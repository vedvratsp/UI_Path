(window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0=window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0||[]).push([[23,47,75],{"+cV3":function(e,t){var n={deleteItemThatIsMountedTitle:"Delete shared folder?",deleteItemThatIsMountedDescription:"The {0} person who has a shortcut to this folder will lose access if you delete it.||The {0} people who have a shortcut to this folder will lose access if you delete it.",deleteItemThatIsMountedIntervals:"1||2-",deleteItems:"Delete items?",deleteItemsAndMountPointsFormat:"{0}, and {1}.",deleteShortcutsFormat:"{0} shortcut will be removed||{0} shortcuts will be removed",deleteOtherItemsFormat:"{0} other item will be sent to the recycle bin||{0} other items will be sent to the recycle bin",deleteShortcutsIntervals:"1||2-",deleteOtherItemsIntervals:"1||2-"};n.default=n,e.exports=n},"+gVS":function(e,t){var n={pinToTop:"Pin to top",unpinFromTop:"Unpin",editPin:"Edit pin",moveLeftPinnedItem:"Move left",moveRightPinnedItem:"Move right",errorPinItemMissingTitle:"The item can\u0027t be pinned",errorMoveItemMissingTitle:"The item can\u0027t be moved",errorUnpinItemMissingTitle:"The item can\u0027t be unpinned",errorFolderMissingBody:"This folder has been moved or deleted.",errorItemMissingBody:"It has been moved or deleted.",errorPinnedItemsFullTitle:"No more items can be pinned",errorPinnedItemsFullBody:"Unpin an item and try again.",errorPinGenericTitle:"The item couldn\u0027t be pinned",errorUnpinGenericTitle:"The item couldn\u0027t be unpinned",errorMoveGenericTitle:"The item couldn\u0027t be moved",errorGenericErrorBody:"Please try again.",pinItemStartedItemsTitle:"Pinning {0} item||Pinning {0} items",pinItemCompletedItemsTitle:"Pinned {0} item||Pinned {0} items",pinItemFailedItemsTitle:"{0} item wasn\u0027t pinned||{0} items weren\u0027t pinned",unpinItemStartedItemsTitle:"Unpinning {0} item||Unpinning {0} items",unpinItemCompletedItemsTitle:"Unpinned {0} item||Unpinned {0} items",unpinItemFailedItemsTitle:"{0} item wasn\u0027t unpinned||{0} items weren\u0027t unpinned",moveLeftItemStartedItemsTitle:"Moving {0} item to the left||Moving {0} items to the left",moveLeftItemCompletedItemsTitle:"Moved {0} item to the left||Moved {0} items to the left",moveLeftItemFailedItemsTitle:"{0} item wasn\u0027t moved||{0} items weren\u0027t moved",moveRightItemStartedItemsTitle:"Moving {0} item to the right||Moving {0} items to the right",moveRightItemCompletedItemsTitle:"Moved {0} item to the right||Moved {0} items to the right",moveRightItemFailedItemsTitle:"{0} item wasn\u0027t moved||{0} items weren\u0027t moved",editPinCompletedItemsTitleIntervals:"1||2-"};n.default=n,e.exports=n},"/nZY":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n("17wl"),i=n("12Fv"),a=n("Sd+/"),o=n("dS01"),s=n("Fyxx"),l=n("oveG"),c=n("6aXa"),u=n("h0t6"),d=Object(i.a)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,a=!1,s=i&&o.a.serialize(i);if(i&&n){var c=e.demandItemFacet(l.Ib,s);a=!(!(c&&c.permissions&&c.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:a},Object(u.b)(e,{itemKey:s,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,a;return Object(r.__generator)(this,function(r){return e(Object(c.a)({items:(t={},t[s.a.serialize(i)]={views:(a={},a[n.id]={isDefault:!0},a)},t)})),[2]})})}:void 0}})(a.a)},"0XSq":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("qbEG").a)("kanban")},"1Yta":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("createView"),o=Object(i.e)({operationTypeFacet:a})},"1xfj":function(e,t,n){"use strict";n.r(t),n.d(t,"spProjectedUploadedItemSetAddon",function(){return pc.spProjectedUploadedItemSetAddon}),n.d(t,"SpAddonDeferred",function(){return Ac});var r=n("17wl"),i=n("sqky"),a=n("xznA"),o=n("SVnr"),s=n("lbre"),l=n("3tbO"),c=n("ss5J"),u=n("U1Wn"),d=n("XqzB"),m=n("xx2A"),p=n("oCyF"),b=n("lGCB"),f=n("LfMA"),h=n("dS01"),_=new f.a("spContentTypeCreateDocumentAction",{listKey:Object(f.g)(h.a),templateUrl:Object(f.f)()}),v=new f.a("spContentTypeNavigationActionKeyFacet",{listKey:Object(f.g)(h.a),contentTypeId:Object(f.f)()}),g=n("W42Y"),y=n("Pe+L"),I=n("duI/"),O=n("dMIW"),w=n("x4ej"),j=n("yuog"),S=n("Fyxx"),A=n("J37h"),k=n("oveG"),T=n("cDcd"),U=n("jom9"),C=n.n(U),F=n("rbM2"),P=n("2zdE"),E=n("wTnq"),x=n.n(E),D=n("/ZMm"),L=n("12Fv"),N=n("Sd+/"),K=n("R/Xa"),R=n("9kMg"),z=n("R82v"),q=n("doXJ"),M=n("vyKV"),G=n("h0t6"),V=n("JI8f"),B=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},H=Object(D.f)()(Object(D.d)()(Object(L.a)(function(e,t){var n=t.itemKey,i=t.isEditForm,a=!1,o=B;if(Object(V.a)(e,{enableEditOrViewItemCommandConfiguration:k.B}).enableEditOrViewItemCommandConfiguration){var s=e.demandItem({key:p.a,itemId:k.Lb,contentTypeId:k.n,permissions:k.fc},n),l=s.key,c=s.itemId,u=s.contentTypeId,d=s.permissions;if(l&&c&&(!i||d&&M.b.hasItemPermission({permissions:d},M.b.editListItems))){var m=l&&e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}));if(m&&!m.isAnonymousGuestUser){var b=e.demandItem({list:k.Ib,listFormUrls:k.Jb},h.a.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl})),f=b.list,_=b.listFormUrls,v=_?i?_.editFormUrl:_.displayFormUrl:void 0;if(f&&_&&f.templateType&&f.templateType!==R.b.mySiteDocumentLibrary&&v){var g=Object(z.a)(v,l.rootFolder||new q.a(l.listFullUrl).path,c,u);a=!0,o=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){return(e=window.open(g,"_blank"))&&e.focus(),[2]})})}}}}}return Object(r.__assign)({isAvailable:a,onExecute:o},Object(G.b)(e,{itemKey:n,engagement:{name:i?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(N.a))),W=n("iODI"),J=n("NbAF"),Z=n("LbJS"),Q=n("GFxw"),X=Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1),n.e(80)]).then(n.bind(null,"b+Cl"))];case 1:return[2,e.sent().EditItemWizard]}})})}),Y=Object(L.b)(function(e,t){var n=Object(Q.a)(e),i=1===n.length?n[0]:void 0,a=Object(V.a)(e,{enableEditItemCommand:k.A}).enableEditItemCommand,o=e.demandItemFacet(J.a,i),s=J.a.evaluate(o)(e,{itemKey:i}).getPropertiesForm,l=e.demandItemFacet(k.fc,i),c=e.demandItemFacet(p.a,i),u=c&&e.demandItemFacet(k.Ib,h.a.serialize(c)),d=u&&u.templateType===R.a.mySiteDocumentLibrary,m=a&&!!s&&!!l&&!d&&M.b.hasItemPermission({permissions:l},M.b.editListItems),b=i&&s?Object(Z.g)(function(e){return T.createElement(X,Object(r.__assign)({},e,{itemKey:i,interactiveSave:t.interactiveSave,getPropertiesForm:s}))}):void 0;return T.createElement(N.a,Object(r.__assign)({isAvailable:m,onExecute:b},Object(G.b)(e,{itemKey:i,engagement:{name:"EditItem",isIntentional:!0}})))}),$=n("A/IF"),ee=n("UdYf"),te=n("Azfx"),ne=n("NFPW"),re=n.n(ne),ie=n("vHN8"),ae=n("rTHL"),oe=n("N2Rn"),se=n("KrlH"),le={key:new ie.a("createListItem").id,automationId:"createListItemCommand",name:re.a.listItem,action:T.createElement(oe.a,null,T.createElement(se.a,null)),iconProps:Object(ae.a)({size:16,type:4})},ce={key:ee.a.key,automationId:ee.a.automationId,name:ee.a.name,iconProps:ee.a.iconProps,subMenuProps:{items:[te.a,le]}},ue=n("dT8z"),de=Object(ie.b)("EditItem"),me={key:Object(ie.b)("ViewItem"),name:x.a.Open,action:T.createElement(H,null)},pe={key:de,name:C.a.Edit,action:T.createElement(Y,null),iconProps:{iconName:"Edit"}};function be(e){return[ce,ue.b,pe,P.c,P.b,F.a,$.a]}var fe=n("eDrF"),he=n("YVep"),_e=n("QmvJ"),ve=n("FZQJ"),ge=n("KL1q"),ye=n("76b/"),Ie=n("ayFC"),Oe=n("Q7Xl"),we=Object(ge.memoizeFunction)(function(e,t,n,i){var a,o,s,l,c,u,d,m,p,b,f,h,_,v,g=Object(ye.a)(e),y=Object(Ie.a)(e),I=e.palette,O=e.semanticColors,w={root:[Object(ge.getFocusStyle)(e,{inset:2,highContrastStyle:{left:4,top:4,bottom:4,right:4,border:"none"},borderColor:"transparent"}),e.fonts.medium,{minWidth:"40px",backgroundColor:I.white,color:I.neutralPrimary,padding:"0 4px",border:"none",borderRadius:0,selectors:(a={},a[ge.HighContrastSelector]={border:"none"},a)}],rootHovered:{backgroundColor:I.neutralLighter,color:I.neutralDark,selectors:(o={},o[ge.HighContrastSelector]={color:"Highlight"},o["."+Oe.a.msButtonIcon]={color:I.themeDarkAlt},o["."+Oe.a.msButtonMenuIcon]={color:I.neutralPrimary},o)},rootPressed:{backgroundColor:I.neutralLight,color:I.neutralDark,selectors:(s={},s["."+Oe.a.msButtonIcon]={color:I.themeDark},s["."+Oe.a.msButtonMenuIcon]={color:I.neutralPrimary},s)},rootChecked:{backgroundColor:I.neutralLight,color:I.neutralDark,selectors:(l={},l["."+Oe.a.msButtonIcon]={color:I.themeDark},l["."+Oe.a.msButtonMenuIcon]={color:I.neutralPrimary},l)},rootCheckedHovered:{backgroundColor:I.neutralQuaternaryAlt,selectors:(c={},c["."+Oe.a.msButtonIcon]={color:I.themeDark},c["."+Oe.a.msButtonMenuIcon]={color:I.neutralPrimary},c)},rootExpanded:{backgroundColor:I.neutralLight,color:I.neutralDark,selectors:(u={},u["."+Oe.a.msButtonIcon]={color:I.themeDark},u["."+Oe.a.msButtonMenuIcon]={color:I.neutralPrimary},u)},rootExpandedHovered:{backgroundColor:I.neutralQuaternaryAlt},rootDisabled:{backgroundColor:I.white,selectors:(d={},d["."+Oe.a.msButtonIcon]={color:O.disabledBodySubtext,selectors:(m={},m[ge.HighContrastSelector]=Object(r.__assign)({color:"GrayText"},Object(ge.getHighContrastNoAdjustStyle)()),m)},d[ge.HighContrastSelector]=Object(r.__assign)({color:"GrayText",backgroundColor:"Window"},Object(ge.getHighContrastNoAdjustStyle)()),d)},splitButtonContainer:{height:"100%",selectors:(p={},p[ge.HighContrastSelector]={border:"none"},p)},splitButtonDividerDisabled:{selectors:(b={},b[ge.HighContrastSelector]={backgroundColor:"Window"},b)},splitButtonDivider:{backgroundColor:I.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:I.white,border:"none",borderTopRightRadius:"0",borderBottomRightRadius:"0",color:I.neutralSecondary,selectors:{":hover":{backgroundColor:I.neutralLighter,color:I.neutralDark,selectors:(f={},f[ge.HighContrastSelector]={color:"Highlight"},f["."+Oe.a.msButtonIcon]={color:I.neutralPrimary},f)},":active":{backgroundColor:I.neutralLight,selectors:(h={},h["."+Oe.a.msButtonIcon]={color:I.neutralPrimary},h)}}},splitButtonMenuButtonDisabled:{backgroundColor:I.white,selectors:(_={},_[ge.HighContrastSelector]=Object(r.__assign)({color:"GrayText",border:"none",backgroundColor:"Window"},Object(ge.getHighContrastNoAdjustStyle)()),_)},splitButtonMenuButtonChecked:{backgroundColor:I.neutralLight,color:I.neutralDark,selectors:{":hover":{backgroundColor:I.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:I.neutralLight,color:I.black,selectors:{":hover":{backgroundColor:I.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:I.neutralPrimary},splitButtonMenuIconDisabled:{color:I.neutralTertiary},label:{fontWeight:"normal"},icon:{color:I.themePrimary},menuIcon:(v={color:I.neutralSecondary},v[ge.HighContrastSelector]={color:"GrayText"},v)};return Object(ge.concatStyleSets)(g,y,w,t)}),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return T.createElement(ve.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--commandBar",styles:we(n,t),onRenderDescription:ge.nullRender}))},Object(r.__decorate)([Object(ge.customizable)("CommandBarButton",["theme","styles"],!0)],t)}(T.Component),Se=n("InaI"),Ae=n("jOlS");Object(Ae.loadStyles)([{rawString:".iconContainer_8920b193{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8920b193{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8920b193 img{display:block}.menuItemBrandIcon_8920b193{position:relative;margin:0 4px;height:32px;width:16px}.menuItemIconContainer_8920b193{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8920b193,.logoIcon_8920b193{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8920b193[data-icon-name='ExcelLogo16'],.logoIcon_8920b193[data-icon-name='ExcelLogo16']{color:"},{theme:"excelIconColor",defaultValue:"#217346"},{rawString:"}.logoFillIcon_8920b193[data-icon-name='OneNoteLogo16'],.logoIcon_8920b193[data-icon-name='OneNoteLogo16']{color:"},{theme:"onenoteIconColor",defaultValue:"#5c2d91"},{rawString:"}.logoFillIcon_8920b193[data-icon-name='PowerPointLogo16'],.logoIcon_8920b193[data-icon-name='PowerPointLogo16']{color:"},{theme:"powerpointIconColor",defaultValue:"#d24726"},{rawString:"}.logoFillIcon_8920b193[data-icon-name='WordLogo16'],.logoIcon_8920b193[data-icon-name='WordLogo16']{color:"},{theme:"wordIconColor",defaultValue:"#2b579a"},{rawString:"}.logoFillIcon_8920b193[data-icon-name='VisioLogo16'],.logoIcon_8920b193[data-icon-name='VisioLogo16']{color:"},{theme:"visioIconColor",defaultValue:"#3854a2"},{rawString:"}.logoFillIcon_8920b193{color:#ffffff}.contextualMenuItemLinkContent_8920b193{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8920b193{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"}]);var ke=n("F0Gs"),Te=n("gk6P"),Ue={key:new ie.a("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:T.createElement(Te.c,null),facets:Object(r.__assign)({},fe.b.pack(!0))},Ce=n("eKOX"),Fe={key:new ie.a("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:T.createElement(Ce.b,null),facets:Object(r.__assign)({},fe.b.pack(!0))},Pe=n("JfR2"),Ee=n("XIjh"),xe=n("MQWL"),De=new ie.a("fileHandlerOpenCommand").id,Le={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},Ne=Object(D.f)()(Object(D.d)()(Object(L.a)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:k.bc},n).appMap,a=r.name;return r.key===Ue.key?a=a||(i?Object(Se.f)(i,!0):Se.a.Open):r.key===Fe.key&&(a=a||(i?Object(Se.e)(i,!0):Se.a.OpenInBrowser)),{name:a}})(function(e){return T.createElement("div",{className:"contextualMenuItemLinkContent_8920b193"},T.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8920b193"},e.name))}))),Ke=Object(D.f)()(Object(D.d)()(Object(L.a)(function(e,t){var n=t.itemKey,i=t.menuProps,a=e.demandItem({appMap:k.bc,fileName:ke.j},n),o=a.appMap,s=a.fileName,l={};if(i&&i.items){var c=i.items[0];c&&-1!==c.key.indexOf(De)&&c.iconProps&&(l=c.iconProps)}var u=!!s&&!!s.extension&&".pdf"===s.extension.toLowerCase(),d={iconName:o?Object(Se.b)(o):u?"PDF":"OpenFile"},m=Object(xe.a)(e,n),p=Object(Ee.a)(e,{feature:Le,pageContext:m}),b=void 0;return i&&i.items&&(b=i.items.map(function(e){return e.key===Ue.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(Se.f)(o,!0)||Se.a.Open,onRenderIcon:o?Re.bind(void 0,o,!0,p):void 0}):e.key===Fe.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(Se.e)(o,!0)||(u?Se.a.OpenInBrowser:Se.a.Open),onRenderIcon:o?Re.bind(void 0,o,!0,p):void 0}):e})),{iconProps:l||d,onRenderIcon:o?Re.bind(void 0,o,!1,p):void 0,text:Se.a.Open,menuProps:b?Object(r.__assign)(Object(r.__assign)({},i),{items:b}):i}})(je)));function Re(e,t,n){var r=e&&Object(Se.c)(e),i=e&&Object(Se.d)(e);return i&&n?T.createElement(Pe.a,{size:16,extension:"",brand:i.toLowerCase(),className:t?"menuItemBrandIcon_8920b193":"brandIcon_8920b193"}):r?T.createElement("span",{className:t?"menuItemIconContainer_8920b193":"iconContainer_8920b193"},T.createElement(_e.Icon,{iconName:r.logoFill16,className:"logoFillIcon_8920b193"}),T.createElement(_e.Icon,{iconName:r.logo16,className:"logoIcon_8920b193"})):null}var ze={key:he.a.key,automationId:he.a.automationId,subMenuProps:{items:[Fe,Ue]},onRender:function(e){return T.createElement(Ke,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},fe.b.pack(!0))},qe=new f.a("syncIssues",{webAbsoluteUrl:Object(f.f)(),listFullUrl:Object(f.f)()}),Me=(new f.a("syncIssue",{webAbsoluteUrl:Object(f.f)(),listFullUrl:Object(f.f)(),issueId:Object(f.f)()}),new ie.a("listSyncIssueFacet"),n("9jhT")),Ge=n("K9kD");Object(Ae.loadStyles)([{rawString:".needsAttentionIconOverlay_817fe717{position:relative}.needsAttentionIconOverlay_817fe717:after{content:'';position:absolute;top:-3px;height:8px;width:8px;border-radius:8px;background-color:#a80000}[dir='ltr'] .needsAttentionIconOverlay_817fe717:after{left:15px}[dir='rtl'] .needsAttentionIconOverlay_817fe717:after{right:15px}.needsAttentionIcon_817fe717{color:#a80000}\n"}]);var Ve=n("XkN0"),Be=n("EswB"),He=n("0S88"),We=n("neMf"),Je=n("0XSq"),Ze=n("TYG3"),Qe=n("o7xM"),Xe=n("aW/l"),Ye=n("HqLV"),$e=new Ge.PlatformDetection;function et(e,t){var n=Object(V.a)(e,{enableQuickEdit:k.T}).enableQuickEdit,r=Object(Xe.a)(e).itemsScopeItemKey,i=r&&Object(Qe.a)(e,{itemsScopeItemKey:r}),a=i&&i.id===Ye.a.id;return!(!n||!a||$e.isIE)}var tt=Object(D.c)()(Object(Ze.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(70).then(n.bind(null,"+OHR"))];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},et,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:y.a},n).deserizalizedKey,a=i&&i.viewKey&&A.a.serialize(i.viewKey),o=a&&e.demandItemFacet(k.pd,a);return et(e)&&o===r})),nt=n("xCzJ"),rt=n("UbrB"),it=Object(L.b)(function(e,t){var n,i,a,o,s=t.viewKey,l=t.itemSetKey,c=void 0,u=l&&e.demandItemFacet(y.a,l),d=e.demandItemFacet(k.p,s);if(u&&d){var m=h.a.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}),p=e.demandItemFacet(k.Ib,m),b=e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));b&&p&&p.id&&d&&"POWER"!==d.viewType&&p.permissions&&d.canUserEdit(p.permissions)&&(i=(n={webAbsoluteUrl:u.webAbsoluteUrl,layoutsUrl:b.layoutsUrl,viewId:d.id,listId:p.id,sourceUrl:d.serverRelativeUrl||""}).viewId,a=n.listId,o=n.sourceUrl,c=n.webAbsoluteUrl+"/"+n.layoutsUrl+"/ViewEdit.aspx?"+Object(rt.a)({View:Ge.Guid.normalizeUpper(i,!0),List:Ge.Guid.normalizeUpper(a,!0),Source:o}))}var f=!!c;return T.createElement(N.a,Object(r.__assign)({isAvailable:f,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return window.open(c),[2]})})}},Object(G.b)(e,{itemKey:l,engagement:{name:"CustomizeView",isIntentional:!0}})))}),at=Object(Ze.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(95).then(n.bind(null,"IhDx"))];case 1:return[2,e.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r}),ot=n("60OA"),st=n("XYUc"),lt=n("WAEx"),ct=Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(4),n.e(14),n.e(24)]).then(n.bind(null,"TXLq"))];case 1:return[2,e.sent().ViewCreator]}})})}),ut=Object(L.b)(function(e,t){var n=t.currentViewKey,i=Object(ot.a)(e),a=Object(Xe.a)(e).itemsScopeItemKey,o=!1,s=e.demandItemFacet(y.a,i),l=e.demandItemFacet(k.p,n),c=e.demandItemFacet(st.a,i),u=st.a.evaluate(c)(e,{viewKey:n}).onViewSaved;if(s&&l){var d=h.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),m=e.demandItemFacet(k.Ib,d);o=!!(m&&l&&"POWER"!==l.viewType&&m.permissions&&(m.permissions.managePersonalViews||m.permissions.manageLists))}if(!l||!i||!a)return null;var p=Object(Z.g)(function(e){return T.createElement(lt.a,{itemsScopeItemKey:a},T.createElement(ct,Object(r.__assign)({},e,t,{itemSetKey:i,viewTitle:l.title,isPublicView:!l.isPersonal,onViewSaved:u})))},{scope:"global"});return T.createElement(N.a,Object(r.__assign)({isAvailable:o,onExecute:p},Object(G.b)(e,{itemKey:i,engagement:{name:"SaveView",isIntentional:!0}})))}),dt=n("/nZY"),mt=Object(ie.b)("createView"),pt=Object(ie.b)("switchView"),bt=Object(ie.b)("needsAttentionView"),ft=Object(ie.b)("setDefaultView"),ht=Object(ie.b)("customizeView"),_t=Object(ie.b)("switchToFixedGridLayoutCommand"),vt=Object(ie.b)("switchToDynamicGridLayoutCommand"),gt=Object(ie.b)("calendarMonth"),yt=Object(ie.b)("kanban"),It=Object(ie.b)("saveView"),Ot=Object(ie.b)("syncIssues"),wt=n("xKj0"),jt=n("dnQb"),St=n("DTs3"),At=n("kk66"),kt=new ie.a("isViewCommand"),Tt=new ie.a("isSwitchViewCommand"),Ut=new ie.a("isEditViewCommand"),Ct=new ie.a("isCreateViewCommand"),Ft=[{ODB:1776},{ODB:1772},{ODB:60020}],Pt={ODB:1484},Et={iconName:void 0,styles:{root:{display:"none!important"}}},xt=Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(4),n.e(14),n.e(24)]).then(n.bind(null,"T6w3"))];case 1:return[2,e.sent().CreateViewAction]}})})}),Dt={key:_t,automationId:"switchToFixedGridLayoutCommand",name:C.a.fixedHeight,action:T.createElement(tt,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},Lt={key:vt,automationId:"switchToDynamicGridLayoutCommand",name:C.a.dynamicHeight,action:T.createElement(tt,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function Nt(e,t,n,i){var a=Ge.Guid.normalizeLower(e.Id,!1);return{key:pt+"-"+a,automationId:"switchViewCommand_"+a,name:e.Title,iconProps:Et,action:T.createElement(at,{viewId:a,currentDerivedView:i,itemSetKey:n}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},fe.e.pack(!0)),kt.pack(!0)),Tt.pack(!0))}}var Kt,Rt,zt=n("vHjZ"),qt=n("AheH"),Mt=Object(L.a)()(Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(81).then(n.bind(null,"CTe1"))];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),Gt=Object(L.b)(function(e,t){var n=t.itemKey,i=t.editType,a=Object(Xe.a)(e).itemsScopeItemKey,o=Object(qt.a)(e),s=e.demandItem({isMalwareDetected:ke.w,permissions:k.fc},n),l=s.isMalwareDetected,c=s.permissions,u=!l&&!!n&&Object(zt.a)(e,t)&&!!o&&!!c&&M.a.hasItemPermission({permissions:c},M.a.manageLists)&&function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(At.a,n),a=i?i.itemKeys:[],o=a.indexOf(t.itemKey),s=o>-1?0!==r:0===r;return s&&(2===r?s=0!==o:3===r&&(s=o!==a.length-1)),s}(e,{itemKey:t.itemKey,pinnedItemSetKey:o,editType:i}),d=a?Object(Z.g)(function(e){return T.createElement(Mt,Object(r.__assign)({},e,t,{itemsScopeItemKey:a,pinnedItemSetKey:o}))}):void 0;return T.createElement(N.a,Object(r.__assign)({isAvailable:u,onExecute:d},Object(G.b)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),Vt=Object(D.f)()(Object(D.d)()(Gt)),Bt=n("gg5B"),Ht=n("+gVS"),Wt=n.n(Ht),Jt=Object(ie.b)("pinItem"),Zt=Object(ie.b)("moveLeftPinnedItem"),Qt=Object(ie.b)("moveRightPinnedItem"),Xt=Object(ie.b)("removePinnedItem"),Yt=Object(ie.b)("editPinnedItem"),$t={key:Jt,automationId:"pinItemCommand",name:Wt.a.pinToTop,iconProps:{iconName:"Pin"},action:T.createElement(Vt,{editType:0})},en={key:Zt,automationId:"moveLeftPinnedItemCommand",name:Wt.a.moveLeftPinnedItem,iconProps:{iconName:Bt.a.isRightToLeft?"Forward":"Back"},action:T.createElement(Vt,{editType:2})},tn={key:Qt,automationId:"moveRightPinnedItemCommand",name:Wt.a.moveRightPinnedItem,iconProps:{iconName:Bt.a.isRightToLeft?"Back":"Forward"},action:T.createElement(Vt,{editType:3})},nn={key:Xt,automationId:"removePinnedItemCommand",name:Wt.a.unpinFromTop,iconProps:{iconName:"UnPin"},action:T.createElement(Vt,{editType:1})},rn={key:Yt,automationId:"editPinnedItemCommand",name:Wt.a.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[en,tn,nn]}},an=n("LQht"),on=n("7Hin"),sn=n("mNxR"),ln=n("Ql3v"),cn=n("r55L"),un=n("Tz8b"),dn=n("+Grl"),mn=n("ciIl"),pn=n("nz3y"),bn=n("H8DK"),fn=n("jyAd"),hn=n("m0uK"),_n=n.n(hn),vn=((Kt={})[bn.d.started]=function(e){var t=e.count,n=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(n?_n.a.schedulePublishStartedItemsTitle:_n.a.publishStartedItemsTitle,_n.a.publishCompletedItemsTitleIntervals,t)||"",t)},Kt[bn.d.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(n?_n.a.schedulePublishCompletedItemsTitle:_n.a.publishCompletedItemsTitle,_n.a.publishCompletedItemsTitleIntervals,t)||"",t)},Kt[bn.d.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(n?_n.a.schedulePublishFailedItemsTitle:_n.a.publishFailedItemsTitle,_n.a.publishFailedItemsTitleIntervals,t)||"",t)},Kt[bn.d.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(n?_n.a.schedulePublishFailedItemsTitle:_n.a.publishFailedItemsTitle,_n.a.publishFailedItemsTitleIntervals,t)||"",t)},Kt),gn=((Rt={})[bn.d.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(r?_n.a.schedulePublishStartedItemsTitle:_n.a.publishStartedItemsTitle,_n.a.publishStartedItemsDestinationTitleIntervals,t)||"",t,T.createElement(fn.a,{key:"link",itemKey:n}))},Rt[bn.d.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(r?_n.a.schedulePublishCompletedItemsDestinationTitle:_n.a.publishCompletedItemsDestinationTitle,_n.a.publishCompletedItemsDestinationTitleIntervals,t)||"",t,T.createElement(fn.a,{key:"link",itemKey:n}))},Rt[bn.d.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(r?_n.a.schedulePublishFailedItemsDestinationTitle:_n.a.publishFailedItemsDestinationTitle,_n.a.publishFailedItemsDestinationTitleIntervals,t)||"",t,T.createElement(fn.a,{key:"link",itemKey:n}))},Rt[bn.d.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(Ve.formatToArray)(Object(Ve.getLocalizedCountValue)(r?_n.a.schedulePublishFailedItemsDestinationTitle:_n.a.publishFailedItemsDestinationTitle,_n.a.publishFailedItemsDestinationTitleIntervals,t)||"",t,T.createElement(fn.a,{key:"link",itemKey:n}))},Rt),yn=Object(i.b)(function(){return function(e){e(Object(o.a)(an.a,mn.a)(Object(dn.a)()(In)))}});function In(){return function(e){return On}}function On(e,t){var n,i,a=Object(pn.e)(e,t),o=a.phase,s=a.count,l=function(e,t){var n=void 0,r=e.demandItemFacet(At.a,t.itemKey);if(r)for(var i=0,a=r.itemKeys;i<a.length;i++){var o=a[i],s=e.demandItemFacet(bn.r,o),l=s&&s.itemKey,c=e.demandItemFacet(ke.A,l),u=c&&c.itemKey;if(u)if(n){if(u!==n)break}else n=u}return n}(e,t),c=e.demandItemFacet(At.a,t.itemKey),u=c&&c.itemKeys;u&&u.length>0&&(i=e.demandItemFacet(an.b,u[0]));var d=!!i&&i.publishActionType===sn.a.SchedulePublish;return n="group"===t.format&&l?gn[o]({count:s,itemKey:l,isScheduled:d}):vn[o]({count:s,isScheduled:d}),Object(r.__assign)(Object(r.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var wn=n("ldEy"),jn=n("y88i"),Sn=Ge.Killswitch.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?Object(pn.f)({operationTypeFacet:an.b,progressKeyFacet:an.a}):Object(pn.f)({operationTypeFacet:an.b,progressKeyFacet:an.a,initializeBatch:function(){return yn}}),An=function(e){function t(t){var n=e.call(this,t)||this;return n.state={publishItemError:void 0},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,a=e.reject,o=n[0],s=t(Object(ln.a)(function(e){return e.demandItem({firstItemKey:p.a,displayName:ke.h},n[0])})).firstItemKey,l=t(Object(ln.a)(function(e){return un.c(e,o)})),c={publishActionType:l},u=!1;if(s){var d=t(Object(ln.a)(function(e){return e.demandItemFacet(k.Ib,h.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))}));u=!!d&&d.templateType===R.a.webPageLibrary}if(s&&u&&l===sn.a.SubmitForApproval){var m=""+new jn.SimpleUri(s.webAbsoluteUrl).authority+t(Object(ln.a)(function(e){return e.demandItemFacet(k.hb,n[0])}));window.location.href=m}else t(Sn({items:Object(on.a)(n,function(){return c})})).then(function(){var e,a;t(Object(cn.a)({items:(e={},e[o]=[k.id],e[o]=[k.Wb],e)})),r&&t(Object(wn.a)({items:(a={},a[r]=Object(on.a)(n,function(){return{}}),a)})),i()}).catch(function(e){a(e)})},t.prototype.render=function(){return null},t}(T.PureComponent),kn=n("EFk2"),Tn=n("x+Ec"),Un=n("k5pJ"),Cn=Object(L.a)()(An),Fn=Object(L.a)(function(e,t){var n=t.onCancel,i=t.reject;return{onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return i(new kn.a),n&&n(),[2]})})},title:_n.a.MissingMetadataDialogTitle,prompt:_n.a.MissingMetadataDialogText,cancelText:_n.a.MissingMetadataDialogButton}})(Tn.a),Pn=Object(L.b)(function(e,t){var n,i=t.itemKeys,a=t.publishType,o=t.source;if(!i||!i.length)return null;var s=Object(ot.a)(e),l=e.demandItem({firstItemKey:p.a,hasMissingMetadata:ke.x,contentTypeId:k.n},i[0]),c=l.firstItemKey,u=l.hasMissingMetadata,d=l.contentTypeId;if(!c)return null;var m=c&&e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}));if(m&&(m.isAnonymousGuestUser||m.isEmailAuthenticationGuestUser))return null;var b=!1,f=!!m&&Object(Ge.getKillSwitch)(m).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),h=un.c(e,i[0]);if(f||!(i.length>1)||(null===(n=m)||void 0===n?void 0:n.listBaseTemplate)===R.b.webPageLibrary&&(h===sn.a.Publish||h===sn.a.Republish||h===sn.a.PostNews||h===sn.a.UpdateNews))for(var _=0,v=i;_<v.length;_++){var g=v[_];if(!(b=!(!un.a(e,g)||!f&&i.length>1&&!un.e(d)||(Un.b(e,g)?1!==a:0!==a))))break}var y=Object(Z.g)(function(e){return u?T.createElement(Fn,Object(r.__assign)({},e,{onCancel:function(e){}})):T.createElement(Cn,Object(r.__assign)({},e,{itemKeys:i,itemSetKey:s}))});return T.createElement(N.a,Object(r.__assign)({isAvailable:b,onExecute:y},Object(G.b)(e,{itemKey:i[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:o}}})))}),En=Object(D.f)()(Pn),xn=n("hR5Q"),Dn=new ie.a("Publish").id,Ln=new ie.a("Schedule").id,Nn=new Map([[sn.a.Publish,C.a.Publish],[sn.a.CancelApproval,C.a.CancelApproval],[sn.a.SubmitForApproval,C.a.SubmitForApproval],[sn.a.SchedulePublish,C.a.Schedule],[sn.a.Republish,C.a.Republish]]),Kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,i=Object(r.__rest)(e,["defaultRender","itemKeys"]),a=n[0];return T.createElement(xn.a,null,function(e){var n=e.itemCache,o=Object(un.c)(n,a),s=Nn.get(o)||C.a.Publish;return t?T.createElement(t,Object(r.__assign)({},i,{text:s})):null})},t}(T.PureComponent),Rn={key:Dn,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:C.a.Publish,action:T.createElement(En,{publishType:0,source:"Command"}),commandBarButtonAs:Object(D.f)()(Kn)},zn={key:Ln,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:C.a.Schedule,action:T.createElement(En,{publishType:1,source:"Command"}),commandBarButtonAs:Object(D.f)()(Kn)},qn=n("EdJH"),Mn=Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(68).then(n.bind(null,"WIdD"))];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),Gn=Object(L.b)(function(e,t){var n=t.checkInOutType,i=Object(ot.a)(e),a=Object(Q.a)(e);if(!a.length)return null;var o=e.demandItem({firstItemKey:p.a},a[0]).firstItemKey;if(!o)return null;var s=o&&e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl}));if(s&&(s.isAnonymousGuestUser||s.isEmailAuthenticationGuestUser))return null;for(var l=e.demandItemFacet(k.Ib,h.a.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl})),c=!!l&&l.templateType===R.a.mySiteDocumentLibrary,u=!!l&&!!l.enableMinorVersions,d=!1,m=0,b=a;m<b.length;m++){var f=b[m],_=e.demandItemFacet(ke.l,f),v=e.demandItemFacet(qn.e,f);if(f&&!_&&!v){var g=e.demandItem({isCheckedOut:ke.p,isBFile:k.ub},f),y=g.isCheckedOut,I=g.isBFile,O=e.demandItemFacet(k.fc,f),w=M.a.hasItemPermission({permissions:O},M.a.editListItems),j=M.a.hasItemPermission({permissions:O},M.a.cancelCheckout);"checkOut"===n?d=!I&&!c&&!(y&&(y.byYou||y.byOther))&&w:"checkIn"!==n&&"undoCheckOut"!==n||!y||(d=w&&(!!y.byYou||j&&!!y.byOther))}if(!d)break}var S=a?Object(Z.g)(function(e){return T.createElement(Mn,Object(r.__assign)({},e,{itemSetKey:i,itemKeys:a,checkInOutType:n,enableMinorVersions:u}))}):void 0;return T.createElement(N.a,Object(r.__assign)({isAvailable:d,onExecute:S},Object(G.b)(e,{itemKey:a[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:a.length>1}}})))}),Vn=n("JxDi"),Bn=n.n(Vn),Hn=n("9X6G"),Wn=new ie.a("ApproveReject").id;function Jn(e){var t=e.listFacets,n=t&&t.templateType===R.b.webPageLibrary&&t.isModerated?C.a.ReviewApprovals:C.a.ApproveReject;return{key:Wn,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:T.createElement(Hn.a,null)}}var Zn,Qn=new ie.a("moreCommands").id,Xn={key:new ie.a("CheckOutItem").id,automationId:"checkOutItemCommand",name:Bn.a.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:T.createElement(Gn,{checkInOutType:"checkOut"})},Yn={key:new ie.a("CheckInItem").id,automationId:"checkInItemCommand",name:Bn.a.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:T.createElement(Gn,{checkInOutType:"checkIn"})},$n={key:new ie.a("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:Bn.a.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:T.createElement(Gn,{checkInOutType:"undoCheckOut"})},er={key:new ie.a("ViewDocumentProperties").id,name:C.a.ViewProperties,action:T.createElement(Y,{interactiveSave:!0})},tr=n("wVFh"),nr=Object(D.c)()(Object(Ze.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(69).then(n.bind(null,"Hgse"))];case 1:return[2,e.sent().ExitQuickEditActionExecutor]}})})},function(e,t){var n=Object(V.a)(e,{enableQuickEdit:k.T}).enableQuickEdit,r=!!n;return n&&(r=Object(Qe.a)(e)===Ye.a),r})),rr={key:new ie.a("exitQuickEdit").id,automationId:"exitQuickEditCommand",name:C.a.ExitGridView,action:T.createElement(nr,null),iconProps:{iconName:"ViewList"}},ir=n("FBdU"),ar=n("OpeS"),or=n("frCt"),sr=n("3SKL"),lr=n("djFM"),cr=n("SltW"),ur=Object(D.a)()(Object(D.f)()(Object(L.a)(function(e,t){var n,i,a,o=t.itemKey,s=t.itemKeys,l=t.enabledForMultipleItems,c=void 0===l?t.enabledForMultipleItems||!1:l,u=t.isEnabledFunc,d=t.url,m=!!c||1===s.length,b=void 0,f=void 0;if(m&&s[0]){var h=e.demandItem({key:p.a,permissions:k.fc,rowData:k.tc},s[0])||void 0;h&&(f=h.key,b=h.rowData,a=h.permissions)}else if(m&&o){var _=e.demandItem({key:p.a,permissions:k.fc},o);_&&(f=_.key,a=_.permissions)}n=f&&f.webAbsoluteUrl,i=f&&f.listFullUrl;var v,g=n&&i&&e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:n,listFullUrl:i}))||void 0;if(m&&!c)if("boolean"==typeof u)m=u;else if("function"==typeof u){var y="",I="",O="";if(b){var w=b;y=w.File_x0020_Type||"",I=w.ContentTypeId||"",O=w.ProgId||""}else m=!1;m=u({permissions:a||0,extension:y,contentTypeId:I,progId:O})}if(m&&d){var j=[];s.forEach(function(t){var n=e.demandItem({itemId:k.Lb,itemUrl:k.hb},t);n&&j.push({id:n.itemId||"",url:n.itemUrl||""})}),g&&(d=Object(lr.c)(d,j,g))}return v=d&&"javascript:LaunchApp("===d.substring(0,21)&&");"===d.substring(d.length-2)?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return d&&g&&Object(cr.a)(d,g),[2]})})}:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){return(e=window.open(d,"_blank"))&&e.focus(),[2]})})},Object(r.__assign)({isAvailable:m,onExecute:v},Object(G.b)(e,{itemKey:s[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(N.a))),dr=n("GQoE"),mr=n("Rr4e"),pr=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},br=Object(L.b)(function(e,t){var n=t.itemKeys,i=t.enabledForMultipleItems,a=void 0===i?t.enabledForMultipleItems||!1:i,o=t.isEnabledFunc,s=t.commandAdapter,l=e.dispatch,c=!!a||1===n.length;if(c&&1===n.length&&"function"==typeof o){var u=e.demandItem({key:p.a,permissions:k.fc,rowData:k.tc},n[0]),d="",m="",b="";if(u&&u.rowData){var f=u.rowData;d=f.File_x0020_Type||"",m=f.ContentTypeId||"",b=f.ProgId||""}else c=!1;c=c&&o({permissions:u&&u.permissions||0,extension:d,contentTypeId:m,progId:b})}if(c&&s){var h=[];n.forEach(function(t){var n=e.demandItemFacet(ir.h,t);n&&h.push(n)}),s.refresh(h),c=c&&s.visible}var _=pr;s&&(_=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,s.execute()]})})});var v=!Ge.Killswitch.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return T.createElement(T.Fragment,null,v?T.createElement(fr,{dispatch:l,itemKeys:n}):null,T.createElement(N.a,Object(r.__assign)({isAvailable:c,onExecute:_},Object(G.b)(e,{itemKey:n[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),fr=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var i=n[0],a=void 0;if(p.a.matches(i)){var o=p.a.deserialize(i);if(o){var s=h.a.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});a=t(Object(dr.a)({listViewAdapter:ir.g},s)).listViewAdapter}}var l={};return a&&(n.forEach(function(e){var n=t(Object(dr.a)({rowData:k.tc,rowAdapter:ir.h},e)),i=n.rowData;if(!n.rowAdapter&&i&&a){var o=a.createRowAdapter({values:i});o&&(l[e]=Object(r.__assign)({},ir.h.pack(o)))}}),Object.keys(l).length>0&&t(Object(mr.a)({items:l}))),null},hr=Object(D.f)()(br);!function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(Zn||(Zn={}));var _r=n("r8F3");Object(Ae.loadStyles)([{rawString:".customActionCommandIcon_cd2598ba{width:16px;height:16px}\n"}]);var vr=new ie.a("customActionNavigationCommand").id;function gr(e){var t=e.key,n=e.name,r=e.url,i=e.iconUrl,a=e.enabledForMultipleItems,o=e.isEnabledFunc,s=e.commandAdapter;return{key:vr+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:Zn.image,className:"customActionCommandIcon_cd2598ba",imageProps:{src:i||"",imageFit:_r.a.contain,className:"customActionCommandIcon_cd2598ba"}},action:s?T.createElement(hr,{enabledForMultipleItems:a,isEnabledFunc:o,commandAdapter:s}):r?T.createElement(ur,{url:r,enabledForMultipleItems:a,isEnabledFunc:o}):void 0}}var yr=new ie.a("customActionGroupCommand").id;function Ir(e,t){var n=[],r=e.demandItemFacet(At.a,t);return r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r,i,a=e.demandItem({displayName:ke.h,openUrl:ke.z,iconUrl:sr.b,childItemKeys:At.a,enabledForMultipleItems:sr.a,isEnabledFunc:sr.c,commandAdapter:ir.e},t);if(a&&a.displayName){var o=a.displayName,s=a.openUrl,l=a.iconUrl,c=a.enabledForMultipleItems,u=a.isEnabledFunc,d=a.childItemKeys,m=a.commandAdapter;if(d&&d.itemKeys&&d.itemKeys.length>0){var p=[];d.itemKeys.forEach(function(n,r,i){var a=e.demandItem({subMenuDisplayName:ke.h,openUrl:ke.z,iconUrl:sr.b,enabledForMultipleItems:sr.a,isEnabledFunc:sr.c,commandAdapter:ir.e},n);a&&a.subMenuDisplayName&&p.push(gr({key:t+"-"+n,name:a&&a.subMenuDisplayName,url:a&&a.openUrl,iconUrl:a&&a.iconUrl,enabledForMultipleItems:a&&a.enabledForMultipleItems,isEnabledFunc:a&&a.isEnabledFunc,commandAdapter:a&&a.commandAdapter}))}),n.push((i=(r={key:t,name:o,subCommands:p}).key,{key:yr+"-"+i,automationId:"customActionGroupCommand",name:r.name,subMenuProps:{items:r.subCommands}}))}else o&&n.push(gr({key:t,name:o,url:s,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:u,commandAdapter:m}))}}),n}function Or(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,a=e.targetCustomActionSetKey,o=void 0,s=h.a.serialize({webAbsoluteUrl:n,listFullUrl:r}),l=i.demandItemFacet(ir.f,s),c=i.demandItemFacet(k.qc,a),u=!!l&&!!c,d=Object(Xe.a)(i).itemsScopeItemKey;if(u&&d){var m=or.a.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:u,targetCustomActionSetKey:a,itemsScopeItemKey:d});i.demandItemFacet(At.a,m)&&(o=m)}return o}var wr=n("FTHh"),jr=n.n(wr),Sr=n("WopS"),Ar=n("1wUa"),kr=n("Dy9Q");Object(Ae.loadStyles)([{rawString:".keyboardMapGroup_0538ad13{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.keyboardMapTable_0538ad13{display:table;list-style:none;margin:0;padding:0}.keyboardMapRow_0538ad13{display:table-row}.keyboardMapRow_0538ad13 span{display:table-cell}.keyboardMapKey_0538ad13{color:#0078d4;min-width:55px}.keyboardMapVal_0538ad13{padding:4px 8px}\n"}]);var Tr=n("KbV0"),Ur=n("3FfR"),Cr=[{keys:"Ctrl + a",desc:jr.a.selectAllDesc},{keys:"Ctrl + d",desc:jr.a.deselectAllDesc},{keys:"esc",desc:jr.a.escDesc},{keys:"space",desc:jr.a.spaceDesc},{keys:"enter",desc:jr.a.enterDesc}],Fr=[{keys:"F2",desc:jr.a.renameDesc},{keys:"Delete",desc:jr.a.deleteDesc},{keys:"s",desc:jr.a.showShareDesc},{keys:"alt + up",desc:jr.a.altUpDesc},{keys:"?",desc:jr.a.showKeymapDesc},{keys:"g",desc:jr.a.showActionDetailsDesc},{keys:"i",desc:jr.a.toggleInfoDesc}];function Pr(e){var t=e.resolve,n=Object(Ur.a)(function(){t()}),r=[Cr,Fr],i=-1,a=-1;return T.createElement(Tr.a,null,T.createElement(Sr.a,{onDismiss:n,hidden:!1,dialogContentProps:{type:Ar.a.close,title:jr.a.KeyboardMapTitle},styles:xr},r.map(function(e){return T.createElement("div",{className:"keyboardMapGroup_0538ad13",key:"keyMap"+ ++i},T.createElement("ul",{className:"keyboardMapTable_0538ad13",key:""+i},e.map(function(e){return T.createElement("li",{className:"keyboardMapRow_0538ad13",key:""+ ++a},T.createElement("span",{className:"keyboardMapKey_0538ad13",key:i+"."+a+".0.0"},e.keys),T.createElement("span",{className:"keyboardMapVal_0538ad13",key:i+"."+a+".1.1"},e.desc))})))}),T.createElement(kr.a,null,T.createElement(ge.PrimaryButton,{onClick:n},jr.a.okButtonText))))}var Er=Object(L.b)(function(e){var t=Object(Z.g)(Pr);return T.createElement(N.a,{onExecute:t})});function xr(){return{main:{maxWidth:"700px !important"}}}var Dr={key:new ie.a("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:jr.a.showKeymapDesc},action:T.createElement(Er,null)},Lr=Object(L.b)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(ke.A,n),i=r&&r.itemKey;return T.createElement(wt.a,{itemKey:i})}),Nr=Object(D.e)()(Lr),Kr={key:new ie.a("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:jr.a.altUpDesc},action:T.createElement(Nr,null),facets:Object(r.__assign)({},fe.e.pack(!0))},Rr=n("ZXWq"),zr=n("nQ8y"),qr=n("DsuX"),Mr=n("VRCL"),Gr=n("tp5v"),Vr=n("s8I5"),Br=new qr.a("newDocument"),Hr=Object(Gr.b)()(Mr.a),Wr=function(e){function t(t){var n=e.call(this,t)||this;return n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})},n.state={newDocumentKey:Br.serializeNext()},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,i=t.fileCreated,a=t.isItemOpened,o=this.props,s=o.itemCacheDispatch,l=o.itemKey,c=o.parentFolderDriveItemUrl,u=o.action,d=Object(r.__rest)(o,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),m=u.availableOn,p=m&&m.file&&m.file.extensions&&m.file.extensions[0]&&m.file.extensions[0].replace(".",""),b=!!p&&!!u.handler,f=void 0;if(b&&p){var h=!u.handler.isPromoted;h&&!c||(f=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,s(Object(zr.a)({items:(e={},e[l]={newDocumentKey:n,extension:p},e)}))];case 1:return t.sent(),h&&c&&s((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,a=i.parentFolderDriveItemUrl,o=e(Object(dr.a)({fileName:ke.h},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var s=a+":/"+o.fileName+":";e(Object(mr.a)({items:(t={},t[n]=Object(r.__assign)({},ke.H.pack(s)),t)}))})),this.setState({fileCreated:!0,isItemOpened:!1}),[2]}var i})})})}return i?a?null:T.createElement(Hr,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:u})):T.createElement(N.a,Object(r.__assign)({},d,{isAvailable:b,onExecute:f}))},t}(T.Component),Jr=Object(D.e)()(Object(L.a)(function(e,t){var n=t.itemKey,i=t.action,a=e.demandItemFacet(Vr.a,n),o=Vr.a.evaluate(a)(e,{itemKey:n}).driveItemFullUrl,s=i.handler,l=s.appId,c=s.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",u={appId:l};return Object(r.__assign)(Object(r.__assign)({},Object(G.b)(e,{itemKey:n,engagement:{name:c,isIntentional:!0,extraData:u}})),{parentFolderDriveItemUrl:o||""})})(Wr)),Zr=Object(D.f)()(Object(L.a)(function(e,t){var n=t.itemKeys,i=t.action,a=i.availableOn,o=a.allowMultiSelect,s=void 0!==o&&o,l=n.length,c=s&&l>0||1===l;c&&(c=n.every(function(t){var n=e.demandItem({fileName:ke.j,isFolder:ke.l},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(Mr.b)(a,i,Boolean(o))}));var u=i.handler,d=u.appId,m=u.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",p={appId:d};return Object(r.__assign)({isAvailable:c},Object(G.b)(e,{itemKey:n[0],engagement:{name:m,isIntentional:!0,extraData:p}}))})(Mr.a)),Qr=n("WcM2"),Xr=n.n(Qr),Yr=n("yww6");Object(Ae.loadStyles)([{rawString:".fileHandlerCommandIcon_713927b4{width:16px;height:16px}\n"}]);var $r=n("rU9G"),ei=n("U5g/"),ti=new ie.a("fileHandlerOpenCommand").id,ni=new ie.a("fileHandlerCreateCommand").id,ri=new ie.a("fileHandlerCustomCommand").id,ii=new ie.a("fileHandlerAppCommand").id,ai=new ie.a("fileHandlerActionsCommand").id,oi=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:Yr.b,version:Yr.i},n),a=i.actions,o=i.version;if(o&&4===o&&a){var s=function(t){var n=a&&a[t],r=e.demandItemFacet(At.a,n);return r&&r.itemKeys||[]};return{new:ci(e,{actionKeys:s("create"),type:"create"})||[],open:ci(e,{actionKeys:s("open"),type:"open"})||[],custom:ci(e,{actionKeys:s("custom"),type:"custom",collapseCustomCommands:r})||[]}}},si=function(e,t,n){var r=n?t:e,i=n?e:t,a=r,o={};return r.forEach(function(e){o[e.key]=!0}),i.forEach(function(e){o[e.key]||a.push(e)}),a};function li(e,t){var n,r,i,a,o,s=t.itemKey,l=t.type,c=t.CustomAction,u=void 0,d=void 0;if("app"===l){if(u=s,!(y=s&&e.demandItem({displayName:ke.h,appIcon:Yr.c},s)))return;i=ii+"-"+s,a="itemsScopefileHandlerAppCommand",n=y.displayName,y.appIcon&&y.appIcon.url&&(r={iconType:Zn.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:y.appIcon&&y.appIcon.url||"",title:y.displayName||"",imageFit:_r.a.contain,className:"fileHandlerCommandIcon_713927b4"}})}else{var m=e.demandItem({displayName:ke.h,handlerKey:Yr.g,availableOn:Yr.a,icon:Yr.e,isPromoted:Yr.f},s),p=m.displayName,b=m.handlerKey,f=m.availableOn,h=m.icon;d=m.isPromoted;var _=b&&e.demandItemFacet(Yr.c,b),v="open"===l&&_||h;v&&v.url&&(r={iconType:Zn.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:v&&v.url,title:v&&v.displayName,imageFit:_r.a.contain,className:"fileHandlerCommandIcon_713927b4"}});var g=Object($r.a)(e,{itemKey:s});switch(n=p,l){case"open":var y;!n&&b&&(n=(y=s&&e.demandItem({displayName:ke.h},b))&&y.displayName&&Ve.format(Xr.a.openWithCommand,y.displayName)),i=ti,a="itemsScopefileHandlerOpenCommand",o=c?T.createElement(c,{action:g}):T.createElement(Rr.a,{action:g});break;case"create":n||(n=h&&h.displayName||f&&f.file&&f.file.extensions&&Ve.format(Xr.a.createFileWithExtension,f.file.extensions[0])||""),i=ni,a="itemsScopefileHandlerCreateCommand",o=T.createElement(oe.a,null,T.createElement(Jr,{action:g}));break;case"custom":i=ri,a="itemsScopefileHandlerCustomCommand",p&&(a=p.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command"),o=c?T.createElement(c,{action:g}):T.createElement(Zr,{action:g})}i+="-"+s,u=b}if(i&&n)return{key:i,automationId:a,name:n,iconProps:r,action:o,handlerKey:u,isPromoted:d,fileHandlerType:l}}function ci(e,t){var n=t.actionKeys,i=t.type,a=t.collapseCustomCommands,o=void 0===a||a,s=[];if("open"===i){var l=e.demandItemFacet(ei.d,n[0]),c=ei.d.evaluate(l)(e,{openActionAs:Rr.a}).openActionAs;n.forEach(function(t){var n=li(e,{itemKey:t,type:i,CustomAction:c});n&&s.push(n)})}else if("create"===i)n.forEach(function(t){var n=li(e,{itemKey:t,type:i});n&&s.push(n)});else if("custom"===i){l=e.demandItemFacet(ei.b,n[0]);var u=ei.b.evaluate(l)(e,{customActionAs:Zr}).customActionAs,d=function(e,t){var n=t.actionKeys,i=t.CustomAction,a=void 0,o=[],s={},l=function(t){return li(e,{itemKey:t,type:"custom",CustomAction:i})},c=function(t,n){var r=li(e,{itemKey:t,type:"app"});return r&&n&&n.length>0&&(r.subMenuProps={items:n}),r};if(t.collapseCustomCommands){for(var u=0,d=n;u<d.length;u++){var m=d[u],p=l(m);if(p){var b=p.handlerKey||"";if(a){if(!a.subMenuProps){var f=Object(r.__assign)({},a),h=Object.keys(s)[0];if((g=c(h))&&(a=g,b===h)){g.subMenuProps={items:[f,p]};continue}}var _=Object.keys(s).length;if(void 0!==s[b]){var v=a.subMenuProps;if(1===_)v&&v.items.push(p);else{var g,y=s[b];v&&(g=v.items[y]).subMenuProps&&g.subMenuProps.items.push(p)}}else{var I=c(b,[p]);if(!I)continue;if(1===_){var O=Object(r.__assign)({},a);a={key:""+ai,automationId:"itemsScopefileHandlerActionsCommand",name:Xr.a.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:Xr.a.fileHandlerRootActionsMenuAriaLabel,className:"fileHandlerCommandIcon_713927b4"},subMenuProps:{items:[O,I]}},s[b]=1}else a.subMenuProps&&a.subMenuProps.items.push(I),s[b]=_}}else a=p,s[b]=0}}a&&(o=[a])}else for(var w=0,j=function(e){var t=l(e);if(!t)return"continue";var n=t.handlerKey||"",i=c(n,[t]),a=!1;i?(Object.keys(s).forEach(function(e){if(n===e){a=!0;var i=o[s[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}}),a||(s[n]=w,w++,o.push(i))):(s[n]=w,w++,o.push(t))},S=0,A=n;S<A.length;S++)j(m=A[S]);return o}(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:u});d&&s.push.apply(s,d)}return s}var ui,di=n("5s5T"),mi=n("UywX"),pi=((ui={})[te.a.key]="NewFolder",ui[mi.g.key]="NewDOC",ui[mi.a.key]="NewXSL",ui[mi.e.key]="NewPPT",ui[mi.d.key]="NewONE",ui[mi.b.key]="NewXSLSurvey",ui[mi.c.key]="NewXSLForm",ui[mi.f.key]="NewVSDX",ui),bi=n("vRlf"),fi=n("6x/m"),hi=n("2u3R"),_i=n("4Oaa"),vi=n("pn1e"),gi=n("my8R"),yi=Ge.Killswitch.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),Ii=Object(fi.b)(function(){return{type:"file"}})(bi.a),Oi=Object(L.a)(function(){return{fileSelector:Ii}})(hi.a),wi=Object(gi.c)({uploadItemsAction:s.a},{uploadItemsAction:function(e,t){var n=Object(_i.a)(e),i=e.demandItemFacet(p.a,n);if(!i)return{isAvailable:!1};var a=i.listFullUrl;if(!a)return{isAvailable:!1};var o=new q.a(a+"/Forms").path,s=p.a.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),l=p.a.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:o})),c=yi?s:n,u=e.demandItemFacet(k.fc,c);return{targetItemKey:l,isAvailable:M.b.hasItemPermission({permissions:u},M.b.manageLists)&&Si(e,i)}}}),ji=Object(L.b)(function(e,t){var n=t.engagement,r=Object(_i.a)(e);return r?T.createElement(wi,null,T.createElement(Oi,{itemKey:r,engagement:Object(vi.m)({name:"UploadTemplate",isIntentional:!0},n)})):null});function Si(e,t){var n=t&&e.demandItemFacet(k.Ib,h.a.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==R.a.webPageLibrary&&!!n.newWOPIDocumentEnabled}new ie.a("UploadTemplate").id,C.a.UploadTemplate,T.createElement(oe.a,null,T.createElement(ji,{engagement:{name:"UploadTemplate"}}));var Ai={key:new ie.a("AddTemplate").id,automationId:"AddTemplate",name:C.a.AddTemplate,iconProps:{iconName:"Add"},action:T.createElement(oe.a,null,T.createElement(ji,{engagement:{name:"AddTemplate"}}))},ki=new ie.a("editNewMenu").id,Ti=n("h9cA"),Ui=n("BhPz"),Ci=n("Qe+a"),Fi=n("YYzJ"),Pi=n("3SfB"),Ei=Object(i.e)()(function(e){var t=this,n=e.itemKey,i=_.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(a){return e(Object(mr.a)({items:(t={},t[n]=Object(r.__assign)({},k.b.pack(function(){return T.createElement(Ti.a,{documentType:xi(i.templateUrl),templateItemKey:Ci.a.serialize({listKey:i.listKey,templateUrl:i.templateUrl})})})),t)})),[2]})})}});function xi(e){var t=Pi.a.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(Fi.b[r]){case Fi.e:t=Pi.a.OneNote;break;case Fi.f:t=Pi.a.PowerPoint;break;case Fi.c:t=Pi.a.Excel;break;case Fi.g:t=Pi.a.Visio}}}return t}var Di=function(e){var t=e.template,n=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var r,i,a=t.url,o=Ci.a.serialize({listKey:n,templateUrl:a});return{key:new ie.a("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:T.createElement(oe.a,null,T.createElement(Ti.a,{documentType:xi(a),templateItemKey:o})),iconProps:Object(ae.a)({extension:(r=a,i=Object(jn.getFileExtension)(r,!0),Object(Ui.a)(i)),size:16})}};function Li(e,t){var n=t.contentTypes,i=t.newCommandMenu,a=t.fileHandlerCommands,o=t.isCreateFolderAvailable,s=t.newDocumentTemplates,l=t.contentTypeCommands,c=t.listKey,u={},d={},m=function(){var e;return(e={}).NewFolder=te.a,e.NewDOC=mi.g,e.NewXSL=mi.a,e.NewPPT=mi.e,e.NewONE=mi.d,e.NewXSLSurvey=mi.b,e.NewXSLForm=mi.c,e.NewVSDX=mi.f,e}(),p={},b=[],f=[];if(!Ge.Killswitch.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&s&&s.length){if(l)for(var h=0,_=l;h<_.length;h++)(y=_[h]).name&&(u[y.name]=y);if(n)for(var v=0,g=n;v<g.length;v++){var y;u[(y=g[v]).displayName]&&y.contentTypeId&&(d[y.contentTypeId]=u[y.displayName])}var I=i.subMenuProps&&i.subMenuProps.items;if(I)for(var O=0,w=I;O<w.length;O++)(T=w[O]).name&&(m[T.name]=T),T.automationId&&(m[T.automationId]=T);for(var j=void 0,S=0,A=s;S<A.length;S++){var k=A[S];k.isContentType&&k.contentTypeId&&(p[k.contentTypeId]=!0);var T=void 0;if(k.isUpload&&c?T=Di({template:k,listKey:c}):k.isContentType&&k.contentTypeId&&d[k.contentTypeId]?T=d[k.contentTypeId]:m[k.title]?T=m[k.title]:k.templateId&&m[k.templateId]&&(T=m[k.templateId]),T){var U=k.templateId||pi[T.key];"NewFolder"===U&&(j=!0),f.push(Object(r.__assign)(Object(r.__assign)({},k),{templateId:U,command:T})),k.visible&&(b.push(T),m[k.title]&&m[k.title].key===te.a.key&&b.push({name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}))}}for(var C in!j&&o&&te.a.name&&f.unshift({command:te.a,templateId:pi[te.a.key],title:te.a.name,visible:!1}),d)if(d.hasOwnProperty(C)&&!p[C]){var F=d[C];F.name&&f.push({command:F,contentTypeId:C,isContentType:!0,templateId:C,title:F.name,visible:!0}),b.push(F)}}else f=function(e,t){var n=t.contentTypeCommands,r=void 0===n?[]:n,i=t.contentTypes,a=[];t.isCreateFolderAvailable&&te.a.name&&a.push({command:te.a,templateId:pi[te.a.key],title:te.a.name,visible:!0});var o=!(!r||!r.length),s={};if(i)for(var l=0,c=i;l<c.length;l++){var u=c[l];u.contentTypeId&&(s[u.displayName]=u.contentTypeId)}if(o)for(var d=0,m=r;d<m.length;d++)if((_=m[d]).name){var p=s[_.name];a.push({command:_,contentTypeId:p,isContentType:!0,templateId:p,title:_.name||"",visible:!0})}var b=ee.a.subMenuProps&&ee.a.subMenuProps.items;if(b)for(var f=0,h=b;f<h.length;f++){var _;(_=h[f]).name&&-1===[te.a.key,"divider_1","divider_2",Ai.key,ki].indexOf(_.key)&&a.push({command:_,templateId:pi[_.key],title:_.name,visible:!o})}return a}(0,{isCreateFolderAvailable:o,contentTypeCommands:l,contentTypes:n}),l&&l.length?b.push.apply(b,Object(r.__spreadArrays)([te.a,{name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}],l)):b=i.subMenuProps?Object(r.__spreadArrays)(i.subMenuProps.items):[];return a&&a.new&&(b=si(b,a.new)),{visibleNewCommands:Object(r.__assign)(Object(r.__assign)({},ee.a),{subMenuProps:{items:b}}),allCommands:f}}var Ni=n("eVX6"),Ki=n("FYXF");function Ri(e,t){var n,r=t.pageContext,i=t.listFacets,a=t.isODB,o=t.key;if(r&&(i&&i.templateType===R.a.documentLibrary||a)){var s=new Ni.a(o.webAbsoluteUrl||o.listFullUrl).authority+"/_api/v2.0",l=Ki.b.serialize({endpoint:s});n=oi(e,{itemKey:l})}return{fileHandlerCommands:n}}var zi=n("iP7s");function qi(e,t,n,r,i,a,o){return{key:n+r,name:r,action:t(o),iconProps:Gi(e,a,i)}}function Mi(e,t,n,r,i,a,o,s){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:Gi(e,a,i)}}function Gi(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function Vi(e,t,n,r,i,a){return function(e,t,n,r,i,a){if(!a)return[];var o=a.openInClient,s=a.newWOPIDocumentEnabled;return e.map(function(e){var a,l=e.templateUrl,c=e.cTypeId,u=l?l.indexOf("CreateNewDocument.aspx?id="):0,d=e.iconUrl;if(d?-1===d.indexOf("/")&&(d="/"+t.layoutsUrl+"/images/"+d):a=""===e.templateUrl&&e.docSetUrl?"DocumentSet":"Page",u>0&&!o&&s)return n("NewDOC",e.displayName,d,a,l.substring(u+"CreateNewDocument.aspx?id=".length));if(!l)if(l=e.docSetUrl){var m=new Ge.Uri(l),p=i.serverRelativeItemUrl;m.setQueryParameter("RootFolder",p),l=m.toString()}else c&&(l=c);return r("NewCustomType",e,d,a,l,c)})}(e,t,qi.bind(void 0,t.webAbsoluteUrl,r),Mi.bind(void 0,t.webAbsoluteUrl,i),n,a)}function Bi(e,t){var n,r=t.key,i=t.listKey,a=t.listFacets,o=t.pageContext,s=[],l=function(e,t){var n=t.listKey,r=t.listFacets,i=t.pageContext,a=h.a.serialize(n),o=e.demandItemFacet(k.o,a);return!!(i&&!Object(Ge.getKillSwitch)(i).isActivated("2DEF0213-505E-4BB3-8441-19E3AEC0D352","3/19/21a")&&o&&o.length>1&&r.contentTypesEnabled)}(e,{listFacets:a,pageContext:o,listKey:i}),c=p.a.serialize(r),u=e.demandItemFacet(k.o,c);if(u&&u.length&&(u.forEach(function(t){var n=e.demandItemFacet(k.Lc,t);n&&s.push(n)}),(l||!function(e,t){var n=e&&e.length;if(!n)return!0;var r=e[0],i=r.templateUrl,a=i&&i.indexOf("/Forms/template.do")>-1;return!(1!==n||(i||r.docSetUrl)&&!a)||(!t||!t.contentTypesEnabled)&&(!i||a)}(s,a))&&o)){var d=new zi.a({context:{webAbsoluteUrl:r.webAbsoluteUrl,listUrl:r.listFullUrl}}).getUrlParts({path:r.rootFolder});n=Vi(s,o,d,function(t){return r&&e.demandItemFacet(k.b,_.serialize({listKey:i,templateUrl:t}))},function(t){return r&&e.demandItemFacet(k.b,v.serialize({listKey:i,contentTypeId:t}))},a)}return{contentTypes:s,contentTypeCommands:n}}var Hi=n("DxzT"),Wi=n("9HFz"),Ji=new ie.a("getPrintFileUrlOperation"),Zi=new ie.a("universalPrintGetFileUrlItem"),Qi=Object(a.e)({operationTypeFacet:Ji}),Xi=n("gNAT"),Yi=n("7YMn"),$i=new Yi.a("PrintToUniversalPrinterActionControl",{}),ea=n("oD9H"),ta=n("YB5h"),na=new ie.a("universalPrintSharedPrinterListItem"),ra=new f.a("universalPrintSharedPrinterKey",{endpoint:Object(f.f)(),fileType:Object(f.f)()}),ia=new ie.a("universalPrintLicenseCache"),aa=Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(34)]).then(n.bind(null,"Jx+m"))];case 1:return[2,e.sent().UniversalPrint]}})})}),oa=Object(L.b)(function(e,t){var i=t.itemKey,a=t.getPrintFileItem,o=void 0===a?Qi:a;if(!i)return null;var s=e.dispatch,l=e.demandItemFacet($i,i),c=Object(V.a)(e,{graphEndpoint:Wi.h,universalPrintCache:ia}),u=c.graphEndpoint,d=c.universalPrintCache;if(!u)return null;var m=$i.evaluate(l)(e,{itemKey:i,isAvailable:!1}),p=m.isAvailable,b=m.fileType,f=m.fileDisplayName,h=m.fileExtension,_=m.pdfUrlGenerator;if(!f||!b)return null;var v=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return o?[4,s(o({items:(t={},t[i]={pdfUrlGenerator:_},t)}))]:[3,2];case 1:if(n.sent(),e=s(Object(ln.a)(function(e){return e.demandItemFacet(Zi,i)})))return[2,e];n.label=2;case 2:throw new Error("Failed to fetch Print File data")}})})},g=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e(8).then(n.bind(null,"OgJd"))];case 1:return t=r.sent().demandItems,[4,s(t(function(t){return t.demandItemFacet(na,ra.serialize({endpoint:u,fileType:e}))}))];case 2:if(i=r.sent())return[2,i];throw new Error("Failed to fetch list of shared printers")}})})},y=Object(Z.g)(function(e){var t=e.resolve,n=s(ea.a).dataRequestor;return T.createElement(aa,{endpoint:u,onClose:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return t(),[2]})})},fileDisplayName:f,fileExtension:h,fileType:b,getPrintFileData:v,dataRequestor:n,getPrintAuthToken:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,s(Object(ta.a)(["PrinterShare.Read.All","PrintJob.ReadWrite"],u||""))];case 1:if(e=t.sent())return[2,{accessToken:e}];throw new Error("Failed to fetch Print Graph Access Token")}})})},getSharedPrinterList:g,saveUserPreferences:function(e){d&&d.setValue("userpreferernces-"+b,e)},getUserPreferences:function(){if(d)return d.getValue("userpreferernces-"+b)}})});return T.createElement(N.a,Object(r.__assign)({isAvailable:p,onExecute:y},Object(G.b)(e,{itemKey:i,engagement:{name:"PrintToUniversalPrinter",isIntentional:!0}})))}),sa=Object(Xi.b)(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,t(Qi(e))];case 1:return[2,n.sent()]}})})}}),la=Object(L.a)(function(){return{getPrintFileItem:sa}})(Object(D.f)()(Object(D.d)()(oa))),ca=n("z4dx"),ua=n.n(ca),da={key:new ie.a("universalPrint").id,automationId:"universalPrintCommand",action:T.createElement(la,null),name:ua.a.printToUniversalPrinter,title:ua.a.PrintToUniversalPrinterTooltip,iconProps:{iconName:"Print"}},ma=n("4MGu"),pa={ODB:1544},ba=[Xn,Yn,$n],fa=[Dr,Kr],ha=Object(dn.a)()(ga),_a=Object(dn.a)()(ga),va=function(e,t){var n=Object(r.__rest)(ze,[]);return e&&e.open&&e.open.length>0&&(n.subMenuProps=n.subMenuProps||{},n.subMenuProps.items=si(n.subMenuProps&&n.subMenuProps.items||[],e.open,t),!Ge.Killswitch.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})),n};function ga(){return function(e){return function(e,t){return function(e,t){var n,i,a=t.itemKey,o=t.itemSetKey,s=t.commands,l=t.overflowCommands,c=t.farCommands,u=t.shortcutCommands,d=e.demandItemFacet(p.a,a),m=e.demandItemFacet(y.a,o),b=l?Object(r.__spreadArrays)(l):[],f=!0,_=!1,v=void 0,g=void 0,I=void 0,O=s?Object(r.__spreadArrays)(s):[],w=c,j=[],U="",E=d&&h.a.serialize(d),x=e.demandItemFacet(h.a,E);m&&m.viewKey&&(U=m.viewKey.viewId);var D,L,N,K=[],z=!1;if(d&&x){z=Object(di.b)(e,a,d);var q=e.demandItemFacet(k.Ib,E);if(f=!!q&&!!q.isDocumentLibrary,D=Object(xe.a)(e,a),f?j=u?Object(r.__spreadArrays)(u,fa):Object(r.__spreadArrays)(fa):O=be(),!(_=!!q&&q.templateType===R.a.mySiteDocumentLibrary)){f&&b.push.apply(b,ba),b&&b.push(Jn({listFacets:q}));var M={webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},G=S.a.serialize(M),B=e.demandItemFacet(At.a,G);B&&B.itemKeys&&c&&(!U&&D&&D.viewId&&(U=Ge.Guid.normalizeLower(D.viewId,!1)),i=e.demandItemFacet(k.Yb,E),L=c,N=function(e,t){var n,i,a=t.viewKeys,o=t.webAbsoluteUrl,s=t.listViewSetKey,l=t.itemSetKey,c=t.currentViewKey,u=h.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),d=Object(Ee.a)(e,{feature:Pt})&&Ft.some(function(t){return Object(Ee.a)(e,{feature:t})}),m=e.demandItemFacet(k.Ib,u),p=!!m&&!!m.templateType&&Object(R.e)(m.templateType),b=!!m&&!!m.templateType&&m.templateType===R.b.webPageLibrary,f=!1,_=C.a.Views,v=e.demandItem({showViewModifiedIndicator:k.wc,currentDerivedView:k.p,currentViewBasicInfo:k.nd},c),g=v.showViewModifiedIndicator,y=v.currentDerivedView,I=v.currentViewBasicInfo;m&&y&&"POWER"!==y.viewType&&m.permissions&&y.canUserEdit(m.permissions)&&(f=!0),y&&y.title?_=y.title:I&&I.Title&&(_=I.Title),f&&(g||y&&y.isDirty())&&(_=Ve.format(C.a.ViewModifiedIndicator,_));var O=a.map(function(t){var n=e.demandItemFacet(k.uc,t),r=e.demandItemFacet(k.nd,t);return n&&!n.Hidden?Nt(n,0,l,y):r?Nt(r,0,l,y):void 0}).filter(function(e){return!!e}),w=function(e,t){var n=e.demandItemFacet(k.Vb,t);return!(!n||!e.demandItemFacet(ke.x,n))}(e,l),j=function(e,t){var n,i,a=t.isPagesLib,o=t.isList,s=t.itemsNeedAttention,l=t.currentDerivedView,c=t.itemSetKey,u=Me.a;return a&&Object(Ee.a)(e,{feature:{ODB:1743}})?(n=C.a.PagesThatNeedAttention,i="PagesThatNeedAttention"):(n=o?C.a.ItemsThatNeedAttention:C.a.FilesThatNeedAttention,i=o?"ItemsThatNeedAttention":"FilesThatNeedAttention"),{key:bt,automationId:"needsAttentionViewCommand",name:n,iconProps:s?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:Et,action:T.createElement(at,{viewId:u,currentDerivedView:l,itemSetKey:c}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},fe.e.pack(!0)),Tt.pack(!0)),kt.pack(!0)),engagement:{name:i}}}(e,{isList:p,isPagesLib:b,itemsNeedAttention:w,itemSetKey:l,currentDerivedView:y}),U=function(e,t,n){var r=h.a.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(k.o,r),a=[];return i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(k.Wc,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(a=a.concat(r))}),a.length>0}(e,o,s.listFullUrl),F=p&&Object(Ee.a)(e,{feature:jt.b})&&!!e.demandItemFacet(k.Fc,St.a),P=qe.serialize({webAbsoluteUrl:o,listFullUrl:s.listFullUrl}),E=F&&!!(null===(i=null===(n=e.demandItemFacet(At.a,P))||void 0===n?void 0:n.itemKeys)||void 0===i?void 0:i.length),x=C.a.listSyncIssuesViewMenuItem,D=E?{key:Ot,automationId:"itemsWithSyncIssuesViewCommand",name:x,iconProps:E?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:Et,action:P?T.createElement(wt.a,{itemKey:P}):void 0,facets:Object(r.__assign)(Object(r.__assign)({},kt.pack(!0)),Tt.pack(!0))}:void 0,L=y?function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,i=e.listViewSetKey,a=e.itemSetKey,o=e.allowEditCurrentView,s=A.a.serialize({viewId:n.id}),l=S.a.serialize(i),c=o||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:mt,automationId:"createViewCommand",name:C.a.CreateNewView,iconProps:Et,action:T.createElement(xt,{listViewSetKey:l,currentViewKey:s,isEditing:!1}),facets:Object(r.__assign)(Object(r.__assign)({},kt.pack(!0)),Ct.pack(!0))}]:[],[{key:It,automationId:"saveCommand",name:C.a.SaveViewAs,iconProps:Et,action:T.createElement(ut,{listViewSetKey:l,currentViewKey:s}),facets:Object(r.__assign)(Object(r.__assign)({},kt.pack(!0)),Ut.pack(!0))},{key:ft,automationId:"setDefaultViewCommand",name:C.a.SetDefaultView,iconProps:Et,action:T.createElement(dt.a,{currentDerivedView:n,listViewSetKey:i}),facets:Object(r.__assign)(Object(r.__assign)({},kt.pack(!0)),Ut.pack(!0))}],c?[{key:ht,automationId:"customizeViewCommand",name:C.a.CustomizeView,iconProps:Et,action:"MODERNCALENDAR"===n.viewType?T.createElement(xt,{listViewSetKey:l,currentViewKey:s,isEditing:!0}):T.createElement(it,{viewKey:s,itemSetKey:a}),facets:Object(r.__assign)(Object(r.__assign)({},kt.pack(!0)),Ut.pack(!0))}]:[])}({listViewSetKey:s,isCreateNewViewEnabled:d,currentDerivedView:y,itemSetKey:l,allowEditCurrentView:f}):[],N=e.demandItemFacet(k.pd,c),K="MODERNCALENDAR"===N?[{key:gt,isPermanent:!1,automationId:"calendarMonthCommand",name:C.a.calendarMonthTitle,title:C.a.calendarMonthDesc,action:T.createElement(He.a,{layoutType:We.a}),iconProps:{iconName:"calendar"}}]:[],z="KANBAN"===N?[{key:yt,isPermanent:!1,automationId:"kanbanCommand",name:C.a.kanbanLayoutTitle,title:C.a.kanbanLayoutDesc,action:T.createElement(He.a,{layoutType:Je.a}),iconProps:{iconName:"TripleColumn"}}]:[],q=[];if(Be.a.subMenuProps){var M=e.demandItemFacet(k.od,c),G=M&&M.viewFormatter,V=G&&G.isTileDesignerTemplateApplied(),B=G&&G.getTileProps(),H=!!(B&&B.formatter&&B.formatter);if(p&&(V||Object(Ee.a)(e,{feature:{ODB:1396}})&&!H))for(var W=0,J=Be.a.subMenuProps.items;W<J.length;W++){var Z=J[W];Z.key!==nt.d?q.push(Z):q.push(Object(r.__assign)(Object(r.__assign)({},Z),{name:C.a.GalleryLayout,title:C.a.GalleryLayoutCommandTooltip,automationId:"galleryLayoutCommand"}))}else q=Be.a.subMenuProps.items}var Q=[];U&&Q.push(j),E&&D&&Q.push(D),Q.length>0&&Q.push({name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider});var X=Object(r.__spreadArrays)(q,K,z,[{name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}],Q,[Dt,Lt,{name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}],O,[{name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}],L,[{name:"-",key:"divider_1",itemType:ge.ContextualMenuItemType.Divider}]),Y={name:_,key:Be.a.key,automationId:Be.a.automationId,iconProps:Be.a.iconProps,title:C.a.SwitchViewsCommandTitle,ariaLabel:Ve.format(C.a.SwitchViewsCommandAriaLabel,_),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),w||E?{styles:{root:"needsAttentionIconOverlay_817fe717"}}:{})}:{})},subMenuProps:{items:X},facets:Object(r.__assign)({},fe.e.pack(!0))},$=y?Ge.Guid.normalizeLower(y.id,!1):"";return Y.cacheKey=Be.a.key+"_viewId_"+$,Y}(e,{viewKeys:B.itemKeys,webAbsoluteUrl:d.webAbsoluteUrl,listViewSetKey:M,itemSetKey:o,currentViewKey:A.a.serialize({viewId:U})}),w=L.map(function(e){return e.key===Be.a.key?N:e}))}q&&x&&(K=(n=Bi(e,{key:d,listFacets:q,listKey:x,pageContext:D})).contentTypes,v=n.contentTypeCommands),g=function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=ar.a.serialize({webAbsoluteUrl:n,listFullUrl:r}),a=Or({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=Ir(e,i);return a&&(o=o.concat(Ir(e,a))),o}(e,d),D&&q&&(I=Ri(e,{isODB:_,key:d,listFacets:q,pageContext:D}).fileHandlerCommands)}var H=Object(V.a)(e,{enableQuickEdit:k.T,enableUniversalPrint:Wi.e}),W=H.enableQuickEdit,J=H.enableUniversalPrint,Z=!!D&&!!W;if(Z){var Q=Object(Xe.a)(e).itemsScopeItemKey;if(Object(Qe.a)(e,{itemsScopeItemKey:Q})===Ye.a)return{commands:[rr],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var X=function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,a=t.isODB,o=t.contentTypeCommands,s=t.customActionCommands,l=t.fileHandlerCommands,c=t.newDocumentTemplates,u=t.contentTypes,d=t.isCreateFolderAvailable,m=t.listKey,p=t.pageContext,b=t.printEnabled,f=[],h=!Ge.Killswitch.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),_={},v=0,g=r;v<g.length;v++){var y=g[v];_[y.key]=y}for(var I=0,O=r;I<O.length;I++)if((y=O[I]).key===ee.a.key){var w=Li(0,{contentTypes:u,newCommandMenu:y,fileHandlerCommands:l,isCreateFolderAvailable:d,newDocumentTemplates:c,contentTypeCommands:o,listKey:m}).visibleNewCommands;f.push(w)}else if(y.key===Hi.a.key&&n&&!_[ue.b.key])f.push(y,ue.b);else if(y.key===ze.key){var j=va(l,h);f.push(j)}else y.key===P.b.key&&i&&!_[tr.a.key]?f.push(y,tr.a):y.key===F.a.key&&i?(f.push(y),a||_[$.a.key]||f.push($.a),f.push($t,rn)):y.key===P.c.key?(!i&&Object(Ee.a)(e,{feature:pa,pageContext:p})?f.push(P.a):f.push(y),f.push(Rn,zn)):y.key===ma.a.key&&b?f.push(ma.a,da):f.push(y);return s&&s.length>0&&f.push.apply(f,s),l&&l.custom&&l.custom.length>0&&(f=si(f,l.custom)),{overrideDefaultCommands:f}}(e,{defaultCommands:O,isDocumentLibrary:f,isODB:_,contentTypeCommands:v,customActionCommands:g,fileHandlerCommands:I,newDocumentTemplates:i,contentTypes:K,isCreateFolderAvailable:z,quickEditEnabled:Z,listKey:d,pageContext:D,printEnabled:!!J});return{commands:O=X.overrideDefaultCommands,overflowCommands:b,farCommands:w,shortcutCommands:j}}(e,t)}}}var ya=n("e6xE"),Ia=n("Hjbe"),Oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){return this.props.canOpenInOffice?T.createElement(N.a,null):T.createElement(Ia.b,null)},t}(T.PureComponent),wa=Object(L.a)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:k.bc},n).appMap}})(Oa),ja=Object(D.f)()(Object(D.d)()(wa)),Sa={key:he.a.key,automationId:he.a.automationId,name:he.a.name,subMenuProps:{items:[Fe,Ue],contextualMenuItemAs:Ne},facets:Object(r.__assign)({},fe.b.pack(!0))},Aa=(new ie.a("fallbackOpen").id,he.a.name,T.createElement(ja,null),Object(r.__assign)({},fe.b.pack(!0)),n("X59o")),ka=n("77jJ"),Ta=n("t7p+"),Ua=n("2YyJ"),Ca=n("NSZs"),Fa={ODB:1544},Pa=Object(dn.a)()(function(){return function(e){return function(t,n){var i,a=n.itemKey,o=n.commands,s=t.demandItemFacet(p.a,a);if(s){var l=h.a.serialize(s);i=t.demandItemFacet(k.Ib,l)}var c=o?Object(r.__spreadArrays)(o):[];c.push($t,rn);var u=void 0;if(s){var d=s.listFullUrl,m=s.webAbsoluteUrl,b=function(e){var t=e.listFacets,n=Jn({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:Qn,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[er,Xn,Yn,$n,n]}}}({listFacets:i}),f=t.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:m,listFullUrl:d}));if(i&&!i.isDocumentLibrary){c=[me];for(var _=0,v=be();_<v.length;_++){var g=v[_];g.key===P.c.key&&Object(Ee.a)(t,{feature:Fa,pageContext:f})?c.push(P.a):g.key!==$.a.key&&c.push(g)}}c.push(b);var y=ya.a.serialize({webAbsoluteUrl:m,listFullUrl:d}),I=Or({itemCache:t,targetCustomActionSetKey:y,keys:{webAbsoluteUrl:m,listFullUrl:d}});if(c=c.concat(Ir(t,y)),I&&(c=c.concat(Ir(t,I))),f&&i&&(i.templateType===R.a.documentLibrary||i.templateType===R.a.mySiteDocumentLibrary)){var O=new Ni.a(m||d).authority+"/_api/v2.0",w=Ki.b.serialize({endpoint:O});u=oi(t,{itemKey:w})}}var j=!Ge.Killswitch.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),S=!!Object(V.a)(t,{enableUniversalPrint:Wi.e}).enableUniversalPrint;return{commands:Ea(c,u,i&&i.templateType===R.a.mySiteDocumentLibrary,j,S),onMenuOpened:function(){e(function(e){var t=(e(Object(Ua.a)({spLoggerConfiguration:Ca.g})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(Ta.b(n))})}}}}});function Ea(e,t,n,r,i){for(var a=[],o=0,s=e;o<s.length;o++){var l=s[o],c=l.key;if(c===ze.key){var u=t&&t.open||[];u.length>0&&Sa.subMenuProps&&(Sa.subMenuProps.items=si(Sa.subMenuProps.items,u,r)),a.push(Sa)}else a.push(l),c===F.a.key?a.push(ka.a):c===ma.a.key&&(a.push(Aa.a),i&&n&&a.push(da))}return t&&t.custom&&t.custom.length>0?si(a,t.custom):a}var xa=n("jbk0"),Da=Object(dn.a)()(function(){return function(e){return function(e,t){var n=Object(ot.a)(e),i=function e(t,n,i){var a=n,o=i;if(n&&i){var s=t.demandItem({spGroupField:k.Oc,groupValue:k.rb,parentGroupKey:k.ec,groupFilterByValue:k.nb,groupValueDisplayValue:k.qb},n),l=s.spGroupField,c=s.groupValue,u=s.parentGroupKey,d=s.groupFilterByValue,m=s.groupValueDisplayValue;u&&(o=e(t,u.itemKey,i));var p=t.demandItemFacet(y.a,o);if(p){var f=t.demandItemFacet(b.a,n),h=Object(xa.a)(Object(r.__assign)(Object(r.__assign)({},p),f?{viewKey:f.viewKey}:{})),_=d||c;if(void 0!==_&&l&&l.internalName&&l.fieldType){var v=!Ge.Killswitch.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===l.fieldType,g=!Ge.Killswitch.isActivated("e278b853-095c-41f6-a0b9-8ad603442ce7","2/22/2021","Use group display value as the filterDisplays");a=h({filterField:l.internalName,filterValues:[_],filterDisplays:g&&!!m&&[m]||v&&[c||_]||[],filterType:l.fieldType,useLookupId:!1})}}}return a}(e,t.itemKey,n),a=e.demandItem({parentItem:At.f},n).parentItem,o=function(e){var t=this,n=e.stageItem,i=e.parentItemKey;return n?Object(Xi.b)(function(e){var a=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){switch(s.label){case 0:return i&&e(Object(mr.a)({items:(t={},t[o]=Object(r.__assign)({},At.f.pack({itemKey:i})),t)})),[4,e(n({currentItemKey:o,itemsScopeItemKey:a}))];case 1:return s.sent(),[2]}})})}}):void 0}({parentItemKey:a&&a.itemKey,stageItem:t.stageItem});return i?Object(r.__assign)({itemKey:i},o?{stageItem:o}:{}):{}}}}),La=n("Ymtw"),Na=n("EzM5"),Ka=new Na.a("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(At.b,n),i=r&&r.itemKey,a=e.demandItemFacet(At.a,i),o=a&&a.itemKeys;if(o&&1===o.length)return{itemKey:o[0]}}),Ra=Object(dn.a)()(function(){var e=this;return function(){return function(t,i){var a,o=i.itemKey,s=i.stageItem,l=Object(_i.a)(t),c=Object(ot.a)(t),u=t.demandItemFacet(I.a,o);if(u){var d=t.demandItemFacet(p.a,l),m=t.demandItemFacet(La.a,c);d?u.webAbsoluteUrl===d.webAbsoluteUrl&&(a={isToggled:!0}):m&&u.webAbsoluteUrl===m.webAbsoluteUrl&&(a={isToggled:!0})}var b=t.demandItemFacet(Ka,o,{suppressGetItems:!0});return Object(r.__assign)(Object(r.__assign)({},a||{}),b?{itemKey:b.itemKey}:{stageItem:function(t){return function(i){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,a,o,l,c,u;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return o=[Object(r.__assign)({},t)],(l=s)?[4,i(s(t))]:[3,2];case 1:l=d.sent(),d.label=2;case 2:return e=r.__assign.apply(void 0,o.concat([l||{}])).currentItemKey,a=void 0===e?t.currentItemKey:e,[4,n.e(8).then(n.bind(null,"OgJd"))];case 3:return c=d.sent().demandItems,[4,i(c(function(e){return e.demandItemFacet(Ka,a)}))];case 4:return(u=d.sent())?[2,{currentItemKey:u.itemKey}]:[2]}})})}}})}}}),za=n("+jOK"),qa=n("MaEx"),Ma=n("LVBk"),Ga=n.n(Ma),Va=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,a=Object(ot.a)(e),o=void 0;if(r){var s=e.demandItemFacet(p.a,r);s&&(o=p.a.serialize(s))}return{getBreadcrumbItems:function(){var t=[],s={},l=e.demandItemFacet(y.a,a),c=l&&l.filterParams,u=e.demandItemFacet(k.Jc,a),d=u&&u.filterList;if(!u&&c&&(d=za.a.getFilterList(c,void 0,!0)),d&&d.length&&c)for(var m=d.length-1;m>=0;m--){var p=d[m],b=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||Ga.a.EmptyFilterOptionLabel}),f=za.a.formatBreadcrumbFilterValues(b,p.type||"",{booleanFalse:Ga.a.booleanFalse,booleanTrue:Ga.a.booleanTrue}),h=Ba(c,d,m+1),_=(v=Object(qa.a)(e,{folderItemKey:i,currentItemSetKey:a,newFilterParams:h}))?y.a.serialize(v):i;t.unshift({key:p.fieldName,text:f,onClick:n&&_?n(_):void 0})}for(;i&&!s[i];){s[i]=!0;var v,g=e.demandItem({displayName:ke.h,parentFolder:ke.A},i),I=g.displayName,O=g.parentFolder;if(_=(v=Object(qa.a)(e,{folderItemKey:i,currentItemSetKey:a,newFilterParams:""}))?y.a.serialize(v):i,t.unshift({key:i,text:I||"",onClick:n&&_?n(_):void 0}),r&&(r===i||o===i))break;i=O&&O.itemKey||""}return t}}}}});function Ba(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=za.a.addFilterInfo(e,i.fieldName,"",!0)}return e}var Ha=n("wzdx"),Wa=n("48KX"),Ja=n("YHRW"),Za=n("+X3S"),Qa=n("fxG6"),Xa=Za.b.serialize({}),Ya={key:new ie.a("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Za.c,Xa),i=r&&r.draggedItem,a=!i||i.type===Qa.b,o=e.demandItemFacet(Ha.f,n);return{action:a&&o?T.createElement(Wa.a,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(Ja.c)(e.event)||!1}}},$a=n("mUlA"),eo={isAvailable:!1,onExecute:void 0},to=Object(L.a)(function(e,t){var n=t.itemKeys,i=t.groupKey;if(!(e.demandItemFacet(b.a,i)&&n&&n.length>0))return eo;var a=e.demandItem({childItems:At.a},i).childItems,o=a&&a.itemKeys||[],s=!!e.demandItemFacet(b.a,o[0]);if(0===o.length||s)return eo;var l=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===l.length)return eo;var c=l[0],u=e.dispatch;return Object(r.__assign)({isAvailable:!0,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){return e={groupKey:i},[2,u(Object($a.b)({items:Object(on.a)(n,function(){return e})}))]})})}},Object(G.b)(e,{itemKey:c,engagement:{name:"Move",isIntentional:!0}}))})(N.a),no=Za.b.serialize({}),ro={key:new ie.a("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Ha.f,n),i=e.demandItemFacet(Za.c,no),a=i&&i.draggedItem;return{action:a&&a.type!==Qa.a||!r?void 0:T.createElement(to,{itemKeys:a&&a.itemKeys||[],groupKey:n})}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer.draggedItem;return n&&n.type===Qa.a||!1}return!1}}},io=Object(Ze.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(93).then(n.bind(null,"P6Tv"))];case 1:return[2,e.sent().ReorderListItemsActionExecutor]}})})},function(e,t){var n=t.itemKeys,r=t.targetItemKey,i=t.targetItemIndex;return!!Object(ot.a)(e)&&n.length>0&&!!r&&void 0!==i}),ao=Za.b.serialize({}),oo={key:new ie.a("reorderListItemsDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=t.itemIndex,i=e.demandItemFacet(k.Lb,n),a=e.demandItemFacet(ke.l,n),o=e.demandItemFacet(Za.c,ao),s=o&&o.draggedItem,l=s&&s.itemKeys||[],c=l.length>1||1===l.length&&l[0]!==n;return{action:s&&s.type!==Qa.a||!i||!c||a||void 0===r?void 0:T.createElement(io,{itemKeys:l,targetItemKey:n,targetItemIndex:r})}},canHandleEvent:function(e){return function(t){var n,r,i,a,o=null===(n=e.event)||void 0===n?void 0:n.dataTransfer,s=null===(r=o)||void 0===r?void 0:r.dropToPosition;return(null===(a=null===(i=o)||void 0===i?void 0:i.draggedItem)||void 0===a?void 0:a.type)===Qa.a&&void 0!==s||!1}}},so=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(r.__spreadArrays)([Ya,ro],n||[])}}}}),lo=Object(dn.a)()(function(){return function(e){return function(e,t){var n=Object(ot.a)(e)||"",i=e.demandItemFacet(k.f,n),a=t.handlers;return i?{handlers:Object(r.__spreadArrays)([oo],a||[])}:Object(r.__assign)({},t)}}}),co=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:b.a,isDropEnabled:Ha.e},n),i=r.key,a=r.isDropEnabled,o=i&&i.itemSetKey&&p.a.serialize(i.itemSetKey),s=o&&e.demandItemFacet(k.fc,o),l=M.a.hasItemPermission({permissions:s},M.a.insertListItems);if(l){var c=i&&i.itemSetKey&&e.demandItemFacet(k.Ib,h.a.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));l=!!a&&!!c&&!!c.isDocumentLibrary&&c.templateType!==R.a.webPageLibrary}return{isAvailable:l}}}}),uo=n("k7Wg"),mo=Object(L.a)()(Object(W.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(91).then(n.bind(null,"3aip"))];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),po=Object(L.b)(function(e,t){var n,i=t.itemKey,a=e.demandItemFacet(p.a,i),o=!1;if(a&&(n=e.demandItemFacet(k.Yc,K.a.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})))&&!n.isAnonymousGuestUser){var s=e.demandItemFacet(k.fc,i);o=M.a.hasItemPermission({permissions:s},M.a.insertListItems)}var l=Object(Z.g)(function(e){return T.createElement(mo,Object(r.__assign)({},e,t,{pageContext:n}))});return T.createElement(N.a,Object(r.__assign)({isAvailable:o,onExecute:l},Object(G.b)(e,{itemKey:i,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),bo=Object(D.e)()(po),fo=Object(i.e)()(function(e){var t=this,n=e.itemKey,i=v.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,o,s;return Object(r.__generator)(this,function(l){return t=e(Object(dr.a)({listFacets:k.Ib},h.a.serialize(i.listKey))).listFacets,a=uo.a.serialize({listKey:{webAbsoluteUrl:i.listKey.webAbsoluteUrl,listFullUrl:i.listKey.listFullUrl},contentTypeId:i.contentTypeId}),o=!!t&&t.openInClient,e(Object(mr.a)({items:(s={},s[n]=Object(r.__assign)({},k.b.pack(function(){return T.createElement(bo,{contentTypeId:i.contentTypeId,openInClient:o,contentTypeKey:a})})),s)})),[2]})})}}),ho=n("QMTs"),_o=n("NX6U"),vo=n("jj1g"),go=n("qyWO"),yo=Object(i.e)()(function(e){var t=this,n=g.a.deserialize(e.itemKey),i=n.webAbsoluteUrl,a=n.listFullUrl;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,s,l,c,u;return Object(r.__generator)(this,function(d){return t=n(Object(dr.a)({pageContext:k.Yc},K.a.serialize({webAbsoluteUrl:i,listFullUrl:a}))).pageContext,o=n(Object(_o.c)({webAbsoluteUrl:i,listFullUrl:a})).hasTokenProvider,t&&(s=o?void 0:function(e){return n(Object(_o.a)({url:e}))},l=new vo.a({},{pageContext:t,getAuthToken:s}),(c=new go.a).resolveItems({items:(u={},u[e.itemKey]=Object(r.__assign)({},k.bd.pack(l)),u)}),n(c.execute())),[2]})})}}),Io=n("mHc3"),Oo=new ie.a("saveTemplatesToView"),wo=(Object(a.e)({operationTypeFacet:Oo}),n("GbVI")),jo=new Na.a("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(h.a,n);if(i){var a=p.a.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),o=e.demandItemFacet(p.a,a);if(o){var s=Object(xe.a)(e,a),l=e.demandItemFacet(k.Ib,n);if(s&&l){var c=l.templateType===R.a.mySiteDocumentLibrary,u=e.demandItemFacet(k.Yb,n),d=Object(di.b)(e,a,o);Object(Ge.getKillSwitch)(s).isActivated("97F46AEC-F105-436C-9A00-8268455640F0","11/19/20","Folder always available")||(d=!0);var m=Bi(e,{key:o,listFacets:l,listKey:i,pageContext:s}),b=m.contentTypes,f=m.contentTypeCommands,_=Ri(e,{isODB:c,key:o,listFacets:l,pageContext:s}).fileHandlerCommands;return Li(0,{contentTypes:b,newCommandMenu:ee.a,fileHandlerCommands:_,isCreateFolderAvailable:d,newDocumentTemplates:u,contentTypeCommands:f,listKey:i}).allCommands}}}}),So=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,a,o,s,l,c,u,d,m,b,f,_,v,g,y,I,O,w,j;return Object(r.__generator)(this,function(A){if(i=e(Object(dr.a)({deserializedItemKey:p.a,displayName:ke.h},n)),a=i.deserializedItemKey,o=i.displayName,a&&o){if(s=e(Object(dr.a)({contentTypeKeys:k.o},t)).contentTypeKeys,l=[],s&&s.length&&s.forEach(function(t){var n=e(Object(dr.a)({contentType:k.Wc},t)).contentType;n&&l.push(n)}),c=l.length?l[0].contentTypeId:void 0,u=o.replace(/\.[^.]+$/,""),!(d={contentTypeId:c,isUpload:!0,templateId:u,title:u,url:a.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((m=e(Object(dr.a)({defaultView:k.t},t)).defaultView)&&m.viewKey)return b=m.viewKey,f=e(Object(dr.a)({existingTemplates:k.Yb},t)).existingTemplates,_=void 0===f?[]:f,(v=Object(r.__spreadArrays)(_)).length||(g=e(Object(dr.a)({newCommands:jo},t)).newCommands)&&g.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,a=e.visible;v.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:a})}),v.filter(function(e){return e.url===d.url}).length>0||v.push(Object(r.__assign)({},d)),y=h.a.deserialize(t),I=Ci.a.serialize({templateUrl:d.url,listKey:y}),e(Object(mr.a)({items:(O={},O[t]=Object(r.__assign)({},k.Yb.pack(v)),O[I]=Object(r.__assign)({},k.Xb.pack(d)),O)})),[2,e(Object(wo.a)({items:(w={},w[S.a.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})]={views:(j={},j[b]={newDocumentTemplatesJsonString:JSON.stringify(v)},j),qosName:"saveNewTemplatesToDefaultView"},w)}))]}return[2]})})}}),Ao=n("yhcF"),ko=n("H0ge"),To=n("haG3"),Uo=n("ByCU"),Co=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(k.Tb,n,{suppressGetItems:!0}),i=e.demandItemFacet(Uo.a,n);return{isAvailable:!(e.demandItemFacet(To.a,n)||!r&&!i)}}}}),Fo=Object(i.b)(function(){return function(e){e(Object(o.a)(p.a,Ao.a)(Co)),e(Object(a.f)(p.a,ko.b)(Object(i.d)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(79).then(n.bind(null,"jFYS"))];case 1:return[2,e.sent().removeFromOneDriveOperationHandler]}})})})))}}),Po=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(a){return e(Object(mr.a)({items:(i={},i[t]=Object(r.__assign)({},k.Yb.pack(n)),i)})),[2]})})}}),Eo=n("jveB"),xo=n("Sbwo"),Do=n("lxd+");function Lo(e,t){var n=t.itemSetKey,r=e.demandItemFacet(y.a,n);return r&&r.viewKey&&A.a.serialize(r.viewKey)}var No=n("tUiV"),Ko=n("nVPC"),Ro=n("mHvE");Object(Ae.loadStyles)([{rawString:".customTile_76f7b1c2.ms-Tile{-webkit-transform:none !important;transform:none !important;outline-offset:-2px}.customTile_76f7b1c2.ms-Tile--isSelected{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:" !important}.customTile_76f7b1c2.ms-Tile--uninvokable{background-color:transparent !important}.customTile_76f7b1c2.ms-Tile--uninvokable .ms-Tile-link{pointer-events:auto}.customTile_76f7b1c2.ms-Tile--uninvokable .ms-Tile-check{height:auto !important;width:auto !important;right:5px;top:5px;padding:8px 8px 14px 14px}[dir='rtl'] .customTile_76f7b1c2.ms-Tile--uninvokable .ms-Tile-check{padding:8px 14px 14px 8px}.customTile_76f7b1c2.ms-Tile--uninvokable:hover{background-color:transparent !important}.customTile_76f7b1c2.ms-Tile--uninvokable:hover .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_76f7b1c2.ms-Tile--isSelected .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_76f7b1c2 .sp-field-customFormatter{pointer-events:auto}.customTile_76f7b1c2 .customTileFocusZone_76f7b1c2{width:100%;height:100%}\n"}]);var zo=n("0a6r"),qo=n("pML5"),Mo=n("6oVz"),Go=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(r.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){this.props.qosEvent({error:e,errorInfo:JSON.stringify(t)}),this.setState({hasError:!0})},t.prototype.render=function(){return this.state.hasError?null:T.createElement(T.Fragment,null,this.props.children)},t}(T.Component),Vo=n("xkTj");function Bo(e,t){return{enableItemHoverCard:!1}}var Ho=Object(L.a)(function(e,t){var n=Jo(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,a=n.isTileDesignerTemplateApplied,o=n.qosEndPayload;return{customFormatterFeature:r&&e.demandItemFacet(xo.c,xo.b.serialize({})),viewFormatter:r,isGenerated:i,qosEndPayload:o,telemetry:Object(Vo.c)(e).telemetry,isTileDesignerTemplateApplied:a,dispatch:e.dispatch,isDefaultCardEnabled:Object(Ee.a)(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:Object(Ro.a)(e)}})(function(e){var t=T.useMemo(function(){var t=e.telemetry,n=e.qosEndPayload,r=function(){};if(0===e.selectionIndex){var i=new(t(Ge.Qos))({name:"customItemTileRenderQoS"});n&&n.resultType===Ge.ResultTypeEnum.Failure?i.end(n):r=function(e){i&&i.end(e?{resultType:Ge.ResultTypeEnum.Failure,error:e.errorString,extraData:e.extraData}:{resultType:Ge.ResultTypeEnum.Success})}}return{customItemTileRenderQoSEnd:r}},[]).customItemTileRenderQoSEnd;Object(T.useEffect)(function(){b&&b.isTileFormatterAvailable()&&0===y&&(document.querySelectorAll(".sp-card-defaultClickButton")&&t(),_||v.isTileDesignerTemplateApplied?e.dispatch(Object(Do.a)({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(Object(Do.a)({name:"CustomFormatterTileLoad",isIntentional:!0})),b.hasFormatterReferences()&&e.dispatch(Object(Do.a)({name:"FormatterReferenceTile",isIntentional:!0})))},[]);var n=T.useState(!1),i=n[0],a=n[1],o=T.useState([]),s=o[0],l=o[1],c=T.useState(-1),u=c[0],d=c[1],m=e.defaultRender,p=e.customFormatterFeature,b=e.viewFormatter,f=e.isDefaultCardEnabled,h=e.cardDesignerFeatureEnabled,_=e.isGenerated,v=Object(r.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled","isGenerated"]);if(!m)return null;var g=p&&p.tileRenderer,y=v.selectionIndex,I=v.itemKey,O=v.itemSetKey,w=void 0===O?"":O;if(b&&b.isTileFormatterAvailable()&&g){var j=b.shouldHideSelectionInTiles(),S=b.getTileFormatter(),A=T.createElement(Go,{qosEvent:t},T.createElement(m,Object(r.__assign)({},v,h?{href:void 0,invokeSelection:!1}:{},{className:Object(zo.css)(v.className,"customTile_76f7b1c2"),itemName:null,itemActivity:null,foreground:null,isSelectable:!j,selection:j?void 0:v.selection,selectionIndex:j?-1:v.selectionIndex,background:T.createElement(ge.FocusZone,{handleTabKey:ge.FocusZoneTabbableElements.all,direction:ge.FocusZoneDirection.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===ge.KeyCodes.tab){var t=u+1;t<s.length&&s[t]&&(s[t].focus(),d(t),e.stopPropagation(),e.preventDefault())}else d(-1)},className:"customTileFocusZone_76f7b1c2"},T.createElement(g,{rowIndex:y,itemKey:I,itemSetKey:w,formatter:S,qosEvent:t})),onFocus:function(e){a(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");l(t)},onBlur:function(e){a(!1),l([]),d(-1)}})));return f&&S?T.createElement(gi.a,{controlHandlers:No.a.pack(Bo)},A):A}return T.createElement(m,Object(r.__assign)({},v))}),Wo=new Na.a("generatedViewFormatter",function(e,t){var n,r=t.itemKey;if(e.isItemFacetResolved(k.Nb,r)&&r){var i=Lo(e,{itemSetKey:r}),a=e.demandItemFacet(xo.c,xo.b.serialize({})),o=e.demandItemFacet(y.a,r);if(o&&i&&a){var s=e.demandItemFacet(k.Ib,h.a.serialize(o)),l=Object(Ko.b)(e,{mapping:{fieldData:k.bb},itemSetKey:r}),c=Object(Ee.a)(e,{feature:{ODB:522}}),u=Object(Ee.a)(e,{feature:{ODB:1822}}),d=l.map(function(e){return e.fieldData}),m={};if(u){var p=e.demandItem({schema:At.g},r).schema,b=p&&p.columnKeys;b&&c&&(m=Object(Mo.a)(e,b))}var f=s&&s.templateType||R.b.invalidType,_=void 0;if(d&&d.length>0&&f===R.b.genericList){var v=Object.keys(m).length>0?{fieldFormatters:m}:void 0;n=void 0===(_=a.tileDesigner.createDefaultTileProps(d,v))?{resultType:Ge.ResultTypeEnum.Failure,error:"Error generating defaultTileProps",extraData:{fields:JSON.stringify(d)}}:{resultType:Ge.ResultTypeEnum.Success}}var g=Object(Eo.a)({formatter:void 0,fieldFormatters:m,generatedTileProps:_,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:u}});if(g)return{viewFormatter:g.viewFormatter,qosEndPayload:n}}}});function Jo(e,t){var n,r=!1;if(!t)return{viewFormatter:void 0,isGenerated:r,isTileDesignerTemplateApplied:!1,qosEndPayload:n};var i=e.demandItemFacet(k.od,Lo(e,{itemSetKey:t})),a=i&&i.viewFormatter,o=a&&a.getTileProps(),s=Boolean(a&&a.isTileDesignerTemplateApplied());if(s&&(a=e.demandItemFacet(Zo,t)),!(o&&o.formatter&&o.formatter)&&Object(Ro.a)(e)){var l=e.demandItemFacet(Wo,t);a=l&&l.viewFormatter,n=l&&l.qosEndPayload,r=!0}return{viewFormatter:a,isGenerated:r,isTileDesignerTemplateApplied:s,qosEndPayload:n}}var Zo=new Na.a("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(k.od,Lo(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){for(var a=Object(Ko.b)(e,{mapping:{fieldData:k.bb},itemSetKey:n}),o=[],s={},l=0;l<a.length;l++){var c=a[l],u=c.fieldData?c.fieldData.RealFieldName:"";u&&(o.push(c.fieldData),s[u]=c.fieldData)}var d=i&&i.getTileFormatterDesignerConfig(),m=e.demandItemFacet(xo.c,xo.b.serialize({})),p=e.demandItemFacet(y.a,n),b=p&&e.demandItemFacet(k.Ib,h.a.serialize(p)),f=b&&b.templateType||R.b.invalidType,_=Object(Ee.a)(e,{feature:{ODB:522}}),v=Object(Ee.a)(e,{feature:{ODB:1822}});if(m){var g=m.tileDesigner,I=g.encodeTileDesignerConfig,O=g.decodeTileDesignerConfig,w=g.createJSONFromConfig,j=g.shouldExcludeColumnInCards,S=g.encodeTileDesignerConfigForDocLib,A=d&&O(d),T=[],U={};if(_){var C=e.demandItem({schema:At.g},n).schema,F=C&&C.columnKeys;F&&(U=Object(Mo.a)(e,F))}if(A){var P=!1;for(l=0;l<A.columns.length;l++){var E=A.columns[l],x=void 0;switch(E.id){case"LinkTitle":x="Title";break;case"LinkFilename":x="FileLeafRef";break;default:x=E.id}j(s[x],x)?P=!0:T.push(E)}A.columns=T;var D=f===R.b.documentLibrary?S(A,!0):I(A);if(P||_){var L=w(o,D,Object.keys(U).length>0?{fieldFormatters:U}:void 0,f),N=Object(Eo.a)({formatter:JSON.stringify({tileProps:L}),fieldFormatters:U,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:v}});return N&&N.viewFormatter}}}}return i});function Qo(e){return function(){return Object(r.__assign)(Object(r.__assign)({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}var Xo,Yo=n("7ngx"),$o=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.itemSetKey;if(n)return function(e,t){var n=Jo(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=Object(qo.b)(e)?Object(qo.a)(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:Qo(i)}:{};var a=function(e){var t=e&&e.getTileProps(),n=t&&t.width&&t.width>=0?t.width:254;return{height:t&&t.height&&t.height>=0?t.height:340,width:n,disableMarqueeSelection:t&&t.hideSelection}}(n),o=a.height,s=a.width,l=a.disableMarqueeSelection,c=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:Ho,grid:{minRowHeight:o,mode:c},className:"sp-gallery-listContainer",disableMarqueeSelection:l,tileControlHandler:function(){return{desiredSize:{width:s,height:o}}},groupControlHandler:Qo(i)}}(e,n);var r=Object(V.a)(e,{enableMediaTilesInDocumentGroup:k.M}).enableMediaTilesInDocumentGroup;return void 0===r||r?{tileControlHandler:Yo.a}:{}}}}),es=n("4pji"),ts=n("femj"),ns=n("9SeE"),rs=n("te/S"),is={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},as=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")+"/driveItem"},e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e})},e.prototype.getFamily=function(){var e={};return Ge.Features.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},is),{404:!0})}).then(function(e){return e})},e.prototype.getFamilyMembers=function(){var e={};return Ge.Features.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},is),{404:!0})}).then(function(e){return e})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e})},e.prototype.createLink=function(e){var t=this,n=e.itemIds,r=e.type,i=e.scope,a=e.preventDownload,o=e.password,s=e.expiration,l=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:r,scope:i,preventDownload:a,password:o,expiration:s}):this.createBundle(n,l).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:r,scope:i,preventDownload:a,password:o,expiration:s})})},e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,r=t.type,i=t.scope,a=t.preventDownload,o=t.password,s=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:r,scope:i,preventDownload:a,password:o,expiration:s})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.id})},e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(t){var n=""+e.getSharesPathFromItemUrl(t);return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(t){var n=e.getSharesPathFromItemUrl(t)+"/permissions";return this._dataRequestor.send({path:n,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,n=e.itemIds,r=e.recipients,i=e.message,a=e.requireSignIn,o=e.sendInvitation,s=e.roles,l=e.password,c=e.expiration,u=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,a,o,s,l,c):this.createBundle(n,u).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,i,a,o,s,l,c)})},e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,r=t.recipients,i=t.message,a=t.requireSignIn,o=t.sendInvitation,s=t.roles,l=t.password,c=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),r,i,a,o,s,l,c)},e.prototype.getDefaultLink=function(t,n,r){var i={prefer:"getDefaultLink"};return Ge.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(i.prefer+=",ReturnSpecificErrorCode"),n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,i,r):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:r}).then(function(e){return Ge.Promise.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,n){var r={prefer:"getDefaultLink"};return Ge.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(r.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,r,n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return Ge.Promise.wrap([e])})},e.prototype.updatePermissions=function(e,t,n){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,i={roles:[n]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i),getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.value})},e.prototype.updatePermissionsFromItemUrl=function(t,n,r){var i=e.getSharesPathFromItemUrl(t)+"/permissions/"+n,a={roles:[r]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(a),getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var n=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(t,n){var r=e.getSharesPathFromItemUrl(t)+"/permissions/"+n;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,r=e.scope,i=e.preventDownload,a=e.password,o=e.useMultiPart,s=e.expiration,l=n+"/createLink",c=t&&r?{type:t,scope:r,preventDownload:i}:void 0;return(a||""===a)&&(c.password=a),s&&(c.expirationDateTime=s),this._dataRequestor.send({path:l,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(c||{}),getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e})},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e},e.prototype.inviteSingleItem=function(e,t,n,r,i,a,o,s,l,c){var u=e+"/invite",d={recipients:t,message:n,requireSignIn:r,sendInvitation:i,roles:a};return o&&(d.password=o),s&&(d.expirationDateTime=s),this._dataRequestor.send({path:u,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(d),useMultiPart:c,headers:l,getErrorAsMessage:!0,expectedErrorCodes:is}).then(function(e){return e.value})},e}(),os=n("P8RM");!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(Xo||(Xo={}));var ss,ls,cs=Xo,us=n("xkft"),ds=n("h/Eh"),ms=n("dq6a");!function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit"}(ss||(ss={})),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid",e[e.modernFileExplorer=40]="modernFileExplorer",e[e.listsHome=41]="listsHome",e[e.listsIos=42]="listsIos",e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",e[e.officeFeed=44]="officeFeed",e[e.searchUx=45]="searchUx"}(ls||(ls={}));var ps,bs=ls;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(ps||(ps={}));var fs=ps,hs=n("3HEj"),_s=n("bdhH"),vs=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var r=this._sharingContextInformation,i=r.isFolder,a=r.isListSharing,o=r.itemUrl,s=r.listId,l=r.listItemId,c=r.listUrl,u=r.resourceId,d=r.serverRelativeItemUrl,m=r.uniqueId,p=r.webAbsoluteUrl;if(!this.isListSharingKillswitchActive()&&a)return e.build().webByUrl({webUrl:p}).method("Lists",s);if(m){if(s)return e.build().webByUrl({webUrl:p}).segment("lists").method("getbyid",s).method("GetItemByUniqueId",m);var b=i?"GetFolderById":"GetFileById",f={guid:m};return e.build().webByUrl({webUrl:p}).method(b,f).segment("ListItemAllFields")}return c?e.build().webByUrl({listUrl:c}).method("GetListItem",d):o?e.build().webByUrl({webUrl:p}).method("GetFileByUrl",this._encodingFixEnabled()?o:_s.canonicalizeUrl(o)).segment("ListItemAllFields"):s&&l?e.build().webByUrl({webUrl:p}).method("Lists",s).method("GetItemById",l):e.build().webByUrl({webUrl:p}).method("GetListItemByResourceId",u)}var h;h=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var _=e.build().webByItemUrl(h).method("Lists",n);return this.isListSharingKillswitchActive()?_=t.properties.ID?_.method("GetItemById",t.properties.ID):_.method("GetItemByUniqueId",t.properties.uniqueId):t.isRootFolder||(_=t.properties.ID?_.method("GetItemById",t.properties.ID):_.method("GetItemByUniqueId",t.properties.uniqueId)),_},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(this.isListSharingKillswitchActive()?t.ID||t.uniqueId:e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e.prototype.isListSharingKillswitchActive=function(){return Ge.Killswitch.isActivated("0d6f4387-b53c-48b9-aab6-66369291541d","03/27/2020","List sharing changes in odsp-datasources")},e.prototype._encodingFixEnabled=function(){return Ge.Features.isFeatureEnabled({ODB:1331})},e}(),gs=n("71k8"),ys=n("QVYh"),Is=n("4ERF"),Os={ODB:1657},ws=!Ge.Killswitch.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility"),js=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId,r._itemUrlHelper=t.itemUrlHelper||new us.a({},{pageContext:t.pageContext}),r._apiUrlHelper=t.apiUrlHelper||new ds.a({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper}),r._sharingContextInformation=t.sharingContextInformation||void 0,r._sharingDataSourceHelper=new vs({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(hs.a)(r._pageContext);return r._shareUrl=i+"/_api/SP.Web.ShareObject",r}return Object(r.__extends)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}},t.prototype.getSharingInformation=function(e,t,n,r,i,a){var o,s=this,l=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),c="pickerSettings";return t&&(c+=",permissionsInformation"),n&&(c+=",sharingLinkTemplates"),i&&(c+=",addressBarLinkSettings"),o=l.oDataParameter("$Expand",c).toString(),this.getData(function(){return o},function(t){var n=JSON.parse(t);return s._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,this._getExtraData(),a)},t.prototype.emailWithoutPermissioning=function(e,n,r,i){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return a},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var a=[];r.InvitedUsers&&r.InvitedUsers.results&&(a=r.InvitedUsers.results);var o={};if(o.statusCode=r.StatusCode,o.errorMessage=r.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(a),o.itemId=n&&n.id,a.length>0&&(o.invitationLink=a[0].InvitationLink),o.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var s=0,l=r.UsersWithInvalidEmails.results;s<l.length;s++){var c=l[s];o.invalidEmails.push(c.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,a=e;n<a.length;n++){var o=a[n];t.push(o.rawPersonData)}var s={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(s)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var r,i=this,a=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(a){var o=n.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=s.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var a=[];r.InvitedUsers&&r.InvitedUsers.results&&(a=r.InvitedUsers.results);var o={};if(o.statusCode=r.StatusCode,o.errorMessage=r.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(a),o.itemId=n.items[0]&&n.items[0].id,a.length>0&&(o.invitationLink=a[0].InvitationLink),o.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var s=0,l=r.UsersWithInvalidEmails.results;s<l.length;s++){var c=l[s];o.invalidEmails.push(c.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===2..toString()?n.roleValue="role:1073741827":n.roleValue===1..toString()&&(n.roleValue="role:1073741826");var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return a||(s.url=i._sharingDataSourceHelper.getFileUrl(n.items[0])),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case ss.none:case ss.view:case ss.review:case ss.edit:case ss.owner:t=n;break;default:t=ss.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case ss.none:t=0;break;case ss.view:t=1;break;case ss.review:t=6;break;case ss.edit:t=2;break;default:t=1}var a={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?function(e){if(e.d)return Ss(e.d.ShareLink.sharingLinkInfo)}(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(jn.convertDateToISOString)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var i=0,a=e.recipients;i<a.length;i++){var o=a[i];o.rawPersonData&&r.push(o.rawPersonData)}}var s=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){s=[];for(var l=0,c=t.inviteesToRemove;l<c.length;l++){var u=c[l];s.push({id:u.id,loginName:u.loginName,name:u.primaryText,isExternal:u.isExternal,principalType:u.type,email:u.email})}}var d={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};if(s&&(d.request.settings.inviteesToRemove={results:s}),r&&r.length>0){d.request.peoplePickerInput=JSON.stringify(r);var m=e.emailData,p=e.emailSubject;void 0!==m&&void 0===p&&(d.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==p&&(d.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==p&&(d.request.emailData={body:e.emailData,subject:e.emailSubject})}var b=e.settings.shareId;return b&&(d.request.settings.shareId=b,d.request.emailData={body:""}),JSON.stringify(d)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?Ss(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(function(e){var t=Ge.Killswitch.isActivated("fcc930ba-8fe4-4065-b185-8b74488eba20","10/08/2019","SitePagePublishing_FeatureEnabled"),n=Ge.Killswitch.isActivated("1c067c05-41cd-48a7-bf78-bb398a461041","10/15/2019","Check comm site feature instead of template");if(t||n||!e.featureInfo)return Number(e.webTemplate)===gs.b.sitePagePublishing;var r=new Is.a(e.featureInfo);if(r){var i=r.get("SitePagePublishing");return!!i&&i.enabled}return!1}(this._pageContext))return bs.sharePoint;switch(e){case gs.b.teamSite:case gs.b.group:case gs.b.subgroup:case gs.b.sitePagePublishing:return bs.sharePoint;case gs.b.mySite:return bs.odb;default:return Ge.Killswitch.isActivated("49c1f4de-c1fb-47ed-8d4b-695083cb10ef","11/08/2019","Default clientId to SharePoint if unknown for other web templates")?bs.unknown:bs.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],i=0,a=e;i<a.length;i++){var o=a[i];r.push(o.rawPersonData)}var s=null;t.expiration&&(s=Object(jn.convertDateToISOString)(t.expiration));var l={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:s}};return JSON.stringify(l)})},t.prototype._getSharingLinkKind=function(e,t){var n=1;return 6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var n=e.d,r=!!n.permissionsInformation,i=!!n.sharingLinkTemplates,a=Ge.Features.isFeatureEnabled(Os)&&r,o=!!n.addressBarLinkSettings,s=r?this._parseSharingLinks(n.permissionsInformation.links.results,n.directUrl):[],l=i?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results):[],c=o?n.addressBarLinkSettings:null,u=[];if(Ge.Killswitch.isActivated("4681ee55-dadc-4d9b-a53c-30012907318a","5/5/2020","Mark site admins amongst sharing principals")){var d=r?n.permissionsInformation.siteAdmins.results.concat(n.permissionsInformation.principals.results):[];u=this._parseSharingPrincipals(d)}else if(r){var m=n.permissionsInformation.siteAdmins.results,p=n.permissionsInformation.principals.results,b=this._parseSharingPrincipals(m);b.forEach(function(e){return e.isSiteAdmin=!0});var f=this._parseSharingPrincipals(p);u=b.concat(f)}var h=this._getDefaultSharingLink(n.defaultLinkKind,s,n.sharingAbilities),_={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var v=t.properties,g=v.ItemChildCount?parseInt(v.ItemChildCount,10):0,y=v.FolderChildCount?parseInt(v.FolderChildCount,10):0,I=t.type===Ge.ItemType.OneNote?0:g+y,O=this._isPolicyTipFlagSet(t.policyTip,4);_={name:t.name,childCount:I,hasDlpPolicy:O,extension:t.extension,appmap:t.appMap,itemType:t.type}}var w=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||s.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:w,defaultSharingLink:h,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!a&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(s,u),item:_,sharingLinks:s,sharingPrincipals:u,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:fs.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:l,addressBarLinkSettings:c,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch}},t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var a=i[r];a.isActive&&1!==a.sharingLinkKind&&(n=!0)}return n||(n=t.length>0),n},t.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,r=e.linkDetails;return t=ws&&void 0!==r.Scope&&-1!==r.Scope?ks(r.LinkKind,r.Scope):As(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),{allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,description:r.Description,audience:t,expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:Ts(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:n._parseSharingPrincipals(e.linkMembers.results,r.LinkKind),invitees:n._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy),isCreateOnlyLink:r.IsCreateOnlyLink,isAddressBarLink:r.IsAddressBarLink,isUnhealthy:r.IsUnhealthy,status:r.SharingLinkStatus,created:r.Created,trackLinkUsers:r.TrackLinkUsers}});return(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:fs.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),r},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case fs.anyone:t+=30;break;case fs.organization:t+=20;break;case fs.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case ss.edit:t+=3;break;case ss.review:t+=2;break;case ss.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e){var t=this;return e.map(function(e){var n,r,i=e.linkDetails;null!==i&&(r=ws&&void 0!==i.Scope&&-1!==i.Scope?ks(i.LinkKind,i.Scope):As(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),n={allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,audience:r,expiration:i.Expiration?new Date(i.Expiration):null,description:i.Description,isActive:i.IsActive,isEdit:Ts(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(i),shareId:i.ShareId,sharingLinkKind:i.LinkKind,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:t._parseSharingPrincipal(i.PasswordLastModifiedBy)});return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e){var t=e.Invitations;if(!t)return[];for(var n=[],r=0,i=t.results;r<i.length;r++){var a=i[r];a&&a.invitee&&n.push(a.invitee)}return n.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(ys.getUserPhotoUrl)(t.email)}})},t.prototype._parseSharingPrincipals=function(e,t){var n=e.map(function(e){var n=e.principal;n||(n=e);var r={id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(ys.getUserPhotoUrl)(n.email),email:n.email};return t&&(r.sharingLinkKind=t),r});return vs.getUniqueSharingPrincipals(n)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:cs[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;return t||(t=e),{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:Object(ys.getUserPhotoUrl)(t.email),email:t.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n){n.peopleSharingLinkAbilities&&(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;ws&&n.anyoneLinkAbilities?(5!==r||n.anyoneLinkAbilities.canManageEditLink.enabled||(r=4),4!==r||n.anyoneLinkAbilities.canManageReadLink.enabled||(r=3)):(5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4),4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3)),n.organizationLinkAbilities&&(3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2),2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1));var i=void 0;return 5===e||4===e?i=fs.anyone:3===e||2===e?i=fs.organization:1===e?i=fs.specificPeople:6===e&&(i=fs.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(ms.b);function Ss(e){var t;t=ws&&void 0!==e.Scope&&-1!==e.Scope?ks(e.LinkKind,e.Scope):As(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:Ts(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function As(e,t,n){return 5===e||4===e?fs.anyone:3===e||2===e?fs.organization:1===e?fs.specificPeople:6===e?t?fs.anyone:!1===n?fs.organization:fs.specificPeopleFlex:void 0}function ks(e,t){return 5===e||4===e?fs.anyone:3===e||2===e?fs.organization:1===e?fs.specificPeople:6===e?0==t?fs.anyone:1===t?fs.organization:fs.specificPeopleFlex:void 0}function Ts(e){return 5===e||3===e||4!==e&&2!==e&&null}var Us=function(){function e(e){this._dataSource=e.sharingDataSource||new js({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return t._invalidateItem(e.items[0]),n})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateItem(e.item),n})},e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return r._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var a=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){return a._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}(),Cs=n("Gpga"),Fs=n("7qB6"),Ps=n("XgPe"),Es=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(function(e){return function(e){function t(t){var n=t.context,i=void 0===n?{}:n,a=t.userAuthToken,o=t.userId,s=(t.context,Object(r.__rest)(t,["userAuthToken","userId","context"])),l=a&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(a),c=l&&l.puid?"Business":"Unknown",u=l&&l.app_displayname||"Unknown",d=l&&l.appid||"Unknown",m=function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""}(o,l,c),p=m?1:0,b=l&&l.tid||"Unknown";return e.call(this,Object(r.__assign)({context:Object(r.__assign)({AccountType:c,AppName:u,AppId:d,IsAuthenticated:p,SiteSubscriptionId:b,UserId:m},i)},s))||this}return Object(r.__extends)(t,e),t}(e)}(function(e){function t(t){var n=t.context,i=void 0===n?{}:n,a=t.accountType,o=void 0===a?"Unknown":a,s=t.clientName,l=void 0===s?"Unknown":s,c=t.cloudType,u=void 0===c?"Unknown":c,d=t.correlationId,m=t.environment,p=void 0===m?t.ariaEnvironment||"prod":m,b=t.isAuthenticated,f=void 0===b?"NA":b,h=t.language,_=void 0===h?i.Market:h,v=t.scenario,g=void 0===v?"Unknown":v,y=t.siteSubscriptionId,I=void 0===y?"Unknown":y,O=t.userId,w=void 0===O?"Unknown":O,j=t.version,S=void 0===j?"Unknown":j,A=t.tenantToken,k=void 0===A?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":A,T=(t.context,Object(r.__rest)(t,["accountType","clientName","cloudType","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,Object(r.__assign)({tenantToken:k,context:Object(r.__assign)({AccountType:o,ClientName:l,CloudType:u,CorrelationId:d,Environment:p,IsAuthenticated:f,IsSharedControl:!0,Market:_,Scenario:g,Session:Fs.b(),SiteSubscriptionId:I,UserId:w,Version:S,Workload:"SharedControls"},i)},T))||this}return Object(r.__extends)(t,e),t}(Object(Ps.a)()(Cs.a)))),xs=n("vVnv"),Ds=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(Object(xs.a)()(Es)),Ls=n("UHMa"),Ns={ODC:"ODCSharingHostUserId",ECS:73732},Ks=function(){function e(e){if(this._iframe=document.createElement("iframe"),this._form=document.createElement("form"),this._formInput=document.createElement("input"),this._signal=new jn.Signal,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._manager=Object(Ge.createManager)(),this._sessionQos=new(Ge.Qos.withManager(this._manager))({name:"SharingSession."+cs[e.context.mode||cs.share]}),!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");switch(e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var t=this._props.isConsumer,n={clientName:this._context.clientId,userAuthToken:this._context.authToken};if(t&&!Ge.FeatureOverrides.isFeatureEnabled(Ns)&&(this._context.userId?n.userId=this._context.userId:n.accountType="ConsumerAnonymous"),new Ds(n).attach(this._manager),!this._iframeUrl){var r=t?"&consumer=true":"";this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale+r}this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe),t&&(this._initializeForm(),e.element.appendChild(this._form))}return e.prototype.initializeUI=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,a,o,s,l,c=this;return Object(r.__generator)(this,function(u){return e=this._context&&this._context.correlationId,t=this._props.isConsumer,n=this._context.mode===cs.copy&&"teams"===this._context.clientId&&!this._context.shareId,i=n?this._getDefaultLink():Promise.resolve(void 0),a=t?Promise.resolve(void 0):this._getSharingInformation(),o=t?Promise.resolve(void 0):this._signal.getPromise(),this._isShareReady=!1,Promise.all([this._toTuple(i),this._toTuple(a),this._toTuple(o)]).then(function(n){var i=n[0],a=n[1];n[2];try{var o=!1;if(!t){var s=c._props.options.onError;if(c._isError(i)&&(o=!0,s&&s({name:"SharePrefetchError",message:"",error:i.error,resultCode:Ge.Promise.isCanceled(i.error)?"Canceled":Object(Ls.e)(i.error)})),c._isError(a)){o=!0;var l=a.error,u={code:l.code,status:l.status};s&&s({name:"SharePrefetchError",message:"",error:l,resultCode:Ge.Promise.isCanceled(a.error)?"Canceled":"["+u.status.toString()+"] "+(u.code||"Unknown")})}}var d=c._iframe.contentWindow;if(d&&!t){var m=c._props.options.spRestTokenProvider,p=Object(r.__assign)(Object(r.__assign)({},c._context),{rawInvite:i.value,sharingInformation:a.value,hasTokenProvider:!!m&&!!m.getAuthToken});d.postMessage(p,c._iframeUrl)}else t?(c._formInput.value=JSON.stringify(c._context),c._form.submit()):o||c._sessionQos.end({resultType:Ge.ResultTypeEnum.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:c._elementWindow.document.body.contains(c._iframe),messagesReceived:Object.keys(c._messagesReceived).join(","),mode:c._context.mode,correlationId:e}})}catch(t){c._sessionQos.end({resultType:Ge.ResultTypeEnum.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}}),this._props.disableIframeDomainCheck||(s=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout,setTimeout(function(){if(!c._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=c._props.options&&c._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach "+c._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:t}),c._sessionQos.end({resultType:Ge.ResultTypeEnum.ExpectedFailure,resultCode:t,extraData:{mode:c._context.mode,iframeBaseUrl:c._iframeBaseUrl,correlationId:e}}),clearTimeout(c._timeoutId)},t.src=c._iframeBaseUrl+"/favicon.ico?"+Math.random()}},s)),l=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return Object(r.__awaiter)(c,void 0,void 0,function(){var t,n,o,s,c,u,d,m,p,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a];case 2:return o=r.sent(),n=!!o,[3,4];case 3:return s=r.sent(),t=s,[3,4];case 4:u=!1,r.label=5;case 5:return r.trys.push([5,7,,8]),[4,i];case 6:return d=r.sent(),u=!(!d||!d),[3,8];case 7:return m=r.sent(),c=m,[3,8];case 8:return p={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:n,getSharingError:t,inviteHasData:u,inviteError:c,timeout:l,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e},this._showShareUX(),(b=this._props.options&&this._props.options.onTimeout)&&b(),this._sessionQos.end({resultType:Ge.ResultTypeEnum.Failure,resultCode:"timeout",extraData:p}),[2]}})})},l),[2]})})},e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:Ge.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e=new os.b({},{urlDataSource:{getApiBaseUrl:function(){return i._context.webAbsoluteUrl+"/_api/v2.0"}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return Ge.Promise.resolve({accessToken:i._context.authToken})}},apiEvent:jn.Api.withManager(this._manager)}),t=new as({},{dataRequestor:e}),n=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(n=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",n,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",n,!this._props.disableUseMultiPart)];case 1:return[2,{value:r.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,n=this._manager,i=new js({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(i){function a(r){return i.call(this,r,{pageContext:e,apiEvent:jn.Api.withManager(n),tokenProvider:t})||this}return Object(r.__extends)(a,i),a}(Ge.DataRequestor),tokenProvider:t}),a=new Us({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:i}),o=this._context.mode===cs.copy||this._context.mode===cs.linkSettings;return a.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.name="shareFrame",this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},this._iframe.src=this._iframeUrl,this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0",t&&(t.margin&&(this._iframe.style.margin=t.margin),t.minWidth&&(this._iframe.style.minWidth=t.minWidth),t.minHeight&&(this._iframe.style.minHeight=t.minHeight))},e.prototype._initializeForm=function(){this._form.target="shareFrame",this._form.method="POST",this._form.action=this._iframeUrl,this._form.style.display="none",this._formInput.type="text",this._formInput.name="context",this._form.appendChild(this._formInput);var e=document.createElement("input");e.type="submit",this._form.appendChild(e)},e.prototype._showShareUX=function(){this._isShareReady=!0,this._iframe.style.visibility="visible",this._iframe.style.height=(this._iframeHeight||400)+"px",this._iframe.style.width=(this._iframeWidth||320)+"px",clearTimeout(this._timeoutId)},e.prototype._receiveMessage=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,a,o,s,l,c,u,d,m,p,b,f,h,_,v,g,y,I;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this._context&&this._context.correlationId;try{n=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,this.dispose(),[2]}catch(e){}switch(i=n.name,this._messagesReceived[i||""]=!0,i){case"share_scriptsLoaded":return[3,1];case"share_resize":return[3,2];case"share_started":return[3,3];case"share_ready":return[3,4];case"share_error":return[3,5];case"share_completed":return[3,6];case"share_dismiss":return[3,7];case"share_manageAccessClicked":return[3,8];case"share_linkSettingsCompleted":return[3,9];case"share_grantAccessCompleted":return[3,10];case"share_getToken":return[3,11]}return[3,18];case 1:return this._scriptsLoadedTime=new Date,this._signal.complete(),(a=this._props.options&&this._props.options.onScriptsLoaded)&&a(),[3,18];case 2:return(o=this._props.options&&this._props.options.onResize)&&n.width&&n.height&&o(n.width,n.height),this._iframeWidth=n.width||320,this._iframeHeight=n.height||400,this._isShareReady&&(this._iframe.style.height=this._iframeHeight+"px",this._iframe.style.width=this._iframeWidth+"px"),[3,18];case 3:return(s=this._props.options&&this._props.options.onStarted)&&s(),[3,18];case 4:return this._showShareUX(),l={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:t},this._sessionQos.end({resultType:Ge.ResultTypeEnum.Success,extraData:l}),(c=this._props.options&&this._props.options.onReady)&&c(),[3,18];case 5:return this._showShareUX(),u=this._props.options&&this._props.options.onError,d=JSON.parse(n.debugErrorMessage||"{}"),m=d.code||d.status||"ShareError: ["+n.error+"]",this._sessionQos.end({resultType:Ge.ResultTypeEnum.Failure,resultCode:m,extraData:{correlationId:t}}),u&&u({name:"SharePrefetchError",message:n.errorMessage||"",error:n.error,debugErrorMessage:n.debugErrorMessage,errorMessage:n.errorMessage,resultCode:m}),[3,18];case 6:return(p=this._props.options&&this._props.options.onCompleted)&&p({scope:n.scope||""}),[3,18];case 7:return(b=this._props.options&&this._props.options.onDismiss)&&b(),[3,18];case 8:return(f=this._props.options&&this._props.options.openManageAccess)&&f(),[3,18];case 9:return(h=this._props.options&&this._props.options.onLinkSettingsComplete)&&h(n),[3,18];case 10:return _=this._props.options&&this._props.options.onGrantAccessComplete,n.successful&&_&&_(),[3,18];case 11:if(v=new Ge.Qos({name:"SharingSession.GetToken"}),!(g=this._iframe.contentWindow))return v.end({resultType:Ge.ResultTypeEnum.Failure,error:"no_window"}),[3,18];if(!this._props.options.spRestTokenProvider||!this._props.options.spRestTokenProvider.getAuthToken)return[3,16];r.label=12;case 12:return r.trys.push([12,14,,15]),[4,this._props.options.spRestTokenProvider.getAuthToken(n)];case 13:return(y=r.sent())?(g.postMessage(JSON.stringify({name:"share_newToken",token:y}),this._iframeUrl),v.end({resultType:Ge.ResultTypeEnum.Success})):(g.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),this._iframeUrl),v.end({resultType:Ge.ResultTypeEnum.Failure,error:"no_token"})),[3,15];case 14:return I=r.sent(),g.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:I}),this._iframeUrl),v.end({resultType:Ge.ResultTypeEnum.Failure,error:String(I)}),[3,15];case 15:return[3,17];case 16:g.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),v.end({resultType:Ge.ResultTypeEnum.Failure,error:"no_handler"}),r.label=17;case 17:return[3,18];case 18:return[2]}})})},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}(),Rs=n("lBoR"),zs=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=Object(V.a)(e,{graphTokenProvider:Rs.a,spRestTokenProvider:k.ed,logger:Ca.g}),a=i.graphTokenProvider,o=i.spRestTokenProvider,s=i.logger,l=Object(xe.a)(e,n),c=l&&(l.env2||l.env),u=s&&s.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,i=e.sharingInformation,s=e.onError,l=n.defaultRecipients,d=n.itemName,m=n.locale,p=n.mode,b=n.openManageAccess,f=n.theme,h=n.getClientId,_=i.authToken,v=i.isListSharing,g=i.listId,y=i.serverRelativeItemUrl,I=i.shareItemKey,O=i.webAbsoluteUrl,w=h(),j={authToken:_||"",clientId:w,defaultRecipients:l,itemName:d,mode:Number(p),theme:f||Object(ge.getTheme)(),webAbsoluteUrl:O||""},S={};if(I&&rs.a.matches(I)){var A=rs.a.deserialize(I);S={listId:A.listId,uniqueId:A.uniqueId,webAbsoluteUrl:A.webAbsoluteUrl}}else{var k=""+new q.a(O).authority+y;v&&w===Ca.a[Ca.a.listsHome]&&(u="list"),S={isListSharing:v,itemUrl:k,listId:g,scenarioId:u}}new Ks({element:t,environment:c||ns.a.prod,locale:m,context:Object(r.__assign)(Object(r.__assign)({},j),S),options:{onError:s,openManageAccess:b,graphTokenProvider:a,spRestTokenProvider:o}}).initializeUI()}}}}}),qs=n("69Re"),Ms=n("Vsn0"),Gs=Object(dn.a)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(p.a,r),a=i&&K.a.serialize(i),o=t.demandItemFacet(k.Yc,a),s=t.demandItemFacet(k.kd,r),l=t.demandItemFacet(ke.e,r),c=i&&i.listFullUrl,u=i&&i.webAbsoluteUrl,d=t.demandItemFacet(ke.j,r);return{checkInAction:T.createElement(Gn,{checkInOutType:"checkIn"}),undoCheckOutAction:T.createElement(Gn,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(_o.c)({webAbsoluteUrl:u||"",listFullUrl:c})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:s,Operation:"RecommendationActedOn",AffectedResourceUrl:l,ItemType:"File",json:JSON.stringify({FileName:d&&d.name,Scenario:"RecommendedActions",SourceRelativeUrl:c,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:d&&d.name,SourceFileExtension:d&&d.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},a=new Ge.Uri(u+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:a.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}}),Vs=n("jWWb"),Bs=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.signalData,i=t.itemKey;if(n&&i&&n.key===Vs.b.key){var a=e.demandItemFacet(k.Wb,i),o=e.demandItemFacet(p.a,i),s=o&&K.a.serialize(o),l=e.demandItemFacet(k.Yc,s);if(!a||!l||l.listBaseTemplate!==R.b.webPageLibrary)return{};var c=l&&Object(Ge.getKillSwitch)(l);if(!c||!c.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight")){var u=e.demandItemFacet(k.id,i),d=e.demandItemFacet(k.Sb,i),m=Object(Un.b)(e,i),b=!!c&&c.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),f=_n.a.publishNowAction,h=0,_=Vs.b.signal,v=_n.a.pageNeedsRepublishing;if(d)f=_n.a.submitNowAction;else if(!b&&m)f=_n.a.scheduleAction,h=1,_=Vs.a.signal,v=_n.a.pageNeedsScheduling;else if(u){var g=Math.floor(Number(u)/512);f=0===g?_n.a.publishNowAction:_n.a.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?T.createElement(Z.c,{action:T.createElement(Pn,{itemKeys:[i],publishType:h,source:"FileCard"})},function(n){var i=n.isAvailable,a=n.execute,o=i?function(){a()}:void 0,s=Object(r.__assign)(Object(r.__assign)({},e),{actionName:f,action:o,content:v,signal:_});return t(s)}):null}}}return{}}return{}}}}),Hs=n("eJ+/"),Ws=n("IP18"),Js={key:new ie.a("manageAccess").id,automationId:"manageAccessCommand",name:x.a.ManageAccess,title:x.a.ManageAccessCommandTooltipV3,action:T.createElement(oe.b,null,T.createElement(Ws.b,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(r.__assign)({},fe.d.pack(!0))},Zs=!Ge.Killswitch.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),Qs=Object(dn.a)()(function(){return function(e){return Ys}}),Xs=[he.a,P.c,P.b,Js];function Ys(e,t){var n=$s(e,t.itemKey);return{commands:function(e,t){return e.map(function(e){return e.key===he.a.key?va(t,Zs):e})}(Xs,n)}}function $s(e,t){var n,r=e.demandItemFacet(To.a,t);if(r){var i=new Ni.a(r.tenantRootUrl).authority+"/_api/v2.0",a=Ki.b.serialize({endpoint:i});n=oi(e,{itemKey:a})}return n}var el=!Ge.Killswitch.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),tl=[he.a,P.c,P.b],nl=Object(dn.a)()(function(){return function(e){return rl}});function rl(e,t){var n=$s(e,t.itemKey);return{commands:Ea(tl,n,!0,el,!1)}}var il=n("YJze"),al=n("FGZj"),ol=n.n(al),sl=n("KahQ"),ll=n("HHDc"),cl=n("/b/P"),ul=n("YU8+"),dl=n("TwCr"),ml=n("P3yH"),pl=n("RMbO"),bl=n("JwLT"),fl=n("YFmE"),hl=n("iD+X"),_l=Object(ml.a)({key:ul.d,name:ol.a.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:dl.d},[pl.a,hl.a,function(e,t){var n=t.itemKey,r=t.renderer,i=e.demandItemFacet(ke.A,n),a=i&&e.demandItemFacet(ke.z,i.itemKey)||"",o=a?function(e){for(var t=[],n=0,r=new Ni.a(e).segments.slice(1);n<r.length;n++){var i=r[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}(a):[],s=i&&a?Object(cl.d)(e,T.createElement(ll.a,{itemKey:i.itemKey})):null;return{renderer:function(e,t,n){var i=r?r(e,t,n):null;return T.createElement(T.Fragment,null,i?T.createElement(T.Fragment,{key:"content"},i):null,s?T.createElement(Z.c,{key:"path",action:s},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return T.createElement(sl.a,{displayPathSegments:o,parentLink:a,onClick:n})}):null)}}},bl.a,fl.a]),vl=n("UfrX"),gl=Object(dn.a)()(function(){return function(e){return Il}}),yl=[il.a,_l,vl.a];function Il(e,t){return{columns:yl}}var Ol=n("jG4Q"),wl=n("gwT8"),jl=n("zwgV"),Sl=n("92QW"),Al=n.n(Sl),kl=n("6Pju"),Tl=n("c5SI"),Ul=Object(i.e)()(function(e){var t=this,n=e.itemKey,i=To.a.deserialize(n).tenantRootUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c;return Object(r.__generator)(this,function(u){switch(u.label){case 0:return t=Object(kl.c)({webAbsoluteUrl:i}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite"),[4,e(Object(_o.b)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:i,noRedirect:!0}))];case 1:if(!((a=u.sent())&&a.d&&a.d.mySite))throw new wl.a({facets:Object(r.__assign)({},Tl.l.pack({}))});return o=a.d.mySite.replace(/\/$/,""),s=jl.a.serialize({webAbsoluteUrl:o||i}),(l=new go.a).resolveItems({items:(c={},c[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},At.b.pack({itemKey:s})),ke.h.pack(Al.a.sharedByYou)),ke.l.pack({})),c)}),e(l.execute()),[2]}})})}}),Cl=n("4qcU"),Fl=n("s9rn"),Pl=n("IG76"),El=n("SU1E"),xl=n("rmG/"),Dl=n("3EBU"),Ll=n("SVzk"),Nl=n("XgrP"),Kl=n("7/ho"),Rl=n("DOzE");function zl(e,t){var n=[];return e.d.results.forEach(function(e){var i,a,o,s,l=""+new Ni.a(e.SiteUrl).authority+e.UrlPath,c=e.LinkingUrl?e.LinkingUrl:l,u=Pl.a.serialize({itemFullUrl:l});n.push(u);var d=Object(jn.iso8601DateTimeToJsDate)(e.Modified),m=function(e){var t,n=(t=e,""+new jn.SimpleUri(t).authority+new jn.SimpleUri(t).segments.slice(0,-1).join("/")),r={itemFullUrl:n};return{parentItemUrl:n,parentItemKey:Pl.a.serialize(r)}}(l),p=m.parentItemKey,b=m.parentItemUrl;t.mapKeys({mappings:(i={},i[Pl.a.serialize({itemFullUrl:b})]=p,i)});var f=function(e,t){var n=3,r=!1,i=!1;return e.IsContainer&&(n=xl.a.folder,i=!0),"OneNote.Notebook"===e.ProgId&&(r=!0),{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}}(e),h=e.SpItemUrl?Object(Ll.a)(e.SpItemUrl):void 0;if(h)for(var _=0,v=Object(Ll.b)(h);_<v.length;_++){var g=v[_];t.mapKeys({mappings:(a={},a[g]=u,a)})}var y=e.Editor,I=El.a.serialize({id:y.email}),O={itemKey:I,displayValue:y.name};t.resolveItems({items:(o={},o[I]=Object(r.__assign)(Object(r.__assign)({},ke.h.pack(y.name)),Fl.a.pack(y.email)),o)}),t.resolveItems({items:(s={},s[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ke.h.pack(e.FileLeafRef)),ke.s.pack(!0)),ke.j.pack({name:e.FileLeafRef,extension:e.Extension})),qn.a.pack(f.fileIconType)),ke.f.pack(d.getTime())),ke.e.pack(l)),ke.A.pack({itemKey:p})),ke.y.pack(O)),qn.e.pack(f.isOneNote?{}:void 0)),ke.l.pack(f.isFolder?{}:void 0)),ke.z.pack(c)),Rl.a.pack(h)),k.Lb.pack(e.ListItemId.toString())),e.UniqueId?k.kd.pack(Object(Fs.c)(e.UniqueId,!1)):{}),e.ListId?k.Kb.pack(Object(Fs.c)(e.ListId,!1)):{}),h?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ke.c.pack({itemKey:Nl.a.serialize({driveItemKey:h})})),ke.m.pack({itemKey:Kl.a.serialize({driveItemKey:h})})),ke.a.pack({itemKey:Dl.a.serialize({driveItemKey:h})})):{}),Object(Cl.a)().forFacet(ke.h).thenInvalidate(u,At.a).pack()),s[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ke.l.pack({})),ke.e.pack(b)),ke.z.pack(b)),s)})}),n}var ql=n("gah9"),Ml=n("JWF0"),Gl=Object(i.e)()(function(e){var t=this,n=e.itemKey,i=jl.a.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return t=(t=Object(kl.d)({webAbsoluteUrl:i,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"}),a=t.toString(),[4,e(Object(_o.b)({url:a,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i}))];case 1:return o=p.sent(),s=new go.a,l=zl(o,s),c=""+new jn.SimpleUri(i).authority,u=To.a.serialize({tenantRootUrl:c}),o.d.__next&&(d=ql.a.serialize({itemSet:jl.a.deserialize(n),after:o.d.__next}),l.push(d),s.merge(Object(Ml.b)({itemKey:d}).itemResolver)),s.resolveItems({items:(m={},m[n]=Object(r.__assign)(Object(r.__assign)({},At.a.pack({itemKeys:l})),At.f.pack({itemKey:u})),m[u]=Object(r.__assign)({},Object(Cl.a)().forFacet(At.b).thenInvalidate(n,At.a).pack()),m)}),e(s.execute()),[2]}})})}}),Vl=Object(i.e)()(function(e){var t=this,n=e.itemKey,i=ql.a.deserialize(n).after,a=ql.a.deserialize(n).itemSet;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,s,l,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,e(Object(_o.b)({url:i,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:a.webAbsoluteUrl}))];case 1:return t=r.sent(),o=jl.a.serialize(a),s=new go.a,l=zl(t,s),t.d.__next&&(c=ql.a.serialize({itemSet:a,after:t.d.__next}),l.push(c),s.merge(Object(Ml.b)({itemKey:c}).itemResolver)),s.merge(Object(Ml.a)({itemKey:n,itemSetKey:o,childItemKeys:l}).itemResolver),e(s.execute()),[2]}})})}}),Bl=n("IX5e"),Hl=n("+tFs"),Wl=n("rz5G"),Jl=n("OMa8"),Zl=n("Ti5N"),Ql=Object(dn.a)()(function(){return function(e){return function(e,t){return function(e,t){var n=t.itemKey,i=Object(V.a)(e,{enableItemActivityField:k.I}).enableItemActivityField,a=e.demandItemFacet(k.ib,n),o=i&&Object(cl.d)(e,T.createElement(Zl.a,{itemKey:n,isCompact:!0,hideDate:!0}))||a&&T.createElement(Jl.a,{text:a}),s=e.demandItemFacet(k.Tb,n);return Object(r.__assign)(Object(r.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return s?{folderCoverAs:Xl}:{}}})}(e,t)}}});function Xl(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?T.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var Yl=n("pG+u"),$l=n("ImEp"),ec=n("jCHr"),tc=n("Ti3E"),nc=n("wJkO"),rc=n("SJhz"),ic=n("baHJ");function ac(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],a=n[".hasThumbnail"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"thumbnail"});if("True"===a&&i)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(ic.c)(i,o)+"&"+Object(rt.a)(n)}}}var oc=Object(i.e)({maxParallelOperationCount:16})(function(e){var t=this,n=tc.a.deserialize(e.itemKey).itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,o,s;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,i(Object(nc.a)(function(e){var t=e.demandItemFacet(p.a,n),r=t&&h.a.serialize(t);return{generator:ac({listMediaTransformSchema:e.demandItemFacet(rc.b,r),itemMediaTransformSchema:e.demandItemFacet(rc.a,n)})}}))];case 1:return t=l.sent().generator,(a=new go.a).resolveItems(((o={items:(s={},s[e.itemKey]=Object(r.__assign)({},rc.c.pack(t)),s)})[n]=Object(r.__assign)({},Object(Cl.a)().forFacet(rc.a).thenInvalidate(e.itemKey,rc.c).pack()),o)),i(a.execute()),[2]}})})}}),sc=Object(i.b)(function(){return function(e){e(Object(a.f)(tc.a,ho.a)(oc)),e(Object(o.a)(p.a,$l.a)(ec.b))}}),lc=Object(i.b)(function(){return function(e){e(Object(o.a)(p.a,No.a)(Ql)),e(sc),e(Yl.a)}}),cc=new Yi.a("removeFromShardListActionControl"),uc=Object(dn.a)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(p.a,n)}}}}),dc=n("7R8I"),mc=n("M8CB"),pc=n("G4nM"),bc=n("7jzR"),fc=n("1Hqc"),hc=n("w56h"),_c=n("dRAu"),vc=n.n(_c),gc=n("QPPw"),yc=n("O/6m"),Ic=Object(dn.a)()(function(){return function(e){return function(e,t){return{errorRenderer:Oc}}}}),Oc=Object(L.b)(function(e,t){var n=t.defaultRender,i=(t.itemKey,t.title,Object(r.__rest)(t,["defaultRender","itemKey","title"])),a=i.error;if(a instanceof yc.a&&a.extraData&&404===a.extraData.status){var o=Object(Xe.a)(e).itemsScopeItemKey,s=e.demandItemFacet(gc.c,o),l=e.demandItemFacet(fc.a,s&&s.itemKey),c=l&&p.a.serialize(l.mountPointItem),u=void 0,d=vc.a.mountPointNotFoundDefaultErrorMessage;if(c){var m=e.demandItemFacet(ke.h,c);m&&(d=Ve.format(vc.a.mountPointNotFoundErrorMessage,m)),u=T.createElement("div",null,T.createElement(Z.c,{action:T.createElement(hc.a,{itemKeys:[c]})},function(e){var t=e.execute;return T.createElement(ge.DefaultButton,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:return e.sent(),[2]}})})}},vc.a.removeThisShortcut)}))}return T.createElement(T.Fragment,null,n?T.createElement(n,Object(r.__assign)({key:"error"},i,{title:vc.a.mountPointNotFoundErrorTitle,subText:d,actions:u})):null)}return n?T.createElement(n,Object(r.__assign)({},t)):null}),wc=n("B2jn"),jc={key:El.a,displayName:ke.h,email:Fl.a},Sc=Object(i.e)()(function(e){var t=e.itemKey,n=wc.a.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,a,o,s,l,c,u,d,m;return Object(r.__generator)(this,function(p){switch(p.label){case 0:i=n.siteUrl||"",a=n.listId||"",o=n.uniqueId||"",s=i+"/_api/web/Lists('"+a+"')/GetPlacesInformation('"+o+"')?$expand=places",p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e(Object(ea.b)({url:s,qosName:"GetPlacesInformation",method:"GET",endpoint:i}))];case 2:return l=p.sent(),c=new go.a,u=[],(d=l&&l.places)&&d.forEach(function(e){var t,n=e.userEntity.email,r=El.a.serialize({id:String(n)});c.resolveItems({items:(t={},t[r]=Object(ie.c)(jc,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)}),u.push(r)}),c.resolveItems({items:(m={},m[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},k.jc.pack({locationKeys:u})),k.Eb.pack(l.itemSourcePath)),ke.h.pack(l.itemSourceSiteTitle)),m)}),e(c.execute()),[3,4];case 3:throw p.sent();case 4:return[2]}})})}}),Ac=Object(i.b)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return e(Fo),e(Hs.a),e(Hl.a),e(j.spDataOnlyAddonDeferred),e(Object(Ua.a)({enablePltCommands:k.Q})).enablePltCommands?e(Object(o.a)(p.a,Wl.a)(ha)):(e(Object(o.a)(p.a,u.a)(_a)),e(Object(o.a)(p.a,dc.a)(mc.a))),e(Object(o.a)(p.a,d.a)(Pa)),e(Object(o.a)(b.a,c.a)(Da)),e(Object(o.a)(p.a,l.a)(Va)),e(Object(o.a)(b.a,m.a)(so)),e(Object(o.a)(p.a,m.a)(lo)),e(Object(o.a)(b.a,s.a)(co)),e(lc),e(Object(a.f)(_,ho.a)(Ei)),e(Object(a.f)(v,ho.a)(fo)),e(Object(a.f)(g.a,ho.a)(yo)),e(Object(a.f)(h.a,Io.b)(So)),e(Object(a.f)(h.a,Oo)(Po)),e(Object(o.a)(y.a,es.a)($o)),e(Object(o.a)(p.a,ts.a)(zs)),e(Object(o.a)(p.a,qs.a)(Gs)),e(Object(o.a)(To.a,u.a)(Qs)),e(Object(o.a)(jl.a,Ol.a)(gl)),e(Object(o.a)(To.a,d.a)(nl)),e(Object(a.f)(To.a,ho.a)(Ul)),e(Object(a.f)(jl.a,ho.a)(Gl)),e(Object(a.f)(ql.a,ho.a)(Vl)),e(Object(a.f)(wc.a,ho.a)(Sc)),e(Object(o.a)(I.a,c.a)(Ra)),e(Object(o.a)(p.a,Ms.a)(Bs)),e(Object(a.f)(O.a,ho.a)(Bl.b)),e(Object(o.a)(w.a,bc.a)(Ic)),e(Object(o.a)(p.a,cc)(uc)),[2]})})}})},"38Zw":function(e,t,n){"use strict";n.r(t),n.d(t,"getNeedsAttentionView",function(){return b});var r=n("17wl"),i=n("ftiL"),a=n("DL2h"),o=n("9kMg"),s=n("jom9"),l=n.n(s),c=n("GQoE"),u=n("oveG"),d=n("dS01"),m=n("K9kD"),p=n("9jhT");function b(e,t,n){var s=d.a.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),b=n(Object(c.a)({list:u.Ib},s)),f=b&&b.list&&b.list.templateType&&Object(o.e)(b.list.templateType),h=f?"LinkTitle":"LinkFilename",_={},v=[];if(e)for(var g=0,y=e;g<y.length;g++){var I=y[g];if(I.contentTypeId&&I.requiredFields&&I.requiredLookups){for(var O={fieldName:"ContentTypeId",operator:"Eq",values:[I.contentTypeId]},w=a.a(O),j=[],S=I.requiredFields.split(","),A=I.requiredLookups.split(","),k=0;k<S.length;k++){var T=S[k],U="True"===A[k];void 0===_[T]&&(_[T]=U);var C={fieldName:T,lookupId:!!U||void 0,operator:"Eq",values:[""]};j.push(C)}var F=a.b(j,"Or");if(F){var P=a.b([w,F],"And");v.push(P)}}}0===v.length&&v.push(a.a({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var E=Object.keys(_),x=E.map(function(e){return _[e]}),D=Object(r.__spreadArrays)(["DocIcon",h,"Editor","Modified"],E,["FileDirRef"]),L=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],x,[void 0]),N=!!b&&!!b.list&&!!b.list.templateType&&b.list.templateType===o.b.webPageLibrary,K=new i.a("<View Scope='Recursive'/>");N&&m.Features.isFeatureEnabled({ODB:1743})?K.title=l.a.PagesThatNeedAttention:K.title=f?l.a.ItemsThatNeedAttention:l.a.FilesThatNeedAttention,K.isReadOnly=!0,K.id=p.a,K.replaceFields(D,L),K.updateSort({fieldName:"ID",isAscending:!0}),K.updateRowLimit({rowLimit:30,isPerPage:!0});var R=a.b(v,"Or");return K.addFilters([R]),K}},"3SKL":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o});var r=n("vHN8"),i=new r.a("enabledForMultipleItems"),a=new r.a("isEnabledFunction"),o=new r.a("iconUrl")},"4qQ9":function(e,t,n){"use strict";var r,i=n("boye");!function(e){e.getFilterData=function(e,t,r,a){var o=[];e=e.split("<br>")[0];var s=document.createElement("DIV");s.innerHTML=e;var l=s.querySelector("#diidFilter"+t);if(null!=l)for(var c=l.childNodes.length,u=l.childNodes,d=1;d<c;d++){var m=Object(i.getText)(u[d]),p=u[d].value.toString(),b={display:null!=a&&a?p:m,value:p};if(r){var f=n(p);f.filterType&&(b.value=f.value,b.calculatedFieldOriginFilterValue=p,b.calculatedFieldFilterType=f.filterType,o.push(b))}else o.push(b)}for(var h={},_=0,v=o;_<v.length;_++)(I=v[_]).display in h?h[I.display]++:h[I.display]=1;for(var g=0,y=o;g<y.length;g++){var I;h[(I=y[g]).display]>1&&(I.display=I.value)}return o};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function n(e){var n=e.indexOf("_"),r=e,i=void 0;if(n>0){r=e.substring(n+1);var a=Number(e.substring(0,n));!isNaN(a)&&a<t.length&&(i=t[a])}return{value:r,filterType:i}}e.getCalculatedFieldFilterValueAndType=n}(r||(r={})),t.a=r},"69Re":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("7YMn").a)("hoverCardCommandsControl")},"6Uwp":function(e,t,n){"use strict";n.r(t),n.d(t,"spItemCreateFolderOperationHandler",function(){return w}),n.d(t,"getCreateFolderUrl",function(){return j});var r=n("17wl"),i=n("eVX6"),a=n("oCyF"),o=n("dS01"),s=n("oveG"),l=n("NX6U"),c=n("CUTS"),u=n("gwT8"),d=n("GQoE"),m=n("Rr4e"),p=n("r55L"),b=n("sqky"),f=n("H8DK"),h=n("kk66"),_=n("F0Gs"),v=n("6Pju"),g=n("c5SI"),y=n("NSZs"),I=n("84Rh"),O=n("9Zk4"),w=Object(b.e)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,b=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,v,g,O,w,A,k,T,U,C,F,P,E,x,D,L,N;return Object(r.__generator)(this,function(K){switch(K.label){case 0:return t=Object.keys(b)[0],v=b[t],g=v.progressItemKey,O=v.conflictResolution,w=a.a.deserialize(n),A=w.rootFolder||new i.a(w.listFullUrl).path,k=o.a.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}),T=e(Object(d.a)({list:s.Ib},k)),U=Object(I.mapConflictResolutionToNameConflictBehavior)(O),C=j({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl,parentFolderPath:A,isDocLib:!!T&&!!T.list&&T.list.isDocumentLibrary,folderName:t,nameConflictBehavior:U}),[4,e(Object(l.b)({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl,url:C,method:"POST",qosName:"createFolder",parseResponse:function(e){var t;try{return null===(t=JSON.parse(e))||void 0===t?void 0:t.d}catch(e){}},telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,a=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?y.b.expectedFailure:y.b.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:a})}}return{eventData:n}}})).catch(function(t){if(t instanceof c.a&&t.message&&A){var n=A;"/"===n[0]&&(n=n.substr(1)),"/"!==n[n.length-1]&&(n+="/"),t.message=t.message.replace(n,"")}throw new u.a({innerError:t,facets:e(S(t))})})];case 1:return F=K.sent(),g&&(P=null===(N=F)||void 0===N?void 0:N.Name,E=A+"/"+P,x=a.a.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl,rootFolder:E}),e(Object(m.a)({items:(D={},D[g]=Object(r.__assign)(Object(r.__assign)({},f.f.pack({itemKey:x})),P&&t!==P?_.h.pack(P):{}),D[x]=Object(r.__assign)(Object(r.__assign)({},s.hb.pack(E)),_.A.pack({itemKey:n})),D)}))),e(Object(p.a)({items:(L={},L[n]=[h.b],L)})),[2]}})})}});function j(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.parentFolderPath,a=e.isDocLib,o=void 0===a||a,s=e.folderName,l=e.nameConflictBehavior,c=Object(v.d)({webAbsoluteUrl:t,listOrItemFullUrl:n}),u=s?s.trim():"";return(c=o?(c=c.segment("folders")).methodWithAliases("AddUsingPath",Object(r.__assign)({DecodedUrl:i+"/"+u,overwrite:!1},2===l?{EnsureUniqueFileName:!0}:{})).oDataParameter("$Expand","ListItemAllFields/PermMask"):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:i}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:u||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function S(e){return function(t){if(e instanceof c.a)switch(function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]}(e)){case Number("-2130575257"):var n=t(Object(O.a)());if(n)return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.o.pack({})),g.b.pack(n)),g.c.pack(!1));break;case-2147023080:case-2130575282:return g.q.pack({})}}}},"6aXa":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("modifyView"),o=Object(i.e)({operationTypeFacet:a})},"7wik":function(e,t){var n={FileCheckedoutOrLockedWarningTitle:"File is checked out or locked",FileCheckedoutOrLockedWarning:"You cannot edit the properties of this document while it is checked out or locked for editing by another user",CheckoutRequired:"The file is not checked out.  You must first check out this document before making changes.",Error:"Error"};n.default=n,e.exports=n},"92QW":function(e,t){var n={sharedByYou:"Shared by you"};n.default=n,e.exports=n},"9X6G":function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n("17wl"),i=n("cDcd"),a=n("12Fv"),o=n("Sd+/"),s=n("60OA"),l=n("/ZMm"),c=n("EFk2"),u=n("Pe+L"),d=n("dS01"),m=n("oveG"),p=n("h0t6"),b=n("TdeX"),f=n("eddL"),h=n("vyKV"),_=n("2p7v"),v=n("JI8f"),g=n("9kMg"),y=n("Hjbe"),I=n("F0Gs"),O=n("LbJS"),w=n("iODI"),j=Object(w.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(6),n.e(85)]).then(n.bind(null,"NTtD"))];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),S=Object(a.b)(function(e,t){var n=t.onContinue,a=t.onCancel,o=t.resolve,s=t.reject,l=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(j,Object(r.__assign)({},l,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return o(),[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return a?[4,a()]:[3,2];case 1:e.sent(),e.label=2;case 2:return s(new c.a),[2]}})})}}))}),A=Object(a.b)(function(e,t){var n=t.itemKeys,a=Object(s.a)(e);if(!a)return null;var l=e.demandItem({setKey:u.a},a).setKey;if(!l||!n||!n.length)return null;if(!Object(v.a)(e,{enbableApproveRejectConfiguration:m.x}).enbableApproveRejectConfiguration)return null;var c=!0,w=e.demandItemFacet(m.Ib,d.a.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}));if(w&&w.templateType===g.b.webPageLibrary&&n.length>1)return null;for(var j,A,k=!0,T=!0,U=!1,C={},F=0,P=n;F<P.length;F++){var E=P[F];if(!f.a(e,{itemKey:E,listFacets:w}))return null;var x=e.demandItem({permissions:m.fc,moderationStatusType:m.Sb,moderationComments:m.Rb},E),D=x.permissions,L=x.moderationStatusType,N=x.moderationComments;if(w&&!w.isDocumentLibrary&&!h.b.hasItemPermission({permissions:D},h.b.layoutsPage))return null;if(void 0!==L){var K=C[_.a[L]];C[_.a[L]]=K?K+1:1}if(void 0===j?j=N:j!==N&&(k=!1),void 0===A?A=L:A!==L&&(T=!1),L===_.a.draft&&(U=!0),!(c=f.b(e,{itemKey:E,includeOneNote:!0})||L===_.a.pending||!!w&&!w.enableMinorVersions))return null}if(w&&w.templateType===g.b.webPageLibrary)return c&&(E=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(y.a,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null;var R,z=T&&A===_.a.draft&&!!w&&!!w.enableMinorVersions,q=U,M=e.dispatch,G=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){return t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}],void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment}),[2,M(Object(b.a)({items:(i={},i[a]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},V=n.length,B=V>1?"BulkApproveReject":"ApproveReject";1===V&&(R=e.demandItemFacet(I.h,n[0]));var H=Object(O.g)(function(e){return i.createElement(S,Object(r.__assign)({},e,{onContinue:G,hideApproveRejectOptions:z,showDraftOption:q,initialComment:k?j:void 0,initialStatus:T?A:void 0,itemCount:n.length,itemName:R,initialStatusMapForBulkEdit:C}))});return i.createElement(o.a,Object(r.__assign)({isAvailable:c,onExecute:H},Object(p.b)(e,{itemKey:n[0],engagement:{name:B,isIntentional:!0}})))}),k=Object(l.f)()(A)},BhPz:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return u});var r,i=n("K9kD"),a={accdb:{extensions:["accdb","mdb"]},archive:{type:i.ItemType.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:i.ItemType.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:i.ItemType.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:i.ItemType.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:i.ItemType.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{type:i.ItemType.Folder,iconType:"svg"},font:{type:i.ItemType.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:i.ItemType.Unknown},html:{extensions:["htm","html","mht"]},link:{type:i.ItemType.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:i.ItemType.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:i.ItemType.OneNote,extensions:["one"]},onetoc:{type:i.ItemType.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},photo:{type:i.ItemType.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:i.ItemType.Folder,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:i.ItemType.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:i.ItemType.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:i.ItemType.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:i.ItemType.Unknown,extensions:["zip"]}};!function(e){e[e.Invalid=0]="Invalid",e[e.File=1]="File",e[e.FileVersion=2]="FileVersion",e[e.ListItem=3]="ListItem",e[e.List=4]="List",e[e.Folder=5]="Folder",e[e.FolderWithLists=6]="FolderWithLists",e[e.Attachment=7]="Attachment",e[e.ListItemVersion=8]="ListItemVersion",e[e.CascadeParent=9]="CascadeParent",e[e.Web=10]="Web",e[e.App=11]="App"}(r||(r={}));var o,s=n("M6f2");function l(e){var t,n="";return e.type===i.ItemType.Folder?(n=void 0===(t=e.sharingType)||t===s.a.Private||t===s.a.Unknown?"folder":"sharedfolder",e.isDocSet&&(n="docset")):n=e.type===i.ItemType.OneNote?"one":e.recycleBinProperties&&e.recycleBinProperties.itemType===r.List?"splist":e.listItem?"listitem":"text/typescript"===e.textEditorMimeType?"code":e.panorama?"photo360":u(e.extension),n}function c(e){var t;try{if(e){var n=u(e);if(a[n]){var r=a[n].type;void 0===r&&(r=i.ItemType.File),t=r}}}catch(e){}return void 0===t&&(t=i.ItemType.Unknown),t}function u(e){if(!o)for(var t in o={},a){var n=a[t].extensions;if(n)for(var r=0;r<n.length;r++)o[n[r]]=t}return e=e.replace(".","").toLowerCase(),o[e]||"genericfile"}},C21W:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("K9kD"),i=n("m1i4"),a=n("y88i"),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.b({webAbsoluteUrl:!e&&t?new a.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),a=e.message.value;n.error={code:i,message:a}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,r,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var a=1;a<n.length;a++)(r=n[a].split("\n\r")).length>2&&i.push(r[2])}return i},e.processBatchResponse=function(e,t,n){var r,i,a,o,s=[],l=!1;if(e.split("\n").length>0&&(r=e.split("\n")[0]),r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var c=1;c<i.length;c++)if((a=i[c].split("\n\r")).length>2){try{o=JSON.parse(a[2])}catch(e){o=a[2]}var u=t&&t[c-1],d=u?{key:u.key,id:u.id,newId:n?n+"/"+u.name:null}:{};if((o=o.error?o.error:o)&&o.code){var m=o.code?o.code.split(","):o.error.code.split(","),p=Number(m[0]),b=o.message.value;d.error={code:p,message:b},l=!0}s.push(d)}}return{items:s,hasError:l}},e.getBatchContent=function(e,t,n,i){for(var a=[],o=0;o<t.length;o++){for(var s=t[o],l=r.Guid.generate(),c=[],u=0;u<s.length;u++){var d=s[u];c.push("--changeset_"+l),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(n+" "+d+" HTTP/1.1"),c.push(i),c.push("")}c.push("--changeset_"+l+"--");var m=c.join("\r\n");a.push("--batch_"+e),a.push('Content-Type: multipart/mixed; boundary="changeset_'+l+'"'),a.push("Content-Length: "+m.length),a.push("Content-Transfer-Encoding: binary"),a.push(""),a.push(m),a.push("")}return a.push("--batch_"+e+"--"),a.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,a,o,s){var l=r.Guid.generate(),c=[];a&&a.length!==t.length&&(a=null);for(var u=0;u<t.length;u++){var d=t[u];c.push("--changeset_"+l),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),s?c.push(s[u]+" "+d+" HTTP/1.1"):c.push(n+" "+d+" HTTP/1.1"),c.push(i),o&&c.push(o),a&&(c.push(""),c.push(a[u])),c.push("")}c.push("--changeset_"+l+"--");var m=c.join("\r\n");return(c=[]).push("--batch_"+e),c.push('Content-Type: multipart/mixed; boundary="changeset_'+l+'"'),c.push("Content-Length: "+m.length),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(m),c.push(""),c.push("--batch_"+e+"--"),c.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.b=o},Dd7j:function(e,t,n){"use strict";n.r(t),n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return P});var r=n("sqky"),i=n("17wl"),a=n("xznA"),o=n("qyWO"),s=n("eVX6"),l=n("P1qn"),c=n("DadU"),u=n("q0Ln"),d=n("K9kD"),m=n("IG76"),p=n("dS01"),b=n("Rr4e"),f=n("QMTs"),h=n("bdhH"),_=n("oCyF"),v=n("Pe+L"),g=n("R/Xa"),y=n("oveG"),I=n("F0Gs"),O=n("kk66"),w=n("YTDo"),j=n("zLs4"),S=n("JyUB"),A=n("GQoE"),k=n("SJhz"),T=n("SkYD"),U=n("Zq6i"),C=Object(r.b)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return e(Object(b.b)({keyFacet:m.a,facets:[_.a,I.h,I.j,y.kd,I.l,y.hb,O.b,y.Qb,k.a,k.b,y.fc,I.e]})),e(Object(a.f)(m.a,f.a)(Object(r.e)({maxParallelOperationCount:8})(F))),[2]})})}});function F(e){var t=this,n=e.itemKey,r=m.a.deserialize(n);return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,b,f,I,k,C,F,P,E,x,D,L,N,K,R,z,q,M,G;return Object(i.__generator)(this,function(V){switch(V.label){case 0:return t=new o.a,a=!1,b=new s.a(r.itemFullUrl),f=e(function(e,t,n){return function(t){var n,r,i=e.itemFullUrl,a=new s.a(i);return r=d.Killswitch.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"],n=[a.path],t(Object(A.a)({contentTypeId:y.n},m.a.serialize(e))),{webAbsoluteUrl:"",listFullUrl:i,currentPageContext:void 0,qosName:"getSPItemByFullUrl",viewXml:Object(S.d)({itemRefs:n,recurseInFolders:!0,pageSize:1,fieldNames:r}),rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}}(r)),[4,e(Object(w.a)({getItemContext:f}))];case 1:return I=V.sent(),k=I.WebUrl||h.getSharePointPath(decodeURIComponent(I.HttpRoot||""))||b.authority,C=""+new s.a(k).authority+(I.ListUrl||decodeURIComponent(I.listUrlDir||"")),F={webAbsoluteUrl:k,listFullUrl:C,rootFolder:""},P=e(Object(j.b)({serverData:I,itemSetKey:F,currentPageContext:f.currentPageContext,contentTypes:void 0,isItemSetRequest:a})),E=P.itemResolver,x=P.childKeys,D=P.pageContext,L=x[0],N=v.a.serialize(F),L&&t.mapKeys({mappings:(M={},M[L]=m.a.serialize(r),M)}),D&&(K=g.a.serialize({webAbsoluteUrl:k,listFullUrl:C}),e(Object(A.a)({pageContext:y.Yc},K)).pageContext||e(Object(c.a)({itemKey:K,options:{pageContext:D}}))),t.merge(E),_.a.matches(L)&&(R=_.a.deserialize(L),(z=Object(T.b)(R))&&t.merge(e(Object(T.a)({parentKey:z,serverData:I,pageContext:D})).itemResolver)),q=p.a.serialize({webAbsoluteUrl:k,listFullUrl:C}),t.resolveItems({items:(G={},G[_.a.serialize(F)]=Object(i.__assign)({},O.b.pack({itemKey:N})),G[n]=Object(i.__assign)({},l.d.pack(_.a)),G[q]=Object(i.__assign)({},Object(u.a)(I,D)),G)}),e(t.execute()),e(Object(U.a)({itemSetKey:N,serverData:I,isItemSetRequest:a})),[2]}})})}}var P=Object(r.b)(function(){return function(e){e(C)}})},Et6h:function(e,t){var n={files:"My files",recentTitle:"Recent",recent:"Recent",saved:"Saved for later",sharedWithMe:"Shared with you",sharedByMe:"Shared by me"};n.default=n,e.exports=n},FU0e:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("updateView"),o=Object(i.e)({operationTypeFacet:a})},G4nM:function(e,t,n){"use strict";n.r(t),n.d(t,"spProjectedUploadedItemSetAddon",function(){return h});var r=n("+Grl"),i=n("SVnr"),a=n("JI8f"),o=n("Pe+L"),s=n("oCyF"),l=n("kk66"),c=n("dMIW"),u=n("F0Gs"),d=n("oveG"),m=n("IX5e"),p=n("26gu"),b=n("sqky"),f=Object(r.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(a.a)(e,{isProjectedUploadedItemSetEnabled:d.R}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var p=e.demandItemFacet(o.a,n);if(p){var b=function(e,t,n){var r=[],i=c.a.serialize({itemSetKey:t}),a=e.demandItemFacet(l.a,i);if(e.demandItemFacet(m.a,c.a.serialize({itemSetKey:t})),a&&(!a.itemKeys||0!==a.itemKeys.length)){for(var o={},d={},p=0,b=a.itemKeys;p<b.length;p++){var f=b[p];r.push(f);var h=e.demandItemFacet(s.a,f);h&&(h.itemId&&(o[h.itemId]=!0),h.rootFolder&&(d[h.rootFolder]=!0)),o[f]=!0}if(n)for(var _=0,v=n;_<v.length;_++){var g=v[_],y=e.demandItemFacet(s.a,g);if(y)if(e.demandItemFacet(u.l,g)){if(y.rootFolder&&y.rootFolder in d)continue}else if(y.itemId&&y.itemId in o)continue;r.push(g)}return r}}(e,p,r);return b?{itemKeys:b}:{}}}return{}}}}),h=Object(b.b)(function(){return function(e){e(Object(i.a)(o.a,p.a)(Object(r.a)()(f)))}})},"GQ+h":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spTenantKeyFacet",{tenantRootUrl:Object(r.f)()})},GQ1J:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spFrequentSitesItemSet",{tenantRootUrl:Object(r.f)()})},GbVI:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("saveViewCore"),o=Object(i.e)({operationTypeFacet:a})},Gpga:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("17wl"),i=n("K9kD"),a=n("XkN0"),o=function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})},this._getAria=l(function(){return e.ariaLoader().then(function(t){return function(e,t){e.LogManager.isInitialized()||(e.LogManager.initialize(t.tenantToken,Object(r.__assign)(Object(r.__assign)({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})),e.LogManager.addCallbackListener(function(e,n,r,i){r===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})}(t,e),t})}),this._getLogger=l(function(){return t._getAria().then(function(t){return[function(e,t,n){void 0===n&&(n={});var r=new e.Logger(t);return s(r,n),r}(t,e.tenantToken,e.context),t]})}),this._createLogHandler=l(function(){return t._getLogger().then(function(t){var n=t[0];return function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=void 0),function(o){try{if(o.enabled&&(o.eventType!==i.ClonedEventType.Start||n)&&(!r||!r.isQosEvent(o))){var s=function(e,t){var n=function(e){for(var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:i.ClonedEventType[e.eventType]},n=e.eventName.split(","),r=0,o=n;r<o.length;r++){var s=o[r];s&&(t["WebLog_Type_"+s]=1)}var l=e.data,c=e.context;if(c)for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){if(null==(m=c[u]))continue;t[b=Object(a.capitalize)(u)]=m}if(l)for(var d in l)if(Object.prototype.hasOwnProperty.call(l,d)){var m;if(null==(m=l[d]))continue;var p=e.metadata[d];if(p){var b=p.isPrefixingDisabled?Object(a.capitalize)(d):Object(a.capitalize)(p.definedInName)+"_"+d,f=p.type;if(4===f){for(var h in m)if(Object.prototype.hasOwnProperty.call(m,h)){var _=m[h];if(null!=_&&""!==_){var v=void 0;if("object"==typeof _)try{v=JSON.stringify(_)}catch(e){v=_}else v=_;t[b+"_"+h.replace(/\./g,"_")]=v}}}else t[b]=6===f?p.typeRef[m]:m}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_"+n[n.length-2],values:t}}(t),r=n.name,o=n.values,s=new e.EventProperties;return s.name=r,function(e,t,n){var r;try{for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r=a,t.setProperty(a,n[a]))}catch(t){var o=void 0,s=void 0;throw t instanceof e.Exception&&(o=t.ErrorCode(),s=new Error("Aria error: "+t.toString())),s&&(t.handled=!0,i.logError(s,{errorCode:o,propertyKey:r})),t}}(e,s,o),s}(e,o);t.logEvent(s)}}catch(t){var l=void 0;t instanceof e.Exception&&(l=new Error("Aria error: "+t.toString())),t&&t.handled||i.log(l||t)}}}(t[1],n,e.logStartEvents,e.ariaQos)})}),this._onLogEvent=e.onLogEvent}return e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;return e.addLogHandler(t).forEach(t),function(){return e.removeLogHandler(t)}},e.prototype.updateContext=function(e){this._getLogger().then(function(t){return s(t[0],e)})},e}();function s(e,t){var n=t.Session,i=t.Version,o=t.OSName,s=t.OSVersion,l=t.Market,c=t.UserId,u=t.Manifest,d=Object(r.__rest)(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),m=e.getSemanticContext();if(n&&e.setContext("AppInfo.Session",n),u&&e.setContext("AppInfo.Manifest",u),i&&m.setAppVersion(i),m.setUserLanguage(l||""),c){var p=function(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,r,i,a){return""+t+function(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}(i)+a})}(c);m.setUserId(p)}for(var b in o&&m.setDeviceOsName(o),s&&m.setDeviceOsVersion(s),d)if(Object.prototype.hasOwnProperty.call(d,b)){if(null==d[b])continue;var f=Object(a.capitalize)(b);e.setContext(f,d[b])}}function l(e){var t=void 0;return function(){return t||(t=e()),t}}},H0ge:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return l});var r=n("vHN8"),i=n("nz3y"),a=n("xznA"),o=new r.a("removeFromOneDrive"),s=new i.a("removeFromOneDrive"),l=Object(a.e)({operationTypeFacet:o})},I2kL:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return h});var r=n("17wl"),i=n("NX6U"),a=n("2YyJ"),o=n("6Pju"),s=n("IS2W"),l=n("y88i"),c=n("oveG"),u=n("QDiT"),d=n("O/6m");function m(e){return function(t){var n=t(Object(a.a)({spHomeDataSourceConfiguration:c.Pc})).spHomeDataSourceConfiguration,r=n&&n.contextAcquiresAuthToken;return t(Object(i.d)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:f(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:r,crossSiteCollectionCall:r,needsRequestDigest:!r,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,n){var i=this;return void 0===n&&(n=8),function(o){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,s,l,u,d,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=o(Object(a.a)({spFrequentSitesConfiguration:c.Nc,enableFilesWeightedFrequentSitesConfiguration:c.D})),s=i.spFrequentSitesConfiguration,l=i.enableFilesWeightedFrequentSitesConfiguration,s&&s.getExternalData?[4,s.getExternalData()]:[3,2];case 1:if(u=r.sent())return[2,u];r.label=2;case 2:return!t&&s&&s.getCacheContext?[4,s.getCacheContext()]:[3,4];case 3:(d=r.sent())&&(t=JSON.stringify(d)),r.label=4;case 4:return[4,o(m({tenantRootUrl:e}))];case 5:return p=r.sent(),[2,o(h({path:"api/v1/sites/feed?acronyms=true&start=0&count="+n,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:l?"ODBWeb":void 0,cacheContext:t}))]}})})}}function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(t=n(Object(a.a)({spFollowedSitesConfiguration:c.Mc})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(i=r.sent())return[2,i];r.label=2;case 2:return[4,n(m({tenantRootUrl:e}))];case 3:return o=r.sent(),[2,n(h({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function f(e){var t=e.tenantRootUrl;return Object(o.c)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function h(e){var t=this,n=e.method,a=e.path,o=e.context,c=e.qosName,m=e.clientType,p=e.contentType,b=void 0===p?"application/json;odata=verbose":p,f=e.body,h=e.cacheContext,_=c?"getData."+c:"getData";return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,c,p,v,g,y,I,O,w,j=this;return Object(r.__generator)(this,function(S){switch(S.label){case 0:return t=new Headers,(p=o.accessToken)?[3,2]:[4,e(Object(i.a)({url:o.resource}))];case 1:p=S.sent(),S.label=2;case 2:return(c=p)&&t.set("Authorization","Bearer "+c),o.payloadHeader&&t.set("SPHome-ApiContext",o.payloadHeader),h&&t.set("SPHome-CacheContext",h),t.set("SPHome-ClientType",m||"ODSPDocLibsWeb"),t.set("Content-Type",b),v={headers:t,credentials:"omit",method:n,mode:"cors",cache:"default",body:f},g=e(Object(s.a)({name:_})),y=o.resource+"/"+a+"__"+n,[4,e(Object(u.b)(y))];case 3:return I=S.sent(),O=fetch(o.resource+"/"+a,v).then(function(t){return Object(r.__awaiter)(j,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t.ok?(e(g({resultType:l.ResultTypeEnum.Success})),204===t.status?[2,{}]:[4,t.json()]):[3,2];case 1:return n=r.sent(),e(Object(u.d)(y,n)),[2,n];case 2:throw new d.a({code:""+t.status,message:t.statusText})}})})}).catch(function(t){throw e(g({resultType:l.ResultTypeEnum.Failure,resultCode:t instanceof d.a?t.code:t.name,error:t&&JSON.stringify(t)})),t}),(w=I)?[3,5]:[4,O];case 4:w=S.sent(),S.label=5;case 5:return[2,w]}})})}}n("ZQAL")},IX5e:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"b",function(){return y});var r=n("17wl"),i=n("dMIW"),a=n("Pe+L"),o=n("sqky"),s=n("qyWO"),l=n("4qcU"),c=n("vHN8"),u=n("kk66"),d=n("Ql3v"),m=n("oCyF"),p=n("nz3y"),b=n("JI8f"),f=n("PpNt"),h=n("H8DK"),_=n("Rr4e"),v=n("oveG"),g=new c.a("projection"),y=Object(o.e)()(function(e){var t=this,n=i.a.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,c,y;return Object(r.__generator)(this,function(I){return t=a.a.serialize(n),(c=new s.a).resolveItems({items:(y={},y[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},g.pack({})),Object(l.a)().forFacet(g).thenInvalidate(function(){return function(){o(function(e){var t=this,n=e.itemSetKey,o=a.a.deserialize(n),s=i.a.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return e(Object(d.a)(function(e){var t=Object(b.a)(e,{isProjectedUploadedItemSetEnabled:v.R}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=m.a.serialize(o),r=e.demandItemFacet(v.c,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(u.a,p.i),a=0,s=i&&i.itemKeys||[];a<s.length;a++){var l=s[a];if(e.demandItemFacet(f.b,l)){var c=e.demandItemFacet(h.g,l),d=e.demandItemFacet(m.a,c&&c.itemKey);if(d&&d.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(_.a)({items:(t={},t[s]=Object(r.__assign)({},u.a.pack({itemKeys:[]})),t)})),[2]})})}}({itemSetKey:t}))}}).pack()),y[t]=Object(l.a)().forFacet(u.a).thenInvalidate(e.itemKey,g).pack(),y)}),o(c.execute()),[2]})})}})},ImEp:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("7YMn").a)("itemThumbnailControl")},InaI:function(e,t,n){"use strict";n.d(t,"a",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return O}),n.d(t,"d",function(){return j}),n.d(t,"b",function(){return k}),n.d(t,"c",function(){return T});var r,i,a,o,s,l,c=n("K15e"),u=n.n(c),d="ms-word",m="onenote|UsePlain",p="ms-powerpoint",b="ms-excel",f="ms-visio",h="ms-publisher",_="ms-project",v=u.a,g=((r={})[d]=u.a.OpenInWordOnline,r[m]=u.a.OpenInOneNoteOnline,r[p]=u.a.OpenInPowerPointOnline,r[b]=u.a.OpenInExcelOnline,r[f]=u.a.OpenInVisioOnline,r);function y(e,t){return g[e]?t?u.a.OpenInBrowser:g[e]:""}(i={})[d]=u.a.OpenInWord,i[m]=u.a.OpenInOneNote,i[p]=u.a.OpenInPowerPoint,i[b]=u.a.OpenInExcel,i[f]=u.a.OpenInVisio;var I=((a={})[d]=u.a.OpenInWord,a[m]=u.a.OpenInOneNote,a[p]=u.a.OpenInPowerPoint,a[b]=u.a.OpenInExcel,a[f]=u.a.OpenInVisio,a[h]=u.a.OpenInPublisher,a[_]=u.a.OpenInProject,a["ms-infopath"]=u.a.OpenInInfoPath,a);function O(e,t){return t&&function(e){return g.hasOwnProperty(e)}(e)?u.a.OpenInApp:I[e]}var w=((o={})[d]="Word",o[m]="OneNote",o[p]="PowerPoint",o[_]="Project",o[f]="Visio",o[b]="Excel",o);function j(e){return w[e]}var S=((s={})[d]="WordLogo",s[m]="OneNoteLogo",s[p]="PowerPointLogo",s[b]="ExcelLogo",s[f]="VisioLogo",s[h]="Page",s),A=((l={})[d]={logo:"WordLogo",logo16:"WordLogo16",logoFill:"WordLogoFill",logoFill16:"WordLogoFill16",logoInverse:"WordLogoInverse",logoInverse16:"WordLogoInverse16"},l[m]={logo:"OneNoteLogo",logo16:"OneNoteLogo16",logoFill:"OneNoteLogoFill",logoFill16:"OneNoteLogoFill16",logoInverse:"OneNoteLogoInverse",logoInverse16:"OneNoteLogoInverse16"},l[p]={logo:"PowerPointLogo",logo16:"PowerPointLogo16",logoFill:"PowerPointLogoFill",logoFill16:"PowerPointLogoFill16",logoInverse:"PowerPointLogoInverse",logoInverse16:"PowerPointLogoInverse16"},l[b]={logo:"ExcelLogo",logo16:"ExcelLogo16",logoFill:"ExcelLogoFill",logoFill16:"ExcelLogoFill16",logoInverse:"ExcelLogoInverse",logoInverse16:"ExcelLogoInverse16"},l[f]={logo:"VisioLogo",logo16:"VisioLogo16",logoFill:"VisioLogoFill",logoFill16:"VisioLogoFill16",logoInverse:"VisioLogoInverse",logoInverse16:"VisioLogoInverse16"},l);function k(e){return S[e]}function T(e){return A[e]}},JfR2:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("17wl"),i=n("cDcd"),a=n("QmvJ"),o=n("VrFJ"),s=function(e){var t=e.extension,n=e.className,s=e.isOneNote,l=e.size,c=e.brand,u=Object(o.c)({size:l,extension:s?"one":t,brand:c});return u?i.createElement(a.Icon,Object(r.__assign)({className:n},u)):null}},JgQI:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("17wl"),i=n("rFvU"),a=n("6gF6"),o=n("EFk2");function s(e,t,n){var s=this;void 0===n&&(n={});var l=n.cancelToken,c=n.flushOperationQueue,u=n.contextualControlHandlerCache;return function(n){return Object(r.__awaiter)(s,void 0,void 0,function(){var s,d,m,p,b=this;return Object(r.__generator)(this,function(f){switch(f.label){case 0:return s=n(i.b),(d=s.createItemCacheSelector(e,u,"observeItems")).isResolved()?(t(d.get()),[3,5]):[3,1];case 1:m=new a.a,p=void 0,f.label=2;case 2:return f.trys.push([2,,4,5]),p=d.subscribeToDemandResolution(function(){return Object(r.__awaiter)(b,void 0,void 0,function(){var e,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),d.isResolved()?(e=t(d.get()))?[4,e]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return m.resolve(),[3,4];case 3:l&&l.throwIfCanceled(),r.label=4;case 4:return[3,6];case 5:return n=r.sent(),m.reject(n),[3,6];case 6:return[2]}})})}),d.registerDemands(),c&&d.flushDemands(),[4,Object(o.d)(m.promise,l)];case 3:return f.sent(),[3,5];case 4:return p&&p(),d.dispose(),[7];case 5:return[2]}})})}}},JxDi:function(e,t){var n={UndoCheckOut:"Discard check out",CheckOut:"Check out",CheckIn:"Check in",Error:"Error",checkoutStartedItemsTitle:"Checking out {0} item||Checking out {0} items",checkinStartedItemsTitle:"Checking in {0} item||Checking in {0} items",undoCheckoutStartedItemsTitle:"Discarding Check out {0} item||Discarding Check out {0} items",checkoutCompletedItemsTitleIntervals:"1||2-",checkoutFailedItemsTitle:"{0} item wasn\u0027t checked out||{0} items weren\u0027t checked out",checkinFailedItemsTitle:"{0} item wasn\u0027t checked in||{0} items weren\u0027t checked in",undoCheckoutFailedItemsTitle:"{0} item failed to undo check out||{0} items failed to undo check out",checkoutCompletedItemsTitle:"Checked out {0} item||Checked out {0} items",undoCheckoutCompletedItemsTitle:"Discarded check out {0} item||Discarded check out {0} items",checkinCompletedItemsTitle:"Checked in {0} item||Checked in {0} items",DiscardCheckoutTitle:"Discard check out?",DiscardCheckoutText:"If you discard your check out, you will lose all changes made to the document. Are you sure you want to discard your check out?"};n.default=n,e.exports=n},K15e:function(e,t){var n={Open:"Open",OpenInBrowser:"Open in browser",OpenInApp:"Open in app",OpenInWord:"Open in Word",OpenInProject:"Open in Project",OpenInExcel:"Open in Excel",OpenInPowerPoint:"Open in PowerPoint",OpenInOneNote:"Open in OneNote",OpenInTextEditor:"Open in Text Editor",OpenInVisio:"Open in Visio",OpenInPublisher:"Open in Publisher",OpenInInfoPath:"Open in InfoPath",OpenInWordOnline:"Open in Word Online",OpenInPowerPointOnline:"Open in PowerPoint Online",OpenInExcelOnline:"Open in Excel Online",OpenInOneNoteOnline:"Open in OneNote Online",OpenInVisioOnline:"Open in Visio Online"};n.default=n,e.exports=n},KIOw:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n("17wl"),i=n("sqky"),a=n("NvJS");n.d(t,"getCreateDocumentUrl",function(){return a.a}),n.d(t,"getRedirectUrlFromResponse",function(){return a.b});var o=Object(i.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.e(72).then(n.bind(null,"jxE4"))];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:return t.sent(),[2]}})})}})},KbV0:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("cDcd"),i=n("xjN3"),a=n("t+OK"),o=n("LSX5"),s=0;function l(e){var t=e.isDefault,n=void 0!==t&&t,l=r.useState(""+ ++s)[0],c=r.useContext(i.a),u=r.useRef(),d=u.current||n&&c.keyboardManager||(u.current=new i.b({isDefault:!1,id:l,parent:c.keyboardManager})),m=function(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],a=r.useState(function(){return e.hasActiveChildren()}),s=a[0],l=a[1];return r.useEffect(function(){var t=new o.EventGroup(null);return t.on(e,"change",function(){i(e.getIsActive()),l(e.hasActiveChildren())}),function(){t.dispose()}},[]),{isActive:n,isChildActive:s}}(d),p=m.isActive,b=m.isChildActive;r.useEffect(function(){return function(){n||(d.setIsActive(!1),d.dispose())}},[]);var f=r.useMemo(function(){return{keyboardManager:d}},[d]);return r.createElement("div",{"data-keyboard-zone-id":l},r.createElement(i.a.Provider,{value:f},Object(a.b)(e.children,{isActive:p,isChildActive:b})))}},KrlH:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return d});var r=n("17wl"),i=n("oveG"),a=n("vyKV"),o=n("TYG3"),s=n("/ZMm");function l(e,t){var n=t.itemKey,r=e.demandItemFacet(i.fc,n);return a.a.hasItemPermission({permissions:r},a.a.insertListItems)}var c=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(92).then(n.bind(null,"QZXe"))];case 1:return[2,e.sent().CreateListItemExecutor]}})})},u=Object(s.e)()(Object(o.a)(c,l)),d=Object(s.a)()(Object(o.a)(c,l))},LQht:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("nz3y"),a=new r.a("updatePublishState"),o=new i.a("publish")},M6f2:function(e,t,n){"use strict";var r;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(r||(r={})),t.a=r},Mrnz:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("YUrf"),i=(n("s8xr"),n("DL2h")),a=n("Z29y");function o(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var n=i.a(t);if(!n)throw new Error("Filter could not be serialized");var o=function(e,t){var n=e.getDomParts();if(n&&n.where){var r=n.where.querySelectorAll('[id="'+t+'"]');if(r.length>1)throw new Error("More than one filter found with id "+t);return r[0]}}(e,t.id);if(o){var s=void 0;try{s=a.k(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}o.parentNode.replaceChild(s,o),e.setIsDirty(!0,r.a.filters)}else e.addFilters([n])}n("boye")},NFPW:function(e,t){var n={listItem:"Item"};n.default=n,e.exports=n},NvJS:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var r=n("czUR"),i=n("3SfB"),a=n("c1lE"),o=n("6Pju");function s(e){var t=e.responseText,n=e.documentType,i=e.fileName,a="",o="";if(null!=t){var s=JSON.parse(t);if(null!==s&&null!==s.d&&null!==s.d.CreateDocumentAndGetEditLink)o=s.d.CreateDocumentAndGetEditLink,a=Object(r.b)(o,n,i||"",!1);else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"",a=Object(r.b)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:a}}function l(e){var t=i.a.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,s=e.parentFolderPath,l=e.templateUrl,c=e.docName,u=e.docType;if(null!==u&&u>=i.a.Word&&u<=t&&u!==i.a.Text)return u!==i.a.OneNote||c?c&&(c+=Object(a.b)(u)):c="Notebook"+Math.floor(100*Math.random())+1,c||(c=""),u===i.a.ExcelForm&&(u=i.a.ExcelSurvey),Object(o.a)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:c,folderPath:s,documentTemplateType:u,templateUrl:l||""}).toString();throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},PpNt:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n("LfMA"),i=new r.a("uploadProgress",{sourceEntryKey:Object(r.f)()});function a(e){return i.serialize({sourceEntryKey:e})}},SltW:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("K9kD"),i=n("y88i");function a(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var n=s(e);try{return JSON.parse(n),!0}catch(e){return!1}}return!1}function o(e,t){var n=s(e);try{var a=JSON.parse(n);return function(e){var t=e.pageContext,n=e.appInstanceId,r=e.appOAuthId,a=e.launchUrl,o=e.isTenantApp,s=i.UriEncoding.escapeUrlForCallback(t.webAbsoluteUrl)+"/"+i.UriEncoding.escapeUrlForCallback(t.layoutsUrl)+"/appredirect.aspx";if(r&&a)s+="?client_id="+i.UriEncoding.encodeURIComponent(r)+"&redirect_uri="+i.UriEncoding.encodeURIComponent(a);else{if(!n)throw"appOAuthId, launchUrl, appInstanceId are null";s+="?instance_id="+i.UriEncoding.encodeURIComponent(n)}o&&(s+="&tsapp=1"),window.location.href=s}({pageContext:t,appInstanceId:a[0],appOAuthId:a[1],launchUrl:a[2],isTenantApp:a[4]}),r.Promise.wrap()}catch(e){return r.Promise.wrapError(e)}}function s(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},TdeX:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("bulkUpdateListItems"),o=Object(i.e)({operationTypeFacet:a})},Ti5N:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("17wl"),i=n("cDcd"),a=n("12Fv"),o=new(n("vHN8").a)("activity"),s=n("F0Gs"),l=n("Src9"),c=n("bkr4"),u=n("iODI"),d=Object(c.a)()(Object(u.a)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(63).then(n.bind(null,"cNdL"))];case 1:return[2,e.sent().default]}})})})),m=Object(a.b)(function(e,t){var n=t.itemKey,a=Object(r.__rest)(t,["itemKey"]),c=function(e,t){var n=t.itemKey;if(!e.demandItemFacet(s.l,n)){var r=e.demandItemFacet(s.a,n),i=r&&r.itemKey,a=e.demandItemFacet(o,i),c=e.demandItemFacet(l.a,n);return l.a.evaluate(c)(e,{itemKey:n,activity:a}).itemActivity}}(e,{itemKey:n});return c?i.createElement(d,Object(r.__assign)({activity:c},a)):null})},Tz8b:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return f}),n.d(t,"e",function(){return h}),n.d(t,"d",function(){return _}),n.d(t,"c",function(){return v});var r,i=n("oveG"),a=n("F0Gs"),o=n("vyKV"),s=n("2p7v"),l=n("mNxR"),c=n("oCyF"),u=n("dS01"),d=n("eddL"),m=n("cBXU"),p=n("k5pJ");function b(e,t){var n,r,l;if(!t)return!1;var m=e.demandItem({firstItemKey:c.a,permissions:i.fc,checkoutInfo:a.p,needsPublishing:i.Wb},t),b=m.firstItemKey,f=m.permissions,h=m.checkoutInfo,v=m.needsPublishing;if(!b)return!1;var g=e.demandItemFacet(i.Ib,u.a.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}));return Boolean(v&&o.a.hasItemPermission({permissions:f},o.a.editListItems)&&(null===(n=g)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=g)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(l=h)||void 0===l?void 0:l.byOther)&&!p.a(e,t)&&!function(e,t){var n=t.itemKey,r=t.listFacets,a=e.demandItem({moderationStatusType:i.Sb},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof a&&a!==s.a.draft&&a!==s.a.denied&&a!==s.a.pending;var o=_(e,n);return 0===o.minor&&0!==o.major}(e,{itemKey:t,listFacets:g})&&!d.b(e,{itemKey:t,includeOneNote:!0}))}function f(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function h(e){return!!e&&0===e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118")}function _(e,t){var n=e.demandItem({uiVersion:i.id},t).uiVersion;return Object(m.b)(n)}function v(e,t){var n,r=e.demandItem({firstItemKey:c.a,moderationStatusType:i.Sb},t),a=r.firstItemKey,o=r.moderationStatusType;return a?(null===(n=e.demandItemFacet(i.Ib,u.a.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===s.a.pending?l.a.CancelApproval:l.a.SubmitForApproval:p.b(e,t)?l.a.SchedulePublish:0===_(e,t).major?l.a.Publish:l.a.Republish:l.a.Publish}!function(e){e[e.publish=0]="publish",e[e.schedule=1]="schedule"}(r||(r={}))},"U5g/":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return s});var r=n("7YMn"),i=new r.a("fileHandlerActionControl"),a=new r.a("fileHandlerCustomActionControl"),o=new r.a("fileHandlerOpenActionControl"),s=new r.a("fileHandlerInvokeActionControl")},VRCL:function(e,t,n){"use strict";n.d(t,"a",function(){return U}),n.d(t,"b",function(){return C});var r=n("17wl"),i=n("cDcd"),a=n("12Fv"),o=n("/ZMm"),s=n("Sd+/"),l=n("WopS"),c=n("Dy9Q"),u=n("KL1q"),d=n("07ga"),m=n("U5g/"),p=n("GQoE"),b=n("F0Gs"),f=n("DOzE"),h=n("2YyJ"),_=n("9HFz"),v=n("VSW6"),g=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.getPreAuthUrls=function(e){var t=e.items,n=e.accessToken,r=void 0===n?void 0:n,i=e.driveUrl,a=void 0===i?"":i,o=e.appId,s={items:t};return this._dataRequestor.send({path:(a||"/drive")+"/getPreAuthorizedUrls"+(o?"?appId="+o:""),apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(s),requestType:"POST",accessToken:r,useAuthorizationHeaders:!!r}).then(function(e){return e.value})},e}(),y=n("oD9H"),I=n("YB5h");function O(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,a,o,s,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return t=e.appId,i=e.itemKeys,a=e.getPreAuthUrl,o=e.driveUrl,a?(s=i.map(function(e){return n(Object(p.a)({fullUrl:b.e},e)).fullUrl||""}),[4,n(Object(I.b)(o,o))]):[2,i.map(function(e){var t=n(Object(p.a)({driveItemKey:f.a},e)).driveItemKey,i=n(Object(h.a)({graphEndpoint:_.h})).graphEndpoint;return t?Object(v.a)(Object(r.__assign)(Object(r.__assign)({},t),{endpoint:i||t.endpoint})):""})];case 1:return l=c.sent(),[2,new g({},{dataRequestor:n(y.a).dataRequestor}).getPreAuthUrls({appId:t,items:s,accessToken:l,driveUrl:o})]}})})}}var w=n("EFk2"),j=n("psLB"),S=n.n(j),A=n("LbJS"),k=n("K9kD"),T=Object(a.b)(function(e,t){var n,a,o=t.itemKeys,p=t.action,b=t.isAvailable,h=t.itemKey,_=p.handler,g=_.appId,y=_.isPromoted,I=h,j="";a=k.Killswitch.isActivated("f69e50a3-c176-4a8c-8c48-6adf2b86607b","1/23/2021","Use itemKey instead of parentItemKey.")?I||(1===o.length?o[0]:""):1===o.length?o[0]:I||"";var T=e.demandItem({controlHandler:m.a,driveItemKey:f.a},a),U=T.controlHandler,C=T.driveItemKey;(j=C&&Object(v.b)(C)||"").indexOf("/v2.1")>-1&&(j=j.replace("/v2.1","/v2.0"));var F=m.a.evaluate(U)(e,{itemKey:a}).sharedPostData;n=F;var P=e.dispatch;if(!(b&&p.url&&n&&j))return null;var E=e.demandItemFacet(m.c,h),x=m.c.evaluate(E)(e,{itemKey:h}).onInvokeCallback,D=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return e=x?void 0:window.open("","_blank"),[4,P(O({appId:g,itemKeys:o,getPreAuthUrl:!y,driveUrl:j})).catch(function(){})];case 1:return t=a.sent(),i=Object(r.__assign)(Object(r.__assign)({},n),{appId:g,items:JSON.stringify(t||[])}),x?x({url:p.url,postdata:i}):t&&t.length>0&&e&&e.document?(e.opener=null,Object(d.a)({url:p.url,postdata:i,document:e.document})):e&&e.close(),[2]}})})},L=y?Object(A.g)(function(e){var t=e.resolve,n=e.reject,a=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return n(new w.a),[2]})})};return i.createElement(l.a,{dialogContentProps:{title:S.a.consentDialogTitle,onDismiss:a},hidden:!1},i.createElement("p",null,S.a.consentDialogMessage),i.createElement(c.a,null,i.createElement(u.PrimaryButton,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return t(),[4,D()];case 1:return e.sent(),[2]}})})}},S.a.consentDialogContinueButton),i.createElement(u.Button,{onClick:a},S.a.consentDialogCancelButton)))}):D;return i.createElement(s.a,Object(r.__assign)({isAvailable:b,onExecute:L},t))}),U=Object(o.a)()(T);function C(e,t,n){var r=e.file,i=e.folder,a=e.file&&e.file.extensions||void 0;if(!0===n)return!!i;if(r&&t){var o=k.Killswitch.isActivated("b0dc9ce2-048d-43d2-ac18-f07fc73030c2","1/23/2021","Check if the extension includes a period")||"."===t.charAt(0)?t:"."+t;return!a||-1!==a.indexOf(o.toLowerCase())||-1!==a.indexOf("*")||-1!==a.indexOf(".*")}return!1}},Vsn0:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("7YMn").a)("hoverCardLifeCycleStatusControl")},W1iS:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n("C4BG"),i=n("17wl"),a=n("RmVY"),o=n("3woD"),s=n("Ql3v"),l=n("UQtj"),c=n("7YMn"),u=n("EFk2"),d=n("T7OJ"),m=n("JgQI"),p=r.a?m.a:function e(t,n,r){var m=this;void 0===r&&(r={});var p=r.cancelToken,b=r.flushOperationQueue,f=r.contextualControlHandlers,h=void 0===f?c.b:f,_=r.owner;return function(r,c){return Object(i.__awaiter)(m,void 0,void 0,function(){var m,f,v,g,y;return Object(i.__generator)(this,function(I){switch(I.label){case 0:m=r(o.a),f=r(d.a),v={selector:t,operation:e,owner:_},I.label=1;case 1:I.trys.push([1,,6,7]),g=function(){var e,o,d,_,g,y;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=m.evaluate({selector:t,controlHandlers:h,owner:v,state:c()}),o=e.result,d=e.demands,_=e.dependencies,(g=n(o))?[4,g]:[3,2];case 1:i.sent(),i.label=2;case 2:return y={items:d,flushOperationQueue:b},f.recordLastAccesses(_,Date.now()),r(Object(s.a)(function(e){return Object(l.b)(e,y)}))?(f.registerDemands(v,_),p&&p.throwIfCanceled(),[4,Object(u.d)(r(Object(a.a)(y)),p)]):[2,{value:void 0}];case 3:return i.sent(),[2]}})},I.label=2;case 2:return[5,g()];case 3:if("object"==typeof(y=I.sent()))return[2,y.value];I.label=4;case 4:return[3,2];case 5:return[3,7];case 6:return f.removeDemands(v),[7];case 7:return[2]}})})}}},W42Y:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spPeoplePickerDataSource",{webAbsoluteUrl:Object(r.f)(),listFullUrl:Object(r.f)()})},WDbG:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemUploadItemsOperationHandler",function(){return v});var r=n("17wl"),i=n("oCyF"),a=n("dS01"),o=n("ZUWj"),s=n("sqky"),l=n("GQoE"),c=n("vLsd"),u=n("vHN8"),d=n("H8DK"),m=n("kk66"),p=n("qyWO"),b=n("mHc3"),f=n("eVX6"),h=n("2YyJ"),_=n("oveG"),v=Object(s.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,s=e.options.sourceEntries,v=i.a.deserialize(n),g=v.webAbsoluteUrl,y=v.listFullUrl,I=Object.keys(s)[0],O=s[I].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,w,j,S,A,k,T,U,C;return Object(r.__generator)(this,function(F){switch(F.label){case 0:return t=i(Object(l.a)({sourceFile:c.b},I)).sourceFile,s=i(Object(h.a)({listItemUploader:_.Mb})).listItemUploader,w=void 0===s?o.a:s,[4,i(w(e))];case 1:return j=F.sent().itemKey,S=new p.a,O&&t&&S.resolveItems({items:(T={},T[O]=Object(r.__assign)(Object(r.__assign)({},d.f.pack({itemKey:j})),Object(u.c)({progressSize:d.q},{progressSize:{current:t.size}})),T)}),S.invalidateItems({items:(U={},U[n]=[m.b],U)}),v.listFullUrl&&(A=new f.a(v.listFullUrl+"/Forms").path,v.rootFolder&&(v.rootFolder+"/").slice(0,A.length+1)===A+"/"&&(k=a.a.serialize({webAbsoluteUrl:g,listFullUrl:y}),i(Object(b.a)({items:(C={},C[k]={childItemKey:j},C)})))),i(S.execute()),[2]}})})}})},WcM2:function(e,t){var n={openWithAppCommand:"Open with App",openWithCommand:"Open with {0}",createFileWithExtension:"{0} file",fileHandlerRootActionsMenu:"Actions",fileHandlerRootActionsMenuAriaLabel:"Actions available for selected items"};n.default=n,e.exports=n},XYUc:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("7YMn").a)("saveViewActionControl")},XgPe:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("17wl");function i(){return function(e){return function(e){function t(t){var i=this,a=t.context,o=void 0===a?{}:a,s=t.ariaLoader,l=void 0===s?function(){return Object(r.__awaiter)(i,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,n.e(17).then(n.t.bind(null,"WuHn",7))]})})}:s,c=(t.context,Object(r.__rest)(t,["ariaLoader","context"]));return i=e.call(this,Object(r.__assign)({ariaLoader:l,context:Object(r.__assign)({},o)},c))||this}return Object(r.__extends)(t,e),t}(e)}}},XqzB:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("7YMn"),i=n("slll"),a=new r.a("itemsContextMenuControl",{contextMenuAs:Object(i.a)({})})},Xtay:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return l});var r=n("vHN8"),i=n("nz3y"),a=n("LfMA"),o=new r.a("updateItem"),s=new a.a("updateListItem",{itemDisplayName:Object(a.f)()}),l=new i.a("updateListItemProgress",function(e,t){return s.serialize({})})},YYzJ:function(e,t,n){"use strict";var r;n.d(t,"h",function(){return d}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return p}),n.d(t,"c",function(){return b}),n.d(t,"g",function(){return f}),n.d(t,"a",function(){return h}),n.d(t,"b",function(){return _}),n.d(t,"d",function(){return g});var i="ms-word",a="onenote|UsePlain",o="ms-powerpoint",s="ms-excel",l="ms-visio",c="ms-publisher",u="ms-project",d=i,m=a,p=o,b=s,f=l,h={"ms-access":["accdb"],"ms-word":["doc","docm","docx","dot","dotm","dotx","odt"],"ms-project":["mpp"],"onenote|UsePlain":["one","onepkg","onetoc2","notebook","oneNote"],"ms-powerpoint":["odp","pot","potm","potx","ppa","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],"ms-publisher":["pub"],"ms-excel":["csv","ods","xla","xlam","xll","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],"ms-visio":["vdw","vsd","vsdm","vsdx","vsl","vss","vssm","vssx","vst","vstm","vstx"]},_={accdb:"ms-access",csv:s,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:s,odt:i,one:a,onepkg:a,onetoc2:a,mpp:u,notebook:a,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:c,vdw:l,vsd:l,vsdm:l,vsdx:l,vsl:l,vss:l,vssm:l,vssx:l,vst:l,vstm:l,vstx:l,xla:s,xlam:s,xll:s,xls:s,xlsb:s,xlsm:s,xlsx:s,xlt:s,xltm:s,xltx:s},v=((r={})["ms-access"]="Access",r[i]="Word",r[a]="OneNote",r[o]="PowerPoint",r[s]="Excel",r[l]="Visio",r[c]="Publisher",r[u]="Project",r);function g(e){return v[e]||e}},Ymtw:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spLibrariesItemSet",{webAbsoluteUrl:Object(r.f)(),types:Object(r.b)(Object(r.d)({document:1,media:2}))})},ZQAL:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r=50,i=8},ZUWj:function(e,t,n){"use strict";n.d(t,"a",function(){return U});var r=n("17wl"),i=n("oCyF"),a=n("dS01"),o=n("K9kD"),s=n("9G2s"),l=n("y88i"),c=n("sylB"),u=n("q3PD"),d=function(){function e(){var e=this.scope=new l.Scope;this._events=e.attach(new o.EventGroup(this))}return e.prototype.start=function(){},e.prototype.abort=function(){},e.prototype.dispose=function(){this.scope.dispose()},e.prototype.updateState=function(e){e!==this.state&&(this.state=e,this._events.raise("upload_state_change",e))},e}(),m=new s.a(3),p=!o.Killswitch.isActivated("72E63389-0C1B-4876-8C80-5F244AD63320","10/15/2020","Restrict retries on streaming uploads"),b=function(e){function t(t){var n=this,r=t.fileUpload;return(n=e.call(this)||this)._fileUpload=r,n._authToken=t.authToken,n._uploadId=null,n._chunkNumber=0,n._streamingChunkNumber=0,n._currentChunkSize=8388608,n._currentStreamingChunkSize=262144e3,n._onProgress=t.onProgress,n._dataRequestor=t.dataRequestor,n._async=n.scope.attach(new o.Async(n)),n.totalBytes=r.size,n.uploadedBytes=0,n.fileName=r.name,n.iconName=t.iconName,n.state=0,n.error=null,n.nameConflictBehavior=0,n.allowRename=!1,n.supportsVersioning=!0,n._expandAllItemFields=t.expandAllItemFields,n._uniqueId=t.uniqueId,n._parentItemKey=t.parentItemKey,n._targetItemKey=t.targetItemKey,n._serverRelativeItemUrl=t.serverRelativeItemUrl,n._webApiUrl=t.webApiUrl,n}return Object(r.__extends)(t,e),t.prototype.start=function(){var e=this;this.updateState(0);var t=m.enqueue(function(){return e.error=void 0,e.updateState(1),e._upload().then(function(){e.updateState(2)},function(t){var n;return n=t instanceof u.a?t:new u.a({message:t&&t.message||"",errorType:c.a.general}),e.error=n,e.updateState(4),o.Promise.reject(t)})});return this._uploadPromise=t,t},t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null,this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0,t&&(t.cancel(),t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()}))}},t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0,n?(n.cancel(),e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})):e=o.Promise.resolve(),e.done(function(){t.start()})},t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;return n<=25165824?e=this._sendSingleRequestUpload():(this._maxUploadRequestDuration=15e4,e=this._sendStreamingUpload()),e.then(function(e){t.uploadedBytes=n,t.item=e})},t.prototype._createUploadError=function(e){var t,n,r,i;switch("string"==typeof e?r=String(e):(t=this._getErrorCode(e),n=e.status,r="string"==typeof e.message?String(e.message):e.message.value),t){case-2130575257:i=c.a.conflict;break;case-1:i=c.a.disconnected;break;case-2130575245:i=c.a.invalidName;break;case-2130246326:i=c.a.versionMismatch;break;case-2147023080:case-2130575282:i=c.a.overQuota;break;default:switch(n){case 401:i=c.a.authFailure;break;case 404:i=c.a.targetFolderMissing;break;case 403:case 429:i=c.a.accessDenied;break;case 409:i=c.a.conflict;break;case 412:i=c.a.versionMismatch;break;case 415:i=c.a.emptyFileOrFolder;break;case 423:i=c.a.lockMismatch;break;case 507:i=c.a.overQuota;break;default:r?i||(i=c.a.other):i=c.a.general}}return new u.a({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})},t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]},t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):f(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var a="ListItemAllFields";return this._expandAllItemFields&&(a+="/ContentType/Fields"),a&&(n=n.oDataParameter("$Expand",a)),n.toString()},t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return o.Promise.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;return n=(n=f(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+l.UriEncoding.encodeRestUriStringToken(this._fileUpload.name)+"'"),this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!(!(n&&n.d&&n.d.results&&n.d.results.length>0)||n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!o.Promise.isCanceled(e)&&o.Promise.reject(e)})},t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)},t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var a=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var s=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(s.length>0)for(var c=0,u=s;c<u.length;c++){var d=u[c];if(!n.ListItemAllFields[d.InternalName]){a=!0;break}}}var m=void 0;n.UniqueId&&(m=o.Guid.normalizeLower(n.UniqueId));var p=n.Name,b=l.getFileExtension(p);t={key:r,parentKey:this._parentItemKey,type:o.ItemType.File,id:n.ServerRelativeUrl,name:p,displayName:p,extension:b,properties:{ID:i,uniqueId:m},itemFromServer:n,hasMissingMetadata:a}}catch(e){}return t},t.prototype._generateChunkPostUrl=function(e,t){var n,i=this._fileUpload,a=this._uniqueId,o=i.size<=t,s=this._serverRelativeItemUrl,l=this._webApiUrl,c={uploadId:{guid:this._uploadId}};return 0===this._chunkNumber&&0===this._streamingChunkNumber?(n="StartUpload",l=(l=a?l.method("GetFolderById",a):f(l,{serverRelativeItemUrl:s,isFolder:!0})).segment("Files"),l=1===this.nameConflictBehavior?l.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):l.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})):(n=o?"FinishUpload":"ContinueUpload",l=f(l,{serverRelativeItemUrl:s+"/"+i.name,isFolder:!1}),c=Object(r.__assign)(Object(r.__assign)({},c),{fileOffset:e})),(l=l.methodWithAliases(n,c)).toString()},t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,r=this._webApiUrl;return r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}}),this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){return e.d&&e.d.ExpectedContentRange?parseInt(e.d.ExpectedContentRange.split("-")[0],10):o.Promise.reject(new Error("No expected range from server response."))})},t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0),void 0===t&&(t=3);var r=this._fileUpload.size,i=Math.min(this._currentChunkSize+e,r);this._uploadId||(this._uploadId=o.Guid.generate());var a=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,i),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,i),offset:e,length:i-e}).then(function(e){return n.uploadedBytes=i,i<r?(n._chunkNumber++,Date.now()-a<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,1/4)),62914560)),n._uploadFragment(i)):n._processUploadCompleteResponse(e)},function(r){if(o.Promise.isCanceled(r))return o.Promise.reject(r);if(-2===n._getErrorCode(r)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var i=void 0;return 0===n._chunkNumber&&(i=n._cancelChunkUpload()),o.Promise.resolve(i).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(r)){var a,s=new l.Signal(function(){a&&n._async.clearTimeout(a)});return a=n._async.setTimeout(function(){return s.complete()},1e3),s.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return o.Promise.reject(n._createUploadError(r))})},t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new u.a({message:"",errorType:c.a.conflict});return o.Promise.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){return o.Promise.isCanceled(t)?o.Promise.reject(t):-2===e._getErrorCode(t)?(e.nameConflictBehavior=1,e._uploadFragment()):o.Promise.reject(e._createUploadError(t))})})},t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0),void 0===t&&(t=3),this._uploadId||(this._uploadId=o.Guid.generate());var r=this._fileUpload.size,i=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,r):0;return this._isConflictFile().then(function(t){if(t){var r=new u.a({message:"",errorType:c.a.conflict});return o.Promise.reject(r)}return n._fileUpload.slice(e,i)}).then(function(a){return n._sendFileData({url:n._generateChunkPostUrl(e,i),qosName:"SingleFileUploader.SendFileRequest",data:a,offset:e,length:a.size}).then(function(e){return n.uploadedBytes=i,i<r?(n._streamingChunkNumber++,n._sendStreamingUpload(i,t)):n._processUploadCompleteResponse(e)},function(r){return o.Promise.isCanceled(r)?o.Promise.reject(r):-2===n._getErrorCode(r)?n._currentStreamingChunkSize<=1048576?o.Promise.reject(n._createUploadError(r)):(n._currentStreamingChunkSize=n._currentStreamingChunkSize/2,n._sendStreamingUpload(e,t)):n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,p?t-1:3)},function(e){if(t>0&&n._canRetry(r)){var i,a=new l.Signal(function(){i&&n._async.clearTimeout(i)});return i=n._async.setTimeout(function(){return a.complete()},1e3),a.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return o.Promise.reject(n._createUploadError(r))})})})},t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t},t.prototype._cancelChunkUpload=function(){var e=this._uploadId;if(this._uploadId=void 0,this._chunkNumber=0,e){var t=this._fileUpload,n=this._serverRelativeItemUrl,r=this._webApiUrl;return r=(r=f(r,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}}),this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return o.Promise.resolve()},t.prototype._sendFileData=function(e){var t,n,r,i=this,a=e.url,o=e.qosName,s=e.data,c=e.offset,u=e.length,d=new l.Signal(function(){t.cancel()}),m=function(e){var t=i._chunkNumber>0&&c+u>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n),e&&(n=i._async.setTimeout(function(){d.error({code:"-1",message:""})},r))},p=Date.now(),b=Date.now(),f=0,h=0,_=0,v=this._async.debounce(function(e){e>i.uploadedBytes&&(i.uploadedBytes=e,i._onProgress&&i._onProgress(e))},100,{leading:!1});t=this._dataRequestor.getData({url:a,noRedirect:!0,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:s,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();h+=(e.loaded-f)/(t-b),_++,r=e.loaded/(t-p),b=t,f=e.loaded,v(c+e.loaded),m(u-e.loaded)}}}),m(u);var g=this._async.setInterval(function(){_&&Date.now()-p+(u-f)/((h+r)/(_+1))>i._maxUploadRequestDuration&&f<u&&d.error({code:"-2",message:""})},1e4);return t.done(function(e){d.complete(e)},function(e){d.error(e)}),d.getPromise().done(function(){n&&i._async.clearTimeout(n),g&&i._async.clearInterval(g)},function(){t.cancel(),n&&i._async.clearTimeout(n),g&&i._async.clearInterval(g)}),d.getPromise()},t}(d);function f(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}var h=n("NX6U"),_=n("oveG"),v=n("LNaD"),g=n("GQoE"),y=n("vLsd"),I=n("Rr4e"),O=n("vHN8"),w=n("H8DK"),j=n("6Pju"),S=n("Ql3v"),A=n("F0Gs"),k=n("9kMg"),T=n("9Zk4");function U(e){var t=this,n=e.itemKey,o=e.options.sourceEntries,s=i.a.deserialize(n),l=s.webAbsoluteUrl,c=s.listFullUrl,u=Object.keys(o)[0],d=o[u],m=d.progressItemKey,p=d.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,d,f,U,C,F,P,E,x,D,L,N,K,R,z,q,M,G,V,B,H,W,J,Z;return Object(r.__generator)(this,function(Q){switch(Q.label){case 0:return t=e(Object(h.c)({webAbsoluteUrl:l,listFullUrl:c})),o=t.dataRequestor,d=t.hasDigest,t.hasTokenProvider?(U=void 0,[3,3]):[3,1];case 1:return[4,e(Object(h.a)({url:l||c,disallowCookies:!d}))];case 2:U=Q.sent(),Q.label=3;case 3:if(f=U,C=e(Object(g.a)({sourceFile:y.b},u)).sourceFile,F=e(Object(g.a)({folderPath:_.hb},n)).folderPath,P=void 0===F?s.rootFolder:F,!C)throw new Error("No source file for upload.");if(!P)throw new Error("No path information for target folder.");E=Object(j.d)({webAbsoluteUrl:l,listOrItemFullUrl:c}),x=new v.Async(void 0),D=x.debounce(function(t){var n;m&&e(Object(I.a)({items:(n={},n[m]=Object(O.c)({progressSize:w.q},{progressSize:{current:t}}),n)}))},300,{leading:!1}),L=e(Object(S.a)(function(e){return e.demandItemFacet(_.Ib,a.a.serialize({webAbsoluteUrl:l,listFullUrl:c}))})),N=L&&L.contentTypesEnabled&&L.templateType!==k.a.mySiteDocumentLibrary,(K=new b({authToken:f,dataRequestor:o,parentItemKey:"",targetItemKey:"",fileUpload:C,iconName:"",serverRelativeItemUrl:P,webApiUrl:E,onProgress:D,expandAllItemFields:N})).nameConflictBehavior="replace"===p?1:0,m&&e(Object(I.a)({items:(J={},J[m]=Object(r.__assign)({},w.q.pack({total:C.size,current:0})),J)})),R=K.start(),z=e(Object(S.a)(function(e){return e.demandItemFacet(w.e,m)})),q=z?z.token.subscribe(function(){K.abort()}):void 0,Q.label=4;case 4:return Q.trys.push([4,6,7,8]),[4,R];case 5:return Q.sent(),[3,8];case 6:throw M=Q.sent(),K.abort(),Object(T.b)(M);case 7:return q&&q(),K.dispose(),[7];case 8:return G=K.item,V=G.properties,B=V&&V.ID||G.id,H=V&&V.uniqueId,W=i.a.serialize({webAbsoluteUrl:l,listFullUrl:c,itemId:B}),e(Object(I.a)({items:(Z={},Z[W]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},A.h.pack(G.displayName)),G.id?_.hb.pack(G.id):{}),H?_.kd.pack(H):{}),A.A.pack({itemKey:n})),Z)})),[2,{itemKey:W}]}})})}}},ZXWq:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n("17wl"),i=n("12Fv"),a=n("VRCL"),o=n("/ZMm"),s=n("F0Gs"),l=n("h0t6"),c=Object(i.a)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var c=e.demandItem({fileName:s.j,isFolder:s.l},n),u=c&&c.fileName,d=u&&u.extension||"",m=c&&c.isFolder||!1;o=Object(a.b)(i.availableOn,d,Boolean(m))}var p=i.handler,b=p.appId,f=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",h={appId:b};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(l.b)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:h}}))})(a.a),u=Object(o.f)()(Object(o.d)()(c))},ZvAv:function(e,t){var n={assignToGroupStartedItemsTitle:"Moving {0} item to group {1}||Moving {0} items to group {1}",assignToGroupCompletedItemsTitle:"Moved {0} item to group {1}||Moved {0} items to group {1}",assignToGroupFailedItemsTitle:"{0} item wasn\u0027t moved||{0} items weren\u0027t moved",assignToGroupTitleIntervals:"1||2-"};n.default=n,e.exports=n},ajZD:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spAllSitesKeyFacet",{tenantRootUrl:Object(r.f)()})},bezv:function(e,t,n){"use strict";function r(e){for(var t=e,n="",r=0,i=void 0,a=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|a)||(o="=",a%1);n+=o.charAt(63&r>>8-a%1*8)){if((i=t.charCodeAt(a+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}n.d(t,"a",function(){return r})},c1lE:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n("3SfB");function i(e){switch(e){case r.a.Word:return".docx";case r.a.Excel:case r.a.ExcelSurvey:case r.a.ExcelForm:return".xlsx";case r.a.PowerPoint:return".pptx";case r.a.OneNote:return"";case r.a.Text:return".txt";case r.a.Visio:return".vsdx";case r.a.Bohemia:return".b";case r.a.Prague:return".prague"}}function a(e,t){var n="";switch(e){case r.a.Word:n=t.CreateWord;break;case r.a.Excel:n=t.CreateExcel;break;case r.a.PowerPoint:n=t.CreatePowerPoint;break;case r.a.OneNote:n=t.CreateOneNote;break;case r.a.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.a.Text:n=t.CreateText;break;case r.a.ExcelForm:n=t.CreateFormForExcel;break;case r.a.Visio:n=t.CreateVisio;break;case r.a.Bohemia:n=t.CreateBohemia;break;case r.a.Prague:n=t.CreatePrague}return n}},czUR:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var r=n("y7lx"),i=n("ynV5");function a(e,t,n){var r=void 0;return"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(r=i.format(n?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError,r}function o(e,t,n,i){var a="";return null!==e&&""!==e&&(a=t===r.a.ExcelSurvey?e.replace("action=edit","action=formedit"):t===r.a.ExcelForm?function(e,t,n){var r=e.replace("&action=edit",""),i=n?"forms.officeppe.com":"forms.office.com",a="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(a)}(e,n,i):e.replace("action=edit","action=editnew")),a}},dRAu:function(e,t){var n={mountPointNotFoundErrorTitle:"This shortcut no longer works",mountPointNotFoundErrorMessage:"{0} has been deleted or you  no longer have permission to view it",mountPointNotFoundDefaultErrorMessage:"This item has been deleted or you  no longer have permission to view it",removeThisShortcut:"Remove this shortcut"};n.default=n,e.exports=n},djFM:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return b});var r,i,a=n("17wl");!function(e){e[e.ContextMenu=0]="ContextMenu",e[e.RibbonDocuments=1]="RibbonDocuments",e[e.RibbonList=2]="RibbonList"}(r||(r={})),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(i||(i={}));var o=n("vyKV"),s=n("mflv"),l=n("SltW"),c=n("K9kD"),u=n("ynV5"),d=n("y88i");function m(e,t){var n=[],r=[],o=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var l=new DOMParser,d=function(e){var d=e.Location,m=e.RegistrationType;if(d&&0===d.lastIndexOf("ClientSideExtension.ListViewCommandSet",0)){if(!m||m!==i.List)return"continue";var p="ClientSideExtension.ListViewCommandSet"===d,b="ClientSideExtension.ListViewCommandSet.ContextMenu"===d||p,g="ClientSideExtension.ListViewCommandSet.CommandBar"===d||p,O={text:e.Title,isEnabled:function(){return I({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};b&&o.push(O),g&&(t.isDocumentLibrary?n.push(Object(a.__assign)({},O)):r.push(Object(a.__assign)({},O)))}else{if(!f(e.UrlAction))return"continue";if(e.CommandUIExtension&&u.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var w=h(e,t,!0),j=h(e,t,!1),S=void 0;try{S=l.parseFromString(e.CommandUIExtension,s.b.doctype)}catch(e){}if(!S)return"continue";var A=S.getElementsByTagName("Tab");if(A&&0!==A.length||(A=S.getElementsByTagName("Group")),A&&A.length>0){var k=_(A,!0),T=_(A,!1),U={};if(k||T)for(var C=0,F=S.getElementsByTagName("CommandUIHandlers");C<F.length;C++)for(var P=F[C].firstElementChild;P;)U[P.getAttribute("Command")]=P.getAttribute("CommandAction"),P=P.nextElementSibling;if(k){var E=v(k,U,e,w);n.push(E)}T&&(E=v(T,U,e,j),r.push(E))}else{var x=S.getElementsByTagName("Button"),D=y(x,!0,e,w);D&&n.push(D);var L=y(x,!1,e,j);L&&r.push(L)}}else if("EditControlBlock"===e.Location&&e.Title){var N={text:e.Title,isEnabled:h(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:c.Guid.Empty,clientSideComponentProperties:""};o.push(N)}}},m=0,p=e;m<p.length;m++)d(p[m]);return{"Ribbon.Documents":n,"Ribbon.List":r,ContextMenu:o}}function p(e){return"children"in e}function b(e,t,n){var r=n.webAbsoluteUrl+"/",i=n.layoutsUrl+"/",a=""+r+i,o=n.siteAbsoluteUrl+"/",s=""+o+i,l="",c=n.listId,u=n.listUrl;if(0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(c=c.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D")),l=e.replace(/{SiteUrl}/g,r).replace(/~site\//g,r).replace(/~layouts\//g,i).replace(/~siteLayouts\//g,a).replace(/~siteCollection\//g,o).replace(/~siteCollectionLayouts\//g,s).replace(/{ListId}/g,c).replace(/{SelectedListId}/g,c).replace(/{ListUrlDir}/g,u).replace(/{Source}/g,d.UriEncoding.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true"),t.length>0){var m=t.map(function(e){return e.id}).join(","),p=t[0].id,b=t[0].url;l=l.replace(/{ItemUrl}/g,d.UriEncoding.encodeURIComponent(b)).replace(/{ItemId}/g,p).replace(/{SelectedItemId}/g,m)}else l=l.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return l}function f(e){return!e||"javascript:"!==e.substring(0,11).toLowerCase()||Object(l.b)(e,!1)}function h(e,t,n){var r=void 0===n||n===t.isDocumentLibrary;if(e.CommandUIExtension&&e.EnabledScript)return r||!0;var i=I({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!i&&("function"==typeof i?"function"==typeof r?function(e){return i(e)&&r}:i:r)}function _(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],a=i.getAttribute("Id");if(!a)return i;if((t||!u.doesStringStartWith(a,"Ribbon.Documents"))&&!(t&&u.doesStringStartWith(a,"Ribbon.List")||u.doesStringStartWith(a,"Ribbon.Calendar")))return i}return null}function v(e,t,n,r){for(var i=[],a=e.getElementsByTagName("Button"),o=0,s=a.length;o<s;o++){var l=a[o],u=l.getAttribute("Command"),d=u&&t[u]||n.UrlAction;if(f(d)){var m={text:l.getAttribute("LabelText"),iconUrl:g(l),isEnabled:r,allowMultiSelect:!n.EnabledScript,action:d,clientSideComponentId:c.Guid.Empty,clientSideComponentProperties:""};i.push(m)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:i}}function g(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function y(e,t,n,r){var i;if(("boolean"!=typeof r||r)&&(e&&e.length>0&&(i=_(e,t)),i)){var a=i.getAttribute("LabelText")||n.Title;if(a){var o={text:a,allowMultiSelect:!n.EnabledScript,action:n.UrlAction,isEnabled:r,clientSideComponentId:c.Guid.Empty,clientSideComponentProperties:""},s=g(e[0]);return s&&(o.iconUrl=s),o}}}function I(e,t){var n=function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return o.a.hasItemPermission(t,e.rights)}}(e,t),r=function(e,t){var n=e.registrationType,r=e.registrationId;if(!r)return n===i.List;switch(n){case i.List:return parseInt(r,10)===t.listTemplate||r===t.listId;case i.FileType:var a="."+r;return function(e){return u.equalsCaseInsensitive(e.extension,a)};case i.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&u.doesStringStartWith(t,r)};case i.ProgId:return function(e){return("progId"in e&&e.progId||"properties"in e&&e.properties.ProgId)===r}}return!1}(e,t);return!(!n||!r)&&function(e){return!(!e||"function"==typeof n&&!n({permissions:e.permissions})||"function"==typeof r&&!r(e))}}},dnQb:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return c});var r,i=n("K9kD");!function(e){e.SharePointList="SharePointList"}(r||(r={}));var a={ODB:1620},o={ODB:60063},s={ODB:1287},l={ODB:60177};function c(e,t){return e(s)?!!i.Killswitch.isActivated("b23d2c9d-f690-4d59-953b-374afd7ae908","2/8/2021")||(/[?&]enableNucleusPreview=false/.test(location.search)?(u(!1),!1):/[?&]enableNucleusPreview=true/.test(location.search)?(u(!0),!0):"false"!==window.localStorage.NucleusSyncEnabled):e(a)&&(window.localStorage&&"true"===window.localStorage.NucleusPreviewEnabled||/[?&]enableNucleusPreview=true/.test(location.search))}function u(e){var t,n;e?null===(n=window.localStorage)||void 0===n||n.removeItem("NucleusSyncEnabled"):null===(t=window.localStorage)||void 0===t||t.setItem("NucleusSyncEnabled","false")}},eddL:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var r=n("oveG"),i=n("F0Gs"),a=n("vyKV"),o=n("EdJH");function s(e,t){var n=t.itemKey,r=t.includeOneNote,a=e.demandItem({folder:i.l,oneNote:o.e},n),s=a.folder,l=a.oneNote;return r?!!s||!!l:!!s&&!l}function l(e,t){var n=t.itemKey,o=t.listFacets,s=!!o&&!!o.isModerated;if(s){var l=e.demandItem({permissions:r.fc,checkoutInfo:i.p},n),c=l.permissions,u=l.checkoutInfo;s=!(u&&(u.byOther||u.byYou))&&!!c&&a.a.hasItemPermission({permissions:c},a.a.editListItems)&&a.a.hasItemPermission({permissions:c},a.a.approveItems)}return s}},"fKe+":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var r=n("NX6U"),i=n("6Pju"),a=n("9kMg"),o=n("ftiL");function s(e){return function(t){return t(Object(r.d)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:d(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){var n=c(t,!1,e.listTemplate);return t&&n&&!t.ViewData&&(t.ViewData=n.viewData),{serverView:t,view:n}})},noRedirect:!0}))}}function l(e){return function(t){return t(Object(r.d)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:d(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:c(t,!0)}},noRedirect:!0}))}}function c(e,t,n){if(e.ViewType&&e.Id){var r=o.a.isAppView(e),i=e.Hidden&&!r,s=n===a.a.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!s){var l=new o.a(e);if(l.viewType)return l}}}var u=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function d(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,a=Object(i.a)({webAbsoluteUrl:t,listFullUrl:n});return(a=r?a.method("Views",r):a.segment("Views")).oDataParameter("$select",u).toString()}},frCt:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("customActionSetWithExtensionsKeyFacet",{webAbsoluteUrl:Object(r.f)(),listFullUrl:Object(r.f)(),isSPFXandCustomActionsAvailable:Object(r.c)(),targetCustomActionSetKey:Object(r.f)(),itemsScopeItemKey:Object(r.f)()})},gah9:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("LfMA"),i=n("zwgV"),a=new r.a("spSharedByMePage",{itemSet:Object(r.g)(i.a),after:Object(r.f)()})},"h+D8":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("pinnedItem",{rootItemKey:Object(r.f)(),itemKey:Object(r.f)()})},hr5y:function(e,t,n){"use strict";n.r(t),n.d(t,"getListRootFolder",function(){return o});var r=n("17wl"),i=n("NX6U"),a=n("6Pju");function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,s=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=Object(a.a)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder"),[4,e(Object(i.d)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+s,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}},irYs:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("modifyColumnAggregateType"),o=Object(i.e)({operationTypeFacet:a})},iy8a:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("17wl"),i=n("oCyF"),a=n("oveG"),o=n("wJkO"),s=n("Ql3v");function l(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,l,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=n(Object(s.a)(function(t){return t.demandItemFacet(i.a,e)})),[4,n(Object(o.a)(function(t){return t.demandItem({listItemId:a.Lb},e)}))];case 1:if(l=r.sent().listItemId,!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(c=l||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:c}]}})})}}},jCHr:function(e,t,n){"use strict";n.d(t,"b",function(){return v}),n.d(t,"a",function(){return I});var r=n("+Grl"),i=n("oCyF"),a=n("dS01"),o=n("62nM"),s=n("oveG"),l=n("9kMg"),c=n("JI8f"),u=n("y88i"),d=n("DOzE"),m=n("VSW6"),p=n("F0Gs"),b=n("UbrB"),f=n("XIjh"),h=n("MQWL"),_=n("K9kD"),v=Object(r.a)()(function(){return function(e){return y}}),g={ODB:1928};function y(e,t){var n=t.itemKey,r=t.desiredSize,c=e.demandItemFacet(i.a,n);if(!c)return{};var u=function(e,t){var n=t.desiredSize,r=I(e,{itemKey:t.itemKey,spItem:t.spItem});if(r)return{url:r(Math.ceil(n.width),Math.ceil(n.height)),width:0,height:0}}(e,{itemKey:n,spItem:c,desiredSize:r})||function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(o.b,n),a=i&&i(r.width,r.height);if(a)return{url:a,width:0,height:0}}(e,{itemKey:n,desiredSize:r})||function(e,t){var n=t.spItem,r=t.itemKey,i=a.a.serialize(n),c=e.demandItemFacet(s.Ib,i);if(c){var u=c.templateType===l.b.publishingAsset;if(c.isPromotedLinks||u){var d=e.demandItemFacet(s.tc,r),m=void 0;if(c.isPromotedLinks?m=d&&d.BackgroundImageLocation:u&&d&&d.AlternateThumbnailUrl&&(m=e.demandItemFacet(o.a,r)),m)return{url:m,width:0,height:0}}}}(e,{spItem:c,itemKey:n});return u?{thumbnail:u}:{}}function I(e,t){var n=t.itemKey,r=t.spItem,i=Object(c.a)(e,{enableSharePointDirectThumbnails:s.W,spCookieDomainConfiguration:s.Bc}),a=i.enableSharePointDirectThumbnails,o=void 0===a||a,l=i.spCookieDomainConfiguration,v=Object(h.a)(e,n);if(o&&Object(f.a)(e,{pageContext:v,feature:g})&&v&&!Object(_.getKillSwitch)(v).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var y=r.webAbsoluteUrl,I=r.listFullUrl,O=new u.SimpleUri(y||I).authority;if(l&&l===O){var w=O+"/_api/v2.1",j=e.demandItemFacet(d.a,n),S=e.demandItemFacet(p.i,n)||"";if(j){var A=j.driveId,k=j.itemId,T=Object(m.a)({endpoint:w,driveId:A,itemId:k});return function(e,t){return T+"/thumbnails/0/c"+e+"x"+(t=t||e)+"/content?"+Object(b.a)({prefer:"noredirect,closestavailablesize",cb:S})}}}}}},jj1g:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n("17wl"),i=n("3HEj"),a=n("dq6a"),o=n("pVWH"),s=n("K9kD"),l=n("P8RM"),c={ODB:1286},u=(function(){function e(e,t){this._dataRequestor=new l.a({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&s.FeatureOverrides.isFeatureEnabled(c)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",s.DataStoreCachingType.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue("DisableSubstrateSearch",!0,s.DataStoreCachingType.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return s.Promise.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new s.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken("https://outlook.office.com/search").then(function(e){return t.end({resultType:s.ResultTypeEnum.Success}),e},function(n){return s.Promise.isCanceled(n)?(t.end({resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),s.Promise.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.ResultTypeEnum.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t="https://outlook.office.com/search/api/v1/init?scenario=documentshare";s.Killswitch.isActivated("20373606-dfd1-4220-9a96-50f93570a877","07/03/2020","Removing litoken while calling Substrate.")?this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1}):this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.DataStore("PeoplePicker",s.DataStoreCachingType.session))}}(),n("h/Eh")),d=n("xkft"),m=n("QVYh"),p=n("UHMa"),b=n("y88i"),f=function(e){function t(t,n){var r=this,i=h(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var a=h(t)?t.apiUrlHelper:n.apiUrlHelper;return r._apiUrlHelper=a||new u.a({},{itemUrlHelper:new d.a({},{pageContext:i}),pageContext:i}),r._capabilities={supportsMruCaching:!0},n&&(r._dataRequestor=n.dataRequestor,r._graphPeoplePickerHelper=n.graphPeoplePickerHelper,r._substratePeoplePickerHelper=n.substratePeoplePickerHelper,r._livePeoplePickerHelper=n.livePeoplePickerHelper,r._getAuthToken=n.getAuthToken),r._invalidPeopleSubTypesKSActivated=s.Killswitch.isActivated("daa1be46-12ff-45a4-8c9f-9b3c0f174853","01/19/2021","Ignore invalid PeopleSubtypes."),r}return Object(r.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return s.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,a={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};return a.personDetails.profilePage=Object(i.b)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(a.personDetails.sip)+"&origin=ProfileODBCard",a}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===o.a.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return s.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return s.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),a=[];a[0]=i,s.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(a[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(a[0].DisplayText=i.Key);var l=(a=n._transformData(a,t.filterExternalUsers))[0];return t.filterExternalUsers&&l&&1===l.entityType?(l.isResolved=!1,l.entityType=0):t.blockViaPolicy&&!t.filterExternalUsers&&l&&!l.isResolved&&0===l.multipleMatches.length&&(l.isResolved=!0,l.isExternal=!0,l.entityType=1),t.isGraphDistributionList&&t.useGraph&&l.isExternal&&(l.entityType=2,l.principalType=o.a.distributionList),l}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new l.b({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new l.b({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),s.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,a=void 0===i||i,l=t.filterExternalUsers,c=t.forceResolve,u=JSON.parse(r),d=JSON.parse(u.d.ClientPeoplePickerSearchUser),m=n._transformData(d,l);l&&(m=m.filter(function(e){return 1!==e.entityType}));var p=!m.length;if(m=m.filter(function(e){return e.principalType===o.a.sharePointGroup?a:e.principalType===o.a.securityGroup?a||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),s.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))c&&p&&m.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===m.length&&n._isValidEmail(e,!1)){var b={Key:e,IsResolved:!1};m.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:b,rawPersonData:b,isExternal:!0})}return m}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,r),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null},t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var a=new s.Uri("https://graph.microsoft.com/v1.0/me/people");if(e)if(a.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),s.Killswitch.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&a.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&a.setQueryParameter("$filter",l)}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:a.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,a=[];if(i.forEach(function(e){if(r._invalidPeopleSubTypesKSActivated||!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,s={Key:i,IsResolved:!1},l="ImplicitContact"===e.personType.subclass,c="OrganizationUser"===e.personType.subclass,u="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,d="PublicDistributionList"===e.personType.subclass,p=Object(m.getUserPhotoUrl)(t),b={department:e.department,email:t,image:l?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:c?"Provider":void 0,userId:i,rawData:s,rawPersonData:s,isExternal:!c,aadObjectId:e.id};c?(b.entityType=0,b.principalType=o.a.user,b.isResolved=!0):u?(b.entityType=2,b.principalType=o.a.securityGroup,b.isResolved=!1,b.userId=e.id):(b.principalType=d?o.a.distributionList:o.a.none,b.entityType="Group"===e.personType.class?2:1,b.isResolved=!1,b.providerName=void 0),b.userId&&a.push(b)}}),!1!==n.resolveEmailIfNoResults&&0===a.length&&r._isValidEmail(e,!1)){var s={Key:e,IsResolved:!1};a.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:s,rawPersonData:s,isExternal:!0})}return a},function(t){if(Object(p.f)(t))switch(t.status){case 400:case 401:case 403:case 404:return r._graphPeoplePickerHelper.disableGraphCallsForPicker(),r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var a,l=["Directory"];return s.Killswitch.isActivated("9403ac4d-b51a-48b3-a4c0-9007477f73ea","02/18/2020","Mailbox Searching in Substrate People Suggestions.")||l.splice(0,0,"Mailbox"),a=s.Killswitch.isActivated("04f09a5b-1c0f-42ef-9b9f-ba8c1e321810","07/03/2020","Removing litoken in Substrate call.")?{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r}:{Authorization:"Bearer "+r},n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"https://outlook.office.com/search/api/v1/suggestions",headers:a,needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:l,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],a=[];if(i.forEach(function(e){if(n._invalidPeopleSubTypesKSActivated||!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,s={Key:i,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,c="OrganizationUser"===e.PeopleSubtype,u="LinkedIn"===e.PeopleSubtype,d="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,b=Object(m.getUserPhotoUrl)(r),f={department:e.Department,office:e.OfficeLocation,email:r,image:l?void 0:b,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:s,rawPersonData:s,isExternal:!c};c?(f.entityType=0,f.principalType=o.a.user,f.isResolved=!0):d?(f.entityType=2,f.principalType=o.a.securityGroup,f.isResolved=!1,f.providerName=void 0):u?f.entityType=4:(f.principalType=p?o.a.distributionList:o.a.none,f.entityType="Group"===e.PeopleType?2:1,f.isResolved=!1,f.providerName=void 0),f.userId&&a.push(f)}}),!1!==t.resolveEmailIfNoResults&&0===a.length&&n._isValidEmail(e,!1)){var s={Key:e,IsResolved:!1};a.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:s,rawPersonData:s,isExternal:!0})}return a},function(r){return"Canceled"!==r.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t)),null})})},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&b.EmailAddressParser.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){if(e.principalType===o.a.user)return"personType/class ne 'Group'";var t="";return e.principalType&o.a.distributionList||(t+="personType/subclass ne 'PublicDistributionList'"),e.principalType&o.a.securityGroup||(t&&(t+=" and "),t+="personType/subclass ne 'UnifiedGroup'"),t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};i.multipleMatches.length>0&&(i.multipleMatches=n._transformData(i.multipleMatches,t),t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType})));var a=i.email;i.isResolved&&(i.image=a?Object(m.getUserPhotoUrl)(a):null);var s=r.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1,i.principalType=o.a.user,i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2,i.principalType="SharePointGroup"===s?o.a.sharePointGroup:o.a.securityGroup;break;default:i.entityType=0,i.principalType=o.a.user}return i})},t}(a.b);function h(e){return!!e.webAbsoluteUrl}},jyAd:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n("cDcd"),i=n("hR5Q"),a=n("LbJS"),o=n("KL1q"),s=n("HHDc"),l=n("F0Gs"),c=n("4Oaa"),u=n("26LT"),d=n("XsBk"),m=function(e){var t=e.itemKey,n=e.action;return r.createElement(i.a,null,function(i){var m,p=i.itemCache;if(e.children)m=e.children;else{var b=p.demandItemFacet(l.h,t);m=b}var f=Object(c.a)(p),h=!n&&function(e,t){var n=Object(u.a)(e,{itemKey:t.itemKey1}),r=Object(u.a)(e,{itemKey:t.itemKey2});return Object(d.a)(e,{itemKey:n})===Object(d.a)(e,{itemKey:r})}(p,{itemKey1:t,itemKey2:f})||!t?null:r.createElement(s.a,{itemKey:t});return r.createElement(a.c,{action:h},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?r.createElement(o.Link,{onClick:i},m):r.createElement("span",null,m)})})}},jziX:function(e,t){var n={emptyNameError:"You can\u0027t leave this blank.",invalidNameError:"Please enter a name that doesn\u0027t include any of these characters: {0}.",invalidNameStartError:"File or folder names can\u0027t begin with: {0}",invalidNameEndError:"File or folder names can\u0027t end with: {0}"};n.default=n,e.exports=n},kAty:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("nz3y"),a=new r.a("updateCheckoutState"),o=new i.a("checkout");Object(i.f)({operationTypeFacet:a,progressKeyFacet:o})},lMcC:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return c});var r,i=n("XkN0"),a=n("jziX"),o=n.n(a);function s(e){return function(t){return function(e,t){switch(e){case r.InvalidCharacters:return i.format(o.a.invalidNameError,t.invalidCharacters);case r.InvalidStart:return i.format(o.a.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return i.format(o.a.invalidNameEndError,t.cannotEndWith);case r.Empty:return o.a.emptyNameError;case void 0:return}}(function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0}(t,e),e)}}!function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(r||(r={}));var l=s({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),c=s({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},m0uK:function(e,t){var n={MissingMetadataDialogTitle:"Missing Required Properties",MissingMetadataDialogText:"You must fill out all required properties before publishing an item.",MissingMetadataDialogButton:"Ok",schedulePublishStartedItemsTitle:"Scheduling {0} item||Scheduling {0} items",publishStartedItemsTitle:"Publishing {0} item||Publishing {0} items",publishStartedItemsTitleIntervals:"1||2-",schedulePublishStartedItemsDestinationTitle:"Scheduling {0} item from {1}||Scheduling {0} items from {1}",publishStartedItemsDestinationTitle:"Publishing {0} item from {1}||Publishing {0} items from {1}",publishStartedItemsDestinationTitleIntervals:"1||2-",schedulePublishCompletedItemsTitle:"Scheduled {0} item||Scheduled {0} items",publishCompletedItemsTitle:"Published {0} item||Published {0} items",publishCompletedItemsTitleIntervals:"1||2-",schedulePublishCompletedItemsDestinationTitle:"Scheduled {0} item from {1}||Scheduled {0} items from {1}",publishCompletedItemsDestinationTitle:"Published {0} item from {1}||Published {0} items from {1}",publishCompletedItemsDestinationTitleIntervals:"1||2-",schedulePublishFailedItemsTitle:"{0} item wasn\u0027t scheduled||{0} items weren\u0027t scheduled",publishFailedItemsTitle:"{0} item wasn\u0027t published||{0} items weren\u0027t published",publishFailedItemsTitleIntervals:"1||2-",schedulePublishFailedItemsDestinationTitle:"{0} item wasn\u0027t scheduled from {1}||{0} items weren\u0027t scheduled from {1}",publishFailedItemsDestinationTitle:"{0} item wasn\u0027t published from {1}||{0} items weren\u0027t published from {1}",publishFailedItemsDestinationTitleIntervals:"1||2-",pageNeedsRepublishing:"This page has changes that are not published yet.",pageNeedsScheduling:"This page has changes that are not published yet. Schedule your page to publish in the future.",scheduleAction:"Schedule",publishNowAction:"Publish now",republishNowAction:"Republish now",submitNowAction:"Submit for approval now"};n.default=n,e.exports=n},mCu1:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return c});var r=n("vHN8"),i=n("xznA"),a=n("nz3y"),o=n("LfMA"),s=new r.a("editPinnedItem"),l=new o.a("editPinnedItemProgressItem",{itemKey:Object(o.f)(),editType:Object(o.e)()}),c=new a.a("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return l.serialize({itemKey:n,editType:r})});Object(i.e)({operationTypeFacet:s})},mHc3:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("saveUploadedTemplateToView"),o=Object(i.e)({operationTypeFacet:a})},mNxR:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Publish=0]="Publish",e[e.Republish=1]="Republish",e[e.PostNews=2]="PostNews",e[e.UpdateNews=3]="UpdateNews",e[e.SubmitForApproval=4]="SubmitForApproval",e[e.CancelApproval=5]="CancelApproval",e[e.SchedulePublish=6]="SchedulePublish"}(r||(r={}))},mUlA:function(e,t,n){"use strict";n.d(t,"a",function(){return j}),n.d(t,"b",function(){return S});var r,i=n("xznA"),a=n("nz3y"),o=n("17wl"),s=n("XkN0"),l=n("ZvAv"),c=n.n(l),u=n("oJsO"),d=n("sqky"),m=n("SVnr"),p=n("+Grl"),b=n("ciIl"),f=n("ulBY"),h=n("kk66"),_=n("H8DK"),v=n("F0Gs"),g=((r={})[_.d.started]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(c.a.assignToGroupStartedItemsTitle,c.a.assignToGroupTitleIntervals,e)||"",e,t)},r[_.d.completed]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(c.a.assignToGroupCompletedItemsTitle,c.a.assignToGroupTitleIntervals,e)||"",e,t)},r[_.d.failed]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(c.a.assignToGroupFailedItemsTitle,c.a.assignToGroupTitleIntervals,e)||"",e,t)},r[_.d.canceled]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(c.a.assignToGroupFailedItemsTitle,c.a.assignToGroupTitleIntervals,e)||"",e,t)},r),y=Object(d.b)(function(){return function(e){e(Object(m.a)(u.b,b.a)(Object(p.a)()(O))),e(Object(m.a)(u.b,f.c)(Object(p.a)()(I)))}});function I(){return function(e){return function(e,t){return{reportMode:f.a.pin}}}}function O(){return function(e){return w}}function w(e,t){var n=t.itemKey,r=Object(a.e)(e,t),i=r.phase,s=r.count,l=g,c=e.demandItemFacet(h.a,n),d=c&&c.itemKeys,m="",p="";if(d&&d.length>0){var b=e.demandItemFacet(u.a,d[0]),f=b&&b.groupKey;f&&(m=e.demandItemFacet(v.h,f)||""),p=l[i](s,m)}else{var _=e.demandItemFacet(u.b,n);if(_){var y=_.taskKey,I=y&&e.demandItemFacet(v.h,y);I&&(p=I)}}return Object(o.__assign)({},p&&"item"!==t.format?{title:p}:{})}var j=Object(i.e)({operationTypeFacet:u.a}),S=Object(a.f)({operationTypeFacet:u.a,progressKeyFacet:u.b,initializeBatch:function(){return y}})},oJsO:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var r=n("vHN8"),i=n("nz3y"),a=new r.a("assignItemToGroup"),o=new i.a("assignToGroup")},oRIR:function(e,t,n){"use strict";n.r(t),n.d(t,"sharePointBasicActionsAddonDeferred",function(){return re});var r=n("17wl"),i=n("sqky"),a=n("xznA"),o=n("SVnr"),s=n("vnYe"),l=n("oCyF"),c=n("IG76"),u=n("Wg20"),d=n("81mP"),m=Object(i.e)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e(96).then(n.bind(null,"gDWC"))];case 1:return[4,(0,r.sent().renameItemCore)(t,e)];case 2:return r.sent(),[2]}})})}}),p=n("QroS"),b=n("R/Xa"),f=n("dS01"),h=n("oveG"),_=n("vyKV"),v=n("7wik"),g=n.n(v),y=n("+Grl"),I=n("F0Gs"),O=n("lMcC");function w(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}var j=n("9kMg"),S=n("XIjh"),A=Object(y.a)()(function(){return function(e){return function(e,t){var n,i,a=t.itemKey,o=e.demandItem({key:l.a,permissions:h.fc,isCheckedOut:I.p,isFolder:I.l,rowData:h.tc},a),s=o.key,c=o.permissions,u=o.isCheckedOut,d=o.isFolder,m=o.rowData,p=s&&e.demandItemFacet(h.Yc,b.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})),v=s&&f.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),y=(null===(n=e.demandItemFacet(h.Ib,v))||void 0===n?void 0:n.templateType)===j.b.contentCenterModelLibrary,A=Object(S.a)(e,{feature:k,pageContext:p})&&y,T=void 0,U=!1,C=O.a;if(p){T=m&&u&&!!u.byOther;var F=e.demandItemFacet(h.Tb,a,{suppressGetItems:!0}),P=w(null===(i=m)||void 0===i?void 0:i.ProgId);U=!(F||p.isAnonymousGuestUser||P)&&_.a.hasItemPermission({permissions:c},_.a.deleteListItems)&&_.a.hasItemPermission({permissions:c},_.a.editListItems)&&!A,p.supportPercentStorePath&&p.supportPoundStorePath||(C=O.b)}var E={},x=s&&e.demandItemFacet(h.Ib,f.a.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}));return T?(E.lockedWarningMessage=g.a.FileCheckedoutOrLockedWarning,E.title=g.a.FileCheckedoutOrLockedWarningTitle):x&&x.isForceCheckout&&u&&!u.byYou&&!d&&(E.lockedWarningMessage=g.a.CheckoutRequired,E.title=g.a.Error),Object(r.__assign)({isAvailable:U,validator:C,isFolder:!!d},E)}}}),k={ODB:1517},T=n("yMmz"),U=n("cDcd"),C=n("NX6U"),F=n("fmac");function P(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,r=e.webApiUrl,i=e.duration,a=void 0===i?1:i,o=e.authToken,s=r;return s=(s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",a),n.getData({url:s.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}var E=n("K9kD"),x=n("eUBi"),D=n("6Pju"),L=n("bybz"),N=n("EdJH"),K=n("JI8f"),R=n("eVX6"),z=n("UbrB"),q=n("rqqu");function M(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?U.createElement(t,Object(r.__assign)({},n,{preferOpenInBrowser:!0})):null}function G(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?U.createElement(t,Object(r.__assign)({},n,{preferSameWindow:!0})):null}var V=Object(y.a)()(H),B=Object(y.a)()(H);function H(){return function(e){var t=new q.a;return function(e,n){var i=n.itemKeys,a=i[0],o=e.demandItemFacet(I.l,a),s=e.demandItemFacet(N.e,a),c=e.demandItemFacet(h.v,a);return 1!==i.length||o||s||c?i.length>0?function(e,t){var n=t.itemKeys,i=e.demandItemFacet(l.a,n[0]);if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var a=i.webAbsoluteUrl,o=i.listFullUrl,s=f.a.serialize({webAbsoluteUrl:a,listFullUrl:o}),c=e.demandItem({listFacets:h.Ib,downloadZipApiUrl:x.a},s),u=c.listFacets,d=c.downloadZipApiUrl;if(!u||!d||u.templateType===j.a.webPageLibrary)return{};for(var m=[],p=Object(K.a)(e,{enableOAuthTokenInDownload:h.P}).enableOAuthTokenInDownload,b=void 0!==p&&p,v=!1,g=0,y=n;g<y.length;g++){var O=y[g],w=e.demandItem({name:I.h,size:I.k,itemUrl:I.H,folder:I.l,permissions:h.fc,itemComplianceStatus:L.a,isOneNote:N.e},O),S=w.name,A=w.size,k=w.itemUrl,T=w.folder,U=w.permissions,P=w.itemComplianceStatus;if(w.isOneNote)return{isAvailable:!1};var D=void 0,z=void 0,q=e.demandItemFacet(h.Tb,O,{suppressGetItems:!0});if(q)D=void 0,z=new R.a(q.siteUrl).authority+"/_api/v2.1/drives/"+q.driveId+"/items/"+q.itemId,v=!0;else{if(!k)return{};D=e.demandItemFacet(x.b,s),z=Object(F.b)(k,(D?D.accessToken:void 0)||"")}if(z){var M=!!T;3!==P&&4!==P&&_.a.hasItemPermission({permissions:U},_.a.openItems)&&m.push({name:S||"",size:A||0,docId:z,isFolder:M})}}return 0===m.length?{}:{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,n=e.zipApiUrl,i=e.itemsData,a=e.useOAuthToken;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=void 0,a?[4,e(Object(C.a)({url:new R.a(n).authority}))]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return o=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++W+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip",s=E.Guid.generate(),[2,{url:n,method:"POST",postData:{zipFileName:o,guid:s,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}}({zipApiUrl:d,itemsData:m,useOAuthToken:b||v})}}}(e,{itemKeys:i}):{}:function(e,t){var n=t.itemKey,i=t.platformDetection,a=e.demandItem({spItem:l.a,permissions:h.fc,folderPath:h.hb,uniqueId:h.kd,itemComplianceStatus:L.a,isBFile:h.ub},t.itemKey),o=a.spItem,s=a.permissions,c=a.folderPath,u=a.uniqueId,d=a.itemComplianceStatus,m=a.isBFile,p=e.demandItemFacet(I.w,t.itemKey),v=o&&b.a.serialize(o),g=e.demandItemFacet(h.Yc,v);if(!g||!o||m)return{};var y=o.webAbsoluteUrl,O=o.listFullUrl,w=f.a.serialize(o),S=e.demandItemFacet(h.Ib,w);if(S&&S.templateType===j.a.webPageLibrary)return{};if(3===d||4===d||!_.a.hasItemPermission({permissions:s},_.a.openItems))return{};var A=Object(K.a)(e,{spCookieDomainConfiguration:h.Bc,enableMalwareDownloadInNewWindow:h.K}),k=A.spCookieDomainConfiguration,T=A.enableMalwareDownloadInNewWindow;if(p){if(!g.allowInfectedDownload)return{};var U=e.demandItemFacet(I.e,n);return U?T?{isAvailable:!0,downloader:M,getDownloadData:function(){return J({canconicalUrl:U})}}:k?new R.a(k).authority!==new R.a(U).authority?{}:Object(r.__assign)(Object(r.__assign)({isAvailable:!!u},i.isIE?{downloader:G}:{}),{getDownloadData:function(){return J({canconicalUrl:U})}}):{}:{}}if(!c)return{};var F=g.layoutsUrl;if(!F)return{};var x=!k||new R.a(k).authority!==new R.a(y).authority,N=g&&Object(E.getKillSwitch)(g),q=!!N&&N.isActivated("d1181e40-8c18-49bf-bff9-efd9518c28c0","10/10/2020","Use PostBody Download"),V=Object(K.a)(e,{disableDownloadWithAspxUrlWithToken:h.u}).disableDownloadWithAspxUrlWithToken,B=void 0!==V&&V;return Object(r.__assign)(Object(r.__assign)({isAvailable:!0},i.isIE?{downloader:G}:{}),{getDownloadData:function(){return q||B?k&&u&&!x?function(e){var t=this,n=e.webAbsoluteUrl,i=e.layoutsUrl,a=e.uniqueId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{url:n+"/"+i+"/download.aspx?"+Object(z.a)({UniqueId:a}),method:"GET"}]})})}}({webAbsoluteUrl:y,uniqueId:u,layoutsUrl:F}):function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,a=e.folderPath;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,s,l,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e(Object(C.c)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,s=t.hasDigest,t.hasTokenProvider?(c=void 0,[3,3]):[3,1];case 1:return[4,e(Object(C.a)({url:n||i,disallowCookies:!s}))];case 2:c=r.sent(),r.label=3;case 3:return l=c,u=Object(D.d)({webAbsoluteUrl:n,listOrItemFullUrl:i}),[4,P({dataRequestor:o,authToken:l,serverRelativeItemUrl:a,webApiUrl:u})];case 4:return[2,{url:r.sent(),method:"GET"}]}})})}}({webAbsoluteUrl:y,listFullUrl:O,folderPath:c,layoutsUrl:F}):function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,a=e.uniqueId,o=e.layoutsUrl,s=e.isCrossSite;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,l,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e(Object(C.c)({webAbsoluteUrl:n,listFullUrl:i})),l=t.hasDigest,!t.hasTokenProvider&&s?[3,1]:(u=void 0,[3,3]);case 1:return[4,e(Object(C.a)({url:n||i,disallowCookies:!l}))];case 2:u=r.sent(),r.label=3;case 3:return c=u,[2,{url:n+"/"+o+"/download.aspx?"+Object(z.a)({UniqueId:a}),method:s?"POST":"GET",postData:{oAuthToken:c||""}}]}})})}}({webAbsoluteUrl:y,listFullUrl:O,uniqueId:u||"",layoutsUrl:F,isCrossSite:x})}})}(e,{itemKey:a,platformDetection:t})}}}var W=0;function J(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1"),[2,{url:t,method:"GET"}]})})}}var Z=n("/rh/"),Q=n("XkN0"),X=n("12Fv"),Y=n("+cV3"),$=n.n(Y),ee=Object(y.a)()(function(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.isBatchDelete,a=e.demandItemFacet(h.Tb,r,{suppressGetItems:!0}),o=e.demandItemFacet(h.fc,r,{suppressGetItems:!0}),s=w(null===(n=e.demandItemFacet(h.tc,r,{suppressGetItems:!0}))||void 0===n?void 0:n.ProgId),l=_.a.hasItemPermission({permissions:o},_.a.deleteListItems)&&!s;return l&&a&&(l=!!Object(K.a)(e,{enableDeleteCommandForMountPointConfiguration:h.z}).enableDeleteCommandForMountPointConfiguration&&i),{isAvailable:l,deleteWizard:te}}}}),te=Object(X.b)(function(e,t){var n,i,a,o,s,l,c=t.itemKeys,u=t.defaultRender,d=Object(r.__rest)(t,["itemKeys","defaultRender"]),m=void 0,p=Object(K.a)(e,{enableDeleteCommandForMountPointConfiguration:h.z}).enableDeleteCommandForMountPointConfiguration;if(1===c.length){var b=e.demandItemFacet(h.Ub,c[0]);if(b){var f=b&&Object(Q.formatToArray)(Object(Q.getLocalizedCountValue)($.a.deleteItemThatIsMountedDescription,$.a.deleteItemThatIsMountedIntervals,b)||"",b),_=d.deleteWizardStrings.confirmText;m=Object(r.__assign)(Object(r.__assign)({},d),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},d.deleteWizardStrings),{confirmTitle:$.a.deleteItemThatIsMountedTitle,confirmText:[f," ",_]})})}}else if(p&&(n=0,c.forEach(function(t){e.demandItemFacet(h.Tb,t,{suppressGetItems:!0})&&n++}),n>0)){var v=c.length-n;m=Object(r.__assign)(Object(r.__assign)({},d),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},d.deleteWizardStrings),{confirmTitle:$.a.deleteItems,confirmText:(i=n,a=v,o=Object(Q.format)(Object(Q.getLocalizedCountValue)($.a.deleteShortcutsFormat,$.a.deleteShortcutsIntervals,i)||"",i),s=Object(Q.format)(Object(Q.getLocalizedCountValue)($.a.deleteOtherItemsFormat,$.a.deleteOtherItemsIntervals,a)||"",a),l=Object(Q.format)($.a.deleteItemsAndMountPointsFormat,o,s),l)})})}var g=m||d;return u?U.createElement(u,Object(r.__assign)({itemKeys:c},g)):null}),ne=Object(y.a)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(K.a)(e,{enableDeleteCommandForMountPointConfiguration:h.z}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var a=i[r];if(!e.demandItemFacet(h.Tb,a,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}}),re=Object(i.b)(function(){return function(e){e(Object(a.f)(l.a,u.b)(Object(i.d)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(73).then(n.bind(null,"PMTl"))];case 1:return[2,e.sent().spItemDeleteItemsOperationHandler]}})})}))),e(Object(a.f)(l.a,d.b)(m)),e(Object(o.a)(l.a,p.a)(A)),e(Object(o.a)(l.a,T.a)(V)),e(Object(o.a)(c.a,T.a)(B)),e(Object(o.a)(l.a,Z.a)(ee)),e(Object(o.a)(l.a,s.a)(ne))}})},pHIF:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("updateItemLikes"),o=Object(i.e)({operationTypeFacet:a})},pVWH:function(e,t,n){"use strict";var r;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(r||(r={})),t.a=r},pq27:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spFollowedSitesItemSet",{tenantRootUrl:Object(r.f)()})},psLB:function(e,t){var n={consentDialogTitle:"One more thing...",consentDialogMessage:"The action you\u0027ve chosen is provided by a third party. If you continue, you may be asked to accept additional terms of use, or to create an account with third party service. This service is not provided by Microsoft and its use is not covered by Microsoft terms of use or privacy policy.",consentDialogContinueButton:"Continue",consentDialogCancelButton:"Cancel"};n.default=n,e.exports=n},pyXj:function(e,t){var n={sites:"Sites",frequent:"Frequent",followed:"Followed",sharedChannels:"Shared Channels",documentLibraries:"Document Libraries"};n.default=n,e.exports=n},"q+uO":function(e,t,n){"use strict";n.r(t),n.d(t,"getSPFilterOptionSetHandler",function(){return I});var r=n("17wl"),i=n("oveG"),a=n("NX6U");function o(e,t,n,r){var i="",a=0;if(!e)return"";var o=e.length;for(a=0;a<o;a++){var s=e.charCodeAt(a),l=e.charAt(a);if(t&&("#"===l||"?"===l)){i+=e.substr(a);break}n&&"&"===l?i+=l:s<=127?r||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(l)<0?i+=l:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):a<e.length-1&&(s=(1023&s)<<10,a++,s|=1023&e.charCodeAt(a),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}var s=n("+jOK"),l=n("6Pju");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,a=e.rootFolder,c=e.excludeFieldFilteringHtml,u=e.filterParams,d=e.currentUserDisplayName,m=Object(l.a)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");if(i&&(m=m.parameter("ViewId",i)),a&&(m=m.parameter("RootFolder",{raw:o(a)})),c&&(m=m.parameter("ExcludeFieldFilteringHtml",!0)),u){var p=s.a.getFilterParams(u,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:d});m=m.rawParameter(p)}return m.toString()}var u=n("4qQ9"),d=n("Brbd"),m=n("oCyF"),p=n("R/Xa"),b=n("jrqp"),f=n("yhDP"),h=n("sqky"),_=n("GQoE"),v=n("qyWO"),g=n("2YyJ"),y=n("K9kD"),I=Object(h.e)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,o=d.a.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,l,d,h;return Object(r.__generator)(this,function(I){switch(I.label){case 0:return t=e(function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(g.a)({spDataSourceConfiguration:i.Ec})).spDataSourceConfiguration,a=r&&r.ensureAuthToken,o=m.a.serialize(t),s=e(Object(_.a)({folderPath:i.hb},o)),l=e(Object(_.a)({internalName:i.tb,mappedColumnFieldType:i.Pb,isCalculated:i.vb},b.a.serialize(n))),c=s&&s.folderPath,u=l&&l.internalName&&l.internalName,d=l&&l.mappedColumnFieldType===f.a.Taxonomy,h=l&&l.isCalculated,v=p.a.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),I=e(Object(_.a)({pageContext:i.Yc},v)).pageContext,O=t.viewKey&&t.viewKey.viewId,w=O===y.Guid.Empty?I&&I.viewId:O;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:c,ensureAuthToken:a,fieldInternalName:u,isCalculatedField:h,filterParams:t.filterParams,excludeFieldFilteringHtml:d,viewId:w,currentUserDisplayName:I&&I.userDisplayName}}}({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey})),[4,e((O=t,function(e){return e(Object(a.b)({webAbsoluteUrl:O.webAbsoluteUrl,listFullUrl:O.listFullUrl,method:"POST",url:c(O),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:return s=I.sent(),l=u.a.getFilterData(s,t.fieldInternalName||"",t.isCalculatedField),(d=new v.a).resolveItems({items:(h={},h[n]=Object(r.__assign)({},i.gb.pack(l)),h)}),e(d.execute()),[2]}var O})})}})},rWQz:function(e,t,n){"use strict";n.d(t,"b",function(){return I}),n.d(t,"a",function(){return O}),n.d(t,"c",function(){return w});var r,i,a=n("17wl"),o=n("etdY"),s=n("oCyF"),l=n("6Pju");!function(e){e[e.pin=0]="pin",e[e.unpin=1]="unpin",e[e.movePrevious=2]="movePrevious",e[e.moveNext=3]="moveNext"}(r||(r={})),function(e){e[e.success=0]="success",e[e.folderDoesNotExist=1]="folderDoesNotExist",e[e.itemDoesNotExist=2]="itemDoesNotExist",e[e.tooManyItems=3]="tooManyItems",e[e.itemNotInSpotlight=4]="itemNotInSpotlight",e[e.invalidArgument=5]="invalidArgument",e[e.serverError=6]="serverError",e[e.invalidServerJSON=7]="invalidServerJSON",e[e.unknownServerResult=8]="unknownServerResult"}(i||(i={}));var c=n("NX6U"),u=n("eVX6"),d=n("Z6kr"),m=n("sqky"),p=n("kk66"),b=n("Rr4e"),f=n("oveG"),h=n("Ql3v"),_=n("iy8a"),v=n("7Hin"),g=n("4qcU"),y=n("F0Gs"),I=3,O=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;return n.resultType=i,n}return Object(a.__extends)(t,e),t}(d.a),w=Object(m.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var r,i,d,m,w,j,S,A,k,T,U,C,F,P,E,x,D,L,N,K,R,z;return Object(a.__generator)(this,function(q){switch(q.label){case 0:return r=Object.keys(n)[0],i=n[r].editType,[4,e(Object(_.a)(r))];case 1:if(d=q.sent(),m=d.key,w=d.itemId,j=e(Object(h.a)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.a,pinnedItems:p.a},t)})),S=j.deserializedPinnedItemSetKey,A=j.pinnedItems,S||(S=o.a.deserialize(t)),!m||!S||!w)throw new O({resultType:5});return m&&S&&w?(k="",S.viewKey&&(k=S.viewKey.viewId),T=S.parentItemKey.rootFolder||new u.a(S.parentItemKey.listFullUrl).path,U=void 0,(C=A&&A.itemKeys||[])&&(F=C.indexOf(r))>-1&&(2===i&&F>=2?U=C[F-2]:3===i&&F<C.length-1&&(U=C[F+1])),P=void 0,U&&(P=e(Object(h.a)(function(e){return e.demandItemFacet(f.Lb,U)}))),E={webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,itemId:w,editType:i,viewId:k,rootFolder:T,afterItemId:P},t&&(x=function(e,t,n,r){var i=r.editType,a=[];(0===i||void 0===n&&1!==i)&&a.push(e);for(var o=0,s=t;o<s.length;o++){var l=s[o];l!==e&&a.push(l),l===n&&a.push(e)}return a}(r,C,U,E)).length<=I&&e(Object(b.a)({items:Object(a.__assign)((R={},R[t]=Object(a.__assign)({},p.a.pack({itemKeys:x})),R),Object(v.a)(x,function(){return Object(a.__assign)({},Object(g.a)().forFacet(y.g).thenInvalidate(t,p.a).pack())}))})),(D=function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,a=e.itemId,o=e.afterItemId,s=e.rootFolder,c=Object(l.a)({webAbsoluteUrl:t,listFullUrl:n});if(r&&(c=c.methodWithAliases("GetView",{viewGuid:r})),1!==i){var u=o?parseInt(o,10):-1;isNaN(u)&&(u=-1),c=c.methodWithAliases("AddToSpotlight",{itemId:a,folderPath:s||"",afterItemId:u})}else c=c.methodWithAliases("RemoveFromSpotlight",{itemId:a,folderPath:s||""});return c.toString()}(E))?[4,e(Object(c.b)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,url:D,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3]):[3,3];case 2:if(L=q.sent(),0!==(N=function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}}(L)).resultType)throw K=function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var o=i[r];n.push(s.a.serialize(Object(a.__assign)(Object(a.__assign)({},t),{itemId:o.toString()})))}return n}(N,m),e(Object(b.a)({items:Object(a.__assign)((z={},z[t]=Object(a.__assign)({},p.a.pack({itemKeys:K})),z),Object(v.a)(K,function(){return Object(a.__assign)({},Object(g.a)().forFacet(y.g).thenInvalidate(t,p.a).pack())}))})),new O({resultType:N.resultType});q.label=3;case 3:return[2]}})})}})},s8I5:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=new(n("7YMn").a)("getDriveItemFullUrlControl")},s8xr:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r=n("mflv"),i=n("PSxD"),a=n("Z29y");function o(e){var t="string"==typeof e?Object(i.a)(e):e;return{filters:u(t.where),sorts:s(t.orderBy),groupBy:l(t.groupBy),fieldNames:Object(i.e)(t.viewFields),rowLimit:c(t.rowLimit),associatedContentTypeId:Object(i.d)(t.associatedContentTypeId)}}function s(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return m(e)}).filter(function(e){return!!e});return t.length?t:void 0}}function l(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return m(e)}).filter(function(e){return!!e});if(t.length){var n={isCollapsed:p(e,r.a.collapse,!0),group1:t[0]};return t[1]&&(n.group2=t[1]),n}}}function c(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:p(e,r.a.paged,!1)}}function u(e){if(e&&e.childElementCount){var t=d(e.firstElementChild);return t&&t.length?t:void 0}}function d(e){if(e){var t;switch(e.tagName){case r.c.and:t=function(e){if(e&&e.childElementCount){var t=e.firstElementChild,n=d(t);if(!t.nextElementSibling)return n;var r=d(t.nextElementSibling);if(n||r)return(n||[]).concat(r||[])}}(e);break;case r.c.or:t=function(e){var t=function e(t){if(t.childElementCount){var n;switch(t&&t.tagName){case r.c.or:var i=t.firstElementChild,a=e(i);if(a&&i.nextElementSibling){var o=e(i.nextElementSibling);n=o?a.concat(o):void 0}else n=a;break;case r.c.eq:n=b(t);break;case r.c.isNull:n=f(t)}return n?Array.isArray(n)?n:[n]:void 0}}(e);if(t&&t.length&&!t.some(function(e){return!e})&&t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId})){var n=!1,i=t.reduce(function(e,t){return n||(e.type&&t.type&&e.type!==t.type?(n=!0,e.type=void 0):e.type=e.type||t.type),e.values.push(t.values[0]),e});return i.operator=r.c.eq,i.id=e&&a.b(e,r.a.id),i}return null}(e);break;case r.c.isNull:case r.c.isNotNull:case r.c.membership:t=f(e);break;case r.c.beginsWith:case r.c.contains:case r.c.eq:case r.c.greaterEq:case r.c.greater:case r.c.includes:case r.c.lessEq:case r.c.less:case r.c.notEq:case r.c.notIncludes:t=b(e);break;case r.c.inTag:t=function(e){var t=h(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.c.values})[0];if(t&&n){var i=!1,a=Array.prototype.map.call(n.childNodes,function(e){var n=_(e);if(n&&n.type&&!i){var r=n.type,a=t.type;i=!(!a||!r||a===r),t.type=a||r}return n&&n.value});return(a=a.filter(function(e){return!!e})).length&&(t.values=a,i&&(t.type=void 0)),a.length?t:void 0}}(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}function m(e){if(e&&e.tagName===r.c.fieldRef){var t=a.b(e,r.a.name);if(t)return{fieldName:t,isAscending:p(e,r.a.ascending,!0)}}}function p(e,t,n){switch((a.b(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return n}}function b(e){var t=h(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.c.value})[0];if(t&&n){var i=_(n);return i?(t.type=i.type,t.values=[i.value],t):void 0}}function f(e){var t=h(e);if(t)if(e.tagName===r.c.isNull)t.values=[""];else if(e.tagName===r.c.membership){var n=a.b(e,r.a.type);n?t.values=[n]:t=void 0}return t}function h(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.c.fieldRef})[0],n=t&&a.b(t,r.a.name),i=e&&a.b(e,r.a.id);if(n)return{fieldName:n,id:i,type:void 0,lookupId:p(t,r.a.lookupId),operator:e.tagName,values:void 0}}function _(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==r.c.today&&e.firstElementChild.tagName!==r.c.me;if(e&&e.tagName===r.c.value&&!t){var n,i={value:e.textContent,type:a.b(e,r.a.type)};if(e.childElementCount)if(e.firstElementChild.tagName===r.c.today){var o=e.firstElementChild,s=a.b(o,r.a.offset)||a.b(o,r.a.offsetDays),l=parseInt(s,10)||0;i.value=a.f(l),i.type=i.type||"DateTime"}else e.firstElementChild.tagName===r.c.me&&(i.value=a.d(),i.type=i.type||"Integer");return i.value&&"DateTime"===i.type&&!0!==p(e,r.a.includeTimeValue)&&(n=i.value.match(r.b.datetimeNoTimeRegex))&&(i.value=n[1]),i}}},skhv:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("createFreshView"),o=Object(i.e)({operationTypeFacet:a})},tUiV:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("7YMn"),i=n("slll"),a=new r.a("itemTileFolderCoverControl",{folderCoverAs:Object(i.a)()}),o=new r.a("itemTileControl",{tileAs:Object(i.a)(),folderCoverControlHandler:Object(r.c)(a)})},unvQ:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("updateItemRating"),o=Object(i.e)({operationTypeFacet:a})},vQrl:function(e,t){var n={MoreSitesText:"More libraries",SharedLibrariesHeader:"Shared libraries"};n.default=n,e.exports=n},vVnv:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("17wl"),i=n("rqqu");function a(){return function(e){return function(e){function t(t){var n=new i.a,a=t.context,o=void 0===a?{}:a;return e.call(this,Object(r.__assign)(Object(r.__assign)({language:window.navigator.language},t),{context:Object(r.__assign)({BrowserIsMobile:n.isMobile,BrowserIsPWA:n.isPWA,BrowserMajVer:n.browserMajor,BrowserMinVer:n.browserMinor,BrowserName:n.browserName,BrowserUserAgent:n.userAgent,OSName:n.osName,OSVersion:n.osVersion},o)}))||this}return Object(r.__extends)(t,e),t}(e)}}},wJkO:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("C4BG"),i=n("17wl"),a=n("W1iS"),o=n("kbGg"),s=n("JgQI"),l=r.a?function(e,t){var n=this;void 0===t&&(t={});var r=t.cancelToken,a=t.flushOperationQueue,l=t.timeout,c=void 0===l?1/0:l,u=t.contextualControlHandlerCache;return function(t){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:l=Object(o.a)({timeout:c,errorProps:{message:"Timeout demanding items"}},r),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,t(Object(s.a)(e,function(e){n={result:e}},{cancelToken:l.token,flushOperationQueue:a,contextualControlHandlerCache:u}))];case 2:return i.sent(),[3,4];case 3:return l.dispose(),[7];case 4:if(!n)throw new Error("No result.");return[2,n.result]}})})}}:function e(t,n){var r=this;void 0===n&&(n={});var s=n.cancelToken,l=n.flushOperationQueue,c=n.timeout,u=void 0===c?1/0:c,d=n.contextualControlHandlers;return function(n){return Object(i.__awaiter)(r,void 0,void 0,function(){var r,c,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:c={operation:e},m=Object(o.a)({timeout:u,errorProps:{message:"Timeout demanding items"}},s),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,n(Object(a.a)(t,function(e){r={result:e}},{cancelToken:m.token,flushOperationQueue:l,contextualControlHandlers:d,owner:c}))];case 2:return i.sent(),[3,4];case 3:return m.dispose(),[7];case 4:if(!r)throw new Error("No result.");return[2,r.result]}})})}}},"x+Ec":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("cDcd"),i=n("WopS"),a=n("Dy9Q"),o=n("KL1q"),s=function(e){var t=e.title,n=e.prompt,s=e.cancelText,l=e.onCancel;return r.createElement(i.a,{onDismiss:l,hidden:!1,title:t,maxWidth:e.maxWidth},r.createElement(o.Label,null,n),r.createElement(a.a,null,r.createElement(o.PrimaryButton,{onClick:l,componentRef:function(e){e&&e.focus()}},s)))}},xqQV:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n("vHN8"),i=n("xznA"),a=new r.a("reorderListItems"),o=Object(i.e)({operationTypeFacet:a})},yuog:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemUploadItemsOperationHandler",function(){return hr.spItemUploadItemsOperationHandler}),n.d(t,"spItemCreateFolderOperationHandler",function(){return _r.spItemCreateFolderOperationHandler}),n.d(t,"spItemCreateDocumentOperationHandler",function(){return vr.spItemCreateDocumentOperationHandler}),n.d(t,"getSPFilterOptionSetHandler",function(){return Ft.getSPFilterOptionSetHandler}),n.d(t,"spDataOnlyAddonDeferred",function(){return Lr});var r,i=n("17wl"),a=n("sqky"),o=n("xznA"),s=n("+1qS"),l=n("QMTs"),c=n("nQ8y"),u=n("K5HB"),d=n("oCyF"),m=n("etdY"),p=n("Fyxx"),b=n("Pe+L"),f=n("lGCB"),h=n("jTd0"),_=n("OpeS"),v=n("frCt"),g=n("l0+j"),y=n("IG76"),I=n("dS01"),O=n("mCu1"),w=n("kAty"),j=n("LQht"),S=n("unvQ"),A=n("pHIF"),k=n("oJsO"),T=n("6aXa"),U=n("GbVI"),C=n("1Yta"),F=n("skhv"),P=n("FU0e"),E=n("SVnr"),x=n("93qO"),D=n("vHN8");!function(e){e[e.preview=0]="preview",e[e.save=1]="save"}(r||(r={}));var L=new D.a("updateColumnFormatter"),N=(Object(o.e)({operationTypeFacet:L}),n("Rr4e")),K=n("duI/"),R=n("pq27"),z=n("GQ1J"),q=n("Ymtw"),M=n("LfMA"),G=new M.a("spHomeContextKeyFacet",{tenantRootUrl:Object(M.f)()}),V=n("ajZD"),B=n("F0Gs"),H=n("kk66"),W=n("oveG"),J=n("I2kL"),Z=n("qyWO");function Q(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o;return Object(i.__generator)(this,function(s){switch(s.label){case 0:return t=G.deserialize(e.itemKey).tenantRootUrl,r=new Z.a,[4,n(Object(J.b)({tenantRootUrl:t}))];case 1:return a=s.sent(),r.resolveItems({items:(o={},o[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},W.Rc.pack(a.resource)),W.Qc.pack(a.payloadHeader)),o)}),n(r.execute()),[2]}})})}}var X=n("wzdx"),Y=n("pyXj"),$=n.n(Y),ee=n("vQrl"),te=n.n(ee),ne=new M.a("spSharedChannelGroupSetKeyFacet",{tenantRootUrl:Object(M.f)()}),re=n("Ql3v"),ie=n("JI8f");function ae(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o,s,l,c,u,d;return Object(i.__generator)(this,function(m){return t=V.a.deserialize(e.itemKey).tenantRootUrl,r=new Z.a,a=n(Object(re.a)(oe)),o=z.a.serialize({tenantRootUrl:t}),s=R.a.serialize({tenantRootUrl:t}),l=ne.serialize({tenantRootUrl:t}),c=[o,s],(d={})[o]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},X.f.pack(!0)),B.h.pack($.a.frequent)),W.ec.pack({itemKey:e.itemKey})),d[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},X.f.pack(!0)),B.h.pack($.a.followed)),W.ec.pack({itemKey:e.itemKey})),d[e.itemKey]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(te.a.SharedLibrariesHeader)),X.f.pack(!0)),H.a.pack({itemKeys:c})),u=d,a&&(c.push(l),u[l]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},X.f.pack(!0)),B.h.pack($.a.sharedChannels)),W.ec.pack({itemKey:e.itemKey}))),r.resolveItems({items:u}),n(r.execute()),[2]})})}}function oe(e){return!!Object(ie.a)(e,{enableSharedChannel:W.X}).enableSharedChannel}var se=n("h+D8"),le=n("ZQAL"),ce=n("4qcU"),ue=n("2YyJ");function de(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o,s,l,c,u;return Object(i.__generator)(this,function(d){switch(d.label){case 0:return t=z.a.deserialize(e.itemKey).tenantRootUrl,r=new Z.a,[4,n(me(t))];case 1:return a=d.sent(),o=[],s=V.a.serialize({tenantRootUrl:t}),l=void 0,c=void 0,a&&a.Items&&a.Items.forEach(function(t,n){var u,d=K.a.serialize({webAbsoluteUrl:t.Url}),m=q.a.serialize({webAbsoluteUrl:t.Url}),p=t.ItemReference||{},b=p.SiteId,f=void 0===b?void 0:b,h=p.WebId,_=void 0===h?void 0:h,v=p.GroupId,g=void 0===v?void 0:v,y=se.a.serialize({rootItemKey:s,itemKey:d});l=a.Items[n-1]&&a.Items[n-1].PinOrder,c=a.Items[n+1]&&a.Items[n+1].PinOrder,r.resolveItems({items:(u={},u[d]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(t.Title)),W.a.pack(t.Acronym)),W.g.pack(t.BannerColor)),W.h.pack(t.BannerImageUrl)),W.Db.pack(!0)),B.l.pack({})),W.yc.pack(t.Weight)),K.a.pack({webAbsoluteUrl:t.Url})),W.xc.pack(f)),W.qd.pack(_)),W.ob.pack(g)),H.b.pack({itemKey:m})),u[y]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},W.nc.pack(l)),W.hc.pack(t.PinOrder)),W.ac.pack(c)),Object(ce.a)().forFacet(W.hc).thenInvalidate(e.itemKey,H.a).pack()),u[m]=Object(i.__assign)({},H.f.pack({itemKey:d})),u)}),o.push(d)}),r.resolveItems({items:(u={},u[e.itemKey]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack($.a.frequent)),H.a.pack({itemKeys:o})),W.ec.pack({itemKey:s})),u)}),n(r.execute()),[2]}})})}}function me(e){var t=this;return function(r){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=r(Object(ue.a)({enableSitePinningConfiguration:W.Y,enableSPHomeServiceConfiguration:W.V})),a=t.enableSitePinningConfiguration,!1!==t.enableSPHomeServiceConfiguration?[3,3]:[4,n.e(18).then(n.bind(null,"G6W3"))];case 1:return o=i.sent().getFrequentSitesData,[4,r(o(e))];case 2:return[2,i.sent()];case 3:return s=a?le.b:le.a,[4,r(Object(J.d)(e,void 0,s))];case 4:return[2,i.sent()]}})})}}function pe(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o;return Object(i.__generator)(this,function(s){return t=K.a.deserialize(e.itemKey).webAbsoluteUrl,r=new Z.a,a=q.a.serialize({webAbsoluteUrl:t}),r.resolveItems({items:(o={},o[e.itemKey]=Object(i.__assign)({},H.b.pack({itemKey:a})),o)}),n(r.execute()),[2]})})}}var be=n("iP7s"),fe=n("QDiT"),he=n("L6XE"),_e=n("y88i"),ve=n("6Pju"),ge=n("NX6U");function ye(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(Object(ue.a)({spHostPageWebAbsoluteUrl:W.Sc,spSitesListsDataWebAbsoluteUrl:W.fd})),i=r.spHostPageWebAbsoluteUrl,a=r.spSitesListsDataWebAbsoluteUrl,o=new _e.SimpleUri(t).authority,s=i||a,l=s&&new _e.SimpleUri(s).authority,c=n&&o===l,u=Object(ve.c)({webAbsoluteUrl:l||o}).segment(c?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(Object(ge.d)({webAbsoluteUrl:l||o,method:"POST",url:u.toString(),qosName:c?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}function Ie(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o,s,l,c,u,m,p,f,h,_,v,g,y,I;return Object(i.__generator)(this,function(O){switch(O.label){case 0:return t=q.a.deserialize(e.itemKey),r=t.webAbsoluteUrl,a=t.types,o=K.a.serialize({webAbsoluteUrl:r}),s=new Z.a,[4,n(ye({webAbsoluteUrl:r,isMediaQuery:!!a&&a.indexOf("media")>-1}))];case 1:for(l=O.sent(),c=[],u=0,m=l.d.GetDocumentLibraries.results;u<m.length;u++)p=m[u],f=new be.a({context:{webAbsoluteUrl:r}}),h=f.getUrlParts({webUrl:r,listUrl:p.AbsoluteUrl,path:p.AbsoluteUrl}),_={webAbsoluteUrl:r,listFullUrl:h.fullListUrl||"",rootFolder:""},v=d.a.serialize(_),g=b.a.serialize({webAbsoluteUrl:r,listFullUrl:h.fullListUrl||"",rootFolder:""}),s.merge(n(Object(he.a)({itemKey:v,spItem:_})).itemResolver),s.resolveItems({items:(y={},y[v]=Object(i.__assign)({},B.h.pack(p.Title)),y[g]=Object(i.__assign)({},H.f.pack({itemKey:v})),y)}),c.push(v);return s.resolveItems({items:(I={},I[e.itemKey]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},H.a.pack({itemKeys:c})),Object(ce.a)().forFacet(H.a).thenInvalidate(fe.a).pack()),K.a.pack({webAbsoluteUrl:r})),H.f.pack({itemKey:o})),I)}),n(s.execute()),[2]}})})}}var Oe=n("2muu"),we=n("AygU"),je=n("+Grl"),Se=n("fwYH"),Ae=Object(je.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.handlers,a=e.demandItemFacet(q.a,n);if(r&&a){for(var o=[],s=0,l=r;s<l.length;s++){var c=l[s];".JPEG"===Object(Se.a)(c)&&o.push("media")}return o.length<1?{}:{itemKey:q.a.serialize(Object(i.__assign)(Object(i.__assign)({},a),{types:o}))}}return{}}}}),ke=new M.a("spSharedChannelGroupKeyFacet",{tenantRootUrl:Object(M.f)(),groupId:Object(M.f)(),tenantId:Object(M.f)()}),Te=n("m1i4"),Ue=Object(a.e)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m,p,b,f;return Object(i.__generator)(this,function(h){switch(h.label){case 0:return t=r(Object(ue.a)({spHostPageWebAbsoluteUrl:W.Sc})).spHostPageWebAbsoluteUrl,a=ke.deserialize(n),o=t||a.tenantRootUrl,s=new Te.b({webAbsoluteUrl:o}).build().segments("GroupSiteManager","GetSharedChannelSharePointUrl").toString(),l={tenantId:a.tenantId,groupId:a.groupId},[4,r(Object(ge.b)({url:s,method:"POST",body:JSON.stringify(l),qosName:"getSharedChannelGroupUrlFromSharePoint",webAbsoluteUrl:o,noRedirect:!0}))];case 1:return c=h.sent(),u=c.d.GetSharedChannelSharePointUrl,d=K.a.serialize({webAbsoluteUrl:u}),m=q.a.serialize({webAbsoluteUrl:u}),(p=new Z.a).mapKeys({mappings:(b={},b[e.itemKey]=d,b)}),p.resolveItems({items:(f={},f[e.itemKey]=Object(i.__assign)({},H.b.pack({itemKey:m})),f)}),r(p.execute()),[2]}})})}}),Ce=new D.a("groupResourceCapability"),Fe=Object(a.e)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m,p,b,f,h,_,v,g,y,I,O,w,j;return Object(i.__generator)(this,function(S){switch(S.label){case 0:return t=new Z.a,a=ne.deserialize(n),s=r(Object(ue.a)({spHostPageWebAbsoluteUrl:W.Sc})).spHostPageWebAbsoluteUrl,l=s||a.tenantRootUrl,c=new Te.b({webAbsoluteUrl:l}).build().segments("GroupSiteManager","GetCurrentUserSharedChannelMemberGroups").toString(),u={},[4,r(Object(ge.b)({url:c,method:"POST",body:JSON.stringify(u),qosName:"getSharedChannelGroupsFromSharePoint",webAbsoluteUrl:l,noRedirect:!0}))];case 1:for(o=S.sent(),d=[],m=JSON.parse(o.d.GetCurrentUserSharedChannelMemberGroups),p=0,b=m.value;p<b.length;p++)f=b[p],h=f.oid,_=f.tid,v=f.DisplayName,g=f.GroupResourceCapability,y=f.Acronym,I=f.BannerColor,O=ke.serialize({groupId:h,tenantId:_,tenantRootUrl:l}),r(Object(N.a)({items:(w={},w[O]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(v)),Ce.pack(g)),W.a.pack(y)),W.g.pack(I)),B.l.pack({})),w)})),d.push(O);return t.resolveItems({items:(j={},j[e.itemKey]=Object(i.__assign)({},H.a.pack({itemKeys:d})),j)}),r(t.execute()),[2]}})})}}),Pe=n("ss5J"),Ee=n("gNAT"),xe=n("wJkO"),De=Object(je.a)()(function(){return function(e){return function(e,t){var n=function(e,t){var n=this,r=t.stageItem;return r?Object(Ee.b)(function(e){var t=e.itemsScopeItemKey,a=e.currentItemKey;return function(e){return Object(i.__awaiter)(n,void 0,void 0,function(){return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,e(Object(xe.a)(function(e){return e.demandItemFacet(d.a,a,{suppressGetItems:!1})}))];case 1:return n.sent()?[4,e(r({currentItemKey:a,itemsScopeItemKey:t}))]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}}):void 0}(0,{itemKey:t.itemKey,stageItem:t.stageItem});return n?{stageItem:n}:{}}}}),Le=n("4Oaa"),Ne=n("60OA"),Ke=Object(je.a)()(function(){return function(){return function(e,t){var n,r=t.itemKey,a=Object(Le.a)(e),o=Object(Ne.a)(e);if(e.demandItemFacet(V.a,r)){var s=e.demandItemFacet(d.a,a),l=e.demandItemFacet(q.a,o);(s||l)&&(n={isToggled:!0})}return Object(i.__assign)({},n||{})}}}),Re=Object(Oe.b)(Object(Oe.a)(function(){return n.e(20).then(n.bind(null,"Hn06"))},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet"),ze=Object(a.b)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return e(Object(N.b)({keyFacet:K.a,facets:[B.h,H.b]})),e(Object(N.b)({keyFacet:R.a,facets:[R.a,H.a]})),e(Object(N.b)({keyFacet:z.a,facets:[z.a,H.a]})),e(Object(N.b)({keyFacet:q.a,facets:[q.a,H.a,H.b]})),e(Object(o.f)(G,l.a)(Object(a.e)({maxParallelOperationCount:4})(Q))),e(Object(o.f)(V.a,l.a)(Object(a.e)()(ae))),e(Object(o.f)(z.a,l.a)(Object(a.e)()(de))),e(Object(o.f)(K.a,l.a)(Object(a.e)({maxParallelOperationCount:4})(pe))),e(Object(o.f)(q.a,l.a)(Object(a.e)({maxParallelOperationCount:8})(Ie))),e(Object(E.a)(q.a,we.a)(Ae)),e(Object(o.f)(R.a,l.a)(Object(a.d)(Re))),e(Object(N.b)({keyFacet:ke,facets:[d.a]})),e(Object(o.f)(ke,l.a)(Ue)),e(Object(o.f)(ne,l.a)(Fe)),e(Object(E.a)(ke,Pe.a)(De)),e(Object(E.a)(V.a,Pe.a)(Ke)),[2]})})}}),qe=new M.a("businessNavSet",{tenantRootUrl:Object(M.f)()}),Me=new M.a("oneDriveNavSet",{tenantRootUrl:Object(M.f)()}),Ge=Object(a.e)()(function(e){var t=this,n=e.itemKey,r=qe.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a;return Object(i.__generator)(this,function(o){return(t=new Z.a).resolveItems({items:(a={},a[n]=Object(i.__assign)({},H.a.pack({itemKeys:[Me.serialize({tenantRootUrl:r}),V.a.serialize({tenantRootUrl:r})]})),a)}),e(t.execute()),[2]})})}}),Ve=n("EdJH"),Be=n("9SeE"),He=n("DTs3"),We=n("3IOs"),Je=n("R/Xa"),Ze=n("Et6h"),Qe=n.n(Ze),Xe=n("G4Jo"),Ye=new M.a("savedForLaterRootItem",{endpoint:Object(M.f)()}),$e=new M.a("sharedRootItem",{endpoint:Object(M.f)()}),et=n("LVBk"),tt=n.n(et),nt=n("9HFz"),rt=Object(a.e)()(function(e){var t=this,n=e.itemKey,r=Me.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,m,p,b,f,h,_,v,g,y,I,O,w,j,S;return Object(i.__generator)(this,function(A){switch(A.label){case 0:return t=new Z.a,[4,e(Object(xe.a)(function(e){var t=We.a.serialize({tenantRootUrl:r});return e.demandItemFacet(d.a,t,{suppressGetItems:!1})}))];case 1:return(a=A.sent())?[4,e(Object(xe.a)(function(e){return e.demandItemFacet(W.Yc,Je.a.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}))}))]:[2];case 2:for(o=A.sent(),s=e(Object(re.a)(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(Be.k,He.a),isSharedWithMeEnabled:!!e.demandItemFacet(nt.i,He.a)}})),l=s.isSavedForLaterEnabled,c=s.isSharedWithMeEnabled,u={},m=o&&o.userDisplayName,p=d.a.serialize(a),u[p]={icon:"FabricFolder",displayName:tt.a.files},b=Xe.a.serialize({endpoint:r+"/_api/v2.0"}),u[b]={icon:"History",displayName:Qe.a.recentTitle},f=Ye.serialize({endpoint:r+"/_api/v2.0"}),u[f]={icon:"SingleBookmark",displayName:Qe.a.saved},h=$e.serialize({endpoint:""+r}),u[h]={icon:"People",displayName:Qe.a.sharedWithMe},_=Object(i.__spreadArrays)([p,b],c?[h]:[],l?[f]:[]),v=0,g=_;v<g.length;v++)y=g[v],I=u[y],O=I.icon,w=I.displayName,t.resolveItems({items:(j={},j[y]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Ve.b.pack(O)),B.h.pack(w)),B.l.pack({})),j)});return t.resolveItems({items:(S={},S[n]=Object(i.__assign)(Object(i.__assign)({},H.a.pack({itemKeys:_})),B.h.pack(m)),S)}),e(t.execute()),[2]}})})}}),it=n("UbrB"),at=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=this,n=Object.keys(e.options),r=e.itemKey,a=n[0],o=e.options[a],s=o.type,l=o.reorderPinInfo,c=se.a.serialize({itemKey:a,rootItemKey:r});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,o,u,d,m,p,b,f;return Object(i.__generator)(this,function(h){switch(h.label){case 0:return t=e(Object(re.a)(function(e){return e.demandItem({siteId:W.xc,webId:W.qd,groupId:W.ob},a)})),n=t.siteId,o=t.webId,u=t.groupId,d=new Z.a,m=function(e,t){switch(e){case"pin":return st();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:st()}return;default:return}}(s,l),d.resolveItems({items:(b={},b[c]=Object(i.__assign)({},W.hc.pack(m)),b)}),e(d.execute()),(p=V.a.deserialize(r).tenantRootUrl)?[4,e(ot(p,{siteId:n||"",webId:o||"",groupId:u},s,l))]:[3,2];case 1:h.sent(),(d=new Z.a).invalidateItems({items:(f={},f[c]=[W.hc],f)}),e(d.execute()),h.label=2;case 2:return[2]}})})}});function ot(e,t,n,r){var a=this;return function(o){return Object(i.__awaiter)(a,void 0,void 0,function(){var a,s,l,c,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if("pin"===n)a="api/v1/sites/pinned/add",s="pinSite";else if("unpin"===n)a="api/v1/sites/pinned/remove",s="unpinSite";else{if("reorderPin"!==n)return[2];if(!r)return[2];l=Object(it.a)({PreviousPinOrder:r.prevPinOrder||"",NextPinOrder:r.nextPinOrder||""},void 0,!0),a="api/v1/sites/pinned/update?"+l,s="reorderSite"}return[4,o(Object(J.b)({tenantRootUrl:e}))];case 1:return c=i.sent(),u="",t&&(u=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}})),[4,o(Object(J.a)({path:a,method:"POST",qosName:s,context:c,body:u}))];case 2:return i.sent(),[2]}})})}}function st(e){return void 0===e&&(e=new Date),621355968e9+1e4*e.getTime()}var lt,ct=new D.a("pinSite"),ut=(Object(o.e)({operationTypeFacet:ct}),n("/zQO")),dt=Object(a.b)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return e(ut.a),e(Object(o.f)(qe,l.a)(Ge)),e(Object(o.f)(Me,l.a)(rt)),e(Object(o.f)(V.a,ct)(at)),[2]})})}}),mt=n("GQ+h"),pt=Object(a.e)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=mt.a.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m,p,b,f;return Object(i.__generator)(this,function(h){switch(h.label){case 0:return t=g.a.serialize({webAbsoluteUrl:r}),[4,n(Object(xe.a)(function(e){return e.demandItemFacet(W.cc,t)}))];case 1:return a=h.sent(),o=n(Object(re.a)(function(e){return e.demandItemFacet(Be.v,He.a)})),s=!a,c=o&&o.language||"en-US",u=Object(it.a)({Locale:c,v:2,msajax:1,cv:2}),l=s?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+u:Object(ve.c)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:c}),[4,n(Object(ge.b)({url:l.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:return d=h.sent(),m=s?d:JSON.parse(d.d.GetSuiteNavData),p=!(!m.NavBarData||!m.NavBarData.AdminLink)||void 0,(b=new Z.a).resolveItems({items:(f={},f[e.itemKey]=Object(i.__assign)({},W.gd.pack(p)),f)}),n(b.execute()),[2]}})})}}),bt=Object(a.b)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return e(Object(o.f)(mt.a,l.a)(pt)),[2]})})}});!function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter",e[e.saveColumnFormatter=1]="saveColumnFormatter",e[e.previewViewFormatter=2]="previewViewFormatter",e[e.saveViewFormatter=3]="saveViewFormatter"}(lt||(lt={}));var ft=new D.a("updateFormatter"),ht=(Object(o.e)({operationTypeFacet:ft}),n("jveB")),_t=n("Sbwo"),vt=n("XIjh"),gt=n("6oVz"),yt={ODB:1855},It=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d;return Object(i.__generator)(this,function(m){switch(m.label){case 0:return r=Object.keys(n)[0],a=n[r],o=a.updateType,s=a.formatter,0!==o?[3,1]:[2,e(Object(N.a)({items:(u={},u[r]=Object(i.__assign)({},W.q.pack(s)),u)}))];case 1:return 2!==o?[3,4]:[4,e(Object(xe.a)(function(e){e.demandItemFacet(_t.a,_t.b.serialize({}))}))];case 2:return m.sent(),l=!1,c={},[4,e(Object(xe.a)(function(e){if(l=Object(vt.a)(e,{feature:yt})){var n=e.demandItem({schema:H.g},t).schema,r=n&&n.columnKeys;r&&(c=Object(gt.a)(e,r))}}))];case 3:return m.sent(),[2,e(Object(N.a)({items:(d={},d[r]=Object(i.__assign)({},W.od.pack(Object(ht.a)({formatter:s,fieldFormatters:c,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:l}}))),d)}))];case 4:return[2]}})})}}),Ot=new D.a("modifyFieldProperties"),wt=(Object(o.e)({operationTypeFacet:Ot}),n("GQoE")),jt=n("sb7W"),St=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d,m;return Object(i.__generator)(this,function(p){return r=Object.keys(n)[0],a=n[r],o=a.displayName,s=a.fieldDescription,l=a.showInFiltersPane,(c=e(Object(wt.a)({setKey:b.a},t)).setKey)&&r&&(u=e(Object(wt.a)({id:W.eb},r)).id)?(d={__metadata:{type:"SP.Field"},Title:o,SchemaXml:s,ShowInFiltersPane:l},m=Object(ve.a)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}).method("Fields",u).toString(),[2,e(Object(ge.b)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:m,qosName:"modifyFieldProperties",body:JSON.stringify(d),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(N.a)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==l?jt.c.pack(l):{}),void 0!==o?B.h.pack(o):{}),t)}))})]):[2]})})}}),At=n("yG7E"),kt=n("9jhT"),Tt=n("YTDo"),Ut=Object(a.e)()(function(e){var t=this,n=e.itemKey,r=u.a.deserialize(n),a={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:kt.a}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=e(Object(At.c)({itemSetKey:a})),[4,e(Object(At.b)({itemSetKey:a,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent(),i.label=2;case 2:return i.trys.push([2,5,,7]),[4,e(Object(Tt.a)({getItemContext:r}))];case 3:return o=i.sent(),[4,e(Ct(o,n))];case 4:return i.sent(),[3,7];case 5:return i.sent(),[4,e(Ct(void 0,n))];case 6:return i.sent(),[3,7];case 7:return[2]}})})}});function Ct(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,a,o,s;return Object(i.__generator)(this,function(l){return n=!1,(a=e&&e.ListData&&e.ListData.Row)&&a.length>0&&a[0]&&(n=!0),(o=new Z.a).resolveItems({items:(s={},s[t]=Object(i.__assign)({},B.x.pack(n||void 0)),s)}),r(o.execute()),[2]})})}}var Ft=n("q+uO"),Pt=n("gwT8"),Et=n("NSZs"),xt=n("K9kD"),Dt=n("C21W"),Lt=Object(a.c)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,s,l,c,u,m,p,b,f,h,_,v,g,y,I,O,w,j,S,A,k,T,U,C;return Object(i.__generator)(this,function(F){switch(F.label){case 0:for(r=void 0,o=void 0,s=0,l=Object.keys(t);s<l.length;s++)h=l[s],c=n(Object(wt.a)({key:d.a,folderPath:W.hb},h)),u=e.items[h],c&&c.key&&c.folderPath&&(r||(o=c.key.listFullUrl,r={webAbsoluteUrl:c.key.webAbsoluteUrl,items:[],checkInOutType:u.checkInOutType,checkInText:u.checkInText,checkInVersionType:u.checkInVersionType},o=c.key.listFullUrl),r.items.push({key:h,itemFullUrl:c.folderPath}));return(m=r)&&m.items.length?(p=m.items.length>1,b="checkIn"===m.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===m.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem",f="checkOut"===m.checkInOutType,p?[3,2]:(h=m.items[0].key,_=Nt(m.webAbsoluteUrl,m.items[0].itemFullUrl,m.checkInOutType,m.checkInText,m.checkInVersionType),[4,n(Object(ge.b)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:o,url:_,method:"POST",qosName:b}))])):[3,4];case 1:return F.sent(),n(Object(N.a)({items:(U={},U[h]=Object(i.__assign)({},B.p.pack({byYou:!!f,byOther:void 0})),U)})),[3,4];case 2:return v=xt.Guid.generate(),g="multipart/mixed; boundary=batch_"+v,[4,n(Object(ge.b)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:o,url:Dt.b.getBatchOperationUrl(m.webAbsoluteUrl),body:Kt(m,v),method:"POST",additionalHeaders:void 0,contentType:g,parseResponse:function(e){return Dt.b.processBatchResponse(e,m.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===Et.b.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?Et.b.failure:Et.b.success})}:{eventData:n}}}))];case 3:if((y=F.sent()).hasError){for(S={items:{}},A=0,k=y.items;A<k.length;A++)(T=k[A]).error&&T.key&&(S.items[T.key]=new Pt.a({message:T.error.message}));throw new a.a(S)}for(I=new Z.a,O=0,w=m.items;O<w.length;O++)j=w[O],I.resolveItems({items:(C={},C[j.key]=Object(i.__assign)({},B.p.pack({byYou:!!f,byOther:void 0})),C)});n(I.execute()),F.label=4;case 4:return[2]}})})}});function Nt(e,t,n,r,i){var a;a="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(ve.d)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(a)).toString()}function Kt(e,t){var n=e.items,r=Dt.b.defaultBatchRequestPostData,i=n.map(function(t){return Nt(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return Dt.b.getBatchContentExtended(t,i,"POST",r)}var Rt=n("mNxR"),zt=n("Tz8b"),qt=Object(a.c)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,m,p,b,f,h,_,v,g,y,I,O,w,j,S;return Object(i.__generator)(this,function(A){switch(A.label){case 0:for(r=void 0,a=void 0,o="",s=!0,l=0,c=Object.keys(t);l<c.length;l++)O=c[l],u=n(Object(wt.a)({key:d.a,folderPath:W.hb},O)),m=n(Object(wt.a)({key:d.a,uiVersion:W.id,contentTypeId:W.n},O)),p=m.uiVersion,b=m.contentTypeId,o=zt.b(p),s=zt.e(b),f=e.items[O],h=n(Object(wt.a)({listItemId:W.Lb},O)).listItemId,u&&u.key&&u.folderPath&&(r||(a=u.key.listFullUrl,r={webAbsoluteUrl:u.key.webAbsoluteUrl,items:[],publishActionType:f.publishActionType,publishText:f.publishText},a=u.key.listFullUrl),r.items.push({key:O,itemFullUrl:u.folderPath,listItemId:h}));if(!(_=r)||!_.items.length)return[3,4];v=_.publishActionType===Rt.a.SchedulePublish,g=v?"ScheduleItem":"PublishItem",y=0,A.label=1;case 1:return y<_.items.length?(I=_.items[y],O=I.key,w=s&&_.publishActionType!==Rt.a.CancelApproval,j=w?function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")}(_.webAbsoluteUrl,I.listItemId,v):function(e,t,n){var r="Publish";n&&n===Rt.a.CancelApproval&&(r="UnPublish");var i=Object(ve.d)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()}(_.webAbsoluteUrl,_.items[0].itemFullUrl,_.publishActionType),[4,n(Object(ge.b)({webAbsoluteUrl:_.webAbsoluteUrl,listFullUrl:a,url:j,body:!v&&w?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:g}))]):[3,4];case 2:A.sent(),""!==o&&n(Object(N.a)({items:(S={},S[O]=Object(i.__assign)({},W.id.pack(o)),S)})),A.label=3;case 3:return y++,[3,1];case 4:return[2]}})})}}),Mt=n("r55L"),Gt=n("iy8a"),Vt=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Gt.a)(t))];case 1:return r=i.sent(),a=r.key,o=r.itemId,s=a.webAbsoluteUrl,l=a.listFullUrl,c=I.a.serialize({webAbsoluteUrl:s,listFullUrl:l}),(u=e(Object(re.a)(function(e){return e.demandItemFacet(W.Ib,c)})))&&u.id&&o?[4,e(Object(ge.b)({webAbsoluteUrl:s,listFullUrl:l,url:Object(ve.c)({webAbsoluteUrl:s}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:u.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent(),e(Object(Mt.a)({items:(d={},d[t]=[B.h],d)})),i.label=3;case 3:return[2]}})})}}),Bt=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Gt.a)(t))];case 1:return r=i.sent(),a=r.key,o=r.itemId,s=a.webAbsoluteUrl,l=a.listFullUrl,c=I.a.serialize({webAbsoluteUrl:s,listFullUrl:l}),(u=e(Object(re.a)(function(e){return e.demandItemFacet(W.Ib,c)})))&&u.id&&o?[4,e(Object(ge.b)({webAbsoluteUrl:s,listFullUrl:l,url:Object(ve.c)({webAbsoluteUrl:s}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:u.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent(),e(Object(Mt.a)({items:(d={},d[t]=[B.h],d)})),i.label=3;case 3:return[2]}})})}}),Ht=n("eVX6"),Wt=Object(a.e)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,a=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,l,c;return Object(i.__generator)(this,function(u){switch(u.label){case 0:return t=d.a.deserialize(n),r=t.rootFolder||new Ht.a(t.listFullUrl).path,s=new be.a({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}}),l=s.getUrlParts({path:r}),c=l.fullItemUrl,[4,e(Object(ge.b)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Jt({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:l.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,s=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!s)throw"Fail to create custom document";var l=c+"/"+s;e(Object(N.a)({items:(r={},r[a]=Object(i.__assign)(Object(i.__assign)({},B.h.pack(s)),B.e.pack(l)),r)})),e(Object(Mt.a)({items:(o={},o[n]=[H.b],o)}))})];case 1:return u.sent(),[2]}})})}});function Jt(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(ve.a)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var Zt=n("rWQz"),Qt=n("J37h"),Xt=n("ftiL"),Yt=n("Mrnz"),$t=n("0oI4");function en(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new Xt.a(t.getEffectiveViewXml());if(n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0}),n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}}),r)for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];Yt.a(i,o)}try{var s=Object($t.a)(t.id,!0);s&&(i.updateColumnWidths(s),Object($t.b)(t.id))}catch(e){}return i}var tn=n("MQWL"),nn=Object(a.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d,m,f,h,_,v,g,y,I,O,w,j,S,A,k,U,C,F,P,E,x;return Object(i.__generator)(this,function(D){return r=p.a.deserialize(t),a=Object.keys(n)[0],o=n[a],s=o.sourceView,l=o.isPublic,c=o.itemSetKey,u=o.progressItemKey,s&&r?(d=e(Object(wt.a)({deserializedItemSetKey:b.a,filterableSet:W.Jc,childItems:H.a,parentItem:H.f,schema:H.g},c)),m=d.deserializedItemSetKey,f=d.filterableSet,h=d.childItems,_=d.parentItem,v=d.schema,g=m&&m.viewKey&&Qt.a.serialize(m.viewKey)||"",y=e(Object(wt.a)({viewType:W.pd},g)).viewType,(I=m?en({sourceView:s,deserializedItemSetKey:m,appliedFilters:f&&f.appliedFilters}):s).prepareForSaving(),O=e(Object(re.a)(function(e){return Object(tn.a)(e,c)})),w=O&&Object(xt.getKillSwitch)(O).isActivated("E05C14DE-D6D7-4E39-9616-2D192123BAC3","2/1/21","Include ViewTypeKind in payload"),j=y&&Xt.a.getViewTypeInfo(y),S=!w&&j?j.viewTypeKind:void 0,A=j?j.viewType2:void 0,k=Object(ve.a)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add"),P=s.getEffectiveAggregatesFieldXml(),E=s.viewData,x=s.customFormatter,[2,e(Object(ge.b)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:k.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:a,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:s.getEffectiveFieldNames()},Query:I.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!l,RowLimit:s.rowLimit},S?{ViewTypeKind:S}:{}),A?{ViewType2:y}:{}),{ViewData:E})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,a;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;C={viewId:xt.Guid.normalizeLower(o.Id,!1)},U=new Xt.a(t.d),Object($t.c)(U);var s=new Z.a;return s.resolveItems({items:(n={},n[Qt.a.serialize(C)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Qt.a.pack(C)),W.uc.pack(o)),W.p.pack(U)),W.wc.pack(!1)),n)}),m&&(F=b.a.serialize(Object(i.__assign)(Object(i.__assign)({},m),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:C})),s.resolveItems({items:(r={},r[F]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},h?H.a.pack(h):{}),_?H.f.pack(_):{}),v?H.g.pack(v):{}),r)})),u&&s.resolveItems({items:(a={},a[u]=Object(i.__assign)({},Qt.a.pack(C)),a)}),e(s.execute())}).then(function(){var n,r;if(s.scope||P||x){var a={};return s.scope&&(a.scope=s.scope),e(Object(ue.a)({enableModernColumnTotalsSettings:W.N})).enableModernColumnTotalsSettings&&P&&(a.aggregations=P),x&&(a.customFormatter=x),e(Object(T.a)({items:(n={},n[t]={views:(r={},r[U.id]=Object(i.__assign)({},a),r)},n)}))}}).then(function(){var n,r;return e(Object(Mt.a)({items:Object(i.__assign)((n={},n[t]=[H.a],n),P?(r={},r[Qt.a.serialize(C)]=[W.zc],r):{})}))})]):[2]})})}}),rn=Object(a.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d,m,f,h,_,v,g,y,I,O,w,j,S,A,k,T,U,C;return Object(i.__generator)(this,function(F){return r=p.a.deserialize(t),a=Object.keys(n)[0],o=n[a],s=o.isPublic,l=o.viewType,c=o.viewFields,u=o.viewStyles,d=o.viewData,m=o.queryXml,f=o.rowLimit,h=o.itemSetKey,_=o.progressItemKey,r?(v=e(Object(wt.a)({deserializedItemSetKey:b.a,childItems:H.a,parentItem:H.f,schema:H.g},h)),g=v.deserializedItemSetKey,y=v.childItems,I=v.parentItem,O=l&&Xt.a.getViewTypeInfo(l),w=O?O.viewTypeKind:void 0,j=O?O.viewType2:void 0,S=Object(ve.a)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),A=S.segment("Views").segment("Add"),[2,e(Object(ge.b)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:A.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:a,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:c}},w?{ViewTypeKind:w}:{}),j?{ViewType2:j}:{}),{ViewData:d,CalendarViewStyles:u,Query:m,Paged:!0,PersonalView:!s,RowLimit:f})}),qosName:"CreateFreshView",noRedirect:!0})).then(function(t){var n,r,a;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;T=xt.Guid.normalizeLower(o.Id,!1),U={viewId:T},k=new Xt.a(o),Object($t.c)(k);var s=new Z.a;return s.resolveItems({items:(n={},n[Qt.a.serialize(U)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Qt.a.pack(U)),W.uc.pack(o)),W.p.pack(k)),W.wc.pack(!1)),n)}),g&&(C=b.a.serialize(Object(i.__assign)(Object(i.__assign)({},g),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:U})),s.resolveItems({items:(r={},r[C]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},y?H.a.pack(y):{}),I?H.f.pack(I):{}),H.g.pack({columnKeys:[]})),r)})),_&&s.resolveItems({items:(a={},a[_]=Object(i.__assign)({},Qt.a.pack(U)),a)}),e(s.execute())}).then(function(){var n;return e(Object(Mt.a)({items:(n={},n[t]=[H.a],n)}))})]):[2]})})}}),an=Object(a.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d,m,b,f;return Object(i.__generator)(this,function(i){return r=p.a.deserialize(t),a=Object.keys(n)[0],o=n[a],s=o.viewXml,l=o.viewTitle,r?(c=r.webAbsoluteUrl,u=r.listFullUrl,d=Object(ve.a)({webAbsoluteUrl:c,listFullUrl:u}),m=d.method("Views",a),b=e(Object(re.a)(function(e){return c&&u?e.demandItemFacet(W.Yc,Je.a.serialize({webAbsoluteUrl:c,listFullUrl:u})):void 0})),f=!!b&&!Object(xt.getKillSwitch)(b).isActivated("D554A99B-07B1-4652-8A7E-940F6CD0EE85","01/08/2021","Enable updating View Title in Edit view dialog"),[2,e(Object(ge.b)({webAbsoluteUrl:c,listFullUrl:u,url:m.method("SetViewXml").toString(),method:"POST",body:JSON.stringify({viewXml:s}),qosName:"saveViewXML"})).then(function(){f&&l&&e(Object(ge.b)({webAbsoluteUrl:c,listFullUrl:u,url:m.toString(),method:"MERGE",body:JSON.stringify({__metadata:{type:"SP.View"},Title:l}),qosName:"updateViewTitle"}))})]):[2]})})}}),on=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=p.a.deserialize(t),a=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,s,l;return Object(i.__generator)(this,function(c){return r&&a?(o=n[a],s=Object(ve.a)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",a),l={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title},"number"==typeof o.scope&&(l.Scope=o.scope),o.aggregations&&(l.Aggregations=o.aggregations,l.AggregationsStatus="On"),o.customFormatter&&(l.CustomFormatter="<![CDATA["+o.customFormatter+"]]>"),[2,e(Object(ge.b)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:s.toString(),method:"POST",body:JSON.stringify(l),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,s=e(Object(wt.a)({childItems:H.a},t)).childItems;if(s){for(var l=new Z.a,c=Qt.a.serialize({viewId:a}),u=void 0,d=void 0,m=void 0,p=0,b=s.itemKeys;p<b.length;p++){var f=b[p],h=e(Object(wt.a)({view:W.p},f)).view;h&&(h.isDefault&&(u=h,d=f),f===c&&(m=h))}return"boolean"==typeof o.isDefault&&(o.isDefault&&u&&d&&(u.isDefault=!1,l.resolveItems({items:(n={},n[d]=Object(i.__assign)({},W.p.pack(u)),n)})),m&&c&&(m.isDefault=o.isDefault,l.resolveItems({items:(r={},r[c]=Object(i.__assign)({},W.p.pack(m)),r)}))),e(l.execute())}})]):[2]})})}}),sn=n("SU1E"),ln=n("s9rn"),cn={key:sn.a,displayName:B.h,email:ln.a,picture:ln.b},un=Object(a.e)()(function(e){var t=this,n=e.itemKey,r=h.a.deserialize(n),a=r&&r.spItem,o=a.webAbsoluteUrl,s=a.listFullUrl,l=a.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,c,u,d,m;return Object(i.__generator)(this,function(p){switch(p.label){case 0:return t=l&&Object(ve.a)({webAbsoluteUrl:o,listFullUrl:s}).method("GetItemById",l).segment("likedByInformation"),r=new Z.a,(c=t)?[4,e(Object(ge.d)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:s}))]:[3,2];case 1:c=p.sent(),p.label=2;case 2:return u=[],(d=(a=c)&&a.d&&a.d.likedBy&&a.d.likedBy.results)&&d.forEach(function(e){var t,n=e.email,i=sn.a.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(D.c)(cn,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)}),u.push(i)}),r.resolveItems({items:(m={},m[n]=Object(i.__assign)({},B.u.pack({personKeys:u})),m)}),e(r.execute()),[2]}})})}}),dn=n("fKe+"),mn=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,s,l,c,u,d,m,f,h,_,v,g,y,I,O,w,j;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=p.a.deserialize(t),o=Object.keys(r)[0],n&&o?(s=r[o],l=s.itemSetKey,c=s.shouldSaveViewFieldsOnly,u=s.newDocumentTemplatesJsonString,d=s.shouldSaveAggregationsOnly,m=e(Object(wt.a)({deserializedViewKey:Qt.a,currentDerivedView:W.p},o)),f=m.deserializedViewKey,h=m.currentDerivedView,_=f&&f.viewId,h&&_?(v=void 0,c||u||d?[4,e(Object(dn.a)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,viewId:_}))]:[3,2]):[3,4]):[3,4];case 1:return(g=i.sent())&&g.view&&(v=g.view,c?v.replaceFields(h.getEffectiveFieldNames()):u?v.updateNewDocumentTemplates(u):d&&v.replaceAggregates(h.getEffectiveAggregatesData())),[3,3];case 2:y=e(Object(wt.a)({deserializedItemSetKey:b.a,filterableSet:W.Jc},l)),I=y.deserializedItemSetKey,O=y.filterableSet,I&&(v=en({sourceView:h,deserializedItemSetKey:I,appliedFilters:O&&O.appliedFilters}),(w=e(Object(wt.a)({viewType:W.pd},o)).viewType)&&v.updateViewType(w)),i.label=3;case 3:if(v&&(v.prepareForSaving(),h.isDirty()||v.isDirty()))return j=Object(ve.a)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",_).method("SetViewXml"),[2,e(Object(ge.b)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:j.toString(),method:"POST",body:JSON.stringify({viewXml:v.getEffectiveViewXml()}),qosName:a||"saveView"}))];i.label=4;case 4:return[2]}})})}}),pn=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c,u,d,m,f,h,_,v,g,y,O,w,j,S,A,k,T;return Object(i.__generator)(this,function(C){switch(C.label){case 0:if(!(r=e(Object(wt.a)({setKey:b.a},t)).setKey))return[3,3];if(a=Object.keys(n)[0],o=n[a],s=o.modifyType,l=o.targetIndex,!(c=r.viewKey?Qt.a.serialize(r.viewKey):void 0))return[3,3];if(!(u=e(Object(wt.a)({currentDerivedView:W.p},c)).currentDerivedView))return[3,3];if(d=u.getEffectiveFieldNames(),!(m=e(Object(wt.a)({internalName:W.tb},a)).internalName))return[3,3];if((f=d.indexOf(m))<0||1===s&&0===f||2===s&&f===d.length-1)return[2];switch(h=u.isDirty(),s){case 0:u.updateField(m);break;case 1:u.updateField(m,f-1);break;case 2:u.updateField(m,f+1);break;case 3:u.updateField(m,l)}return _={ODB:1318},v=e(Object(re.a)(function(e){return e.demandItemFacet(W.Yc,Je.a.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))})),g=e(Object(re.a)(function(e){return{isAutoSaveEnabled:Object(vt.a)(e,{feature:_,pageContext:v}),list:e.demandItemFacet(W.Ib,I.a.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}})),y=g.isAutoSaveEnabled,O=g.list,w=!1,y&&O&&O.permissions&&O.permissions.manageLists?[4,e(Object(U.a)({items:(S={},S[p.a.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})]={views:(A={},A[c]={shouldSaveViewFieldsOnly:!0},A),qosName:"autoSaveModifyColumn"},S)})).then(function(){h||(u.baseViewXml=u.getEffectiveViewXml()),w=!0},function(e){throw xt.OdspErrorHelper.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:m,modifyType:s,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),e})]:[3,2];case 1:C.sent(),C.label=2;case 2:j=new Z.a,y&&w||j.resolveItems({items:(k={},k[c]=Object(i.__assign)({},W.wc.pack(!0)),k)}),j.invalidateItems({items:(T={},T[t]=[H.a],T[c]=[W.p],T)}),e(j.execute()),C.label=3;case 3:return[2]}})})}}),bn=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,a,o,s;return Object(i.__generator)(this,function(l){return n=Object.keys(t)[0],r=t[n],a=r.updateType,o=r.formatter,0===a?[2,e(Object(N.a)({items:(s={},s[n]=Object(i.__assign)({},W.q.pack(o)),s)}))]:[2]})})}}),fn=n("mUlA"),hn=n("ZUWj"),_n=n("vLsd"),vn=n("H8DK"),gn=Object(a.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,a=f.a.deserialize(n),o=a&&a.itemSetKey,s=o.webAbsoluteUrl,l=o.listFullUrl,c=o.rootFolder,u=d.a.serialize({webAbsoluteUrl:s,listFullUrl:l,rootFolder:c}),m=Object.keys(r)[0],p=r[m].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,d;return Object(i.__generator)(this,function(b){switch(b.label){case 0:return t=e(Object(wt.a)({sourceFile:_n.b},m)).sourceFile,a=e(Object(ue.a)({listItemUploader:W.Mb})).listItemUploader,o=void 0===a?hn.a:a,[4,e(o({itemKey:u,options:{sourceEntries:r}}))];case 1:s=b.sent().itemKey,b.label=2;case 2:return b.trys.push([2,4,,5]),[4,e(Object(fn.a)({items:(l={},l[s]={groupKey:n},l)}))];case 3:case 4:return b.sent(),[3,5];case 5:return e(Object(Mt.a)({items:(c={},c[u]=[H.b],c)})),p&&t&&e(Object(N.a)({items:(d={},d[p]=Object(i.__assign)(Object(i.__assign)({},vn.f.pack({itemKey:s})),Object(D.c)({progressSize:vn.q},{progressSize:{current:t.size}})),d)})),[2]}})})}}),yn=n("18Xy"),In=Object(a.e)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,r=p.a.deserialize(n),a=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,l,c,u,d,m,b,f,h;return Object(i.__generator)(this,function(_){switch(_.label){case 0:return t=[],s=new Z.a,l=I.a.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),c=e(Object(wt.a)({list:W.Ib},l)),u=e(Object(ue.a)({localeConfiguration:Be.v})).localeConfiguration,[4,e(Object(dn.b)({webAbsoluteUrl:a,listFullUrl:o,listTemplate:c.list&&c.list.templateType,preferredLanguage:u&&u.language}))];case 1:return d=_.sent(),m={},b=void 0,d.filter(function(e){return!!e.view}).map(function(n){var r,l=n.serverView,c=n.view,u={viewId:c.id},d=Qt.a.serialize(u);if(c.isDefault){b=d;var p=c.getDomParts().newDocumentTemplates;p&&p.textContent&&s.merge(Object(yn.a)({webAbsoluteUrl:a,listFullUrl:o,newDocumentTemplatesString:p.textContent}).itemResolver)}m[d]=c,Object($t.c)(c);var f=e(Object(re.a)(function(e){if(e.isItemFacetResolved(W.p,d))return e.demandItemFacet(W.p,d)})),h=!!f&&f.getEffectiveViewXml().replace(/ \/>/g,"/>")===c.getEffectiveViewXml().replace(/ \/>/g,"/>");s.resolveItems({items:(r={},r[d]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Qt.a.pack(u)),W.uc.pack(l)),h?{}:W.p.pack(c)),W.wc.pack(!1)),W.pd.pack(c.viewType)),r)}),t.push(d)}),t.sort(function(e,t){return m[e].compareTo(m[t])}),s.resolveItems({items:(f={},f[n]=Object(i.__assign)(Object(i.__assign)({},p.a.pack(r)),H.a.pack({itemKeys:t})),f)}),b&&s.resolveItems({items:(h={},h[l]=Object(i.__assign)({},W.t.pack({viewKey:b})),h)}),e(s.execute()),[2]}})})}}),On=n("QU/z"),wn=n("iHu4"),jn=n("8x+S"),Sn=n("3SKL"),An=n("FBdU"),kn=n("djFM"),Tn=n("9kMg"),Un=n("KvhV"),Cn=n("e6xE");function Fn(e){for(var t,n,r,a=e.setKey,o=e.actions,s=new Z.a,l=[],c=0,u=0,d=o;u<d.length;u++){var m=d[u],p=[];if(Object(kn.a)(m))for(var b=0,f=0,h=m.children;f<h.length;f++){var _=h[f],v=_.id?_.id:_.text+c+"."+b,g=On.a.serialize({actionId:v});Pn(_)||s.resolveItems({items:(t={},t[g]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(_.text)),B.z.pack(_.action)),Sn.a.pack(_.allowMultiSelect)),Sn.c.pack(_.isEnabled||!1)),Sn.b.pack(_.iconUrl)),t)}),p.push(g),b++}if(Object(kn.a)(m)||!Pn(m)){var y=m.id?m.id:m.text+c.toString(),I=On.a.serialize({actionId:y});s.resolveItems({items:(n={},n[I]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(m.text)),H.a.pack({itemKeys:p})),B.z.pack(Object(kn.a)(m)?"":m.action)),Object(kn.a)(m)?{}:Sn.a.pack(m.allowMultiSelect)),Object(kn.a)(m)?{}:Sn.c.pack(m.isEnabled||!1)),Object(kn.a)(m)?{}:Sn.b.pack(m.iconUrl)),n)}),l.push(I)}c++}var O=l.length>0?{itemKeys:l}:void 0;return s.resolveItems({items:(r={},r[a]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},X.f.pack(!0)),H.a.pack(O)),W.qc.pack(o)),r)}),{itemResolver:s}}function Pn(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==xt.Guid.Empty)||!1}var En=Object(a.e)()(function(e){var t=e.itemKey,n=_.a.deserialize(t),r=n.webAbsoluteUrl,a=n.listFullUrl;return function(e){var n,o=e(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl;return function(e){var r=e(Object(wt.a)({pageContext:W.Yc},Je.a.serialize({webAbsoluteUrl:t,listFullUrl:n}))),i=e(Object(wt.a)({list:W.Ib},I.a.serialize({webAbsoluteUrl:t,listFullUrl:n})));return{currentUserIsSiteAdmin:r.pageContext&&r.pageContext.isSiteAdmin||!1,listTemplate:i.list&&i.list.templateType||Tn.b.invalidType,listId:i.list&&i.list.id||"",isDocumentLibrary:i.list&&i.list.isDocumentLibrary||!1}}}({webAbsoluteUrl:r,listFullUrl:a}));if(o.listTemplate===Tn.a.mySiteDocumentLibrary){var s=new Z.a;return s.resolveItems({items:(n={},n[t]=Object(i.__assign)({},H.a.pack(void 0)),n)}),e(s.execute()),Promise.resolve()}return e(function(e,t,n){var r=Object(ve.a)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(i){return i(Object(ge.d)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:r.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return Object(kn.b)(e.d.CustomActionElements.Items.results,n)})}}(r,a,o)).then(function(n){return e(function(e){var t=e.customActionSetKey,n=e.customActions,r=e.context,a=_.a.deserialize(t),o=a.webAbsoluteUrl,s=a.listFullUrl;return function(e){var a=new Z.a,l=Cn.a.serialize({webAbsoluteUrl:o,listFullUrl:s}),c=e(Object(wt.a)({enableDebugClientSideExtensions:W.y},He.a)).enableDebugClientSideExtensions;c&&c.customActions&&function(e,t){if(t){var n=e.ContextMenu||[],r=e["Ribbon.Documents"]||[],a=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var s=JSON.parse(t);if(s)for(var l=0,c=Object.keys(s);l<c.length;l++){var u=c[l];try{var d=s[u],m=d.location,p=d.properties,b={text:o[m],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:u,clientSideComponentProperties:"object"==typeof p?JSON.stringify(p):""},f="ClientSideExtension.ListViewCommandSet"===m,h="ClientSideExtension.ListViewCommandSet.CommandBar"===m||f;("ClientSideExtension.ListViewCommandSet.ContextMenu"===m||f)&&n.push(b),h&&(r.push(Object(i.__assign)({},b)),a.push(Object(i.__assign)({},b)))}catch(e){console.log("Error processing query parameter for "+u)}}}catch(e){console.log("error in parsing query parameter for custom actions")}}}(n,c.customActions);var u=Fn({setKey:t,actions:n[r.isDocumentLibrary?"Ribbon.Documents":"Ribbon.List"]}).itemResolver,d=Fn({setKey:l,actions:n.ContextMenu}).itemResolver;return a.merge(d),a.merge(u),a}}({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),xn=Object(a.e)()(function(e){var t=this,n=e.itemKey,r=v.a.deserialize(n),a=r.webAbsoluteUrl,o=r.listFullUrl,s=r.isSPFXandCustomActionsAvailable,l=r.targetCustomActionSetKey,c=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,d,m,p,b,h,_,v,g;return Object(i.__generator)(this,function(y){switch(y.label){case 0:return t=new Z.a,r=I.a.serialize({webAbsoluteUrl:a,listFullUrl:o}),u=e(Object(re.a)(Un.a)),d=function(){var n;t.resolveItems({items:(n={},n[r]=An.g.pack(void 0),n)}),e(t.execute())},s||u?(p=u)?[4,u()]:[3,2]:(d(),[2]);case 1:p=y.sent(),y.label=2;case 2:return b=!1,(m=p)?(h=m.createListViewAdapter(),t.resolveItems({items:(g={},g[r]=Object(i.__assign)({},h?An.g.pack(h):{}),g)}),_=e(Object(wt.a)({rawCustomActions:W.qc},l)).rawCustomActions,[4,Dn({setKey:n,actions:_||[],listViewAdapter:h})]):[3,7];case 3:return v=y.sent().itemResolver,t.merge(v),[4,e(Object(xe.a)(function(e){var n=Object(Ne.a)(e,c);if(n&&h){var r=e.demandItemFacet(H.a,n),s=r&&r.itemKeys,l=function(n){var r,a=e.isItemFacetResolved(W.tc,n)?e.demandItemFacet(W.tc,n):void 0;if(a&&h){var o=h.createRowAdapter({values:a});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?An.h.pack(o):{}),r)})}else if(e.demandItemFacet(f.a,n)){var s=e.isItemFacetResolved(H.a,n)?e.demandItemFacet(H.a,n):void 0;if(s)for(var c=0,u=s.itemKeys;c<u.length;c++){var d=u[c];l(d)}}};if(s)for(var u=0,d=s;u<d.length;u++){var m=d[u];l(m)}var p=e.demandItemFacet(H.g,n),_=p&&p.columnKeys||[];if(_&&h)for(var v=function(n){var r,i=e.demandItem({fieldId:W.eb,internalName:W.tb,realFieldName:W.rc,fieldType:W.db,isRequired:jn.d,displayName:B.h,clientSideComponentId:An.a,clientSideComponentProperties:An.b},n),s=i.fieldId,l=i.internalName,c=i.realFieldName,u=i.fieldType,d=i.isRequired,m=i.displayName,p=i.clientSideComponentId,f=i.clientSideComponentProperties;if(s&&l){b=!0;var _={listKey:{webAbsoluteUrl:a,listFullUrl:o},internalName:l},v={id:s,internalName:c||l,fieldType:u||"Text",isRequired:d||!1,isVisible:!0,displayName:m||"",clientSideComponentId:p||xt.Guid.Empty,clientSideComponentProperties:f||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+l+",\n                      componentId: "+p+", error: "+e.message)}},g=h.addColumnAdapter(v);if(p&&p!==xt.Guid.Empty){var y=wn.a.serialize(_);t.resolveItems({items:(r={},r[y]=An.c.pack(g),r[n]=An.d.pack(y),r)})}}},g=0,y=_;g<y.length;g++)v(y[g])}}))];case 4:return y.sent(),b?[4,h.loadFieldCustomizers()]:[3,6];case 5:y.sent(),y.label=6;case 6:return[3,8];case 7:d(),y.label=8;case 8:return e(t.execute()),[2]}})})}});function Dn(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,a,o,s,l,c,u,d,m;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=e.setKey,n=e.actions,r=e.listViewAdapter,a=new Z.a,o=[],s=0,l=function(e){var t,n,l,c,u,d,m,p,b,f,h,_;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(t=[],!Object(kn.a)(e))return[3,5];n=e.children,l=0,c=0,u=n,i.label=1;case 1:return c<u.length?(d=u[c],m=d.id?d.id:d.text+s+"."+l,p=On.a.serialize({actionId:m}),Nn(d)&&r?[4,Ln({action:d,listViewAdapter:r})]:[3,3]):[3,5];case 2:b=i.sent(),_=b.actionKeys,h=b.itemResolver,a.merge(h),_.forEach(function(e){t.push(e)}),i.label=3;case 3:t.push(p),l++,i.label=4;case 4:return c++,[3,1];case 5:return!Object(kn.a)(e)&&Nn(e)&&r?[4,Ln({action:e,listViewAdapter:r})]:[3,7];case 6:f=i.sent(),h=f.itemResolver,_=f.actionKeys,a.merge(h),o=o.concat(_),i.label=7;case 7:return s++,[2]}})},c=0,u=n,p.label=1;case 1:return c<u.length?(d=u[c],[5,l(d)]):[3,4];case 2:p.sent(),p.label=3;case 3:return c++,[3,1];case 4:return a.resolveItems({items:(m={},m[t]=Object(i.__assign)(Object(i.__assign)({},X.f.pack(!0)),H.a.pack(0===o.length?void 0:{itemKeys:o})),m)}),[2,{itemResolver:a}]}})})}function Ln(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,a,o,s,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:return t=e.action,n=e.listViewAdapter,r=new Z.a,a=[],o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"",s=t.clientSideComponentProperties||"",o&&o!==xt.Guid.Empty?[4,n.loadCommandSet(o,s).catch(function(){})]:[2,{itemResolver:r,actionKeys:[]}];case 1:return(l=c.sent())&&l.commandAdapters&&l.commandAdapters.forEach(function(e){var n,o=t.clientSideComponentId+"."+e.commandId,s=On.a.serialize({actionId:o});r.resolveItems({items:(n={},n[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},B.h.pack(e.title)),B.z.pack(t.action)),Sn.a.pack(t.allowMultiSelect)),Sn.c.pack(t.isEnabled||!1)),Sn.b.pack(e.iconUrl||t.iconUrl)),An.e.pack(e)),n)}),a.push(s)}),[2,{itemResolver:r,actionKeys:a}]}})})}function Nn(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==xt.Guid.Empty)||!1}var Kn=Object(a.e)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=g.a.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u;return Object(i.__generator)(this,function(d){switch(d.label){case 0:return t=Object(ve.c)({webAbsoluteUrl:r}).segments("ComponentContextInfo"),[4,n(Object(ge.b)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:return a=d.sent(),o=JSON.parse(a.d.SerializedData),s=o.isSPO,l=void 0===s||s,(c=new Z.a).resolveItems({items:(u={},u[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},W.cc.pack(l?void 0:{})),W.Yc.pack(o)),u)}),n(c.execute()),[2]}})})}}),Rn=n("jrqp"),zn=n("+jOK"),qn=n("TdeX"),Mn=n("ldEy"),Gn=Object(a.c)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m,p,h,_,v,g,y,I,O,w,j,S;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(t=e(Object(re.a)(function(e){return e.demandItemFacet(f.a,r)})),!(a=t&&t.itemSetKey&&b.a.serialize(t.itemSetKey))||n.length<1||!r)return[2];if(o=e(Object(wt.a)({spGroupField:W.Oc,groupValue:W.rb,parentGroupKey:W.ec,defaultCollapsed:X.b},r)),s=o.spGroupField,l=o.groupValue,c=o.parentGroupKey,u=o.defaultCollapsed,d=[],s&&s.internalName&&l&&d.push({FieldName:s.internalName,FieldValue:l}),c&&c.itemKey&&(m=e(Object(wt.a)({parentGroupField:W.Oc,parentGroupValue:W.rb},c.itemKey)),p=m.parentGroupField,h=m.parentGroupValue,p&&p.internalName&&h&&d.push({FieldName:p.internalName,FieldValue:h})),t&&t.itemSetKey&&t.itemSetKey.filterParams&&(_=zn.a.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(v=0;v<_.length;v++)g=_[v],y=e(Object(wt.a)({isReadOnly:W.zb},Rn.a.serialize({listKey:t.itemSetKey,internalName:g.fieldName}))).isReadOnly,1===g.values.length&&!1===y&&d.push({FieldName:g.fieldName,FieldValue:g.values[0]});return[4,e(Object(qn.a)({items:(O={},O[a]={itemKeys:n,formValues:d,qosName:"AssignItemsToGroup"},O)}))];case 1:return i.sent(),I={},n.forEach(function(e){I[e]={}}),[4,e(Object(Mn.a)({items:(w={},w[a]=I,w)}))];case 2:return i.sent(),e(u?Object(Mt.a)({items:(j={},j[r]=[H.a],j)}):Object(Mt.a)({items:(S={},S[a]=[H.a],S)})),[2]}})})}}),Vn=n("7YMn"),Bn=new Vn.a("getDefaultShareLinkActionControl"),Hn=n("bezv"),Wn=Object(je.a)()(function(){return function(e){return Jn}});function Jn(e,t){var n=t.itemKey,r=e.demandItem({driveItem:d.a,canonicalLinkUrl:B.e},n),a=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o,s,l,c,u,d,m,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(r=e.canonicalLinkUrl,(t=e.driveItem)&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:if(a=void 0,r){for(o=new Ht.a(r),s=o.authority,l=0,c=o.segments;l<c.length;l++)""!==(u=c[l])&&(s=s+"/"+encodeURIComponent(u));d=Object(Hn.a)(s.toString()),a="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}return m=new Ht.a(t.webAbsoluteUrl).authority,[4,n(Object(ge.b)({webAbsoluteUrl:m,listFullUrl:void 0,url:m+"/_api/v2.0/shares/"+a+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}}({driveItem:a,canonicalLinkUrl:o})}}}var Zn=n("Xtay"),Qn=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.isNewDocumentUpdate,a=n.checkInComment,o=n.formValues;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,s,l,c,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o.length>0?[4,e(Object(Gt.a)(t))]:[3,3];case 1:return n=i.sent(),s=n.key,l=n.itemId,c=function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(ve.a)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()}({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:l||s.itemId||""}),(u={}).formValues=o,u.bNewDocumentUpdate=r,u.checkInComment=a,[4,e(Object(ge.b)({body:JSON.stringify(u),listFullUrl:s.listFullUrl,method:"POST",qosName:"updateItem.ValidateUpdateListItem",url:c,webAbsoluteUrl:s.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:i.sent(),i.label=3;case 3:return[2]}})})}}),Xn=n("JyUB"),Yn=n("nVPC"),$n=n("zLs4"),er=n("Zq6i"),tr=Object(a.e)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,a,o,s,l,c;return Object(i.__generator)(this,function(u){switch(u.label){case 0:return r=b.a.deserialize(t),a=n(Object(At.c)({itemSetKey:r})),o=Object.keys(e.options),[4,n((m={itemSetKey:t,itemKeys:o},function(e){for(var t=m.itemSetKey,n=m.itemKeys,r=e(Object(re.a)(function(e){var n=e.demandItemFacet(b.a,t)||b.a.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object(tn.a)(e,d.a.serialize(n))})})),a=r.webAbsoluteUrl,o=r.listFullUrl,s=r.pageContext,l=[],c=0,u=n;c<u.length;c++){var p=u[c],f=d.a.deserialize(p).itemId;f||(f=e(Object(wt.a)({listItemId:W.Lb},p)).listItemId),f&&l.push(f)}var h=e(Object(Yn.a)({internalName:W.tb},t)),_=["Modified"];if(h)for(var v=0,g=h;v<g.length;v++){var y=g[v];y.internalName&&"Modified"!==y.internalName&&_.push(y.internalName)}return{webAbsoluteUrl:a,listFullUrl:o,currentPageContext:s,qosName:"refreshItemsInSet",viewXml:Object(Xn.d)({itemIds:l,recurseInFolders:!0,pageSize:n.length,fieldNames:_.length>0?_:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:return s=u.sent(),[4,n(Object(Tt.a)({getItemContext:s}))];case 2:return l=u.sent(),c=n(Object($n.b)({serverData:l,itemSetKey:r,currentPageContext:s.currentPageContext,contentTypes:a,isItemSetRequest:!0})).itemResolver,n(c.execute()),n(Object(er.a)({itemSetKey:t,serverData:l,isItemSetRequest:!0})),[2]}var m})})}}),nr=new Vn.a("permissionInviteActionControl"),rr=Object(je.a)()(function(){return function(e){return ir}});function ir(e,t){var n=t.itemKey,r=t.link,a=t.recipients,o=e.demandItem({driveItem:d.a},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a,o,s,l,c,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e.link,a=e.recipients,(t=e.driveItem)?(s=Object(Hn.a)(r),o="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),l=a.map(function(e){return{email:e}}),c={recipients:l,roles:["read"]},u=new Ht.a(t.webAbsoluteUrl).authority,[4,n(Object(ge.b)({webAbsoluteUrl:u,listFullUrl:void 0,url:u+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(c),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))]):[3,2];case 1:return[2,{recipients:i.sent().value[0].grantedToIdentities.map(function(e){return{email:e.user.email}})}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}}({driveItem:o,link:r,recipients:a})}}}var ar=n("U5g/"),or=Object(je.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(d.a,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},a=e.demandItemFacet(W.Ib,I.a.serialize(i)),o=e.demandItemFacet(W.Yc,Je.a.serialize(i));if(!o)return{};var s=a&&a.templateType===Tn.a.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:s?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}}),sr=n("s8I5"),lr=n("DOzE"),cr=n("VSW6"),ur=n("SJhz"),dr=Object(je.a)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:d.a,driveItemKey:lr.a},n),a=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(cr.a)(o)};if(a){var s={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl},l=e.demandItem({listMediaFacets:ur.b},I.a.serialize(s)).listMediaFacets;if(l&&l[".driveUrl"]){var c=l[".driveUrl"],u=a.rootFolder||"",m="";if(u){var p=new be.a({context:{webAbsoluteUrl:a.webAbsoluteUrl,listUrl:a.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(m=u.replace(p.serverRelativeListUrl,"")).charAt(0)&&(m="/"+m)}return{driveItemFullUrl:r=c+"/items/root"+(m?":":"")+m}}}return{driveItemFullUrl:r}}}}),mr=n("HFG5"),pr=Object(a.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,a=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,s,l,c,u,d,m,f,h,_,v,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return(n=e(Object(wt.a)({setKey:b.a},t)).setKey)&&(o=n.viewKey?Qt.a.serialize(n.viewKey):void 0)&&(s=e(Object(wt.a)({currentDerivedView:W.p},o)).currentDerivedView)?(l=e(Object(wt.a)({internalName:W.tb,fieldType:W.fb,fieldFieldType:W.db},a)),c=l.internalName,u=l.fieldType,d=l.fieldFieldType,c?(m=e(Object(wt.a)({spFolderAggregates:W.k},t)).spFolderAggregates,f=s.isDirty(),!(h=m&&m[a]?m[a].aggregateFunctionType:void 0)&&0===r||h===mr.a[r]?[2]:(_=0===r?void 0:mr.a[r],s.updateColumnAggregateType(c,_),[4,e(Object(U.a)({items:(v={},v[p.a.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(g={},g[o]={shouldSaveAggregationsOnly:!0},g),qosName:"SaveModifyColumnAggregateType"},v)})).then(function(){var n,r=s.getEffectiveViewXml(),i=new Xt.a(s.baseViewXml||"");i.replaceAggregates(s.getEffectiveAggregatesData()),s.baseViewXml=i.getEffectiveViewXml(),s.setDom(r),s.setIsDirty(f);var a=new Z.a;a.invalidateItems({items:(n={},n[t]=[H.a],n[o]=[W.zc],n)}),e(a.execute())},function(e){throw xt.OdspErrorHelper.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:u,fieldFieldType:d,currentAggregateType:h||"None",newAggregateType:_||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),s.updateColumnAggregateType(c,h),s.setIsDirty(f),e})])):[3,2]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})}}),br=n("irYs"),fr=Object(a.e)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,a=n.bNewDocumentUpdate,o=n.checkInComment,s=n.formValues,l=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,c,u,d,m,p,f,h,_,v,g,y,I,O,w;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(s&&s.length&&r&&r.length))return[2];n=b.a.deserialize(t),c=n.viewKey,u=n.rootFolder,d=n.webAbsoluteUrl,m=n.listFullUrl,p=u||"",c&&(!(f=e(Object(wt.a)({currentDerivedView:W.p},Qt.a.serialize(c))).currentDerivedView)||1!==f.scope&&2!==f.scope||(p="")),h=[],_={},v=0,g=r,i.label=1;case 1:return v<g.length?(y=g[v],[4,e(Object(Gt.a)(y))]):[3,4];case 2:I=i.sent().itemId,h.push(parseInt(I,10)),_[I]=y,i.label=3;case 3:return v++,[3,1];case 4:return O=Object(ve.a)({webAbsoluteUrl:d,listFullUrl:m}).method("BulkValidateUpdateListItems").toString(),w={itemIds:h,formValues:s,folderPath:p,bNewDocumentUpdate:a,checkInComment:o},[4,e(Object(ge.b)({body:JSON.stringify(w),listFullUrl:m,method:"POST",qosName:l,url:O,webAbsoluteUrl:d,noRedirect:!0})).then(function(n){for(var r,i="",a={},o=0,s=n.d.BulkValidateUpdateListItems.results;o<s.length;o++){var l=s[o];l.HasException?i=l.ErrorMessage+"\n"+i:_[l.ItemId]&&(a[_[l.ItemId]]={})}if(Object.keys(a).length>0&&e(Object(Mn.a)({items:(r={},r[t]=a,r)})),i)throw new Error(i)})];case 5:return i.sent(),[2]}})})}}),hr=n("WDbG"),_r=n("6Uwp"),vr=n("KIOw"),gr=n("NYNE"),yr=n("nz3y"),Ir=new D.a("removeItemsFromSharedList"),Or=new yr.a("removeItemsFromSharedList"),wr=(Object(yr.f)({operationTypeFacet:Ir,progressKeyFacet:Or}),n("ZaYU")),jr=n.n(wr),Sr=n("YaYu"),Ar=n("doXJ"),kr=Object(a.c)()(Ur),Tr=Object(a.c)()(Ur);function Ur(e){var t=this,n=e.items,r=n[Object.keys(n)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,o,s,l,c,u,d,m,p,b,f,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=[],[4,e(Cr({itemSetKey:r}))];case 1:for(o=i.sent(),s=function(n){var r=e(Object(re.a)(function(e){return e.demandItemFacet(B.e,n)}))||"",i={DecodedUrl:decodeURIComponent(r)};i&&t.push(i)},l=0,c=Object.keys(n);l<c.length;l++)u=c[l],s(u);return a=JSON.stringify({itemPaths:t}),d="RemoveItemsFromSharedWithMeViewByPath",m=Object(ve.c)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+d),[4,e(Object(ge.b)({url:m.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:a,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[d]&&p.d[d].results){if((b=p.d[d].results).length<1)throw new Pt.a({message:jr.a.DefaultTitle});b.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new Pt.a({message:e.ErrorMessage||void 0})})}return(f=new Z.a).invalidateItems({items:(h={},h[r]=[H.a],h)}),e(f.execute()),[2]}})})}}function Cr(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=e(Object(re.a)(function(e){return e.demandItemFacet(Sr.a,n)})),r=t&&t.driveItemKey.endpoint||"",[4,e(Object(xe.a)(function(e){return e.demandItemFacet(d.a,We.a.serialize({tenantRootUrl:new Ar.a(r).authority}))}))];case 1:return[2,(a=i.sent())&&a.webAbsoluteUrl||""]}})})}}var Fr=n("oRIR"),Pr=n("Dd7j"),Er=Object(a.e)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,a=n.relativeItemKey,o=[];r.forEach(function(e){if(d.a.matches(e)){var t=d.a.deserialize(e).itemId;void 0===t||isNaN(Number(t))||o.push(Number(t))}});var s=b.a.deserialize(t),l=s.webAbsoluteUrl,c=s.listFullUrl,u=s.viewKey,m=!!u&&u.viewId,p=void 0;if(a&&d.a.matches(a)){var f=d.a.deserialize(a);f&&(p=f.itemId&&!isNaN(Number(f.itemId))?Number(f.itemId):void 0)}if(!m||o.length<1||a&&!p)throw new Error("Invalid parameters to reorderListItemsOperationHandler");var h=Object(ve.a)({webAbsoluteUrl:l,listFullUrl:c}).method("AddCustomOrderToView").toString();return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n={viewId:m,itemIds:o,relativeItemId:p},[4,e(Object(ge.b)({webAbsoluteUrl:l,listFullUrl:c,url:h,body:JSON.stringify(n),method:"POST",qosName:"ReorderItems",noRedirect:!0}))];case 1:return i.sent()?[4,e(Object(Mt.a)({items:(r={},r[t]=[H.a],r)}))]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})}}),xr=n("xqQV"),Dr=new D.a("addContentTypesToList"),Lr=(new yr.a("addContentTypesToList"),Object(a.b)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return e(Object(o.f)(u.a,l.a)(Ut)),e(Object(o.f)(d.a,w.b)(Lt)),e(Object(o.f)(d.a,j.b)(qt)),e(Object(o.f)(d.a,S.b)(Vt)),e(Object(o.f)(d.a,A.b)(Bt)),e(Fr.sharePointBasicActionsAddonDeferred),e(Object(o.f)(d.a,c.b)(Wt)),e(Object(o.f)(m.a,O.a)(Zt.c)),e(Object(o.f)(d.a,k.a)(Gn)),e(Object(o.f)(p.a,C.b)(nn)),e(Object(o.f)(p.a,F.b)(rn)),e(Object(o.f)(p.a,P.b)(an)),e(Object(o.f)(p.a,T.b)(on)),e(Object(o.f)(p.a,U.b)(mn)),e(Object(o.f)(b.a,x.b)(pn)),e(Object(o.f)(b.a,br.b)(pr)),e(Object(o.f)(b.a,L)(bn)),e(Object(o.f)(b.a,Mn.b)(tr)),e(Object(o.f)(b.a,qn.b)(fr)),e(Object(o.f)(f.a,s.b)(gn)),e(Object(o.f)(h.a,l.a)(un)),e(Object(o.f)(p.a,l.a)(In)),e(Object(o.f)(_.a,l.a)(En)),e(Object(o.f)(v.a,l.a)(xn)),e(Object(o.f)(g.a,l.a)(Kn)),e(Object(o.f)(b.a,ft)(It)),e(Object(o.f)(b.a,Ot)(St)),e(Object(E.a)(d.a,ar.a)(or)),e(Object(E.a)(d.a,sr.a)(dr)),e(Pr.sharePointBasicItemDataAddonDeferred),e(gr.a),e(ze),e(dt),e(bt),e(Object(E.a)(d.a,Bn)(Wn)),e(Object(o.f)(d.a,Zn.a)(Qn)),e(Object(E.a)(d.a,nr)(rr)),e(Object(o.f)(d.a,Ir)(kr)),e(Object(o.f)(y.a,Ir)(Tr)),e(Object(o.f)(b.a,xr.b)(Er)),e(Object(o.f)(I.a,Dr)(Object(a.d)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(15),n.e(65)]).then(n.bind(null,"pnVj"))];case 1:return[2,e.sent().spListAddContentTypesToListOperationHandler]}})})}))),[2]})})}}))},z4dx:function(e,t){var n={printToUniversalPrinter:"Print",PrintToUniversalPrinterTooltip:"Print the selected file using Universal Cloud Printer"};n.default=n,e.exports=n},zwgV:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("LfMA"),i=new r.a("spSharedByMeItemSet",{webAbsoluteUrl:Object(r.f)(),sortField:Object(r.f)(),isAscending:Object(r.c)()})}}]);