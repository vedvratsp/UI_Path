/*! For license information please see 619.chunk.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["619"],{"1556":function(e,t,n){"use strict";n.d(t,"s",function(){return h});n.d(t,"N",function(){return p});n.d(t,"C",function(){return d});n.d(t,"T",function(){return v});n.d(t,"e",function(){return r});n.d(t,"k",function(){return m});n.d(t,"A",function(){return g});n.d(t,"L",function(){return y});n.d(t,"x",function(){return w});n.d(t,"b",function(){return E});n.d(t,"y",function(){return S});n.d(t,"w",function(){return x});n.d(t,"E",function(){return T});n.d(t,"p",function(){return N});n.d(t,"h",function(){return C});n.d(t,"u",function(){return k});n.d(t,"o",function(){return L});n.d(t,"v",function(){return A});n.d(t,"r",function(){return M});n.d(t,"m",function(){return _});n.d(t,"f",function(){return D});n.d(t,"g",function(){return P});n.d(t,"c",function(){return H});n.d(t,"d",function(){return B});n.d(t,"l",function(){return j});n.d(t,"t",function(){return F});n.d(t,"n",function(){return I});n.d(t,"S",function(){return q});n.d(t,"a",function(){return R});n.d(t,"i",function(){return U});var r,i=n(0),s=n(4269),o=n(3927),u=n(4241),a=n(20),f=n(1553),l=n(1558),c=n(1599),h=[f.e.sunday,f.e.monday,f.e.tuesday,f.e.wednesday,f.e.thursday,f.e.friday,f.e.saturday],p=[f.e.shortSunday,f.e.shortMonday,f.e.shortTuesday,f.e.shortWednesday,f.e.shortThursday,f.e.shortFriday,f.e.shortSaturday],d=[f.e.shortJanuary,f.e.shortFebruary,f.e.shortMarch,f.e.shortApril,f.e.shortMay,f.e.shortJune,f.e.shortJuly,f.e.shortAugust,f.e.shortSeptember,f.e.shortOctober,f.e.shortNovember,f.e.shortDecember],v=[f.e.january,f.e.february,f.e.march,f.e.april,f.e.may,f.e.june,f.e.july,f.e.august,f.e.september,f.e.october,f.e.november,f.e.december];(function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"})(r||(r={}));function m(e){return b(e,26)}function g(e,t){return b(e,t=t||25)}function y(e,t){return b(e,t=t||20)}function b(e,t){if(!e)return"";var n=t,r=n/2;return e.length<=n?e:e.slice(0,r)+"..."+e.slice(e.length-r)}function w(e){return e.userRole===s.e.none&&0===e.defaultLinkKind}function E(e,t){switch(e){case"anonymous":return t?5:4;case"organization":return t?3:2;case"users":return 6;default:return 1}}function S(e){switch(e){case"anonymous":return o.e.anyone;case"organization":return o.e.organization;case"users":return o.e.specificPeople;default:return o.e.existing}}function x(e){switch(e){case 5:case 4:return"anonymous";case 3:case 2:return"organization";case 6:return"users";default:return"existingAccess"}}function T(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function N(e,t,n){var r=t.sharingLinkKind,i=t.audience,s="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing",u=l.a(e)?"directrecipients.svg":"peopleinchat.svg";switch(r){case 2:case 3:return s+"/companyonly.svg";case 4:case 5:return s+"/anyone.svg";case 6:return t.audience===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/specificpeople.svg";default:return i===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/existingaccess.svg?v2"}}function C(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return e.audience===o.e.anyone?"Globe":e.audience===o.e.organization?"Work":"PeopleAdd";default:return"Link"}}function k(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function L(e,t,n,r){var i=l.a(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return f.e.peopleInChannelEditLabel;case"review":return c.t[r]?f.e.peopleInChannelOfficeReviewLabel:f.e.peopleInChannelReviewLabel;default:return f.e.peopleInChannelViewLabel}break;case"team":switch(t){case"edit":return f.e.peopleInTeamEditLabel;case"review":return c.t[r]?f.e.peopleInTeamOfficeReviewLabel:f.e.peopleInTeamReviewLabel;default:return f.e.peopleInTeamViewLabel}break;case"recipient":switch(t){case"edit":return f.e.recipientsCanEditLabel;case"review":return c.t[r]?f.e.recipientsCanOfficeReviewLabel:f.e.recipientsCanReviewLabel;default:return f.e.recipientsCanViewLabel}break;default:switch(t){case"edit":return f.e.peopleInChatEditLabel;case"review":return c.t[r]?f.e.peopleInChatOfficeReviewLabel:f.e.peopleInChatReviewLabel;default:return f.e.peopleInChatViewLabel}}}function A(e,t,n,r,i){var s=e.sharingLinkKind,u=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?a.format(f.e.fileRequestCSLDescription,t):f.e.fileRequestDescription;switch(s){case 2:return a.format(f.e.cslViewDescription,t);case 3:return a.format(f.e.cslEditDescription,t);case 4:return f.e.anonViewDescription;case 5:return f.e.anonEditDescription;case 1:return u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.e.customLabeledReviewLabel,r.entityName):L(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.e.customLabeledEditLabel,r.entityName):L(n,"edit",r):r&&r.entityName?a.format(f.e.customLabeledViewLabel,r.entityName):L(n,"view",r):f.e.existingPeopleDescription;case 6:return u===o.e.existing?f.e.existingPeopleDescription:u===o.e.anyone?e.blockDownload?e.hasPassword?f.e.anonymousViewOnlyWithPassword:f.e.anonymousViewOnlyHint:e.hasPassword?e.isReview?c.t[i]?f.e.anonPasswordOfficeReviewDescription:f.e.anonPasswordReviewDescription:e.isEdit?f.e.anonPasswordEditDescription:f.e.anonPasswordViewDescription:e.isReview?c.t[i]?f.e.anonOfficeReviewDescription:f.e.anonReviewDescription:e.isEdit?f.e.anonEditDescription:f.e.anonViewDescription:u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.e.customLabeledReviewLabel,r.entityName):L(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.e.customLabeledEditLabel,r.entityName):L(n,"edit",r):r&&r.entityName?a.format(f.e.customLabeledViewLabel,r.entityName):L(n,"view",r):e.audience===o.e.organization?e.blockDownload?a.format(f.e.cslViewOnlyHint,t):e.isReview?c.t[i]?a.format(f.e.cslOfficeReviewDescription,t):a.format(f.e.cslReviewDescription,t):e.isEdit?a.format(f.e.cslEditDescription,t):a.format(f.e.cslViewDescription,t):e.blockDownload?f.e.specificPeopleViewOnlyHint:e.isReview?c.t[i]?f.e.pslOfficeReviewLabel:f.e.pslReviewLabel:e.isEdit?f.e.pslEditLabel:f.e.pslViewLabel;default:return""}}function O(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function M(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function _(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push(O(o))}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(O(e))},a=0,f=r;a<f.length;a++){u(f[a])}return t}function D(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t}function P(e){var t,n;switch(e){case s.e.edit:t="Edit";n=f.e.canEditRole;break;case s.e.view:t="Uneditable2";n=f.e.canViewRole;break;case s.e.review:t="Feedback";n=f.e.canReviewRole;break;case s.e.owner:t="Signin";n=f.e.fullControlRole}return{name:t,title:n}}function H(e,t){var n=r.none,i=t;if(!e||e.getTime()===new Date(0).getTime())return n;var s=new Date;s.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-s.getTime())/864e5);o<1?n=r.pastDate:o>730?n=r.overMax:o>i&&-1!==i&&(n=r.adminPolicy);return n}function B(e,t){return e===o.e.anyone?t?5:4:e===o.e.organization?t?3:2:e===o.e.specificPeople||e===o.e.existing?1:6}function j(e,t){var n=f.e;switch(e){case r.pastDate:return n.pastDateExpirationError;case r.adminPolicy:return a.format(n.adminExpirationError,t);case r.overMax:return a.format(n.maxExpirationError,730);case r.adminRequired:return f.e.requireExpirationError;default:return""}}function F(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function I(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function q(e,t,n){return l.a(e)||t===u.e.linkSettings&&l.l(e)&&n&&(!!n.entityName||!!n.audienceType)}function R(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n}function U(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var r,s,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=!1;if(l.i(e))return[3,4];try{t.focus();t.setSelectionRange(0,t.value.length);r=document.execCommand("copy")}catch(e){}if(r||!window.navigator||!window.navigator.clipboard)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(t.value)];case 2:i.sent();r=!0;return[3,4];case 3:i.sent();return[3,4];case 4:try{s=window.external;o=s.CopyToClipboard(n);r=o||void 0===o}catch(e){}return[2,r]}})})}},"1558":function(e,t,n){"use strict";n.d(t,"o",function(){return i});n.d(t,"s",function(){return s});n.d(t,"a",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});n.d(t,"i",function(){return f});n.d(t,"d",function(){return l});n.d(t,"v",function(){return c});n.d(t,"e",function(){return h});n.d(t,"h",function(){return p});n.d(t,"n",function(){return d});n.d(t,"f",function(){return v});n.d(t,"c",function(){return m});n.d(t,"u",function(){return g});n.d(t,"l",function(){return y});n.d(t,"m",function(){return b});n.d(t,"p",function(){return w});var r=n(2026);function i(e){return p(e)||v(e)||d(e)||m(e)||g(e)||(function(e){return e===r.e.officemobileIos||e===r.e.officemobileAndroid})(e)}function s(e){return e===r.e.odb||e===r.e.sharePoint||e===r.e.odc}function o(e){return e===r.e.outlookWeb||e===r.e.outlookWindows||e===r.e.outlookMac}function u(e){return e===r.e.odIos||e===r.e.wordIos||e===r.e.excelIos||e===r.e.visioIos||e===r.e.onenoteIos||e===r.e.powerpointIos||e===r.e.teamsIos||e===r.e.officemobileIos||e===r.e.listsIos}function a(e){return e===r.e.odAndroid||e===r.e.wordAndroid||e===r.e.excelAndroid||e===r.e.visioAndroid||e===r.e.onenoteAndroid||e===r.e.powerpointAndroid||e===r.e.teamsAndroid||e===r.e.officemobileAndroid}function f(e){return u(e)||a(e)}function l(e){return s(e)||e===r.e.onenoteWeb||e===r.e.outlookWeb||e===r.e.officecom||e===r.e.teams||e===r.e.sample||e===r.e.outlookGroupsWeb||e===r.e.fluid||e===r.e.odcWac||e===r.e.wac||e===r.e.listPart||e===r.e.listsHome||f(e)}function c(e){return s(e)||e===r.e.officecom||e===r.e.wac}function h(e){return f(e)||y(e)}function p(e){return e===r.e.word||e===r.e.wordAndroid||e===r.e.wordIos}function d(e){return e===r.e.excel||e===r.e.excelAndroid||e===r.e.excelIos}function v(e){return e===r.e.powerpoint||e===r.e.powerpointAndroid||e===r.e.powerpointIos}function m(e){return e===r.e.visio||e===r.e.visioIos||e===r.e.visioAndroid}function g(e){return e===r.e.onenote||e===r.e.onenoteWeb||e===r.e.onenoteUWP||e===r.e.onenoteIos||e===r.e.onenoteAndroid}function y(e){return e===r.e.teams||e===r.e.teamsIos||e===r.e.teamsAndroid}function b(e){return e===r.e.odc}function w(e){return e===r.e.word||e===r.e.excel||e===r.e.powerpoint||e===r.e.ngsc||e===r.e.visio}},"1562":function(e,t,n){"use strict";n.d(t,"c",function(){return o});n.d(t,"t",function(){return u});n.d(t,"l",function(){return a});n.d(t,"m",function(){return f});n.d(t,"d",function(){return l});n.d(t,"p",function(){return c});n.d(t,"S",function(){return h});n.d(t,"g",function(){return p});n.d(t,"x",function(){return d});n.d(t,"v",function(){return v});n.d(t,"T",function(){return m});n.d(t,"n",function(){return g});n.d(t,"u",function(){return y});n.d(t,"r",function(){return b});n.d(t,"k",function(){return w});n.d(t,"C",function(){return E});n.d(t,"a",function(){return S});n.d(t,"i",function(){return x});n.d(t,"b",function(){return T});n.d(t,"s",function(){return N});n.d(t,"h",function(){return C});n.d(t,"f",function(){return k});n.d(t,"e",function(){return L});n.d(t,"o",function(){return A});n.d(t,"N",function(){return O});n.d(t,"y",function(){return M});n.d(t,"E",function(){return _});n.d(t,"w",function(){return D});var r=n(71),i=n(107),s=n(55);function o(){return!r.e.isActivated("dc0d2554-cc99-4c76-a9c0-9051db7fff0e","06/01/2020","Make the share dialog fluent on Sharepoint website")}function u(){return!r.e.isActivated("4871dfa3-5de8-46d7-995c-5eaa87cbecdd","06/02/2020","Enable callback for at-mention result")&&!i.e.isFeatureEnabled({ODC:"AtMentionCallbackKillswitch"})}function a(){return!r.e.isActivated("c2c7f33a-3c0d-45b1-84e2-479261473ea9","06/10/2020","Make the share dialog header fluent compatible")}function f(){return!r.e.isActivated("8608b910-a448-49a1-a857-0650ea6516d1","07/07/2020","Lift common engagement extradata to the SharingStore")&&!i.e.isFeatureEnabled({ODC:"LiftingEngagementExtradataKillswitch"})}function l(){return!r.e.isActivated("0ff6a17f-783b-4023-9085-f93de18b7628","07/09/2020","Allow window.parent to supply a theme value")&&!i.e.isFeatureEnabled({ODC:"GetThemeFromParentKilswitch"})}function c(){return!r.e.isActivated("98d2236b-2205-4f43-bb39-25fd0278b7c7","7/2/2020","Top level error trap + QoS event for unexpected share errors")&&!i.e.isFeatureEnabled({ODC:"ShareDialogGenericErrorHandlerKillswitch"})}function h(){return!r.e.isActivated("c6f35eb5-71d8-4ac4-aa3f-b8d401cbefc9","1/7/2021","Killswitch to manage whether the sharing dialog messages the host when UI is ready after load; separate message after share_ready")&&!i.e.isFeatureEnabled({ODC:"ShareDialogUIReadyMessageKillswitch"})}function p(){return i.e.isFeatureEnabled({ODB:1617})}function d(){return!r.e.isActivated("f59e9dbd-e7d0-4b9a-a668-58a105ea2360","9/21/2020","Show links section in manage access for lists")}function v(){return!r.e.isActivated("07e5acaf-67db-4df8-9259-29bc1201b62a","8/26/2020","Do not re-render copy link screen (or re-copy deleted link) when UnshareLink completes")}function m(){return!r.e.isActivated("2a9b6ca0-76ff-4c6c-aa7c-4437d34d38f1","1/6/2020","Enable the experiment for the speicfic people string changes")}function g(){return s.n.isFeatureEnabled({ODB:1777})&&!r.e.isActivated("172754a2-483b-4ed6-be52-d2c6dd239f80","11/20/2020","Override to use the compact role selector")}function y(){return i.e.isFeatureEnabled({ODB:1977})}function b(){return!r.e.isActivated("e07ddcbc-0f59-4e0f-8b16-a72212c79398","10/12/2020","Fix audience change in copy link for existing links")}function w(){return!r.e.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility")}function E(){return!r.e.isActivated("fe046d2e-1ec8-4812-af74-7143477c628c","10/15/2020","Deactivate set meeting media file default to block download link")}function S(){return!r.e.isActivated("343af0af-0a2e-4a08-8117-7b5dcff3dca6","10/21/2020","Coalesce participant list when checking for participant to remove from link.")}function x(){return!r.e.isActivated("919172c8-2994-4220-be3e-2982627413ca","10/14/2020","Disable theme loading for WAC until a solution is figured out")}function T(){return i.e.isFeatureEnabled({ODC:"OptimizeSharingStoreApiCallsKillswitch"})}function N(){return!r.e.isActivated("919172c8-2994-4220-be3e-2982627413ca","11/12/2020","enable Message length check (<500) for grant access dialog")}function C(){return!r.e.isActivated("ad625bf7-8de3-4d5d-b71b-48fcf7143956","12/01/2020","Forse use unique id (if available) when creating default link")}function k(){return i.e.isFeatureEnabled({ECS:71061})}function L(){return!r.e.isActivated("42724868-f9df-4881-83d0-a065c53a3c59","02/10/2021","add link settings to sharing dialog compact role selector")}function A(){return!r.e.isActivated("cb8b0084-e0df-406c-93c8-3d9552380b84","02/18/2021","Enforcing SPO Search.")}function O(){return!i.e.isFeatureEnabled({ECS:77463})}function M(){return!r.e.isActivated("87fa1b2c-3cf4-4dac-b27a-504775e5d635","03/25/2021","Hide compact role selector when sharing role is not mapped")}function _(){return!r.e.isActivated("5d091681-66bf-48dd-a4c8-e1a95ab89066","3/30/2021","check and sanitize iframe post message")&&!i.e.isFeatureEnabled({ODC:"SanitizeIframePostMessageKillswitch"})&&!i.e.isFeatureEnabled({ECS:73634})}function D(){return!r.e.isActivated("f0217676-afef-454a-bec4-6b1960a92e68","04/13/2021","Error message for people picker in external sharing")}},"1570":function(e,t,n){"use strict";n.d(t,"i",function(){return f});n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"s",function(){return d});var r=n(20),i=n("react-lib"),s=n(1544),o=n(1553),u=n(1640),a=n(1562);function f(e){return!!e&&!!e.rawPersonData&&!!e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType}function l(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0}function c(e){return e&&0!==e.length?e.filter(function(e){return 4===e.entityType}).length:0}function h(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i)+" "+o.e.and+" "+s.substring(i+1)+" "+o.e.outsideOfYourOrgPlural}if(n>2){var s;i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i+1)+" "+o.e.and+" "+s.substring(i+1)+" "+o.e.outsideOfYourOrgPlural}return 1===n?r[0]+" "+o.e.outsideOfYourOrgSingular:""}function p(e,t){var n=e.filter(function(e){return 2===e.entityType}).length,i="";1===n?i=o.e.oneGroupInvited:n>1&&(i=r.format(o.e.multipleGroupsInvited,n));t>=1e3?i+=" "+o.e.groupsMemberCountLargeLabel:t>=25&&(i+=" "+r.format(o.e.groupsMemberCountLabel,t));return i}function d(e){for(var t,n=e.selectedItems,r=e.sharingLinkKind,f=e.canAddExternalPrincipal,l=e.sharingInformation,c=e.viewPolicyTipCallback,h=e.permissionsMap,p=i.createElement("div",null,i.createElement("span",null,o.e.ptErrorMessage," "),i.createElement(s.e,{onClick:c},o.e.ptViewPolicyTipLabel)),d=l.item.hasDlpPolicy||l.sharingAbilities&&l.sharingAbilities.directSharingAbilities&&7===l.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,m=0,g=n;m<g.length;m++){var y=g[m];if(!y.isResolved)return d&&!f?p:y.rawData?v(y.rawData,l.customizedExternalSharingServiceUrl):i.createElement("span",null,o.e.noExactMatch);if(y.isExternal&&d&&!f)return p;if(Object(a.w)()&&!f&&((t=y)&&t.isExternal&&t.rawPersonData&&t.rawPersonData.EntityData&&"GUEST_USER"===t.rawPersonData.EntityData.PrincipalType))return i.createElement("span",null,o.e.peoplePickerErrorExternal);if(y.isExternal&&y.principalType===u.e.distributionList&&2===y.entityType)return i.createElement("span",null,o.e.peoplePickerErrorDLNotSupported);var b=3===r||2===r;if(y.isExternal&&b)return i.createElement("span",null,o.e.peoplePickerErrorCsl)}if(h&&1===r){var w=0;for(var E in h)1===h[E]&&w++;var S="";1===w?S=o.e.insufficientPermissionsError:w>1&&(S=o.e.insufficientPermissionsErrorPlural);var x=e.onShareHintClick?i.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:e.onShareHintClick,href:"javascript:void(0)"},o.e.changeLinkType):void 0;if(S)return i.createElement("div",null,i.createElement("span",null,S),x)}return l.peoplePickerError?i.createElement("span",null,l.peoplePickerError):null}function v(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n?i.createElement("span",null,e.Description):n>=401&&n<=404?t?i.createElement("div",null,r.formatToArray(o.e.externalSharingAllowDenyListWithLink,n,i.createElement("a",{href:t,target:"_blank"},o.e.noExternalSharingLearnMoreHere))):i.createElement("span",null,r.format(o.e.externalSharingAllowDenyList,n)):n>=200&&n<=209||n>=301&&n<=305?t?i.createElement("div",null,r.formatToArray(o.e.externalSharingDisabledWithLink,n,i.createElement("a",{href:t,target:"_blank"},o.e.noExternalSharingLearnMoreHere))):i.createElement("span",null,r.format(o.e.externalSharingDisabled,n)):void 0}},"1571":function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}},"1574":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0};this._resizeCallback=e;this._callbackDelayMilliseconds=20}e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)};e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback());this._cachedRect=n}};return e})()},"1576":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-bottom-width:1px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}[dir='ltr'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:48px}[dir='rtl'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:48px}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:17px;font-weight:700}[dir='ltr'] .od-ShareHeader-linkSettings{margin-left:20px}[dir='rtl'] .od-ShareHeader-linkSettings{margin-right:20px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-left{padding-left:8px}[dir='rtl'] .od-ShareHeader-buttons-left{padding-right:8px}[dir='ltr'] .od-ShareHeader-buttons-left{left:0}[dir='rtl'] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right{right:0}[dir='rtl'] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-moreOptionsIcon{font-size:16px}.od-ShareHeader-closeButtonIcon{font-size:16px}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:none;border:none;padding:0px;width:30px;cursor:pointer;font:-apple-system-body}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{border-color:ActiveBorder}}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:16px}.od-ShareHeader-title{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.isFluent .od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline;margin:0px 32px 0px 32px}[dir='rtl'] .od-ShareHeader-viewName{margin:0px 32px 0px 32px}.isFluent .od-ShareHeader-viewName{margin:0px 32px 0px 0px;font-size:20px;font-weight:600;margin-bottom:4px}[dir='rtl'] .isFluent .od-ShareHeader-viewName{margin:0px 0px 0px 32px}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}.isFluent .od-ShareHeader-itemName{text-align:initial;font-size:12px}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}}\n"}]);var s=n(1387),o=n(1326),u=n(4241),a=n("react-lib"),f=n("prop-types-lib"),l=n(20),c=n(1558),h=n(1556),p=n(1553),d=n(115),v=n(1578),m=n(1562);n.d(t,"e",function(){return g});var g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButtonRef=Object(a.createRef)();r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={showContextualMenu:!1,target:null};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._store=n.sharingStore;r._onDismissMoreContextualMenu=r._onDismissMoreContextualMenu.bind(r);r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);r._onMoreClick=r._onMoreClick.bind(r);return r}t.prototype.render=function(){var e=this.props;if(e.mode===u.e.linkSettings)return a.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName(),a.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderCloseButton()));var t=4===e.viewState||7===e.viewState||9===e.viewState,n=c.i(this.props.clientId)||this._platformDetection.isMobile,r=t?"":" od-ShareHeader-backgroundColor",i=m.l()&&this.props.hasBackButton?" od-ShareHeader-withBackButton":"",s=t?"":a.createElement("div",{className:"od-ShareHeader"+r+i},a.createElement("div",{className:"od-ShareHeader-title"},a.createElement("h1",{className:"od-ShareHeader-viewName"},this.props.title||this._getViewName()),this._renderItemName())),o=!m.g()&&n,f=o?a.createElement("div",{className:"od-ShareHeader-buttons-left od-ShareHeader-buttons-fabric"},this._renderCloseButton()):"";return a.createElement("div",null,f,s,this._renderRightHeaderButtons(o,t,e.viewState),this._renderContextualMenu())};t.prototype._renderMoreButton=function(){if(!(0!==this.props.viewState&&10!==this.props.viewState||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.e.manageExistingAccessLabel,ariaLabel:p.e.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick}]},t=a.createElement(s.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.e.moreOptionsLabel,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:v.t(t,p.e.moreOptionsLabel,{position:d.e.bottomRightEdge})}};t.prototype._renderCloseButton=function(){var e,t,n,r=null!=(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)?n:c.d(this.props.clientId);if(this._onDismiss&&r&&3!==this.props.viewState){var i=a.createElement(s.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.e.closeButtonLabel,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?i:v.t(i,p.e.closeButtonLabel,{position:d.e.bottomRightEdge})}};t.prototype._renderRightHeaderButtons=function(e,t,n){var r="od-ShareHeader-buttons-right od-ShareHeader-buttons-fabric";return e&&!t&&0===n?a.createElement("div",{className:r},this._renderMoreButton()):e&&(t||0!==n)?"":a.createElement("div",{className:r},this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(){var e=this.props.item;if(e){var t=e.childCount>1?" ("+l.format(p.e.folderHeader,e.childCount)+")":"";return a.createElement("div",{className:"od-ShareHeader-itemName"},h.k(e.name+" "+t))}};t.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:p.e.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return a.createElement(o.e,{ariaLabel:p.e.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};t.prototype._onDismissMoreContextualMenu=function(){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showContextualMenu:!1}))};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()};t.prototype._getViewName=function(){var e=p.e;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 12:return e.modifylinksFromTemplateHeader;case 3:return e.manageExistingAccessLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;case 10:return e.addPeopleLabel;default:return e.shareLinkHeader}};t.prototype.focusCloseButton=function(){if(this._closeButtonRef.current){this._closeButtonRef.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:f.func,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired};return t})(a.Component)},"1578":function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(1410),s=n(115),o=n("react-lib"),u={gapSpace:0},a={maxWidth:"300px"},f=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-"+f;f++;var c=n.targetElementId?Object(r.__assign)(Object(r.__assign)({},u),{target:"#"+n.targetElementId}):u;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?s.e.topCenter:n.position,calloutProps:c,tooltipProps:a},e)}function c(e,t,n,r){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!r,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},"1581":function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"d",function(){return p});n.d(t,"v",function(){return d});n.d(t,"i",function(){return v});n.d(t,"e",function(){return m});n.d(t,"f",function(){return g});n.d(t,"a",function(){return y});n.d(t,"l",function(){return w});n.d(t,"m",function(){return E});n.d(t,"h",function(){return S});n.d(t,"p",function(){return x});n.d(t,"c",function(){return T});n.d(t,"u",function(){return N});n.d(t,"o",function(){return C});n.d(t,"r",function(){return k});n.d(t,"s",function(){return L});n(0);var r=n(2026),i=n(4241),s=n(3927),o=n(74),u=n(31),a=n(1556),f=(n(54),n(1562)),l=!1;function c(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function h(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function p(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function d(e,t,n){var r=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,r,n)}catch(i){var s={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:r,body:n};window.parent.postMessage(JSON.stringify(s),"*")}}function v(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function m(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(r){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function g(e,t,n,s,a,f){if(l)(function(e,t,n,s,a,f){var l=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".AfterPageLoad",startTimeOverride:e||void 0}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:l,scenario:s,isError:!!a,correlationId:f,error:a}})})(e,t,n,s,a.errorMessage||"unknown error",f);else{b(e,t,n,s,a.errorMessage||"unknown error",f);l=!0}try{window.external.PageError(a.error,a.errorCategory,a.errorMessage,a.debugErrorMessage)}catch(e){var c={name:"share_error",error:a.error,errorCategory:a.errorCategory,errorMessage:a.errorMessage,debugErrorMessage:a.debugErrorMessage};window.parent.postMessage(JSON.stringify(c),"*")}}function y(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function b(e,t,n,s,a,l){if(e){var c=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".PageLoaded",startTimeOverride:e}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:c,scenario:s,isError:!!a,correlationId:l,error:f.p()?a:void 0}})}}function w(e,t,n,r,i){if(!l){b(e,t,n,r,void 0,i);try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*")}l=!0}}function E(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function S(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function x(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function T(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function N(e,t,n,r){var i,o=Object(a.p)(r,e,n),u=Object(a.v)(e,t,r,n),f=Object(a.w)(e.sharingLinkKind),l=Object(a.E)(e.status),c=e.audience===s.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,h=!1;try{window.external.LinkSettingsCompleted(c,e.url,o,u,f);h=!0}catch(e){}var p={id:c,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:f,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople,status:l,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(p));h=!0}catch(e){}if(!h){var d={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:c,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:f,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(d),"*");window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:p}),"*")}}function C(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function k(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function L(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}},"1598":function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"r",function(){return h});n.d(t,"s",function(){return p});n.d(t,"i",function(){return d});n.d(t,"o",function(){return v});n.d(t,"n",function(){return m});var r=n(3927),i=n(107),s=n(1599),o=n(516),u=n(1562),a={ODB:772},f={ODB:1935};function l(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?r.e.anyone:"organizationLinkAbilities"===e?r.e.organization:"peopleSharingLinkAbilities"===e?r.e.specificPeopleFlex:void 0}function c(e,t){return e===r.e.anyone?u.k()&&t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===r.e.organization?t.organizationLinkAbilities:e===r.e.specificPeopleFlex||e===r.e.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function h(e,t){var n,r,i=c(e,t);return(null===(n=i)||void 0===n?void 0:n.canManageEditLink)?i.canManageEditLink.enabled:!!(null===(r=i)||void 0===r?void 0:r.canAddInternalPrincipal)&&i.canAddInternalPrincipal.enabled}function p(e,t,n){if(i.e.isFeatureEnabled(a)&&!s.t[n]){var r=c(e,t);return r.canManageReviewLink?r.canManageReviewLink.enabled:!!r.supportsReviewPermission&&r.supportsReviewPermission.enabled}return!1}function d(e,t,n){if(s.u===s.t[n]){var r=c(e,t);return r.canManageReviewLink?r.canManageReviewLink.enabled:!!r.supportsReviewPermission&&r.supportsReviewPermission.enabled}return!1}function v(e,t){var n=c(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}function m(e,t){var n=[],r=new o.t({name:"RedeemedUserShareUI",startDate:"05/05/2020",version:o.e.v2});if(i.e.isFeatureEnabled(f)&&r.IsExperimentOn())for(var s=0,u=t;s<u.length;s++){var a=u[s];if(a.linkDetails&&a.linkDetails.shareId){var l=c(a.linkDetails.audience,e);if(!(!!l.canManageEditLink&&l.canManageEditLink.enabled||!!l.canManageReviewLink&&l.canManageReviewLink.enabled||!!l.canManageReadLink&&l.canManageReadLink.enabled)){!!(a.linkDetails.expiration&&a.linkDetails.expiration<new Date(Date.now()))||n.push(a.linkDetails)}}}return n}},"1600":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.folder=2]="folder";e[e.item=3]="item";e[e.list=4]="list";e[e.web=5]="web";e[e.max=6]="max"})(r||(r={}))},"1602":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}\n"}]);var s=n("react-lib"),o=n(1396),u=n(352);n.d(t,"e",function(){return a});var a=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},s.createElement("div",null,s.createElement(o.e,{type:u.t.large})),s.createElement("span",{role:"alert"},this.props.message))};return t})(s.Component)},"1612":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(4154),o=n(600),u=n(4269),a=n(1556),f=n(1553),l=n(20),c=n(150);Object(c.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelectorLarge-wrapper{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.od-RoleSelectorLarge-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir='ltr'] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{right:0}[dir='rtl'] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{left:0}.od-RoleSelectorLarge-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0;height:auto}[dir='ltr'] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir='rtl'] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelectorLarge-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:0px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir='ltr'] .isFluent .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown:focus::after{border:none;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:0px}.od-RoleSelectorLarge-rolesDropdown:hover,.od-RoleSelectorLarge-rolesDropdown.is-open{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelectorLarge-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir='rtl'] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelectorLarge-roleDropdownOption{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:8px 0px}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-weight:600}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{font-size:12px;line-height:1.3}[dir='ltr'] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:left}[dir='rtl'] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:right}.od-RoleSelectorLarge-settingIcon{font-size:17px}[dir='ltr'] .od-RoleSelectorLarge-settingIcon{padding-left:8px}[dir='rtl'] .od-RoleSelectorLarge-settingIcon{padding-right:8px}[dir='ltr'] .od-RoleSelectorLarge-settingIcon{padding-right:12px}[dir='rtl'] .od-RoleSelectorLarge-settingIcon{padding-left:12px}.isFluent .od-RoleSelectorLarge-settingIcon{font-size:16px}[dir='ltr'] .isFluent .od-RoleSelectorLarge-settingIcon{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelectorLarge-settingIcon{padding-right:0}\n"}]);var h=n(135),p=n(1410),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onRenderTitle=function(e){var t=Object(a.g)(e[0].key);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement(o.e,{iconName:t.name,"aria-hidden":"true",title:t.name,className:"od-RoleSelectorLarge-settingIcon"}),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e[0].text," "))};r._onRenderOption=function(e){var t=Object(a.g)(e.key);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOption"},i.createElement(p.e,{content:t.title,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(o.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:t.name})),i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e.text," "),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionSubtext"},e.data)))};r._onAllowRoleChange=function(e,t){r.props.onRoleChange(t.key)};return r}t.prototype.render=function(){var e=this.props,n=Object(a.g)(e.sharingRole),r=e.sharingRole;r!==u.e.review||this.props.showReview||(r=u.e.edit);r!==u.e.owner||e.showFullControl||(r=u.e.edit);var f=[];e.showFullControl&&f.push(this.props.isListSharing?t._fullControlDropdownOptionForLists:t._fullControlDropdownOption);f.push(this.props.isListSharing?t._editDropDownOptionForLists:t._editDropDownOption);this.props.showReview&&f.push(t._reviewDropdownOption);f.push(this.props.isListSharing?t._viewDropdownOptionForLists:t._viewDropdownOption);return i.createElement("div",{className:"od-RoleSelectorLarge-wrapper"},i.createElement(p.e,{content:n.title,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(o.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:n.name})),i.createElement(s.e,{className:"od-RoleSelectorLarge-rolesDropdown",disabled:this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChange:this._onAllowRoleChange,defaultSelectedKey:r,calloutProps:{className:"od-RoleSelectorLarge-rolesDropdownOptionsCallout"},responsiveMode:h.ResponsiveMode.large,options:f,ariaLabel:this.props.ariaLabel}),this.props.children)};t._editDropDownOption={key:u.e.edit,text:f.e.canEditRole,data:f.e.canEditRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canEditRole,f.e.canEditRoleSubText),title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canEditRole,f.e.canEditRoleSubText)};t._editDropDownOptionForLists=Object(r.__assign)(Object(r.__assign)({},t._editDropDownOption),{data:f.e.canEditRoleSubTextForLists,title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canEditRole,f.e.canEditRoleSubTextForLists)});t._reviewDropdownOption={key:u.e.review,text:f.e.canReviewRole,data:f.e.canReviewRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canReviewRole,f.e.canReviewRoleSubText),title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canReviewRole,f.e.canReviewRoleSubText)};t._viewDropdownOption={key:u.e.view,text:f.e.canViewRole,data:f.e.canViewRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canViewRole,f.e.canViewRoleSubText),title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canViewRole,f.e.canViewRoleSubText)};t._viewDropdownOptionForLists=Object(r.__assign)(Object(r.__assign)({},t._viewDropdownOption),{data:f.e.canViewRoleSubTextForLists,title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canViewRole,f.e.canViewRoleSubTextForLists)});t._fullControlDropdownOption={key:u.e.owner,text:f.e.fullControlRole,data:f.e.fullControlRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.fullControlRole,f.e.fullControlRoleSubText),title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.fullControlRole,f.e.fullControlRoleSubText)};t._fullControlDropdownOptionForLists=Object(r.__assign)(Object(r.__assign)({},t._fullControlDropdownOption),{data:f.e.fullControlRoleSubTextForLists,title:l.format(f.e.roleSelectorOptionAriaLabel,f.e.fullControlRole,f.e.fullControlRoleSubTextForLists)});return t})(i.Component),v=n(243),m=n(115),g=n(1387);Object(c.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir='ltr'] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir='rtl'] .od-RoleSelectorCompact-permissionButton{margin-right:8px}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin:8px}[dir='ltr'] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir='rtl'] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:disabled{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}\n"}]);var y,b=n("prop-types-lib"),w=n(1578),E=n(1562);(function(e){e.edit="edit";e.view="view";e.review="comment";e.fullControl="full-control";e.divider="divider";e.stopSharing="stop-sharing";e.linkSettings="linkSettings"})(y||(y={}));var S=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._linkSettingsClickedInRoleSelector=function(){r.context.sharingStore.getEngagementHelper().log("RoleSelectorCompact.LinkSettingsClicked",{clientId:r.props.clientId,scenarioId:"",mode:r.props.mode});r.props.onLinkSettingsClicked()};r._onItemClicked=function(e,t){var n;r.props.sharingRole;switch(t.key){case y.fullControl:n=u.e.owner;break;case y.edit:n=u.e.edit;break;case y.view:n=u.e.view;break;case y.review:n=u.e.review;break;default:n=u.e.none}r._selectedRole!==n&&r.props.onRoleChange(n)};r._selectedRole=r._parseRole(t.sharingRole,t.showReview,t.showFullControl);return r}t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole,this.props.showReview,this.props.showFullControl);var n,r=this._getMenuItems(this.props.showFullControl,this.props.showReview,this.props.showStopSharing,this.props.isListSharing,this.props.showLinkSettings),s=r.filter(function(e){return e.itemType!==v.e.Divider}).length;if(E.y())switch(this.props.sharingRole){case u.e.owner:n=f.e.fullControlRole;break;case u.e.edit:n=f.e.canEditRole;break;case u.e.review:n=f.e.canReviewRole;break;case u.e.view:n=f.e.canViewRole;break;case u.e.none:n="";break;default:return null}else switch(this.props.sharingRole){case u.e.owner:n=f.e.fullControlRole;break;case u.e.edit:n=f.e.canEditRole;break;case u.e.review:n=f.e.canReviewRole;break;case u.e.view:n=f.e.canViewRole;break;default:n=""}var o={directionalHint:m.e.bottomRightEdge,shouldFocusOnMount:!0,items:r,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){return e._logRoleSelectorClicked(e.context.sharingStore)},styles:t.menuItemStyles};return this.props.shimmer?i.createElement(g.e,{menuIconProps:{iconName:"ChevronDown",style:{fontSize:"16"}},iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:o,disabled:!0}):w.t(i.createElement(g.e,{menuIconProps:{iconName:"ChevronDown",style:{fontSize:"16"}},iconProps:this.getRoleIconName(this.props.sharingRole),className:"od-RoleSelectorCompact-permissionButton",menuProps:o,disabled:this.props.disabled,ariaLabel:l.format(f.e.linkPermissionsAriaLabel,this.props.ariaLabel,n,s)}),n,{position:m.e.bottomRightEdge})};t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))};t.prototype._parseRole=function(e,t,n){return e===u.e.review&&!1===t?u.e.edit:e!==u.e.owner||n?e===u.e.restrictedview?u.e.view:e:u.e.edit};t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{onRenderContent:t._renderContent})})};t.prototype._getMenuItems=function(e,t,n,r,i){var s=[],o={key:y.edit,text:f.e.canEditRole,secondaryText:r?f.e.canEditRoleSubTextForLists:f.e.canEditRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canEditRole,r?f.e.canEditRoleSubTextForLists:f.e.canEditRoleSubText),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"}},u={key:y.view,text:f.e.canViewRole,secondaryText:r?f.e.canViewRoleSubTextForLists:f.e.canViewRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canViewRole,r?f.e.canViewRoleSubTextForLists:f.e.canViewRoleSubText),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Uneditable2"}},a={key:y.fullControl,text:f.e.fullControlRole,secondaryText:r?f.e.fullControlRoleSubTextForLists:f.e.fullControlRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canEditRole,r?f.e.fullControlRoleSubTextForLists:f.e.fullControlRoleSubText),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"}},c={key:y.review,text:f.e.canReviewRole,secondaryText:f.e.canReviewRoleSubText,ariaLabel:l.format(f.e.roleSelectorOptionAriaLabel,f.e.canReviewRole,f.e.canReviewRoleSubText),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"}},h={key:y.divider,itemType:v.e.Divider},p={key:y.stopSharing,text:f.e.stopSharing,ariaLabel:f.e.stopSharing,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing"},d={key:"linkSettings",text:f.e.modifyPermissionsHeader,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:f.e.modifyPermissionsHeader};e&&s.push(a);s.push(o);t&&s.push(c);s.push(u);n&&s.push(h,p);i&&s.push(h,d);return this._addRenderContent(s)};t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().log("RoleSelectorCompact.Clicked",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})};t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e,this.props.showReview,this.props.showFullControl)){case u.e.owner:t="Signin";break;case u.e.edit:t="Edit";break;case u.e.view:t="Uneditable2";break;case u.e.review:t="Feedback";break;case u.e.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}};t.contextTypes={sharingStore:b.object.isRequired};t.menuItemStyles={subComponentStyles:{menuItem:{root:{height:"52px !important"},label:{margin:"0",fontSize:"14px",fontWeight:"600",lineHeight:"20px"},secondaryText:{paddingLeft:"0",fontSize:"12px",lineHeight:"16px"}}}};return t})(i.Component);n.d(t,"e",function(){return x});var x=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){return this.props.compact?i.createElement(S,Object(r.__assign)({},this.props)):i.createElement(d,Object(r.__assign)({},this.props))};return t})(i.Component)},"1613":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(150);Object(s.n)([{rawString:".od-Share-LivePeoplePicker{max-height:150px;min-height:32px;overflow-y:auto}.od-Share-LivePeoplePicker-lpp{display:grid;display:-ms-grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;row-gap:0;-ms-grid-columns:1fr auto;-ms-grid-rows:auto auto;-ms-row-gap:0}.od-Share-LivePeoplePicker-Adapter{grid-row:1;grid-column:1;-ms-grid-row:1;-ms-grid-column:1}.od-Share-LivePeoplePicker-RoleSelector{grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-flex-item-align:end;align-self:end;-ms-grid-row-align:end}.od-Share-LivePeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}\n"}]);var o,u,a=n(1640),f=n(1932),l=n(1546),c=n("prop-types-lib"),h=!1,p=i.forwardRef(function(e,t){var r=Object(i.useState)(null),s=r[0],o=r[1];Object(i.useEffect)(function(){s||n.e("487").then(n.t.bind(null,4361,7)).then(function(t){if(!h){t.initializeLivePersonaPicker(e.userPrincipalName,e.options);h=!0}o({LivePersonaPicker:t.getLivePersonaPickerWithRichTextInput(e.userPrincipalName),PersonaPillList:t.PersonaPillList})})},[s]);var u=Object(i.useState)(null),a=u[0],f=u[1],l=Object(i.useState)(!1),c=l[0],p=l[1];Object(i.useEffect)(function(){if(c&&a){a.focus();p(!1)}},[a,c]);Object(i.useImperativeHandle)(t,function(){return{focus:function(){p(!0)},getCurrentText:function(){return a.getCurrentText()}}});if(!s)return e.fallback||null;var d=s.LivePersonaPicker,v=s.PersonaPillList;return i.createElement("div",{className:e.className},i.createElement(v,{personaItems:e.selectedPersonas,onRemoveItem:e.onRemovePersona}),e.entryDisabled||i.createElement(d,{componentRef:function(e){f(e)},strings:e.strings,maxHeight:200,maxWidth:300,onSuggestionSelected:e.onSuggestionSelected,selectedSuggestions:e.selectedPersonas}))}),d=n(1396),v=n(352),m=n(1558),g=n(1553),y=n(1574),b=n(1612);(function(e){e.Person="Person";e.Group="Group"})(o||(o={}));(function(e){e.OrganizationUser="OrganizationUser";e.LinkedIn="LinkedIn";e.UnifiedGroup="UnifiedGroup";e.PublicDistributionList="PublicDistributionList"})(u||(u={}));var w=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t)||this;s._lppAdapterRef=Object(i.createRef)();s._wrapperDivRef=Object(i.createRef)();s._getHostAppSuggestions=function(e){return Object(r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this.props.pickerSettings;n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.sharePointSearch(e,n)];case 1:i=r.sent();return[2,i.map(function(e){return{Id:e.userId,Name:e.name,UserPrincipalName:e.rawPersonData.userPrincipalName||e.email,SuggestionType:e.name,SuggestionSubtype:e.name,EmailAddresses:[e.email||""],HostAppSuggestion:e}})]}})})};s._onSelectedPersonasChanged=function(){var e=s.state.selectedPersonas.map(function(e){return s._personaPillListItemToIPerson(e)});s.props.onChange(e)};s._onRemovePersona=function(e){s.setState(function(t,n){var i=s.state.selectedPersonas.filter(function(t){return t.Id!==e.Id});return Object(r.__assign)(Object(r.__assign)({},t),{selectedPersonas:i})},s._onSelectedPersonasChanged)};s._onSuggestionSelected=function(e){var t=Object(r.__assign)(Object(r.__assign)({},e),{validationState:"Pending"});s.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{selectedPersonas:Object(r.__spreadArrays)(e.selectedPersonas,[t])})});s._validateSuggestion(e).then(function(e){return s._onPersonaValidated(e)})};s._onKeyDown=function(e){"Backspace"===e.key&&s._lppAdapterRef.current&&""===s._lppAdapterRef.current.getCurrentText()&&s.setState(function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{selectedPersonas:e.selectedPersonas.slice(0,-1)})},s._onSelectedPersonasChanged)};s._validateSuggestion=function(e){return Object(r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(e.SuggestionSubtype===u.OrganizationUser)return[2,Object(r.__assign)(Object(r.__assign)({},e),{validationState:"Valid"})];t=this.props.pickerSettings;n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.resolve(e.UserPrincipalName,n).then(function(e){!e.email&&e.rawData&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);!e.name&&e.rawData&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})];case 1:i=s.sent();e.HostAppSuggestion=i;return[2,Object(r.__assign)(Object(r.__assign)({},e),{validationState:this._shouldShowErrorOnItem(i)?"Error":"Valid"})]}})})};s._peoplePickerProvider=n.peoplePickerProvider;s._resize=n.resize;s._platformDetection=n.platformDetection;s._hasTakenErrorFocus=!1;s._peoplePickerProvider=n.peoplePickerProvider;var a=t.defaultSelectedItems.map(function(e){return{Id:e.email,Name:e.name,UserPrincipalName:e.principalName,EmailAddresses:[e.email],SuggestionType:o.Person,SuggestionSubtype:u.OrganizationUser,HostAppSuggestion:e,Source:"HostApp",validationState:"Valid",SuggestionSource:"HostApp",SuggestionOrigin:"ZeroTerm"}});s.state={selectedPersonas:a};s._livePeoplePickerHelper=s._peoplePickerProvider._dataSource.getLivePersonaPickerHelper();s._resizeTracker=new y.e(n.resize);return s}t.prototype.render=function(){var e={emptyResults:g.e.noResultsLabel,loading:g.e.loadingLabel,error:g.e.LPPPeoplePickerSearchError,allResults:g.e.LPPAllResultsPeoplePicker,limitedResults:g.e.LPPLimitedResultsPeoplePicker,suggestionsCalloutAccessibilityOnShow:g.e.fabricPickerSuggestionsAvailable,useThisAddress:g.e.LPPUseThisAddress,pickerModePlaceholderText:this._computePlaceholderText()};if(!(this.props.pickerSettings&&0!==Object.keys(this.props.pickerSettings).length))return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp"});var t=Object(r.__assign)(Object(r.__assign)({},this._livePeoplePickerHelper.getLppOptions()),{getHostAppSuggestions:this._getHostAppSuggestions}),n=this._livePeoplePickerHelper.getUserPrincipalName();return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp",ref:this._wrapperDivRef,onKeyDown:this._onKeyDown},i.createElement(p,{className:"od-Share-LivePeoplePicker-Adapter",ref:this._lppAdapterRef,userPrincipalName:n,options:t,strings:e,entryDisabled:!1,selectedPersonas:this.state.selectedPersonas,onSuggestionSelected:this._onSuggestionSelected,onRemovePersona:this._onRemovePersona,fallback:i.createElement(d.e,{size:v.e.small})}),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-LivePeoplePicker-RoleSelector"},i.createElement(b.e,Object(r.__assign)({},this.props.roleSelectorProps))),i.createElement("div",{className:"od-Share-LivePeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isValidateInProgress()){if(!m.i(this.props.clientId)&&!this._hasTakenErrorFocus){this._focusInput();this._hasTakenErrorFocus=!0}return i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){this.state.selectedPersonas.length>=this.props.selectionLimit&&n.push(i.createElement(l.e,{key:"peoplePickerLimitMessage",ariaLabel:g.e.peoplePickerLimitMessage},g.e.peoplePickerLimitMessage));e&&n.push(i.createElement(l.e,{key:"oversharingExternalsWarning",ariaLabel:e},e));t&&n.push(i.createElement(l.e,{key:"oversharingGroupsWarning",ariaLabel:t},t));return n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype.componentDidUpdate=function(e,t){this._resizeTracker?this._resizeTracker.checkSizeChangeForRef(this._wrapperDivRef):null!==this.props.error&&null===e.error&&this._resize();var n=t.selectedPersonas.length>=this.props.selectionLimit&&this.state.selectedPersonas.length<this.props.selectionLimit;this._hasInitialFocus&&!n||this._focusInput()};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;m.i(this.props.clientId)||e||this._focusInput()};t.prototype._focusInput=function(){if(this._lppAdapterRef.current){this._lppAdapterRef.current.focus();this._hasInitialFocus=!0}};t.prototype._shouldShowErrorOnItem=function(e){var t=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal),n=this.props.permissionsMap;return e.isExternal&&!t||1===this.props.sharingLinkKind&&n&&(1===n[e.email]||1===n[e.userId])||!e.isResolved&&!e.isResolving};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._onPersonaValidated=function(e){this.setState(function(t,n){var i=t.selectedPersonas.filter(function(t){return t.Id!==e.Id});i.push(e);return Object(r.__assign)(Object(r.__assign)({},t),{selectedPersonas:i})},this._onSelectedPersonasChanged)};t.prototype._convertPrincipalType=function(e){if(!e)return a.e.none;for(var t=a.e.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=a.e.user);"DL"===i&&(t|=a.e.distributionList);"SecGroup"===i&&(t|=a.e.securityGroup);"SPGroup"===i&&(t|=a.e.sharePointGroup)}return t};t.prototype._lppSuggestionToIPerson=function(e){if(e.HostAppSuggestion&&e.HostAppSuggestion.hasOwnProperty("userId"))return e.HostAppSuggestion;var t=e.EmailAddresses[0],n=e.UserPrincipalName&&f.e.isValidEmailSyntax(e.UserPrincipalName,!1)?e.UserPrincipalName:t,r={Key:n,IsResolved:!1},i=e.SuggestionSubtype===u.OrganizationUser,s=e.SuggestionSubtype===u.LinkedIn,l=e.SuggestionType===o.Group&&e.SuggestionSubtype===u.UnifiedGroup,c=e.SuggestionSubtype===u.PublicDistributionList,h={rawData:r,rawPersonData:r,userId:n,name:e.Name,email:t,isExternal:!i,isResolved:!0};if(i){h.entityType=0;h.principalType=a.e.user}else if(l){h.entityType=2;h.principalType=a.e.securityGroup}else if(s)h.entityType=4;else{h.principalType=c?a.e.distributionList:a.e.none;h.entityType=e.SuggestionType===o.Group?2:1;h.providerName=void 0}return h};t.prototype._personaPillListItemToIPerson=function(e){return Object(r.__assign)(Object(r.__assign)({},this._lppSuggestionToIPerson(e)),{isResolved:"Pending"!==e.validationState})};t.prototype._isValidateInProgress=function(){for(var e=0,t=this.state.selectedPersonas;e<t.length;e++){if("Pending"===t[e].validationState)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?g.e.peoplePickerPlaceholder:g.e.peoplePickerPlaceholderWithSelection};t.contextTypes={peoplePickerProvider:c.object.isRequired,resize:c.func.isRequired,platformDetection:c.object.isRequired};return t})(i.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PeoplePicker-wrapper{display:grid;display:-ms-grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;row-gap:0;-ms-grid-columns:1fr auto;-ms-grid-rows:auto auto;-ms-row-gap:0;max-height:150px;overflow-y:auto}.od-Share-PeoplePicker-wrapper#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}.od-Share-PeoplePicker-RoleSelector{grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-flex-item-align:end;align-self:end;-ms-grid-row-align:end}.od-Share-PeoplePicker{grid-row:1;grid-column:1;-ms-grid-row:1;-ms-grid-column:1}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0px;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:13px;font-weight:400;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir='rtl'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-top:3px}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-error{font-size:12px;font-weight:400;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir='ltr'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir='rtl'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;-webkit-box-sizing:border-box;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir='rtl'] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", 0.06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast: active){.ms-Button.is-suggested .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast: active){.ms-Button:hover .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast: active){.ms-Suggestions-item:hover,.ms-PeoplePicker-personaContent:hover,.ms-PeoplePicker-pickerPersona:hover,.ms-Button-flexContainer:hover{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:12px;color:highlighttext;forced-color-adjust:none}.ms-Persona-secondaryText,.ms-PeoplePicker-personaContent,.ms-PeoplePicker-pickerPersona,.ms-Button-flexContainer{color:inherit}}\n"}]);var E,S=n(835),x=n(2964),T=n(1879),N=n(4241),C=n(20),k=n(1581),L=n(77),A=n(2175),O=n(1819),M=n(600),_=n(107),D=n(71),P=n(1570),H=n(1578);(function(e){e[e.None=0]="None";e[e.Family=1]="Family";e[e.FamilyMember=2]="FamilyMember"})(E||(E={}));var B=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t)||this;s._onItemsChange=function(e){var t=s.state.selectedItems.concat(e);s.setState({selectedItems:t},function(){s.props.onChange(t)});e.forEach(function(e){s._onAutoResolve(e)})};s._onInputChange=function(e){s._hasTakenErrorFocus=!1;if(e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);t&&t[0]&&(e=t[0].substring(1,t[0].length-1));if(e=e.trim())return s._createGenericPerson(e)}).filter(function(e){return e});s._onItemsChange(t);s.props.onInputChange&&s.props.onInputChange("");return""}var n=/['"].*['"]/g.exec(e);if(n&&n[0])return n[0].substring(1,n[0].length-1);s.props.onInputChange&&s.props.onInputChange(e);return e};s._onGetMoreResults=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!s.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:s.props.sharingInformation.siteIBSegmentIDs};return s._peoplePickerProvider.sharePointSearch(e,n)};s._onSuggestionSelected=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(_.e.isFeatureEnabled({ODC:"FamilySharing"})&&m.m(s.props.clientId)){var r=s._store.getFamily(),i=s._store.getFamilyMembers();r&&i&&(e.userId===r.userId?s._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:E[s.state.familyType],mode:N.e.share}):i.some(function(t){return t.userId===e.userId})&&s._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:E[s.state.familyType],mode:N.e.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===a.e.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0}var o=!D.e.isActivated("6a4e06ce-21cb-40a0-b7f2-53ea3d93c1f2","04/02/2020","Calling resolve API for unvalidated external users in share dialog")&&Object(P.i)(e);return!e.isResolved||o?s._peoplePickerProvider.resolve(e.userId,n).then(function(t){!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails);4===e.entityType&&(t.entityType=e.entityType);return t}):e};s._onRenderItem=function(e){var t=s.props.permissionsMap,n=s._computeAllowExternalUsers(s.props.sharingLinkKind,s.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!n||1===s.props.sharingLinkKind&&t&&(void 0!==t[e.item.email]&&1===t[e.item.email]||void 0!==t[e.item.userId]&&1===t[e.item.userId])||!e.item.isResolved&&!e.item.isResolving,u=e.item.name;e.removeButtonAriaLabel=C.format(g.e.removePersonLabel,u);e.item.imageAlt=C.format(g.e.userPhotoAriaLabel,u);return o?i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},i.createElement(x.t,Object(r.__assign)({},e))):e.item.isResolving?i.createElement(d.e,{className:"od-Share-PeoplePicker-resolve-spinner"}):i.createElement(x.t,Object(r.__assign)({},e))};s._onToggleGetMoreResults=function(e){s.state&&(e&&!s.state.searchForMoreText||!e&&s.state.searchForMoreText)&&s.setState({searchForMoreText:s._getSearchForMoreText(e)})};s._peoplePickerProvider=n.peoplePickerProvider;s._resize=n.resize;s._platformDetection=n.platformDetection;s._hasTakenErrorFocus=!1;s._store=n.sharingStore;s.state={selectedItems:t.defaultSelectedItems,searchForMoreText:s._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:E.None,familyResolveEventFired:!1};s._resizeTracker=new y.e(n.resize);return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,r=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&r.push(n[0].name)});this.setState({selectedItems:t,addedUsers:r})};t.prototype.componentDidUpdate=function(e,t){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var n=t.addedUsers,r=this.state.addedUsers,i=this.state.removedUsers;this._resizeTracker?this._resizeTracker.checkSizeChange(this._peoplePicker):null!==this.props.error&&null===e.error&&this._resize();if(n.length>r.length){i=n.filter(function(e){return-1===r.indexOf(e)});this.setState({removedUsers:i})}else n.length!==r.length&&i.length>0&&this.setState({removedUsers:[]})};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;!this._peoplePickerControl||m.i(this.props.clientId)||e||this._peoplePickerControl.focusInput()};t.prototype.render=function(){var e=this,t={placeholder:this._computePlaceholderText(),onFocus:function(t){e._onFocus()},"aria-label":this._computeAddAnotherAriaLabel()},n=this.props.pickerSettings,s={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!D.e.isActivated("ecb0e267-7a2f-499b-b0bd-1cb4e6476c62","07/01/2020","Use substrate in people search.")&&n.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:!!this.props.sharingInformation.enforceIBSegmentFiltering,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:L.e.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs},o=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker",u=m.i(this.props.clientId)||this._platformDetection.isMobile,a={preventDismissOnScroll:u,preventDismissOnResize:!0},f=u?g.e.fabricPickerSuggestionsAvailableMobile:g.e.fabricPickerSuggestionsAvailable;return i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",className:"od-Share-PeoplePicker-wrapper",role:"presentation",ref:function(t){e._peoplePicker=t}},H.e(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement(T.e,{componentRef:this._resolveRef("_peoplePickerControl"),className:o,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:t,loadingText:g.e.loadingLabel,noResultsFoundText:g.e.noResultsLabel,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:s,suggestionsClassName:"od-Share-PeoplePicker-Suggestions"+(this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""),onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,ariaLabel:this._computeAddAnotherAriaLabel(),suggestionsAvailableAlertText:f,enableSelectedSuggestionAlert:this._platformDetection.isIE,role:"presentation",pickerCalloutProps:a}),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(b.e,Object(r.__assign)({},this.props.roleSelectorProps))),i.createElement("div",{className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))};t.prototype._onResolvedSuggestions=function(e,t){if(_.e.isFeatureEnabled({ODC:"FamilySharing"})&&m.m(this.props.clientId)){var n=this._store.getFamily(),r=this._store.getFamilyMembers();if(n&&t.length>1){var i=0===g.e.family.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),s=!1,o=E.None;if(i){o=E.Family;s=!0;e=[n].concat(r,e)}else{e.forEach(function(t,i){r.forEach(function(r){if(!s&&t.userId===r.userId||t.email===r.email){e.splice(i+1,0,n);s=!0}})});s&&(o=E.FamilyMember)}this.setState({familyType:o});if(s&&!this.state.familyResolveEventFired){this.setState({familyResolveEventFired:!0});this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:N.e.share,familySuggestionType:E[o]})}}}var u=[],a=[this._store.getCurrentUserId()],f=[];e.forEach(function(e){if(-1===a.indexOf(e.userId)&&-1===u.indexOf(e.email)){f.push(e);e.userId&&a.push(e.userId);e.email&&u.push(e.email)}});try{return this.props.onResolvedSuggestions(f)}catch(e){return f}};t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}};t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email?e.email:"",imageInitials:"",imageAlt:e.imageAlt};return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(A.e,Object(r.__assign)({},t,{presence:O.t.none,size:O.n.small,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&i.createElement(M.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails);!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var r=[];t.state.selectedItems.forEach(function(t){t.email===e.email?r.push(n):r.push(t)});t.setState({selectedItems:r},function(){t.props.onChange(r)})}).catch(function(){var n=Object(r.__assign)(Object(r.__assign)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)});t.setState({selectedItems:i},function(){t.props.onChange(i)})})};t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++){if(t[e].isResolving)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?g.e.peoplePickerPlaceholder:g.e.peoplePickerPlaceholderWithSelection};t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,r=[];t.length>0&&(r=r.concat(t.map(function(e){return C.format(g.e.peoplePickerPersonAddedAlert,e)+". "+g.e.peoplePickerPlaceholderWithSelection})));n.length>0&&(r=r.concat(n.map(function(e){return C.format(g.e.peoplePickerPersonRemovedAlert,e)})));return r.length>0?r.toString():""};t.prototype._convertPrincipalType=function(e){if(!e)return a.e.none;for(var t=a.e.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=a.e.user);"DL"===i&&(t|=a.e.distributionList);"SecGroup"===i&&(t|=a.e.securityGroup);"SPGroup"===i&&(t|=a.e.sharePointGroup)}return t};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isResolveInProgress()){if(this._peoplePickerControl&&!m.i(this.props.clientId)&&!this._hasTakenErrorFocus){this._peoplePickerControl.focusInput();this._hasTakenErrorFocus=!0}return i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(l.e,{ariaLabel:g.e.peoplePickerLimitMessage},g.e.peoplePickerLimitMessage));e&&n.push(i.createElement(l.e,{ariaLabel:e},e));t&&n.push(i.createElement(l.e,{ariaLabel:t},t));return n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype._getSearchForMoreText=function(e){return e?g.e.searchForMoreText:void 0};t.prototype._onFocus=function(){k.c()};t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?g.e.selectedItemListLabel:g.e.selectedItemAddAnotherAriaLabel};t.contextTypes={peoplePickerProvider:c.object.isRequired,resize:c.func.isRequired,platformDetection:c.object.isRequired,sharingStore:c.object.isRequired};return t})(S.e),j=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._peoplePickerProvider=n.peoplePickerProvider;return r}t.prototype.render=function(){return!!this._peoplePickerProvider.getLivePersonaPickerHelper&&!!this._peoplePickerProvider.getLivePersonaPickerHelper()?i.createElement(w,Object(r.__assign)({},this.props,{selectionLimit:100})):i.createElement(B,Object(r.__assign)({},this.props,{selectionLimit:100}))};t.contextTypes={peoplePickerProvider:c.object.isRequired};return t})(i.Component);t.e=j},"1614":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1382),s=n(7),o=n(97),u=n(176),a=n(1383),f=n(80),l=n(54),c=n(1590),h=n(1623),p=n(1575),d=n(1580),v=n(1644),m=n(30),g=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._itemProvider=n.itemProvider;r._operationProvider=n.operationProvider;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._sharingContextInformation=n.sharingContextInformation;return r}t.prototype.share=function(e,t,n){if(this._sharingContextInformation||n)return this._dataSource.share(e,t);var r=this._getShareOperation(t),i=this._dataSource.share(e,t);r.state(d.e.started);return i.then(this._onSuccess(t,r),this._onError(r))};t.prototype._getShareOperation=function(e){var t=this,n=this.observables,r=this._operationProvider.register({name:e.items[0].name,type:p.e.shareItem,payloads:{shareItem:{items:e.items}},iconName:e.items[0].iconName,actions:{hipCheck:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getHipCheckUrl(),frameId:"_blank"});r.state(d.e.expired);return l.n.wrap()}},verifyAccount:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getVerifyAccountUrl(),frameId:"_blank"});r.state(d.e.expired);return l.n.wrap()}}}});r.progress.maximum(1);r.progress.current(0);return r};t.prototype._onSuccess=function(e,t){var n=this;return function(r){e.items[0].parent&&n._itemProvider&&n._itemProvider.invalidateItem(e.items[0].parent.key);t.progress.current(1);r.statusCode>=0?t.state(d.e.completed):t.state(d.e.failed);var i=t.payloads.peek();i.shareItem.result=r.statusCode;t.payloads(i);return r}};t.prototype._onError=function(e){var t=this;return function(n){var r=e.payloads.peek();r.shareItem.result=n.statusCode||n.code;e.payloads(r);var i,s=n.code;if(3006===s&&t._urlDataSource.getHipCheckUrl()){e.actions.peek().hipCheck.isAvailable(!0);i=n&&n.message}else if(3009!==s&&3033!==s||!t._urlDataSource.getVerifyAccountUrl())3007!==s&&3034!==s&&3036!==s&&3037!==s&&1007!==s&&3035!==s||(i=n&&n.message);else{e.actions.peek().verifyAccount.isAvailable(!0);i=v.e.VerifyAccount}i&&e.error(new h.e({message:i}));e.state(d.e.failed);return l.n.wrapError(n)}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{sharingDataSource:o.ne,itemProvider:a.resourceKey.optional,operationProvider:c.e,navigation:f.e,urlDataSource:o.pe,sharingContextInformation:m.d.optional});return t})(i.default),y=Object(s.s)("ShareItemHelper",g),b=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(l.n.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){l.n.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})();n.d(t,"resourceKey",function(){return E});var w=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new b({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t,n){var r=this;return this._shareItemHelper.share(e,t,n).then(function(e){r._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].parent&&e[0].parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{sharingDataSource:o.ne,sharingDataDataSource:o.re.optional,navigation:f.e,externallySharedItemProvider:u.r.optional,itemProvider:a.resourceKey.optional,shareItemHelper:y});return t})(i.default),E=(t.default=w,Object(s.s)("SharingProvider",w))},"1628":function(e,t,n){"use strict";var r=n(54),i=n(7),s=n(97),o=n(0),u=n(226),a=n(116),f=(function(e){Object(o.__extends)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=7;var r=window._sharingContextInfo;r&&(t._StorageKey=""+t._StorageKey+r.webAbsoluteUrl);n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version||n.initializeBuffer();n._data={};for(var i=0;i<n._buffer.dataArray.length;i++)n._data[n._buffer.dataArray[i].email]=n._buffer.dataArray[i];return n}t.clear=function(){new u.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return!!this._data[e.email]};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=a.e.local;return t})(u.e),l=n(132);n.d(t,"t",function(){return h});var c=(function(){function e(e,t){var n=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;n&&(this._mruCache=new f);this.MaxCacheSuggestions=n?5:0}e.prototype.search=function(e,t){var n,i,s=this,o={cached:null,promise:null},u=Object(l.isFeatureEnabled)(l.PeoplePickerGraph)&&t.useGraph,a=Object(l.isFeatureEnabled)(l.PeoplePicker3S)&&t.useSubstrate;!this._mruCache||t.groupID||u||a||(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new r.n(function(r,o){n=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper&&this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];f.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})(),h=(t.e=c,Object(i.s)("PeoplePickerProvider",c,{dataSource:s.U}))},"1636":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i=((r={})[0]="Globe",r[3]="Lock",r[2]="PeopleAdd",r[1]="Work",r[4]="SecurityGroup",r[5]="Chat",r[6]="Mail",r)},"1654":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return c});var r,i=n(0),s=n(178),o=n(2026),u=n(4241),a=n(2066),f=n(3927),l=n(1570);(function(e){e.Opening="Opening";e.Opened="Opened";e.Completed="Completed"})(r||(r={}));var c=(function(){function e(e,t){this._manager=e;this._extraData=t}e.prototype.setEngagementExtraData=function(e){this._extraData=Object(i.__assign)(Object(i.__assign)({},this._extraData),e)};e.prototype.linkSettingsOpened=function(e){this.log("LinkSettings.Opened",e)};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.shareCompleted=function(e){this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(i.__assign)(Object(i.__assign)({},e),{linkedinSuggestionsCount:l.t(t)}))};e.prototype.logEvent=function(e,t){this.log(r[e],t)};e.prototype.log=function(e,t){var n=Object(i.__assign)(Object(i.__assign)({},this._extraData),t),r=Object(i.__assign)(Object(i.__assign)({},n),{clientId:o.e[n.clientId],scenarioId:n.scenarioId,mode:u.e[n.mode],shareType:a.e[n.shareType],audience:f.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets)}),l={name:"ShareV3."+e,webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:r};(this._manager?s.e.withManager(this._manager):s.e).logData(l)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t.push(a.e[i])}return t};return e})()},"1655":function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r,i,s=n(299),o=n(1562);function u(e){r=Object(s.t)(90076,e);i=Object(s.t)(90085,e)}function a(){if(!r||!o.T())return 0;r.logExposure();return r.variantToDisplay}function f(){if(!i||!o.e())return 0;i.logExposure();return i.variantToDisplay}},"1659":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully";e[e.AccessRequestsQueued=1]="AccessRequestsQueued";e[e.Error=2]="Error"})(r||(r={}));(function(e){e[e.UnshareLink=0]="UnshareLink";e[e.ShareLink=1]="ShareLink";e[e.FetchSharingInformation=2]="FetchSharingInformation"})(i||(i={}))},"1660":function(e,t,n){"use strict";var r;(function(e){e[e.button=0]="button";e[e.link=1]="link"})(r||(r={}));t.e=r},"1663":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHint{background:none;margin:16px 16px 0px 16px;position:relative}.isFluent .od-ShareHint{margin:0 16px}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:16px}.od-ShareHint .ms-Label{font-size:12px;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:10px;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:14px;font-weight:400;background:none;border:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:";padding:10px 10px 10px 0px;margin:0;opacity:0;-webkit-transition:opacity 200ms;transition:opacity 200ms;outline:transparent;position:relative}@media screen and (-ms-high-contrast: active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.isFluent .od-ShareHint .od-ShareHint-data{border-radius:2px;border:none}.od-ShareHint .od-ShareHint-data::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHint .od-ShareHint-data:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareHint .od-ShareHint-data:focus:after{border-color:ActiveBorder}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:10px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.od-ShareHint-darkBorder{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:2px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint--clickable:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:-webkit-gradient(linear, left top, right top, from("},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"), color-stop(50%, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"), to("},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"));background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0%, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;-webkit-animation:2s ease-in-out infinite placeholderShimmer;animation:2s ease-in-out infinite placeholderShimmer;-webkit-transition:opacity 200ms, visibility 200ms;transition:opacity 200ms, visibility 200ms}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:36px;height:24px}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:24px;border-bottom:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:white}@-webkit-keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}\n"}]);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:12px;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusUnhealthyText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusUnhealthyText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusUnhealthyText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir='ltr'] .od-ShareHintDetail-statusDetails{right:-36px}[dir='rtl'] .od-ShareHintDetail-statusDetails{left:-36px}[dir='ltr'] .od-ShareHintDetail-statusDetails{text-align:right}[dir='rtl'] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:10px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir='ltr'] .od-ShareHintDetail-item{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir='ltr'] .od-ShareHintDetail-description{text-align:left}[dir='rtl'] .od-ShareHintDetail-description{text-align:right}\n"}]);var s=n(600),o=n(3927),u=n(4269),a=n(1410),f=n("react-lib"),l=n(20),c=n(1553),h=n(938),p=n(1556),d=n(1599),v=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._renderStatusIcons=r._renderStatusIcons.bind(r);return r}t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return f.createElement("div",{className:"od-ShareHintDetail"},f.createElement("div",{className:"od-ShareHintDetail-description"},f.createElement("div",{className:"od-ShareHintDetail-status"},f.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,r=[];e&&e.getTime()!==new Date(0).getTime()&&r.push({icon:"Calendar",tooltip:""+l.format(c.e.expiresIn2,Object(h.s)(e))});t&&r.push({icon:"Lock",tooltip:c.e.sharePasswordReminderText});n&&r.push({icon:"Blocked2",tooltip:c.e.preventDownloadHint});this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.isReview&&d.t[this.props.sharingInformation.fileExtension]&&r.push({icon:"Feedback",tooltip:c.e.officeReviewModeHint});this.props.currentSettings.audience===o.e.anyone&&this.props.currentSettings.trackLinkUsers&&r.push({icon:"ReminderPerson",tooltip:c.e.requireVerificationHint});var i=r.map(function(e,t){return f.createElement("i",{className:"od-ShareHintDetail-item"},f.createElement(a.e,{content:e.tooltip,id:e.icon},f.createElement(s.e,{iconName:e.icon,"aria-describedby":e.icon})))});return f.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)}};t.prototype._getLabel=function(e){var t=c.e,n=this.props.companyName,r=this.props.sharingInformation.addressBarLinkSettings,i=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&r)return r.linkDisabled||!Object(p.n)(i)?t.permissionsExistingPeopleString:l.format(t.cslViewDescription,n);if(!e)return"";if(e.preventDownload){if(e.audience===o.e.anyone)return t.anonymousViewOnlyHint;if(e.audience===o.e.organization)return l.format(t.cslViewOnlyHint,n);if(e.audience===o.e.specificPeopleFlex)return t.specificPeopleViewOnlyHint}switch(e.sharingLinkKind){case 1:return e.audience===o.e.specificPeople?this.props.sharingInformation.requiresAccessApproval?c.e.requestAccessDescription:e.sharingRole?e.sharingRole===u.e.edit?t.specificPeopleEditHint:e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.e.specificPeopleOfficeReviewHint:c.e.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:t.existingPeopleDescription;case 2:return l.format(t.cslViewDescription,n);case 3:return l.format(t.cslEditDescription,n);case 4:return t.anonViewDescription;case 5:return t.anonEditDescription;case 6:return e.audience===o.e.existing?t.existingPeopleDescription:e.audience===o.e.specificPeopleFlex?e.sharingRole?e.sharingRole===u.e.edit?t.specificPeopleEditHint:e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.e.specificPeopleOfficeReviewHint:c.e.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:e.audience===o.e.customLabeledSpecificPeople?e.sharingRole===u.e.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.e.customLabeledReviewLabel,this.props.customLabeledAudienceConfig.entityName):Object(p.o)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.e.customLabeledEditLabel,this.props.customLabeledAudienceConfig.entityName):Object(p.o)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.e.customLabeledViewLabel,this.props.customLabeledAudienceConfig.entityName):Object(p.o)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.e.organization?e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?l.format(t.cslOfficeReviewDescription,n):l.format(t.cslReviewDescription,n):e.isEdit?l.format(t.cslEditDescription,n):l.format(t.cslViewDescription,n):e.audience===o.e.anyone?e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.e.anonOfficeReviewDescription:c.e.anonReviewDescription:e.isEdit?c.e.anonEditDescription:c.e.anonViewDescription:"";default:return""}};return t})(f.Component),m=n(1707),g=n(409),y=n(4147),b=n(2840),w=n(115),E=n(55),S=n(516),x=n("prop-types-lib");n.d(t,"e",function(){return N});var T={ODB:1176},N=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._targetButton=Object(f.createRef)();r._odShareHintchevron=Object(f.createRef)();r._onDismiss=function(){r.setState({isCoachmarkVisible:!1})};r._platformDetection=n.platformDetection;r._isOnExperiment=!1;if(E.n.isFeatureEnabled(T)){var i=new S.t({name:"CoachMark",startDate:"08/2/2018",version:S.e.v2});r._isOnExperiment=i.IsExperimentOn()}r.state={isCoachmarkVisible:r._isOnExperiment};return r}t.prototype.componentDidMount=function(){this._platformDetection.isIE&&this._targetButton.current&&this._targetButton.current.focus()};t.prototype.render=function(){var e,t,n=this.props,i=!!this.props.onShareHintClick,s="od-ShareHint "+(Object(p.x)(n.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),u="od-ShareHint-data "+(i?"od-ShareHint--clickable":"")+" "+(n.useDarkBorder?"od-ShareHint-darkBorder":"");e=f.createElement("div",{className:"od-ShareHint-shimmer"},f.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},f.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},f.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),f.createElement("div",{className:"od-ShareHint-text-shimmer"}));if(n.isAddressBarLinkHint){var a=this.props.sharingInformation.addressBarLinkSettings,h=this.props.sharingInformation.sharingAbilities,d=4===(E=a.linkDisabled||!Object(p.n)(h)?4:1)?c.e.permissionsExistingPeopleString:l.format(c.e.permissionsCompanyString,this.props.companyName);t=f.createElement("button",{className:u,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(m.e,{label:d,permissionsType:E,showLabel:!1})),f.createElement(v,{clientId:n.clientId,companyName:n.companyName,currentSettings:null,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:n.addressBarLink}),this._renderChevron(i))}else{var E=this._getFileShareTypeFromAudience(),S=(d=this._getLabelFromPermissionsType(E),this.props.currentSettings.audience===o.e.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl);t=n.onShareHintClick?f.createElement("button",{className:u,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(m.e,{label:d,permissionsType:E,iconUrl:S,showLabel:!1})),f.createElement(v,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig}),this._renderChevron(i)):f.createElement("div",Object(r.__assign)({className:u},{autoFocus:!0}),f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(m.e,{label:d,permissionsType:E,iconUrl:S,showLabel:!1})),f.createElement(v,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig}),this._renderChevron(i))}return f.createElement("div",{"aria-label":c.e.modifyPermissionsHeader,className:s},t,e,this.state.isCoachmarkVisible&&f.createElement(y.e,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:g.e.isRightToLeft?w.e.bottomLeftEdge:w.e.bottomRightEdge}},f.createElement(b.e,{calloutProps:{directionalHint:g.e.isRightToLeft?w.e.bottomLeftEdge:w.e.bottomRightEdge,gapSpace:0},headline:c.e.modifyPermissionsHeader,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:c.e.closeButtonLabel,onDismiss:this._onDismiss},c.e.linkSettingsExplanation1,f.createElement("br",null),c.e.linkSettingsExplanation2)))};t.prototype._renderChevron=function(e){if(e)return f.createElement("div",{ref:this._odShareHintchevron},f.createElement(s.e,{iconName:g.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron"}))};t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===o.e.anyone?0:e===o.e.organization?1:e===o.e.existing?4:e===o.e.customLabeledSpecificPeople?5:2};t.prototype._getLabelFromPermissionsType=function(e){var t=c.e;return 0===e?t.permissionsAnyoneString:1===e?l.format(t.permissionsCompanyString,this.props.companyName):4===e?t.permissionsExistingPeopleString:2===e?t.permissionsSpecificPeopleString:void 0};t.contextTypes={platformDetection:x.object.isRequired};return t})(f.Component)},"1666":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;-webkit-transform:translateX(-50%) scale(0.5, 0.5);transform:translateX(-50%) scale(0.5, 0.5);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;background-color:#599b00;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;border-radius:50%;width:44px;height:44px;-webkit-animation:bounce 0.45s;animation:bounce 0.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:44px}.isFluent .od-ShareNotification-icon{background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-ShareNotification-content{width:90%}[dir='ltr'] .od-ShareNotification-content{padding-left:16px}[dir='rtl'] .od-ShareNotification-content{padding-right:16px}[dir='ltr'] .od-ShareNotification-content{padding-right:16px}[dir='rtl'] .od-ShareNotification-content{padding-left:16px}.isFluent .od-ShareNotification-content .ms-font-l{font-weight:500;font-size:20px}.od-ShareNotification-content-tooltip{margin:5px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-webkit-box;display:-ms-flexbox;display:flex}.isFluent .od-ShareNotification-urlText{padding:12px 0}.isFluent .od-ShareNotification-urlText .ms-TextField{padding-right:4px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir='ltr'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir='rtl'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.isFluent .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{border-radius:2px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:32px}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;width:12px;height:12px;cursor:pointer}[dir='ltr'] .od-ShareNotification-close{right:12px}[dir='rtl'] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}.isFluent .od-ShareNotification-footer{margin-top:0px}@-webkit-keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0px 0px 0px;padding:16px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-ShareNotification .od-ShareHint{padding:6px;margin:0;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:12px;font-weight:400}.od-ShareNotification-copyButton{height:32px;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}.isFluent .od-ShareNotification-copyButton{border-radius:2px}[dir='ltr'] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir='rtl'] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:17px;font-weight:300;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0px 8px 24px 8px;text-align:left}\n"}]);var s=n(1576),o=n(2066),u=n(1663),a=n(2965),f=n("react-lib"),l=n("prop-types-lib"),c=n(20),h=n(1556),p=n(1394),d=n(1235),v=n(115),m=n(600),g=n(1553),y=n(1558),b=n(1571);n.d(t,"e",function(){return w});var w=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowNameTooltip=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isNameTooltipVisible:!0}))};i._onHideNameTooltip=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isNameTooltipVisible:!1}))};i._copySharingLinkToClipboard=function(){return Object(r.__awaiter)(i,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){h.i(this.props.clientId,this._textField,this.props.linkUrl).then(function(t){e.setState(Object(r.__assign)(Object(r.__assign)({},e.state),{successfullyCopied:t}))});return[2]})})};i._onNotificationLabel=function(e){i._notificationLabel=e};i.state={successfullyCopied:!1,isNameTooltipVisible:!1};i._resize=n.resize;i._sharingStore=n.sharingStore;i._platformDetection=n.platformDetection;return i}t.prototype.componentDidMount=function(){var e=this,t=this._platformDetection,n=t.isEdge,r=t.isIE,i=this.props.shareType===o.e.copy&&this.props.shouldCopyLinkToClipboard,s=r&&!y.p(this.props.clientId);i&&!s&&this._copySharingLinkToClipboard();(n||s)&&setTimeout(function(){e._textField.focus()},500)};t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=this._getNotificationLabel(!0),i=this._getNotificationAriaLabel(),u=this.props.shareType===o.e.copy,l=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),c=this.props.shareType,h=c===o.e.share||c===o.e.moreApps||c===o.e.copy&&this.state.successfullyCopied,y=h?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return l?f.createElement("div",{className:"od-ShareNotification"},f.createElement(s.e,Object(r.__assign)({},Object(b.e)(this.props),{viewState:4})),f.createElement("div",{className:"od-ShareNotification-content ms-font-su"},f.createElement(m.e,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon"}),f.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},g.e.accessRequestNotificationHeader),f.createElement("div",{className:"od-ShareNotification-accessRequestBody"},g.e.accessRequestNotificationBody))):f.createElement("div",{className:"od-ShareNotification "+y,role:"alert","aria-live":"assertive"},f.createElement(s.e,Object(r.__assign)({},Object(b.e)(this.props),{viewState:4})),this._renderCheckMark(h),f.createElement("div",{className:"od-ShareNotification-content"},f.createElement("div",{className:"ms-font-l",ref:this._onNotificationLabel,onMouseOver:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip,role:"alert","aria-live":"assertive"},t),this.state.isNameTooltipVisible&&t!==n&&f.createElement(d.e,{directionalHint:v.e.topCenter,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300},f.createElement("div",{className:"od-ShareNotification-content-tooltip"},n)),u&&this._renderCopyCta(),u&&f.createElement("div",{className:"od-ShareNotification-urlText"},f.createElement(a.e,{autoFocus:!0,"aria-live":"polite",ariaLabel:i,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField"}),f.createElement(p.e,{className:"od-ShareNotification-copyButton",text:g.e.copyButtonLabel,onClick:this._copySharingLinkToClipboard}))),u&&this._renderShareHint())};t.prototype._renderCheckMark=function(e){if(e)return f.createElement("div",{className:"od-ShareNotification-icon"},f.createElement(m.e,{iconName:"CheckMark"}))};t.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===o.e.copy&&!t.successfullyCopied)return f.createElement("span",{className:"od-ShareNotification-copyCta"},g.e.notificationCopyFailedCta)};t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?f.createElement("div",{className:"od-ShareNotification-footer"},f.createElement(u.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig})):null};t.prototype._getNotificationLabel=function(e){var t=g.e,n=e?this.props.itemName:h.L(this.props.itemName),r=this.props.shareType,i=n?c.format(t.notificationCopied,n):g.e.notificationCopiedLabel,s=n?c.format(t.notificationCopyFailed,n):g.e.notificationCopyFailedLabel,u=n?c.format(t.notificationSent,n):g.e.notificationSentLabel;return r===o.e.copy?this.state.successfullyCopied?i:s:r===o.e.share?u:r===o.e.moreApps?s:""};t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===o.e.copy?this.state.successfullyCopied?g.e.notificationCopiedLabel:g.e.notificationCopyFailedLabel:e===o.e.share?g.e.notificationSentLabel:e===o.e.moreApps?g.e.notificationCopyFailedLabel:""};t.contextTypes={resize:l.func.isRequired,sharingStore:l.object.isRequired,platformDetection:l.object.isRequired};return t})(f.Component)},"1681":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});var r,i,s,o;(function(e){e[e.Sunday=0]="Sunday";e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=3]="Wednesday";e[e.Thursday=4]="Thursday";e[e.Friday=5]="Friday";e[e.Saturday=6]="Saturday"})(r||(r={}));(function(e){e[e.January=0]="January";e[e.February=1]="February";e[e.March=2]="March";e[e.April=3]="April";e[e.May=4]="May";e[e.June=5]="June";e[e.July=6]="July";e[e.August=7]="August";e[e.September=8]="September";e[e.October=9]="October";e[e.November=10]="November";e[e.December=11]="December"})(i||(i={}));(function(e){e[e.FirstDay=0]="FirstDay";e[e.FirstFullWeek=1]="FirstFullWeek";e[e.FirstFourDayWeek=2]="FirstFourDayWeek"})(s||(s={}));(function(e){e[e.Day=0]="Day";e[e.Week=1]="Week";e[e.Month=2]="Month";e[e.WorkWeek=3]="WorkWeek"})(o||(o={}))},"1691":function(e,t){var n,r,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}})();function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var a,f=[],l=!1,c=-1;function h(){if(l&&a){l=!1;a.length?f=a.concat(f):c=-1;f.length&&p()}}function p(){if(!l){var e=u(h);l=!0;for(var t=f.length;t;){a=f;f=[];for(;++c<t;)a&&a[c].run();c=-1;t=f.length}a=null;l=!1;(function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout){r=clearTimeout;return clearTimeout(e)}try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}})(e)}}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new d(e,t));1!==f.length||l||u(p)};function d(e,t){this.fun=e;this.array=t}d.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};function v(){}i.on=v;i.addListener=v;i.once=v;i.off=v;i.removeListener=v;i.removeAllListeners=v;i.emit=v;i.prependListener=v;i.prependOnceListener=v;i.listeners=function(e){return[]};i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},"1699":function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(1596),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],fluid:["fluid"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},s=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==r.t.File?r.t[e.itemType].toLowerCase():u(e.extension):"none"}function u(e){if(!e)return"none";if(!s){s={};Object.keys(i).map(function(e){i[e].forEach(function(t){s[t]=e})})}var t=s[e.toLowerCase()];return t||"other"}},"1707":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDescription{-webkit-box-align:top;-ms-flex-align:top;align-items:top;display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px 0px 2px 0px;width:100%}.isFluent .od-ShareLinkDescription{padding:4px 0}.od-ShareLinkDescription-label{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;width:80%;padding-top:2px}[dir='ltr'] .od-ShareLinkDescription-label{margin-left:8px}[dir='rtl'] .od-ShareLinkDescription-label{margin-right:8px}[dir='ltr'] .od-ShareLinkDescription-label{text-align:left}[dir='rtl'] .od-ShareLinkDescription-label{text-align:right}.isFluent .od-ShareLinkDescription-label{padding-top:0;position:relative;top:2px}.od-ShareLinkDescription-image{width:16px;height:16px}.od-ShareLinkDescription-icon{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:1px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;height:24px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:24px}.isFluent .od-ShareLinkDescription-icon{font-size:14px}.od-ShareLinkDescription-icon .ms-Icon{font-size:14px}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:24px;height:24px;border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir='ltr'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir='rtl'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}\n"}]);var s=n(1636),o=n(1708),u=n(600),a=n("react-lib");n.d(t,"e",function(){return f});var f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=s.e[this.props.permissionsType],t=this.props.iconUrl?a.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):a.createElement(u.e,{"aria-hidden":"true",iconName:e});return a.createElement("div",{className:"od-ShareLinkDescription"},a.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e,"aria-hidden":"true"},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?a.createElement(o.e,{message:e}):"";if(this.props.showLabel)return a.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t)};return t})(a.Component)},"1708":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:12px}.od-InfoButton-button{background:none;border:none;padding:0}.od-InfoButton-content{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}\n"}]);var s=n(1235),o=n(115),u=n(600),a=n("react-lib"),f=n("prop-types-lib");n.d(t,"e",function(){return l});var l=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!1}))};i._onInfoButton=function(e){i._infoButton=e};i.state={isCalloutVisible:!1};return i}t.prototype.render=function(){var e=this.props,t=this.state;return a.createElement("div",null,a.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},a.createElement(u.e,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout})),t.isCalloutVisible&&a.createElement(s.e,{directionalHint:o.e.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},a.createElement("div",{className:"od-InfoButton-content"},a.createElement("span",{className:"od-InfoButton-message"},e.message))))};t.contextTypes={strings:f.object.isRequired};return t})(a.Component)},"1709":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}\n"}]);var s=n("react-lib"),o=n(1394),u=n(1544),a=n(3927),f=n(1660),l=n(1556),c=n("prop-types-lib"),h=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSendLinkClicked=function(){r.props.onSendLinkClicked(r.props.messageText,r.props.subjectText)};r._platformDetection=n.platformDetection;return r}t.prototype.render=function(){var e=!1;if(this.props.currentSettings.audience===a.e.existing)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var r=n[t];if(void 0===this.props.permissionsMap[r.email]&&void 0===this.props.permissionsMap[r.userId]){e=!0;break}}if(this.props.ctaLabel){var i=!!this.props.errorMessage||Object(l.x)(this.props.sharingInformation)||e||Object(l.f)(this.props.messageText)>this.props.maximumMessageLength||Object(l.f)(this.props.subjectText)>this.props.maximumSubjectLength;if(this.props.sendButtonType===f.e.button)return s.createElement(o.e,{disabled:i,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===f.e.link)return s.createElement("div",{className:"od-SendButton-linkButton"},s.createElement(u.e,{disabled:i,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};t.contextTypes={platformDetection:c.object.isRequired};return t})(s.Component);t.e=h},"1723":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(7),s=n(97),o=n(1382),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.policyTipDataSource;return r}t.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};t.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.default.dependencies),{policyTipDataSource:s.z});return t})(o.default),a=Object(i.s)("PolicyTipProvider",u)},"1724":function(e,t,n){"use strict";e.exports=n(1759).polyfill()},"1759":function(e,t,n){(function(t,n){r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,s=void 0,o=void 0,u=function(e,t){d[i]=e;d[i+1]=t;2===(i+=2)&&(o?o(v):m())},a="undefined"!=typeof window?window:void 0,f=a||{},l=f.MutationObserver||f.WebKitMutationObserver,c="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(v,1)}}var d=new Array(1e3);function v(){for(var e=0;e<i;e+=2){(0,d[e])(d[e+1]);d[e]=void 0;d[e+1]=void 0}i=0}var m=void 0;m=c?function(){return t.nextTick(v)}:l?(function(){var e=0,t=new l(v),n=document.createTextNode("");t.observe(n,{characterData:!0});return function(){n.data=e=++e%2}})():h?(function(){var e=new MessageChannel;e.port1.onmessage=v;return function(){return e.port2.postMessage(0)}})():void 0===a?(function(){try{var e=Function("return this")().require("vertx");return void 0!==(s=e.runOnLoop||e.runOnContext)?function(){s(v)}:p()}catch(e){return p()}})():p();function g(e,t){var n=this,r=new this.constructor(w);void 0===r[b]&&_(r);var i=n._state;if(i){var s=arguments[i-1];u(function(){return O(i,r,s,n._result)})}else L(n,r,e,t);return r}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);T(t,e);return t}var b=Math.random().toString(36).substring(2);function w(){}var E={error:null};function S(e){try{return e.then}catch(e){E.error=e;return E}}function x(t,n,r){if(n.constructor===t.constructor&&r===g&&n.constructor.resolve===y)(function(e,t){1===t._state?C(e,t._result):2===t._state?k(e,t._result):L(t,void 0,function(t){return T(e,t)},function(t){return k(e,t)})})(t,n);else if(r===E){k(t,E.error);E.error=null}else void 0===r?C(t,n):e(r)?(function(e,t,n){u(function(e){var r=!1,i=(function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}})(n,t,function(n){if(!r){r=!0;t!==n?T(e,n):C(e,n)}},function(t){if(!r){r=!0;k(e,t)}},e._label);if(!r&&i){r=!0;k(e,i)}},e)})(t,n,r):C(t,n)}function T(e,t){e===t?k(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?C(e,t):x(e,t,S(t)));var n,r}function N(e){e._onerror&&e._onerror(e._result);A(e)}function C(e,t){if(void 0===e._state){e._result=t;e._state=1;0!==e._subscribers.length&&u(A,e)}}function k(e,t){if(void 0===e._state){e._state=2;e._result=t;u(N,e)}}function L(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null;i[s]=t;i[s+1]=n;i[s+2]=r;0===s&&e._state&&u(A,e)}function A(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3){r=t[o];i=t[o+n];r?O(n,r,i,s):i(s)}e._subscribers.length=0}}function O(t,n,r,i){var s=e(r),o=void 0,u=void 0,a=void 0,f=void 0;if(s){if((o=(function(e,t){try{return e(t)}catch(e){E.error=e;return E}})(r,i))===E){f=!0;u=o.error;o.error=null}else a=!0;if(n===o){k(n,new TypeError("A promises callback cannot return that same promise."));return}}else{o=i;a=!0}void 0!==n._state||(s&&a?T(n,o):f?k(n,u):1===t?C(n,o):2===t&&k(n,o))}var M=0;function _(e){e[b]=M++;e._state=void 0;e._result=void 0;e._subscribers=[]}var D=(function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(w);this.promise[b]||_(this.promise);if(r(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(0===this.length)C(this.promise,this._result);else{this.length=this.length||0;this._enumerate(t);0===this._remaining&&C(this.promise,this._result)}}else k(this.promise,new Error("Array Methods must be provided an Array"))}e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)};e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===y){var i=S(e);if(i===g&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i){this._remaining--;this._result[t]=e}else if(n===P){var s=new n(w);x(s,e,i);this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)};e.prototype._settledAt=function(e,t,n){var r=this.promise;if(void 0===r._state){this._remaining--;2===e?k(r,n):this._result[t]=n}0===this._remaining&&C(r,this._result)};e.prototype._willSettleAt=function(e,t){var n=this;L(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})};return e})(),P=(function(){function e(t){this[b]=M++;this._result=this._state=void 0;this._subscribers=[];if(w!==t){"function"!=typeof t&&(function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")})();this instanceof e?(function(e,t){try{t(function(t){T(e,t)},function(t){k(e,t)})}catch(t){k(e,t)}})(this,t):(function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")})()}}e.prototype.catch=function(e){return this.then(null,e)};e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})};return e})();P.prototype.then=g;P.all=function(e){return new D(this,e).promise};P.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})};P.resolve=y;P.reject=function(e){var t=new this(w);k(t,e);return t};P._setScheduler=function(e){o=e};P._setAsap=function(e){u=e};P._asap=u;P.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=P};P.Promise=P;return P},e.exports=r();var r}).call(this,n(1691),n(951))},"1811":function(e,t,n){"use strict";var r;(function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"})(r||(r={}));t.e=r},"1823":function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){var n=t?document.createElement("textarea"):document.createElement("input");if(t)n.innerHTML=e;else{n.setAttribute("type","text");n.setAttribute("value",e)}document.body.appendChild(n);var r=!1;try{n.focus();n.select();r=document.execCommand("copy")}catch(e){}if(!r&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(n.value);r=!0}catch(e){}document.body.removeChild(n);return r}},"1837":function(e,t,n){"use strict";var r,i=n(0),s=n(4241),o=n(3927);(function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT";e[e.OWNER=3]="OWNER";e[e.REVIEW=6]="REVIEW"})(r||(r={}));var u=n(4269),a=n(2026),f=n(1659),l=n(1811),c=n(2871),h=n(1640),p=n(77),d=n(54),v=n(20),m=n(95),g=n(1553),y=n(71),b=n(31),w=n(74),E=n(1556),S=n(41),x=n(1558),T=n(1654),N=n(1600),C=n(1596),k=n(1699),L=n(1562),A=n(1655),O=(function(){function e(e,t){var n=this;this._listeners=null;var r=e.item,i=e.sharingInformation,s=e.defaultRecipients,o=e.accessChecked,u=void 0===o||o,f=e.mode;this._item=r;this._mode=f;this._sharingContextInformation=e.sharingContextInformation;this._clientId=this._sharingContextInformation&&Object(a.t)(this._sharingContextInformation.clientId);this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._substratePeoplePickerHelper=t.substratePeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value;this._sharingService=e.sharingService;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&Object(A.t)(this._sharingContextInformation.experimentContext);if(L.m()){var c=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"",h={mode:this._mode,clientId:this._clientId,scenarioId:c};this._engagementHelper=new T.e(e.telemetryManager,h)}else this._engagementHelper=new T.e(e.telemetryManager);this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:this._sharingContextInformation&&this._sharingContextInformation.organizationName||g.e.companyNameFallback,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:l.e.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};if(s&&0!==s.length)this._resolveDefaultRecipients(s,u,f);else{this._eventGroup=new m.t(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var r=t.recipientIds;n._resolveDefaultRecipients(r,u,f)}}catch(e){}})}}e.prototype.isConsumer=function(){return!1};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getInitialLinkSettings=function(e){return null};e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return!y.e.isActivated("460d91d6-f963-47fa-9254-0a47f9989ffc","07/01/2020","Disabling Graph searching in SPO/ODB.")&&this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||L.o()&&this._storeContents.sharingInformation.enforceSPOSearch)};e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&(!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled))}return!1};e.prototype.showManageAccess=function(){return!0};e.prototype.fetchSharingInformation=function(e,t){var n=this;if(!this._storeContents.sharingInformation||this._sharingInformationInvalidated||e&&!this._storeContents.sharingInformation.hasPermissionsInformation||t){var r=(new Date).getTime(),i=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._getSharingInformationStats={name:"GetSharingInformation",resultType:b.e.Success,duration:(new Date).getTime()-r};if(!n._storeContents.sharingInformation||!n._storeContents.sharingInformation.error){n._storeContents.sharingInformation=e;n._fetchAdditionalAuthenticationTokens();n.fetchPolicyTipInformation();n._configureLinkIfShareId();n._emitChange({type:f.t.FetchSharingInformation})}},function(e){var t=5,i=e&&e.code,s=e&&e.status,o=g.e.getSharingInformationError,u=JSON.stringify(e||{});i?i.indexOf("-2147024809")>-1&&u&&u.indexOf("Item does not exist")>-1&&(t=3):s&&parseInt(s,10)>=500&&(t=2);n._getSharingInformationStats={name:"GetSharingInformation",resultType:b.e.Failure,duration:(new Date).getTime()-r,error:t};n._invokeShareStatsEvent();n._storeContents.sharingInformation={error:t,errorCategory:1,errorMessage:o,debugErrorMessage:u,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};n._emitChange({type:f.t.FetchSharingInformation})})}else{this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:b.e.Success,duration:0};this._configureLinkIfShareId();this._emitChange({type:f.t.FetchSharingInformation})}};e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var r=n.totalMemberCount;t._groupMembersCountHash[e.email]=r;t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null;t._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(e){var t=this,n=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;var r=e.settings,u=e.recipients,a=e.emailMessage,l=e.emailSubject,c=e.copyLinkCommand,h=e.allRecipientsHaveAccess,p=e.shareId,d=e.inviteesToRemove;if(e.copyLinkCommand&&x.l(this._clientId)&&this._mode===s.e.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&n)this._getDefaultLink();else{var m=0,w=0,E=!1,S=(u=u||[]).map(function(e){1===e.entityType?w++:m++;e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(E=!0);return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});S=this._dedupeRecipients(S);if(!y.e.isActivated("88cc94ae-ba5f-4552-aea0-f5a00a24ff6b","01/02/2019","Ensure share link is called for manage access")&&(p&&p.length>0||r.shareId&&r.shareId.length>0))this._shareLink(r,S,a,l,c,n,p,d);else{if((y.e.isActivated("099614d2-0712-466a-be0f-c1f1ec2ee793","08/13/2019","fix sharing to new external users incident")?this.isPeopleSharingLinksEnabled()&&r.audience!==o.e.existing:this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!E)&&r.audience!==o.e.existing)&&!this._storeContents.sharingInformation.requiresAccessApproval)this._shareLink(r,S,a,l,c,n,p,d);else if(1!==r.sharingLinkKind&&6!==r.sharingLinkKind)this._shareLink(r,S,a,l,c,n,p,d);else{var T=void 0;T=r.sharingRole?this._getRoleString(r.sharingRole):this._getRoleValue(r.isEdit);var N={items:[this._item],roleValue:T,sendEmail:void 0!==a,message:a,subject:l,requireSignIn:!0,propagateSharing:!0},C=this._storeContents.sharingInformation.directLink;if(0===u.length||r.audience==o.e.existing&&(this._mode===s.e.copy||this._mode==s.e.linkSettings)){this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:b.e.Success});this._handleSharedLink(C,c)}else{for(var k=!0,L=0,A=u;L<A.length;L++){var O=A[L];3!==this._storeContents.permissionsMap[O.email]&&3!==this._storeContents.permissionsMap[O.userId]&&(k=!1)}if(k||h){var M=(new Date).getTime();this._sharingProvider.emailWithoutPermissioning(S,this._item,a,l).done(function(e){var n=e.statusCode;if(0===n){t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-M,resultType:b.e.Success});t._handleSharedLink(C,c)}else{var r=g.e,s=5,o=r.getSharingInformationError;if(-8===n){s=6;o=r.sharingOperationNotSupportedError}else if(-13===n){s=7;o=v.format(r.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===n){s=5;o=e.errorMessage}t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-M,resultType:b.e.Failure,error:s});t._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},t._storeContents.sharingInformation),{error:s,errorCategory:3,errorMessage:o});t._emitChange({type:f.t.ShareLink})}})}else{var _=(new Date).getTime();this._sharingProvider.share(S,N,!0).done(function(e){var n=e.statusCode;if(0===n){var s=C;0===m&&1===w&&e.invitationLink?s=Object(i.__assign)(Object(i.__assign)({},C),{url:e.invitationLink}):0===m&&w>1&&e.invitationLink&&(s=Object(i.__assign)(Object(i.__assign)({},C),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));r.audience===o.e.customLabeledSpecificPeople&&(s=Object(i.__assign)(Object(i.__assign)({},s),{audience:o.e.customLabeledSpecificPeople}));t._invokeShareStatsEvent({name:"ShareObject",resultType:b.e.Success,duration:(new Date).getTime()-_});t._handleSharedLink(s,c)}else if(1===n){t._storeContents.accessRequestCreated=!0;t._invokeShareStatsEvent({name:"ShareObject",resultType:b.e.Success,duration:(new Date).getTime()-_});t._handleSharedLink(C,c)}else{var u=g.e,a=5,l=u.getSharingInformationError;if(-8===n){a=6;l=u.sharingOperationNotSupportedError}else if(-13===n){a=7;l=v.format(u.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===n){a=5;l=e.errorMessage}t._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},t._storeContents.sharingInformation),{error:a,errorCategory:3,errorMessage:l});t._invokeShareStatsEvent({name:"ShareObject",resultType:b.e.Failure,duration:(new Date).getTime()-_,error:a});t._emitChange({type:f.t.ShareLink})}})}}}c&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==r.audience&&this._cleanupDefaultLink()}}};e.prototype.unshareLink=function(e,t){var n=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).done(function(e){if(!0===e){n._removeLinkByShareId(t);n._updateIsShared();n._emitChange({type:f.t.UnshareLink})}})};e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated};e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var i=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===r.NONE){n._storeContents.sharingInformation.sharingPrincipals=i.filter(function(t){return t.id!==e.id});n._updateIsShared();n._emitChange()}else for(var s=0,o=i;s<o.length;s++){var a=o[s];if(a.id===e.id){switch(t.role){case r.VIEW:a.role=u.e.view;break;case r.EDIT:a.role=u.e.edit;break;case r.OWNER:a.role=u.e.owner;break;case r.REVIEW:a.role=u.e.review}n._emitChange()}}})};e.prototype.addPeople=function(e,t,n,r,i){var s=this,o=this._getRoleString(t),u={items:[this._item],roleValue:o,sendEmail:r,message:i,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,u,!0).then(function(e){switch(e.statusCode){case 0:s._storeContents.addPeopleResult=f.e.CompletedSuccessfully;break;case 1:s._storeContents.addPeopleResult=f.e.AccessRequestsQueued;break;default:s._storeContents.addPeopleResult=f.e.Error}s._emitChange()},function(){s._storeContents.addPeopleResult=!1;s._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var e=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,r=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n;e._storeContents.outlookAvailability=r.HasEXOLicense?l.e.available:l.e.none;e._emitChange()});else{this._storeContents.outlookAvailability=l.e.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._storeContents.companyName};e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId};e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,r=function(e){var r={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===h.e.securityGroup){var s=i._groupsMemberCountCache[e.userId];void 0!==s?n+=s:i._peoplePickerProvider.getPickerEntityInformation(r).then(function(r){var i=r.totalMemberCount;t._groupsMemberCountCache[e.userId]=i;n+=i;t._storeContents.groupsMemberCount=n;t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null;t._emitChange()})}},i=this,s=0,o=e;s<o.length;s++){r(o[s])}this._storeContents.groupsMemberCount=n;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info){this._emitChange();return}var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,4),r=t.sharingAbilities;if(r){if(7!==(r&&r.directSharingAbilities&&r.directSharingAbilities.canAddExternalPrincipal.disabledReason)&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){if(t){e._storeContents.policyTipInfo.info=t;e._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo};e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){n._storeContents.policyTipInfo.actionResult=e;n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0);n._emitChange()})}};e.prototype.checkPermissions=function(e,t){var n=this;if(0!==e.length){var r=[];this._recipients=[];for(var i=0,s=e;i<s.length;i++){var o=s[i];r.push({alias:y.e.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email});this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers;this._invitedUsers=[];for(var u=0,a=t;u<a.length;u++){var f=a[u];r.push({alias:f.email});this._invitedUsers.push(f.email)}var l=r.map(function(e){return e.alias});this._sharingProvider.checkPermissions(r,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,r=e;t<r.length;t++){var i=r[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:2:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:1)}n._emitChange()})}else{this._storeContents.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,n=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});n=this._dedupeRecipients(n);var r={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(n,r,!0).done(function(e){t._storeContents=Object(i.__assign)(Object(i.__assign)({},t._storeContents),{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients};e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})};e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1};e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._storeContents.defaultLink=void 0}};e.prototype._emitChange=function(e){if(L.m()&&this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),r=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:r,extension:i})}for(var s=0,o=this._listeners;s<o.length;s++){(0,o[s])(e)}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var e=this;if(this._storeContents.sharingInformation){var t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n;e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1;var n=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();n?this._substratePeoplePickerHelper.getSubstrateToken().then(function(t){e._substratePeoplePickerHelper.init(t);n=!!t;e._storeContents.sharingInformation.isTsAvailable=n}):this._storeContents.sharingInformation.isTsAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._storeContents.sharingLinkCreated=e;this._updateIsShared();this._emitChange({type:f.t.ShareLink})};e.prototype._getRoleValue=function(e){return e?"role:1073741827":"role:1073741826"};e.prototype._getRoleString=function(e){return e===u.e.review?"roletype:Reviewer":e===u.e.edit?c.e:e===u.e.owner?c.t:c.r};e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===s.e.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}};e.prototype._removeLinkByShareId=function(e){this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(t){if(e===t.shareId){t.expiration=null;t.isActive=!1;t.shareId=p.e.Empty;t.url=null;t.principals=[]}return t})};e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,r=!1,i=0,s=t;i<s.length;i++){var o=s[i];o.isActive&&1!==o.sharingLinkKind&&(r=!0)}r||(r=n.length>0);this._storeContents.sharingInformation.isShared=r}};e.prototype._getOwaUrl=function(e,t){var n=location.origin.indexOf(".cn")===location.origin.length-3,r=location.origin.indexOf(".de")===location.origin.length-3,i="https://outlook.office.com/owa/";n?i="https://partner.outlook.cn/owa/":r&&(i="https://outlook.office.de/owa/");return i+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,n){var r=this,o=e||[],u=[];this._storeContents.isValidatingDefaultRecipients=e.length>0;if(!t){o=[];for(var a=[],f=0,l=e;f<l.length;f++){var c=l[f];a.push({alias:c})}u.push(this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.hasAccess||o.push(r.inputEntity)}}))}d.n.all(u).then(function(){if(0!==o.length){for(var e=[],t=[],u={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},a=0,f=o;a<f.length;a++){var l=f[a];e.push(r._peoplePickerProvider.resolve(l,u).then(function(e){t.push(e)}))}d.n.all(e).then(function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:t};r._storeContents.isValidatingDefaultRecipients=!1;r._emitChange()},function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:[]};r._storeContents.isValidatingDefaultRecipients=!1;r._emitChange()})}else if(n===s.e.atMention){r._storeContents=Object(i.__assign)(Object(i.__assign)({},r._storeContents),{grantAccessResult:!0});r._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],r=0,i=t[1].split("&");r<i.length;r++){var s=i[r];-1===s.indexOf("email=")&&n.push(s)}var o=n.join("&");return t[0]+"?"+o}return e};e.prototype._shareLink=function(e,t,n,r,l,c,h,p){var d=this,v={emailData:n,emailSubject:r,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:h,inviteesToRemove:p,role:e.sharingRole}};v.settings.role||(v.settings.role=e.isEdit?u.e.edit:u.e.view);if(e.shareId&&e.shareId.length>0){v.settings.shareId=e.shareId;e.fetchLinkOnly&&(v.settings.createLink=!1)}var m=(new Date).getTime(),E=new w.e({name:"SharingShareLink."+s.e[this._mode]+"."+(a.e[this._clientId]||"unknown")});if((e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===o.e.anyone){v.settings.sharingLinkKind=6;v.settings.allowAnonymousAccess=!0}if(e.audience===o.e.anyone)if(e.trackLinkUsers){v.settings.allowAnonymousAccess=!1;v.settings.restrictShareMembership=!1;v.settings.trackLinkUsers=!0;v.settings.scope=0;v.settings.sharingLinkKind=6}else{v.settings.allowAnonymousAccess=!0;v.settings.restrictShareMembership=!1;v.settings.trackLinkUsers=!1;v.settings.scope=0}else if(e.audience===o.e.organization){v.settings.allowAnonymousAccess=!1;v.settings.restrictShareMembership=!1;v.settings.scope=1}if(e.preventDownload){v.settings.role=u.e.restrictedview;e.sharingRole=u.e.restrictedview;v.settings.sharingLinkKind=6}if(e.audience===o.e.specificPeopleFlex||e.audience===o.e.customLabeledSpecificPeople){v.settings.restrictShareMembership=!0;v.settings.scope=2}var S=this.getDefaultRecipients();e.audience===o.e.customLabeledSpecificPeople&&S&&(v.recipients=S.recipients);if(e.isCreateOnlyLink){v.settings.role=u.e.submit;v.settings.description=e.description}this._sharingProvider.shareLink(v).done(function(t){if(t.error){d._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},d._storeContents.sharingInformation),{error:t.error,errorCategory:2,debugErrorMessage:t.debugErrorMessage,errorMessage:g.e.getSharingInformationError});E.end({resultType:b.e.Failure});d._invokeShareStatsEvent({name:"ShareLink",resultType:b.e.Failure,duration:(new Date).getTime()-m,error:t.error});d._emitChange({type:f.t.ShareLink})}else{E.end({resultType:b.e.Success});d._invokeShareStatsEvent({name:"ShareLink",resultType:b.e.Success,duration:(new Date).getTime()-m});var n=t.link;e.audience===o.e.customLabeledSpecificPeople&&(n.audience=o.e.customLabeledSpecificPeople);n.sharingLinkKind===d._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&c&&l&&(y.e.isActivated("4FE917A1-5DBE-4BEB-8145-41D71F6F3673","9/20/2018","Use Share Id to test for existing link.")?d._storeContents.sharingInformation.sharingLinks.forEach(function(e){e.audience!==n.audience||!y.e.isActivated("EC2649A7-64A3-4EDB-BB8F-71AC090528CB","9/20/2018","Scope comparison against existing share links")&&e.isEdit!==n.isEdit||e.isActive||(d._storeContents.defaultLink=n)}):0===d._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===n.shareId}).length&&(d._storeContents.defaultLink=n));if(h){d._sharingInformationInvalidated=!0;d.fetchSharingInformation(!0);d._emitChange({type:f.t.ShareLink})}else d._handleSharedLink(n,l)}})};e.prototype._invokeShareStatsEvent=function(e){var t=new w.e,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var r={mode:s.e[this._mode],clientId:a.e[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:r})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype._getDefaultLink=function(){var e,t,n=this,r=new w.e({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){i=""+new S.e(this._sharingContextInformation.webAbsoluteUrl).authority+this._sharingContextInformation.serverRelativeItemUrl}var s=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(s=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var o=this._sharingContextInformation.uniqueId;!o&&L.h()&&(o=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);(this._permissions?d.n.resolve(this._permissions):o?this._sharingService.getDefaultLinkByUniqueId(o||"",s,!0):this._sharingService.getDefaultLink(i,s,!0)).then(function(e){var t=e[0],i=t.link,s=t.roles&&t.roles.indexOf("write")>=0;r.end({resultType:b.e.Success});n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:Object(E.y)(i.scope),expiration:t.expirationDateTime,isActive:!0,isEdit:s,principals:[],shareId:t.id,sharingLinkKind:Object(E.b)(i.scope,s),url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){r.end({resultType:b.e.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:8,errorMessage:g.e.getSharingInformationError,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};n._emitChange()})};e.prototype._dedupeRecipients=function(e){var t=[];if(y.e.isActivated("57ddc052-f331-4283-9af2-51d8ed07235d","08/15/2019","Deduping ShareLink Recipients"))t=e;else{var n={};e.forEach(function(e){n[e.userId]=e});Object.keys(n).forEach(function(e){t.push(n[e])})}return t};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return!0};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.shouldInterruptCopyLink=function(e){return new d.n(function(e,t){e(!1)})};e.prototype.isPreventDownloadAllowed=function(){return!0};e.prototype.isBundleShare=function(){return!1};e.prototype.getSupportedAudienceOptions=function(){return[o.e.anyone,o.e.customLabeledSpecificPeople,o.e.existing,o.e.organization,o.e.specificPeople,o.e.specificPeopleFlex]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1};e.prototype.showAudienceLearnMore=function(){return!0};e.prototype.showEmailsInSuggestions=function(){return!1};e.prototype.getFamily=function(){return null};e.prototype.getFamilyMembers=function(){return null};e.prototype.getCurrentUserId=function(){return null};e.prototype.getItemInformationForLogging=function(){var e,t,n,r=!0,i=this.getSharingInformation();if(i.fileExtension){e=Object(k.e)(i.fileExtension);t=i.fileExtension}else if(i.sharedObjectType)e=N.e[i.sharedObjectType];else if(i.item){e=Object(k.t)(i.item);t=i.item.extension;r=i.item.itemType===C.t.File}r&&e&&"other"!==e&&(n=t);return{itemType:e,extension:n}};return e})();t.e=O},"1838":function(e,t,n){"use strict";var r=n(0),i=n(4241),s=n(150);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding-bottom:8px}[dir='ltr'] .od-AtMention li{padding-right:4px}[dir='rtl'] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:0.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;padding:16px 16px 0px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention .od-AtMention-message{margin-bottom:16px;font:-apple-system-body}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:44px;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AtMention .od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var o=n(1602),u=n(1576),a=n(1546),f=n(94),l=n(2175),c=n(1819),h=n(1394),p=n(1571),d=n(1396),v=n(352),m=n(1553),g=n(1558),y=n("react-lib"),b=n("prop-types-lib"),w=n(1581),E=n(1562),S=n(1578),x=n(1574);n.d(t,"e",function(){return T});var T=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._topLevelDivRef=y.createRef();r._onShareClicked=function(){r.setState({isSharing:!0},function(){r._store.getEngagementHelper().shareCompleted({clientId:r.props.clientId,scenarioId:r.props.scenarioId,mode:i.e.atMention});r._store.grantAccess(r.props.recipients)})};r._onOkayClicked=function(){r._notifyGrantAccessCompleted(!1);r._dismiss()};r._dismiss=n.onDismiss;r._resize=n.resize;r._store=n.sharingStore;r._platformDetection=n.platformDetection;r._shareClickTime=n.shareClickTime;var s=0===t.recipients.length;s||r._notifyReady();r.state={canShare:r._canShare(t.recipients),isLoading:s,isSharing:!1};r._resizeTracker=new x.e(n.resize);return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients();this._store.addListener(function(){var t=e._store.getGrantAccessResult();if(null!==t){e._notifyGrantAccessCompleted(t);E.t()&&e.props.onComplete&&e.props.onComplete(!!t);e._dismiss()}});this._resizeIfNeeded()};t.prototype.render=function(){var e,t=this.state,n=t.canShare,s=t.isLoading,o=t.isSharing;e=s?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath();return y.createElement("div",{ref:this._topLevelDivRef,className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!s&&y.createElement(u.e,Object(r.__assign)({},Object(p.e)(this.props),{mode:i.e.atMention,viewState:5})),e,this._renderSharingActivityIndicator(),S.e(this._getScreenReaderAlertMessage(),"assertive","alert"))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderLoadingSpinner=function(){return y.createElement("div",{className:"od-AtMention-spinnerHolder"},y.createElement(d.e,{className:"od-AtMention-spinner",label:m.e.componentLoading,type:v.t.large}))};t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return y.createElement(o.e,{message:m.e.grantAccessActivityIndicatorString})};t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=this._getHappyMessage();return y.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),y.createElement("div",{className:"od-AtMention-message"},t),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onShareClicked},m.e.shareAndNotifyButtonLabel))};t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return y.createElement("div",{className:"od-AtMention-container"},y.createElement(a.e,{messageBarType:f.e.warning},this._getSadMessage()),this._renderRecipients(!0),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onOkayClicked},m.e.okayButtonLabel))};t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e);return y.createElement("li",null,y.createElement(l.e,{className:"od-AtMention-recipient "+(n?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:c.n.extraSmall}))});return y.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":m.e.grantAccessRecipientsListLabel},n)};t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?m.e.grantAccessActivityIndicatorString:m.e.grantAccessPageLabel};t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&(!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};t.prototype._notifyReady=function(){w.l(this._shareClickTime,this.props.clientId,i.e.atMention,this.props.scenarioId,this.props.correlationId)};t.prototype._notifyReadyForRecipients=function(){w.h()};t.prototype._notifyGrantAccessCompleted=function(e){w.i(e)};t.prototype._getHappyMessage=function(){return this._store.isConsumer()?m.e.atMentionHappyMessageODC:g.u(this.props.clientId)?m.e.atMentionHappyMessageOneNote:m.e.atMentionHappyMessage};t.prototype._getSadMessage=function(){if(this._store.isConsumer())return m.e.atMentionUnresolvedErrorODC;var e=this.props.sharingInformation,t=g.u(this.props.clientId)?m.e.atMentionSadMessageOwnerOneNote:m.e.atMentionSadMessageOwner;return e.canManagePermissions&&e.canAddInternalPrincipal?m.e.atMentionSadMessageRecipient:t};t.contextTypes={onDismiss:b.func.isRequired,resize:b.func.isRequired,sharingStore:b.object.isRequired,platformDetection:b.object.isRequired,shareClickTime:b.number};return t})(y.Component)},"1840":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:6px 0;font-size:12px;font-weight:400;font:-apple-system-footnote}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir='ltr'] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir='rtl'] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir='ltr'] .od-SendLink-ITPolicy{right:0}[dir='rtl'] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons{float:right}[dir='rtl'] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir='ltr'] .od-SendLink-emailButtons-allCaps{float:right}[dir='rtl'] .od-SendLink-emailButtons-allCaps{float:left}.od-SendLink-emailButtons-left{font:-apple-system-headline}[dir='ltr'] .isFluent .od-SendLink-emailButtons-left{text-align:right}[dir='rtl'] .isFluent .od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons-rounded{float:right}[dir='rtl'] .od-SendLink-emailButtons-rounded{float:left}.od-SendLink-emailButtons-rounded .ms-Button{font:-apple-system-headline;border-radius:8px;height:54px}[dir='ltr'] .od-SendLink-emailButtons-roleSelector{float:right}[dir='rtl'] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding-bottom:30px;font-size:12px}[dir='ltr'] .od-SendLink-email .ms-TextField-field{padding-left:0px}[dir='rtl'] .od-SendLink-email .ms-TextField-field{padding-right:0px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-footnote}.isFluent .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.isFluent .od-SendLink-sendContainer{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir='ltr'] .od-SendLink-characterCounter{float:right}[dir='rtl'] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;width:100%}\n"}]);var s=n(4241),o=n(2965),u=n(1570),a=n("react-lib"),f=n("prop-types-lib"),l=n(1613),c=n(1709),h=n(1660),p=n(1553),d=n(1556),v=n(1396),m=n(352),g=n(1562),y=n(1655),b=n(1558),w=n(1574),E=n(1600),S=n(1598);n.d(t,"e",function(){return x});var x=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=a.createRef();i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=Object(d.f)(e);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{messageLength:t}));return""};i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=Object(d.f)(e);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{subjectLength:t}));return e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._platformDetection=n.platformDetection;i.state={messageLength:0,subjectLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._resizeTracker=new w.e(n.resize);return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){u.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(d.t)(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState(Object(r.__assign)({},this.state))};t.prototype.componentDidMount=function(){this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,r=u.n(n),i=u.r(n,e.groupsMemberCount),s=this._platformDetection.isIOS||b.r(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||b.t(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";s+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=this.props.showSendButton?a.createElement("div",{className:s},a.createElement(c.e,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:h.e.button,sharingInformation:this.props.sharingInformation})):"",f=e.isLoadingDefaultRecipients?a.createElement("div",null,a.createElement(v.e,{className:"od-SendLink-spinner",label:p.e.loadingRecipients,size:m.e.small})):a.createElement(l.e,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:r,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:g.n(),roleSelectorProps:this._getRoleSelectorProps()});return a.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},a.createElement("div",{className:"od-SendLink-email"},a.createElement("div",{className:"od-SendLink-peoplePicker"},f),a.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),o)))};t.prototype._getRoleSelectorProps=function(){var e=Object(d.x)(this.props.sharingInformation),t=this.props.sharingInformation.sharedObjectType===E.e.list,n=this.props.sharingInformation.sharedObjectType===E.e.list,r=1===y.e(),i=!1;e||(i=S.s(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension));return{compact:!0,shimmer:e,sharingRole:this.props.currentSettings.sharingRole,mode:s.e.share,clientId:this.props.clientId,ariaLabel:p.e.linkPermissionsRoleSelectorAriaLabel,showReview:i,showFullControl:t,showStopSharing:!1,isListSharing:n,onRoleChange:this.props.onRoleChange,showLinkSettings:r,onLinkSettingsClicked:this.props.onLinkSettingsClicked}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};t.prototype._renderTextArea=function(){if(this.props.showTextArea)return a.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&a.createElement(o.e,{borderless:!0,underlined:!0,placeholder:p.e.subjectPlaceholder,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),a.createElement(o.e,{borderless:!0,placeholder:p.e.messagePlaceholder,ariaLabel:p.e.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}))};t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t="od-SendLink-characterCounter "+(e>this.props.maximumMessageLength?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return a.createElement("div",{className:"od-SendLink-characterCounterWrapper"},a.createElement("span",{className:t},e,"/",this.props.maximumMessageLength))};t.contextTypes={platformDetection:f.object.isRequired,sharingStore:f.object.isRequired,resize:f.func.isRequired};return t})(a.Component)},"1845":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Family=0]="Family";e[e.FamilyMember=1]="FamilyMember"})(r||(r={}))},"1859":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=/[\{\}]/g,i=/\{\d+\}/g;function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=t;function o(e){var t=s[e.replace(r,"")];null==t&&(t="");return t}return e.replace(i,o)}},"1863":function(e,t,n){"use strict";var r=n(0),i=n(1628),s=n(1614),o=n(1687),u=n(1723),a=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}t.dependencies={sharingProvider:s.resourceKey,suiteNavProvider:o.resourceKey,peoplePickerProvider:i.t,policyTipProvider:u.e};return t})(n(1837).e);t.e=a},"1868":function(e,t,n){"use strict";var r=n(0),i=(n(1724),n("prop-types-lib")),s=n(150);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";min-width:320px;min-height:150px;overflow-y:auto;overflow-x:hidden}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}[dir='ltr'] .od-Share .ms-Button+.ms-Button{margin-left:6px}[dir='rtl'] .od-Share .ms-Button+.ms-Button{margin-right:6px}[dir='ltr'] .isFluent .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir='rtl'] .isFluent .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:hover,.od-Share a:focus{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-Share .od-Share-noFocusBorder:focus{outline:none;border:none}.isFluent .od-Share .ms-Button--default{outline:transparent;position:relative}.isFluent .od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .isFluent .od-Share .ms-Button--default:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .isFluent .od-Share .ms-Button--default:focus:after{border-color:ActiveBorder}}@media screen and (-ms-high-contrast: active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:'';position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{border-color:ActiveBorder}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.isFluent .od-Share .icon-Globe{color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.isFluent .od-Share .icon-Work{color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.isFluent .od-Share .icon-PeopleAdd{color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e, 0.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.isFluent .od-Share .icon-SecurityGroup{color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c, 0.06)}.od-Share .ms-Tooltip{pointer-events:none}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active){.od-Share{width:320px}.od-Share .ms-Button{overflow:visible}}button.od-Share-backButton{z-index:1;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0px;position:absolute;top:8px}[dir='ltr'] button.od-Share-backButton{left:10px}[dir='rtl'] button.od-Share-backButton{right:10px}.isFluent button.od-Share-backButton{top:12px}[dir='rtl'] button.od-Share-backButton{-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--primary,.teams .ms-Button.ms-Button--default{border-radius:3px;min-width:96px}.teams .ms-Button--default{-webkit-box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);border:1px solid rgba(37,36,36,0.15)}.teams .ms-Button--primary{-webkit-box-shadow:0 2px 2px 0 rgba(98,100,167,0.4);box-shadow:0 2px 2px 0 rgba(98,100,167,0.4)}.teams .ms-Button--primary.is-disabled{-webkit-box-shadow:none;box-shadow:none;border:none}\n"}]);var o=n(4241),u=n(2066);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}#od-ModifyPermissions-apply-id.ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}[dir='ltr'] .teams .od-ModifyPermissions{margin-right:32px}[dir='rtl'] .teams .od-ModifyPermissions{margin-left:32px}[dir='ltr'] .teams .od-ModifyPermissions{margin-left:12px}[dir='rtl'] .teams .od-ModifyPermissions{margin-right:12px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}#od-ModifyPermissions-actions-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir='ltr'] .teams .od-ModifyPermissions-actions{padding-right:0}[dir='rtl'] .teams .od-ModifyPermissions-actions{padding-left:0}.od-ModifyPermissions-section{padding:20px 0px 0 0px}.isFluent .od-ModifyPermissions-section{padding:0}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0px 20px 0px 20px}.isFluent .od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir='rtl'] .isFluent .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir='ltr'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir='rtl'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}\n"}]);var a,f=n(3927),l=n(4269),c=n(1602),h=n("react-lib"),p=n(3742),d=n(2338),v=n(2787),m=n(969),g=n(1394),y=n(20),b=n(1553);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:12px}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}.od-confirmationDialog .ms-Dialog-title{font-weight:600}[dir='ltr'] .od-confirmationDialog-discard{float:left}[dir='rtl'] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0px 4px}[dir='ltr'] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir='rtl'] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);(function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.participant=2]="participant";e[e.linkSettings=3]="linkSettings";e[e.back=4]="back";e[e.shareDialogPasswordOnly=5]="shareDialogPasswordOnly";e[e.shareDialogExpirationOnly=6]="shareDialogExpirationOnly";e[e.shareDialogPasswordAndExpiration=7]="shareDialogPasswordAndExpiration";e[e.copyInterruptUpdate=8]="copyInterruptUpdate";e[e.copyInterruptRemove=9]="copyInterruptRemove";e[e.addressBarLinkOff=10]="addressBarLinkOff"})(a||(a={}));var w=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){var e,t,n,r=this.props,i=r.confirmationCode,s=r.participant,o="od-confirmationDialog";switch(i){case a.link:e=b.e.deleteLinkDialogTitle;t=b.e.deleteLinkButtonText;n=b.e.cancelButtonText;break;case a.linkSettings:e=b.e.changeLinkSettingsDialogTitle;t=b.e.changeItButtonText;n=b.e.cancelButtonText;break;case a.participant:e=y.format(b.e.deleteLinkParticipantDialogTitle,s.name);t=b.e.removeButtonText;n=b.e.cancelButtonText;break;case a.back:e=b.e.leaveLinkSettingsDialogTitle;t=b.e.saveButtonText;n=b.e.cancelButtonText;break;case a.shareDialogPasswordOnly:e=b.e.updateLinkDialogTitle;t=b.e.useNewPasswordText;n=b.e.useExistingPasswordText;o+=" shareDialog";break;case a.shareDialogExpirationOnly:e=b.e.updateLinkDialogTitle;t=b.e.useNewExpirationText;n=b.e.useExistingExpirationText;o+=" shareDialog";break;case a.shareDialogPasswordAndExpiration:e=b.e.updateLinkDialogTitle;t=b.e.useNewSettingsText;n=b.e.useExistingSettingsText;o+=" shareDialog";break;case a.copyInterruptUpdate:e=b.e.copyInterruptUpdateTitle;t=b.e.copyInterruptContinue;n=b.e.copyInterruptOldPassword;o+=" shareDialog";break;case a.copyInterruptRemove:e=b.e.copyInterruptRemoveTitle;t=b.e.copyInterruptContinue;n=b.e.copyInterruptRemovePassword;o+=" shareDialog";break;case a.addressBarLinkOff:e=this.props.companyName?y.format(b.e.stopSharingAddressBarLinkTitleCompany,this.props.companyName):b.e.stopSharingAddressBarLinkTitle;t=b.e.stopSharing;n=b.e.cancelButtonText}return h.createElement("div",null,h.createElement(p.e,{hidden:!1,className:o,onDismiss:this.props.onCancel,dialogContentProps:{type:d.e.close,title:e,subTextId:"dialogSubtext"},modalProps:{isDarkOverlay:!0,isBlocking:!0,subtitleAriaId:"dialogSubtext"}},this._getDialogSubText(),i===a.back?h.createElement(v.e,{className:"od-confirmationDialog-footer"},h.createElement(m.e,{className:"od-confirmationDialog-discard",onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:b.e.discardButtonText}),h.createElement("div",{className:"od-confirmationDialog-saveCancel"},h.createElement(g.e,{onClick:this.props.onApply,text:t}),h.createElement(m.e,{onClick:this.props.onCancel,text:n}))):i===a.copyInterruptUpdate||i===a.copyInterruptRemove?h.createElement(v.e,null,h.createElement(g.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onApply,text:t}),h.createElement(m.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:n})):h.createElement(v.e,null,h.createElement(g.e,{onClick:this.props.onApply,text:t}),h.createElement(m.e,{onClick:this.props.onCancel,text:n}))))};t.prototype._getDialogSubText=function(){var e="";switch(this.props.confirmationCode){case a.link:return h.createElement("div",{className:"od-ConfirmationDialog-subText",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,h.createElement("strong",null,b.e.deleteLinkLeadText),b.e.deleteLinkEndText));case a.linkSettings:return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,b.e.applyLinkSettingsText));case a.participant:return;case a.shareDialogPasswordOnly:e=y.format(b.e.overwritePasswordText,this.props.linkPasswordSetBy);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.shareDialogExpirationOnly:e=y.format(b.e.overwriteExpirationText,this.props.linkExpiration);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.shareDialogPasswordAndExpiration:e=y.format(b.e.overwriteSettingsText,this.props.linkExpiration,this.props.linkPasswordSetBy);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.copyInterruptUpdate:e=b.e.copyInterruptUpdateContent;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.copyInterruptRemove:e=b.e.copyInterruptRemoveContent;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.addressBarLinkOff:e=b.e.stopSharingAddressBarLinkSubText;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e))}};return t})(h.Component),E=n(1571),S=n(1576);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:20px;height:20px}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:16px;line-height:20px;width:20px}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:20px}.od-PermissionsSettings-description{padding-bottom:10px;font-size:12px;font:-apple-system-caption2}[dir='ltr'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-right:3px}[dir='rtl'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-left:3px}.isFluent .od-PermissionsSettings-description{padding-bottom:8px;font-size:14px;font-weight:600}.od-PermissionsSettings-linksFromTemplateHeader{font-weight:400}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:14px}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none;outline:transparent;position:relative}.od-PermissionsSetting-specificPeople-list a::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-PermissionsSettings-bottomBorder{border-bottom:0}.teams .od-PermissionsSettings-bottomBorder{border:0}.teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{margin:0}[dir='ltr'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-left:20px}[dir='rtl'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-right:20px}.od-PermissionsSettings-setting{margin-bottom:8px}.isFluent .od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}[dir='ltr'] .od-PermissionsSettings-prompt{padding-right:.25em}[dir='rtl'] .od-PermissionsSettings-prompt{padding-left:.25em}.od-PermissionsSettings-learnMore{text-decoration:none;outline:transparent;position:relative;white-space:nowrap;font:-apple-system-caption2}.od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-learnMore:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir='ltr'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir='rtl'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PermissionsSettings-setting--RequireVerification{width:100%;height:32px}[dir='ltr'] .od-PermissionsSettings-setting--RequireVerification{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--RequireVerification{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification{padding-left:0}.od-RequireVerificationToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-RequireVerificationToggle .ms-Toggle{width:100%}.od-RequireVerificationToggle .ms-Toggle-slider{position:absolute;top:6px}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-slider{float:left}.od-RequireVerificationToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-RequireVerificationToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-RequireVerificationToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-RequireVerificationToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-RequireVerificationToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:left}.od-PermissionsSettings-setting--RequireVerification-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--RequireVerification-Icon{font-size:16px}.od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:32px}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--PreventDownload-Icon{font-size:16px}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--OfficeReviewMode{width:100%;height:32px}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-left:0}.od-PermissionsSettings-setting--OfficeReviewMode-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--OfficeReviewMode-Icon{font-size:16px}.od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%;outline:transparent;position:relative}.od-PermissionsSettings-wrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:300px}.od-PermissionsSettings-teachingBubbleIcon{font-size:24px;position:absolute;top:25px;z-index:1}[dir='ltr'] .od-PermissionsSettings-teachingBubbleIcon{padding-left:5px}[dir='rtl'] .od-PermissionsSettings-teachingBubbleIcon{padding-right:5px}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:50px}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-AudienceChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-weight:600}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:16px;margin-top:8px}[dir='ltr'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;margin-top:10px}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast: active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset;box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir='ltr'] .od-AudienceChoiceGroup-description{float:left}[dir='rtl'] .od-AudienceChoiceGroup-description{float:right}\n"}]);var x=n(1398),T=n(290),N=n(1707),C=n(1558),k=n(1562),L=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._firstInteractiveElement=h.createRef();r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!C.i(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||r._onRowClick(t)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}};t.prototype.componentDidMount=function(){var e=this;this._firstInteractiveElement&&this._firstInteractiveElement.current&&(this._platformDetection.isIOS?setTimeout(function(){e._firstInteractiveElement.current.focus()},100):this._firstInteractiveElement.current.focus())};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return h.createElement(x.e,{direction:T.e.vertical,onActiveElementChanged:this._onActiveElementChanged},h.createElement("div",{"aria-labelledBy":"od-PermissionsSettings-prompt-id",role:"radiogroup"},e))};t.prototype._renderItem=function(e,t){var n=e.key,r=!this._platformDetection.isFirefox,i=e.isDisabled&&e.disabledText?e.disabledText:"",s=this.state.selectedKey===n,o=this._platformDetection.isAndroid&&k.N()?t+1+" of "+this.props.items.length:"";return h.createElement(h.Fragment,null,h.createElement("button",{ref:s?this._firstInteractiveElement:void 0,role:"radio","aria-checked":s,key:n,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,n),className:this._getRowClasses(e),"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+i+" "+o,"data-key":n,tabIndex:s?0:-1},h.createElement("div",{className:"od-AudienceChoiceGroup-description"},h.createElement(N.e,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:r?i:""})),h.createElement("div",{className:"tickIcon","aria-hidden":!0})),h.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row od-Share-noFocusBorder";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e){var t=this.props;this.setState({selectedKey:e});t.onChange(e);t.onAudienceChange(e)};t.contextTypes={platformDetection:i.object.isRequired};return t})(h.Component),A=n(111),O=n(2122),M=n(4514);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:32px}.od-ExpirationDatePicker-content{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-ExpirationDatePicker-content{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content:hover,.od-ExpirationDatePicker-content-expired:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:28px;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-right:14px}[dir='rtl'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-left:14px}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:transparent}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content .ms-TextField-errorMessage,.od-ExpirationDatePicker-content-expired .ms-TextField-errorMessage{display:none}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:20px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}[dir='ltr'] .od-ExpirationDatePicker-label{margin-right:8px}[dir='rtl'] .od-ExpirationDatePicker-label{margin-left:8px}.isFluent .od-ExpirationDatePicker-label{font-size:16px}[dir='ltr'] .isFluent .od-ExpirationDatePicker-label{margin-right:12px}[dir='rtl'] .isFluent .od-ExpirationDatePicker-label{margin-left:12px}.od-ExpirationDatePicker-info{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ExpirationDatePicker-info{margin-left:auto}[dir='rtl'] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:12px}[dir='ltr'] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker-delete{background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;line-height:0px;padding:0px;height:16px;outline:transparent;position:relative}[dir='ltr'] .od-ExpirationDatePicker-delete{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-delete{margin-right:10px}.od-ExpirationDatePicker-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{border-color:ActiveBorder}}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ExpirationDatePicker-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-premiumGleam{height:12px;margin-top:2px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir='ltr'] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir='rtl'] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}.od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}.od-ExpirationDatePicker-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{border-color:ActiveBorder}}\n"}]);var _=n(835),D=n(650),P=n(346),H=n(505),B=n(418),j=n(149),F=n(38),I=n(1915),q=n(1681),R=n(1235),U=n(115),z=n(2965),W=n(1918),X=n(1536),V=Object(P.e)(),$={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",prevYearRangeAriaLabel:"Previous year range",nextYearRangeAriaLabel:"Next year range",closeButtonAriaLabel:"Close date picker",weekNumberFormatString:"Week number {0}"},J=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._calendar=h.createRef();n._datePickerDiv=h.createRef();n._textField=h.createRef();n._onSelectDate=function(e){var t=n.props,r=t.formatDate,i=t.onSelectDate;n.props.calendarProps&&n.props.calendarProps.onSelectDate&&n.props.calendarProps.onSelectDate(e);n.setState({selectedDate:e,formattedDate:r&&e?r(e):""});i&&i(e);n._calendarDismissed()};n._onCalloutPositioned=function(){var e=!0;n.props.calloutProps&&void 0!==n.props.calloutProps.setInitialFocus&&(e=n.props.calloutProps.setInitialFocus);n._calendar.current&&e&&n._calendar.current.focus()};n._onTextFieldFocus=function(e){n.props.disableAutoFocus||n.props.allowTextInput||(n._preventFocusOpeningPicker?n._preventFocusOpeningPicker=!1:n._showDatePickerPopup())};n._onTextFieldBlur=function(e){n._validateTextInput()};n._onTextFieldChanged=function(e,t){var r=n.props,i=r.allowTextInput,s=r.textField;if(i){n.state.isDatePickerShown&&n._dismissDatePickerPopup();var o=n.props,u=o.isRequired,a=o.strings;n.setState({errorMessage:u&&!t?a.isRequiredErrorMessage||" ":void 0,formattedDate:t})}s&&s.onChange&&s.onChange(e,t)};n._onTextFieldKeyDown=function(e){switch(e.which){case A.e.enter:e.preventDefault();e.stopPropagation();if(n.state.isDatePickerShown)n.props.allowTextInput&&n._dismissDatePickerPopup();else{n._validateTextInput();n._showDatePickerPopup()}break;case A.e.escape:n._handleEscKey(e)}};n._onTextFieldClick=function(e){n.props.disableAutoFocus||n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n._dismissDatePickerPopup():n._showDatePickerPopup()};n._onIconClick=function(e){e.stopPropagation();n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n._dismissDatePickerPopup():n._showDatePickerPopup()};n._dismissDatePickerPopup=function(){n.state.isDatePickerShown&&n.setState({isDatePickerShown:!1},function(){n._validateTextInput()})};n._calendarDismissed=function(){n._preventFocusOpeningPicker=!0;n._dismissDatePickerPopup()};n._handleEscKey=function(e){n.state.isDatePickerShown&&e.stopPropagation();n._calendarDismissed()};n._validateTextInput=function(){var e=n.props,t=e.isRequired,r=e.allowTextInput,i=e.strings,s=e.parseDateFromString,o=e.onSelectDate,u=e.formatDate,a=e.minDate,f=e.maxDate,l=n.state.formattedDate;if(!n.state.isDatePickerShown)if(r){var c=null;if(l){if(n.state.selectedDate&&!n.state.errorMessage&&u&&u(n.state.selectedDate)===l)return;if(!(c=s(l))||isNaN(c.getTime())){if(u){c=n.state.selectedDate;n.setState({formattedDate:u(c).toString()})}n.setState({errorMessage:i.invalidInputErrorMessage||" "})}else if(n._isDateOutOfBounds(c,a,f))n.setState({errorMessage:i.isOutOfBoundsErrorMessage||" "});else{n.setState({selectedDate:c,errorMessage:""});u&&u(c)!==l&&n.setState({formattedDate:u(c).toString()})}}else n.setState({errorMessage:t?i.isRequiredErrorMessage||" ":""});o&&o(c)}else t&&!l?n.setState({errorMessage:i.isRequiredErrorMessage||" "}):n.setState({errorMessage:""})};Object(H.e)(n);n.state=n._getDefaultState();n._id=t.id||Object(B.e)("DatePicker");n._preventFocusOpeningPicker=!1;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.formatDate,n=e.value;if(!(Object(W.s)(this.props.minDate,e.minDate)&&Object(W.s)(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&Object(W.s)(this.state.selectedDate,n)&&this.props.formatDate===t)){this._setErrorMessage(!0,e);this._id=e.id||this._id;var r=this.state.selectedDate;Object(W.s)(r,n)&&this.props.formatDate===t||this.setState({selectedDate:n||void 0,formattedDate:t&&n?t(n):""})}};t.prototype.componentDidUpdate=function(e,t){t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss&&this.props.onAfterMenuDismiss()};t.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,n=e.strings,i=e.label,s=e.theme,o=e.className,u=e.styles,a=e.initialPickerDate,f=e.isRequired,l=e.disabled,c=e.ariaLabel,p=e.pickerAriaLabel,d=e.placeholder,v=e.allowTextInput,m=e.borderless,g=e.minDate,y=e.maxDate,b=e.showCloseButton,w=e.calendarProps,E=e.calloutProps,S=e.textField,x=e.underlined,T=e.allFocusable,N=e.calendarAs,C=void 0===N?I.e:N,k=e.tabIndex,L=this.state,A=L.isDatePickerShown,O=L.formattedDate,M=L.selectedDate,_=V(u,{theme:s,className:o,disabled:l,label:!!i,isDatePickerShown:A}),D=Object(B.e)("DatePicker-Callout"),P=Object(j.u)(this.props,j.s,["value"]),H=S&&S.iconProps;return h.createElement("div",Object(r.__assign)({},P,{className:_.root}),h.createElement("div",{ref:this._datePickerDiv,"aria-haspopup":"true","aria-owns":A?D:void 0,className:_.wrapper},h.createElement(z.e,Object(r.__assign)({role:"combobox",label:i,"aria-expanded":A,ariaLabel:c,"aria-controls":A?D:void 0,required:f,disabled:l,errorMessage:this._getErrorMessage(),placeholder:d,borderless:m,value:O,componentRef:this._textField,underlined:x,tabIndex:k,readOnly:!v},S,{id:this._id+"-label",className:Object(F.e)(_.textField,S&&S.className),iconProps:Object(r.__assign)(Object(r.__assign)({iconName:"Calendar"},H),{className:Object(F.e)(_.icon,H&&H.className),onClick:this._onIconClick}),onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChange:this._onTextFieldChanged}))),A&&h.createElement(R.e,Object(r.__assign)({id:D,role:"dialog",ariaLabel:p,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:U.e.bottomLeftEdge},E,{className:Object(F.e)(_.callout,E&&E.className),onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned}),h.createElement(X.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus,forceFocusInsideTrap:!1},h.createElement(C,Object(r.__assign)({},w,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:M||a,firstDayOfWeek:t,strings:n,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:g,maxDate:y,componentRef:this._calendar,showCloseButton:b,allFocusable:T})))))};t.prototype.focus=function(){this._textField.current&&this._textField.current.focus()};t.prototype.reset=function(){this.setState(this._getDefaultState())};t.prototype._setErrorMessage=function(e,t){var n=t||this.props,r=n.isRequired,i=n.strings,s=n.value,o=n.minDate,u=n.maxDate,a=n.initialPickerDate||!r||s?void 0:i.isRequiredErrorMessage||" ";!a&&s&&(a=this._isDateOutOfBounds(s,o,u)?i.isOutOfBoundsErrorMessage||" ":void 0);e&&this.setState({errorMessage:a});return a};t.prototype._showDatePickerPopup=function(){if(!this.state.isDatePickerShown){this._preventFocusOpeningPicker=!0;this.setState({isDatePickerShown:!0})}};t.prototype._getDefaultState=function(e){void 0===e&&(e=this.props);return{selectedDate:e.value||void 0,formattedDate:e.formatDate&&e.value?e.formatDate(e.value):"",isDatePickerShown:!1,errorMessage:this._setErrorMessage(!1)}};t.prototype._isDateOutOfBounds=function(e,t,n){return!!t&&Object(W.i)(t,e)>0||!!n&&Object(W.i)(n,e)<0};t.prototype._getErrorMessage=function(){if(!this.state.isDatePickerShown)return this.state.errorMessage};t.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:q.t.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:$,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:q.n.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0,showCloseButton:!1,underlined:!1,allFocusable:!1};return t})(h.Component),K=n(22),Q={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "},G=Object(D.e)(J,function(e){var t=e.className,n=e.theme,r=e.disabled,i=e.label,s=e.isDatePickerShown,o=n.palette,u=n.semanticColors,a=n.effects,f=n.fonts,l=Object(K.N)(Q,n),c={color:o.neutralSecondary,fontSize:f.mediumPlus.fontSize,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"4px",padding:"5px"};return{root:[l.root,n.fonts.medium,s&&"is-open",K.I,t],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},r&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[l.callout,{boxShadow:a.elevation8}],icon:[c,i?l.withLabel:l.withoutLabel,{paddingTop:"7px"},!r&&[l.disabled,{pointerEvents:"initial",cursor:"pointer"}],r&&{color:u.disabledText,cursor:"default"}]}},void 0,{scope:"DatePicker"}),Y=n(600),Z=n(1556),ee=n(1410),te=G,ne=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._dateRemovedStatus=h.createRef();r._onSelectDateForExpirationPicker=function(e){r._expirationDateRemoved=!1;var t=e<new Date(Date.now());r._focusDatePicker();r.setState({hasExpired:t,selectedDate:e});r.props.onSelectDate(e)};r._onDeleteDate=function(){r._expirationDateRemoved=!0;r.setState({selectedDate:null},function(){r.props.onSelectDate(null)})};r._formatDate=function(e){if(e){var t=e.getDay(),n=e.getMonth();return r._datePickerStrings.days[t]+" "+r._datePickerStrings.shortMonths[n]+" "+e.getDate()+" "+e.getFullYear()}return""};var i=r.props.value<new Date(Date.now());r.state={hasExpired:i,selectedDate:null};r._platformDetection=n.platformDetection;var s=new Date(Date.now());r._minDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());t.expiryRestriction>0?r._maxDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+t.expiryRestriction,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()):r._maxDate=new Date(s.getFullYear()+2,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());r._isMobile=r._platformDetection.isMobile||C.i(r.props.clientId);r._datePickerStrings={months:Z.T,shortMonths:Z.C,days:Z.s,shortDays:Z.N,goToToday:b.e.goToToday,setExpirationDate:b.e.setExpirationDate,nextMonthAriaLabel:b.e.nextMonthAriaLabel,prevMonthAriaLabel:b.e.prevMonthAriaLabel,ariaLabel:r._formattedExpirationDateAriaLabel(),pickerAriaLabel:b.e.expirationDatePickerAriaLabel,closeButtonAriaLabel:r._isMobile&&b.e.calendarCloseButton||""};return r}t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired;this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel();return h.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},h.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},h.createElement(Y.e,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"})),h.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":"")},this._renderExpiresLabel(),h.createElement(te,{componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex,onAfterMenuDismiss:this._focusDatePicker.bind(this)}),this._renderExpirationDateRemovedLabel(),this._renderRemoveDateButton()),this._renderPremiumGleam())};t.prototype._renderExpirationDateRemovedLabel=function(){if(this._expirationDateRemoved)return h.createElement("div",{ref:this._dateRemovedStatus,className:"od-Share-screenReaderOnly",tabIndex:-1,role:"alert","aria-live":"assertive","aria-hidden":!0},b.e.expirationDateRemoved)};t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return h.createElement("span",{className:e,role:"status","aria-live":"polite"},this.state.hasExpired?b.e.expired:b.e.expires)}};t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=y.format(b.e.expirationDateToolTip,this.props.expiryRestriction);return h.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},h.createElement(ee.e,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",content:t,directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}return h.createElement(ee.e,{content:b.e.removeExpirationLabel,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},h.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":b.e.removeExpirationLabel},h.createElement(Y.e,{iconName:"Cancel","aria-hidden":!0})))}};t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?y.format(b.e.expirationDateValueAriaLabel,""):b.e.setExpirationDate};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?h.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-ExpirationDatePicker-premiumGleam"}):void 0};t.prototype._focusDatePicker=function(){this._platformDetection.isIE||this._datePicker.focus()};t.contextTypes={platformDetection:i.object.isRequired};return t})(_.e);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:32px;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-PasswordField .od-ShareLink-passwordFieldContent{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input::-webkit-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-moz-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-ms-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:28px;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:transparent}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:28px;min-width:0;width:100%;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-PasswordField-delete{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-PasswordField-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{border-color:ActiveBorder}}.od-PasswordField-label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:7px}[dir='ltr'] .od-PasswordField-label{margin-right:8px}[dir='rtl'] .od-PasswordField-label{margin-left:8px}.isFluent .od-PasswordField-label{font-size:16px}[dir='ltr'] .isFluent .od-PasswordField-label{margin-right:12px}[dir='rtl'] .isFluent .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:12px}[dir='ltr'] .od-PasswordField-shareReminder{padding-left:22px}[dir='rtl'] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:12px}[dir='ltr'] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir='rtl'] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PermissionsSettings-delete{outline:transparent;position:relative;background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;line-height:0px;padding:0px}.od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-PermissionsSettings-delete{margin-left:auto}[dir='rtl'] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:12px;margin-top:12px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir='ltr'] .od-PasswordField-premiumGleam{padding-right:5px}[dir='rtl'] .od-PasswordField-premiumGleam{padding-left:5px}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink .od-ShareLink-main{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";min-width:54px;margin:0;padding:0}.od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-left:0px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}[dir='rtl'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-right:0px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;min-width:50px;height:50px}[dir='ltr'] .od-ShareLink-icon{margin-right:10px}[dir='rtl'] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon i{left:50%}[dir='rtl'] .od-ShareLink-icon i{right:50%}[dir='ltr'] .od-ShareLink-icon i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:17px;border-style:solid;border-width:1px;border-radius:50%;-webkit-box-sizing:border-box;box-sizing:border-box;width:32px;min-width:32px;height:32px}[dir='ltr'] .od-ShareLink-icon2{margin-right:10px}[dir='rtl'] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon2 i{left:50%}[dir='rtl'] .od-ShareLink-icon2 i{right:50%}[dir='ltr'] .od-ShareLink-icon2 i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon2 i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLink-icon2.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLink-icon2.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLink-icon2.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLink-icon2.icon-FileRequest{color:#333333;background:white;border:white;font-size:20px}.od-ShareLink-icon2.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLink-icon2.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLink-details{-webkit-box-flex:1;-ms-flex:1;flex:1}.od-ShareLink-actionButton{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-ShareLink-actionButton::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{border-color:ActiveBorder}}.od-ShareLink-description{padding-top:8px;font-size:12px}[dir='ltr'] .od-ShareLink-description{padding-left:42px}[dir='rtl'] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir='ltr'] .od-ShareLink-description.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink-description.flightOff{padding-right:60px}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:11px}[dir='ltr'] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir='rtl'] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}.od-ShareLink--inviteesHolder{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;outline:transparent;position:relative}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-left:42px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-right:42px}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-right:38px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-left:38px}.od-ShareLink--inviteesHolder::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:12px;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:12px}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:'';background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:block;height:7px}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink-personaItem{padding:18px 8px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:15px;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:11px;color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:";font:-apple-system-caption1}.od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative;font-size:12px}.od-ShareLink-personaItem .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ShareLink-linkMember{outline:transparent;position:relative}.od-ShareLink-linkMember::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{border-color:ActiveBorder}}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .od-PasswordStrengthMeter{padding-left:6px}[dir='rtl'] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var re=n(1955),ie=[b.e.passwordStrengthMeterStrengthLevel0,b.e.passwordStrengthMeterStrengthLevel1,b.e.passwordStrengthMeterStrengthLevel2,b.e.passwordStrengthMeterStrengthLevel3,b.e.passwordStrengthMeterStrengthLevel4],se=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n);n._renderStrengthText=n._renderStrengthText.bind(n);n._renderStrengthBar=n._renderStrengthBar.bind(n);return n}t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=y.format(b.e.currentStrength,ie[e]);this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(ie[e]);return h.createElement("div",{className:"od-PasswordStrengthMeter"},h.createElement(ee.e,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return h.createElement("div",null,h.createElement("ul",{style:{margin:0,padding:0}},h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},b.e.passwordStrengthMeterStrengthExplanation1," ",h.createElement("br",null)),b.e.passwordStrengthMeterStrengthExplanation2," ",h.createElement("br",null),b.e.passwordStrengthMeterStrengthExplanation3," ",h.createElement("br",null),b.e.passwordStrengthMeterStrengthExplanation4))}}},h.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))};t.prototype._renderStrengthText=function(e){var t=ie[e];return h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText",role:"status","aria-live":"assertive"},h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},b.e.passwordStrengthMeterStrengthBarText),h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))};t.prototype._renderStrengthBar=function(e){var t=ie[e];return h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},h.createElement(re.e,{percentComplete:.25*e,barHeight:4}))};t.prototype._calculatePasswordStrength=function(e){var t=0;e.length>8&&t++;/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++;/\d/.test(e)&&t++;/[^A-Za-z0-9]/g.test(e)&&t++;return t};return t})(h.Component),oe=n(1574),ue=n(1387),ae=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._currentStrengthMeterValue="";i._topLevelDiv=h.createRef();i._onUpdatePassword=function(e,t){void 0===t&&(t="");var n=t.length>0;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{currentPassword:t,displayRemovePasswordButton:n&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})};if(i.props.detailsPane){i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}}else i.state=Object(r.__assign)(Object(r.__assign)({},i.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1});i._renderShareReminder=i._renderShareReminder.bind(i);i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i);i._onFocusPasswordField=i._onFocusPasswordField.bind(i);i._onBlurPasswordField=i._onBlurPasswordField.bind(i);i._onDeletePassword=i._onDeletePassword.bind(i);i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i);i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i);i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidUpdate=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDiv)};t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel();return h.createElement("div",{ref:this._topLevelDiv,className:"od-PasswordField"},h.createElement("div",{className:"od-PasswordField-passwordFieldLine"},h.createElement("div",{className:"od-PasswordField-label"},h.createElement(Y.e,{iconName:"Lock"})),h.createElement("div",{className:"od-ShareLink-passwordFieldContent"},h.createElement(z.e,{type:"password",autoComplete:"off",disabled:this.state.disablePasswordField,placeholder:b.e.setPasswordFieldText,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText"})),this.state.displayRemovePasswordButton&&h.createElement(ue.e,{"data-is-focusable":!0,className:"od-PasswordField-delete",iconProps:{iconName:"Cancel"},ariaLabel:b.e.removePassword,onClick:this._onDeletePassword}),this._renderPremiumGleam()),this._renderShareReminder())};t.prototype._renderShareReminder=function(){var e,t="od-PasswordField-shareReminder";this.props.detailsPane&&(t+="-detailsPane");this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane&&(e=h.createElement("div",{className:"odPasswordField-lastModifiedBy"},b.e.passwordFieldPasswordSetBy+this.props.lastModifiedBy)):e=this.state.currentPassword.length>0?h.createElement(se,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue}):h.createElement("div",null,b.e.passwordFieldShareReminder):e=h.createElement("div",null,"");return h.createElement("div",{className:t,id:"shareReminderText"},e)};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?h.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-PasswordField-premiumGleam"}):void 0};t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._onFocusPasswordField=function(){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{displayNotificationText:!0}))};t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{displayNotificationText:!1}))};t.prototype._onDeletePassword=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._getPasswordFieldAriaLabel=function(){return this.state.currentPassword.length>0?y.format(b.e.currentStrength,this._currentStrengthMeterValue):b.e.passwordFieldName};t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e};t.contextTypes={resize:i.func.isRequired};return t})(h.Component),fe=n(1636),le=n(1612),ce=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onAllowRoleChange=function(e){r.setState({selectedRole:e},function(){r.props.onRoleChange(e)})};r.state={selectedRole:r._getSelectedKey(t)};return r}t.prototype.render=function(){var e=this.props;return h.createElement(le.e,{compact:!1,disabled:e.canChangePermission,sharingRole:this.state.selectedRole,mode:e.mode,clientId:e.clientId,ariaLabel:b.e.linkPermissionsRoleSelectorAriaLabel,onRoleChange:this._onAllowRoleChange,showReview:e.showReview},e.canChangePermission&&this._renderInfoIcon())};t.prototype._getSelectedKey=function(e){return e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?l.e.edit:l.e.view};t.prototype._renderInfoIcon=function(){return h.createElement("div",{className:"od-changePermissions--info","aria-label":b.e.createNewLinkTooltip,"aria-haspopup":!0},h.createElement(ee.e,{id:"od-changePermissions--tooltip",content:b.e.createNewLinkTooltip,directionalHint:U.e.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"320px"}},h.createElement(Y.e,{iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))};return t})(h.Component),he=n(1570),pe=n(1598),de=n(1613);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:6px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:12px}[dir='ltr'] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}.od-preventDownload-tooltipWrapper{outline:transparent;position:relative}.od-preventDownload-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var ve,me=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={preventDownloadToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled,n=!this.props.detailsPane&&this.props.disablePreventDownload,i=n?this.props.isRolesDropDown?y.format(b.e.preventDownloadInfoIconRoleDropDown,b.e.canViewRole):y.format(b.e.preventDownloadInfoIcon,b.e.allowEditLabel):b.e.preventDownloadLabel;this.props.detailsPane&&(t=!0);return h.createElement("div",{className:"od-PreventDownloadToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"Blocked2"},{alt:b.e.imageAltPreventDownloadIcon}))),h.createElement(M.e,{checked:t,disabled:e,"aria-disabled":e,label:b.e.preventDownloadLabel,ariaLabel:i,onChanged:this._onChanged,className:t?"isToggled":"",role:"checkbox"}),n&&h.createElement("div",{className:"od-PreventDownloadToggle--info"},h.createElement(ee.e,{hostClassName:"od-preventDownload-tooltip",content:i,directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement("div",{tabIndex:0,className:"od-preventDownload-tooltipWrapper"},h.createElement("div",{className:"od-preventDownload-hidden"},i),h.createElement(Y.e,{"aria-hidden":"true",iconName:"Info",className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),ge=n(2104),ye={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},be={"3fr":1,"3mf":1,ai:1,ari:1,arw:1,avci:1,avcs:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m4a:1,mat:1,mef:1,mos:1,mp3:1,mp4:1,mrw:1,msg:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webp:1,wma:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},we=n(107),Ee={ODB:1768};(function(e){e[e.None=0]="None";e[e.AllowMediaTA=1]="AllowMediaTA";e[e.OfficeOnly=2]="OfficeOnly"})(ve||(ve={}));Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-OfficeReviewModeToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-OfficeReviewModeToggle .ms-Toggle{width:100%}.od-OfficeReviewModeToggle .ms-Toggle-slider{position:absolute;top:6px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:left}.od-OfficeReviewModeToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-OfficeReviewModeToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-OfficeReviewModeToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:left}.od-OfficeReviewModeToggle-learnMore{text-decoration:none;outline:transparent;position:relative;margin:0px 3px;white-space:nowrap;font:-apple-system-caption2}.od-OfficeReviewModeToggle-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-learnMore:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:12px}[dir='ltr'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-right:10px}.od-OfficeReviewMode-tooltipWrapper{outline:transparent;position:relative}.od-OfficeReviewMode-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewMode-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewMode-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-OfficeReviewModeToggle-tooltipWrapper{display:inline;outline:transparent;position:relative}.od-OfficeReviewModeToggle-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var Se=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={OfficeReviewModeToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disableOfficeReviewMode,t=this.props.isToggled,n=!this.props.detailsPane&&this.props.disableOfficeReviewMode,i=n?y.format(b.e.officeReviewModeInfoIcon,b.e.allowEditLabel):b.e.officeReviewModeLabel;return h.createElement("div",{className:"od-OfficeReviewModeToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"Feedback"},{alt:b.e.imageAltOfficeReviewModeIcon}))),h.createElement(M.e,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:h.createElement(h.Fragment,null,b.e.officeReviewModeLabel," ",!n&&h.createElement(ee.e,{hostClassName:"od-OfficeReviewMode-tooltip",directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"},content:h.createElement(h.Fragment,null,b.e.officeReviewModeHint," ",h.createElement("a",{className:"od-OfficeReviewModeToggle-learnMore","aria-label":b.e.learnMoreLabel+": "+b.e.officeReviewModeLabel,href:"https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07",target:"_blank"},b.e.learnMoreLabel))},h.createElement("div",{tabIndex:0,className:"od-OfficeReviewModeToggle-tooltipWrapper"},h.createElement(Y.e,{iconName:"Info","aria-label":b.e.officeReviewModeHint})))),ariaLabel:i,onChanged:this._onChanged}),n&&h.createElement("div",{className:"od-OfficeReviewModeToggle--info","aria-label":i},h.createElement(ee.e,{hostClassName:"od-OfficeReviewMode-tooltip",content:i,directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement("div",{tabIndex:0,className:"od-OfficeReviewMode-tooltipWrapper"},h.createElement("div",{className:"od-OfficeReviewMode-hidden","aria-label":i},i),h.createElement(Y.e,{"aria-hidden":"true",iconName:"Info",className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("OfficeReviewMode.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({OfficeReviewModeToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-LinkTemplateChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-LinkTemplateChoiceGroup-row{padding-right:0}.teams .od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{font-weight:700}.od-LinkTemplateChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-LinkTemplateChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-LinkTemplateChoiceGroup-row .od-ShareHintDetail{padding-top:2px}.od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-weight:600}.od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:16px;margin-top:8px}[dir='ltr'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;margin-top:10px}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareHintDetail-statusText{color:#a19f9d}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast: active){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset;box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.teams .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.od-LinkTemplateChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir='ltr'] .od-LinkTemplateChoiceGroup-description{float:left}[dir='rtl'] .od-LinkTemplateChoiceGroup-description{float:right}\n"}]);var xe=n(938),Te=n(1708),Ne=n(1599),Ce=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!C.i(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=e.getAttribute("data-key");"true"===e.getAttribute("aria-disabled")||r._onRowClick(t,null)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}return null};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return h.createElement("div",{"aria-label":b.e.permissionsSettingsHeader,role:"radiogroup"},h.createElement(x.e,{direction:T.e.vertical,defaultActiveElement:".od-LinkTemplateChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};t.prototype._renderItem=function(e){var t=e.key,n=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===t,i=fe.e[e.permissionsType],s=e.iconUrl?h.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:e.iconUrl,alt:e.label}):h.createElement(Y.e,{"aria-hidden":"true",iconName:i});return h.createElement("div",{key:t},h.createElement("button",{role:"radio","aria-checked":r,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:r,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+n,"data-key":t},h.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":r?y.format(b.e.audienceSelectedStatus,e.label):"",className:"od-Share-screenReaderOnly"},r?y.format(b.e.audienceSelectedStatus,e.label):""),h.createElement("div",{className:"od-LinkTemplateChoiceGroup-description"},h.createElement("div",{className:"od-ShareLinkDescription"},h.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+i,"aria-hidden":"true"},s),this._renderLabel(e))),h.createElement("div",{className:"tickIcon","aria-hidden":!0})),h.createElement("div",{className:"od-LinkTemplateChoiceGroup-bottomBorder"}))};t.prototype._renderLabel=function(e){var t=e.isDisabled&&e.disabledText?e.disabledText:"";t&&h.createElement(Te.e,{message:t});return h.createElement("div",{className:"od-ShareHintDetail"},h.createElement("div",{className:"od-ShareHintDetail-description"},h.createElement("div",{className:"od-ShareHintDetail-status"},h.createElement("span",{className:"od-ShareHintDetail-statusText"},e.label),this._renderStatusIcons(e.link))))};t.prototype._renderStatusIcons=function(e){if(e){var t=e.expiration,n=e.hasPassword,r=e.blockDownload,i=[];t&&t.getTime()!==new Date(0).getTime()&&i.push({icon:"Calendar",tooltip:""+y.format(b.e.expiresIn2,Object(xe.s)(t))});n&&i.push({icon:"Lock",tooltip:b.e.sharePasswordReminderText});r&&i.push({icon:"Blocked2",tooltip:b.e.preventDownloadHint});e.audience!==f.e.existing&&e.isReview&&Ne.t[this.props.sharingInformation.fileExtension]&&i.push({icon:"Feedback",tooltip:b.e.officeReviewModeHint});var s=i.map(function(e,t){return h.createElement("i",{className:"od-ShareHintDetail-item"},h.createElement(ee.e,{content:e.tooltip,id:e.icon},h.createElement(Y.e,{iconName:e.icon,"aria-describedby":e.icon})))});return h.createElement("div",{className:"od-ShareHintDetail-iconsList"},s)}};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-LinkTemplateChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e});n.onChange(e);n.onLinkTemplateChange(e)};t.contextTypes={platformDetection:i.object.isRequired};return t})(h.Component),ke=n(1655),Le=(function(e){Object(r.__extends)(t,e);function t(t,n){var i,s,o=e.call(this,t)||this;o._allowEditCheckbox=Object(h.createRef)();o._pickerUpsellDiv=Object(h.createRef)();o._passwordUpsellDiv=Object(h.createRef)();o._firstInteractiveElement=h.createRef();o._learnMoreClicked=function(){o.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(o.props.engagementExtraData)};o._onPeoplePickerChange=function(e){o.setState(Object(r.__assign)(Object(r.__assign)({},o.state),{externalRecipientWarning:he.n(e),groupRecipientWarning:he.r(e,o.props.groupsMemberCount)}),function(){o.props.onPeoplePickerChange(e)})};o._setSpecificPeopleReadOnlyExpanded=function(){o.setState({isSpecificPeopleReadOnlyExpanded:!0})};o._onAllowRoleChange=function(e){var t=!1,n=!1;e===l.e.edit&&(t=!0);e===l.e.review&&(n=!0);o.setState(Object(r.__assign)(Object(r.__assign)({},o.state),{preventDownloadDisabled:t||n}),function(){o.props.onRoleChange(e)})};o._onResolvedSuggestions=function(e){o.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(o.props.engagementExtraData,e);return e};o._resize=n.resize;var u=t.selectedPermissions.specificPeople;o.state={expirationErrorCode:Z.e.none,externalRecipientWarning:he.n(u),groupRecipientWarning:he.r(u,t.groupsMemberCount),preventDownloadDisabled:o.props.selectedPermissions.isEdit||o.props.selectedPermissions.isReview,officeReviewModeDisabled:!1===o.props.selectedPermissions.isEdit&&!1===o.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1};o._onAllowEditChange=o._onAllowEditChange.bind(o);o._onChoiceGroupChange=o._onChoiceGroupChange.bind(o);o._onLinkTemplateChoiceChange=o._onLinkTemplateChoiceChange.bind(o);o._onSelectDate=o._onSelectDate.bind(o);o._renderExpirationDatePicker=o._renderExpirationDatePicker.bind(o);o._renderExpirationDatePickerErrorMessage=o._renderExpirationDatePickerErrorMessage.bind(o);o._renderPeoplePicker=o._renderPeoplePicker.bind(o);o._permissionsOptions=o._getAudienceChoiceGroupOptions();o._linkTemplateOptions=o._getLinkTemplateOptions();o._supportedAudienceOptions=n.sharingStore.getSupportedAudienceOptions();o._hiddenAudienceOptions=(null===(i=t.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[];o._disabledAudienceOptions=(null===(s=t.hostOptions)||void 0===s?void 0:s.disabledAudienceOptions)||[];o._platformDetection=n.platformDetection;return o}t.prototype.componentDidMount=function(){var e=this;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();if(this._disablePremiumFeatures){if(this._pickerUpsellDiv.current){this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()});this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==A.e.enter&&t.keyCode!==A.e.space||e._togglePickerTeachingBubble()})}if(this._passwordUpsellDiv.current){this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()});this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==A.e.enter&&t.keyCode!==A.e.space||e._togglePasswordTeachingBubble()})}}var t,n,r=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];if(r){t=r.getElementsByClassName("ms-Checkbox-text")[0];n=r.children[0]}t&&t.setAttribute("aria-hidden","true");if(n){n.setAttribute("aria-label",b.e.allowEditLabel);this.context.sharingStore.isPremiumExperienceAllowed()||n.focus()}};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype.render=function(){var e=this.props;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();return this._getLinkTemplateOptions().length>0?h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},h.createElement("span",{className:"od-PermissionsSettings-linksFromTemplateHeader"},b.e.linksFromTemplateHeader)),h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),h.createElement(Ce,{items:this._getLinkTemplateOptions(),onChange:this._onLinkTemplateChoiceChange,onLinkTemplateChange:e.onLinkTemplateChange,companyName:e.companyName,clientId:e.clientId,sharingInformation:e.sharingInformation}),this._renderPeoplePicker())):this._getAudienceOptions().length>1?h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},h.createElement("span",{className:"od-PermissionsSettings-prompt",id:"od-PermissionsSettings-prompt-id"},b.e.permissionsSettingsHeader),this.context.sharingStore.showAudienceLearnMore()&&h.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-label":b.e.learnMoreLabel+": "+b.e.permissionsSettingsHeader,href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked,tabIndex:0},b.e.learnMoreLabel)),h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),h.createElement(L,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId}),this._renderPeoplePicker()),this._renderOtherSettings()):h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"})),this._renderOtherSettings())};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,n=e.selectedPermissions,i=n.specificPeople;0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:Object(Z.c)(n.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:he.n(i),groupRecipientWarning:he.r(i,e.groupsMemberCount),preventDownloadDisabled:n.isEdit||n.isReview,officeReviewModeDisabled:!n.isEdit&&!n.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})};t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})};t.prototype._renderOtherSettings=function(){if(this.props.selectedPermissions.audience!==f.e.existing&&!this.props.sharingInformation.requiresAccessApproval)return h.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},h.createElement("div",{className:"od-PermissionsSettings-description"},b.e.otherSettings),h.createElement("div",{role:"group","aria-label":b.e.otherSettings},h.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),this._renderPasswordField(),this._renderPreventDownloadToggle()))};t.prototype._getSpecificPeopleOption=function(){var e=this.props.sharingInformation.requiresAccessApproval,t=e?b.e.permissionsRequestAccessString:this._getSpecificPeopleLabel(),n=!this.props.createPeopleSharingLinks||e?[1]:[6],r=this.props.createPeopleSharingLinks?f.e.specificPeopleFlex:f.e.specificPeople;return{disabledText:b.e.disabledAudienceChoiceLabel2,icon:fe.e[2],isChecked:!1,isDisabled:!1,key:r,label:t,linkKinds:n,permissionsType:2}};t.prototype._getAudienceChoiceGroupOptions=function(){var e=[{disabledText:b.e.disabledAudienceChoiceLabel2,icon:fe.e[0],isChecked:!1,isDisabled:!1,key:f.e.anyone,label:b.e.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0},{disabledText:b.e.disabledAudienceChoiceLabel2,icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.organization,label:y.format(b.e.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var t={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.existing,label:b.e.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};e.splice(2,0,t)}return e};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return e.selectedPermissions.audience!==f.e.specificPeople&&e.selectedPermissions.audience!==f.e.specificPeopleFlex||!e.copyLinkShortcut&&e.mode!==o.e.linkSettings?void 0:C.a(this.props.clientId)?h.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},e.currentSettings.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0):h.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},h.createElement(de.e,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null}))};t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,r=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var s=r>0&&!this.state.isSpecificPeopleReadOnlyExpanded?h.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+r):void 0;return h.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,s)};t.prototype._renderRolesDropDown=function(){var e=this.props,t=pe.s(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension);return t?h.createElement("div",{className:"od-PermissionsSettings-changePermission"},h.createElement(ce,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,canChangePermission:!1,showReview:t})):h.createElement(O.e,{className:"od-PermissionsSettings-allowEdit",label:b.e.allowEditLabel,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing,componentRef:this._allowEditCheckbox})};t.prototype._renderRequireVerificationToggle=function(){var e=this.props.selectedPermissions,t=this.props.sharingInformation.anyoneLinkTrackUsers,n=!1;if(e.audience===f.e.anyone){t&&(n=!0);return h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification"},h.createElement("div",{className:"od-RequireVerificationToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"ReminderPerson"},{alt:b.e.imageAltPreventDownloadIcon}))),h.createElement(M.e,{"aria-disabled":!0,role:"checkbox",checked:n,disabled:!0,label:b.e.requireVerificationLabel}))))}};t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return this.context.sharingStore.isExpirationDateModificationAllowed()&&(t.audience===f.e.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===f.e.specificPeople)?this._disablePremiumFeatures?h.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},h.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),h.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),this._renderExpirationDatePickerErrorMessage()):void 0};t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:b.e.expirationTeachingBubbleHeadline,mainText:b.e.expirationTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(Z.l)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return h.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},t)};t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;return t&&n.audience===f.e.anyone?this._disablePremiumFeatures?h.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},h.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement(ae,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1}),this._renderPasswordTeachingBubble()))):h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement(ae,{onPasswordChange:this.props.onPasswordChange})):void 0};t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:b.e.passwordTeachingBubbleHeader,mainText:b.e.passwordTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._getLinkTemplateOptions=function(){var e=[],t=this.props.sharingInformation,n=t.sharingLinkTemplates,r=t.sharingAbilities,i=pe.n(r,n);if(i.length>0){for(var s=0,o=i;s<o.length;s++){var u=o[s];e.push(this._getLinkTemplateOption(u))}var a={icon:fe.e[1],isChecked:this.props.currentSettings.audience===f.e.existing,isDisabled:!1,key:f.e.existing.toString(),label:b.e.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};e.push(a);var l=this.props.sharingInformation.requiresAccessApproval?b.e.permissionsRequestAccessString:this._getSpecificPeopleLabel(),c={icon:fe.e[2],isChecked:this.props.currentSettings.audience===f.e.specificPeople,isDisabled:!1,key:f.e.specificPeople.toString(),label:l,linkKinds:[1],permissionsType:2};e.push(c)}return e};t.prototype._getLinkTemplateOption=function(e){var t={icon:fe.e[0],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[4,5],permissionsType:0,link:e},n={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[2,3],permissionsType:1,link:e};switch(e.audience){case f.e.anyone:t.key=e.shareId;t.label=Object(Z.v)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return t;case f.e.organization:n.key=e.shareId;n.label=Object(Z.v)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return n}};t.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation,n=[],r=this.props.currentSettings,i=void 0;for(var s in e)if(e.hasOwnProperty(s)){var u=e[s];if(null!==u){var a=pe.e(s),l=n.map(function(e){return e.key}).indexOf(a)>-1;if(!a||l)continue;if(a===f.e.specificPeopleFlex&&!this.props.createPeopleSharingLinks){i=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?i.isChecked=i.key===r.audience||f.e.specificPeopleFlex===r.audience:i.isDisabled=!0;this._supportedAudienceOptions.indexOf(f.e.specificPeople)>-1&&n.push(i);continue}if(y=this._getAudienceOption(a)){y.isDisabled=!(u.canManageEditLink.enabled||u.canManageReadLink.enabled);y.isChecked=y.key===r.audience;n.push(y)}}}var c={icon:fe.e[1],isChecked:r.audience===f.e.existing,isDisabled:!1,key:f.e.existing,label:b.e.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};-1!==this._supportedAudienceOptions.indexOf(f.e.existing)&&n.splice(2,0,c);var h=n.filter(function(e){return e.key===f.e.specificPeople&&!e.isDisabled||e.key===f.e.specificPeopleFlex&&!e.isDisabled?e:null}).length>0,p=!this.props.omitCustomLabeledAudience&&Object(Z.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig);if(h&&p){var d=this._getAudienceOption(f.e.customLabeledSpecificPeople);n.splice(2,0,d);d.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal);d.isChecked=r.audience===f.e.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&r.audience===f.e.specificPeopleFlex}this.props.mode!==o.e.linkSettings||!C.a(this.props.clientId)||this.props.shareId&&r.audience===f.e.specificPeopleFlex||!h||n.splice(n.indexOf(h),1);for(var v=[],m=0,g=n;m<g.length;m++){var y=g[m];if(-1===this._hiddenAudienceOptions.indexOf(y.key)||r.audience===y.key){-1!==this._disabledAudienceOptions.indexOf(y.key)&&r.audience!==y.key&&(y.isDisabled=!0);v.push(y)}}return v};t.prototype._renderPreventDownloadToggle=function(){var e=this.props.selectedPermissions,t=!!e.preventDownload,n=this.context.sharingStore.isPreventDownloadAllowed();return!!!this.context.sharingStore.getNavId()&&n&&pe.o(e.audience,this.props.sharingInformation.sharingAbilities)&&(function(e,t){if(!e)return!1;e=("."===e[0]?e.slice(1):e).toLowerCase();return we.e.isFeatureEnabled(Ee)?ye[e]>=t:be[e]>=t})(this.props.sharingInformation.fileExtension,1)?h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},h.createElement(me,{onToggleChange:this.props.onToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isRolesDropDown:e.isReview}))):void 0};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props.selectedPermissions,t=!!e.isReview;return pe.i(e.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)?h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode"},h.createElement(Se,{onToggleChange:this.props.onOfficeReviewModeToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disableOfficeReviewMode:this.state.officeReviewModeDisabled}))):void 0};t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var r=window.external;r.IsGoPremiumAvailable()&&(n=function(){try{r.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:b.e.teachingBubbleLearnMoreButton,onClick:this.context.premiumLearnMore};else try{var i=window.external;if(i.IsPremiumLearnMoreAvailable()){t={children:b.e.teachingBubbleLearnMoreButton,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}}}}catch(e){}return h.createElement(ge.e,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,headline:e.headline,primaryButtonProps:{children:b.e.teachingBubbleUpgradeButton,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0},h.createElement(Y.e,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)};t.prototype._getAudienceOption=function(e){var t=b.e;if(e===f.e.anyone&&this._supportedAudienceOptions.indexOf(f.e.anyone)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:fe.e[0],isChecked:!1,isDisabled:!1,key:f.e.anyone,label:b.e.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0};if(e===f.e.organization&&this._supportedAudienceOptions.indexOf(f.e.organization)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.organization,label:y.format(b.e.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(e===f.e.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(f.e.specificPeopleFlex)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:fe.e[2],isChecked:!1,isDisabled:!1,key:f.e.specificPeopleFlex,label:this._getSpecificPeopleLabel(),linkKinds:[6],permissionsType:2};if(e===f.e.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(f.e.customLabeledSpecificPeople)>-1){var n=C.a(this.props.clientId),r=n?6:5,i="",s=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;i=n||"recipient"===s?t.permissionsRecipientsOfThisMessageString:"channel"===s?t.permissionsPeopleInChannelString:"team"===s?t.permissionsPeopleinTeamString:t.permissionsPeopleInChatString;return{disabledText:b.e.disabledAudienceChoiceLabel2,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&fe.e[r],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:f.e.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?y.format(t.permissionsOnlyCustomLabeledString,this.props.customLabeledAudienceConfig.entityName):i,linkKinds:[6],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&r}}};t.prototype._getSpecificPeopleLabel=function(){if(k.T()){var e=void 0;switch(ke.n()){case 0:e=b.e.permissionsSpecificPeopleString;break;case 1:e=y.format(b.e.permissionsSpecificPeopleStringExperimental,this.props.companyName);break;case 2:e=y.format(b.e.permissionsSpecificPeopleStringExperimental2,this.props.companyName);break;default:e=b.e.permissionsSpecificPeopleString}return e}return b.e.permissionsSpecificPeopleString};t.prototype._onChoiceGroupChange=function(e){for(var t=0,n=this._permissionsOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onLinkTemplateChoiceChange=function(e){for(var t=0,n=this._linkTemplateOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onSelectDate=function(e){var t=this,n=Object(Z.c)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:n}),function(){t.props.updateExpirationErrorCode(n);t.props.onExpirationChange(e)})};t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t);this.context.sharingStore.getEngagementHelper().linkSettingsOnAllowEditingClicked(this.props.engagementExtraData);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{preventDownloadDisabled:t,officeReviewModeDisabled:!!t}))};t.contextTypes={resize:i.func.isRequired,sharingStore:i.object.isRequired,goPremium:i.func,platformDetection:i.object.isRequired,premiumLearnMore:i.func};return t})(h.Component),Ae=n(71),Oe=n(1581),Me=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._currentPassword="";r._matchingTemplate=null;r._peoplePickerHasUnresolvedText=!1;r._topLevelDivRef=h.createRef();r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._currentPassword="";r.state=r._initializeState();r._preventDownloadToggle=!!r.state.selectedPermissions.preventDownload;r._officeReviewModeToggle=!!r.state.selectedPermissions.isReview;r._initializeState=r._initializeState.bind(r);r._onApplyClicked=r._onApplyClicked.bind(r);r._onCancel=r._onCancel.bind(r);r._onPeoplePickerChange=r._onPeoplePickerChange.bind(r);r._updateExpirationErrorCode=r._updateExpirationErrorCode.bind(r);r.onAudienceChange=r.onAudienceChange.bind(r);r.onLinkTemplateChange=r.onLinkTemplateChange.bind(r);r.onEditChange=r.onEditChange.bind(r);r.onRoleChange=r.onRoleChange.bind(r);r.onExpirationChange=r.onExpirationChange.bind(r);r._getShareLinkTemplate=r._getShareLinkTemplate.bind(r);r._findMatchingShareLinkTemplate=r._findMatchingShareLinkTemplate.bind(r);r._calculateRole=r._calculateRole.bind(r);r._onPasswordChange=r._onPasswordChange.bind(r);r._resetPasswordVariables=r._resetPasswordVariables.bind(r);r._onPreventDownloadToggleChange=r._onPreventDownloadToggleChange.bind(r);r._onOfficeReviewModeToggleChange=r._onOfficeReviewModeToggleChange.bind(r);r._onConfirmationUseExisting=r._onConfirmationUseExisting.bind(r);r._onConfirmationUseNew=r._onConfirmationUseNew.bind(r);r._shareClickTime=n.shareClickTime;r._resizeTracker=new oe.e(n.resize);return r}t.prototype.componentDidMount=function(){Oe.l(this._shareClickTime,this.props.clientId,o.e.linkSettings,this.props.scenarioId,this.props.correlationId);this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=C.e(this.props.clientId),n=pe.n(this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.sharingLinkTemplates),i="od-ModifyPermissions-section";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(i+=" od-ModifyPermissions-section-noAudienceMod");return h.createElement("div",{ref:this._topLevelDivRef,className:"od-ModifyPermissions"+e},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,viewState:n.length>0?12:2,mode:this.props.mode})),h.createElement("div",{className:i},h.createElement(Le,Object(r.__assign)({},Object(E.e)(this.props),{mode:this.props.mode,shareId:this.props.shareId,companyName:Z.A(this.props.companyName),currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onLinkTemplateChange:this.onLinkTemplateChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onPreventDownloadToggleChange,onOfficeReviewModeToggleChange:this._onOfficeReviewModeToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onPeoplePickerInputChange:this._onPeoplePickerInputChange}))),t?h.createElement("div",{className:"od-ModifyPermissions-actions",id:"od-ModifyPermissions-actions-id"},this._renderDefaultButton(),this._renderPrimaryButton()):h.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype.onLinkTemplateChange=function(e){var t=this.props.sharingInformation.sharingLinkTemplates.find(function(t){return!!t.linkDetails&&t.linkDetails.shareId===e}),n={allowEditing:!0,audience:f.e.existing,expiration:null,isEdit:!1,isReview:!1,sharingRole:l.e.view,preventDownload:!1,sharingLinkKind:1,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};if(t){var i=t.linkDetails;n.shareId=i.shareId;n.fetchLinkOnly=!0;n.audience=i.audience;n.expiration=i.expiration;n.isEdit=i.isEdit;n.isReview=i.isReview;n.hasPassword=i.hasPassword;n.sharingRole=i.isEdit?l.e.edit:i.isReview?l.e.review:l.e.view;n.preventDownload=i.blockDownload;n.sharingLinkKind=i.sharingLinkKind}else e===f.e.existing.toString()?n.audience=f.e.existing:e===f.e.specificPeople.toString()&&(n.audience=f.e.specificPeople);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:n}))};t.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions,n=this._isAllowEditingEnabled(e),i=t.isEdit&&n,s=t.isReview&&(pe.s(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)||pe.i(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),o=s?6:Object(Z.d)(e,i),u=e===f.e.anyone||e===f.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:Object(Z.a)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),a=l.e.view;s?a=l.e.review:i&&(a=l.e.edit);var c={allowEditing:n,audience:e,expiration:u,isEdit:i,isReview:s,sharingRole:a,preventDownload:t.preventDownload&&!i&&!s,sharingLinkKind:o,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:"",trackLinkUsers:t.trackLinkUsers};this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:c}))};t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,n=Object(Z.d)(t.audience,e),i=l.e.view;e&&(i=t.isReview?l.e.review:l.e.edit);this._resetPasswordVariables();this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{isEdit:e,isReview:i===l.e.review,sharingRole:i,sharingLinkKind:n,preventDownload:!1}),preventDownloadDisabled:e,officeReviewModeDisabled:!!e}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,n=l.e.review==e,i=n?6:Object(Z.d)(t.audience,e===l.e.edit),s=Object(Z.a)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{sharingRole:e,isEdit:e===l.e.edit,isReview:n,expiration:s,sharingLinkKind:i,preventDownload:!1}),preventDownloadDisabled:e!==l.e.view}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onExpirationChange=function(e){e||(e=Object(Z.a)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{expiration:e})}))};t.prototype._renderDefaultButton=function(){return h.createElement(m.e,{onClick:this._onCancel},b.e.cancelButtonText)};t.prototype._renderPrimaryButton=function(){return h.createElement(g.e,{id:"od-ModifyPermissions-apply-id",className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked},b.e.applyButtonText)};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.e.activityMessageCreatingLink})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,r=t.isReview&&(pe.s(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)||pe.i(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)),i=he.s({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:Z.e.none,peoplePickerError:i,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),trackLinkUsers:t.trackLinkUsers,audience:t.audience,isEdit:t.isEdit,isReview:r,sharingRole:t.sharingRole,expiration:t.expiration||Object(Z.a)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId,fetchLinkOnly:t.fetchLinkOnly},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),officeReviewModeDisabled:!!this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}};t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==Z.e.none||!!this.state.peoplePickerError};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:e}))};t.prototype._onCancel=function(){this.props.onCancel()};t.prototype._onApplyClicked=function(){var e=this,t=this.state.selectedPermissions;if(this._peoplePickerHasUnresolvedText)this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:h.createElement("span",null,b.e.unresolvedTextError)}));else if(t.audience!==f.e.specificPeopleFlex||0!==t.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==o.e.linkSettings){var n=this.props.doesCreate;if(t.fetchLinkOnly)this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)});else{var i=t.audience===f.e.anyone||t.audience===f.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:null;if(this._determineMatchingTemplateAndSettingChange(i)){var s=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,shareId:this._existingPasswordLinkShareId,hasPassword:s}),showActivityIndicator:n,showConfirmationDialog:!0}))}else this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,hasPassword:!!this._currentPassword,shareId:""}),showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}}else this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:h.createElement("span",null,b.e.recipientsRequiredError)}))};t.prototype._determineMatchingTemplateAndSettingChange=function(e){if(this.state.selectedPermissions.audience!==f.e.anyone)return!1;this._matchingTemplate=this._getShareLinkTemplate();if(!this._matchingTemplate||!this._matchingTemplate.linkDetails)return!1;if(this._currentPassword&&this._matchingTemplate.passwordProtected)return!0;var t=this._matchingTemplate.linkDetails.expiration;return null!==e&&null!==t&&(e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())};t.prototype._onPeoplePickerChange=function(e){var t=he.s({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===f.e.specificPeople){for(var n=!1,i=!1,s=0,o=e;s<o.length;s++){var u=o[s];n||(n=u.isExternal&&!u.providerName);i||(i=!u.isExternal||u.isExternal&&!!u.providerName)}n&&i&&(t=h.createElement("span",null,b.e.mixedRecipientErrorMessage))}this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:t,selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{specificPeople:e})}))};t.prototype._getShareLinkTemplate=function(){var e=this._findMatchingShareLinkTemplate();e&&(e.passwordProtected&&e.linkDetails?this._existingPasswordLinkShareId=e.linkDetails.shareId:this._existingPasswordLinkShareId="");return e};t.prototype._findMatchingShareLinkTemplate=function(){var e,t,n=!!this._currentPassword,r=this.props.sharingInformation.sharingLinkTemplates;if(!r||0===r.length)return null;for(var i=this._calculateRole(),s=0,o=r;s<o.length;s++){var u=o[s];if(u.role===i&&0===u.scope){if(n&&u.passwordProtected)return u;u.passwordProtected?e=u:t=u}}return e&&e.linkDetails&&!this._deletedPassword&&n?e:t};t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?l.e.restrictedview:this.state.selectedPermissions.isReview?l.e.review:this.state.selectedPermissions.isEdit?l.e.edit:l.e.view};t.prototype._onPasswordChange=function(e){this._currentPassword=e;this._deletedPassword=0===e.length};t.prototype._resetPasswordVariables=function(){if(Ae.e.isActivated("52d2d6a6-5610-4d11-83d0-a889fd6732bb","01/21/2020","Do not reset password when role changes")){this._currentPassword="";this._deletedPassword=!1;this._existingPasswordLinkShareId=""}};t.prototype._onPreventDownloadToggleChange=function(e){this._preventDownloadToggle=e;this._resetPasswordVariables();this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{preventDownload:e})}))};t.prototype._onOfficeReviewModeToggleChange=function(e){this._officeReviewModeToggle=e;var t=e?l.e.review:this.state.selectedPermissions.isEdit?l.e.edit:l.e.view;this._resetPasswordVariables();this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{sharingRole:t,isReview:e,sharingLinkKind:e?6:Object(Z.d)(this.state.selectedPermissions.audience,this.state.selectedPermissions.isEdit)})}))};t.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;return pe.r(e,t)};t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,r=t.linkDetails.expiration,i=e&&t.passwordProtected,s=null!==n&&null!==r&&(n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate());return i&&s?a.shareDialogPasswordAndExpiration:i?a.shareDialogPasswordOnly:a.shareDialogExpirationOnly};t.prototype._renderConfirmationDialog=function(){var e=!!this._currentPassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),r=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?Object(xe.s)(t.linkDetails.expiration):"";return h.createElement(w,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:r,linkExpiration:i})};t.prototype._onConfirmationUseNew=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,n=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:n,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),_e=n(1666),De=n(1396),Pe=n(352),He=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._initialLinkShown=!1;r._onLinkSettingsCancelClick=function(){r.setState({shouldCopyLinkToClipboard:!1},function(){r.props.onLinkPermissionsCancelClicked()})};r._onLinkSettingsApplyClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e)})};r._shareClickTime=n.shareClickTime;r.state={shouldCopyLinkToClipboard:!0};return r}t.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 4:var n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};if(!this._initialLinkShown){Oe.l(this._shareClickTime,this.props.clientId,o.e.copy,this.props.scenarioId,this.props.correlationId);this._initialLinkShown=!0}return h.createElement(_e.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:u.e.copy,itemName:t.item.name,linkUrl:e.displayUrl,sharingHintProps:n,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));case 2:return h.createElement(Me,Object(r.__assign)({},Object(E.e)(this.props),{shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onSelectedPeopleChange:function(){}}));default:return h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(De.e,{className:"od-Share-spinner",label:b.e.componentLoading,type:Pe.t.large}))}};t.contextTypes={shareClickTime:i.number};return t})(h.Component),Be=n(2026);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:12px;min-height:36px}.od-PermissionsList-header{position:relative}.od-PermissionsList-inheritance{margin:16px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-header{font-weight:400;font-size:14px;display:inline}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0px 5px}.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0}[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}.od-ShareLinkDetails--sectionHeader .ms-Button{height:32px}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0px}.od-PermissionsList-principalGroup{outline:transparent;position:relative}.od-PermissionsList-principalGroup::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{border-color:ActiveBorder}}.od-PermissionsList-addressBarDescription{display:inline-block;padding-top:20px;font-size:12px}.od-AddressBarLinkHint{padding-top:20px;padding-bottom:24px}.isFluent .od-AddressBarLinkHint .od-ShareHint{margin:0}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}\n"}]);var je,Fe=n(2175),Ie=n(1819),qe=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!1}))};i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}t.prototype.render=function(){var e=this.props,t=this.state;return h.createElement("div",{className:"od-LinkMember"},h.createElement(Fe.e,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:Ie.e.blue,size:Ie.n.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&h.createElement(R.e,{directionalHint:U.e.topCenter,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},h.createElement("div",{className:"od-LinkMember-tooltip"},h.createElement("span",null,e.primaryText))))};return t})(h.Component),Re=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onCancel=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showDetailsPanel:!1,showConfirmationDialog:!1,participants:i.state.participants,hasPeopleChange:!1})})};i._onConfirmationDeleteParticipant=function(){if(i.state.confirmationCode===a.participant){i._onLinkParticipantDelete();i.setState({showConfirmationDialog:!1,confirmationCode:a.none})}};i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:a.none,hasPeopleChange:!1};return i}t.prototype.render=function(){var e=this;return h.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t){return h.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email},h.createElement(Fe.e,{imageUrl:t.image,primaryText:t.name,secondaryText:t.isExternal?b.e.externalUser:t.job,size:Ie.n.size32,showSecondaryText:!(!t.job&&!t.isExternal)}),6===e.props.link.sharingLinkKind&&!e.props.link.isAddressBarLink&&h.createElement(ue.e,{"data-is-focusable":!0,ariaLabel:y.format(b.e.removePersonLabel,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:a.participant,participant:t})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})}})};t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];if(this.props.showDetailsPanel){t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email});this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{participants:t,hasPeopleChange:!0}));this.props.onRemoveParticipant(e,t)}else this.props.updateLinkSettings(e)};return t})(h.Component);(function(e){e[e.none=0]="none";e[e.descriptive=1]="descriptive";e[e.more=2]="more";e[e.downArrow=3]="downArrow"})(je||(je={}));var Ue=n(436),ze=n(1120),We=n(86),Xe=n(416),Ve=Object(We.t)(function(e,t,n){var i=Object(Xe.e)(e),s=Object(K.b)(i,n);return Object(r.__assign)(Object(r.__assign)({},s),{root:[i.root,t,e.fonts.medium,n&&n.root]})}),$e=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,i=Object(r.__rest)(e,["className","styles"]),s=Ve(this.props.theme,t,n);return h.createElement(Ue.e,Object(r.__assign)({},i,{variantClassName:"ms-Button--facepile",styles:s,onRenderDescription:_.t}))};return t=Object(r.__decorate)([Object(ze.e)("FacepileButton",["theme","styles"],!0)],t)})(h.Component),Je=n(3385),Ke=Object(P.e)(),Qe=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._classNames=Ke(n.props.styles,{theme:n.props.theme,className:n.props.className});n._getPersonaControl=function(e){var t=n.props,i=t.getPersonaProps,s=t.personaSize;return h.createElement(Fe.e,Object(r.__assign)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:s},i?i(e):null,{styles:{details:{flex:"1 0 auto"}}}))};n._getPersonaCoinControl=function(e){var t=n.props,i=t.getPersonaProps,s=t.personaSize;return h.createElement(Je.e,Object(r.__assign)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:s},i?i(e):null))};Object(H.e)(n);n._ariaDescriptionId=Object(B.e)();return n}t.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,n=t.chevronButtonProps,r=t.maxDisplayablePersonas,i=t.personas,s=t.overflowPersonas,o=t.showAddButton,u=t.ariaLabel,a=this._classNames,f="number"==typeof r?Math.min(i.length,r):i.length;n&&!e&&(e=n);var l=s&&s.length>0,c=l?i:i.slice(0,f),p=(l?s:i.slice(f))||[];return h.createElement("div",{className:a.root},this.onRenderAriaDescription(),h.createElement("div",{className:a.itemContainer},o?this._getAddNewElement():null,h.createElement("ul",{className:a.members,"aria-label":u},this._onRenderVisiblePersonas(c,0===p.length&&1===i.length)),e?this._getOverflowElement(p):null))};t.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&h.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)};t.prototype._onRenderVisiblePersonas=function(e,t){var n=this,r=this.props,i=r.onRenderPersona,s=void 0===i?this._getPersonaControl:i,o=r.onRenderPersonaCoin,u=void 0===o?this._getPersonaCoinControl:o;return e.map(function(e,r){var i=t?s(e,n._getPersonaControl):u(e,n._getPersonaCoinControl);return h.createElement("li",{key:(t?"persona":"personaCoin")+"-"+r,className:n._classNames.member},e.onClick?n._getElementWithOnClickEvent(i,e,r):n._getElementWithoutOnClickEvent(i,e,r))})};t.prototype._getElementWithOnClickEvent=function(e,t,n){var i=t.keytipProps;return h.createElement($e,Object(r.__assign)({},Object(j.u)(t,j.n),this._getElementProps(t,n),{keytipProps:i,onClick:this._onPersonaClick.bind(this,t)}),e)};t.prototype._getElementWithoutOnClickEvent=function(e,t,n){return h.createElement("div",Object(r.__assign)({},Object(j.u)(t,j.n),this._getElementProps(t,n)),e)};t.prototype._getElementProps=function(e,t){var n=this._classNames;return{key:(e.imageUrl?"i":"")+t,"data-is-focusable":!0,className:n.itemButton,title:e.personaName,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}};t.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case je.descriptive:return this._getDescriptiveOverflowElement(e);case je.downArrow:return this._getIconElement("ChevronDown");case je.more:return this._getIconElement("More");default:return null}};t.prototype._getDescriptiveOverflowElement=function(e){var t=this.props.personaSize;if(!e||e.length<1)return null;var n=e.map(function(e){return e.personaName}).join(", "),i=Object(r.__assign)({title:n},this.props.overflowButtonProps),s=Math.max(e.length,0),o=this._classNames;return h.createElement($e,Object(r.__assign)({},i,{ariaDescription:i.title,className:o.descriptiveOverflowButton}),h.createElement(Je.e,{size:t,onRenderInitials:this._renderInitialsNotPictured(s),initialsColor:Ie.e.transparent}))};t.prototype._getIconElement=function(e){var t=this.props,n=t.overflowButtonProps,i=t.personaSize,s=this._classNames;return h.createElement($e,Object(r.__assign)({},n,{className:s.overflowButton}),h.createElement(Je.e,{size:i,onRenderInitials:this._renderInitials(e,!0),initialsColor:Ie.e.transparent}))};t.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,n=e.personaSize,i=this._classNames;return h.createElement($e,Object(r.__assign)({},t,{className:i.addButton}),h.createElement(Je.e,{size:n,onRenderInitials:this._renderInitials("AddFriend")}))};t.prototype._onPersonaClick=function(e,t){e.onClick(t,e);t.preventDefault();t.stopPropagation()};t.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)};t.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)};t.prototype._renderInitials=function(e,t){var n=this._classNames;return function(){return h.createElement(Y.e,{iconName:e,className:t?n.overflowInitialsIcon:""})}};t.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return h.createElement("span",{className:t.overflowInitialsIcon},e<100?"+"+e:"99+")}};t.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:Ie.n.size32};return t})(h.Component),Ge={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"},Ye=Object(D.e)(Qe,function(e){var t,n=e.className,r=e.theme,i=e.spacingAroundItemButton,s=void 0===i?2:i,o=r.palette,u=r.fonts,a=Object(K.N)(Ge,r),f={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",display:"inline",backgroundColor:"transparent",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}};return{root:[a.root,r.fonts.medium,{width:"auto"},n],addButton:[a.addButton,Object(K.T)(r,{inset:-1}),f,{fontSize:u.medium.fontSize,color:o.white,backgroundColor:o.themePrimary,marginRight:2*s+"px",selectors:{"&:hover":{backgroundColor:o.themeDark},"&:focus":{backgroundColor:o.themeDark},"&:active":{backgroundColor:o.themeDarker},"&:disabled":{backgroundColor:o.neutralTertiaryAlt}}}],descriptiveOverflowButton:[a.descriptiveOverflowButton,Object(K.T)(r,{inset:-1}),f,{fontSize:u.small.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*s+"px"}],itemButton:[a.itemButton,f],itemContainer:[a.itemContainer,{display:"flex"}],members:[a.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+s+"px"}],member:[a.member,{display:"inline-flex",flex:"0 0 auto",margin:s+"px"}],overflowButton:[a.overflowButton,Object(K.T)(r,{inset:-1}),f,{fontSize:u.medium.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*s+"px"}],overflowInitialsIcon:[{color:o.neutralPrimary,selectors:(t={},t[K.o]={color:"WindowText"},t)}],screenReaderOnly:K.D}},void 0,{scope:"Facepile"});Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;padding:0 20px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}[dir='ltr'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:22px 0 12px;margin-bottom:50px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--absolute{position:absolute}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0px}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{outline:transparent;position:relative;font-size:12px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-RequireVerificationToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:-webkit-box;display:-ms-flexbox;display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:12px;line-height:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:12px;font-style:italic;margin-top:-5px;padding:0}[dir='ltr'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";font-size:14px}.od-ShareLinkDetails--sectionHeader .ms-Button:not(:hover){background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-ShareLinkDetails--sectionHeader .ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400}[dir='ltr'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-negative:0;flex-shrink:0;margin-top:auto;height:56px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";margin:10px -20px 0}[dir='ltr'] .od-ShareLinkDetails--actions{padding-right:35px}[dir='rtl'] .od-ShareLinkDetails--actions{padding-left:35px}.od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}.od-ShareLinkDetails--actions .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir='rtl'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button--primary::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button:focus::after{left:-2px;right:-2px;top:-2px;bottom:-2px}}.od-ShareLinkDetails--noParticipants{font-size:12px;padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";min-height:50px}.od-ShareLinkDetails-addressBarChoiceGroup{padding-top:10px}.od-ShareLinkDetails-addressBarChoiceGroupLabel{font-weight:600;font-size:12px}\n"}]);var Ze=n(4154),et=n(135),tt=n(1578),nt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onPeoplePickerChange=function(e){var t=he.s({selectedItems:i.state.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),n=e[0],r=[];r=!0===n.isExternal?i.state.participants.filter(function(e){return e.email===n.email}):i.state.participants.filter(function(e){return e.userId===n.userId});i.setState({participants:0===r.length?i.state.participants.concat(e):i.state.participants,hasPeopleChange:0===r.length,peoplePickerError:t});i.props.onPeoplePickerChange(r,e)};i._onRemoveParticipant=function(e,t){i.setState({participants:t,participantRemovedText:y.format(b.e.removedPersonText,e.name)});i.props.updateLinkSettings(e)};i._onRoleChange=function(e){i.setState({hasSettingsChange:!0});i.props.onRoleChange(e)};i._onOptionChange=function(e){i.props.onOptionChange(e)};i._onAudienceChange=function(e){var t=e===f.e.organization;i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{isAddressBarLinkEnabled:t,hasSettingsChange:e!==i._selectedAudience,currentAudience:e,confirmationCode:a.addressBarLinkOff})})};i._onPasswordChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:e.length>0})});i.props.onPasswordChange(e)};i._onConfirmationSave=function(){if(i.props.addressBarLinkDetails){if(i.state.confirmationCode===a.addressBarLinkOff){i._store.setAddressBarLinkCapability(!1);i._link&&i._store.unshareLink(i._link.sharingLinkKind,i._link.shareId)}else i._store.setAddressBarLinkCapability(!0);i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{isAddressBarLinkEnabled:!1,showConfirmationDialog:!1,hasSettingsChange:!1,confirmationCode:a.none})})}else{i.props.updateLinkSettings(null);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:a.none,hasSettingsChange:!1,hasPeopleChange:!1}))}};i._onCancel=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:a.none}));i.props.onCancel()};i._onSave=function(){if(i.state.hasSettingsChange){var e=i.props.addressBarLinkDetails&&i.state.currentAudience===f.e.existing?a.addressBarLinkOff:a.linkSettings;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{confirmationCode:e,showConfirmationDialog:!0}))}else if(i.state.hasPeopleChange){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{hasPeopleChange:!1}));i.props.updateLinkSettings(null)}};i._onBack=function(){i.state.hasPeopleChange||i.state.hasSettingsChange?i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!0,confirmationCode:a.back})):i.props.onCancel()};i._onSelectDate=function(e){var t=i.props.sharingInformation.anonymousLinkExpirationRestrictionDays;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{expirationErrorCode:Object(Z.c)(e,t)}),function(){i._updateExpirationErrorCode(Object(Z.c)(e,t))});i._onExpirationChange(e)};i._store=n.sharingStore;i._link=i.props.link;var s=i.props.sharingInformation.sharingAbilities;i._canManageAddressBarLink=Object(Z.n)(s);i.state={expirationErrorCode:Z.e.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:a.none,participants:i.props.participants,participantRemovedText:"",selectedPermissions:i.props.selectedPermissions,currentAudience:i._getCurrentAudience(),peoplePickerError:he.s({selectedItems:Object(r.__assign)({},i.props.participants),sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})};i._audienceOptions=i._getAudienceOptions();return i}t.prototype.render=function(){var e=C.s(this.props.clientId)?" od-ShareLinkDetails--absolute":"";return h.createElement("div",{className:"od-ShareLinkDetails--div"+e},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())};t.prototype._renderDetailsPanelContent=function(){return this.props.addressBarLinkDetails?this._renderAddressBarLinkDetails():h.createElement("div",{className:"od-ShareLinkDetails--content"},this._renderShareLink(),h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.e.modifyPermissionsHeader},b.e.modifyPermissionsHeader),h.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":b.e.modifyPermissionsHeader},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==f.e.specificPeopleFlex&&this.state.participants.length>0&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.e.notFlexibleLinkPeoplePickerHeader},b.e.notFlexibleLinkPeoplePickerHeader),this.props.selectedPermissions.audience===f.e.specificPeopleFlex&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.e.flexibleLinkPeoplePickerHeader},b.e.flexibleLinkPeoplePickerHeader),this._renderPeoplePicker(),this._renderParticipantsList(),tt.e(this.state.participantRemovedText,"assertive","alert"),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderRequireVerificationToggle=function(){var e=this.state.selectedPermissions.trackLinkUsers;return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--requireVerification"},h.createElement("div",{className:"od-RequireVerificationToggle"},h.createElement("div",{className:"od-ShareLinkDetails-setting--RequireVerification-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"ReminderPerson"},{alt:b.e.imageAltPreventDownloadIcon}))),h.createElement(M.e,{"aria-disabled":!0,role:"checkbox",checked:e,disabled:!0,label:b.e.requireVerificationLabel}))))};t.prototype._renderAddressBarLinkDetails=function(){return h.createElement("div",{className:"od-ShareLinkDetails--content"},h.createElement("span",{className:"od-ShareLinkDetails-addressBarChoiceGroupLabel"},b.e.chooseAddressBarLink),h.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},h.createElement(L,{items:this._audienceOptions,onChange:this._onOptionChange,onAudienceChange:this._onAudienceChange,companyName:this.props.companyName,clientId:this.props.clientId})),h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.e.modifyPermissionsHeader},b.e.modifyPermissionsHeader),h.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":b.e.modifyPermissionsHeader},this._renderChangePermission()),this.state.participants.length>0&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.e.notFlexibleLinkPeoplePickerHeader},b.e.notFlexibleLinkPeoplePickerHeader),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderShareLink=function(){return h.createElement(rt,{link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink})};t.prototype._renderDetailsPanelHeader=function(){return h.createElement("div",{className:"od-ShareLinkDetails--header"},tt.t(h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Back"},onClick:this._onBack,ariaLabel:b.e.backButtonLabel}),b.e.backButtonLabel,{position:U.e.bottomLeftEdge}),h.createElement("span",null,b.e.manageExistingAccessLabel))};t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange)||this.state.expirationErrorCode!==Z.e.none;return h.createElement("div",{className:"od-ShareLinkDetails--actions"},h.createElement(g.e,{id:"od-ShareLinkDetails-save",onClick:this._onSave,disabled:e},b.e.saveButtonText),h.createElement(m.e,{onClick:this.props.showPermissionsList,disabled:e},b.e.discardButtonText))};t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?h.createElement(Re,{link:this._link,showDetailsPanel:!0,participants:this.state.participants,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant}):this._link.audience===f.e.specificPeopleFlex?h.createElement("div",{className:"od-ShareLinkDetails--noParticipants"},b.e.noLinkParticipantsPSL):void 0};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=he.n(t.participants),r=he.r(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===f.e.specificPeopleFlex)return h.createElement(de.e,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:r,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:b.e.peoplePickerPlaceholderSpecific,onResolvedSuggestions:null})};t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=t==f.e.organization||t==f.e.anyone||t===f.e.existing;if(pe.i(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension))return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement(ce,{clientId:e.clientId,mode:e.mode,selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,canChangePermission:n,showReview:!1})));var r=pe.s(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension);return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement(ce,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,canChangePermission:n,showReview:r})))};t.prototype._renderRequestFileEntry=function(){var e=[{key:b.e.canUploadText,text:b.e.canUploadText,data:b.e.canUploadText,ariaLabel:b.e.canUploadText}];return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement("div",{className:"od-RoleSelector-wrapper"},tt.t(h.createElement(Y.e,{className:"od-RoleSelector-settingIcon",iconName:"Upload"}),b.e.canUploadText),h.createElement(Ze.e,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:b.e.canUploadText,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:et.ResponsiveMode.large,ariaLabel:b.e.canUploadText,options:e}),this.props.children)))};t.prototype._getCurrentAudience=function(){var e=this.props.addressBarLinkSettings;return e&&e.linkDisabled||!this._canManageAddressBarLink?f.e.existing:f.e.organization};t.prototype._getAudienceOptions=function(){var e=[],t={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.existing,label:b.e.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4},n={disabledText:b.e.disabledAudienceChoiceLabel2,icon:fe.e[1],isChecked:!1,isDisabled:!this._canManageAddressBarLink,key:f.e.organization,label:y.format(b.e.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(this._canManageAddressBarLink&&this.state.currentAudience!==f.e.existing){n.isChecked=!0;t.isChecked=!1;this._selectedAudience=f.e.organization}else{n.isChecked=!1;t.isChecked=!0;this._selectedAudience=f.e.existing}e.push(n,t);return e};t.prototype._renderExpirationDatePicker=function(){var e=this.state.selectedPermissions;if(e.audience===f.e.anyone)return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:e.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays})),this._renderExpirationDatePickerErrorMessage())};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(Z.l)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return h.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},t)};t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;t&&(e=t.primaryText?t.primaryText:t.email?t.email:"");return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},h.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},h.createElement(ae,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e}))))}};t.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},h.createElement(me,{isToggled:e,disablePreventDownload:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props,t=e.selectedPermissions.audience;if(pe.i(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)){var n=e.selectedPermissions.isReview||e.selectedPermissions.sharingRole===l.e.review;return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--officeReviewModeToggle"},h.createElement(Se,{isToggled:n,disableOfficeReviewMode:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))}};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,companyName:this.props.companyName,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})},onDiscard:this.props.showPermissionsList})};t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return Object(r.__assign)(Object(r.__assign)({},t.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t.state.selectedPermissions),{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})});this.props.onExpirationChange(e)};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:e}))};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),rt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onOptionChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:!0})})};i._onChevronClick=function(){i.setState({linkMemberExpanded:!i.state.linkMemberExpanded})};i._onCancel=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,participants:i._link?Object(Z.m)(i._link):[],expirationErrorCode:Z.e.none,selectedPermissions:i._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})});i.state.hasSettingsChange||i.state.hasPeopleChange||i._showPermissionsList()};i._showPermissionsList=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:!1,hasPeopleChange:!1,addressBarDetailsView:!1})});var e=i.props.showPermissionsList;e&&e()};i._onConfirmationDeleteLink=function(){if(i.state.confirmationCode===a.link){i._onShareLinkDelete();i.setState({showConfirmationDialog:!1,confirmationCode:a.none,hasSettingsChange:!1,linkDetailsView:!1})}i._showPermissionsList()};i._showLinkDetails=function(){var e=i.props.onShowLinkDetailsClicked;e&&e(i._link)};i._onShareLinkDelete=function(){var e=i._link;i.props.onRemoveLink&&i.props.onRemoveLink();i._store.unshareLink(e.sharingLinkKind,e.shareId)};i._onLinkClicked=function(e){try{var t=e.target;t.focus();t.setSelectionRange(0,t.value.length)}catch(e){}};i._copySharingLinkToClipboard=function(){var e=i.props.clientId,t=i._link.url,n=i._textField;Object(Z.i)(e,n,t).then(function(e){i.setState({copyLinkToClipboardSuccess:e,copyLinkAlert:b.e.notificationCopiedLabel});i._copyButton.focus();e&&setTimeout(function(){i.setState({copyLinkToClipboardSuccess:!1,copyLinkAlert:""})},2e3)})};i._updateLinkSettings=function(e){var t=[],n=[],s=i.state.participants;if(e)if(k.a())for(var o=0,u=s;o<u.length;o++){if((m=u[o]).principalName&&m.principalName===e.principalName||m.email===e.email){t.push(Object(Z.r)(m));i.setState({participantRemovedText:y.format(b.e.removedPersonText,m.name)});i._chevronButton&&i._chevronButton.focus();break}}else{var a=i._link.invitees.filter(function(t){return!Ae.e.isActivated("ef5f3998-f6a0-48b0-8847-931de0af354e","01/09/2020","bug fix for removing user on link")&&e.principalName&&t.loginName===e.principalName||t.email===e.email?t:void 0});if(a.length>0){t.push(Object(r.__assign)(Object(r.__assign)({},a[0]),{type:a[0].type}));i.setState({participantRemovedText:y.format(b.e.removedPersonText,a[0].primaryText)});i._chevronButton&&i._chevronButton.focus()}}else{for(var l=function(e){0===(!0===e.isExternal?s.filter(function(t){return t.email===e.email}):s.filter(function(t){return t.userId===e.loginName})).length&&t.push(e)},c=0,h=i._link.invitees;c<h.length;c++){l(h[c])}for(var p=function(e){if(!0===e.isExternal&&i.state.selectedPermissions.audience===f.e.organization)return"continue";0===(!0===e.isExternal?i._link.invitees.filter(function(t){return t.email===e.email}):i._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&n.push(e)},d=0,v=s;d<v.length;d++){var m;p(m=v[d])}}if(t.length>0||n.length>0||i.state.hasSettingsChange){i._store.shareLink({settings:i.state.selectedPermissions,recipients:n,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:i._link.shareId,inviteesToRemove:t});i._store.addListener(function(){i.setState(function(){var e=i._store.getSharingInformation().sharingLinks.filter(function(e){return e.shareId===i._link.shareId});if(e&&e.length>0){i._link=e[0];return{link:i._link,participants:6===i._link.sharingLinkKind?Object(Z.m)(i._link):[]}}})})}};i._onPeoplePickerChange=function(e,t){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:i.state.selectedPermissions,participants:0===e.length?i.state.participants.concat(t):i.state.participants,hasPeopleChange:0===e.length}))};i._onRoleChange=function(e){var t=i.state.selectedPermissions,n=Object(Z.d)(t.audience,e===l.e.edit);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{sharingRole:e,isEdit:e===l.e.edit,sharingLinkKind:n}),hasSettingsChange:e!==i._getSharingRole()||i.state.hasSettingsChange}))};i._onExpirationChange=function(e){e||i._link.expiration||(e=Object(Z.a)(i.props.sharingInformation.anonymousLinkExpirationRestrictionDays));i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},i.state.selectedPermissions),{expiration:e,shareId:i._link.shareId}),hasSettingsChange:e!==i.state.selectedPermissions.expiration||i.state.hasSettingsChange})})};i._onPasswordChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},i.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:i._link.shareId}),hasSettingsChange:!0})})};i._getLinkSettings=function(){return i._link?{allowEditing:!0,audience:i._link.audience,expiration:i._link.expiration,isEdit:i._link.isEdit,isReview:i._link.isReview,isCreateOnlyLink:i._link.isCreateOnlyLink,sharingLinkKind:i._link.sharingLinkKind,specificPeople:Object(Z.m)(i._link),updatePassword:i._link.updatePassword,password:i._link.password,sharingRole:i._getSharingRoleFromLink(),preventDownload:i._link.blockDownload,hasPassword:i._link.hasPassword,description:i._link.description,trackLinkUsers:i._link.trackLinkUsers}:i.props.isAddressBarLink?{allowEditing:!0,audience:i.props.addressBarLinkSettings.linkDisabled?f.e.existing:f.e.organization,expiration:null,isEdit:i.props.addressBarLinkSettings.linkPermission===l.e.edit,sharingLinkKind:6,specificPeople:i._link?Object(Z.m)(i._link):[],updatePassword:!1,password:""}:void 0};i._store=n.sharingStore;i._resize=n.resize;i._link=i.props.link;i.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,copyLinkAlert:"",link:i._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:i._link?Object(Z.m)(i._link):[],showConfirmationDialog:!1,confirmationCode:a.none,selectedPermissions:i._getLinkSettings(),expirationErrorCode:Z.e.none,linkDetailsView:i.props.linkDetailsView,addressBarDetailsView:!1,participantRemovedText:""};return i}t.prototype.render=function(){var e=this;if(this.props.enableLinkSettings&&(this.state.linkDetailsView||this.props.isAddressBarLink))return this._renderLinkDetails();var t=this.props.link,n=t.url,r=Object(Z.h)(this.props.link),i=Object(Z.v)(this.props.link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),s=t.principals&&t.principals.length>0||t.invitees&&t.invitees.length>0;return this.props.enableLinkSettings?h.createElement("div",null,this._renderShareLink(),tt.e(this.state.copyLinkAlert,"assertive","alert",!0),!t.isUnhealthy&&this.props.showMoreOptions&&s&&h.createElement("div",{"aria-label":b.e.linkMembersListLabel,className:"od-ShareLink--inviteesHolder","data-is-focusable":!0,"aria-expanded":this.state.linkMemberExpanded},h.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick},!this.state.linkMemberExpanded&&this._link.audience===f.e.specificPeopleFlex&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&h.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},b.e.inviteesHolderLabel),this._link.audience===f.e.specificPeopleFlex&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),tt.e(this.state.participantRemovedText,"assertive","alert",!0)),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):h.createElement("div",null,h.createElement("div",{className:"od-ShareLink flightOff"},h.createElement("div",{className:"od-ShareLink-main"},h.createElement("div",{className:"od-ShareLink-icon"},h.createElement(Y.e,{iconName:r})),h.createElement("div",{className:"od-ShareLink-details","aria-live":"assertive","aria-relevant":"all"},h.createElement(z.e,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:i,componentRef:function(t){return e._textField=t}})),h.createElement(ee.e,{content:b.e.removeLinkText,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},ariaLabel:b.e.removeLinkText}))),h.createElement("div",{className:"od-ShareLink-description flightOff"},i)),s&&this._renderLinkMembers())};t.prototype.componentDidUpdate=function(){Ae.e.isActivated("0c40b3c2-4638-4643-8284-44108486c2d8","09/26/2019","Resize manage access")||this._resize()};t.prototype._renderLinkDetails=function(){return h.createElement(nt,{companyName:this.props.companyName,link:this._link,participants:this.state.participants,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,mode:this.props.mode,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this._showPermissionsList,enableLinkSettings:this.props.enableLinkSettings,onRemoveLink:this.props.onRemoveLink,addressBarLinkDetails:this.props.isAddressBarLink,addressBarLinkSettings:this.props.addressBarLinkSettings,onOptionChange:this._onOptionChange})};t.prototype._renderParticipantsList=function(){return h.createElement(Re,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings})};t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return h.createElement(Ye,{personas:e,personaSize:Ie.n.size24,maxDisplayablePersonas:4,overflowButtonType:je.descriptive,overflowButtonProps:{ariaLabel:b.e.overflowButtonFacepileAriaLabel}})};t.prototype._renderChevron=function(){var e=this;return h.createElement(ee.e,{content:b.e.inviteesHolderChevronAriaLabel,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{ariaLabel:b.e.inviteesHolderChevronAriaLabel,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}}))};t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})}})};t.prototype._renderShareLink=function(){var e=this,t=this._link,n=t.url,r=this.state.copyLinkToClipboardSuccess,i=Object(Z.h)(this.props.link),s=Object(Z.v)(t,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),o=this._canManageLink(t);return h.createElement("div",{className:"od-ShareLink"},h.createElement("div",{className:"od-ShareLink-main"},h.createElement("div",{className:"od-ShareLink-icon2 icon-"+i},h.createElement(Y.e,{iconName:i,"aria-hidden":!0})),h.createElement("div",{className:"od-ShareLink-details"},h.createElement(z.e,{"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:this._getAriaLabel(),componentRef:function(t){return e._textField=t}})),h.createElement(m.e,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:r?b.e.notificationCopiedLabel:b.e.copyLinkAriaLabel,componentRef:function(t){return e._copyButton=t}},r?b.e.copiedButtonLabel:b.e.copyButtonLabel),this.props.showMoreOptions&&o?h.createElement(ee.e,{content:b.e.moreOptionsLabel,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails,iconProps:{iconName:"More"},ariaLabel:b.e.moreOptionsLabel})):o?h.createElement(ee.e,{content:b.e.removeLinkText,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:a.link})},iconProps:{iconName:"Cancel"},ariaLabel:b.e.removeLinkText})):null),o?h.createElement("div",{className:"od-ShareLink-description",onClick:this._showLinkDetails},h.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?h.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},b.e.statusUnhealthyLinkDescription):h.createElement("span",{className:"od-ShareHintDetail-statusText"},s),this._renderStatusIcons())):h.createElement("div",{className:"od-ShareLink-description"},h.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?h.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},b.e.statusUnhealthyLinkDescription):h.createElement("span",{className:"od-ShareHintDetail-statusText"},s),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){if(!this._link.isUnhealthy){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=this._link.isCreateOnlyLink,i=this._link.trackLinkUsers,s=[];e&&(e<new Date(Date.now())?s.push({icon:"EventDateMissed12",tooltip:""+y.format(b.e.expiredIn2,Object(xe.s)(e))}):e.getTime()!==new Date(0).getTime()&&s.push({icon:"Calendar",tooltip:""+y.format(b.e.expiresIn2,Object(xe.s)(e))}));t&&s.push({icon:"Lock",tooltip:b.e.sharePasswordReminderText});n&&!r&&s.push({icon:"Blocked2",tooltip:b.e.preventDownloadHint});this._link.isReview&&Ne.t[this.props.sharingInformation.fileExtension]&&s.push({icon:"Feedback",tooltip:b.e.officeReviewModeHint});i&&s.push({icon:"ReminderPerson",tooltip:b.e.requireVerificationHint});var o=s.map(function(e,t){return h.createElement("i",{className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},h.createElement(ee.e,{content:e.tooltip,id:e.icon},h.createElement(Y.e,{iconName:e.icon,"aria-describedby":e.icon})))});return h.createElement("div",{className:"od-ShareHintDetail-iconsList"},o)}};t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=Object(Z.v)(this._link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);e&&(e<new Date(Date.now())?r+=" "+y.format(b.e.expiredIn2,Object(xe.s)(e))+".":e.getTime()!==new Date(0).getTime()&&(r+=" "+y.format(b.e.expiresIn2,Object(xe.s)(e))+"."));t&&(r+=" "+b.e.sharePasswordReminderText+".");n&&(r+=" "+b.e.preventDownloadHint+".");return r};t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}));return h.createElement(x.e,null,h.createElement("ul",{"aria-label":b.e.linkMembersListLabel,className:"od-ShareLink--inviteesHolder flightOff","data-is-focusable":!0},e.map(function(e){return h.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},h.createElement(qe,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))};t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isEdit?l.e.edit:this.state.selectedPermissions.isReview?l.e.review:l.e.view};t.prototype._getSharingRoleFromLink=function(){return this._link.isEdit?l.e.edit:this._link.isReview?l.e.review:l.e.view};t.prototype._canManageLink=function(e){if(this._store.isConsumer())return!0;var t=pe.t(e.audience,this.props.sharingInformation.sharingAbilities);return e.isEdit?!!t.canManageEditLink&&t.canManageEditLink.enabled:e.isReview?!!t.canManageReviewLink&&t.canManageReviewLink.enabled:!!t.canManageReadLink&&t.canManageReadLink.enabled};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-webkit-box;display:-ms-flexbox;display:flex;outline:none}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir='ltr'] .od-SharePrincipal-persona{margin-right:8px}[dir='rtl'] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{outline:transparent;position:relative;cursor:pointer;background:none;border:none;padding:0}.od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{border-color:ActiveBorder}}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir='ltr'] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir='ltr'] .od-SharePrincipal-deleteIcon{right:8px}[dir='rtl'] .od-SharePrincipal-deleteIcon{left:8px}\n"}]);var it=n(1326),st=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onStopSharingClick=function(){r.setState({isUpdatingRole:!0});r._store.updatePermissions(r.props.principal,l.e.none)};r.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:r._computeInitialRoleText(t.principal)};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._onPermissionsClick=r._onPermissionsClick.bind(r);return r}t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!C.i(this.props.clientId)&&this._focusElement.focus()};t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})};t.prototype.render=function(){var e=this,t=this.props.principal;return h.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},h.createElement(Fe.e,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:Ie.e.blue,primaryText:t.primaryText,size:Ie.n.regular,imageUrl:t.imageUrl}),h.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},h.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))};t.prototype._computeInitialRoleText=function(e){var t=b.e,n=this.props.principal.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case l.e.edit:return t.canEditLabel;case l.e.review:return b.e.canReviewRole;case l.e.view:return t.canViewLabel;case l.e.owner:return t.ownerLabel;default:return""}};t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?b.e.updatingPermissions:this.state.roleText};t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||this.props.userRole!==l.e.owner||t!==l.e.edit&&t!==l.e.view&&t!==l.e.review?h.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):h.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription"+e.id},h.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),h.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription"+e.id},"Set permissions for "+e.primaryText))};t.prototype._renderChevron=function(e){if(e===l.e.edit||e===l.e.view||e===l.e.review)return h.createElement("div",{className:"od-SharePrincipal-permissions-icon"},h.createElement(Y.e,{iconName:"ChevronDown"}))};t.prototype._renderContextualMenu=function(e){var t,n,r=this,i=b.e;switch(e){case l.e.view:t=l.e.edit;n=b.e.allowEdit;l.e.review;b.e.ReviewOnly;break;case l.e.review:t=l.e.edit;n=b.e.allowEdit;l.e.view;b.e.changeToViewOnly;break;case l.e.edit:t=l.e.view;n=b.e.changeToViewOnly;l.e.review;b.e.ReviewOnly}if(this.state.showContextualMenu)return h.createElement(it.e,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+i.stopSharing,onClick:this._onStopSharingClick}],onDismiss:function(){r.setState({showContextualMenu:!1})},directionalHint:U.e.bottomLeftEdge,isBeakVisible:!0,target:this.state.target})};t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText});this._store.updatePermissions(this.props.principal,e)};t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(t===l.e.edit||t===l.e.view||t===l.e.review)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}\n"}]);var ot=n(1640),ut=n(470),at=n(1600),ft=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._menuElement=Object(h.createRef)();r._showMenu=function(){var e=r.state.showMenu;r.setState({showMenu:!e})};r._hideMenu=function(){r.setState({showMenu:!1})};r._stopSharingConfirmation=function(){r.setState({showConfirmationDialog:!0})};r._onCancel=function(){r.setState({showConfirmationDialog:!1})};r._onStopSharingClick=function(){r._store.updatePermissions(r.props.principal,l.e.none)};r.state={showMenu:!1,showConfirmationDialog:!1,selectedRole:t.principal.role};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._enableCompactRoleSelector=k.n();return r}t.prototype.render=function(){var e=this.props.principal,t=e.role===l.e.owner,n=e.type===ot.e.sharePointGroup,r=!t,i=this.props.sharingInformation;i&&i.sharedObjectType===at.e.list&&(r=!n&&!e.isSiteAdmin||n&&!t);return h.createElement("div",{className:"od-ShareLink-personaItem od-SharePrincipal2","data-is-focusable":!0,"aria-label":this._computeAriaLabel(e,t),tabIndex:-1},h.createElement(x.e,{direction:T.e.horizontal},h.createElement(Fe.e,{className:"od-SharePrincipal-persona2",size:Ie.n.size32,primaryText:e.primaryText,secondaryText:e.isExternal?b.e.externalUser:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}),h.createElement("div",{className:"od-SharePrincipal-permissions"},r?this._renderChangePermissions(e):h.createElement("span",{className:"od-SharePrincipal-ownerLabel"},b.e.ownerLabel))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderRoleSelector=function(e){var t=pe.s(f.e.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),n=this.props.sharingInformation.sharedObjectType===at.e.list,r=n&&this.props.principal.type!==ot.e.sharePointGroup;return h.createElement(le.e,{compact:!0,sharingRole:e,disabled:!1,mode:this.props.mode,clientId:this.props.clientId,ariaLabel:y.format(b.e.permissionsLabelFor,this.props.principal.primaryText),showReview:t,showFullControl:r,isListSharing:n,showStopSharing:!0,onRoleChange:this._onChangeRoleClick,onStopSharing:this._stopSharingConfirmation})};t.prototype._renderChangePermissions=function(e){var t=this.state.selectedRole;return this.props.userRole!==l.e.owner||t!==l.e.edit&&t!==l.e.view&&t!==l.e.review&&t!==l.e.owner?h.createElement("div",{className:"od-SharePrincipal-permissionsRole"},this._renderRoleIcon(e)):this._enableCompactRoleSelector?h.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleSelector(t)):h.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e),this._renderChangePermissionDropdown())};t.prototype._renderRoleIcon=function(e){var t=Object(Z.g)(e.role),n=this._computeRoleText(e);return h.createElement(ee.e,{id:e.id.toString(),content:n,calloutProps:{gapSpace:0}},h.createElement(Y.e,{className:"od-SharePrincipal-roleIcon",iconName:t.name,"aria-describedby":"od-SharePrincipal-tooltip"}))};t.prototype._renderChangePermissionDropdown=function(){var e=Object(ut.e)();return h.createElement("div",{ref:this._menuElement},h.createElement(ue.e,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:y.format(b.e.permissionsLabelFor,this.props.principal.primaryText)}),this.state.showMenu&&h.createElement(it.e,{target:this._menuElement.current,items:Ae.e.isActivated("05d8eb3d-2efd-4c97-bc62-8b8d318b5d4a","5/5/2020","Share Principals dropdown refactoring")?this._getContextualMenuItems_deprecated():this._getContextualMenuItems(),directionalHint:e?U.e.bottomLeftEdge:U.e.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))};t.prototype._onChangeRoleClick=function(e){if(e!==this.props.principal.role){this._store.updatePermissions(this.props.principal,e);this.setState({selectedRole:e})}};t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return h.createElement(w,{confirmationCode:a.participant,participant:t,onApply:this._onStopSharingClick,onCancel:this._onCancel})};t.prototype._getContextualMenuItems_deprecated=function(){var e,t,n,r=this.props.principal.role;switch(r){case l.e.view:n=b.e.canViewLabel;e=l.e.edit;t=b.e.canEditLabel;l.e.review;b.e.canReviewRole;break;case l.e.review:n=b.e.canReviewRole;e=l.e.edit;t=b.e.canEditLabel;l.e.view;b.e.canViewLabel;break;case l.e.edit:n=b.e.canEditLabel;e=l.e.view;t=b.e.canViewLabel;l.e.review;b.e.canReviewRole}return[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,r),checked:!0,iconProps:{iconName:"CheckMark"}},{key:"editable2",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"stopSharing",name:""+b.e.stopSharing,onClick:this._stopSharingConfirmation}]};t.prototype._getContextualMenuItems=function(){var e=this,t=this.props.principal.role,n=pe.s(f.e.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),r=this.props.sharingInformation.sharedObjectType===at.e.list&&this.props.principal.type!==ot.e.sharePointGroup,i={key:"currentRole",name:Object(Z.g)(t).title,onClick:function(){e._onChangeRoleClick(t)},checked:!0,iconProps:{iconName:"CheckMark"}},s={key:"fullControl",name:b.e.fullControlRole,onClick:function(){e._onChangeRoleClick(l.e.owner)}},o={key:"editRole",name:b.e.canEditLabel,onClick:function(){e._onChangeRoleClick(l.e.edit)}},u={key:"reviewRole",name:b.e.canReviewRole,onClick:function(){e._onChangeRoleClick(l.e.review)}},a={key:"viewRole",name:b.e.canViewLabel,onClick:function(){e._onChangeRoleClick(l.e.view)}},c={key:"stopSharing",name:""+b.e.stopSharing,onClick:this._stopSharingConfirmation},h=[i];r&&t!=l.e.owner&&h.push(s);t!=l.e.edit&&h.push(o);n&&t!=l.e.review&&h.push(u);t!=l.e.view&&h.push(a);h.push(c);return h};t.prototype._computeAriaLabel=function(e,t){var n=this._computeRoleText(e),r=e.primaryText+", "+n+".";t||(r+=" "+b.e.sharePrincipalInstruction);return r};t.prototype._computeRoleText=function(e){var t=b.e,n=e.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case l.e.edit:return t.canEditLabel;case l.e.review:return b.e.canReviewRole;case l.e.view:return t.canViewLabel;case l.e.owner:return t.ownerLabel;default:return""}};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),lt=n(1663),ct=n(1416),ht=n(1546),pt=n(1596),dt=n(1699),vt={ODB:1466},mt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._focusAnchorRef=h.createRef();i._showPermissionsList=function(){i.setState({showLinkDetails:!1,showAddressBarLinkDetails:!1})};i._onRemoveLink=function(){i.setState({linkRemovedText:b.e.linkRemovedText});setTimeout(function(){i.setState({linkRemovedText:""})},3e3)};i._onLinkSelected=function(e){i.setState({currentSharingLink:e,showLinkDetails:!0})};i._onShareClick=function(e){i._targetElement=e.target;i._mode=o.e.share;i.setState({showShare:!0})};i._onGrantAccessClick=function(e){i._targetElement=e.target;i._mode=o.e.addPeople;i.setState({showGrantAccess:!0})};i._onDismiss=function(){i._mode===o.e.share?i.setState({showShare:!1}):i.setState({showGrantAccess:!1})};i._onAddressBarLinkClicked=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showAddressBarLinkDetails:!0})})};i._shareClickTime=n.shareClickTime;i._sharingStore=n.sharingStore;i._resize=n.resize;i._mode=i.props.mode;i._addressBarLink=null;i.state={showLinkDetails:!1,showAddressBarLinkDetails:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1,selectedKey:f.e.existing};i._isShareCommandsExperimentOn=C.s(i.props.clientId)&&i.props.shareCommandsExperiment;i._isLinkSettingsEditPanelEnabled=i._sharingStore.showManageAccess()&&(i.props.mode===o.e.manageAccess||i.props.mode===o.e.share||i.props.mode===o.e.addPeople);if(we.e.isFeatureEnabled(vt)){var s=i.props.sharingInformation.sharingLinks?i.props.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink}):[];s.length>0&&(i._addressBarLink=s[0])}i._hasBackButton=i.props.mode!==o.e.manageAccess;return i}t.prototype.componentDidMount=function(){if(this._focusAnchorRef&&this._focusAnchorRef.current){this._focusAnchorRef.current.focus();this._focusAnchorRef.current.blur()}Oe.l(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,this.props.correlationId)};t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails);Ae.e.isActivated("0c40b3c2-4638-4643-8284-44108486c2d8","09/26/2019","Resize manage access")||this._resize()};t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}};t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;if(t.hasPermissionsInformation)if(t.isShared){var r=t.sharedObjectType===at.e.list,i=k.x();e=h.createElement("div",{className:"od-PermissionsList-content","aria-label":b.e.manageExistingAccessLabel},(!r||i)&&h.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),!r&&h.createElement("div",{className:"od-PermissionsList-addressbar"},this._renderAddressBarAccess()," "),h.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n)))}else e=h.createElement("div",null,b.e.notShared);else e=h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(De.e,{className:"od-Share-spinner",label:b.e.componentLoading,type:Pe.t.large}));var s=t.hasInheritedLinks,o=!C.s(this.props.clientId)&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails;return h.createElement("div",{tabIndex:-1,ref:this._focusAnchorRef,className:"od-PermissionsList od-Share-noFocusBorder"},tt.e(b.e.manageExistingAccessLabel,"assertive","alert",!0),o&&this._renderHeader(),s&&this._renderInheritance(n),this.state.showLinkDetails||this.state.showAddressBarLinkDetails?this._renderLinkDetails():e)};t.prototype._renderHeader=function(){return h.createElement("div",{className:"od-PermissionsList-header"},this._hasBackButton&&tt.t(h.createElement(ue.e,{className:"od-Share-backButton",id:"od-PermissionsList-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:b.e.backButtonLabel}),b.e.backButtonLabel,{position:U.e.bottomLeftEdge,targetElementId:"od-PermissionsList-backButton"}),h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,viewState:3,"data-is-focusable":!0,mode:this.props.mode,hasBackButton:this._hasBackButton})))};t.prototype._renderInheritance=function(e){var t,n;this.props.sharingInformation.item.itemType===pt.t.Folder?n=b.e.inheritedLinksFolder:this.props.sharingInformation.item&&(n=b.e.inheritedLinksFile);t=e?y.format(b.e.activeAndInheritedLinks,n):y.format(b.e.onlyInheritedLinks,n);return h.createElement("div",{className:"od-PermissionsList-inheritance"},h.createElement(ht.e,null,t))};t.prototype._renderLinkDetails=function(){if(this.state.showAddressBarLinkDetails){var e=this.props.sharingInformation.addressBarLinkSettings;return h.createElement(rt,{companyName:this.props.companyName,link:this._addressBarLink,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,showPermissionsList:this._showPermissionsList,enableLinkSettings:!0,isAddressBarLink:!0,addressBarLinkSettings:e})}return h.createElement(rt,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink})};t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return h.createElement("div",{className:"od-PermissionsList-linksListHolder"},this._isLinkSettingsEditPanelEnabled&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},h.createElement(Y.e,{iconName:"Link","aria-label":b.e.linkIconLabel,className:"ms-Icon ms-Icon--Link",role:"img","aria-hidden":"true"}),h.createElement("h2",{className:"od-PermissionsList-header"},b.e.linksListHeader),tt.t(h.createElement("span",null,h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.e.linksListHeaderTooltip,role:"img"})),b.e.linksListHeaderTooltip,{tooltipId:"od-ShareLinkDetails-tooltip-links",position:U.e.bottomCenter}),this._isShareCommandsExperimentOn&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},h.createElement(ct.e,{iconProps:{iconName:"Share"},"aria-label":b.e.share,onClick:this._onShareClick,"aria-haspopup":!0},h.createElement("span",null,b.e.share)),this.state.showShare&&this._renderShare())),h.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,r){if(t.audience!==f.e.specificPeople&&t.isActive&&!t.isAddressBarLink){n=!0;return h.createElement("li",{key:t.shareId},h.createElement(rt,{key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList}))}}),!n&&this._renderNoSharingLinks()),this._isLinkSettingsEditPanelEnabled&&h.createElement("div",null,tt.e(n?"":b.e.noLinksGivingAccess,"polite","alert",!0),tt.e(this.state.linkRemovedText,"assertive","alert",!0)))};t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return h.createElement("div",{className:"od-PermissionsList-emptyLinks"},b.e.noLinksGivingAccess)};t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,r=n.sharingPrincipals.slice();return this._isLinkSettingsEditPanelEnabled?h.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},h.createElement(Y.e,{iconName:"PlayerSettings","aria-label":b.e.principalsListHeader,className:"ms-Icon ms-Icon--PlayerSettings",role:"img","aria-hidden":"true"}),h.createElement("h2",{className:"od-PermissionsList-header"},b.e.principalsListHeader),tt.t(h.createElement("span",null,h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.e.principalsListHeaderTooltip,role:"img"})),b.e.principalsListHeaderTooltip,{tooltipId:"od-ShareLinkDetails-tooltip-principals"}),this._isShareCommandsExperimentOn&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},tt.t(h.createElement(ue.e,{iconProps:{iconName:"Add"},"aria-label":b.e.addPeopleLabel,onClick:this._onGrantAccessClick,"aria-haspopup":!0}),b.e.addPeopleLabel),this.state.showGrantAccess&&this._renderShare())),h.createElement("ul",{className:"od-PermissionsList-entities","aria-label":b.e.permissionsListPrincipalsAriaLabel},h.createElement(x.e,{direction:T.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(ut.t)(A.e.right)}},r.map(function(e,r){return h.createElement("li",{key:e.id},h.createElement(ft,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,mode:o.e.manageAccess,sharingInformation:n}))})))):h.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":b.e.permissionsListPrincipalsAriaLabel},r.map(function(r,i){return h.createElement("li",{key:r.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},h.createElement(st,{principal:r,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))}))};t.prototype._renderShare=function(){return h.createElement(R.e,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:U.e.bottomCenter,onDismiss:this._onDismiss},h.createElement(X.e,{isClickableOutsideFocusTrap:!0},h.createElement(Zt,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId,maxWidth:340})))};t.prototype._renderAddressBarAccess=function(){if(we.e.isFeatureEnabled(vt)){var e=this.props.sharingInformation.addressBarLinkSettings,t=Object(dt.e)(this.props.sharingInformation.fileExtension),n="word"===t||"excel"===t||"powerpoint"===t;if(!!e&&(e.linkPermission!==l.e.none&&n||!!this._addressBarLink))return h.createElement("div",{className:"od-PermissionsList-addressBarAccess","aria-label":b.e.addressBarLinkDescription},h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},b.e.addressBarAccess),h.createElement("div",{className:"od-PermissionsList-addressBarDescription"},b.e.addressBarLinkDescription),h.createElement("div",{className:"od-AddressBarLinkHint"},h.createElement(lt.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:null,onShareHintClick:this._onAddressBarLinkClicked,sharingInformation:this.props.sharingInformation,linkRecipients:this.state.currentSharingLink?Object(Z.m)(this.state.currentSharingLink):[],customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:this._addressBarLink})))}};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired,resize:i.func.isRequired};t.childContextTypes={onDismiss:i.func};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-ShareMain-section{padding:20px 16px 0px 16px}.isFluent .od-ShareMain-section{padding:16px 16px 0}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.od-ShareMain-section-experimental{padding:12px 16px 0 16px}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{border-color:ActiveBorder}}.ms-Fabric .od-ShareMain-footer{position:fixed}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir='ltr'] .od-ShareMain-attachIcon{margin-right:4px}[dir='rtl'] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}\n"}]);var gt=n(1840);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir='ltr'] .od-ShareTargets-items{margin-right:-10px}[dir='rtl'] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir='ltr'] .od-ShareTargets-item{margin-right:10px}[dir='rtl'] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.isFluent .od-ShareTargets-icon{font-size:26px}.od-ShareTargets-itemImage--border{border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font:-apple-system-short-caption2}.isFluent .od-ShareTargets-itemText{font-size:10px}.od-ShareTargets-target{outline:transparent;position:relative;background:none;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{border-color:ActiveBorder}}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast: active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:1px solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:2px solid highlight}}\n"}]);var yt,bt=n(1811),wt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==f.e.existing&&this.props.currentSettings.audience!==f.e.anyone&&this.props.currentSettings.audience!==f.e.organization;this._shareTargetsData=this._getShareTargetsData();return e?h.createElement("div",{className:"od-ShareTargets"},h.createElement(ee.e,{content:b.e.accessRequestTooltip,calloutProps:{calloutWidth:300,directionalHint:U.e.topCenter}},h.createElement("ul",{className:"od-ShareTargets-items","aria-label":b.e.otherWaysToShareLabel},this._renderTargets()))):h.createElement("div",{className:"od-ShareTargets"},h.createElement("ul",{className:"od-ShareTargets-items","aria-label":b.e.otherWaysToShareLabel},this._renderTargets()))};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==f.e.existing&&this.props.currentSettings.audience!==f.e.anyone&&this.props.currentSettings.audience!==f.e.organization,n=0,r=this._shareTargetsData;n<r.length;n++){var i=r[n],s=void 0,o=i.icon,u=o.split(":",2)[1],a=t||Object(Z.x)(this.props.sharingInformation),l="od-ShareTargets-icon "+(a?"od-ShareTargets-disabled":""),c="od-ShareTargets-itemText ms-font-xs "+(a?"od-ShareTargets-disabled":"");s=o.indexOf("font:")>-1?h.createElement(Y.e,{iconName:u,className:l}):h.createElement("img",{src:u,className:l});e.push(h.createElement("li",{role:"presentation",key:i.shareType,className:"od-ShareTargets-item"},h.createElement("button",{className:"od-ShareTargets-target",disabled:a,onClick:i.action},h.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage"},s),h.createElement("div",{className:c},i.label))))}return e};t.prototype._getShareTargetsData=function(){var e=[{label:b.e.copyLinkLabel,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:u.e.copy,action:this._onClick.bind(this,u.e.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===bt.e.available?e.push({label:b.e.outlookLabel,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.e.outlook,action:this._onClick.bind(this,u.e.outlook)}):t===bt.e.other&&e.push({label:b.e.nonOutlookLabel,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:u.e.nonOutlook,action:this._onClick.bind(this,u.e.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:b.e.teamsLabel,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.e.teams,action:this._onClick.bind(this,u.e.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:b.e.moreAppsLabel,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:u.e.moreApps,action:this._onClick.bind(this,u.e.moreApps)});return e};t.prototype._onClick=function(e){this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){if(C.v(this.props.clientId)&&this.props.outlookAvailability===bt.e.available)return bt.e.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return bt.e.none}};t.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};t.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};return t})(h.Component);(yt||(yt={})).getAttachAsCopyOptions=function(e,t,n,r){var i=[],s=(function(e,t,n,r){var i=!1,s=n.name.split("."),o="";s.length>1&&(o=s[1].toLowerCase());try{var u=window.external;i=u.IsSendCopyEnabled()}catch(e){}if(i){var a=function(){(function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t);try{window.external.SendCopy()}catch(e){}})(e,r)};return C.h(t)||(function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1})(o)?{key:"word",name:b.e.wordDocument,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:a}:C.f(t)||(function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1})(o)?{key:"powerpoint",name:b.e.powerPointPresentation,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:a}:C.n(t)||(function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1})(o)?{key:"excel",name:b.e.excelWorkbook,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:a}:C.c(t)||(function(e){return["vsd","vsdx"].indexOf(e)>-1})(o)?{key:"visio",name:b.e.visioDrawing,iconProps:{iconName:"VisioLogo"},onClick:a}:{key:"document",name:b.e.document,iconProps:{iconName:"Document"},onClick:a}}})(n,e,t,r);s&&i.push(s);var o=(function(e,t){var n=!1;try{var r=window.external;n=r.IsSendPdfEnabled()}catch(e){}if(n)return{key:"pdf",name:b.e.pdf,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){(function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t);try{window.external.SendPdf()}catch(e){}})(e,t)}}})(n,r);o&&i.push(o);return i};var Et=yt,St=n(516),xt=n(55),Tt={ODB:1637},Nt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._headerControl=Object(h.createRef)();r._peoplePickerHasUnresolvedText=!1;r._onSelectedPeopleChange=function(e){var t=r.props,n=he.s({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:Object(Z.t)(t.sharingInformation)?t.onShareHintClicked:void 0,permissionsMap:t.permissionsMap});if(n){for(var i=t.currentSettings.sharingLinkKind,s=3===i||2===i,o=!1,u=0,a=e;u<a.length;u++){if(a[u].isExternal&&s){o=!0;break}}o&&r.context.sharingStore.getEngagementHelper().externalSharingCslError(t.engagementExtraData)}r.setState({peoplePickerErrorMessage:n},function(){t.onSelectedPeopleChange(e)})};r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._onShareTargetClicked=function(e){!r._isPeoplePickerValid(e)&&(r.props.currentSettings.audience===f.e.specificPeopleFlex||r.props.currentSettings.audience===f.e.specificPeople||r.props.linkRecipients.length>0)||r.setState({showActivityIndicator:!0,shareType:e},function(){r.props.onShareTargetClicked(e)})};r._onSendLinkClicked=function(e,t){r._isPeoplePickerValid(u.e.share)&&r.setState({showActivityIndicator:!0,shareType:u.e.share},function(){r.props.onSendLinkClicked(e,t)})};r._onAttachAsCopyClicked=function(){var e=r.props.clientId;r.context.sharingStore.getEngagementHelper().sendACopyClicked(r.props.engagementExtraData);if(C.o(e)){var t=!r.state.isAttachAsCopyContextualMenuVisible;r.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===Be.e.ngsc||C.i(e))try{window.external.SendCopy()}catch(e){}};r._shareClickTime=n.shareClickTime;r._isRoleSelectorCompactExperimentOn=!1;if(xt.n.isFeatureEnabled(Tt)){var i=new St.t({name:"RoleSelectorCompact",startDate:"07/29/2019",version:St.e.v2});r._isRoleSelectorCompactExperimentOn=i.IsExperimentOn()}r.state={isAttachAsCopyContextualMenuVisible:!1,shareType:u.e.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return r}t.prototype.componentDidMount=function(){Oe.l(this._shareClickTime,this.props.clientId,o.e.share,this.props.scenarioId,this.props.correlationId);this._updatePeoplePickerError(this.props);C.i(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=this.props,n=this.state.showActivityIndicator?this._getActivityMessage():"",i=this.props.hideShareDialogOverflowButton||!1,s=this._renderFooter(),o=s?{className:"od-ShareMain-section-body"}:null;return h.createElement("div",{className:"od-ShareMain"+e},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:t.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:0,hideShareDialogOverflowButton:i,ref:this._headerControl,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus})),h.createElement("div",Object(r.__assign)({},o),h.createElement("div",{className:"od-ShareMain-section full-bleed"},h.createElement(lt.e,{clientId:t.clientId,companyName:t.companyName,currentSettings:t.currentSettings,onShareHintClick:t.onShareHintClicked,sharingInformation:t.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:t.customLabeledAudienceConfig,useDarkBorder:this._isRoleSelectorCompactExperimentOn})),this._renderSendLink(),this._renderTargets()),s,this._renderActivityIndicator(),tt.e(n,"assertive","alert",!0))};t.prototype._renderTargets=function(){return h.createElement("div",{className:"od-ShareMain-targets"},h.createElement(wt,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(C.o(t)){var n=Et.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this.props.engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return h.createElement("div",null,h.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},h.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},h.createElement(Y.e,{iconName:"Copy"})),h.createElement("span",null,b.e.attachACopyInstead)));if(n.length>0)return h.createElement("div",null,h.createElement(m.e,{className:"od-ShareMain-footer",text:b.e.attachACopyInstead,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n}}))}else if((t===Be.e.ngsc||C.i(t))&&this._isSendCopyEnabled())return h.createElement("div",null,h.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},h.createElement("div",{className:"od-ShareMain-attachIcon"},h.createElement(Y.e,{iconName:"Copy"})),h.createElement("span",null,b.e.attachACopyInstead)))};t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||Object(Z.x)(this.props.sharingInformation)){var e=this.props;return h.createElement("div",{className:this._isRoleSelectorCompactExperimentOn?"od-ShareMain-section od-ShareMain-section-experimental":"od-ShareMain-section"},h.createElement(gt.e,{ctaLabel:b.e.sendButtonLabel,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:500,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this.props.engagementExtraData,onShareHintClicked:this.props.onShareHintClicked,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClicked}))}};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:this._getActivityMessage(),ariaHidden:!0})};t.prototype._getActivityMessage=function(){var e=b.e;switch(this.state.shareType){case u.e.share:return e.activityMessageSendingMail;case u.e.copy:case u.e.outlook:case u.e.nonOutlook:case u.e.teams:case u.e.moreApps:default:return e.activityMessageCreatingLink}};t.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==u.e.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===f.e.specificPeople){for(var t=!1,n=!1,r=0,i=this.props.linkRecipients;r<i.length;r++){var s=i[r];t||(t=s.isExternal&&!s.providerName);n||(n=!s.isExternal||s.isExternal&&!!s.providerName)}if(t&&n){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.e.mixedRecipientErrorMessage)});return!1}}var o=this.props.currentSettings.audience===f.e.specificPeopleFlex||this.props.currentSettings.audience===f.e.specificPeople||e===u.e.share;if(this._peoplePickerHasUnresolvedText){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.e.unresolvedTextError)});return!1}if(0===this.props.linkRecipients.length&&o){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.e.recipientsRequiredError)});return!1}return!0}};t.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=he.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(Z.t)(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState({peoplePickerErrorMessage:t,showActivityIndicator:!t&&this.state.showActivityIndicator})}};t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0px 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}\n"}]);var Ct=n(2046),kt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;1===e?i._store.updatePolicy(0):2===e&&i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showJustificationInput:!0}))};i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(0,e)};i._onReportClicked=function(){i._store.updatePolicy(1)};i._store=n.sharingStore;i._resize=n.resize;i.state={showJustificationInput:!1};return i}t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return h.createElement("div",{className:"od-SharePolicyDetails"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:e.sharingInformation.item,viewState:6,hasBackButton:!0})),h.createElement("div",{className:"od-Share-PolicyTip"},h.createElement(Ct.e,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?2===n.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:b.e.ptHeader,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?b.e.ptLastScanned+": "+Object(xe.r)(e.lastScanned):void 0,learnMoreActionLabel:e?b.e.ptLearnMoreActionLabel:void 0,learnMoreLabel:e?b.e.ptLearnMoreLabel:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:b.e.ptNoPolicyTipInfo,overrideActionLabel:t?b.e.ptOverrideActionLabel:void 0,overrideLabel:b.e.ptOverrideLabel,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:b.e.ptReportActionLabel,reportLabel:b.e.ptReportLabel,reportInProgressLabel:b.e.ptReportInProgress,submitButtonLabel:b.e.ptSubmitLabel,titleText:void 0}};t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?b.e.ptReportConfirmation:2===e||3===e?b.e.ptOverrideConfirmation:""};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),Lt=n(1543),At=n(1838);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Notify{padding:0px 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-Notify .ms-Checkbox-label{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-message{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:15px;padding:6px 0px 4px 0px;margin:0px 3px 0px 0px}[dir='rtl'] .od-Notify-message{margin:0px 0px 0px 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0px 0px auto}[dir='rtl'] .od-Notify-show-link{margin:8px auto 0px 0px}.od-Notify-sendNotification-button{margin:24px auto 6px 0px}[dir='ltr'] .od-Notify-sendNotification-button{text-align:right}[dir='rtl'] .od-Notify-sendNotification-button{text-align:left}[dir='rtl'] .od-Notify-sendNotification-button{margin:24px 0px 6px auto}.od-Notify-group-recipient{display:-webkit-box;display:-ms-flexbox;display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0px 0px 0px auto}[dir='rtl'] .od-Notify-PickerPersona-checkbox{margin:0px auto 0px 0px}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0px 10px 0px 0px;font-size:13px}[dir='rtl'] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0px 0px 0px 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,0.3)}[dir='ltr'] .od-Notify-recipientWarning{left:0}[dir='rtl'] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0px 0px 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:6px 0px;margin:0px 0px 0px auto}[dir='ltr'] .od-Notify-totalMembersCount{text-align:right}[dir='rtl'] .od-Notify-totalMembersCount{text-align:left}[dir='rtl'] .od-Notify-totalMembersCount{margin:0px auto 0px 0px}.od-Notify-groups-expand{height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;margin:14px 0px 0px}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0px 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0px 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0px}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:11px}[dir='ltr'] .od-Notify-groupMembersCount{margin-left:28px}[dir='rtl'] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0px}\n"}]);var Ot=n(2040),Mt=n(1544),_t=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.group;n.checked=t;r.setState({group:n},function(){r._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",r.props.engagementExtraData);r.props.updateCountCallback();r.props.updateCheckboxForGroup(n)})};r._sharingStore=n.sharingStore;r.state={group:t.group};return r}t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)};t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)};t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return h.createElement(O.e,{id:e.email,boxSide:"start",label:t?e.name+" ("+b.e.notifyGroupReachedAllowedLimit+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(F.e)("od-Notify-group-checkbox"),disabled:e.disabled})};t.prototype.render=function(){var e=this.state.group,t=e.disabled;return h.createElement(ee.e,{className:Object(F.e)("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+b.e.notifyGroupReachedAllowedLimit+")":e.name,directionalHint:U.e.bottomCenter},this._renderGroup())};t.contextTypes={sharingStore:i.object.isRequired,strings:i.object.isRequired};return t})(h.Component),Dt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.person;n.checked=t;r.setState({person:n});r.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",r.props.engagementExtraData);r.props.updateCheckboxForPerson(n)};r.state={person:t.person};return r}t.prototype.render=function(){var e=this.state.person;return h.createElement("div",{className:Object(F.e)("od-Notify-PickerPersona-container")},h.createElement(Fe.e,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:Ie.n.extraSmall,className:Object(F.e)("od-Notify-PickerPersona")}),h.createElement(O.e,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(F.e)("od-Notify-PickerPersona-checkbox")}))};t.contextTypes={sharingStore:i.object.isRequired,strings:i.object.isRequired};return t})(h.Component),Pt=n(1709),Ht=n(1660),Bt=n(94),jt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=h.createRef();i._onExpandClick=function(){i.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isExpanded:!e.isExpanded})},function(){i._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",i.props.engagementExtraData)})};i._onStoreUpdate=function(){var e=i._sharingStore.getPermissionsMap(),t=he.s({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&i._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",i.props.engagementExtraData);e=Object(r.__assign)(Object(r.__assign)({},i.state.permissionsMap),e);i.setState(function(n){return Object(r.__assign)(Object(r.__assign)({},n),{peoplePickerError:t,permissionsMap:e})})};i._onPeoplePickerSelected=function(e){i._sharingStore.checkPermissions(e);e.filter(function(e){return e.principalType!==ot.e.user}).forEach(function(e){i._sharingStore.fetchMemberCount(e)});i._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",i.props.engagementExtraData);var t=i._sharingStore.getPermissionsMap(),n=he.s({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:t});t=Object(r.__assign)(Object(r.__assign)({},i.state.permissionsMap),t);i.setState(function(i){return Object(r.__assign)(Object(r.__assign)({},i),{peoplePickerRecipients:e,peoplePickerError:n,permissionsMap:t})})};i._onResolvedSuggestions=function(e){i._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._updateGroupCount=function(){for(var e=i._sharingStore.getMembersCounts(),t=i.state.groups.slice(0),n=0;n<t.length;n++){var s=i.state.groups[n];if(e[s.email]!==s.memberCount){s.memberCount=e[s.email];s.checked=!1;s.disabled=s.memberCount>=100;t[n]=s}}i.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{groups:t})})};i._updateCheckboxForGroup=function(e){var t=i.state.groups;t.map(function(t){return t.email===e.email?e:t});i.setState({groups:t})};i._updateCheckboxForPerson=function(e){var t=i.state.people;t.map(function(t){return t.email===e.email?e:t});i.setState({people:t})};i._sendNotification=function(){var e=i._allRecipients();i.setState({showActivityIndicator:!0},function(){Oe.p();i._sharingStore.shareLink({settings:i.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0});i._sharingStore.getEngagementHelper().shareCompleted(Object(r.__assign)(Object(r.__assign)({},i.props.engagementExtraData),{recipientsCount:e.length}));Oe.d(u.e.share);i._showSuccessMessage()})};i._onGroupsExpandClick=function(){var e=i.state.groupsIsExpanded;i.setState(function(t){return Object(r.__assign)(Object(r.__assign)({},t),{groupsIsExpanded:!e})},function(){i._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",i.props.engagementExtraData)})};i._selectAllPeopleCheckbox=function(e,t){var n=i.state.people;n.map(function(e){e.checked=t;return e});i.setState({people:n})};i._sharingStore=n.sharingStore;i._shareClickTime=n.shareClickTime;i._resize=n.resize;i.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:9};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var n=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(n).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),s=i.filter(function(e){return e.principalType!==ot.e.user}).map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});s.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===ot.e.user}),u={};o.concat(s).forEach(function(e){u[e.email]=3});this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==ot.e.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)});this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:s,people:o,peoplePickerError:null,permissionsMap:u,viewState:9})};t.prototype.componentDidMount=function(){Oe.l(this._shareClickTime,this.props.clientId,o.e.notify,this.props.scenarioId,this.props.correlationId);this.setState({groupsIsExpanded:!1,isExpanded:!1});this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return h.createElement("div",{className:Object(F.e)("od-Notify-PeoplePicker")},h.createElement(de.e,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))};t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)};t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)});return Object.keys(t).map(function(n){return t[n].principalType===ot.e.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)};t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))};t.prototype._showSuccessMessage=function(){this.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{viewState:4,showActivityIndicator:!1})})};t.prototype._renderGroup=function(e){return h.createElement(_t,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderGroups=function(e){var t=this,n=this.state,r=n.groupsIsExpanded?" expanded ":"",i=n.groups.length>5?" scroll ":"";if(0!==e.length)return h.createElement("div",{className:Object(F.e)("od-Notify-groups-container")},h.createElement("div",{className:Object(F.e)("od-Notify-groups-expand")},h.createElement(Ot.e,{className:Object(F.e)("od-Notify-groupLabel")},b.e.notifyGroupsLabel),h.createElement(ue.e,{className:"od-Notify-group-expand-icon",iconProps:{iconName:r?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),h.createElement("div",{className:Object(F.e)("od-Notify-groups-recipient-container"+r+i)},r&&e.map(function(e){return h.createElement("div",{key:e.email,className:Object(F.e)("od-Notify-groups-listItem")},t._renderGroup(e))})))};t.prototype._renderPerson=function(e){return h.createElement(Dt,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderPeople=function(e){var t=this,n=this.state,r=n.people.length>5?" scroll ":"";return h.createElement("div",{className:Object(F.e)("od-Notify-people-container")},h.createElement(Ot.e,{className:Object(F.e)("od-Notify-peopleLabel")},b.e.notifyPeopleLabel),n.people.length>0&&h.createElement(O.e,{label:b.e.notifySelectAllPeople,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:Object(F.e)("od-Notify-people-selectAll-checkbox")}),h.createElement("div",{className:Object(F.e)("od-Notify-people-recipient-container"+r)},e.map(function(e){return t._renderPerson(e)})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.e.activityMessageSendingMail})};t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,i={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return h.createElement(_e.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:u.e.share,itemName:t.item.name,linkUrl:null,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}))};t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?y.format(b.e.notifyMembersTotalPlus,e):1===e?y.format(b.e.notifyMemberTotal):0===e?"":y.format(b.e.notifyMembersTotal,e)};t.prototype._tooManyRecipientsErrorString=function(){return b.e.peoplePickerLimitMessage};t.prototype._displayTotalMembersCountOrError=function(){return h.createElement(Ot.e,{className:Object(F.e)("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=100?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())};t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":y.format(b.e.notifyGroupsMembersTotalPlus,e)};t.prototype._displayTotalGroupsMembersCount=function(){return h.createElement(Ot.e,{className:Object(F.e)("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())};t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=y.format(b.e.notifyLargeRecipientWarning,e);return e>20&&e<100&&h.createElement("div",{className:"od-Notify-recipientWarning-container"},h.createElement(ht.e,{className:Object(F.e)("od-Notify-recipientWarning"),messageBarType:Bt.e.severeWarning,isMultiline:!0},t))};t.prototype._sendButtonError=function(){return h.createElement(Ot.e,null,b.e.notifySendButtonError)};t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",i=Z.L(this.props.sharingInformation.item.name,10);return h.createElement("div",{className:"od-Notify"+n},h.createElement("div",{className:"od-Notify-headerAndMessage"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9})),h.createElement(Ot.e,{className:Object(F.e)("od-Notify-message")},y.format(b.e.notifyMessage,i))),this._renderWarning(),!e.isExpanded&&h.createElement("div",null,h.createElement("div",{className:Object(F.e)("od-Notify-horizontalLine")}),h.createElement(Mt.e,{onClick:this._onExpandClick,className:Object(F.e)("od-Notify-show-link")},b.e.sendNotifyLinkExpandLink)),e.isExpanded&&h.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),h.createElement("div",{className:Object(F.e)("od-Notify-sendNotification-button")},h.createElement(Pt.e,{ctaLabel:b.e.sendNotifyLinkButton,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=100?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:Ht.e.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))};t.prototype._renderViews=function(){switch(this.state.viewState){case 4:return this._renderNotification();default:return this._renderNotifyMain()}};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return h.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())};t.contextTypes={resize:i.func.isRequired,strings:i.object.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t})(h.Component),Ft=n(63),It=n(95);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.isFluent .od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-AddPeople-Success{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{margin-top:24px}.od-AddPeople-Failure{padding:24px 16px 0 16px}.od-AddPeople-NotAllowed{padding:0 16px}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;margin-bottom:12px}.od-AddPeople-Edit-Section{margin:0px 16px 0px 16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap}.od-AddPeople-Edit-Section .od-AddPeople-Edit-Section-PermissionAlert{margin-bottom:8px}.od-AddPeople-Edit-Section .ms-TextField-wrapper{margin:6px 0}.od-AddPeople-Message{margin-top:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0}.od-PeoplePicker-RoleSelector-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-AddPeople-NotificationSelector{-ms-flex-item-align:start;align-self:flex-start;margin-top:12px;margin-bottom:12px}[dir='ltr'] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-left:4px}[dir='rtl'] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-right:4px}[dir='ltr'] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-right:4px}[dir='rtl'] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-left:4px}.od-AddPeople-AddButton{-ms-flex-item-align:start;align-self:flex-start}\n"}]);var qt,Rt=n(1659),Ut=(function(e){Object(r.__extends)(t,e);function t(t,n){var i,s=e.call(this,t)||this;s._peoplePickerHasUnresolvedText=!1;s._topLevelDivRef=h.createRef();s._onPeoplePickerChange=function(e){s.setState(function(t,n){var i=he.s({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:n.sharingInformation.canAddExternalPrincipal,sharingInformation:n.sharingInformation,viewPolicyTipCallback:function(){return null}}),o=s.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return Object(r.__assign)(Object(r.__assign)({},t),{people:e,notifyRecipients:o,peoplePickerError:i})})};s._onPeoplePickerInputChange=function(e){s._peoplePickerHasUnresolvedText=""!==e};s._onMessageChange=function(e,t){s.setState({messageText:t})};s._validateMessage=function(e){var t,n=Object(Z.f)(e);s.setState({messageText:e});if(n<=500){t="";s.setState({shareMessageError:!1})}else{t=n+"/500";s.setState({shareMessageError:!0})}return t};s._onRoleSelectorChange=function(e){s.setState({roleSelection:e})};s._onAllowEditChange=function(e,t){s.setState({notifyRecipients:t})};s._onAddButtonClick=function(){if(s._peoplePickerHasUnresolvedText)s.setState(Object(r.__assign)(Object(r.__assign)({},s.state),{peoplePickerError:h.createElement("span",null,b.e.unresolvedTextError)}));else{var e=s.state.messageText||null;s._store.addPeople(s.state.people,s.state.roleSelection,s.userRequiresAccessApproval(),s.state.notifyRecipients,e);s.props.onLoading&&s.props.onLoading({notifiedRecipients:s.state.notifyRecipients,requestedAccess:s.userRequiresAccessApproval()})}};s._store=n.sharingStore;s._resize=n.resize;s._store.addListener(function(){var e=s._store.getAddPeopleResult();if(null!==e){var t=e===Rt.e.AccessRequestsQueued||e===Rt.e.CompletedSuccessfully,n=s.userRequiresAccessApproval();t&&s.props.onSuccess?s.props.onSuccess({notifiedRecipients:s.state.notifyRecipients,requestedAccess:n}):s.props.onFailure&&s.props.onFailure({notifiedRecipients:s.state.notifyRecipients,requestedAccess:n})}});i=s.props.sharingInformation.userRole===l.e.owner?l.e.edit:s.props.sharingInformation.userRole;var o=he.s({selectedItems:s.props.currentSettings.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:s.props.sharingInformation.canAddExternalPrincipal,sharingInformation:s.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});s.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,peoplePickerError:o,shareMessageError:!1};s._resizeTracker=new oe.e(n.resize);return s}t.prototype.componentDidMount=function(){this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype.render=function(){return h.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople-Edit"},h.createElement("div",{className:"od-AddPeople-Edit-Header"},this._renderHeader()),h.createElement("div",{className:"od-AddPeople-Edit-Section"},this.userRequiresAccessApproval()&&this._renderRequestAccessAlert(),this._renderPeoplePicker(),!k.n()&&h.createElement("div",{className:"od-AddPeople-RoleSelector"},h.createElement(le.e,Object(r.__assign)({},this._getRoleSelectorProps(!1)))),this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.peoplePickerError&&!1===this.state.shareMessageError};t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval};t.prototype.numberSelectedUnverifiedExternals=function(){return this.state.people.filter(function(e){return Object(he.i)(e)}).length};t.prototype._getRoleSelectorProps=function(e){var t=this.props.sharingInformation.sharedObjectType===at.e.list;return{compact:e,sharingRole:this.state.roleSelection,mode:o.e.addPeople,clientId:this.props.clientId,ariaLabel:b.e.addPeopleRoleSelectorAriaLabel,showReview:!1,showFullControl:t,showStopSharing:!1,isListSharing:t,onRoleChange:this._onRoleSelectorChange}};t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=he.n(e),n=he.r(e,0);return h.createElement("div",{className:"od-Share-PeoplePicker"},h.createElement(de.e,{defaultSelectedItems:this.state.people,error:this.state.peoplePickerError,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:1,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:null,onInputChange:this._onPeoplePickerInputChange,roleSelectorProps:this._getRoleSelectorProps(!0),renderRoleSelector:k.n()}))};t.prototype._renderHeader=function(){return h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,hideShareDialogOverflowButton:!this.props.onManageExistingAccessClick,onManageExistingAccessClick:this.props.onManageExistingAccessClick,viewState:10}))};t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return k.s()?h.createElement(z.e,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:b.e.messagePlaceholder,ariaLabel:b.e.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage}):h.createElement(z.e,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:b.e.messagePlaceholder,value:this.state.messageText,ariaLabel:b.e.messageAriaLabel,multiline:!0,resizable:!1,onChange:this._onMessageChange})};t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return h.createElement(O.e,{className:"od-AddPeople-NotificationSelector",disabled:e,label:b.e.notifyPeople,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients})};t.prototype._renderAddButton=function(){var e=b.e.addButtonLabel;return h.createElement(g.e,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton"},e)};t.prototype._renderRequestAccessAlert=function(){return h.createElement(ht.e,{className:"od-AddPeople-Edit-Section-PermissionAlert"},b.e.requestAccessDetail)};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),zt=n(1654);(function(e){e[e.edit=0]="edit";e[e.successGrantingPermissions=1]="successGrantingPermissions";e[e.successRequestingPermissions=2]="successRequestingPermissions";e[e.failure=3]="failure";e[e.notAllowed=4]="notAllowed"})(qt||(qt={}));var Wt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=h.createRef();i._onLoading=function(e){i.setState(function(t,n){if(t.view===qt.edit){var i=void 0;i=e.requestedAccess?b.e.activityRequestingAccess:e.notifiedRecipients?b.e.activityAddingAndNotifying:b.e.activityAdding;return Object(r.__assign)(Object(r.__assign)({},t),{loading:!0,message:i})}return t})};i._onSuccess=function(e){var t,n;if(e.requestedAccess){t=b.e.accessRequested;n=qt.successRequestingPermissions}else{t=e.notifiedRecipients?b.e.addedAndNotified:b.e.added;n=qt.successGrantingPermissions}i.setState({view:n,message:t,loading:!1});k.m()&&i._store.getEngagementHelper().log(zt.t.Completed,{accessRequested:e.requestedAccess});Oe.e(!0,t)};i._onFailure=function(e){var t=b.e.addFailed;i.setState({view:qt.failure,message:t,loading:!1});Oe.e(!1,t)};i._store=n.sharingStore;i._shareClickTime=n.shareClickTime;i._resize=n.resize;i._dismiss=n.onDismiss;var s=!1===t.sharingInformation.canAddExternalPrincipal&&!1===t.sharingInformation.canAddInternalPrincipal&&!1===t.sharingInformation.canRequestAccessForGrantAccess;i.state={message:"",view:s?qt.notAllowed:qt.edit,loading:!1};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidMount=function(){Oe.l(this._shareClickTime,this.props.clientId,o.e.addPeople,this.props.scenarioId,this.props.correlationId);this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype.render=function(){var e=this.state.loading?" blocker":"";return h.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople"+e},this.renderView(),this.state.loading?h.createElement(c.e,{message:this.state.message}):null)};t.prototype.renderView=function(){switch(this.state.view){case qt.edit:return h.createElement(Ut,Object(r.__assign)({},Object(E.e)(this.props),{sharingInformation:this.props.sharingInformation,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked,onManageExistingAccessClick:this.props.onManageExistingAccessClick}));case qt.successGrantingPermissions:return this._renderSuccessGranting();case qt.successRequestingPermissions:return this._renderSuccessRequesting();case qt.failure:return this._renderFailure();case qt.notAllowed:return this._renderNotAllowed()}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderSuccessGranting=function(){return h.createElement("div",{className:"od-AddPeople-Success"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement(Y.e,{className:"od-ShareNotification-icon",iconName:"CheckMark"}),h.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),h.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderSuccessRequesting=function(){return h.createElement("div",{className:"od-AddPeople-Success"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement(Y.e,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),h.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),h.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderFailure=function(){return h.createElement("div",{className:"od-AddPeople-Failure"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement("p",null,this.state.message))};t.prototype._renderNotAllowed=function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{hideShareDialogOverflowButton:!0,title:b.e.needPermissionToShare,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement("div",{className:"od-AddPeople-NotAllowed"},h.createElement("p",null,b.e.needPermissionToShareListText1),h.createElement("p",null,b.e.needPermissionToShareListText2),h.createElement(g.e,{autoFocus:!0,onClick:function(){e._dismiss()}},b.e.okayButtonLabel)))};t.contextTypes={sharingStore:i.object.isRequired,shareClickTime:i.number,resize:i.func.isRequired,onDismiss:i.func.isRequired};return t})(h.Component),Xt=n(3524),Vt=n(1823);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-error{padding:16px;font-size:14px;font-weight:400;word-break:break-word;outline:transparent;position:relative;margin-bottom:30px}.od-Share-error::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share-error:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-Share-error:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-Share-error-details{float:left}[dir='rtl'] .od-Share-error-details{float:right}.od-Share-error-copy{margin-top:10px}[dir='ltr'] .od-Share-error-copy{float:right}[dir='rtl'] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:50px}[dir='ltr'] .od-Share-error-report{float:right}[dir='rtl'] .od-Share-error-report{float:left}[dir='ltr'] .od-Share-error-report{margin-right:5px}[dir='rtl'] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:10px}[dir='ltr'] .od-Share-error-chevron{margin-left:5px}[dir='rtl'] .od-Share-error-chevron{margin-right:5px}.od-Share-error-technical{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding:0 10px 10px 10px;margin-bottom:10px}[dir='rtl'] .od-Share-error-technical{padding:0 10px 10px 10px}\n"}]);var $t,Jt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._errorMessage=Object(h.createRef)();r._onToggleDetailsClicked=function(){r.setState({areDetailsVisible:!r.state.areDetailsVisible})};r._onCopyToClipboardClicked=function(){Object(Vt.e)(r.props.sharingInformation.debugErrorMessage||"")};r._resize=n.resize;r.state={areDetailsVisible:!1};return r}t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus();this._resize()};t.prototype.render=function(){var e=b.e,t=this.state.areDetailsVisible&&this.props.sharingInformation.debugErrorMessage?h.createElement("div",{className:"od-Share-error-technical"},h.createElement("h4",null," ",e.errorTechnicalDetails," "),h.createElement("div",null,this.props.sharingInformation.debugErrorMessage),h.createElement(Xt.e,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},e.errorCopyTechnicalDetails),h.createElement("span",{className:"od-Share-error-clear"})):null,n=this.props.showReportProblem?h.createElement("div",{className:"od-Share-error-report"},e.errorReportProblem):null,r=this.props.sharingInformation.debugErrorMessage?h.createElement("div",{className:"od-Share-error-details",onClick:this._onToggleDetailsClicked},this.state.areDetailsVisible?e.errorHideDetails:e.errorShowDetails,h.createElement(Y.e,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;return h.createElement("div",{className:"od-Share-error",role:"alert",tabIndex:0,ref:this._errorMessage},h.createElement("h2",null," ",e.errorTitle," "),h.createElement("div",{className:"od-Share-error-message"},h.createElement("p",null," ",this.props.sharingInformation.errorMessage," "),this.props.sharingInformation.fixItUrl&&h.createElement("a",{href:this.props.sharingInformation.fixItUrl,target:"_blank"},b.e.fixIt),t),h.createElement("div",null,r,n))};t.contextTypes={resize:i.func.isRequired};return t})(h.Component),Kt=n(1845),Qt=n(77),Gt=n(4225),Yt=n(31);(function(e){e[e.default=0]="default";e[e.shareShimmer=1]="shareShimmer";e[e.modifyPermissions=2]="modifyPermissions";e[e.permissionsList=3]="permissionsList";e[e.linkSuccess=4]="linkSuccess";e[e.grantPermissions=5]="grantPermissions";e[e.policyDetails=6]="policyDetails";e[e.error=7]="error";e[e.linkSettings=8]="linkSettings";e[e.notify=9]="notify";e[e.addPeople=10]="addPeople";e[e.linksFromTemplateList=12]="linksFromTemplateList";e[e.atMention=13]="atMention";e[e.spinner=14]="spinner"})($t||($t={}));var Zt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._viewStates=[];i._shareMainControl=Object(h.createRef)();i._topLevelDivRef=h.createRef();i._copyLinkOnCancelClicked=function(){i._returnToPreviousView()};i._copyLinkOnApplyClicked=function(e){i.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onCopyLinkClicked(!0)})};i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})};i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})};i.onRoleChange=function(e){var t=e===l.e.edit,n=e===l.e.view,s=e===l.e.review;if(!t&&!n&&!s)throw new Error("Role not implemented: "+l.e[e]);var o=i.state.currentSettings,u=s?6:Object(Z.d)(o.audience,t);o.sharingRole!==e&&i._store.getEngagementHelper().log("SharingRoleChanged",{isEdit:t,isReview:s});i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{currentSettings:Object(r.__assign)(Object(r.__assign)({},o),{sharingRole:e,isEdit:t,isReview:s,sharingLinkKind:u})}))};i._onShareTargetClicked=function(e){if(e===u.e.copy){Oe.t();i._onCopyLinkClicked()}else e===u.e.outlook?i._onOutlookClicked():e===u.e.nonOutlook?i._onNonOutlookClicked():e===u.e.teams?i._onTeamsClicked():e===u.e.moreApps&&i._onMoreAppsClicked()};i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onSelectedPermissionsChange(e);i.props.mode===o.e.linkSettings&&i.setState({shareType:u.e.share,applyLinkSettingsClicked:!0},function(){var e=i.state.linkRecipients;if(C.l(i.props.clientId)){var t=i.state.currentSettings.sharingLinkKind;3!==t&&2!==t||(e=e.filter(function(e){return!e.isExternal}))}i._store.shareLink({settings:i.state.currentSettings,recipients:e,copyLinkCommand:!1})})};i._onLinkPermissionsCancelClicked=function(){i.props.mode===o.e.linkSettings&&Oe.n();i._returnToPreviousView()};i._returnToPreviousView=function(){if(i._viewStates&&i._viewStates.length){i.setState({viewState:i._viewStates.pop()});2===i.state.viewState&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)}};i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)};i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===f.e.existing&&i._store.checkPermissions(e);i._store.resetPeoplePickerError();i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.fetchGroupsMemberCount(e)})};i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients;i.setState({shareType:u.e.share,recipientsCount:n.length,externalRecipientsCount:he.e(n),linkedinRecipientsCount:he.t(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){Oe.p();i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})};i._onViewPolicyTipClicked=function(){i._viewStates.push(i.state.viewState);i.setState({viewState:6})};i._onSendLinkMessageChange=function(e){i.setState({messageText:e})};i._onSendLinkSubjectChange=function(e){i.setState({subjectText:e})};i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData);i.setState({shareType:u.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData);i.setState({shareType:u.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})};i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData);i.setState({showCopyLinkInterrupt:!1});i._shareMainControl.current.shouldShowActivityIndicator(!1)};i._showModifyPermissions=function(e){i._viewStates.push(i.state.viewState);i.setState({viewState:2},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData)})};i._showPermissionsList=function(){i._viewStates.push(i.state.viewState);i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,r=n&&!t;t?Oe.s():r?n():i.setState({viewState:3})};i._dismiss=n.onDismiss;i._resize=n.resize;i._store=n.sharingStore;i._shareClickTime=n.shareClickTime;i._isPeopleSharingLinksEnabled=!1;var s=Oe.o(),a=t.theme;!a&&k.d()&&(a=Oe.r());(a&&(!k.i()||i.props.clientId!==Be.e.wac)||s)&&i._loadTheme(s?Object(Z.u)():a);i._sizeConstraints={maxHeight:C.i(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none"};var c={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:u.e.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1};c.viewState=t.mode===o.e.share?1:14;i.state=c;i._baseProps=Object(E.e)(t);i._correlationId=i.props.correlationId||Qt.e.generate();i._baseProps.correlationId=i._correlationId;i._engagementExtraData={clientId:t.clientId,scenarioId:t.scenarioId,correlationId:i._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?o.e.copy:o.e.share)};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidMount=function(){var e=this;try{this._store.getEngagementHelper().log(zt.t.Opening,this._engagementExtraData);this._copyLinkCustomerPromise=new Gt.e({scenario:"CopyLink",extraData:{clientId:this.props.clientId}});var t=this._store;new It.t(this).on(window,"keydown",function(t){t&&t.keyCode===A.e.escape&&e._handleEscKeyPress(t)});t.addListener(function(n){try{if(k.p()&&7===e.state.viewState)return;if(k.v()&&e.props.mode===o.e.copy&&n&&n.type===Rt.t.UnshareLink)return;var i=t.getSharingInformation(),s=t.getSharingLinkCreated(),a=t.getCompanyName(),f=t.getGroupsMemberCount(),l=t.getPolicyTipInformation(),c=t.getPermissionsMap(),h=t.getDefaultRecipients();e._outlookAvailability=t.getOutlookAvailability();e._isPeopleSharingLinksEnabled=t.isPeopleSharingLinksEnabled();if(!i)return;i.webTemplateId&&(e._engagementExtraData.webTemplateId=i.webTemplateId);i.itemUniqueId&&(e._engagementExtraData.itemUniqueId=i.itemUniqueId);var p=e._store.getItemInformationForLogging(),d=p.itemType,v=p.extension;e._engagementExtraData.itemType=d;e._engagementExtraData.extension=v;k.E()&&e._sanitizeSharingContextInfo(i);var m=e._getSettings(i),g=Object(r.__assign)({},e.state);if(1===e.state.viewState||14===e.state.viewState){g.viewState=e._getInitialViewState(i,m,s);1!==g.viewState&&14!==g.viewState&&k.S()&&Oe.m()}if(i&&i.error){Oe.f(e._shareClickTime,e.props.clientId,e.props.mode,e.props.scenarioId,i,e._correlationId);g.viewState=7;g.sharingInformation=i}else if(s&&(e.state.shareTargetClicked||e.props.copyLinkShortcut||e.state.applyLinkSettingsClicked)){e._modifiedSharingLinkUrl=e._getModifiedSharingLinkUrl(s,m,i);var y=e.state.shareType,b=e.state.currentSettings,w=b?b.isEdit:m.isEdit,E=b?b.isReview:m.isReview,S=b?b.preventDownload:m.preventDownload,x=b?b.audience:m.audience,T=pe.i(x,i.sharingAbilities,i.fileExtension),N=pe.s(x,i.sharingAbilities,i.fileExtension),L=Object(r.__assign)(Object(r.__assign)({},e._engagementExtraData),{shareType:y,audience:s.audience,isEdit:w,isReview:N&&E,recipientsCount:e.state.recipientsCount,externalRecipientsCount:e.state.externalRecipientsCount,linkedinRecipientsCount:e.state.linkedinRecipientsCount,hasMessage:e.state.hasMessage,hasSubject:e.state.hasSubject,messageLength:e.state.messageLength,daysUntilExpiry:e._getNumberOfDaysUntilExpiry(s),isDefaultLink:i.defaultSharingLink.sharingLinkKind===s.sharingLinkKind,linkBlocksDownload:!!S,linkWithOfficeReviewMode:T&&E,groupRecipientCount:e.state.linkRecipients.filter(function(e){return 2===e.entityType&&null==e.familySharingTargetType}).length});if(we.e.isFeatureEnabled({ODC:"FamilySharing"})&&C.m(e.props.clientId)){L.sharedToFamilyGroup=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===Kt.e.Family});L.sharedToFamilyMember=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===Kt.e.FamilyMember})}e._store.getEngagementHelper().shareCompleted(L);var A=Object(Z.w)(s.sharingLinkKind);Oe.d(e.state.shareType,A);if(y===u.e.outlook||y===u.e.nonOutlook)if(C.v(e.props.clientId)){e._store.navigateToOwa(e._getRecipientEmails(e.state.linkRecipients),e._modifiedSharingLinkUrl);Oe.a();e._dismiss()}else try{window.external.SendViaOutlookWithContext(e._getRecipientEmails(e.state.linkRecipients),e.state.linkRecipients.length,e.state.messageText,e._modifiedSharingLinkUrl)}catch(e){}else if(y===u.e.teams){e._dismiss();Oe.v(s,e._getRecipientEmails(e.state.linkRecipients),e.state.messageText)}else if(y===u.e.moreApps)try{g=Object(r.__assign)(Object(r.__assign)({},g),{viewState:4,companyName:a,sharingLinkCreated:s,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(s.url)}catch(e){}else e.props.mode===o.e.linkSettings?Oe.u(s,a,e.props.customLabeledAudienceConfig,e.props.clientId):g=Object(r.__assign)(Object(r.__assign)({},g),{viewState:4,sharingLinkCreated:s,companyName:a,showActivityIndicator:!1,sharingInformation:i,currentSettings:e._getSettings(i)})}else{if(e.props.copyLinkShortcut&&i&&!e.props.shareId&&!i.error&&!e._copyLinkShortcutInvoked){e._copyLinkShortcutInvoked=!0;e._onCopyLinkClicked(!0,m)}g=Object(r.__assign)(Object(r.__assign)({},g),{sharingInformation:i,companyName:a,groupsMemberCount:f,currentSettings:m,policyTipInformation:l,isLoadingDefaultRecipients:t.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:c});if(h&&!h.isConsumed){g.linkRecipients=h.recipients;e._store.consumeDefaultRecipients()}}if(!e._isOpenEventLogged){e._store.getEngagementHelper().log(zt.t.Opened,e._engagementExtraData);e._isOpenEventLogged=!0}e.setState(g)}catch(t){e._setGenericErrorState(t)}});t.fetchSuiteNavInformation();t.fetchSharingInformation(this.props.copyLinkShortcut||this.props.mode===o.e.linkSettings||this.props.mode===o.e.manageAccess||this.props.mode===o.e.notify,this.props.mode===o.e.manageAccess);t.fetchPolicyTipInformation();if(this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===o.e.copy&&!this.props.shareId&&C.l(this.props.clientId)){this._copyLinkShortcutInvoked=!0;this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0});this.setState({shareType:u.e.copy,shareTargetClicked:!0})}this._resizeIfNeeded()}catch(e){this._setGenericErrorState(e)}};t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case o.e.share:if(e&&t)return 0;break;case o.e.atMention:if(e&&t)return 13;break;case o.e.linkSettings:if(t)return 8;break;case o.e.manageAccess:if(t)return 3;break;case o.e.copy:if(e&&t&&n)return 4;break;case o.e.notify:if(e)return 9;break;case o.e.addPeople:if(e)return 10;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return this.props.mode===o.e.share?1:14};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.componentDidCatch=function(e,t){this._setGenericErrorState(e)};t.prototype.render=function(){var e,t,n=b.e,i=this.props,s=(i.clientId,i.copyLinkShortcut),o=this.state,a=o.sharingInformation,l=o.currentSettings,c=o.showActivityIndicator,p=o.sharingLinkCreated,d="od-Share",v=!1;if(a&&l&&s&&p&&7!==this.state.viewState){v=!0;e=this._renderPostCopyShortcutView()}else switch(this.state.viewState){case 7:e=this._renderError(a);!1===this.state.shareTargetClicked?this._copyLinkCustomerPromise.end({resultType:Yt.e.Failure,errorCode:null!==a.error?a.error.toString():"RenderSharingDialogFailure"}):this.state.shareType===u.e.copy&&this._copyLinkCustomerPromise.end({resultType:Yt.e.Failure,errorCode:null!==a.error?a.error.toString():"ClientCopyLinkFailure"});break;case 0:d+=c?" od-Share--hasActivity":"";v=!0;e=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case 2:e=h.createElement(h.Fragment,null,this._renderModifyPermissions(2),this._renderActivityIndicator());break;case 8:e=h.createElement(h.Fragment,null,this._renderModifyPermissions(8),this._renderActivityIndicator());break;case 4:e=this._renderNotification();this.state.shareType===u.e.copy&&this._copyLinkCustomerPromise.end({resultType:Yt.e.Success});break;case 3:v=!0;e=this._renderPermissionsList();break;case 6:e=h.createElement(h.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case 13:d="";e=this._renderAtMention();break;case 8:d+=c?" od-Share--hasActivity":"";v=!0;e=h.createElement(h.Fragment,null,this._renderModifyPermissions(8));break;case 1:d+=" od-Share--hasShimmer";v=!0;e=this._renderShareMainShimmer();break;case 9:l.sharingLinkKind=1;l.audience=f.e.existing;this._engagementExtraData=Object(r.__assign)(Object(r.__assign)({},this._engagementExtraData),{appMap:a.item.appmap});d="";e=h.createElement(jt,Object(r.__assign)({},this._baseProps,{currentSettings:l,sharingInformation:a,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));break;case 10:v=!0;e=this._renderAddPeople();break;case 14:e=h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(De.e,{className:"od-Share-spinner",label:n.componentLoading,size:Pe.e.large}))}t=v||d?h.createElement("div",{className:d,style:v?this._sizeConstraints:void 0},e):e;var m=C.l(this.props.clientId)?" teams":"";return h.createElement(Lt.e,null,h.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:m+(this._shouldUseFluent()?" isFluent":"")},t))};t.prototype._shouldUseFluent=function(){return this.props.clientId===Be.e.odb||k.c()&&(this.props.clientId===Be.e.sharePoint||this.props.clientId===Be.e.listPart)||this.props.clientId===Be.e.listsHome||k.f()};t.prototype._renderAtMention=function(){var e=k.t()&&this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return h.createElement(At.e,Object(r.__assign)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,onComplete:e}))};t.prototype._renderPostCopyShortcutView=function(){var e=this.state,t=e.sharingInformation,n=e.currentSettings,i=e.companyName,s=e.sharingLinkCreated,o=e.viewState,u=e.groupsMemberCount;return h.createElement(He,Object(r.__assign)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:i,currentSettings:n,item:t.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(s.createdViaCopyLinkCommand),sharingInformation:t,showExistingAccessOption:this.props.showExistingAccessOption,viewState:o,groupsMemberCount:u,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}))};t.prototype._renderError=function(e){return h.createElement(h.Fragment,null,h.createElement(S.e,Object(r.__assign)({},this._baseProps,{viewState:7})),h.createElement(Jt,{sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()}))};t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,r=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,s=pe.n(e.sharingAbilities,e.sharingLinkTemplates),o=!1;if(!n&&!r){var u=e.defaultSharingLink;if(i){if(a=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0]){u=a;o=!0}}if(void 0!==s&&s.length>0){var a;if(a=s.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0]){u=a;o=!0}else if(a=s.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0]){u=a;o=!0}else{u=s[0];o=!0}}n=this._initializeCurrentSettings(u,e,this.props.copyLinkShortcut,o);if(s.length>0){n.shareId=u.shareId;n.fetchLinkOnly=!0;n.audience=u.audience;n.expiration=u.expiration;n.isEdit=u.isEdit;n.isReview=u.isReview;n.sharingRole=u.isEdit?l.e.edit:u.isReview?l.e.review:l.e.view;n.preventDownload=u.blockDownload;n.sharingLinkKind=u.sharingLinkKind;this._engagementExtraData.isRedeemedUserResharing=!0;this._engagementExtraData.redeemedLinksCount=s.length}}return n};t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n].email;i&&t.push(i)}return t};t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var r=(t.getTime()-n.getTime())/864e5;return Math.floor(r)}};t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss();e.stopPropagation()};t.prototype._initializeCurrentSettings=function(e,t,n,r){if(we.e.isFeatureEnabled({ODC:"ODCRequestAccess"})&&this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:f.e.existing,expiration:null,isEdit:!0,sharingRole:l.e.edit,sharingLinkKind:1,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===f.e.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=f.e.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:f.e.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:l.e.edit,sharingLinkKind:6,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};if(e.audience===f.e.specificPeopleFlex&&n&&(!k.r()||!r)){e.audience=f.e.existing;e.sharingLinkKind=1}var i=e.sharingLinkKind,s=5===i||3===i||1===i||6===i,o=e.isEdit&&2===t.defaultShareLinkPermission,u=[];this.props.shareId&&e.principals&&(u=Object(Z.m)(e));return{allowEditing:s,audience:this.props.preferCustomLabeledAudience&&e.audience===f.e.specificPeopleFlex?f.e.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:o,sharingRole:o?l.e.edit:l.e.view,sharingLinkKind:e.sharingLinkKind,specificPeople:u,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}};t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var r,i,s,o,u=t.sharingAbilities,a="00000000-0000-0000-0000-000000000000"===this.props.shareId,c=a?1:t.defaultSharingLink.sharingLinkKind,h=(this._store.isValidatingDefaultRecipients()||this.state.linkRecipients.length,Object(Z.S)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?f.e.customLabeledSpecificPeople:f.e.specificPeople);if(t.defaultShareLinkToExistingAccess){h=f.e.existing;c=1}else switch(c){case 5:case 4:h=f.e.anyone;break;case 3:case 2:h=f.e.organization;break;case 1:default:if(a||!t.canManagePermissions||t.blockPeoplePickerAndSharing)h=f.e.existing;else if(this._isPeopleSharingLinksEnabled){h!==f.e.customLabeledSpecificPeople&&(h=f.e.specificPeopleFlex);Ae.e.isActivated("78387c02-96db-42f2-87ff-2b40f18d8f00","05/08/2019","Update defaultLinkKind from direct to flexible based on audience")||(c=6)}else h=f.e.existing}if(h===f.e.specificPeopleFlex&&n){h=f.e.existing;c=1}var p=null,d=pe.t(h,u).linkExpiration;(d?d.defaultExpirationInDays:null)>0&&(p=new Date((new Date).toDateString())).setDate(p.getDate()+d.defaultExpirationInDays);var v=pe.r(h,u),m=v&&2===t.defaultShareLinkPermission,g=m?l.e.edit:l.e.view,y=void 0;k.C()&&(y=7===t.defaultShareLinkPermission)&&(g=l.e.restrictedview);var b=(null===(i=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],w=(null===(o=null===(s=this.props)||void 0===s?void 0:s.hostOptions)||void 0===o?void 0:o.disabledAudienceOptions)||[];return{allowEditing:v,audience:h=-1===b.indexOf(h)&&-1===w.indexOf(h)?h:f.e.existing,expiration:p,isEdit:m,sharingRole:g,isReview:!1,preventDownload:y,sharingLinkKind:h===f.e.existing?1:c,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}};t.prototype._loadTheme=function(e){try{var t=e;Object(K.H)(t)}catch(e){}};t.prototype._onCopyLinkClicked=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i=this;return Object(r.__generator)(this,function(s){switch(s.label){case 0:n=Object(r.__assign)(Object(r.__assign)({sendInvitation:!1},t),this.state.currentSettings);return[4,this._store.shouldInterruptCopyLink(n.isEdit)];case 1:if(s.sent()){this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData);this.setState({showCopyLinkInterrupt:!0})}else this.setState({shareType:u.e.copy,shareTargetClicked:!0},function(){i._store.shareLink({settings:n,recipients:i.state.linkRecipients,copyLinkCommand:e})});return[2]}})})};t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:u.e.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:u.e.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:u.e.teams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:u.e.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===f.e.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=0;this.props.mode===o.e.linkSettings&&(n=this.state.viewState);this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===f.e.specificPeople},permissionsMap:t})};t.prototype._renderBackButtonForPolicyDetails=function(){if(6===this.state.viewState)return tt.t(h.createElement(ue.e,{className:"od-Share-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:b.e.backButtonLabel}),b.e.backButtonLabel)};t.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 4:return this._renderNotification();case 3:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};t.prototype._renderShareMain=function(e,t){return h.createElement("div",null,h.createElement(Nt,Object(r.__assign)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this.onRoleChange})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}))};t.prototype._renderPolicyDetails=function(){return h.createElement(kt,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return h.createElement(w,{confirmationCode:t?a.copyInterruptUpdate:a.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})};t.prototype._renderModifyPermissions=function(e){return h.createElement(Me,Object(r.__assign)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:!1,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}))};t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===u.e.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return h.createElement(_e.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}))};t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:f.e.existing,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",sharingRole:l.e.none},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,canRequestAccessForGrantAccess:!1,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},fileExtension:"",sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:l.e.none,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0};return this._renderShareMain(t,e)};t.prototype._renderPermissionsList=function(){this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!!this.props.shareCommandsExperiment;this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===at.e.list&&(e=e&&k.u());return h.createElement(mt,Object(r.__assign)({},this._baseProps,{mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,shareCommandsExperiment:e}))};t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return h.createElement(h.Fragment,null,h.createElement(Wt,Object(r.__assign)({},this._baseProps,{onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.e.applyingLinkSettings})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._getModifiedSharingLinkUrl=function(e,t,n){var r=this.state.shareType,i=e.url;if(r!==u.e.copy&&r!==u.e.outlook)return i;var s=this._getBase62Id(),o=new Ft.t(i);o.setQueryParameter("e",s);var a=this._store.getNavId();a&&o.setQueryParameter("nav",a);return o.toString()};t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")};t.prototype._setGenericErrorState=function(e){if(k.p()){var t=e.stack?e.stack:e.toString();t.length>1024&&(t=t.substr(0,1024));var n=Object(r.__assign)(Object(r.__assign)({},this.state.sharingInformation),{error:t,errorCategory:0,errorMessage:b.e.unexpectedError,debugErrorMessage:"CorrelationId: "+this._correlationId});this.setState({sharingInformation:n,viewState:7})}};t.prototype._sanitizeSharingContextInfo=function(e){if(e){this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl="");this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl="");e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url="");e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url="");if(e.sharingLinks)for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")}};t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")};t.contextTypes={resize:i.func.isRequired,onDismiss:i.func.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t})(h.Component),en=n(104),tn=n(1934),nn=n(1644),rn=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._resize=function(){var e=n._share.current;if(e){n._onResize&&n._onResize();var t=n._maxHeight,r=e.clientHeight>t?t:e.clientHeight,i=e.clientWidth;if(r>0&&i>0)try{window.external.Resize(i,r)}catch(e){var s={name:"share_resize",width:i,height:r};window.parent.postMessage(JSON.stringify(s),"*")}}};n._dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};var r=window._sharingContextInfo;n._copyLinkShortcut=t.copyLinkShortcut;n._onDismiss=t.onDismiss;n._dismissed=!1;n._shareDismissEnabled=!Ae.e.isActivated("7541C104-321A-49F2-8350-DC1343D6F61B","5/16/2019","Fix share command refresh bug");n._onResize=t.onResize;n._peoplePickerProvider=t.peoplePickerProvider;n._mode=t.mode||(n._copyLinkShortcut?o.e.copy:o.e.share);n._messageText=t.messageText;n._sharingStore=t.sharingStore;n._premiumLearnMore=t.premiumLearnMore;n._goPremium=t.goPremium;n._platformDetection=new en.e;n._breakpoint=tn.t.DEFAULT_BREAKPOINTS[tn.t.determineWindowSize(window.innerWidth)];n._share=h.createRef();if(!t.noMaxHeightRestriction){var i=n.props.maxHeight;n._maxHeight=i<650?i:650}r&&(n._hostSessionId=r.hostSessionId);var s=0,u=" ",a=" ",f=" ",l=0;if(t.item&&t.item.properties){var c=t.item.properties,p=c.ItemChildCount?parseInt(c.ItemChildCount,10):0,d=c.FolderChildCount?parseInt(c.FolderChildCount,10):0;s=t.item.type===pt.t.OneNote?0:p+d;u=t.item.name;a=t.item.extension;f=t.item.appMap;l=t.item.type}else if(r){u=r.itemName||" ";s=r.itemCount||0;a=r.itemExtension;f=r.itemAppmap;l=r.itemType}t.items&&t.items.length>1&&(u=y.format(nn.e.SharingBundleTempName,t.items.length));n._sharingItemInformation={name:u,childCount:s,hasDlpPolicy:void 0,extension:a,appmap:f,itemType:l};return n}t.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize,onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,platformDetection:this._platformDetection,breakpoint:this._breakpoint,premiumLearnMore:this._premiumLearnMore,goPremium:this._goPremium,shareClickTime:window._sharingStartTime||Date.now()}};t.prototype.render=function(){var e=this._mode===o.e.copy?b.e.copyLinkLabel:nn.e.ShareText;return this._sharingStore?h.createElement("div",{className:"od-share-v3",ref:this._share,role:"dialog","aria-label":e},this._renderShareComponent()):null};t.prototype.componentWillUnmount=function(){this._shareDismissEnabled&&this._shareDismiss()};t.prototype._shareDismiss=function(){if(!this._dismissed&&this._onDismiss){this._dismissed=!0;this._onDismiss()}};t.prototype._renderShareComponent=function(){var e=this.props,t=h.createElement(Zt,{copyLinkShortcut:this._copyLinkShortcut,shareId:e.shareId,theme:e.theme,clientId:e.clientId||e.sharingProvider.getClientId(),scenarioId:e.scenarioId||"",omitCustomLabeledAudience:e.omitCustomLabeledAudience,customLabeledAudienceConfig:e.customLabeledAudienceConfig,showExistingAccessOption:!!e.sharingProvider&&e.sharingProvider.supportsExistingAccessOption(e.item),onManageAccessClicked:e.onManageAccessClicked,hideShareDialogOverflowButton:e.hideShareDialogOverflowButton,maxHeight:this._maxHeight,maxWidth:this.props.maxWidth,mode:this._mode,messageText:this._messageText,useVroomCreateDefaultLink:this._mode===o.e.copy&&C.l(e.clientId),sharingItemInformation:this._sharingItemInformation,hideElementsInManageAccess:this.props.hideElementsInManageAccess,shareCommandsExperiment:this.props.shareCommandsExperiment,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,invokeManageAccess:this.props.invokeManageAccess,hostSessionId:this._hostSessionId,hostOptions:this.props.hostOptions}),n=this._mode===o.e.share||this._mode===o.e.addPeople;return e.useFocusTrap?h.createElement(X.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:n,forceFocusInsideTrap:!n},t):t};t.childContextTypes={peoplePickerProvider:i.object.isRequired,resize:i.func.isRequired,onDismiss:i.func,sharingStore:i.object.isRequired,platformDetection:i.object.isRequired,breakpoint:i.object.isRequired,premiumLearnMore:i.func,goPremium:i.func,shareClickTime:i.number};return t})(h.Component);t.e=rn},"1915":function(e,t,n){"use strict";var r={};n.r(r);n.d(r,"root",function(){return y});n.d(r,"picker",function(){return b});n.d(r,"holder",function(){return w});n.d(r,"pickerIsOpened",function(){return E});n.d(r,"frame",function(){return S});n.d(r,"wrap",function(){return x});n.d(r,"goTodaySpacing",function(){return T});n.d(r,"dayPicker",function(){return N});n.d(r,"header",function(){return C});n.d(r,"divider",function(){return k});n.d(r,"monthAndYear",function(){return L});n.d(r,"year",function(){return A});n.d(r,"decade",function(){return O});n.d(r,"currentYear",function(){return M});n.d(r,"currentDecade",function(){return _});n.d(r,"table",function(){return D});n.d(r,"dayWrapper",function(){return P});n.d(r,"weekday",function(){return H});n.d(r,"day",function(){return B});n.d(r,"daySelection",function(){return j});n.d(r,"dayIsToday",function(){return F});n.d(r,"dayIsDisabled",function(){return I});n.d(r,"dayIsUnfocused",function(){return q});n.d(r,"dayIsFocused",function(){return R});n.d(r,"dayIsHighlighted",function(){return U});n.d(r,"pickerIsFocused",function(){return z});n.d(r,"dayDisabled",function(){return W});n.d(r,"dayBackground",function(){return X});n.d(r,"dayHover",function(){return V});n.d(r,"dayPress",function(){return $});n.d(r,"weekBackground",function(){return J});n.d(r,"showWeekNumbers",function(){return K});n.d(r,"weekNumbers",function(){return Q});n.d(r,"weekIsHighlighted",function(){return G});n.d(r,"showWeekNumbersRTL",function(){return Y});n.d(r,"monthComponents",function(){return Z});n.d(r,"yearComponents",function(){return ee});n.d(r,"decadeComponents",function(){return te});n.d(r,"closeButton",function(){return ne});n.d(r,"prevMonth",function(){return re});n.d(r,"nextMonth",function(){return ie});n.d(r,"prevYear",function(){return se});n.d(r,"nextYear",function(){return oe});n.d(r,"prevDecade",function(){return ue});n.d(r,"nextDecade",function(){return ae});n.d(r,"prevMonthIsDisabled",function(){return fe});n.d(r,"nextMonthIsDisabled",function(){return le});n.d(r,"prevYearIsDisabled",function(){return ce});n.d(r,"nextYearIsDisabled",function(){return he});n.d(r,"prevDecadeIsDisabled",function(){return pe});n.d(r,"nextDecadeIsDisabled",function(){return de});n.d(r,"headerToggleView",function(){return ve});n.d(r,"optionGrid",function(){return me});n.d(r,"monthOption",function(){return ge});n.d(r,"yearOption",function(){return ye});n.d(r,"isHighlighted",function(){return be});n.d(r,"monthOptionIsDisabled",function(){return we});n.d(r,"yearOptionIsDisabled",function(){return Ee});n.d(r,"goToday",function(){return Se});n.d(r,"goToTodayIsDisabled",function(){return xe});n.d(r,"goTodayInlineMonth",function(){return Te});n.d(r,"isPickingYears",function(){return Ne});n.d(r,"monthPicker",function(){return Ce});n.d(r,"yearPicker",function(){return ke});n.d(r,"monthPickerVisible",function(){return Le});n.d(r,"toggleMonthView",function(){return Ae});n.d(r,"calendarsInline",function(){return Oe});n.d(r,"monthPickerOnly",function(){return Me});n.d(r,"monthPickerAsOverlay",function(){return _e});n.d(r,"holderWithButton",function(){return De});n.d(r,"monthIsHighlighted",function(){return Pe});n.d(r,"monthIsCurrentMonth",function(){return He});n.d(r,"yearIsHighlighted",function(){return Be});n.d(r,"yearIsCurrentYear",function(){return je});n.d(r,"topLeftCornerDate",function(){return Fe});n.d(r,"topRightCornerDate",function(){return Ie});n.d(r,"bottomLeftCornerDate",function(){return qe});n.d(r,"bottomRightCornerDate",function(){return Re});n.d(r,"weekSelection",function(){return Ue});n.d(r,"monthSelection",function(){return ze});n.d(r,"topDate",function(){return We});n.d(r,"rightDate",function(){return Xe});n.d(r,"bottomDate",function(){return Ve});n.d(r,"leftdate",function(){return $e});var i=n(0),s=n("react-lib"),o=n(1681),u=n(111),a=n(505),f=n(418),l=n(38),c=n(470),h=n(1859),p=n(875),d=n(1398),v=n(600),m=n(1918),g=n(150);Object(g.n)([{rawString:".root_635ffc9a{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.root_635ffc9a *{overflow:visible}.root_635ffc9a ::-moz-focus-inner{border:0}.root_635ffc9a *{outline:transparent}.root_635ffc9a *{position:relative}.ms-Fabric--isFocusVisible .root_635ffc9a :focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.picker_635ffc9a{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px;position:relative}html[dir=ltr] .picker_635ffc9a{text-align:left}html[dir=rtl] .picker_635ffc9a{text-align:right}.holder_635ffc9a{-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;box-sizing:border-box;display:none}.picker_635ffc9a.pickerIsOpened_635ffc9a .holder_635ffc9a{-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block}.pickerIsOpened_635ffc9a{position:relative}.frame_635ffc9a{position:relative}.wrap_635ffc9a{min-height:212px;padding:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-sizing:content-box;box-sizing:content-box}.wrap_635ffc9a.goTodaySpacing_635ffc9a{min-height:228px}.dayPicker_635ffc9a{display:block}.header_635ffc9a{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:28px;line-height:44px;width:100%}.divider_635ffc9a{top:0;margin-top:-12px;margin-bottom:-12px}html[dir=ltr] .divider_635ffc9a{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=rtl] .divider_635ffc9a{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.decade_635ffc9a,.monthAndYear_635ffc9a,.year_635ffc9a{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";padding:0 5px}.currentDecade_635ffc9a:hover,.currentYear_635ffc9a:hover,.monthAndYear_635ffc9a:hover{cursor:default}.table_635ffc9a{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit;margin-top:4px;width:197px}.table_635ffc9a td{margin:0;padding:0}.dayWrapper_635ffc9a,.weekday_635ffc9a{width:28px;height:28px;padding:0;line-height:28px;font-size:12px;font-size:15px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:default}.dayWrapper_635ffc9a ::-moz-focus-inner,.weekday_635ffc9a ::-moz-focus-inner{border:0}.dayWrapper_635ffc9a *,.weekday_635ffc9a *{outline:transparent}.dayWrapper_635ffc9a *,.weekday_635ffc9a *{position:relative}.ms-Fabric--isFocusVisible .dayWrapper_635ffc9a :focus:after,.ms-Fabric--isFocusVisible .weekday_635ffc9a :focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.day_635ffc9a{width:24px;height:24px;border-radius:2px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border:none;padding:0;background-color:transparent;line-height:100%;color:inherit;font-size:inherit;font-weight:inherit;font-family:inherit}@media screen and (-ms-high-contrast:active){.daySelection_635ffc9a .day_635ffc9a:active,.daySelection_635ffc9a .day_635ffc9a:hover{outline:1px solid Highlight;-ms-high-contrast-adjust:none}}@media screen and (-ms-high-contrast:active){.daySelection_635ffc9a .day_635ffc9a:active{color:Highlight;-ms-high-contrast-adjust:none}}.dayIsToday_635ffc9a{border-radius:100%}.dayIsToday_635ffc9a,.dayIsToday_635ffc9a:hover{position:relative;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.dayIsToday_635ffc9a,.dayIsToday_635ffc9a:hover{background-color:Highlight;-ms-high-contrast-adjust:none}}.dayIsToday_635ffc9a:hover,.dayIsToday_635ffc9a:hover:hover{border-radius:100%}.dayIsDisabled_635ffc9a:before{border-top-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.dayIsUnfocused_635ffc9a{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400}.dayIsFocused_635ffc9a:hover,.dayIsUnfocused_635ffc9a:hover{cursor:pointer;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.daySelection_635ffc9a.dayIsHighlighted_635ffc9a:hover,.pickerIsFocused_635ffc9a .dayIsHighlighted_635ffc9a.daySelection_635ffc9a{cursor:pointer;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:2px}@media screen and (-ms-high-contrast:active){.daySelection_635ffc9a.dayIsHighlighted_635ffc9a:hover,.pickerIsFocused_635ffc9a .dayIsHighlighted_635ffc9a.daySelection_635ffc9a{outline:2px solid Highlight}.daySelection_635ffc9a.dayIsHighlighted_635ffc9a:hover :not(.dayIsToday_635ffc9a) span,.pickerIsFocused_635ffc9a .dayIsHighlighted_635ffc9a.daySelection_635ffc9a :not(.dayIsToday_635ffc9a) span{color:Highlight;-ms-high-contrast-adjust:none}}@media screen and (-ms-high-contrast:active){.dayIsHighlighted_635ffc9a button.dayIsToday_635ffc9a{border-radius:100%}}@media screen and (-ms-high-contrast:active){.dayIsHighlighted_635ffc9a button.dayIsToday_635ffc9a span{color:Window;-ms-high-contrast-adjust:none}}.dayIsFocused_635ffc9a:active,.dayIsHighlighted_635ffc9a{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.dayIsFocused_635ffc9a:active.day_635ffc9a,.dayIsHighlighted_635ffc9a.day_635ffc9a{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.dayIsHighlighted_635ffc9a.dayDisabled_635ffc9a,.dayIsHighlighted_635ffc9a.dayDisabled_635ffc9a:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.dayBackground_635ffc9a,.dayBackground_635ffc9a:active,.dayBackground_635ffc9a:hover{border-radius:2px}.dayHover_635ffc9a,.dayHover_635ffc9a:hover{cursor:pointer;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayPress_635ffc9a,.dayPress_635ffc9a:hover{cursor:pointer;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.dayPress_635ffc9a .dayIsToday_635ffc9a,.dayPress_635ffc9a:hover .dayIsToday_635ffc9a{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:100%}.dayIsFocused_635ffc9a:active,.dayIsHighlighted_635ffc9a,.dayIsHighlighted_635ffc9a:active,.dayIsHighlighted_635ffc9a:hover,.dayIsUnfocused_635ffc9a:active,.weekBackground_635ffc9a,.weekBackground_635ffc9a:active,.weekBackground_635ffc9a:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayIsToday_635ffc9a,.dayIsToday_635ffc9a.day_635ffc9a:active,.pickerIsFocused_635ffc9a .dayIsToday_635ffc9a{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:600;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:100%}@media screen and (-ms-high-contrast:active){.dayIsToday_635ffc9a,.dayIsToday_635ffc9a.day_635ffc9a:active,.pickerIsFocused_635ffc9a .dayIsToday_635ffc9a{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.showWeekNumbers_635ffc9a .weekNumbers_635ffc9a{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:28px;padding:0}.showWeekNumbers_635ffc9a .weekNumbers_635ffc9a .dayWrapper_635ffc9a{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.showWeekNumbers_635ffc9a .weekNumbers_635ffc9a .dayWrapper_635ffc9a.weekIsHighlighted_635ffc9a{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.showWeekNumbers_635ffc9a .table_635ffc9a{width:225px}.showWeekNumbers_635ffc9a .table_635ffc9a .dayWrapper_635ffc9a,.showWeekNumbers_635ffc9a .table_635ffc9a .weekday_635ffc9a{width:30px}.showWeekNumbersRTL_635ffc9a .weekNumbers_635ffc9a{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.showWeekNumbersRTL_635ffc9a .weekNumbers_635ffc9a .dayWrapper_635ffc9a{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.showWeekNumbersRTL_635ffc9a .weekNumbers_635ffc9a .dayWrapper_635ffc9a.weekIsHighlighted_635ffc9a{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.showWeekNumbersRTL_635ffc9a .table_635ffc9a{width:225px}.showWeekNumbersRTL_635ffc9a .table_635ffc9a .dayWrapper_635ffc9a,.showWeekNumbersRTL_635ffc9a .table_635ffc9a .weekday_635ffc9a{width:30px}.decadeComponents_635ffc9a,.monthComponents_635ffc9a,.yearComponents_635ffc9a{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-item-align:end;align-self:flex-end}.closeButton_635ffc9a,.nextDecade_635ffc9a,.nextMonth_635ffc9a,.nextYear_635ffc9a,.prevDecade_635ffc9a,.prevMonth_635ffc9a,.prevYear_635ffc9a{font-family:inherit;width:28px;height:28px;display:block;text-align:center;line-height:28px;text-align:center;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border-radius:2px;position:relative;background-color:transparent;border:none;padding:0}.closeButton_635ffc9a:hover,.nextDecade_635ffc9a:hover,.nextMonth_635ffc9a:hover,.nextYear_635ffc9a:hover,.prevDecade_635ffc9a:hover,.prevMonth_635ffc9a:hover,.prevYear_635ffc9a:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer;outline:1px solid transparent}.nextDecadeIsDisabled_635ffc9a,.nextMonthIsDisabled_635ffc9a,.nextYearIsDisabled_635ffc9a,.prevDecadeIsDisabled_635ffc9a,.prevMonthIsDisabled_635ffc9a,.prevYearIsDisabled_635ffc9a{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.headerToggleView_635ffc9a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 8px}.headerToggleView_635ffc9a:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";cursor:pointer}@media screen and (-ms-high-contrast:active){.headerToggleView_635ffc9a:hover{outline:1px solid highlight}}@media screen and (-ms-high-contrast:active){.headerToggleView_635ffc9a:hover:active{color:highlight}}.currentDecade_635ffc9a,.currentYear_635ffc9a{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:0 5px;font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:28px;line-height:28px}html[dir=ltr] .currentDecade_635ffc9a,html[dir=ltr] .currentYear_635ffc9a{margin-left:5px}html[dir=rtl] .currentDecade_635ffc9a,html[dir=rtl] .currentYear_635ffc9a{margin-right:5px}.optionGrid_635ffc9a{position:relative;height:210px;width:196px;margin:4px 0 0 0}html[dir=rtl] .optionGrid_635ffc9a{margin:4px 0 0 0}.monthOption_635ffc9a,.yearOption_635ffc9a{width:60px;height:60px;line-height:100%;cursor:pointer;margin:0 10px 10px 0;font-size:13px;font-weight:400;font-family:inherit;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";text-align:center;border:none;padding:0;background-color:transparent;border-radius:2px}html[dir=ltr] .monthOption_635ffc9a,html[dir=ltr] .yearOption_635ffc9a{float:left}html[dir=rtl] .monthOption_635ffc9a,html[dir=rtl] .yearOption_635ffc9a{float:right}html[dir=rtl] .monthOption_635ffc9a,html[dir=rtl] .yearOption_635ffc9a{margin:0 0 10px 10px}.monthOption_635ffc9a:hover,.yearOption_635ffc9a:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.monthOption_635ffc9a:hover,.yearOption_635ffc9a:hover{outline-color:highlight}}@media screen and (-ms-high-contrast:active){.monthOption_635ffc9a:active,.yearOption_635ffc9a:active{color:highlight}}.monthOption_635ffc9a.isHighlighted_635ffc9a,.yearOption_635ffc9a.isHighlighted_635ffc9a{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayIsDisabled_635ffc9a,.monthOptionIsDisabled_635ffc9a,.yearOptionIsDisabled_635ffc9a{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.goToday_635ffc9a{bottom:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:12px;font-weight:400;font-family:inherit;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:30px;line-height:30px;padding:0 10px;background-color:transparent;border:none;position:absolute!important;-webkit-box-sizing:content-box;box-sizing:content-box}[dir=ltr] .goToday_635ffc9a{right:13px}[dir=rtl] .goToday_635ffc9a{left:13px}.goToday_635ffc9a:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.goToday_635ffc9a:hover{outline-color:highlight}}.goToday_635ffc9a:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.goToday_635ffc9a:active{color:highlight}}.goToTodayIsDisabled_635ffc9a{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.goTodayInlineMonth_635ffc9a{top:212px}.wrap_635ffc9a.goTodaySpacing_635ffc9a{padding-bottom:28px}.root_635ffc9a.isPickingYears_635ffc9a .dayPicker_635ffc9a,.root_635ffc9a.isPickingYears_635ffc9a .monthComponents_635ffc9a{display:none}.root_635ffc9a.isPickingYears_635ffc9a .monthPicker_635ffc9a{display:none}.root_635ffc9a.isPickingYears_635ffc9a .yearPicker_635ffc9a{display:block}@media (min-device-width:460px){.wrap_635ffc9a{padding:12px}.dayPicker_635ffc9a,.monthPicker_635ffc9a{min-height:200px}.header_635ffc9a{height:28px;line-height:28px;width:100%}.dayWrapper_635ffc9a,.weekday_635ffc9a{width:28px;height:28px;line-height:28px;font-size:12px}.closeButton_635ffc9a,.nextDecade_635ffc9a,.nextMonth_635ffc9a,.nextYear_635ffc9a,.prevDecade_635ffc9a,.prevMonth_635ffc9a,.prevYear_635ffc9a{font-size:12px;width:28px;height:28px;line-height:28px}.holder_635ffc9a{display:inline-block;height:auto;overflow:hidden}.decade_635ffc9a,.monthAndYear_635ffc9a,.year_635ffc9a{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.yearComponents_635ffc9a{margin-left:1px}.goToday_635ffc9a{padding:0 3px}[dir=ltr] .goToday_635ffc9a{right:20px}[dir=rtl] .goToday_635ffc9a{left:20px}.showWeekNumbers_635ffc9a .table_635ffc9a .dayWrapper_635ffc9a,.showWeekNumbers_635ffc9a .table_635ffc9a .weekday_635ffc9a{width:28px}.showWeekNumbersRTL_635ffc9a .table_635ffc9a .dayWrapper_635ffc9a,.showWeekNumbersRTL_635ffc9a .table_635ffc9a .weekday_635ffc9a{width:28px}.monthPickerVisible_635ffc9a .wrap_635ffc9a{padding:12px}.monthPickerVisible_635ffc9a .dayPicker_635ffc9a{margin:-10px 0;padding:10px 0}.monthPickerVisible_635ffc9a .dayPicker_635ffc9a{-webkit-box-sizing:border-box;box-sizing:border-box;width:212px;min-height:200px}.monthPickerVisible_635ffc9a .monthPicker_635ffc9a{display:block}.monthPickerVisible_635ffc9a .optionGrid_635ffc9a{height:150px;width:196px}.monthPickerVisible_635ffc9a .toggleMonthView_635ffc9a{display:none}.monthPickerVisible_635ffc9a .currentDecade_635ffc9a,.monthPickerVisible_635ffc9a .currentYear_635ffc9a{font-size:14px;margin:0;height:28px;line-height:28px;display:inline-block}.monthPickerVisible_635ffc9a .monthOption_635ffc9a,.monthPickerVisible_635ffc9a .yearOption_635ffc9a{width:40px;height:40px;line-height:100%;font-size:12px;margin:0 12px 16px 0}html[dir=rtl] .monthPickerVisible_635ffc9a .monthOption_635ffc9a,html[dir=rtl] .monthPickerVisible_635ffc9a .yearOption_635ffc9a{margin:0 0 16px 12px}.monthPickerVisible_635ffc9a .monthOption_635ffc9a:hover,.monthPickerVisible_635ffc9a .yearOption_635ffc9a:hover{outline:1px solid transparent}.monthPickerVisible_635ffc9a .monthOption_635ffc9a:nth-child(4n+4),.monthPickerVisible_635ffc9a .yearOption_635ffc9a:nth-child(4n+4){margin:0 0 16px 0}html[dir=rtl] .monthPickerVisible_635ffc9a .monthOption_635ffc9a:nth-child(4n+4),html[dir=rtl] .monthPickerVisible_635ffc9a .yearOption_635ffc9a:nth-child(4n+4){margin:0 0 16px 0}.monthPickerVisible_635ffc9a .goToday_635ffc9a{font-size:12px;height:28px;line-height:28px;padding:0 10px}[dir=ltr] .monthPickerVisible_635ffc9a .goToday_635ffc9a{right:8px}[dir=rtl] .monthPickerVisible_635ffc9a .goToday_635ffc9a{left:8px}html[dir=ltr] .monthPickerVisible_635ffc9a .goToday_635ffc9a{text-align:right}html[dir=rtl] .monthPickerVisible_635ffc9a .goToday_635ffc9a{text-align:left}.monthPickerVisible_635ffc9a .root_635ffc9a.isPickingYears_635ffc9a .dayPicker_635ffc9a,.monthPickerVisible_635ffc9a .root_635ffc9a.isPickingYears_635ffc9a .monthComponents_635ffc9a{display:block}.monthPickerVisible_635ffc9a .root_635ffc9a.isPickingYears_635ffc9a .monthPicker_635ffc9a{display:none}.monthPickerVisible_635ffc9a .root_635ffc9a.isPickingYears_635ffc9a .yearPicker_635ffc9a{display:block}.calendarsInline_635ffc9a .wrap_635ffc9a{padding:12px}.calendarsInline_635ffc9a .holder_635ffc9a{height:auto}html[dir=ltr] .calendarsInline_635ffc9a .table_635ffc9a{margin-right:12px}html[dir=rtl] .calendarsInline_635ffc9a .table_635ffc9a{margin-left:12px}.calendarsInline_635ffc9a .dayPicker_635ffc9a{width:auto}html[dir=ltr] .calendarsInline_635ffc9a .monthPicker_635ffc9a{margin-left:12px}html[dir=rtl] .calendarsInline_635ffc9a .monthPicker_635ffc9a{margin-right:12px}html[dir=ltr] .calendarsInline_635ffc9a .yearPicker_635ffc9a{margin-left:12px}html[dir=rtl] .calendarsInline_635ffc9a .yearPicker_635ffc9a{margin-right:12px}.calendarsInline_635ffc9a .goToday_635ffc9a{padding:0 10px}[dir=ltr] .calendarsInline_635ffc9a .goToday_635ffc9a{right:14px}[dir=rtl] .calendarsInline_635ffc9a .goToday_635ffc9a{left:14px}html[dir=ltr] .calendarsInline_635ffc9a .monthComponents_635ffc9a{margin-right:12px}html[dir=rtl] .calendarsInline_635ffc9a .monthComponents_635ffc9a{margin-left:12px}.monthPickerOnly_635ffc9a .wrap_635ffc9a{padding:12px}.monthPickerAsOverlay_635ffc9a .wrap_635ffc9a{padding-bottom:28px;margin-bottom:6px}.monthPickerAsOverlay_635ffc9a .holder_635ffc9a{height:240px;min-height:240px}.monthPickerAsOverlay_635ffc9a .holderWithButton_635ffc9a{padding-top:6px;height:auto}}@media (max-device-width:459px){.calendarsInline_635ffc9a .monthPicker_635ffc9a,.calendarsInline_635ffc9a .yearPicker_635ffc9a{display:none}.yearComponents_635ffc9a{margin-top:2px}}.goToday_635ffc9a{width:auto}.closeButton_635ffc9a,.nextDecade_635ffc9a,.nextMonth_635ffc9a,.nextYear_635ffc9a,.prevDecade_635ffc9a,.prevMonth_635ffc9a,.prevYear_635ffc9a{display:inline-block}.closeButton_635ffc9a:hover,.nextDecade_635ffc9a:hover,.nextMonth_635ffc9a:hover,.nextYear_635ffc9a:hover,.prevDecade_635ffc9a:hover,.prevMonth_635ffc9a:hover,.prevYear_635ffc9a:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.closeButton_635ffc9a:hover,.nextDecade_635ffc9a:hover,.nextMonth_635ffc9a:hover,.nextYear_635ffc9a:hover,.prevDecade_635ffc9a:hover,.prevMonth_635ffc9a:hover,.prevYear_635ffc9a:hover{outline:1px solid Highlight}}.closeButton_635ffc9a:active,.nextDecade_635ffc9a:active,.nextMonth_635ffc9a:active,.nextYear_635ffc9a:active,.prevDecade_635ffc9a:active,.prevMonth_635ffc9a:active,.prevYear_635ffc9a:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.closeButton_635ffc9a:active,.nextDecade_635ffc9a:active,.nextMonth_635ffc9a:active,.nextYear_635ffc9a:active,.prevDecade_635ffc9a:active,.prevMonth_635ffc9a:active,.prevYear_635ffc9a:active{color:highlight}}.monthIsHighlighted_635ffc9a{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.monthIsHighlighted_635ffc9a.monthOption_635ffc9a:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.monthIsHighlighted_635ffc9a{color:highlight;border:2px solid highlight;border-radius:2px}.monthIsHighlighted_635ffc9a:hover{outline:0!important}}.monthIsCurrentMonth_635ffc9a{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.monthIsCurrentMonth_635ffc9a.monthOption_635ffc9a:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.monthOption_635ffc9a:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.yearIsHighlighted_635ffc9a{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.yearIsHighlighted_635ffc9a.yearOption_635ffc9a:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.yearIsCurrentYear_635ffc9a{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.yearIsCurrentYear_635ffc9a.yearOption_635ffc9a:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.yearOption_635ffc9a:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.topLeftCornerDate_635ffc9a{border-top-left-radius:2px}.topRightCornerDate_635ffc9a{border-top-right-radius:2px}.bottomLeftCornerDate_635ffc9a{border-bottom-left-radius:2px}.bottomRightCornerDate_635ffc9a{border-bottom-right-radius:2px}@media screen and (-ms-high-contrast:active){.weekBackground_635ffc9a{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekBackground_635ffc9a.bottomRightCornerDate_635ffc9a.topRightCornerDate_635ffc9a{border-right:1px solid highlight;border-left:none;padding-left:1px}.weekBackground_635ffc9a.bottomLeftCornerDate_635ffc9a.topLeftCornerDate_635ffc9a{border-left:1px solid highlight;border-right:none;padding-right:1px}.weekBackground_635ffc9a :not(.dayIsToday_635ffc9a) span{color:highlight}.weekSelection_635ffc9a.dayHover_635ffc9a{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekSelection_635ffc9a.dayHover_635ffc9a.bottomLeftCornerDate_635ffc9a.topLeftCornerDate_635ffc9a{border-left:1px solid highlight;padding-right:1px}.weekSelection_635ffc9a.dayHover_635ffc9a.bottomRightCornerDate_635ffc9a.topRightCornerDate_635ffc9a{border-right:1px solid highlight;padding-left:1px}.weekSelection_635ffc9a.dayHover_635ffc9a.dayPress_635ffc9a :not(.dayIsToday_635ffc9a) span{color:highlight}.monthSelection_635ffc9a.dayHover_635ffc9a.bottomLeftCornerDate_635ffc9a,.monthSelection_635ffc9a.dayHover_635ffc9a.topLeftCornerDate_635ffc9a{border-left:1px solid highlight;padding-right:1px}.monthSelection_635ffc9a.dayHover_635ffc9a.bottomRightCornerDate_635ffc9a,.monthSelection_635ffc9a.dayHover_635ffc9a.topRightCornerDate_635ffc9a{border-right:1px solid highlight;padding-left:1px}.monthSelection_635ffc9a.dayIsFocused_635ffc9a.dayHover_635ffc9a.topDate_635ffc9a,.monthSelection_635ffc9a.dayIsUnfocused_635ffc9a.dayHover_635ffc9a.topDate_635ffc9a{border-top:1px solid highlight;padding-bottom:1px}.monthSelection_635ffc9a.dayIsFocused_635ffc9a.dayHover_635ffc9a.rightDate_635ffc9a,.monthSelection_635ffc9a.dayIsUnfocused_635ffc9a.dayHover_635ffc9a.rightDate_635ffc9a{border-right:1px solid highlight;padding-left:1px}.monthSelection_635ffc9a.dayIsFocused_635ffc9a.dayHover_635ffc9a.bottomDate_635ffc9a,.monthSelection_635ffc9a.dayIsUnfocused_635ffc9a.dayHover_635ffc9a.bottomDate_635ffc9a{border-bottom:1px solid highlight;padding-top:1px}.monthSelection_635ffc9a.dayIsFocused_635ffc9a.dayHover_635ffc9a.leftdate_635ffc9a,.monthSelection_635ffc9a.dayIsUnfocused_635ffc9a.dayHover_635ffc9a.leftdate_635ffc9a{border-left:1px solid highlight;padding-right:1px}.monthSelection_635ffc9a.dayIsFocused_635ffc9a.dayHover_635ffc9a.dayPress_635ffc9a :not(.dayIsToday_635ffc9a) span,.monthSelection_635ffc9a.dayIsUnfocused_635ffc9a.dayHover_635ffc9a.dayPress_635ffc9a :not(.dayIsToday_635ffc9a) span{color:highlight}}"}]);var y="root_635ffc9a",b="picker_635ffc9a",w="holder_635ffc9a",E="pickerIsOpened_635ffc9a",S="frame_635ffc9a",x="wrap_635ffc9a",T="goTodaySpacing_635ffc9a",N="dayPicker_635ffc9a",C="header_635ffc9a",k="divider_635ffc9a",L="monthAndYear_635ffc9a",A="year_635ffc9a",O="decade_635ffc9a",M="currentYear_635ffc9a",_="currentDecade_635ffc9a",D="table_635ffc9a",P="dayWrapper_635ffc9a",H="weekday_635ffc9a",B="day_635ffc9a",j="daySelection_635ffc9a",F="dayIsToday_635ffc9a",I="dayIsDisabled_635ffc9a",q="dayIsUnfocused_635ffc9a",R="dayIsFocused_635ffc9a",U="dayIsHighlighted_635ffc9a",z="pickerIsFocused_635ffc9a",W="dayDisabled_635ffc9a",X="dayBackground_635ffc9a",V="dayHover_635ffc9a",$="dayPress_635ffc9a",J="weekBackground_635ffc9a",K="showWeekNumbers_635ffc9a",Q="weekNumbers_635ffc9a",G="weekIsHighlighted_635ffc9a",Y="showWeekNumbersRTL_635ffc9a",Z="monthComponents_635ffc9a",ee="yearComponents_635ffc9a",te="decadeComponents_635ffc9a",ne="closeButton_635ffc9a",re="prevMonth_635ffc9a",ie="nextMonth_635ffc9a",se="prevYear_635ffc9a",oe="nextYear_635ffc9a",ue="prevDecade_635ffc9a",ae="nextDecade_635ffc9a",fe="prevMonthIsDisabled_635ffc9a",le="nextMonthIsDisabled_635ffc9a",ce="prevYearIsDisabled_635ffc9a",he="nextYearIsDisabled_635ffc9a",pe="prevDecadeIsDisabled_635ffc9a",de="nextDecadeIsDisabled_635ffc9a",ve="headerToggleView_635ffc9a",me="optionGrid_635ffc9a",ge="monthOption_635ffc9a",ye="yearOption_635ffc9a",be="isHighlighted_635ffc9a",we="monthOptionIsDisabled_635ffc9a",Ee="yearOptionIsDisabled_635ffc9a",Se="goToday_635ffc9a",xe="goToTodayIsDisabled_635ffc9a",Te="goTodayInlineMonth_635ffc9a",Ne="isPickingYears_635ffc9a",Ce="monthPicker_635ffc9a",ke="yearPicker_635ffc9a",Le="monthPickerVisible_635ffc9a",Ae="toggleMonthView_635ffc9a",Oe="calendarsInline_635ffc9a",Me="monthPickerOnly_635ffc9a",_e="monthPickerAsOverlay_635ffc9a",De="holderWithButton_635ffc9a",Pe="monthIsHighlighted_635ffc9a",He="monthIsCurrentMonth_635ffc9a",Be="yearIsHighlighted_635ffc9a",je="yearIsCurrentYear_635ffc9a",Fe="topLeftCornerDate_635ffc9a",Ie="topRightCornerDate_635ffc9a",qe="bottomLeftCornerDate_635ffc9a",Re="bottomRightCornerDate_635ffc9a",Ue="weekSelection_635ffc9a",ze="monthSelection_635ffc9a",We="topDate_635ffc9a",Xe="rightDate_635ffc9a",Ve="bottomDate_635ffc9a",$e="leftdate_635ffc9a",Je=r,Ke=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.days={};n._onKeyDown=function(e,t){t.which!==u.e.enter&&t.which!==u.e.space||e()};n._onDayKeyDown=function(e,t,r){return function(i){if(i.which===u.e.enter){n._onSelectDate(e,i);i.preventDefault()}else n._navigateMonthEdge(i,e,t,r)}};n._onDayMouseDown=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(Je.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){if(e&&r===t&&n.isInBounds){e.classList.add(Je.dayPress);e.classList.add(Je.dayIsHighlighted)}else e&&e.classList.remove(Je.dayIsHighlighted)})}};n._onDayMouseUp=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(Je.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(Je.dayPress)})}};n._onDayMouseOver=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(Je.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.add(Je.dayHover)})}};n._onDayMouseLeave=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(Je.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(Je.dayHover)})}};n._onTableMouseLeave=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){if(e){e.classList.remove(Je.dayHover);e.classList.remove(Je.dayPress)}})};n._onTableMouseUp=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){e&&e.classList.remove(Je.dayPress)})};n._onSelectDate=function(e,t){var r=n.props,i=r.onSelectDate,s=r.dateRangeType,u=r.firstDayOfWeek,a=r.navigatedDate,f=r.autoNavigateOnSelection,l=r.minDate,c=r.maxDate,h=r.workWeekDays;t&&t.stopPropagation();var p=Object(m.o)(e,s,u,h);s!==o.e.Day&&(p=n._getBoundedDateRange(p,l,c));p=p.filter(function(e){return!n._getIsRestrictedDate(e)});i&&i(e,p);if(f&&e.getMonth()!==a.getMonth()){var d=Object(m.i)(e,a);d<0?n._onSelectPrevMonth():d>0&&n._onSelectNextMonth()}};n._onSelectNextMonth=function(){n.props.onNavigateDate(Object(m.t)(n.props.navigatedDate,1),!1)};n._onSelectPrevMonth=function(){n.props.onNavigateDate(Object(m.t)(n.props.navigatedDate,-1),!1)};n._onClose=function(){n.props.onDismiss&&n.props.onDismiss()};n._onHeaderSelect=function(){var e=n.props.onHeaderSelect;e&&e(!0)};n._onHeaderKeyDown=function(e){var t=n.props.onHeaderSelect;!t||e.which!==u.e.enter&&e.which!==u.e.space||t(!0)};n._onPrevMonthKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectPrevMonth,e)};n._onNextMonthKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectNextMonth,e)};n._onCloseButtonKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onClose,e)};Object(a.e)(n);n.state={activeDescendantId:Object(f.e)("DatePickerDay-active"),weeks:n._getWeeks(t)};n._onSelectNextMonth=n._onSelectNextMonth.bind(n);n._onSelectPrevMonth=n._onSelectPrevMonth.bind(n);n._onClose=n._onClose.bind(n);return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({weeks:this._getWeeks(e)})};t.prototype.render=function(){var e,t,n=this,r=this.state,i=r.activeDescendantId,u=r.weeks,a=this.props,p=a.firstDayOfWeek,g=a.strings,y=a.navigatedDate,b=a.selectedDate,w=a.dateRangeType,E=a.navigationIcons,S=a.showWeekNumbers,x=a.firstWeekOfYear,T=a.dateTimeFormatter,N=a.minDate,C=a.maxDate,k=a.showCloseButton,L=a.allFocusable,A=Object(f.e)("DatePickerDay-dayPicker"),O=Object(f.e)("DatePickerDay-monthAndYear"),M=E.leftNavigation,_=E.rightNavigation,D=E.closeIcon,P=S?Object(m.l)(u.length,p,x,y):null,H=S?Object(m.f)(b,p,x):void 0,B=this._getWeekCornerStyles(u,w),j=!N||Object(m.i)(N,Object(m.a)(y))<0,F=!C||Object(m.i)(Object(m.u)(y),C)<0;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-dayPicker",Je.dayPicker,S&&(Object(c.e)()?Je.showWeekNumbersRTL:Je.showWeekNumbers)),id:A},s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",Je.header)},s.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:O,className:Je.monthAndYear},this.props.onHeaderSelect?s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthAndYear js-showMonthPicker",Je.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":T.formatMonthYear(y,g),role:"button",tabIndex:0},T.formatMonthYear(y,g)):s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthAndYear",Je.monthAndYear)},T.formatMonthYear(y,g))),s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthComponents",Je.monthComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",Je.navContainer)},s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevMonth js-prevMonth",Je.prevMonth,(e={},e["ms-DatePicker-prevMonth--disabled "+Je.prevMonthIsDisabled]=!j,e)),disabled:!L&&!j,"aria-disabled":!j,onClick:j?this._onSelectPrevMonth:void 0,onKeyDown:j?this._onPrevMonthKeyDown:void 0,"aria-controls":A,title:g.prevMonthAriaLabel?g.prevMonthAriaLabel+" "+g.months[Object(m.t)(y,-1).getMonth()]:void 0,role:"button",type:"button"},s.createElement(v.e,{iconName:M})),s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextMonth js-nextMonth",Je.nextMonth,(t={},t["ms-DatePicker-nextMonth--disabled "+Je.nextMonthIsDisabled]=!F,t)),disabled:!L&&!F,"aria-disabled":!F,onClick:F?this._onSelectNextMonth:void 0,onKeyDown:F?this._onNextMonthKeyDown:void 0,"aria-controls":A,title:g.nextMonthAriaLabel?g.nextMonthAriaLabel+" "+g.months[Object(m.t)(y,1).getMonth()]:void 0,role:"button",type:"button"},s.createElement(v.e,{iconName:_})),k&&s.createElement("button",{className:Object(l.e)("ms-DatePicker-closeButton js-closeButton",Je.closeButton),onClick:this._onClose,onKeyDown:this._onCloseButtonKeyDown,title:g.closeButtonAriaLabel,role:"button",type:"button"},s.createElement(v.e,{iconName:D}))))),s.createElement(d.e,null,s.createElement("table",{className:Object(l.e)("ms-DatePicker-table",Je.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":O,"aria-activedescendant":i,role:"grid"},s.createElement("thead",null,s.createElement("tr",null,S&&s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekday",Je.weekday)}),g.shortDays.map(function(e,t){return s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekday",Je.weekday),role:"columnheader",scope:"col",key:t,title:g.days[(t+p)%7],"aria-label":g.days[(t+p)%7],"data-is-focusable":!!L||void 0},g.shortDays[(t+p)%7])}))),s.createElement("tbody",{onMouseLeave:w!==o.e.Day?this._onTableMouseLeave:void 0,onMouseUp:w!==o.e.Day?this._onTableMouseUp:void 0},u.map(function(e,t){var r;return s.createElement("tr",{key:P?P[t]:t},S&&P&&s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekNumbers","ms-DatePicker-weekday",Je.weekday,Je.weekNumbers),key:t,title:P&&g.weekNumberFormatString&&Object(h.e)(g.weekNumberFormatString,P[t]),"aria-label":P&&g.weekNumberFormatString&&Object(h.e)(g.weekNumberFormatString,P[t]),scope:"row"},s.createElement("div",{className:Object(l.e)("ms-DatePicker-day",Je.day,(r={},r["ms-DatePicker-week--highlighted "+Je.weekIsHighlighted]=H===P[t],r))},s.createElement("span",null,P[t]))),e.map(function(e,r){var u,a,f=Object(m.s)(y,e.originalDate);return s.createElement("td",{key:e.key,onClick:e.isInBounds?e.onSelected:void 0,className:Object(l.e)(Je.dayWrapper,"ms-DatePicker-day",n._getHighlightedCornerStyle(B,r,t),(u={},u["ms-DatePicker-weekBackground "+Je.weekBackground]=e.isSelected&&(w===o.e.Week||w===o.e.WorkWeek),u["ms-DatePicker-dayBackground "+Je.dayBackground]=w===o.e.Day,u["ms-DatePicker-day--highlighted "+Je.dayIsHighlighted]=e.isSelected&&w===o.e.Day,u["ms-DatePicker-day--infocus "+Je.dayIsFocused]=e.isInBounds&&e.isInMonth,u["ms-DatePicker-day--outfocus "+Je.dayIsUnfocused]=e.isInBounds&&!e.isInMonth,u[Je.daySelection]=w===o.e.Day,u[Je.weekSelection]=w===o.e.Week||w===o.e.WorkWeek,u[Je.monthSelection]=w===o.e.Month,u)),ref:function(t){return n._setDayCellRef(t,e,f)},onMouseOver:w!==o.e.Day&&e.isInBounds?n._onDayMouseOver(e.originalDate,t,r,w):void 0,onMouseLeave:w!==o.e.Day&&e.isInBounds?n._onDayMouseLeave(e.originalDate,t,r,w):void 0,onMouseDown:w!==o.e.Day&&e.isInBounds?n._onDayMouseDown(e.originalDate,t,r,w):void 0,onMouseUp:w!==o.e.Day&&e.isInBounds?n._onDayMouseUp(e.originalDate,t,r,w):void 0,role:"gridcell"},s.createElement("button",{key:e.key+"button",onClick:e.isInBounds?e.onSelected:void 0,className:Object(l.e)(Je.day,"ms-DatePicker-day-button",(a={},a["ms-DatePicker-day--disabled "+Je.dayIsDisabled]=!e.isInBounds,a["ms-DatePicker-day--today "+Je.dayIsToday]=e.isToday,a)),onKeyDown:n._onDayKeyDown(e.originalDate,t,r),"aria-label":T.formatMonthDayYear(e.originalDate,g),id:f?i:void 0,"aria-readonly":!0,"aria-current":e.isToday?"date":void 0,"aria-selected":e.isInBounds?e.isSelected:void 0,"data-is-focusable":L||!!e.isInBounds||void 0,ref:function(t){return n._setDayRef(t,e,f)},disabled:!L&&!e.isInBounds,"aria-disabled":!e.isInBounds,type:"button"},s.createElement("span",{"aria-hidden":"true"},T.formatDay(e.originalDate))))}))})))))};t.prototype.focus=function(){if(this.navigatedDay){this.navigatedDay.tabIndex=0;this.navigatedDay.focus()}};t.prototype._setDayRef=function(e,t,n){n&&(this.navigatedDay=e)};t.prototype._setDayCellRef=function(e,t,n){this.days[t.key]=e};t.prototype._getWeekCornerStyles=function(e,t){var n=this,r={};switch(t){case o.e.Month:e.forEach(function(t,n){t.forEach(function(t,i){var s=e[n-1]&&e[n-1][i]&&e[n-1][i].originalDate.getMonth()===e[n][i].originalDate.getMonth(),o=e[n+1]&&e[n+1][i]&&e[n+1][i].originalDate.getMonth()===e[n][i].originalDate.getMonth(),u=e[n][i-1]&&e[n][i-1].originalDate.getMonth()===e[n][i].originalDate.getMonth(),a=e[n][i+1]&&e[n][i+1].originalDate.getMonth()===e[n][i].originalDate.getMonth(),f=!s&&!a,l=!o&&!u,h=!o&&!a,p="";!s&&!u&&(p=Object(c.e)()?p.concat(Je.topRightCornerDate+" "):p.concat(Je.topLeftCornerDate+" "));f&&(p=Object(c.e)()?p.concat(Je.topLeftCornerDate+" "):p.concat(Je.topRightCornerDate+" "));l&&(p=Object(c.e)()?p.concat(Je.bottomRightCornerDate+" "):p.concat(Je.bottomLeftCornerDate+" "));h&&(p=Object(c.e)()?p.concat(Je.bottomLeftCornerDate+" "):p.concat(Je.bottomRightCornerDate+" "));s||(p=p.concat(Je.topDate+" "));o||(p=p.concat(Je.bottomDate+" "));a||(p=p.concat(Je.rightDate+" "));u||(p=p.concat(Je.leftdate+" "));r[n+"_"+i]=p})});break;case o.e.Week:case o.e.WorkWeek:e.forEach(function(e,t){var i=Object(p.r)(e,function(e){return e.isInBounds}),s=n._findLastIndex(e,function(e){return e.isInBounds}),o=Je.topLeftCornerDate+" "+Je.bottomLeftCornerDate,u=Je.topRightCornerDate+" "+Je.bottomRightCornerDate;r[t+"_"+i]=Object(c.e)()?u:o;r[t+"_"+s]=Object(c.e)()?o:u})}return r};t.prototype._getHighlightedCornerStyle=function(e,t,n){return e[n+"_"+t]?e[n+"_"+t]:""};t.prototype._navigateMonthEdge=function(e,t,n,r){var i=this.props,s=i.minDate,o=i.maxDate,a=void 0;0===n&&e.which===u.e.up?a=Object(m.n)(t,-1):n===this.state.weeks.length-1&&e.which===u.e.down?a=Object(m.n)(t,1):0===r&&e.which===Object(c.t)(u.e.left)?a=Object(m.e)(t,-1):6===r&&e.which===Object(c.t)(u.e.right)&&(a=Object(m.e)(t,1));if(a&&(!s||Object(m.i)(s,a)<1)&&(!o||Object(m.i)(a,o)<1)){this.props.onNavigateDate(a,!0);e.preventDefault()}};t.prototype._applyFunctionToDayRefs=function(e){var t=this;this.state.weeks&&this.state.weeks.forEach(function(n,r){n.forEach(function(n){var i=t.days[n.key];e(i,n,r)})})};t.prototype._getWeeks=function(e){for(var t=e.navigatedDate,n=e.selectedDate,r=e.dateRangeType,i=e.firstDayOfWeek,s=e.today,u=e.minDate,a=e.maxDate,f=e.showSixWeeksByDefault,l=e.workWeekDays,c=new Date(t.getFullYear(),t.getMonth(),1),h=s||new Date,p=[];c.getDay()!==i;)c.setDate(c.getDate()-1);var d=!1,v=r===o.e.WorkWeek?o.e.Week:r,g=Object(m.o)(n,v,i,l);r!==o.e.Day&&(g=this._getBoundedDateRange(g,u,a));for(var y=!0,b=0;y;b++){var w=[];d=!0;for(var E=0;E<7;E++){var S=new Date(c),x={key:c.toString(),date:c.getDate().toString(),originalDate:S,isInMonth:c.getMonth()===t.getMonth(),isToday:Object(m.s)(h,c),isSelected:Object(m.p)(c,g),onSelected:this._onSelectDate.bind(this,S),isInBounds:(!u||Object(m.i)(u,c)<1)&&(!a||Object(m.i)(c,a)<1)&&!this._getIsRestrictedDate(c)};w.push(x);x.isInMonth&&(d=!1);c.setDate(c.getDate()+1)}(y=f?!d||b<=5:!d)&&p.push(w)}return p};t.prototype._getIsRestrictedDate=function(e){var t=this.props.restrictedDates;return!!t&&!!Object(p.n)(t,function(t){return Object(m.s)(t,e)})};t.prototype._getBoundedDateRange=function(e,t,n){var r=Object(i.__spreadArrays)(e);t&&(r=r.filter(function(e){return Object(m.i)(e,t)>=0}));n&&(r=r.filter(function(e){return Object(m.i)(e,n)<=0}));return r};t.prototype._findLastIndex=function(e,t){for(var n=e.length-1;n>=0;n--){if(t(e[n]))return n}return-1};return t})(s.Component),Qe=r,Ge={prevRangeAriaLabel:void 0,nextRangeAriaLabel:void 0},Ye={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},Ze=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._buttonRef=s.createRef();t._onRenderYear=function(){var e=t.props,n=e.year,r=e.onRenderYear;return r?r(n):n};t._onClick=function(){t.props.onSelectYear&&t.props.onSelectYear(t.props.year)};t._onKeyDown=function(e){t.props.onSelectYear&&e.which===u.e.enter&&t.props.onSelectYear(t.props.year)};return t}t.prototype.focus=function(){this._buttonRef.current&&this._buttonRef.current.focus()};t.prototype.render=function(){var e,t=this.props,n=t.year,r=t.selected,i=t.disabled,o=t.onSelectYear;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-yearOption",Qe.yearOption,(e={},e["ms-DatePicker-day--highlighted "+Qe.yearIsHighlighted]=r,e["ms-DatePicker-yearOption--disabled "+Qe.yearOptionIsDisabled]=i,e)),type:"button",role:"gridcell",onClick:!i&&o?this._onClick:void 0,onKeyDown:!i&&o?this._onKeyDown:void 0,disabled:i,"aria-label":String(n),"aria-selected":r,ref:this._buttonRef},this._onRenderYear())};return t})(s.Component),et=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._selectedCellRef=s.createRef();t._currentCellRef=s.createRef();t._renderCell=function(e){var n=e===t.props.selectedYear,r=t.props,i=r.minYear,o=r.maxYear,u=r.onSelectYear,a=void 0!==i&&e<i||void 0!==o&&e>o,f=e===(new Date).getFullYear();return s.createElement(Ze,{key:e,year:e,selected:n,current:f,disabled:a,onSelectYear:u,ref:n?t._selectedCellRef:f?t._currentCellRef:void 0})};return t}t.prototype.focus=function(){this._selectedCellRef.current?this._selectedCellRef.current.focus():this._currentCellRef.current&&this._currentCellRef.current.focus()};t.prototype.render=function(){for(var e=this.props,t=e.fromYear,n=e.toYear,r=t,i=[];r<=n;){i.push(this._renderCell(r));r++}return s.createElement(d.e,null,s.createElement("div",{className:Object(l.e)("ms-DatePicker-optionGrid",Qe.optionGrid),role:"grid"},s.createElement("div",{role:"row"},i)))};return t})(s.Component),tt=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectPrev=function(){!t.isDisabled&&t.props.onSelectPrev&&t.props.onSelectPrev()};t._onKeyDown=function(e){e.which===u.e.enter&&t._onSelectPrev()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||Ye,n=(this.props.strings||Ge).prevRangeAriaLabel,r={fromYear:this.props.fromYear-12,toYear:this.props.toYear-12},i=n?"string"==typeof n?n:n(r):void 0,o=this.isDisabled,u=this.props.onSelectPrev;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevDecade",Qe.prevDecade,(e={},e["ms-DatePicker-prevDecade--disabled "+Qe.prevDecadeIsDisabled]=o,e)),onClick:!o&&u?this._onSelectPrev:void 0,onKeyDown:!o&&u?this._onKeyDown:void 0,type:"button",tabIndex:0,title:i,disabled:o},s.createElement(v.e,{iconName:Object(c.e)()?t.rightNavigation:t.leftNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.minYear;return void 0!==e&&this.props.fromYear<e},enumerable:!0,configurable:!0});return t})(s.Component),nt=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectNext=function(){!t.isDisabled&&t.props.onSelectNext&&t.props.onSelectNext()};t._onKeyDown=function(e){e.which===u.e.enter&&t._onSelectNext()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||Ye,n=(this.props.strings||Ge).nextRangeAriaLabel,r={fromYear:this.props.fromYear+12,toYear:this.props.toYear+12},i=n?"string"==typeof n?n:n(r):void 0,o=this.props.onSelectNext,u=this.isDisabled;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextDecade",Qe.nextDecade,(e={},e["ms-DatePicker-nextDecade--disabled "+Qe.nextDecadeIsDisabled]=u,e)),onClick:!u&&o?this._onSelectNext:void 0,onKeyDown:!u&&o?this._onKeyDown:void 0,type:"button",tabIndex:0,title:i,disabled:this.isDisabled},s.createElement(v.e,{iconName:Object(c.e)()?t.leftNavigation:t.rightNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.maxYear;return void 0!==e&&this.props.fromYear+12>e},enumerable:!0,configurable:!0});return t})(s.Component),rt=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-decadeComponents",Qe.decadeComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",Qe.navContainer)},s.createElement(tt,Object(i.__assign)({},this.props)),s.createElement(nt,Object(i.__assign)({},this.props))))};return t})(s.Component),it=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onHeaderSelect=function(){t.props.onHeaderSelect&&t.props.onHeaderSelect(!0)};t._onHeaderKeyDown=function(e){!t.props.onHeaderSelect||e.which!==u.e.enter&&e.which!==u.e.space||t.props.onHeaderSelect(!0)};t._onRenderYear=function(e){return t.props.onRenderYear?t.props.onRenderYear(e):e};return t}t.prototype.render=function(){var e=this.props,t=e.fromYear,n=e.toYear;if(e.onHeaderSelect){var r=this.props.strings||Ge,i=r.rangeAriaLabel,o=i?"string"==typeof i?i:i(this.props):void 0,u=r.headerAriaLabelFormatString?Object(h.e)(r.headerAriaLabelFormatString,o):o;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentDecade js-showYearPicker",Qe.currentDecade,Qe.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":u,role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},this._onRenderYear(t)," - ",this._onRenderYear(n))}return s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentDecade js-showYearPicker",Qe.currentDecade)},this._onRenderYear(t)," - ",this._onRenderYear(n))};return t})(s.Component),st=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderTitle=function(){return t.props.onRenderTitle?t.props.onRenderTitle(t.props):s.createElement(it,Object(i.__assign)({},t.props))};t._onRenderNav=function(){return s.createElement(rt,Object(i.__assign)({},t.props))};return t}t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",Qe.header)},this._onRenderTitle(),this._onRenderNav())};return t})(s.Component),ot=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._gridRef=s.createRef();n._onNavNext=function(){n.setState({fromYear:n.state.fromYear+12})};n._onNavPrev=function(){n.setState({fromYear:n.state.fromYear-12})};n._renderHeader=function(){return s.createElement(st,Object(i.__assign)({},n.props,{fromYear:n.state.fromYear,toYear:n.state.fromYear+12-1,onSelectPrev:n._onNavPrev,onSelectNext:n._onNavNext}))};n._renderGrid=function(){return s.createElement(et,Object(i.__assign)({},n.props,{fromYear:n.state.fromYear,toYear:n.state.fromYear+12-1,ref:n._gridRef}))};n.state=n._calculateInitialStateFromProps(t);return n}t.prototype.focus=function(){this._gridRef.current&&this._gridRef.current.focus()};t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-yearPicker",Qe.yearPicker)},this._renderHeader(),this._renderGrid())};t.prototype._calculateInitialStateFromProps=function(e){var t=e.selectedYear,n=e.navigatedYear,r=t||n||(new Date).getFullYear();return{fromYear:10*Math.floor(r/10),navigatedYear:n,selectedYear:t}};return t})(s.Component),ut=r,at=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._navigatedMonthRef=s.createRef();n._onCalendarYearRef=function(e){n._calendarYearRef=e};n._onKeyDown=function(e,t){t.which===u.e.enter&&e()};n._onSelectYear=function(e){n._focusOnUpdate=!0;var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.maxDate,o=t.minDate;if(r.getFullYear()!==e){var u=new Date(r.getTime());u.setFullYear(e);s&&u>s?u=Object(m.d)(u,s.getMonth()):o&&u<o&&(u=Object(m.d)(u,o.getMonth()));i(u,!0)}n.setState({isYearPickerVisible:!1})};n._yearToString=function(e){var t=n.props,r=t.navigatedDate,i=t.dateTimeFormatter;if(i){var s=new Date(r.getTime());s.setFullYear(e);return i.formatYear(s)}return String(e)};n._yearRangeToString=function(e){return n._yearToString(e.fromYear)+" - "+n._yearToString(e.toYear)};n._yearRangeToNextDecadeLabel=function(e){var t=n.props.strings;return t.nextYearRangeAriaLabel?t.nextYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._yearRangeToPrevDecadeLabel=function(e){var t=n.props.strings;return t.prevYearRangeAriaLabel?t.prevYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._onRenderYear=function(e){return n._yearToString(e)};n._onSelectNextYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(Object(m.r)(t,1),!1)};n._onSelectNextYearKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectNextYear,e)};n._onSelectPrevYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(Object(m.r)(t,-1),!1)};n._onSelectPrevYearKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectPrevYear,e)};n._onSelectMonthKeyDown=function(e){return function(t){return n._onKeyDown(function(){return n._onSelectMonth(e)},t)}};n._onSelectMonth=function(e){var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.onHeaderSelect;s&&s(!0);i(Object(m.d)(r,e),!0)};n._onHeaderSelect=function(){var e=n.props,t=e.onHeaderSelect;if(e.yearPickerHidden)t&&t(!0);else{n._focusOnUpdate=!0;n.setState({isYearPickerVisible:!0})}};n._onYearPickerHeaderSelect=function(e){n._focusOnUpdate=e;n.setState({isYearPickerVisible:!1})};n._onHeaderKeyDown=function(e){!n._onHeaderSelect||e.which!==u.e.enter&&e.which!==u.e.space||n._onHeaderSelect()};Object(a.e)(n);n._selectMonthCallbacks=[];t.strings.shortMonths.forEach(function(e,t){n._selectMonthCallbacks[t]=n._onSelectMonth.bind(n,t)});n._isCurrentMonth=n._isCurrentMonth.bind(n);n._onSelectNextYear=n._onSelectNextYear.bind(n);n._onSelectPrevYear=n._onSelectPrevYear.bind(n);n._onSelectMonth=n._onSelectMonth.bind(n);n.state={isYearPickerVisible:!1};return n}t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e,t,n=this,r=this.props,i=r.navigatedDate,o=r.selectedDate,u=r.strings,a=r.today,f=r.highlightCurrentMonth,p=r.highlightSelectedMonth,g=r.navigationIcons,y=r.dateTimeFormatter,b=r.minDate,w=r.maxDate,E=r.yearPickerHidden;if(this.state.isYearPickerVisible){var S=i?i.getFullYear():void 0;return s.createElement(ot,{key:"calendarYear_"+(S&&S.toString()),minYear:b?b.getFullYear():void 0,maxYear:w?w.getFullYear():void 0,onSelectYear:this._onSelectYear,navigationIcons:g,onHeaderSelect:this._onYearPickerHeaderSelect,selectedYear:S,onRenderYear:this._onRenderYear,strings:{rangeAriaLabel:this._yearRangeToString,prevRangeAriaLabel:this._yearRangeToPrevDecadeLabel,nextRangeAriaLabel:this._yearRangeToNextDecadeLabel,headerAriaLabelFormatString:u.yearPickerHeaderAriaLabel},ref:this._onCalendarYearRef})}for(var x=[],T=0;T<u.shortMonths.length/4;T++)x.push(T);var N=g.leftNavigation,C=g.rightNavigation,k=!b||Object(m.i)(b,Object(m.h)(i))<0,L=!w||Object(m.i)(Object(m.c)(i),w)<0,A=y.formatYear(i),O=u.monthPickerHeaderAriaLabel?Object(h.e)(u.monthPickerHeaderAriaLabel,A):A;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthPicker",ut.monthPicker)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",ut.header)},this.props.onHeaderSelect||!E?s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentYear js-showYearPicker",ut.currentYear,ut.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":O,role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},y.formatYear(i)):s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentYear js-showYearPicker",ut.currentYear)},y.formatYear(i)),s.createElement("div",{className:Object(l.e)("ms-DatePicker-yearComponents",ut.yearComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",ut.navContainer)},s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevYear js-prevYear",ut.prevYear,(e={},e["ms-DatePicker-prevYear--disabled "+ut.prevYearIsDisabled]=!k,e)),disabled:!k,onClick:k?this._onSelectPrevYear:void 0,onKeyDown:k?this._onSelectPrevYearKeyDown:void 0,title:u.prevYearAriaLabel?u.prevYearAriaLabel+" "+y.formatYear(Object(m.r)(i,-1)):void 0,role:"button",type:"button"},s.createElement(v.e,{iconName:Object(c.e)()?C:N})),s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextYear js-nextYear",ut.nextYear,(t={},t["ms-DatePicker-nextYear--disabled "+ut.nextYearIsDisabled]=!L,t)),disabled:!L,onClick:L?this._onSelectNextYear:void 0,onKeyDown:L?this._onSelectNextYearKeyDown:void 0,title:u.nextYearAriaLabel?u.nextYearAriaLabel+" "+y.formatYear(Object(m.r)(i,1)):void 0,role:"button",type:"button"},s.createElement(v.e,{iconName:Object(c.e)()?N:C}))))),s.createElement(d.e,null,s.createElement("div",{className:Object(l.e)("ms-DatePicker-optionGrid",ut.optionGrid),role:"grid","aria-readonly":"true"},x.map(function(e){var t=u.shortMonths.slice(4*e,4*(e+1));return s.createElement("div",{key:"monthRow_"+e,role:"row"},t.map(function(t,r){var c,h=4*e+r,d=Object(m.d)(i,h),v=n._isCurrentMonth(h,i.getFullYear(),a),g=i.getMonth()===h,E=o.getMonth()===h,S=o.getFullYear()===i.getFullYear(),x=(!b||Object(m.i)(b,Object(m.u)(d))<1)&&(!w||Object(m.i)(Object(m.a)(d),w)<1);return s.createElement("button",{role:"gridcell",className:Object(l.e)("ms-DatePicker-monthOption",ut.monthOption,(c={},c["ms-DatePicker-day--today "+ut.monthIsCurrentMonth]=f&&v,c["ms-DatePicker-day--highlighted "+ut.monthIsHighlighted]=(f||p)&&E&&S,c["ms-DatePicker-monthOption--disabled "+ut.monthOptionIsDisabled]=!x,c)),disabled:!x,key:h,onClick:x?n._selectMonthCallbacks[h]:void 0,onKeyDown:x?n._onSelectMonthKeyDown(h):void 0,"aria-label":y.formatMonthYear(d,u),"aria-selected":g,"data-is-focusable":!!x||void 0,ref:g?n._navigatedMonthRef:void 0,type:"button"},t)}))}))))};t.prototype.focus=function(){if(this._calendarYearRef)this._calendarYearRef.focus();else if(this._navigatedMonthRef.current){this._navigatedMonthRef.current.tabIndex=0;this._navigatedMonthRef.current.focus()}};t.prototype._isCurrentMonth=function(e,t,n){return n.getFullYear()===t&&n.getMonth()===e};return t})(s.Component),ft=n(374),lt=n(149),ct=n(1135);n.d(t,"e",function(){return mt});var ht=r,pt={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},dt=[o.t.Monday,o.t.Tuesday,o.t.Wednesday,o.t.Thursday,o.t.Friday],vt={formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()},formatDay:function(e){return e.getDate().toString()},formatYear:function(e){return e.getFullYear().toString()}},mt=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._dayPicker=s.createRef();n._monthPicker=s.createRef();n._hasFocus=!1;n._onBlur=function(e){if(!Object(ft.e)(e.currentTarget,e.relatedTarget)){n._hasFocus=!1;n.props.onBlur&&n.props.onBlur(e)}};n._onFocus=function(e){if(!n._hasFocus){n._hasFocus=!0;n.props.onFocus&&n.props.onFocus(e)}};n._navigateDayPickerDay=function(e){n.setState({navigatedDayDate:e,navigatedMonthDate:e})};n._navigateMonthPickerDay=function(e){n.setState({navigatedMonthDate:e})};n._onNavigateDayDate=function(e,t){n._navigateDayPickerDay(e);n._focusOnUpdate=t};n._onNavigateMonthDate=function(e,t){if(t){!n.props.showMonthPickerAsOverlay&&!n.props.isDayPickerVisible&&n._onSelectDate(e);n._navigateDayPickerDay(e)}else{n._navigateMonthPickerDay(e);n._focusOnUpdate=t}};n._onSelectDate=function(e,t){var r=n.props.onSelectDate;n.setState({selectedDate:e});r&&r(e,t)};n._onHeaderSelect=function(e){n.setState({isDayPickerVisible:!n.state.isDayPickerVisible,isMonthPickerVisible:!n.state.isMonthPickerVisible});e&&(n._focusOnUpdate=!0)};n._onGotoToday=function(){var e=n.props,t=e.dateRangeType,r=e.firstDayOfWeek,i=e.today,s=e.workWeekDays;if(e.selectDateOnClick){var o=Object(m.o)(i,t,r,s);n._onSelectDate(i,o)}n._navigateDayPickerDay(i);n._focusOnUpdate=!0};n._onGotoTodayClick=function(e){n._onGotoToday()};n._onGotoTodayKeyDown=function(e){if(e.which===u.e.enter){e.preventDefault();n._onGotoToday()}};n._onDatePickerPopupKeyDown=function(e){switch(e.which){case u.e.enter:case u.e.backspace:e.preventDefault();break;case u.e.escape:n._handleEscKey(e)}};n._handleEscKey=function(e){n.props.onDismiss&&n.props.onDismiss()};Object(a.e)(n);var r=t.value&&!isNaN(t.value.getTime())?t.value:t.today||new Date;n.state={selectedDate:r,navigatedDayDate:r,navigatedMonthDate:r,isMonthPickerVisible:!n.props.showMonthPickerAsOverlay&&n.props.isMonthPickerVisible,isDayPickerVisible:!!n.props.showMonthPickerAsOverlay||n.props.isDayPickerVisible};n._focusOnUpdate=!1;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.autoNavigateOnSelection,n=e.value,r=e.today,i=void 0===r?new Date:r;t&&!Object(m.s)(n,this.props.value)&&this.setState({navigatedMonthDate:n,navigatedDayDate:n});this.setState({selectedDate:n||i})};t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e,t=this.props,n=t.firstDayOfWeek,r=t.dateRangeType,o=t.strings,u=t.showMonthPickerAsOverlay,a=t.autoNavigateOnSelection,f=t.showGoToToday,c=t.highlightCurrentMonth,h=t.highlightSelectedMonth,p=t.navigationIcons,d=t.minDate,v=t.maxDate,m=t.restrictedDates,g=t.className,y=t.showCloseButton,b=t.allFocusable,w=t.yearPickerHidden,E=t.today,S=Object(lt.u)(this.props,lt.s,["value"]),x=this.state,T=x.selectedDate,N=x.navigatedDayDate,C=x.navigatedMonthDate,k=x.isMonthPickerVisible,L=x.isDayPickerVisible,A=u?this._onHeaderSelect:void 0,O=!u&&!L,M=u&&f,_=f;_&&N&&C&&E&&(_=N.getFullYear()!==E.getFullYear()||N.getMonth()!==E.getMonth()||C.getFullYear()!==E.getFullYear()||C.getMonth()!==E.getMonth());return s.createElement("div",{className:Object(l.e)("ms-DatePicker",ht.root,g),role:"application"},s.createElement("div",Object(i.__assign)({},S,{onBlur:this._onBlur,onFocus:this._onFocus,className:Object(l.e)("ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused",ht.picker,ht.pickerIsOpened,ht.pickerIsFocused,k&&"ms-DatePicker-monthPickerVisible "+ht.monthPickerVisible,k&&L&&"ms-DatePicker-calendarsInline "+ht.calendarsInline,O&&"ms-DatePicker-monthPickerOnly "+ht.monthPickerOnly,u&&"ms-DatePicker-monthPickerAsOverlay "+ht.monthPickerAsOverlay)}),s.createElement("div",{className:Object(l.e)("ms-DatePicker-holder ms-slideDownIn10",ht.holder,M&&ht.holderWithButton),onKeyDown:this._onDatePickerPopupKeyDown},s.createElement("div",{className:Object(l.e)("ms-DatePicker-frame",ht.frame)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-wrap",ht.wrap,f&&ht.goTodaySpacing)},L&&s.createElement(Ke,{selectedDate:T,navigatedDate:N,today:this.props.today,onSelectDate:this._onSelectDate,onNavigateDate:this._onNavigateDayDate,onDismiss:this.props.onDismiss,firstDayOfWeek:n,dateRangeType:r,autoNavigateOnSelection:a,strings:o,onHeaderSelect:A,navigationIcons:p,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,dateTimeFormatter:this.props.dateTimeFormatter,showSixWeeksByDefault:this.props.showSixWeeksByDefault,minDate:d,maxDate:v,restrictedDates:m,workWeekDays:this.props.workWeekDays,componentRef:this._dayPicker,showCloseButton:y,allFocusable:b}),L&&k&&s.createElement("div",{className:ht.divider}),k&&s.createElement(at,{navigatedDate:C,selectedDate:N,strings:o,onNavigateDate:this._onNavigateMonthDate,today:this.props.today,highlightCurrentMonth:c,highlightSelectedMonth:h,onHeaderSelect:A,navigationIcons:p,dateTimeFormatter:this.props.dateTimeFormatter,minDate:d,maxDate:v,componentRef:this._monthPicker,yearPickerHidden:w||u}),f&&s.createElement("button",{role:"button",className:Object(l.e)("ms-DatePicker-goToday js-goToday",ht.goToday,(e={},e[ht.goTodayInlineMonth]=k,e[ht.goToTodayIsDisabled]=!_,e)),onClick:this._onGotoTodayClick,onKeyDown:this._onGotoTodayKeyDown,tabIndex:0,disabled:!_,type:"button"},o.goToToday))))),s.createElement(ct.e,null))};t.prototype.focus=function(){this.state.isDayPickerVisible&&this._dayPicker.current?this._dayPicker.current.focus():this.state.isMonthPickerVisible&&this._monthPicker.current&&this._monthPicker.current.focus()};t.defaultProps={onSelectDate:void 0,onDismiss:void 0,isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,value:void 0,today:new Date,firstDayOfWeek:o.t.Sunday,dateRangeType:o.e.Day,autoNavigateOnSelection:!1,showGoToToday:!0,strings:null,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:pt,showWeekNumbers:!1,firstWeekOfYear:o.n.FirstDay,dateTimeFormatter:vt,showSixWeeksByDefault:!1,workWeekDays:dt,showCloseButton:!1,allFocusable:!1};return t})(s.Component)},"1918":function(e,t,n){"use strict";var r=n(1681),i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12};n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"a",function(){return f});n.d(t,"u",function(){return l});n.d(t,"h",function(){return c});n.d(t,"c",function(){return h});n.d(t,"d",function(){return p});n.d(t,"s",function(){return d});n.d(t,"i",function(){return v});n.d(t,"o",function(){return m});n.d(t,"p",function(){return g});n.d(t,"l",function(){return y});n.d(t,"f",function(){return b});function s(e,t){var n=new Date(e.getTime());n.setDate(n.getDate()+t);return n}function o(e,t){return s(e,t*i.DaysInOneWeek)}function u(e,t){var n=new Date(e.getTime()),r=n.getMonth()+t;n.setMonth(r);n.getMonth()!==(r%i.MonthInOneYear+i.MonthInOneYear)%i.MonthInOneYear&&(n=s(n,-n.getDate()));return n}function a(e,t){var n=new Date(e.getTime());n.setFullYear(e.getFullYear()+t);n.getMonth()!==(e.getMonth()%i.MonthInOneYear+i.MonthInOneYear)%i.MonthInOneYear&&(n=s(n,-n.getDate()));return n}function f(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function l(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}function c(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function h(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)}function p(e,t){return u(e,t-e.getMonth())}function d(e,t){return!e&&!t||!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}function v(e,t){return E(e)-E(t)}function m(e,t,n,o,a){void 0===a&&(a=1);var f,l=new Array,c=null;o||(o=[r.t.Monday,r.t.Tuesday,r.t.Wednesday,r.t.Thursday,r.t.Friday]);a=Math.max(a,1);switch(t){case r.e.Day:c=s(f=w(e),a);break;case r.e.Week:case r.e.WorkWeek:f=(function(e,t){var n=t-e.getDay();n>0&&(n-=i.DaysInOneWeek);return s(e,n)})(w(e),n);c=s(f,i.DaysInOneWeek);break;case r.e.Month:c=u(f=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:throw new Error("Unexpected object: "+t)}var h=f;do{(t!==r.e.WorkWeek||-1!==o.indexOf(h.getDay()))&&l.push(h);h=s(h,1)}while(!d(h,c));return l}function g(e,t){for(var n=0,r=t;n<r.length;n++){if(d(e,r[n]))return!0}return!1}function y(e,t,n,s){var o=s.getFullYear(),u=s.getMonth(),a=1,f=new Date(o,u,a),l=a+(t+i.DaysInOneWeek-1)-(function(e,t){return e!==r.t.Sunday&&t<e?t+i.DaysInOneWeek:t})(t,f.getDay()),c=new Date(o,u,l);a=c.getDate();for(var h=[],p=0;p<e;p++){h.push(b(c,t,n));a+=i.DaysInOneWeek;c=new Date(o,u,a)}return h}function b(e,t,n){switch(n){case r.n.FirstFullWeek:return S(e,t,i.DaysInOneWeek);case r.n.FirstFourDayWeek:return S(e,t,4);default:return(function(e,t){var n=x(e)-1,r=(e.getDay()-n%i.DaysInOneWeek-t+2*i.DaysInOneWeek)%i.DaysInOneWeek;return Math.floor((n+r)/i.DaysInOneWeek+1)})(e,t)}}function w(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function E(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function S(e,t,n){var s=x(e)-1,o=e.getDay()-s%i.DaysInOneWeek,u=x(new Date(e.getFullYear()-1,r.r.December,31))-1,a=(t-o+2*i.DaysInOneWeek)%i.DaysInOneWeek;0!==a&&a>=n&&(a-=i.DaysInOneWeek);var f=s-a;if(f<0){0!==(a=(t-(o-=u%i.DaysInOneWeek)+2*i.DaysInOneWeek)%i.DaysInOneWeek)&&a+1>=n&&(a-=i.DaysInOneWeek);f=u-a}return Math.floor(f/i.DaysInOneWeek+1)}function x(e){for(var t=e.getMonth(),n=e.getFullYear(),r=0,i=0;i<t;i++)r+=T(i+1,n);return r+=e.getDate()}function T(e,t){return new Date(t,e,0).getDate()}},"1955":function(e,t,n){"use strict";var r=n(650),i=n(0),s=n("react-lib"),o=n(346),u=Object(o.e)(),a=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderProgress=function(e){var n=t.props,r=n.ariaValueText,i=n.barHeight,o=n.className,a=n.styles,f=n.theme,l="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,c=u(a,{theme:f,className:o,barHeight:i,indeterminate:void 0===l}),h={width:void 0!==l?l+"%":void 0,transition:void 0!==l&&l<.01?"none":void 0},p=void 0!==l?0:void 0,d=void 0!==l?100:void 0,v=void 0!==l?Math.floor(l):void 0;return s.createElement("div",{className:c.itemProgress},s.createElement("div",{className:c.progressTrack}),s.createElement("div",{className:c.progressBar,style:h,role:"progressbar","aria-valuemin":p,"aria-valuemax":d,"aria-valuenow":v,"aria-valuetext":r}))};return t}t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,r=e.label,o=void 0===r?this.props.title:r,a=e.description,f=e.styles,l=e.theme,c=e.progressHidden,h=e.onRenderProgress,p=void 0===h?this._onRenderProgress:h,d="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,v=u(f,{theme:l,className:n,barHeight:t,indeterminate:void 0===d});return s.createElement("div",{className:v.root},o?s.createElement("div",{className:v.itemName},o):null,c?null:p(Object(i.__assign)(Object(i.__assign)({},this.props),{percentComplete:d}),this._onRenderProgress),a?s.createElement("div",{className:v.itemDescription},a):null)};t.defaultProps={label:"",description:"",width:180};return t})(s.Component),f=n(22),l=n(86),c=n(470),h={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},p=Object(l.t)(function(){return Object(f.P)({"0%":{left:"-30%"},"100%":{left:"100%"}})}),d=Object(l.t)(function(){return Object(f.P)({"100%":{right:"-30%"},"0%":{right:"100%"}})});n.d(t,"e",function(){return v});var v=Object(r.e)(a,function(e){var t,n,r,s=Object(c.e)(e.theme),o=e.className,u=e.indeterminate,a=e.theme,l=e.barHeight,v=void 0===l?2:l,m=a.palette,g=a.semanticColors,y=a.fonts,b=Object(f.N)(h,a),w=m.neutralLight;return{root:[b.root,y.medium,o],itemName:[b.itemName,f.F,{color:g.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[b.itemDescription,{color:g.bodySubtext,fontSize:y.small.fontSize,lineHeight:18}],itemProgress:[b.itemProgress,{position:"relative",overflow:"hidden",height:v,padding:"8px 0"}],progressTrack:[b.progressTrack,{position:"absolute",width:"100%",height:v,backgroundColor:w,selectors:(t={},t[f.o]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:m.themePrimary,height:v,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[f.o]=Object(i.__assign)({backgroundColor:"highlight"},Object(f.C)()),n)},u?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+w+" 0%, "+m.themePrimary+" 50%, "+w+" 100%)",animation:(s?d():p())+" 3s infinite",selectors:(r={},r[f.o]={background:"highlight"},r)}:{transition:"width .15s linear"},b.progressBar]}},void 0,{scope:"ProgressIndicator"})},"2046":function(e,t,n){"use strict";var r=n(0),i=n(150);Object(i.n)([{rawString:".od-PolicyTip-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:100;margin:0px 0px 8px 0px}.od-PolicyTip-description{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0px}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300;font-weight:600}[dir='ltr'] .od-PolicyTip-headerText{margin-left:12px}[dir='rtl'] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-bottom:12px}[dir='ltr'] .od-PolicyTip-issue{margin-left:33px}[dir='rtl'] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir='rtl'] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir='ltr'] .od-PolicyTip-label{margin-left:4px}[dir='rtl'] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir='ltr'] .od-PolicyTip-statusText{margin-left:4px}[dir='rtl'] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300}\n"}]);var s=n(835),o=n(1394),u=n(1396),a=n(2965),f=n("react-lib"),l=n(20),c=n(600);n.d(t,"e",function(){return h});var h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onReportClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,reportButtonClicked:!0}),function(){n.props.onReportClicked()})};n._onOverrideClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{overrideButtonClicked:!0}),function(){n.props.onOverrideClicked()})};n._onOverrideSubmitClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){n.props.onOverrideSubmitClicked(n.state.justificationText)})};n._onJustificationChanged=function(e,t){n.props.overrideRequiresJustification&&n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{justificationText:t||"",overrideSubmitDisabled:!t}))};n.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{isLoading:!1}))};t.prototype.componentWillUnmount=function(){this.props.onDismissed()};t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),f.createElement("div",{className:"od-PolicyTip-header"},f.createElement(c.e,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),f.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),f.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),f.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return f.createElement("div",null,f.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,r=this.props.strings.issues;n<r.length;n++){var i=r[n];e.push(f.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e};t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=f.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=l.formatToArray(e.learnMoreLabel,t);return f.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}};t.prototype._getAction=function(e,t,n,r){if(n)return f.createElement("div",{className:"od-PolicyTip-action"},f.createElement("span",null,""+l.format(e,t)));var i=f.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),s=l.formatToArray(e,i);return f.createElement("div",{className:"od-PolicyTip-action"},s)};t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,r=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(i);if(n.overrideActionLabel){var s=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(s)}return r};t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(u.e,null),f.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(c.e,{iconName:"CheckMark"}),f.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return f.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},f.createElement(a.e,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&f.createElement(o.e,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};return t})(s.e)},"2066":function(e,t,n){"use strict";var r;(function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"})(r||(r={}));t.e=r},"2770":function(e,t,n){"use strict";var r=n(150);Object(r.n)([{rawString:".od-Notify-callout{min-height:68px;width:260px}.od-Notify-callout:focus{outline:0}.od-Notify-callout .od-Share{min-width:inherit;min-height:inherit;width:inherit;height:inherit}.od-Notify-callout .od-Share .od-Share-spinnerHolder{min-width:inherit;min-height:inherit;width:inherit;height:inherit}"}]);var i=n(0),s=n(1628),o=n(1959),u=n(1614),a=n(1687),f=n(1723),l=n(30),c=n(158),h=n(1551),p=n(1580),d=n(1575),v=n(56),m=n(2026),g=n(4241),y=n(1596),b=n(1868),w=n(1588),E=n(1650),S=n("knockout-lib"),x=n(1563);var T=S.applyBindingsToNode,N=S.virtualElements,C=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n,i=r.observables,s=r.bindingContext,o=r.element,u=(function(){var e=document.createElement("a");e.href="javascript:;";e.className="ms-accessible";e.setAttribute("role","presentation");return e})();N.prepend(o,u);i.backgroundCompute(function(){u.focus()});T(u,{},s);return n}t.supportsVirtualElements=!0;return t})(x.t),k=n(178),L=n(1863),A=m.e.sharePoint,O=g.e.notify,M=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismiss=function(){var e=r._itemToShare(),t={name:"Notify.Dismissed",clientId:A,mode:O,appMap:e.appMap};k.e.logData(t);r._onExecuteAction()};r.addBindingHandlers({react:w.t,focusTrap:E.e,autoFocus:C});var i=t.groups,s=t.onExecuteAction;r._pageContext=n.pageContext;r._actionMap=n.actionMap;r._peoplePickerProvider=n.peoplePickerProvider;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._sharingProvider=n.sharingProvider;r._suiteNavProvider=n.suiteNavProvider;r._policyTipProvider=n.policyTipProvider;r._groupOperations=i;r._onExecuteAction=s;r.element=r.observables.create(null);r._itemToShare=t.item?r.observables.create(t.item):r.observables.pureCompute(r._computeItemToShare);r.showNotifyExperiment=r.observables.pureCompute(r._computeShowNotifyExperiment);r.scope.attach(t.showNotifyExperiment.register(r.showNotifyExperiment));r.shareComponent=b.e;r.shareComponentProps=r.createPureComputed(r._computeShareProps);return r}t.prototype._computeShowNotifyExperiment=function(){if(!this._policyTipProvider||!this._pageContext||!this._graphPeoplePickerHelper)return!1;var e=Number(this._pageContext.webTemplate);if(e===v.t.teamSite||e===v.t.group){var t=this._itemToShare();if(t){var n=new RegExp(this._pageContext.listUrl+"/Forms/"),r=t.id&&t.id.match(n);return t.type!==y.e.Folder&&!!t.properties.uniqueId&&!r}}return!1};t.prototype._computeShareProps=function(){var e=this._itemToShare(),t=new L.e({item:e,accessChecked:!1,sharingInformation:null,defaultRecipients:null,mode:O,sharingContextInformation:null},{sharingProvider:this._sharingProvider,suiteNavProvider:this._suiteNavProvider,peoplePickerProvider:this._peoplePickerProvider,policyTipProvider:this._policyTipProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper});return{clientId:A,actionMap:this._actionMap,item:e,onDismiss:this._onDismiss,peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper,resources:this.resources,sharingProvider:this._sharingProvider,policyTipProvider:this._policyTipProvider,mode:O,sharingStore:t}};t.prototype._computeItemToShare=function(){var e=this._groupOperations();if(1===e.length){var t=e[0].operations();if(1===t.length){var n=t[0];if(n.state()===p.e.completed&&n.type()===d.e.uploadItems){var r=n.payloads().uploadItems;if(r)return r.item()}}}};t.dependencies=Object(i.__assign)(Object(i.__assign)({},h.t.dependencies),{pageContext:l.h.optional,actionMap:c.e,peoplePickerProvider:s.t,graphPeoplePickerHelper:o.e.optional,sharingProvider:u.resourceKey,suiteNavProvider:a.resourceKey,policyTipProvider:f.e.optional});return t})(h.t),_=n(1555);n.d(t,"e",function(){return D});var D=Object(_.t)({automationName:"od-notify-experiment",name:"NotifyExperiment",template:'\x3c!--ko if:showNotifyExperiment--\x3e\x3c!--ko autoFocus--\x3e\x3c!--ko focusTrap--\x3e<div class="od-Notify-callout" data-bind="react:{componentType:shareComponent,props:shareComponentProps}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModelType:M})},"4288":function(e,t,n){"use strict";n.r(t);n.d(t,"uploadProgressCalloutControlHandler",function(){return C});n.d(t,"resourceKey",function(){return k});var r=n(0),i=n("react-lib"),s=n(106),o=n(64),u=n(1),a=n(9),f=n(168),l=n(82),c=n(1689),h=n(5),p=n(6),d=n(46),v=n(2389),m=n(195),g=n(2053),y=n(110),b=n(2192),w=n(1555),E=n(56),S=n(2770),x=n(990);function T(e){var t=Object(y.t)(),n=Object(b.n)(),r=Object(f.e)(function(){o&&o()}),s=e.item,o=e.onDismiss,u=i.useMemo(function(){return Object(w.r)(S.e,{item:s,onExecuteAction:r,showNotifyExperiment:n.createCallback(Object(c.t)(!1))})},[s.id,r]);return i.createElement(x.e,null,i.createElement(g.e,{specification:u,resources:t}))}function N(e){var t=i.useMemo(function(){if(e.itemKeys&&1===e.itemKeys.length)return e.itemKeys[0]},[e.itemKeys]);return i.createElement(m.e,null,i.useCallback(function(n){var f=(function(e,t){if(t){if(e.demandItemFacet(v.t,t)){var n=e.demandItemFacet(a.e,t);if(n&&1===n.itemKeys.length){var r=n.itemKeys[0],i=e.demandItemFacet(l.s,r);if(i){if(!!!e.demandItemFacet(h.d,i.itemKey)){var f=e.demandItemFacet(o.e,i.itemKey);if(f){var c=Object(d.e)(e,i.itemKey),p=Number(c?c.webTemplate:0);if(p===E.t.teamSite||p===E.t.group){var m=s.e.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}),g=e.demandItemFacet(u.Be,m);if(g&&g.id){var y=e.demandItemFacet(u.fe,i.itemKey);if(y&&(!c||0!==y.indexOf(c.listUrl+"/Forms/"))){var b=e.demandItemFacet(u.fn,i.itemKey),w=e.demandItemFacet(h.l,i.itemKey);if(w&&y){return{key:"",id:y,displayName:w,name:w,properties:{uniqueId:b,listId:g.id},isPlaceholder:!0}}}}}}}}}}}})(n.itemCache,t);if(!f){var c=e.defaultRender;return c?i.createElement(c,Object(r.__assign)({},e)):null}return i.createElement("div",{style:{margin:"10px"}},i.createElement(T,{item:f,onDismiss:e.onCalloutDismiss}))},[t]))}function C(e,t){return{contentAs:N}}var k=new p.t({name:"ProgressCalloutControlHandler",factory:new p.e(C)})}}]);