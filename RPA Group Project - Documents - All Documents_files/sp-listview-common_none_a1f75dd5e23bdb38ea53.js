define("5f18a9a1-d34e-4b05-a71f-e5e554d8649b_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-listview-extensibility","@microsoft/sp-application-base","@microsoft/sp-loader","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-extension-base","@microsoft/sp-diagnostics"],function(e,t,i,n,r,o,s,a,c){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="mwqp")}({"17wl":function(t,i){t.exports=e},"2q6Q":function(e,i){e.exports=t},"7wVe":function(e,t){e.exports=i},C36Z:function(e,t){},GPet:function(e,t){e.exports=n},I6O9:function(e,t){e.exports=r},UWqr:function(e,t){e.exports=o},"X+PM":function(e,t){e.exports=s},ZFc5:function(e,t){e.exports=a},mwqp:function(e,t,i){"use strict";i.r(t);var n=i("C36Z");for(var r in n)["default","SpfxAdapter"].indexOf(r)<0&&function(e){i.d(t,e,function(){return n[e]})}(r);var o=i("z09C");i.d(t,"SpfxAdapter",function(){return o.a})},ut3N:function(e,t){e.exports=c},z09C:function(e,t,i){"use strict";var n=i("GPet"),r=i("ZFc5"),o=i("UWqr"),s=i("7wVe"),a=i("2q6Q"),c=i("ut3N"),u=function(){function e(e,t,i){this._isDisposed=!1,this._domElement=i,this._column=e,this._row=t,this._error=void 0;var n=t.getValueByName(this._column.data.internalName),r=t.getUserData(this._column.data.internalName);this._event={domElement:i,row:t.accessor,listItem:t.accessor,fieldValue:n,userData:r};try{this._column.fieldCustomizer&&this._column.fieldCustomizer.onRenderCell(this._event),t.updateUserData(this._column.data.internalName,this._event.userData)}catch(e){this._error=e}}return Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellDiv",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.row=function(){return this._row},e.prototype.dispose=function(){if(!this._isDisposed){try{this._column.fieldCustomizer&&this._column.fieldCustomizer.onDisposeCell(this._event),this._row.onDisposeCell(this)}catch(t){c._TraceLogger.logError(e._logSource,t)}this._error=void 0,this._domElement=void 0,this._column=void 0,this._row=void 0,this._event=void 0,this._isDisposed=!0}},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e._logSource=c._LogSource.create("CellAdapter"),e}(),l=i("17wl"),d=i("X+PM"),p=function(e){function t(t){var i=e.call(this)||this,n=t.data;return i._field=new d.SPField({id:n.id,internalName:n.internalName,fieldType:n.fieldType,isRequired:n.isRequired,displayName:n.displayName,clientSideComponentId:n.clientSideComponentId,clientSideComponentProperties:n.clientSideComponentProperties}),i._visible=n.isVisible,i._onSetVisible=n.onSetVisible,i}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"field",{get:function(){return this._field},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._onSetVisible(e),this._visible=e},enumerable:!1,configurable:!0}),t}(s.ColumnAccessor),f=function(){function e(e,t){this._data=e,this._accessor=new p(this),this._listViewAdapter=t,this._fieldCustomizer=void 0}return Object.defineProperty(e.prototype,"listViewAdapter",{get:function(){return this._listViewAdapter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldCustomizerLoaded",{get:function(){return void 0!==this._fieldCustomizer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldCustomizer",{get:function(){return this._fieldCustomizer},set:function(e){this._fieldCustomizer=e},enumerable:!1,configurable:!0}),e.prototype.renderCell=function(e,t){if(!this.fieldCustomizer)throw new Error("renderCell() should not have been called because fieldCustomizerLoaded is false");return new u(this,e,t)},e}(),m=function(e){function t(t){var i=e.call(this)||this;for(var n in i._values=new Map,t.data.values)i._values.set(n,t.data.values[n]);return i._fields=t.listViewAdapter.fields,i}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),t.prototype.getValueByName=function(e){return this._values.get(e)},t.prototype.getValue=function(e){return this._values.get(e.internalName)},t}(s.RowAccessor),h=function(){function e(e,t){this._data=e,this._listViewAdapter=t,this._userData=new Map}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor||(this._accessor=new m(this)),this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listViewAdapter",{get:function(){return this._listViewAdapter},enumerable:!1,configurable:!0}),e.prototype.onDisposeCell=function(e){this._userData.delete(e.column.data.internalName)},e.prototype.getValueByName=function(e){if(this.data.values.hasOwnProperty(e))return this.data.values[e]},e.prototype.getUserData=function(e){return this._userData.has(e)||this._userData.set(e,void 0),this._userData.get(e)},e.prototype.updateUserData=function(e,t){this._userData.set(e,t)},e}(),_=function(e){function t(t){var i=e.call(this)||this;return i._adapter=t,i}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"columns",{get:function(){return this._adapter.columnAdapters.map(function(e){return e.accessor})},enumerable:!1,configurable:!0}),t.prototype.tryGetColumnByName=function(e){return this._adapter.tryGetColumnAccessorByName(e)},t}(s.ListViewAccessor),g=function(){function e(e,t,i){if(this.visible=!1,this.description="",this._lastSelectedRows=void 0,this.listViewAdapter=i,this._commandSet=t,this._command=t.tryGetCommand(e),this.commandId=e,!this._command)throw new Error("No command found for command id '"+e+"'");this._updateAdapter(),this.refresh([])}return e.prototype.refresh=function(e){var t=!1;if(this._lastSelectedRows&&1===this._lastSelectedRows.length&&1===e.length){var i=this._lastSelectedRows[0],n=e[0];if(i&&n&&i.data&&n.data&&i.data.values===n.data.values)return;t=!0}if(t||!this._lastSelectedRows||this._lastSelectedRows.length!==e.length){this._lastSelectedRows=e.slice(0);var r={selectedRows:e.map(function(e){return e.accessor})};this._commandSet.onListViewUpdated(r),this._updateAdapter()}},e.prototype.execute=function(){var e={commandId:this.commandId,itemId:this.commandId,selectedRows:(this._lastSelectedRows||[]).map(function(e){return e.accessor})};this._commandSet.onExecute(e)},e.prototype._updateAdapter=function(){this.visible=this._command.visible,this.title=this._command.title,this.ariaLabel=void 0!==this._command.ariaLabel?this._command.ariaLabel:this._command.title,this.iconUrl=this._command.iconImageUrl},e}(),y=function(){function e(e,t){this._commandAdapters=[],this._commandSet=e;for(var i=e.manifest.items,n=0,r=Object.getOwnPropertyNames(i);n<r.length;n++){var o=r[n];"command"===i[o].type&&this._commandAdapters.push(new g(o,this._commandSet,t))}}return Object.defineProperty(e.prototype,"commandAdapters",{get:function(){return this._commandAdapters},enumerable:!1,configurable:!0}),e}(),b=function(){function e(e){this._isDisposed=!1,this._columns=[],this._cachedFields=void 0,this._cachedInternalNamesMap=new Map,this._fieldCustomizerManager=new r._ExtensionManager(e,s.BaseFieldCustomizer),this._commandSetManager=new r._ExtensionManager(e,s.BaseListViewCommandSet),this._accessor=new _(this)}return Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnAdapters",{get:function(){return this._columns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._ensureColumnsCacheIsValid(),this._cachedFields},enumerable:!1,configurable:!0}),e.prototype.addColumnAdapter=function(e){var t=new f(e,this);return this._columns.push(t),this._invalidateColumnsCache(),t},e.prototype.createRowAdapter=function(e){return new h(e,this)},e.prototype.loadFieldCustomizers=function(){for(var t=this,i=[],n=function(n){var u=o.Guid.tryParse(n.data.clientSideComponentId);if(u&&!o.Guid.empty.equals(u)){var l=new a._QosMonitor("FieldCustomizer.Create");n.fieldCustomizer=void 0;var d=r._fieldCustomizerManager.createExtension(u.toString(),n.data.clientSideComponentProperties,function(e){return new s.FieldCustomizerContext(e,{listView:t.accessor,field:n.accessor.field})}).then(function(e){n.fieldCustomizer=e,l.writeSuccess({clientSideComponentId:u})}).catch(function(t){try{n.data.onFieldCustomizerError(t)}catch(t){c._TraceLogger.logError(e._logSource,t)}l.writeExpectedFailure("FailedCreateExtension",t,{clientSideComponentId:u})});i.push(d)}},r=this,u=0,l=this._columns;u<l.length;u++)n(l[u]);return Promise.all(i).then(function(){})},e.prototype.loadCommandSet=function(t,i){var n=this,r=new a._QosMonitor("ListViewCommandSet.Create");return this._commandSetManager.createExtension(t,i,function(e){return new s.ListViewCommandSetContext(e,{listView:n._accessor})}).then(function(e){return new y(e,n)}).then(function(e){return r.writeSuccess({clientSideComponentId:t}),e}).catch(function(i){throw r.writeExpectedFailure("FailedCreateExtension",i,{clientSideComponentId:t}),c._TraceLogger.logError(e._logSource,i),i})},e.prototype.tryGetColumnAccessorByName=function(e){this._ensureColumnsCacheIsValid();var t=this._cachedInternalNamesMap.get(e);if(t)return this._columns[t].accessor},e.prototype.raiseSelectedRowsChangedEvent=function(e){var t=e.map(function(e){return e.accessor});o._SPEventManager.instance.raiseStickyEvent(s.ListViewAccessor._selectedRowsChangedEventName,{selectedRows:t})},e.prototype.dispose=function(){this._isDisposed||(this._fieldCustomizerManager.dispose(),delete this._fieldCustomizerManager,this._commandSetManager.dispose(),delete this._commandSetManager,this._isDisposed=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype._invalidateColumnsCache=function(){this._cachedFields=void 0},e.prototype._ensureColumnsCacheIsValid=function(){var e=this;this._cachedFields||(this._cachedFields=[],this._cachedInternalNamesMap.clear(),this._columns.forEach(function(t,i){e._cachedFields.push(t.accessor.field),e._cachedInternalNamesMap.set(t.accessor.field.internalName,i)}))},e._logSource=c._LogSource.create("ListViewAdapter"),e}(),v=i("I6O9"),w=function(){function e(e){var t=this;this._serviceScope=e,e.whenFinished(function(){t._placeholderManager=e.consume(n._PlaceholderManager.serviceKey)})}return Object.defineProperty(e.prototype,"serviceScope",{get:function(){return this._serviceScope},enumerable:!1,configurable:!0}),e.prototype.registerManifests=function(e){v.SPComponentLoader.registerManifests(e)},e.prototype.createListViewAdapter=function(){return new b(this._serviceScope)},e.prototype.definePlaceholders=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];if("DialogContainer"===o.name)n._DialogManagerConfiguration.instance.initialize(o.div);else{var s=n.PlaceholderName[o.name];if("number"!=typeof s)throw new Error("definePlaceholders() was called with an unsupported name: "+o.name);t.push({name:s,domElement:o.div})}}this._placeholderManager.initializePlaceholders(t)},e}();t.a=w}})});