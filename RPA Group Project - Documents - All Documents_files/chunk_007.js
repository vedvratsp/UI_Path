(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[1,85],{"+shF":function(e,t,r){"use strict";var n=r("0to0"),o=r("Qcms"),c=r("RZul"),i=r("oetw"),a=r("b6au"),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.a=Object(i.a)(function(e){var t=e.token,r=e.clientType,o=e.environment,i=e.culture,s=e.additionalHeaders,f=e.siteId,l=void 0===f?"":f,d=Object(a.a)(r,u(u({},s),Object(a.c)()),t);return Object(c.a)({url:Object(n.constructUrl)(Object(a.e)(o,i),Object(a.d)(l,!1)),method:"GET",headers:d})},{monitorName:"searchConfiguration",cacheId:"searchConfiguration",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]),r=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return u(u({},t),{msSearchScenario:r})},additionalSuccessPropsExtractor:function(e){return u(u({},Object(o.c)(e.responseText)),{cacheClear:Object(n.getQueryStringValue)("cacheClear")})},forceRefresh:function(){return"true"===Object(n.getQueryStringValue)("cacheClear")}})},"0to0":function(e,t,r){"use strict";function n(e){var t=window&&window.location&&window.location.search||window.location.hash||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function o(e,t){var r=e,n=Object.keys(t);return n.length&&(r+="?",r+=n.map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")),r}r.r(t),r.d(t,"getQueryStringValue",function(){return n}),r.d(t,"constructUrl",function(){return o})},"1tuv":function(e,t,r){"use strict";r.r(t),r.d(t,"getSearchConfigScope",function(){return s}),r.d(t,"getSearchConfigPromise",function(){return f}),r.d(t,"getSearchConfigPromiseEntity",function(){return l}),r.d(t,"createSearchConfigPromiseEntity",function(){return d}),r.d(t,"default",function(){return p});var n,o=r("U7zf"),c=r("x5/w"),i=r("+shF"),a=r("b6au"),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(){return n&&n.option&&n.option.siteId||""}function f(){return n||d(),n?n.promiseObj:Promise.resolve([])}function l(){return n||d(),n}function d(e){if(!n||!n.isPending||n.isRejected){n={};var t=new Promise(function(e,t){n.promiseResolver=function(t){n.isPending=!1,e(t)},n.promiseRejector=function(){n.isRejected=!0,n.isPending=!1,t()}});n.promiseObj=t,n.isRejected=!1,t.catch(function(){})}n.isPending=!0,e&&(n.option=e)}function p(e){var t,r,f,l=s();if(n&&(!e.scope&&!l||(null===(r=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===r?void 0:r.toUpperCase())===l.toUpperCase())&&!n.isRejected){var p=n.option;return d(p),Object(i.a)(p).then(function(e){var t,r,o=e.xhr;if(o.responseText){var c=JSON.parse(o.responseText).verticalConfig;null===(t=n.promiseResolver)||void 0===t||t.call(n,c)}else null===(r=n.promiseRejector)||void 0===r||r.call(n)}).catch(function(e){var t;console.error(e),null===(t=n.promiseRejector)||void 0===t||t.call(n,e),Object(o.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")}),n.promiseObj}var h=e.lokiUrl,m=null===(f=null==n?void 0:n.option)||void 0===f?void 0:f.environment;return("Df"===m||"Msit"===m&&-1!==(null==h?void 0:h.toLowerCase().indexOf("df")))&&(h=Object(a.f)(m,n.option.culture,function(e){return e})),Object(c.a)(u(u({},e),{lokiUrl:h})).then(function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]}).catch(function(e){console.error(e),Object(o.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")})}},"4f8Z":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});var n=r("wpY6");function o(e,t){return Object(n.a)({monitorType:"chunk_load",monitorName:e+"_chunk_load",monitorOnce:!0},t)}},"4gcB":function(e,t,r){"use strict";function n(e){var t,r=Number.MAX_VALUE,n=e&&e.split(".");if(n&&3===n.length){var o=JSON.parse(function(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n=0,o=0,c="",i=-1;++i<t;)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(i)),o=n%4?64*o+r:r,n++%4&&(c+=String.fromCharCode(255&o>>(-2*n&6)));return c}(n[1]));o&&o.exp&&(r=1e3*o.exp),o&&o.puid&&(t=o.puid)}return{token:e,expEpoch:r,userPuid:t}}function o(e){return!!c(e)&&Date.now()>e.expEpoch-24e4}function c(e){return!(!e||e.expEpoch-Date.now()<12e4)}r.r(t),r.d(t,"toTokenDetail",function(){return n}),r.d(t,"isApproachingExpiration",function(){return o}),r.d(t,"isValid",function(){return c})},"6kg4":function(e,t,r){"use strict";r.r(t),r.d(t,"cacheId",function(){return i});var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i="spohubsitesinfo";t.default=Object(o.a)(function(e){var t=e.clientId,r=e.endpoint,o=e.token;return Object(n.a)({url:r+"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='"+t+"'&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:c({Accept:"application/json;odata=verbose"},o?{Authorization:"Bearer "+o}:{}),timeoutMs:5e3})},{monitorName:"prefetchSpoHubSitesInfo",cacheId:i,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}})},"7C7s":function(e,t,r){"use strict";r.r(t),r.d(t,"cacheId",function(){return i});var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i="personalaccountname";t.default=Object(o.a)(function(e){var t=e.url,r=e.token;return Object(n.a)({url:t,method:"GET",headers:c({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"fetchPersonalAccountName",cacheId:i,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}})},"88VM":function(e,t,r){"use strict";r.r(t),t.default=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},"9iPW":function(e,t,r){"use strict";r.r(t);var n=r("RZul"),o=r("Fits"),c=r("IY21"),i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=["https://substrate.office.com","https://loki.delve.office.com","https://www.bing.com","https://outlook.office365.com/search"];t.default=Object(c.a)({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return i({},t&&{resource:u(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t;return(null===(t=null==e?void 0:e.requestLogData)||void 0===t?void 0:t.resource)?{resource:e.requestLogData.resource}:{}}},Object(o.a)(function(e){var t=e.digest,r=e.portalUrl,o=e.resourceUrl,c={resource:o};return e.useSTI&&(c.tokenType="STI"),Object(n.a)(i({url:r+"/_api/SP.OAuth.Token/Acquire",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(c),timeoutMs:7e3},u(o)&&{requestLogData:{resource:o}})).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}})})({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}}));var u=function(e){return-1!==a.indexOf(e)}},Fits:function(e,t,r){"use strict";function n(e){if(!o(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),r=t.length,n=[],c=0;c<r;c++){var i=t[c],a=e[i];void 0===a||o(a)||"function"==typeof a||n.push(i+":"+a)}return n.join(",")}function o(e){return"object"==typeof e&&null!==e}r.d(t,"a",function(){return j});var c,i=r("g4n3"),a=r("7jI3"),u=!1,s=!1;function f(e,t,r){var n;p(r);var o=l();try{var c=o.getItem(e);if(!c)return null;n=JSON.parse(c)}catch(e){return!u&&Object(a.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),u=!0,null}return n?n.cacheVersion!==t?(o.removeItem(e),null):n.puid&&n.puid===r?n:(o.removeItem(e),null):null}var l=function(){return c||(c={getItem:function(e){return sessionStorage.getItem(d(e))},removeItem:function(e){return sessionStorage.removeItem(d(e))},setItem:function(e,t){return sessionStorage.setItem(d(e),t)}})};function d(e){return"mssearchux-cache-"+e}function p(e){!e&&Object(i.thr)("Puid not set.")}var h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=function(e,t,r){p(r);var n=v(e);return n&&n.puid!==r&&(n=null),n||b(e,{puid:r,cacheItems:g(e,t,r)||{}})},v=function(e){return Object(i.cache)().caches[e]},b=function(e,t){return Object(i.cache)().caches[e]=t};function g(e,t,r){var n=f(e,t,r);if(!n)return null;var o=n.cacheItems;return Object.keys(o).reduce(function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:o[t].value,status:o[t].status||0}}),expiryTime:o[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e},{})}function O(e,t){return Object(i.cache)().caches[e]?Object(i.cache)().caches[e].cacheItems[t]=null:null}var y=function(e,t,r){return e[t]=r};function j(e){return function(t){return function(r){var o=t.cacheKeyExtractor(r)||{};return!(t.forceRefresh&&t.forceRefresh())&&function(e,t,r,o){void 0===o&&(o={});var c=n(o),i=m(e,t,r).cacheItems[c];if(i){if(Date.now()<i.expiryTime)return i.value.then(function(e){return h(h({},e),{cacheItemType:i.cacheItemType,cacheItemResolved:i.cacheItemResolved,expiryTime:i.expiryTime})});O(e,c)}return null}(t.cacheId,t.cacheVersion,Object(i.puid)(),o)||function(e,t,r,o){var c=e.cacheId,i=e.cacheVersion,u=e.cacheItemLifetime;void 0===o&&(o={}),p(t);var d=n(o),v=m(c,i,t).cacheItems,b=y(v,d,{value:r,expiryTime:Date.now()+u,cacheItemType:"memory",cacheItemResolved:!1});return r.then(function(e){return y(v,d,h(h({},b),{cacheItemResolved:!0})),function(e,t,r,n,o,c,i){p(r);var u=f(e,t,r)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:r,cacheItems:{}};u.cacheItems[n]={value:o,expiryTime:c,status:i};try{l().setItem(e,JSON.stringify(u))}catch(t){!s&&Object(a.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),s=!0}}(c,i,t,d,e.xhr.responseText,b.expiryTime,e.xhr.status),h(h({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:b.expiryTime})},function(e){throw O(c,d),e})}(t,Object(i.puid)(),e(r),o)}}}},G8Vc:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveSubstrateUrl",function(){return o});var n=r("Tju1");function o(e){switch(e){case"Blackforest":return"https://substrate.office.de";case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"AG08":return"https://substrate.exo.eaglex.ic.gov";case"AG09":return"https://substrate.exo.microsoft.scloud";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return"https://substrate.office.com";default:return Object(n.b)(e,"https://substrate.office.com")}}},G8jq:function(e,t,r){"use strict";function n(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://"+e}r.d(t,"a",function(){return n})},Gmr8:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(n||(n={}))},IY21:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("w483"),o=r("wpY6"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r=e.monitorName,n=e.monitorType,i=void 0===n?"prefetch_request":n,u=e.additionalSuccessPropsExtractor,s=e.additionalFailurePropsExtractor;return Object(o.a)({monitorName:r,monitorType:i,successPropExtractor:function(e){var t=e.xhr,r=e.tokenAttemptCount,n=e.tokenFetchDuration,o=e.cacheItemResolved,i=e.cacheItemType;return c(c(c(c({},a(t)),r?{tokenAttemptCount:r,tokenFetchDuration:Math.round(n)}:{}),{cacheItemResolved:o,cacheItemType:i}),null==u?void 0:u(t))},failurePropExtractor:function(e){var t;return c(c(c({},null==s?void 0:s(e)),a(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},function(e){return void 0===e?Promise.reject("undefined options"):t(e)})}function a(e){if(!e||!e.getAllResponseHeaders)return{};var t=Object(n.getNamedHeadersFromXhr)(e,[n.spRequestDurationHeader,n.spClientServiceRequestDurationHeader,n.sharePointCorrelationHeader]),r={};return r[n.sharePointCorrelationHeader]=t[n.sharePointCorrelationHeader],r[n.spRequestDurationHeader]=t[n.spRequestDurationHeader]||t[n.spClientServiceRequestDurationHeader]||void 0,r}},M8TR:function(e,t,r){"use strict";function n(e){return e?e.filter(function(e){return e.indexOf("31828")>-1}).join()||e.join():void 0}r.d(t,"a",function(){return n})},PM3F:function(e,t,r){"use strict";r.r(t),r.d(t,"fetchSpHomePrefetch",function(){return u}),r.d(t,"fetchSpHomeNews",function(){return s});var n,o=r("RZul"),c=r("oetw"),i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=(n=function(e){var t=e.clientId,r=e.token,n=e.fetcher,c=(0,e.requestDataProvider)(),a=c.endpoint,u=c.context,s=c.microserviceFlights,f={url:a,method:"GET",headers:i(i({Accept:"application/json;odata=verbose","SPHome-ClientType":t,"SPHome-ApiContext":JSON.stringify(u)},r?{Authorization:"Bearer "+r}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")})};return n?n(a,f).then(function(e){return e.json()}).then(function(e){return{responseText:JSON.stringify(e)}}):Object(o.a)(f)},function(e){return Object(c.a)(n,{monitorName:e,cacheId:e,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(){return{}}})}),u=a("sphome-rawsprefetch"),s=a("sphome-rawnews")},Pn45:function(e,t,r){"use strict";r.r(t),r.d(t,"cacheKeyExtractor",function(){return i});var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e){return{scope:e&&e.map(function(e){return e&&e.siteId&&e.siteId.toLowerCase()}).join(",")||""}}t.default=Object(o.a)(function(e){var t=e.clientId,r=e.token,o=e.requestDataProvider,i=e.sites,a=o(),u=a.endpoint,s=a.microserviceFlights,f={url:u,method:"POST",headers:c(c({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":t},r?{Authorization:"Bearer "+r}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")}),body:JSON.stringify(i.slice(0,30).map(function(e){return{IndexId:e.id,SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"}}))};return Object(n.a)(f)},{monitorName:"site-activities-rawsprefetch",cacheId:"site-activities-rawsprefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return i(e.sites.slice(0,30))}})},PsWj:function(e,t,r){"use strict";var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i="warmupMsb";t.a=Object(o.a)(function(e){var t=e.msbUrl,r=e.clientType,o=t+"/work/api/v3/user/init",c={Authentication:e.token,clientContext:{clientType:r}};return Object(n.a)({url:o,method:"POST",body:JSON.stringify(c)})},{monitorName:i,cacheId:i,cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]);return c({},t)}})},Qcms:function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"c",function(){return f}),r.d(t,"d",function(){return l}),r.d(t,"a",function(){return h});var n=r("Tju1"),o=r("7jI3"),c=r("0to0"),i=r("U7zf"),a=r("M8TR"),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=function(e){var t=e.complianceEnvironment,r=e.clientWorkload,o=e.userId,c=e.tenantId,i=e.ring;return"https://"+function(e){switch(e){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"AG08":return"config.ecs.teams.eaglex.ic.gov";case"AG09":return"config.ecs.teams.microsoft.scloud";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return"ecs.office.com";default:return Object(n.b)(e,"ecs.office.com")}}(t)+"/config/v1/LokiService/1.0.0.0?agents=MicrosoftSearch&ecsserviceinformation=true&ClientWorkload="+r+"&id="+o+"&TenantID="+c+"&ring="+i};function f(e){var t={};if(e){var r=JSON.parse(e);if(r.ecsConfigIds&&r.ecsEtag){t.ecsConfigIds=Object(a.a)(r.ecsConfigIds)||"",t.ecsEtag=r.ecsEtag.replace(/"/g,"");var n={},o="searchux.".length;r.ecsSettings&&Object.keys(r.ecsSettings).filter(function(e){return"boolean"==typeof r.ecsSettings[e]&&"searchux."===e.substr(0,o)}).forEach(function(e){return n[e.substr(o)]=r.ecsSettings[e]}),t.ecsSettings=JSON.stringify(n)}}return t}function l(e){var t,r;if(!e)return"";try{var n=JSON.parse(e),o=function(e){if(!e["searchux.useNewEcsSchema"])return e;var t=d(e,"searchBoxPluginConfiguration.",function(e){return{id:"searchux.searchBoxPlugin."+e.split(".")[1]}}),r=function(e){return d(e,"suggestionProviderGroups.",function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:p(t)}})}(e);return u(u(u({},e),{searchBoxPluginConfiguration:{plugins:t}}),{searchBoxSuggestionProviderConfiguration:{groups:r,streamPolicy:e["searchux.suggestionGroupStreamPolicy"]}})}(h("ecsSbOverrides","wipeSbEcsConfig",null==n?void 0:n.MicrosoftSearch)),c=null===(t=null==n?void 0:n.Headers)||void 0===t?void 0:t.ETag,a=[null===(r=null==n?void 0:n.ConfigIDs)||void 0===r?void 0:r.MicrosoftSearch];return JSON.stringify({ecsSettings:o,ecsConfigIds:a,ecsEtag:c})}catch(e){Object(i.throwSafeToLogError)("Failed to parse ECS config")}}function d(e,t,r){return Object.keys(e).filter(function(r){return r.indexOf(t)>-1&&e[r]}).sort(function(t,r){return m(e[t])-m(e[r])}).map(function(t){try{return r(t,e[t])}catch(e){Object(o.getDispatcher)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}}).filter(function(e){return e})}function p(e){return d(e,"providers.",function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]})}function h(e,t,r){var n=Object(c.getQueryStringValue)(t);n&&"true"===n.toLowerCase()&&(r={});var o=decodeURIComponent(Object(c.getQueryStringValue)(e));return o?function e(t,r){if(!v(t))return t;var n=u({},t);return v(r)&&Object.keys(r).forEach(function(o){v(r[o])?n[o]=o in t?e(t[o],r[o]):r[o]:n[o]=r[o]}),n}(r,JSON.parse(o)):r}function m(e){return void 0===e.position||null===e.position?Number.MAX_VALUE:e.position}function v(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}},RARn:function(e,t,r){"use strict";r.d(t,"b",function(){return a});var n,o=r("RZul"),c=r("oetw"),i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e){var t=e.siteRoot,r=e.tokenProvider;return u({siteRoot:t,tokenProvider:r}).then(function(e){if(e.cacheItemResolved&&n)return n;var t=JSON.parse(e.xhr.responseText),r=t&&t.d&&t.d.searchcenterurl||"";return n=r,r})}var u=Object(c.a)(function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then(function(e){return Object(o.a)({url:t+"/_api/search/searchcenterurl",method:"GET",headers:i({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer "+e}:{}),timeoutMs:5e3})})},{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}});t.a=function(e){return a({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then(function(e){return(r=(t=e).lastIndexOf("/search/"))<0?"":t.substring(0,r+"/search/".length).replace(/\/$/,"");var t,r})}},RZul:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r("tMv9"),o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e){return new Promise(function(t,r){var c=new XMLHttpRequest;c.requestLogData=o({},e.requestLogData),c.open(e.method,e.url,!0),e.timeoutMs&&(c.timeout=e.timeoutMs),e.withCredentials&&(c.withCredentials=e.withCredentials);var i=e.headers||{};Object.keys(i).map(function(e){c.setRequestHeader(e,i[e])}),c.onload=function(){4===c.readyState&&(Object(n.default)(c.status)?t(c):r(c))},c.onerror=function(){r(c)},c.ontimeout=function(){r(c)};var a=e.body||null;c.send(a)})}},RwpM:function(e,t,r){"use strict";r.r(t);var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.default=Object(o.a)(function(e){var t=e.endpoint,r=e.clientId,o=e.token;return Object(n.a)({url:t+"?querytext='*'&ClientType='"+r+"'&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:c({Accept:"application/json;odata=verbose"},o?{Authorization:"Bearer "+o}:{}),timeoutMs:7e3})},{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}})},Tju1:function(e,t,r){"use strict";function n(e){return e}function o(e,t){return t}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return o})},U7zf:function(e,t,r){"use strict";function n(e,t,r){var n;return t&&t.safeToLog?(n=new Error(e+" "+t.message)).innerError=t:n=new Error(e),n.safeToLog=!0,n.logProperties=r,Object.freeze(n),n}function o(e,t,r){throw n(e,t,r)}r.r(t),r.d(t,"default",function(){return n}),r.d(t,"throwSafeToLogError",function(){return o})},ULPt:function(e,t,r){"use strict";r.r(t);var n=r("RZul"),o=r("Fits"),c=r("IY21");t.default=function(e){var t=e.endpoint,r=e.forceDigestRefresh;return Object(c.a)({monitorName:"prefetchSharepointDigest"},Object(o.a)(function(e){var t=e.endpoint;return Object(n.a)({url:t+"/_api/contextinfo",method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint+"/_api/contextinfo"}},forceRefresh:r}))({endpoint:t,forceDigestRefresh:r})}},"W/YS":function(e,t,r){"use strict";var n=r("RZul"),o=r("oetw"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=["AllVerticalContent","FilesVerticalContent"];t.a=Object(o.a)(function(e){var t=e.endpoint,r=e.token;return Object(n.a)({url:t+"/_api/web/AllProperties?$select="+i.join(","),method:"GET",headers:c({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}})},X0AG:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r("0to0"),o=r("Qcms"),c=r("1tuv"),i=r("+shF"),a=r("Gmr8");function u(e){var t,r;Object(n.getQueryStringValue)("sid")&&(e.siteId=Object(n.getQueryStringValue)("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var u=null===(r=null===(t=e.additionalHeaders)||void 0===t?void 0:t[a.a.SearchComponent])||void 0===r?void 0:r.toLowerCase();return"serp"===u&&Object(c.createSearchConfigPromiseEntity)(e),Object(i.a)(e).then(function(e){var t=e.xhr,r=JSON.parse(t.responseText),n=null==r?void 0:r.ecsSettings;r.ecsSettings=Object(o.a)("ecsOverrides","wipeEcsConfig",n);var i=Object(c.getSearchConfigPromiseEntity)();return"serp"===u&&(r.verticalConfig?(null==i?void 0:i.promiseResolver)&&i.promiseResolver(r.verticalConfig):(null==i?void 0:i.promiseRejector)&&i.promiseRejector()),r}).catch(function(){var e,t=null===(e=Object(c.getSearchConfigPromiseEntity)())||void 0===e?void 0:e.promiseRejector;t&&t()})}},"ajb/":function(e,t,r){"use strict";r.r(t);var n=r("oetw"),o=r("88VM"),c=r("tMv9"),i=r("x4qv"),a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.default=Object(n.a)(function(e){var t=e.token,r=e.queryStringParameters,n=e.headers,u=e.postAction,s=void 0===u?"init":u,f=e.cvid,l=e.makeSubstrateRequest,d=e.substrateUrl,p=r?a({},r):{},h={action:s,token:t,prefix:void 0,cvid:f||Object(o.default)(),additionalInfo:a(a({},p),{diagnostics:"1"}),headers:n};return(l?l(h):Object(i.sendSubstrateRequest)(h,d)).then(function(e){if(!Object(c.default)(e.statusCode))throw{status:e.statusCode};var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var r=Object(i.parseDiagnostics)(e.diagnostics);r&&r.duration&&(t["Substrate-DiagnosticsDuration"]=""+r.duration)}catch(e){}return{status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}}})},{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:function(e){return e.getResponseHeader?{properties:JSON.stringify({requestId:e.getResponseHeader("request-id")||"",serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader("Substrate-DiagnosticsDuration")||""})}:{}},cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token","makeSubstrateRequest","cvid"]);return a({},t)}})},b6au:function(e,t,r){"use strict";r.d(t,"f",function(){return d}),r.d(t,"e",function(){return p}),r.d(t,"a",function(){return h}),r.d(t,"b",function(){return m}),r.d(t,"d",function(){return v}),r.d(t,"c",function(){return b});var n,o=r("Tju1");function c(e){switch(e){case"Df":return n.Dogfood;case"Msit":return n.MSIT;case"Blackforest":return n.Blackforest;case"GccModerate":return n.GccModerate;case"GccHigh":return n.GccHigh;case"DoD":return n.DOD;case"Gallatin":return n.Gallatin;case"Prod":return n.TopLevel;case"AG08":return n.AG08;case"AG09":return n.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(o.a)(e)}}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(n||(n={}));var i=r("0to0"),a=r("Gmr8"),u=r("wuCr"),s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(e){return"string"==typeof e?e.replace(/\/+$/,""):e}var l=function(e){return f(e)+"/api/v1/search/configuration"};function d(e,t,r){return void 0===t&&(t=""),function(e,t){var r=c(e);return r===e&&(r=c("Prod")),t(r)}(e,r)+(t?"/"+t:"")}function p(e,t){return void 0===t&&(t=""),d(e,t,l)}function h(e,t,r){var n;return s(s(s({},t),((n={"X-MSSearchVersion":u.a,"X-ClientFeature":"Search"})["X-ClientType"]=e,n)),r?{Authorization:"Bearer "+r}:{})}function m(e){return(f(e)||"")+"/api/v1/search/configuration/verticals"}function v(e,t){void 0===t&&(t=!1);var r={};return e&&(r.siteCollectionId=e.toUpperCase()),t&&(r.verticalState="all"),Object(i.getQueryStringValue)("ecsOverrides")&&(r.ecsOverrides=Object(i.getQueryStringValue)("ecsOverrides")),r}function b(){var e;return"true"===Object(i.getQueryStringValue)("cacheClear")?((e={})[a.a.VerticalsCacheClear]="uncached",e):{}}},brPI:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveLokiEnvironment",function(){return o});var n=r("Tju1");function o(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return Object(n.b)(e,"Prod")}}},oetw:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r("Fits"),o=r("IY21"),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e){return!!e&&(401===e.status||0===e.status)}function a(e,t,r,n){if(!r.token&&!r.tokenProvider)return Promise.reject(new Error("Token or token provider must be specified."));var o=-1;return r.token?n(c(c({},r),{token:r.token})).then(function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}}):r.tokenProvider({attempt:e}).then(function(e){return o=performance.now()-t,n(c(c({},r),{token:e}))}).then(function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:o,xhr:t}})}function u(e,t){return Object(o.a)(t,Object(n.a)((r=e,function(e){var t=performance.now();return a(0,t,e,r).catch(function(n){return i(n)?a(1,t,e,r).catch(function(e){return function(e,t,r){if(i(e)){var n=e;throw n.tokenAttemptCount=2,n.tokenFetchDuration=r,n}throw e}(e,0,performance.now()-t)}):Promise.reject(n)})}))(t));var r}},sPtD:function(e,t,r){"use strict";function n(e){var t=null;return function(r){return t?t(r):e.then(function(e){return t=e,e(r)})}}r.r(t),r.d(t,"createAsyncTokenProvider",function(){return n}),r.d(t,"fetch",function(){return o.a}),r.d(t,"fetchAcquireToken",function(){return c.default}),r.d(t,"fetchAndParseSearchConfiguration",function(){return i.a}),r.d(t,"fetchCustomVerticals",function(){return a.a}),r.d(t,"fetcher",function(){return u.a}),r.d(t,"fetchBingConsumer",function(){return l}),r.d(t,"fetchFileShareConnectorSettings",function(){return d.a}),r.d(t,"fetchHubSites",function(){return p.default}),r.d(t,"fetchPersonalData",function(){return h.default}),r.d(t,"fetchPersonalRankingContext",function(){return m.default}),r.d(t,"fetchSearchCenterUrl",function(){return v.a}),r.d(t,"fetchRawSearchCenterUrl",function(){return v.b}),r.d(t,"fetchSearchConfiguration",function(){return b.a}),r.d(t,"fetchParsedCustomVerticals",function(){return g.default}),r.d(t,"fetchSearchConfigurationFromEcs",function(){return y}),r.d(t,"fetchConfigFromEcsWithCacheAndMonitor",function(){return S}),r.d(t,"fetchSpHomeNews",function(){return w.fetchSpHomeNews}),r.d(t,"fetchSpHomePrefetch",function(){return w.fetchSpHomePrefetch}),r.d(t,"fetchSiteNewsSuggestions",function(){return T}),r.d(t,"fetchSiteActivities",function(){return R.default}),r.d(t,"siteActivitiesCacheKeyExtractor",function(){return R.cacheKeyExtractor}),r.d(t,"fetchSharePointDigest",function(){return E.default}),r.d(t,"fetchSharePointDigestV2",function(){return A}),r.d(t,"fetchSitesFromSubstrate",function(){return V}),r.d(t,"generateGuid",function(){return M.default}),r.d(t,"cache",function(){return H.cache}),r.d(t,"init",function(){return H.init}),r.d(t,"puid",function(){return H.puid}),r.d(t,"statusOk",function(){return L.default}),r.d(t,"substrateIframeProxy",function(){return F.substrateIframeProxy}),r.d(t,"toTokenDetail",function(){return G.toTokenDetail}),r.d(t,"warmupMsb",function(){return U.a}),r.d(t,"resolveLokiEnvironment",function(){return q.resolveLokiEnvironment}),r.d(t,"resolveSubstrateUrl",function(){return _.resolveSubstrateUrl}),r.d(t,"warmupSubstrateSearch",function(){return B.default}),r.d(t,"withBasicMonitor",function(){return j.a}),r.d(t,"withMonitor",function(){return f.a}),r.d(t,"withImportMonitor",function(){return J.default}),r.d(t,"withPeriodicRefresh",function(){return W}),r.d(t,"withRefresh",function(){return z});var o=r("RZul"),c=r("9iPW"),i=r("X0AG"),a=r("x5/w"),u=r("oetw"),s=r("Fits"),f=r("IY21"),l=function(e){return Object(f.a)({monitorName:"bing-consumer-prefetch"},Object(s.a)(function(e){var t=e.url;return Object(o.a)({url:t,method:"GET",withCredentials:!0}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)},d=r("W/YS"),p=r("6kg4"),h=r("7C7s"),m=r("RwpM"),v=r("RARn"),b=r("+shF"),g=r("1tuv"),O=r("Qcms"),y=function(e){if(!e)throw new Error("missing options for ECS call");return Object(o.a)({url:Object(O.b)(e),method:"GET"})},j=r("wpY6"),S=Object(j.a)({monitorName:"searchConfigurationFromEcs",monitorType:"prefetch_request",successPropExtractor:function(e){return Object(O.c)(Object(O.d)(null==e?void 0:e.xhr.responseText))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},Object(s.a)(function(e){return y(e).then(function(e){return{xhr:e}})})({cacheId:"searchConfigurationFromEcs",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,[])}})),w=r("PM3F"),I=function(){return(I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function P(e,t,r){return r.sitePath+"/_api/search/query?QueryText='*'"+function(e){var t=e.departmentId;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2 AND "+(e.isHubSite&&t?C:x)(e)+"'"}(r)+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100&Properties='ClientFunction:News,EnableMultiGeoSearch:"+(e?"true":"false")+"'&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'&ClientType='"+t+"'&EnableQueryRules=false"}function x(e){return'Path:"'+e.sitePath+'"'}function C(e){var t=e.departmentId;return"(DepartmentId:"+t+" OR DepartmentId:"+t.replace(/[{}]/g,"")+")"}var T=Object(u.a)(function(e){var t=e.clientId,r=e.site,n=e.token;return Object(o.a)({url:P(!0,t,r),method:"GET",headers:I({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{})})},{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),R=r("Pn45"),E=r("ULPt"),k=function(){return(k=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},D=!1,A=Object(u.a)(function(e){var t=e.endpoint,r=e.token,n=e.overrideDigest;return n&&!D?(D=!0,new Promise(function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:n}}})})})):Object(o.a)({url:t+"/_api/contextinfo",method:"POST",headers:k({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"fetchSharepointDigest",cacheId:"fetchSharepointDigest",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),M=r("88VM"),L=r("tMv9"),F=r("x4qv"),N=function(){return(N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},V=Object(u.a)(function(e){var t=e.token,r=e.prefix,n=e.substrateUrl;return Object(F.substrateIframeProxy)(n).then(function(e){return e({action:"queryv2",token:t,prefix:r,cvid:Object(M.default)()}).then(function(e){if(!Object(L.default)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}})})},{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]);return N({},t)}}),H=r("g4n3"),G=r("4gcB"),U=r("PsWj"),q=r("brPI"),_=r("G8Vc"),B=r("ajb/"),J=r("4f8Z"),Q=r("7jI3"),K=function(){return(K=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function z(e,t){var r,n=null,o=!1,c=function(){return o||(o=!0,r=t({attempt:1}).then(function(e){return n=Object(G.toTokenDetail)(e),o=!1,e}).catch(function(e){throw o=!1,e})),r};return function(r,o,i){void 0===i&&(i=!0);var a,u,s,f=i?(a=e+"_withRefresh",u=performance.now(),(s=Object(Q.getDispatcher)()).dispatch({name:"generic_qos",nameDetail:a,timestamp:u,eventType:"QOSSTART"}),function(e,t,r){var n=performance.now();s.dispatch({name:"generic_qos",nameDetail:a,startTimestamp:u,totalTime:n-u,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:r})}):function(){};if(!t)return f("FAILURE",K({cacheItemResolved:!1,tokenProviderNull:!0},o)),Promise.reject("token provider is null");if(!n||!Object(G.isValid)(n)||r.attempt>0)return c().then(function(e){return f("SUCCESS",K({cacheItemResolved:!1,expires:n&&new Date(n.expEpoch),didRefresh:!0},o)),e}).catch(function(e){throw f("FAILURE",K({cacheItemResolved:!1,tokenProviderNull:!1},o)),e.reason||e});var l=Object(G.isApproachingExpiration)(n);return l&&c(),f("SUCCESS",K({cacheItemResolved:!0,expires:n&&new Date(n.expEpoch),backgroundRefresh:l},o)),Promise.resolve(n.token)}}function W(e,t,r){var n,o,c=0,i=z(e,t);return function(e){return c++,o||(o=window.setInterval(function(){c++,i({attempt:0},{invokedByPeriodicRefresh:!0,invocationCounter:c},!1),Date.now()-n>864e5&&(window.clearInterval(o),o=void 0)},r||3e5)),n=Date.now(),i(e,{invokedByPeriodicRefresh:!1,invocationCounter:c},!0)}}},tMv9:function(e,t,r){"use strict";function n(e){return e>=200&&e<=300||0===e}r.r(t),r.d(t,"default",function(){return n})},w483:function(e,t,r){"use strict";r.r(t),r.d(t,"spRequestDurationHeader",function(){return n}),r.d(t,"spClientServiceRequestDurationHeader",function(){return o}),r.d(t,"sharePointCorrelationHeader",function(){return c}),r.d(t,"getNamedHeadersFromXhr",function(){return i}),r.d(t,"getRequestDurationFromXhr",function(){return a}),r.d(t,"getRequestDurationFromHeaders",function(){return u});var n="sprequestduration",o="spclientservicerequestduration",c="sprequestguid";function i(e,t){var r={};if(e.getAllResponseHeaders){var n=e.getAllResponseHeaders();t.forEach(function(t){e.getResponseHeader&&-1!==n.indexOf(t)&&(r[t]=e.getResponseHeader(t)||"")})}return r}function a(e){var t=i(e,[n,o]);return t[n]||t[o]||void 0}function u(e){return e[n]||e[o]||""}},wpY6:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r("7jI3");function o(e,t){var r=e.monitorType,o=e.monitorName,i=e.monitorOnce,a=e.successPropExtractor,u=e.failurePropExtractor,s=!1;return function(e){if(i&&s)return t(e);s=!0;var f,l=Math.round(performance.now()),d=Object(n.getDispatcher)();function p(e,t){d.dispatch({eventType:"QOSSTOP",name:r,result:e,nameDetail:o,startTimestamp:l,totalTime:Math.round(performance.now())-l,properties:t})}d.dispatch({eventType:"QOSSTART",name:r,nameDetail:o,timestamp:l});try{f=t(e)}catch(e){return p("FAILURE",{promiseFactoryFailed:!0}),Promise.reject(e)}return f.then(function(e){return p("SUCCESS",c(e,a,{successExtractorFailed:!0})),e},function(e){return p("FAILURE",c(e,u,{failureExtractorFailed:!0})),Promise.reject(e)})}}var c=function(e,t,r){try{return(t||i)(e)}catch(e){return r}},i=function(){return{}}},x4qv:function(e,t,r){"use strict";r.r(t),r.d(t,"substrateIframeProxy",function(){return p}),r.d(t,"getIframeProxy",function(){return m}),r.d(t,"sendSubstrateRequest",function(){return b}),r.d(t,"parseDiagnostics",function(){return O}),r.d(t,"parser",function(){return y});var n=r("U7zf"),o=r("88VM"),c=function(e,t,r,o){return new Promise(function(c,u){return i(function i(s){if(s.source===e&&s.origin===t){var f=void 0,l=!1;try{f=r(s)}catch(e){return a(i),void u(Object(n.default)("Iframe message parser failure.",e))}try{l=o(f,s)}catch(e){return a(i),void u(Object(n.default)("Iframe message predicate failure.",e))}l&&(a(i),c(f))}})})},i=function(e){return addEventListener("message",e,!1)},a=function(e){return removeEventListener("message",e,!1)},u=r("G8jq"),s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},f={},l={},d={};function p(e){return void 0===e&&(e="https://substrate.office.com"),e=Object(u.a)(e),void 0===l[e]&&(l[e]=h(e).ready),l[e].then(function(){return d[e]=!0,function(t){return g(t,e)}})}function h(e){return f[e]?f[e]:m((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function m(e,t,r){if(e){var n=document.getElementById("ms-searchux-3s-proxy"),o=function(e,t){return e&&e.src===t&&e.ready&&e.postMessage?{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}}:null}(n,t);f[r]=o||v(!n,t,r)}else f[r]=v(!1,t,r);return f[r]}function v(e,t,r){var n=function(e,t){var r=document.createElement("iframe");return{iframe:r,initialize:function(){return document.body.contains(r)||(r.src=e,r.style.display="none",document.body.appendChild(r)),r},postMessage:function(n,o,i){var a=function(e,n){return c(r.contentWindow,t,e,n)}(o,i);return r.contentWindow&&r.contentWindow.postMessage(n,e),a}}}(t,r),o=n.initialize(),i=c(o.contentWindow,r,function(e){return e.data},function(e){return"loaded"===e});return e&&(o.id="ms-searchux-3s-proxy",o.postMessage=n.postMessage,o.ready=i),s(s({},n),{ready:i})}var b=function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=Object(u.a)(t),d[t]?g(e,t):p(t).then(function(t){return t(e)})};function g(e,t){var r=Object(o.default)(),n=e.action,c=e.token,i=e.prefix,a=e.cvid,u=e.additionalInfo,s=e.headers;return h(t).postMessage(JSON.stringify({requestId:r,action:n,token:c,prefix:i,cvid:a,additionalInfo:u,headers:s}),y,function(e){return e.requestId===r})}function O(e){var t=JSON.parse(e)[0];return t.name,function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(t,["name"])}function y(e){try{return JSON.parse(e.data)}catch(e){return Object(n.throwSafeToLogError)("Failed to parse substrate API JSON response.")}}},"x5/w":function(e,t,r){"use strict";var n=r("0to0"),o=r("RZul"),c=r("oetw"),i=r("b6au");t.a=Object(c.a)(function(e){var t=e.lokiUrl,r=e.token,c=e.clientType,a=e.scope,u=e.previewDisabledVerticals,s=Object(i.a)(c,Object(i.c)(),r),f=a&&a.siteId?a.siteId:"";return Object(o.a)({url:Object(n.constructUrl)(Object(i.b)(t),Object(i.d)(f,u)),method:"GET",headers:s})},{monitorName:"customVerticals",cacheId:"customVerticals",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.lokiUrl,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(){return{cacheClear:Object(n.getQueryStringValue)("cacheClear")}},forceRefresh:function(){return"true"===Object(n.getQueryStringValue)("cacheClear")}})}}]);