var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(window.suiteux_shell_webpackJsonp_main=window.suiteux_shell_webpackJsonp_main||[]).push([["plus"],[,,,function(e,t,n){"use strict";n.d(t,"D",(function(){return r.a})),n.d(t,"N",(function(){return i.a})),n.d(t,"r",(function(){return o})),n.d(t,"y",(function(){return a})),n.d(t,"P",(function(){return s.g})),n.d(t,"u",(function(){return s.a})),n.d(t,"k",(function(){return u.g})),n.d(t,"a",(function(){return u.a})),n.d(t,"G",(function(){return c})),n.d(t,"s",(function(){return l})),n.d(t,"h",(function(){return u.d})),n.d(t,"l",(function(){return u.h})),n.d(t,"i",(function(){return u.e})),n.d(t,"m",(function(){return u.i})),n.d(t,"Q",(function(){return s.h})),n.d(t,"J",(function(){return s.b})),n.d(t,"L",(function(){return s.c})),n.d(t,"g",(function(){return d.a})),n.d(t,"b",(function(){return p.a})),n.d(t,"c",(function(){return f.a})),n.d(t,"j",(function(){return b})),n.d(t,"e",(function(){return T.a})),n.d(t,"n",(function(){return O})),n.d(t,"f",(function(){return I.a})),n.d(t,"t",(function(){return w.a})),n.d(t,"p",(function(){return A.a})),n.d(t,"I",(function(){return A.b})),n.d(t,"K",(function(){return A.c})),n.d(t,"M",(function(){return A.d})),n.d(t,"B",(function(){return D})),n.d(t,"F",(function(){return x})),n.d(t,"O",(function(){return P})),n.d(t,"C",(function(){return E.b})),n.d(t,"E",(function(){return E.c})),n.d(t,"A",(function(){return k.a})),n.d(t,"H",(function(){return R.a})),n.d(t,"z",(function(){return L.a})),n.d(t,"x",(function(){return N})),n.d(t,"q",(function(){return M.a})),n.d(t,"v",(function(){return M.b})),n.d(t,"o",(function(){return U})),n.d(t,"w",(function(){return F})),n.d(t,"d",(function(){return j.a}));var r=n(28),i=n(56),o=(n(126),{timestamp:null,appsUpdateTimeSpan:null,appDataCache:null,moreAppDataAvailable:null,doNotCallGetAllAppsUntil:null}),a=(n(122),n(120),{activeButtonId:"",customFlexPanes:{},customFlexPaneHash:void 0,customHeaderButtonFlexPaneTriggers:{},customHeaderButtons:[],badgeValues:{}}),s=n(37),u=n(19),c={notificationsEnabled:!1,toastsMuted:!1,bellHeaderButtonInLayout:!0,isSubscriptionReady:!1,systemNotificationsDisabled:!0,notifications:[]},l={isChatAPIInitialized:null,isChatRecentsPaneInitialized:!1,unreadBadgeValue:0,chatEnabled:!1,chatWebLink:null,webChatSDKUrl:null,isTeamsChatActivated:!1},d=(n(103),n(121)),p=n(89),f=n(76),h=n(0),g=n(2),m=n(7),v=n(148),y=n(16),S=n(116),b=function(e){function t(t){var n=e.call(this,t)||this;return n.setRef=function(e){return n.searchControl=e},n.SearchBarKey=function(e){var t=e.currentTarget.value;n.setState((function(){return{currentSearchText:t,showDismissButton:!0}})),n.props.onSearch(t)},n.DismissDefaultText=function(){n.state.clearTextOnFocus?n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})):n.setState((function(){return{showDismissButton:!0,clearTextOnFocus:!0}}))},n.DefaultSearchText=function(){""===n.state.currentSearchText?n.setState((function(){return{currentSearchText:n.props.defaultText,showDismissButton:!1}})):n.setState((function(){return{clearTextOnFocus:!1}}))},n.ButtonClearText=function(){n.searchControl.focus(),n.searchControl.placeholder="",n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})),n.props.onSearch("")},n.moveCursor=function(){n.searchControl.focus()},n.props.currentSearchText?n.state={currentSearchText:n.props.currentSearchText,showDismissButton:!0,clearTextOnFocus:!1}:n.state={currentSearchText:n.props.defaultText,showDismissButton:!1,clearTextOnFocus:!0},n}return Object(h.__extends)(t,e),t.prototype.render=function(){var e=Object(y.a)(),t=Object(S.a)();return g.createElement("div",{className:Object(w.a)(v.SearchControl,t?v.SearchControlZoomMargin:null,e.neutral.foregroundAlt.background)},this.state.showDismissButton?g.createElement("button",{onClick:this.ButtonClearText,"aria-label":m.a.SearchBoxClearButtonText,title:m.a.SearchBoxClearButtonText},g.createElement(T.a,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--ChromeClose",fontSize:"12"})):g.createElement("button",{onClick:this.moveCursor,tabIndex:-1,"aria-hidden":!0},g.createElement(T.a,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--Search",fontSize:"12"})),g.createElement("input",{className:Object(w.a)(v.inputBox,e.neutral.dark.font),type:"text",onFocus:this.DismissDefaultText,value:this.state.currentSearchText,onChange:this.SearchBarKey,onBlur:this.DefaultSearchText,ref:this.setRef,placeholder:this.props.defaultText,id:"appLauncherSearch",autoComplete:"off","aria-label":this.props.defaultText}))},t}(g.Component),T=n(44),C=(n(78),n(159)),_=n(1),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.__extends)(t,e),t.prototype.render=function(){var e,t=Object(y.a)();if(null!=this.props.unseenItemCount&&0!==this.props.unseenItemCount){var n=Object(w.a)(C.unseenCount,t.accent.border,((e={})[t.badge]=!this.props.isParentHovered,e)),r={};return this.props.isParentHovered&&(r.boxSizing="border-box",r={backgroundColor:Object(_.i)().getThemeData().AccentHover||"white",border:"1px solid",color:"#106EBE"}),g.createElement("div",{className:Object(w.a)(C.unseenitems,this.props.badgeStyles)},g.createElement("span",{style:r,className:n},this.props.unseenItemCount>0&&this.props.unseenItemCount,this.props.children))}return null},t}(g.Component),I=(n(81),n(128)),w=n(10),A=n(31),D=n(188),x=n(127);function P(e,t,n){return void 0===n&&(n=","),e=e?e.toLowerCase().trim():"",(t?t.toLowerCase().split(n):[]).some((function(t){return t.trim()===e}))}var E=n(6),k=n(104),R=n(125),L=n(46),N=n(17),M=n(90),U=(n(67),n(77)),F=n(129),j=(n(83),n(41));n(123)},function(e,t,n){"use strict";n.d(t,"k",(function(){return v})),n.d(t,"d",(function(){return i.a})),n.d(t,"f",(function(){return o.a})),n.d(t,"i",(function(){return a.a})),n.d(t,"a",(function(){return s.a})),n.d(t,"j",(function(){return l})),n.d(t,"b",(function(){return d.a})),n.d(t,"g",(function(){return p.a})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return f})),n.d(t,"c",(function(){return h.a}));var r=n(65),i=n(72),o=n(132),a=n(12),s=n(22),u=(n(93),n(5)),c=n(20),l=function(){function e(){}return e.checkScope=function(t,n){if(null!=t&&!Object(u.startsWith)(t,n+e.DictionaryStringPartsSeparator))throw new s.a(c.a,-2010)},e.SuiteScope="O365S",e.DictionaryStringPartsSeparator="//",e}(),d=n(99),p=n(39),f=(n(130),n(98),n(45)),h=n(23),g=null;try{window.MSA&&window.MSA.MeControl&&(g=window.MSA.MeControl.UserStateModel)}catch(e){}var m=g;(function(){function e(){}e.createUserStateModel=function(e){return null!=window.MSA?new m(e):null}})(),function(){function e(){}e.MSA="msa",e.AAD="aad",e.MSAFed="msaFed"}();function v(){"complete"===document.readyState?r.a.internalProcessWindowLoad():window.onload=r.a.internalProcessWindowLoad}},function(e,t,n){"use strict";n.r(t),n.d(t,"StringTypeString",(function(){return l})),n.d(t,"BooleanTypeString",(function(){return d})),n.d(t,"FunctionTypeString",(function(){return p})),n.d(t,"NumberTypeString",(function(){return f})),n.d(t,"OwaIFrameID",(function(){return h})),n.d(t,"TokenFactoryIFrameID",(function(){return g})),n.d(t,"SuiteServiceApiRelativePath",(function(){return m})),n.d(t,"OwsRelativePath",(function(){return v})),n.d(t,"DevFabricOwsRelativePath",(function(){return y})),n.d(t,"PostMessageIdPrefix",(function(){return S})),n.d(t,"validateField",(function(){return T})),n.d(t,"isFullUrl",(function(){return C})),n.d(t,"validateFullUrl",(function(){return _})),n.d(t,"getCurrentWindowLocation",(function(){return O})),n.d(t,"createInvalidParameterException",(function(){return I})),n.d(t,"isNullOrEmptyString",(function(){return w})),n.d(t,"buildUrl",(function(){return A})),n.d(t,"getUrlDomainPart",(function(){return D})),n.d(t,"getUrlPath",(function(){return x})),n.d(t,"getUrlAuthorityPart",(function(){return P})),n.d(t,"buildIframeResourceData",(function(){return E})),n.d(t,"getXMLHttpRequest",(function(){return k})),n.d(t,"validateRequestInfo",(function(){return R})),n.d(t,"convertArrayBufferToBinaryString",(function(){return L})),n.d(t,"convertBinaryStringToXmlHttpRequestBody",(function(){return N})),n.d(t,"parseQueryString",(function(){return M})),n.d(t,"parseResponseHeaders",(function(){return U})),n.d(t,"startsWith",(function(){return j})),n.d(t,"endsWith",(function(){return B})),n.d(t,"checkBrowserBinaryDataSupport",(function(){return W})),n.d(t,"ensureAttachMessageListener",(function(){return q})),n.d(t,"reportSimpleError",(function(){return H})),n.d(t,"encodeUrlForXmlHttpRequest",(function(){return G})),n.d(t,"urlEncodeCore",(function(){return K})),n.d(t,"getFrameElement",(function(){return V})),n.d(t,"getFrameID",(function(){return Z})),n.d(t,"getXMLHttpResponseLength",(function(){return Q}));var r=n(6),i=n(1),o=n(48),a=n(65),s=n(22),u=n(20),c=n(57),l="string",d="boolean",p="function",f="number",h="o365shellowaframe",g="o365shellwcssframe",m="O365SuiteService/api/",v="owa/service.svc",y="SuiteService.svc",S="SP.RequestExecutor",b="https://";function T(e,t,n,i){if(i){if(null==e||typeof e!==n)throw new s.b(Object(r.b)(u.f,t),-2001)}else if(null!=e&&typeof e!==n)throw new s.b(Object(r.b)(u.f,t),-2001)}function C(e){return e.substr(0,b.length).toLowerCase()===b}function _(e,t){if(!C(e))throw I(t)}function O(){return window.location.href}function I(e){return new s.b(Object(r.b)(u.f,e),-2001)}function w(e){return""===e||null==e}function A(e,t){if(_(e,"baseUrl"),C(t))return t;if("/"===t.charAt(0)){var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function D(e,t){void 0===t&&(t=!1),t&&_(e,"url");var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e.substr(0,b.length).toLowerCase()===b&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function x(e){var t=D(e),n=e.indexOf("?");return n>t.length+1?e.substring(t.length+1,n):e.substring(t.length+1,e.length)}function P(e){return(e=D(e)).substr(0,b.length).toLowerCase()===b&&(e=e.substr(b.length)),e.toLowerCase()}function E(e,t){var n=Object(o.e)(t.ShellResources.tokenfactoryiframe),r=Object(o.e)(t.ShellResources.crossdomainproxyiframe),i=Object(o.e)(t.ShellResources.msaltokenfactoryiframe);return{version:e,tokenfactoryJsHash:n.hash,crossdomainproxyJsHash:r.hash,msaltokenfactoryJsHash:i.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function k(){if(!("XMLHttpRequest"in window))throw new s.b(u.c,-2003);return new XMLHttpRequest}function R(e){if(null==e)throw I("requestInfo");if(T(e.url,"requestInfo.url",l,!0),T(e.body,"requestInfo.body",l,!1),T(e.success,"requestInfo.success",p,!1),T(e.error,"requestInfo.error",p,!1),T(e.timeout,"requestInfo.timeout",f,!1),T(e.method,"requestInfo.method",l,!1),T(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",d,!1),T(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",d,!1),w(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=a.a.DefaultTimeout),e.timeout<0)throw I("requestInfo.timeout");if(w(e.url))throw I("requestInfo.url")}function L(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t}function N(e){var t=null;if(typeof e===l){for(var n=new ArrayBuffer(e.length),r=new Uint8Array(n),i=0;i<e.length;i++)r[i]=255&e.charCodeAt(i);var o=new Blob([n]);t=o||n}return t}function M(e){var t="",n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function U(e){var t={};if(null!=e)for(var n=new RegExp("\r?\n"),r=0,i=e.split(n);r<i.length;r++){var o=i[r];if(null!=o){var a=o.indexOf(":");if(a>0){var s=o.substr(0,a),u=o.substr(a+1);s=F(s),u=F(u),t[s.toUpperCase()]=u}}}return t}function F(e){return e.replace(/^\s+|\s+$/g,"")}function j(e,t){return 0===e.lastIndexOf(t,0)}function B(e,t){return e.lastIndexOf(t)===e.length-t.length}function W(){if(!("ArrayBuffer"in window))throw Object(i.f)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,u.b),new s.b(u.b,-2003);if(!("Uint8Array"in window))throw Object(i.f)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,u.b),new s.b(u.b,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw Object(i.f)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,u.b),new s.b(u.b,-2003)}function q(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new s.b(u.h,-2002)}function H(e,t,n,r){if(null!=e.error){var o={state:e.state,body:""};r&&(n=n+" target: "+r),e.error(o,t,n)}else Object(i.f)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function G(e){return K(e,!0,!0)}var z=128;function K(e,t,n){var r="";if(w(e)||void 0===e||0===e.length)return"";for(var i=0;i<e.length;i++){var o=e.charCodeAt(i),a=e.charAt(i);if(t&&("#"===a||"?"===a)){r+=e.substr(i);break}if(o<=127)n||o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o>=32&&o<=95&&" \"%<>'&".indexOf(a)<0?r+=a:o<=15?r+="%0"+o.toString(16).toUpperCase():o<=127&&(r+="%"+o.toString(16).toUpperCase());else if(o<=2047)r+="%"+(192|o>>6).toString(16).toUpperCase(),r+="%"+(z|63&o).toString(16).toUpperCase();else if(55296!=(64512&o))r+="%"+(224|o>>12).toString(16).toUpperCase(),r+="%"+(z|(4032&o)>>6).toString(16).toUpperCase(),r+="%"+(z|63&o).toString(16).toUpperCase();else if(i<e.length-1){o=(1023&o)<<10,i++,o|=1023&e.charCodeAt(i),r+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase(),r+="%"+(z|(258048&o)>>12).toString(16).toUpperCase(),r+="%"+(z|(4032&o)>>6).toString(16).toUpperCase(),r+="%"+(z|63&o).toString(16).toUpperCase()}}return r}function V(e){return document.getElementById(Z(e))}function Z(e){switch(e){case c.a.OWA:return h;case c.a.TokenFactory:return g;default:return Object(i.f)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function Q(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Theme="theme",e.LanguageAndRegion="languageandregion",e.NavBarDataLinks="navbardatalinks",e.ChangePassword="changepassword",e.ContactPreferences="contactpreferences",e.AboutBase="aboutbase",e.About="about",e.DarkMode="darkmode",e.CPNIPin="cpnipin"}(r||(r={}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}return e.Initialize=function(t){this.instance=new e(t)},Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!0,configurable:!0}),e.assertInitialized=function(){if(null===e.Instance)throw new Error("SessionData not initialized.")},e.isUnitTestMode=!1,e}()},,,,,function(e,t,n){"use strict";function r(e,t){if(null===e)throw new Error("Error: "+t+" is null.")}function i(e,t){if(void 0===e)throw new Error("Error: "+t+" is undefined.")}function o(e,t){r(e,t),i(e,t)}function a(e,t){if(o(e,t),0===e.length)throw new Error("Error: "+t+" is an empty string.")}function s(e,t){if(o(e,t),0===e.length)throw new Error("Error: "+t+" is a null or empty array.")}n.r(t),n.d(t,"throwOnNull",(function(){return r})),n.d(t,"throwOnUndefined",(function(){return i})),n.d(t,"throwOnNullOrUndefined",(function(){return o})),n.d(t,"throwOnNullOrEmpty",(function(){return a})),n.d(t,"throwOnNullOrEmptyArray",(function(){return s}))},function(e,t,n){"use strict";function r(e,t){return{name:e,dataType:1,value:t,classification:4}}function i(e,t){return{name:e,dataType:2,value:t,classification:4}}function o(e,t){return{name:e,dataType:0,value:t,classification:4}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},,function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"m",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"h",(function(){return g}));var r="Request was aborted or timed out",i="Browser not supported",o="Invalid field or parameter {0}",a="Cannot access {0}",s="Binary data not supported",u="Invalid operation",c="Session storage error",l="Unable to parse json",d="Status:{0}, Content-type:{1}",p="Access denied",f="Timeout due to trusted sites",h="Could not find IFrame element.",g="Message listener is not attached."},function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"q",(function(){return p})),n.d(t,"r",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"c",(function(){return m})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return b}));var r="suiteux-settings.SAVE_SELECTIONS",i="suiteux-settings.CANCEL_SELECTIONS",o="suiteux-settings.ADDORUPDATE_WORKLOADSETTINGLINK",a="suiteux-settings.REMOVE_WORKLOADSETTINGLINK",s="suiteux-settings.SET_WORKLOADSETTINGSLINKS",u="suiteux-settings.INITIALCARDS_AVAILABLE",c="suiteux-settings.LANGUAGECHOICE_AVAILABLE",l="suiteux-settings.LANGUAGECHOICES_AVAILABLE",d="suiteux-settings.SELECTEDTIMEZONE_CHANGED",p="suiteux-settings.TIMEZONEANDFORMATSCHOICE_AVAILABLE",f="suiteux-settings.TIMEZONECHOICES_AVAILABLE",h="suiteux-settings.SELECTEDLANGUAGE_CHANGED",g="suiteux-settings.SELECTEDDATEFORMAT_CHANGED",m="suiteux-settings.DATEFORMATCHOICES_AVAILABLE",v="suiteux-settings.SELECTEDTIMEFORMAT_CHANGED",y="suiteux-settings.TIMEFORMATCHOICES_AVAILABLE",S="suiteux-settings.NAVIGATE_TO_CARD",b="suiteux-settings.O365_SETTINGS_EXPANDED"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(0),i=function(e,t,n){if(void 0===e&&(e=""),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];this[o]=n[o]}},o=function(e){function t(t,n,r){void 0===t&&(t="");var i=e.call(this,t,n,r)||this;return i.message=t,i.errorCode=n,i.errorInfo=r,i.name="RequestExecutorException",i}return Object(r.__extends)(t,e),t}(i)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(r||(r={}))},,function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r="function",i="object",o="undefined",a="prototype";function s(){return typeof globalThis!==o&&globalThis?globalThis:typeof self!==o&&self?self:typeof window!==o&&window?window:typeof e!==o&&e?e:null}function u(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if(n!==i&&n!==r)throw new TypeError("Object prototype may only be an Object:"+e);function o(){}return o[a]=e,new o}function c(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object[a].hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function d(e,t){function n(){this.constructor=e}l(e,t),e[a]=null===t?u(t):(n[a]=t[a],new n)}var p,f,h,g=s()||{};f=c,h=d,(p=g).__assign||(p.__assign=Object.assign||f),p.__extends||(p.__extends=h),__assign||(__assign=g.__assign),__extends||(__extends=g.__extends)}).call(this,n(150))},,,,,,,,,,,,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(r||(r={}))},,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"XSuiteError",(function(){return p})),n.d(t,"generateCorrelationId",(function(){return g})),n.d(t,"getOwaServerName",(function(){return m})),n.d(t,"getOwaError",(function(){return v})),n.d(t,"convertErrorToException",(function(){return y})),n.d(t,"isCallsBlockedException",(function(){return S})),n.d(t,"genericServiceExceptionLog",(function(){return b})),n.d(t,"genericServiceRejection",(function(){return T}));var r=n(6),i=n(1),o=n(12),a=n(22),s=function(){function e(e){this.value=e}return e.newSuid=function(){var t=(new Date).getTime();return e.disambiguationIndex=99===e.disambiguationIndex?0:e.disambiguationIndex+1,new e(100*t+e.disambiguationIndex)},e.disambiguationIndex=-1,e}(),u="X-OWA-ERROR",c="X-OWA-CORRELATIONID",l="X-FESERVER",d="X-BESERVER",p="X-SUITE-ERROR",f="FE_{0}_BE_{1}",h=[c,l,d,u,p];function g(e){return e+"_"+s.newSuid().value.toString()}function m(){return Object(r.b)(f,o.a.Instance.OwaFrontEndServerName,o.a.Instance.OwaBackEndServerName)}function v(e){return null==e?null:(null!=e[l]&&(o.a.Instance.OwaFrontEndServerName=e[l]),null!=e[d]&&(o.a.Instance.OwaBackEndServerName=e[d]),e[u])}function y(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=C(e);o.errorCode=t;for(var s=0,u=0,c=r;u<c.length;u++){var l=c[u];o["arg"+s]=l,s++}return new a.a(n,t,o)}function S(e){return-1010===e.errorCode||-1007===e.errorCode}function b(e,t,n){if(n){var o=n.errorCode||"",a=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",s=n[u]||n[p]||"",h=null!=n[l]&&null!=n[d]?Object(r.b)(f,n[l],n[d]):"",g=n[c]||"";Object(i.f)().exception(e,t,n,o,a,s,h,g)}else Object(i.f)().exception(e,t,n)}function T(e,t,n,r){S(n)&&b(e,t,n),r(n)}function C(e){var t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(var n=0,r=h;n<r.length;n++){var i=r[n];null!=e.headers[i]&&(t[i]=e.headers[i])}return t}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(17),i=n(4),o=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"SuiteApi",{get:function(){return this.suiteApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsInitialized",{get:function(){return this.isInitialized},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){r.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)},e.prototype.checkInitialized=function(){if(!this.isInitialized)throw new i.a("SuiteApiComponent_InvalidInitializationCheck",-2002)},e}()},,function(e,t,n){"use strict";var r=n(1),i=n(94),o=n(30),a=n(108);n.d(t,"a",(function(){return a.a}));n(66);Object(r.c)().subscribe("ShellDataUpdated",(function e(t,n){if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!a.a.isInitialized()){var s=Object(r.g)(),u={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:Object(o.b)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:Object(o.c)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:s.GetTokenRequestDictionary,ServiceWorkerCacheId:s.serviceWorkerCacheId,ServiceWorkerFetchStrategy:s.serviceWorkerFetchStrategy,UserDisambiguationEnabled:n.AADDisambiguationEnabled,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!Object(o.c)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:Object(i.e)(s.opxHostUrlOverride),ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled};a.a.CreateInstance(u);var c=Object(r.c)();c.invoke("SuiteAPILoaded",a.a.Instance),c.unsubscribe("ShellDataUpdated",e)}}),!0)},,,,,,function(e,t,n){var r=n(249);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r,i=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function o(e,t,n){i.fireEvent({level:e,category:t,message:n})}function a(e,t,n){o(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AriaSDK.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
* File to export public classes, interfaces and enums.
*/
var r=n(58);t.AWTPropertyType=r.AWTPropertyType,t.AWTPiiKind=r.AWTPiiKind,t.AWTEventPriority=r.AWTEventPriority,t.AWTEventsDroppedReason=r.AWTEventsDroppedReason,t.AWTEventsRejectedReason=r.AWTEventsRejectedReason,t.AWTCustomerContentKind=r.AWTCustomerContentKind;var i=n(117);t.AWTUserIdType=i.AWTUserIdType,t.AWTSessionState=i.AWTSessionState;var o=n(189);t.AWT_BEST_EFFORT=o.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=o.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=o.AWT_REAL_TIME;var a=n(118);t.AWTEventProperties=a.default;var s=n(190);t.AWTLogger=s.default;var u=n(194);t.AWTLogManager=u.default;var c=n(246);t.AWTTransmissionManager=c.default;var l=n(192);t.AWTSerializer=l.default;var d=n(153);t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(6),i=n(77),o=n(1),a=n(22),s=n(20),u=n(5),c=n(39),l=n(93),d=n(130),p=n(57),f=n(23),h=n(132),g=n(12),m=n(144);function v(){return function(e){var t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}("shellver")}var y=function(){function e(t,n,r,i){if(void 0===i&&(i=!1),u.validateField(n,"url",u.StringTypeString,!0),u.isNullOrEmptyString(n))throw u.createInvalidParameterException("url");if(n.indexOf("?")>=0)throw u.createInvalidParameterException("url");"/"===n.charAt(0)&&(n=u.buildUrl(u.getCurrentWindowLocation(),n)),u.validateFullUrl(n,"url"),n.charCodeAt(n.length-1)==="/".charCodeAt(0)&&(n=n.substr(0,n.length-1)),n=n.toLowerCase(),this.url=n,u.getUrlDomainPart(n,!0)!==u.getUrlDomainPart(u.getCurrentWindowLocation(),!0)&&!i||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=r,e.sIFrameInstanceCode[this.appWebProxyUrl]=t,window.addEventListener("unload",e.resetMessageListenerAttachedFlag)}return Object.defineProperty(e.prototype,"appWebProxyUrl",{get:function(){return u.buildUrl(this.url,this.iFrameSourceUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canExecuteNow",{get:function(){return null!==document.body||e.sWindowLoadCalled},enumerable:!0,configurable:!0}),e.prototype.executeAsync=function(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)},e.prototype.executeCrossDomainRequestAsync=function(e,t){return void 0===t&&(t=!1),this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)},e.prototype.ping=function(){return null!=e.sFramePinged&&e.sFramePinged[this.appWebProxyUrl]},e.prototype.registerOpxHost=function(e){this.executeOrQueueCrossDomainRequest(f.a.RegisterOpxHost,e)},e.prototype.executeOpxRequest=function(e){var t={requestObject:e};this.executeOrQueueCrossDomainRequest(f.a.OutgoingOpxMessage,t)},e.prototype.executeStorageRequest=function(t){if(1===this.mode)this.executeOrQueueCrossDomainRequest(f.a.Storage,t);else if(0===this.mode)try{var n=t.requestObject;1===n.RequestType?Object(o.f)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,s.g):d.a.processRequest(n,(function(n){var r={responseObject:n};e.fireDataWatchSentCallback(t),null!=t.success&&t.success(r),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,0,"")}))}catch(n){null!=t.error&&t.error({},0,n.message),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,{},n.errorCode||0,n.message)}},e.prototype.executeIdentityProviderRequest=function(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(f.a.UserState,e)},e.prototype.executeSignalRRequest=function(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(f.a.SignalR,e)},e.prototype.setBeforeSendRequestAction=function(e){this.beforeSendRequest=e},e.prototype.prefetchOAuthAccessToken=function(e){var t=this;g.a.Instance.configuration.IsPwa?m.a.getToken(e).catch((function(n){1===n.responseType&&t.executeOrQueueCrossDomainRequest(f.a.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(f.a.TokenPrefetch,e)},e.prototype.getOwaUserConfiguration=function(e){this.executeOrQueueCrossDomainRequest(f.a.OwaUserConfig,e)},e.internalProcessIFrameRequestTimeoutCallback=function(t){if(null!==e.sPostMessageIdToRequestInfoMap){var n=e.sPostMessageIdToRequestInfoMap[t];null!=n&&(e.isCurrentSiteInTrustOrLocalZone()&&Object(o.f)().tag("RequestExecutor_IFrameLoadError",4,-1007,s.m),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],u.reportSimpleError(n.requestInfo,-1001,s.j,"IFrameRequest"),Object(o.f)().serverRequest(n.command,n.requestInfo.method,e.sIFrameInstanceCode[n.appWebProxyUrl].toString(),n.requestInfo.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n.requestInfo,null,-1001,s.j))}},e.prototype.validateRequest=function(e,t){if(u.validateRequestInfo(e),u.isFullUrl(e.url)){if(!t&&u.getUrlDomainPart(e.url,!0).toLowerCase()!==u.getUrlDomainPart(this.url,!0))throw u.createInvalidParameterException("requestInfo.url")}else e.url=u.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&u.checkBrowserBinaryDataSupport()},e.prototype.executeValidatedRequestInternal=function(e,t){return void 0===t&&(t=!1),t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(f.a.Query,e):this.executeQueryDirect(e),e.postMessageId},e.prototype.executeQueryDirect=function(t){var n=this,r=u.buildUrl(this.url,"_api/contextinfo");r=u.encodeUrlForXmlHttpRequest(r),e.ensureFormDigest(this.url,r,this.formDigestHandlingEnabled,t,(function(e,t){return n.executeQueryUsingXMLHttpRequest(e,t)}))},e.ensureFormDigest=function(t,n,i,a,c){t=t.toLowerCase();var l=new Date;if(!i||"GET"===a.method.toUpperCase()||null!=e.sFormDigestExpirationCache[t]&&e.sFormDigestExpirationCache[t]>l.getTime())c(e.sFormDigestValueCache[t],a);else{var d=u.getXMLHttpRequest();d.open("POST",n),d.setRequestHeader("accept","application/json;odata=verbose");var p=Date.now(),h=0;a.timeout>0&&(h=window.setTimeout((function(){d.onreadystatechange=function(){};try{d.abort()}catch(e){}u.reportSimpleError(a,-1001,s.j,"ensureFormDigest"),Object(o.f)().serverRequest(f.a.Query,a.method,null,a.url,-1001,a.isTokenGeneratedFromWorkload)}),a.timeout)),d.onreadystatechange=function(){if(4===d.readyState){var n=Date.now()-p;if(0!==h&&window.clearTimeout(h),d.onreadystatechange=function(){},200!==d.status||null===d.getResponseHeader("content-type")||d.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){var i=Object(r.b)(s.l,d.status.toString(),d.getResponseHeader("content-type"));u.reportSimpleError(a,-1002,i),Object(o.f)().tag("RequestExecutor_UnexpectedResponse",6,-1002,d.status.toString(),d.getResponseHeader("content-type")),Object(o.f)().serverRequest(f.a.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(d))}else{var l=JSON.parse(d.responseText);if(null!=l){var g=l.d.GetContextWebInformation.FormDigestValue,m=l.d.GetContextWebInformation.FormDigestTimeoutSeconds,v=(new Date).getTime()+750*m;e.sFormDigestValueCache[t]=g,e.sFormDigestExpirationCache[t]=v,c(g,a),Object(o.f)().serverRequest(f.a.Query,a.method,null,a.url,d.status,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(d))}else u.reportSimpleError(a,-1002,s.i),Object(o.f)().tag("RequestExecutor_UnableToParseJson",6,-1002,s.i,d.status.toString(),d.responseText),Object(o.f)().serverRequest(f.a.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(d))}}},d.send("")}},e.prototype.executeOrQueueCrossDomainRequest=function(t,n){e.sMessageListenerAttached=!!e.sMessageListenerAttached||u.ensureAttachMessageListener(e.internalOnMessage),e.fireDataWatchSentCallback(n),n.postMessageId=e.getPostMessageId(),this.canExecuteNow?this.executeCommandByIFrame(t,this.appWebProxyUrl,n):e.addToRequestExecutorQueue(this,n)},e.prototype.executeCommandByIFrame=function(t,n,r){var i={command:t,postMessageId:r.postMessageId,appWebProxyUrl:n,requestInfo:r,timeoutId:null},o=e.sPendingRequestInfo[n];null==o&&(o=[],e.sPendingRequestInfo[n]=o),e.sPostMessageIdToRequestInfoMap[i.postMessageId]=i,i.requestInfo.timeout>0&&(i.timeoutId=window.setTimeout((function(){return e.internalProcessIFrameRequestTimeoutCallback(i.postMessageId)}),i.requestInfo.timeout));var a=u.getFrameElement(e.sIFrameInstanceCode[n]);null!=a?e.sFrameLoaded[n]&&e.sFramePinged[n]?e.sendPostMessage(i):o.push(i):(o.push(i),a=e.createIFrame(n))},e.createIFrame=function(t){var n=e.sIFrameInstanceCode[t],r=u.getFrameID(n);switch(n){case p.a.OWA:Object(o.f)().perfMarker("OwaIframeLoadStarted");break;case p.a.TokenFactory:Object(o.f)().perfMarker("TokenFactoryIframeLoadStarted")}var i=document.createElement("iframe");i.src=t,i.id=r,i.name=r,i.style.display="none",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");i.addEventListener("load",(function(){e.internalProcessIFrameOnload(t)})),document.body.appendChild(i);var a=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeoutOrIFrameLoadTimeout(t)}),this.IFrameLoadTimeout);return e.sFrameLoadTimeoutId[t]=a,i},e.prototype.executeQueryUsingXMLHttpRequest=function(t,n){var r=u.getXMLHttpRequest(),i=u.encodeUrlForXmlHttpRequest(n.url);r.open(n.method,i);var a=!1;if(null!=n.headers)for(var c=0,d=Object.keys(n.headers);c<d.length;c++){var p=d[c];null!=p&&(r.setRequestHeader(p,n.headers[p]),"x-requestdigest"===p.toLowerCase()&&(a=!0))}a||null==t||r.setRequestHeader("X-RequestDigest",t),n.binaryStringResponseBody&&(r.responseType="arraybuffer");var h=0;n.timeout>0&&(h=window.setTimeout((function(){return e.internalProcessXMLHttpRequestTimeoutCallback(r,n)}),n.timeout)),r.onreadystatechange=function(){return e.internalProcessXMLHttpRequestOnreadystatechange(r,n,h)};var g=n.body;if(n.binaryStringRequestBody&&(g=u.convertBinaryStringToXmlHttpRequestBody(n.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(r,null,null),!l.a.isAllowedApi(i))return u.reportSimpleError(n,-1009,s.a),void Object(o.f)().serverRequest(f.a.Query,n.method,null,i,-1009);e.fireDataWatchSentCallback(n),n.requestSentTime=Date.now(),r.send(g)},e.sendPostMessage=function(t){u.validateField(t.postMessageId,"requestInfo.postMessageId",u.StringTypeString,!0),u.validateField(t.appWebProxyUrl,"requestInfo.appWebProxyUrl",u.StringTypeString,!0);var n=u.getFrameElement(e.sIFrameInstanceCode[t.appWebProxyUrl]);if(null==n)throw Object(o.f)().tag("RequestExecutor_IFrameNull",6,-2002,s.e,t.appWebProxyUrl),new a.b(s.e,-2002);null==e.sPostMessageIdToRequestInfoMap&&(e.sPostMessageIdToRequestInfoMap={}),e.sPostMessageIdToRequestInfoMap[t.postMessageId]=t;var r={command:t.command,url:t.requestInfo.url,resource:t.requestInfo.resource,method:t.requestInfo.method,body:t.requestInfo.body,headers:t.requestInfo.headers,postMessageId:t.postMessageId,timeout:t.requestInfo.timeout,binaryStringRequestBody:t.requestInfo.binaryStringRequestBody,binaryStringResponseBody:t.requestInfo.binaryStringResponseBody,requestObject:t.requestInfo.requestObject,getPerformanceTrace:t.requestInfo.getPerformanceTrace},i=JSON.stringify(r),c=t.appWebProxyUrl;t.requestInfo.requestSentTime=Date.now(),g.a.isUnitTestMode||n.contentWindow.postMessage(i,c)},e.getPostMessageId=function(){return e.sPostMessageIdCount++,u.PostMessageIdPrefix+e.sPostMessageIdCount.toString()},e.internalProcessWindowLoad=function(){e.sWindowLoadCalled=!0;var t=e.sRequestExecutorQueue;e.sRequestExecutorQueue=null;var n=e.sRequestExecutorParameterQueue;if(e.sRequestExecutorParameterQueue=null,null!==t)for(var r=0;r<t.length;r++)t[r].executeAsync(n[r])},e.resetMessageListenerAttachedFlag=function(){e.sMessageListenerAttached=!1},e.internalProcessIFrameOnload=function(t){e.sFrameLoaded[t]=!0,null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),u.ensureAttachMessageListener(e.internalOnMessage),null!=e.sFramePingTimeoutId[t]&&(window.clearTimeout(e.sFramePingTimeoutId[t]),delete e.sFramePingTimeoutId[t]);var n={requestObject:{upn:g.a.Instance.configuration.CurrentUserUpn,puid:g.a.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:g.a.Instance.configuration.OpxEnabled}}},r=v();r&&window.O365ShellBootInfo&&(n.requestObject.overrideRequest=u.buildIframeResourceData(r,window.O365ShellBootInfo));var i={command:f.a.Ping,postMessageId:e.getPostMessageId(),appWebProxyUrl:t,timeoutId:-1,requestInfo:n};e.sPostMessageIdToRequestInfoMap[i.postMessageId]=i;var o=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeout(i.postMessageId,t)}),e.IFramePingTimeout);i.timeoutId=o,g.a.isUnitTestMode||(e.sFramePingTimeoutId[t]=o),e.sendPostMessage(i)},e.internalOnMessage=function(t){if(null!=t){var n=t.origin,r=t.data;if(null!=n&&""!==n&&null!=r&&""!==r)try{var i=JSON.parse(r);e.isPostMessageResponseInfo(i)&&e.onResponseMessageReceived(n,i)}catch(t){}}},e.isPostMessageResponseInfo=function(e){var t=e;return null!=t.postMessageId&&null!=t.command},e.onResponseMessageReceived=function(t,n){var r=Date.now();if(null!=e.sPostMessageIdToRequestInfoMap&&null!=n.postMessageId){var i=e.sPostMessageIdToRequestInfoMap[n.postMessageId];if(null!=i){var a=u.getUrlDomainPart(t,!0),s=u.getUrlDomainPart(i.appWebProxyUrl,!0);if(a.toLowerCase()===s.toLowerCase()){var c=n.postMessageId,l=r-i.requestInfo.requestSentTime,d=n.command===f.a.Query&&0===n.errorCode&&3===n.readyState,p=n.command===f.a.Notification&&null==n.errorMessage;if(d||p||(delete e.sPostMessageIdToRequestInfoMap[c],null!=i.timeoutId&&(window.clearTimeout(i.timeoutId),i.timeoutId=0,delete i.timeoutId)),n.command===f.a.Ping)e.processPingMessage(i.appWebProxyUrl,n),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(i.requestInfo,n),Object(o.f)().serverRequest(i.command,i.requestInfo.method,e.sIFrameInstanceCode[i.appWebProxyUrl].toString(),u.getUrlDomainPart(i.appWebProxyUrl),0===n.errorCode?200:n.errorCode,i.requestInfo.isTokenGeneratedFromWorkload,l,n.responseText?n.responseText.length:0);else if(n.command===f.a.Query){var h={responseAvailable:n.responseAvailable,body:n.responseText||"",statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,state:i.requestInfo.state,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody},g=0,m=null;0!==n.errorCode?(g=n.errorCode,m=n.errorMessage):n.statusCode>=200&&n.statusCode<300||1223===n.statusCode||(g=-1003,m=n.statusCode),0===g?4===n.readyState?(h.performanceTrace=n.performanceTrace,null!=i.requestInfo.success&&i.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(i.requestInfo,h,0,null),Object(o.f)().serverRequest(i.command,i.requestInfo.method,e.sIFrameInstanceCode[i.appWebProxyUrl].toString(),i.requestInfo.url,n.statusCode,i.requestInfo.isTokenGeneratedFromWorkload,l,n.responseText?n.responseText.length:0)):3===n.readyState&&null!=i.requestInfo.loading&&i.requestInfo.loading(h):4!==n.readyState&&0!==n.readyState&&null!=n.readyState||(h.performanceTrace=n.performanceTrace,null!=i.requestInfo.error&&i.requestInfo.error(h,g,m),Object(o.f)().tag("RequestExecutor_IFrameError",4,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(i.requestInfo,h,g,m),Object(o.f)().serverRequest(i.command,i.requestInfo.method,e.sIFrameInstanceCode[i.appWebProxyUrl].toString(),i.requestInfo.url,g,i.requestInfo.isTokenGeneratedFromWorkload,l,n.responseText?n.responseText.length:0))}else if(n.command===f.a.Storage||n.command===f.a.TokenPrefetch||n.command===f.a.OwaUserConfig){h={responseObject:n.responseObject},g=n.errorCode,m=n.errorMessage;0===g&&u.isNullOrEmptyString(m)?(null!=i.requestInfo.success&&i.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(i.requestInfo,h,0,null)):(null!=i.requestInfo.error&&i.requestInfo.error(h,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(i.requestInfo,h,g,m)),Object(o.f)().serverRequest(i.command,i.requestInfo.method,e.sIFrameInstanceCode[i.appWebProxyUrl].toString(),i.requestInfo.url,0!==g?g:200,i.requestInfo.isTokenGeneratedFromWorkload,l,n.responseText?n.responseText.length:0)}else n.command===f.a.Notification?(0!==n.errorCode&&null!=i.requestInfo.error&&i.requestInfo.error({responseObject:n.responseObject},n.errorCode,n.errorMessage),e.NotificationCallback(JSON.stringify(n.responseObject)),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(i.requestInfo,n)):n.command===f.a.RegisterOpxHost&&null!=i.requestInfo.success&&i.requestInfo.success(null)}}}},e.internalProcessXMLHttpRequestTimeoutCallback=function(t,n){t.onreadystatechange=function(){};try{t.abort()}catch(e){}u.reportSimpleError(n,-1001,s.j,"XMLHttpRequest"),Object(o.f)().serverRequest(f.a.Query,n.method,null,n.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,null,-1001,s.j)},e.internalProcessXMLHttpRequestOnreadystatechange=function(t,n,r){if(4===t.readyState){var i=Date.now();0!==r&&window.clearTimeout(r),t.onreadystatechange=function(){};var a={state:n.state,responseAvailable:!0,body:n.binaryStringResponseBody?u.convertArrayBufferToBinaryString(t.response):t.responseText,statusCode:t.status,statusText:t.statusText,contentType:t.getResponseHeader("content-type"),allResponseHeaders:t.getAllResponseHeaders(),headers:u.parseResponseHeaders(t.getAllResponseHeaders()),performanceTrace:null},s=i-n.requestSentTime;if(n.getPerformanceTrace){var c=performance.getEntriesByName(n.url);null!=c&&c.length>0&&(a.performanceTrace=c[0])}t.status>=200&&t.status<300||1223===t.status?(null!=n.success&&n.success(a),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,a,0,null),Object(o.f)().serverRequest(f.a.Query,n.method,null,n.url,a.statusCode,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t))):(null!=n.error&&n.error(a,-1003,t.statusText),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,a,-1003,t.statusText),Object(o.f)().serverRequest(f.a.Query,n.method,null,n.url,t.status,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t)))}},e.isCurrentSiteInTrustOrLocalZone=function(){if(!e.isTrustedSiteEvaluated){if(i.isBrowserIE()){var t=window.status,n=window.status+(new Date).getTime();window.status=n,e.isTrustedSite=window.status===n,window.status=t}e.isTrustedSiteEvaluated=!0}return e.isTrustedSite},e.processPingTimeout=function(t,n){null==e.sPostMessageIdToRequestInfoMap[t]&&(e.sFramePinged[n]||(Object(o.f)().tag("PingTimeout",0,e.sIFrameInstanceCode[n].toString()),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],e.processPingTimeoutOrIFrameLoadTimeout(n)))},e.processPingTimeoutOrIFrameLoadTimeout=function(t){switch(e.sIFrameInstanceCode[t]){case p.a.OWA:Object(o.f)().perfMarker("OwaIframeLoadFailed");break;case p.a.TokenFactory:Object(o.f)().perfMarker("TokenFactoryIframeLoadFailed")}var n=u.getUrlDomainPart(t,!0);if(n.toLowerCase()===u.getUrlDomainPart(g.a.Instance.configuration.SuiteServiceUrl,!0)){var i=e.isCurrentSiteInTrustOrLocalZone()?c.a.SecurityZoneMismatched:c.a.IframeLoadError;h.a.Instance.blockSuiteServiceCalls(i,n)}var a=Object(r.b)(s.d,n);e.reportFrameLoadError(t,a)},e.reportFrameLoadError=function(t,n,r){void 0===r&&(r=-1007),e.sFrameLoadError[t]=!0;var i=e.sPendingRequestInfo[t];e.sPendingRequestInfo[t]=[];var a=!1;if(a=e.isTrustedSiteEvaluated?e.isTrustedSite:e.isCurrentSiteInTrustOrLocalZone(),Object(o.f)().tag("RequestExecutor_IFrameLoadError",4,r,n,"isTrustedSite: "+a),null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),e.removeIFrame(t),null!=i)for(var s=0,c=i;s<c.length;s++){var l=c[s],d=l.postMessageId;null!=e.sPostMessageIdToRequestInfoMap[d]&&(e.sPostMessageIdToRequestInfoMap[d]=null,delete e.sPostMessageIdToRequestInfoMap[d],null!=l.timeoutId&&window.clearTimeout(l.timeoutId),u.reportSimpleError(l.requestInfo,r,n),Object(o.f)().serverRequest(l.command,l.requestInfo.method,e.sIFrameInstanceCode[t].toString(),l.requestInfo.url,-1007))}},e.removeIFrame=function(t){var n=u.getFrameElement(e.sIFrameInstanceCode[t]);null!=n&&null!=n.parentNode&&n.parentNode.removeChild(n),null!=e.sPendingRequestInfo&&delete e.sPendingRequestInfo[t],null!=e.sFrameLoadTimeoutId&&delete e.sFrameLoadTimeoutId[t],null!=e.sFrameLoaded&&delete e.sFrameLoaded[t],null!=e.sFramePinged&&delete e.sFramePinged[t],null!=e.sFramePingTimeoutId&&delete e.sFramePingTimeoutId[t],null!=e.sFrameLoadError&&delete e.sFrameLoadError[t]},e.processPingMessage=function(t,n){switch(e.sIFrameInstanceCode[t]){case p.a.OWA:Object(o.f)().perfMarker("OwaIframeLoadCompleted");break;case p.a.TokenFactory:Object(o.f)().perfMarker("TokenFactoryIframeLoadCompleted")}if(n.errorCode&&0!==n.errorCode)e.reportFrameLoadError(t,n.errorMessage,n.errorCode);else{e.sFramePinged[t]=!0;var r=e.sPendingRequestInfo[t];if(null!=r){e.sPendingRequestInfo[t]=[];for(var i=0,a=r;i<a.length;i++){var s=a[i];null!=e.sPostMessageIdToRequestInfoMap[s.postMessageId]&&e.sendPostMessage(s)}}}},e.addToRequestExecutorQueue=function(t,n){null===e.sRequestExecutorQueue&&(e.sRequestExecutorQueue=[]),null===e.sRequestExecutorParameterQueue&&(e.sRequestExecutorParameterQueue=[]),e.sRequestExecutorQueue.push(t),e.sRequestExecutorParameterQueue.push(n)},e.fireDataWatchSentCallback=function(t){null!==e.DataWatchSentCallback&&(e.DataWatchRequestId++,t.dataRequestId=e.DataWatchRequestId,e.DataWatchSentCallback(e.DataWatchRequestId,t))},e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo=function(t,n){if(null!=e.DataWatchReceivedCallback){var r={body:n.responseText,responseAvailable:n.responseAvailable,statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody,responseObject:n.responseObject,state:t.state,performanceTrace:n.performanceTrace};e.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,n.errorCode,n.errorMessage)}},e.fireDataWatchReceivedCallbackGivenResponseInfo=function(t,n,r,i){null!==e.DataWatchReceivedCallback&&null!=t.dataRequestId&&e.DataWatchReceivedCallback(t.dataRequestId,n,r,i)},e.DefaultTimeout=6e4,e.IFrameLoadTimeout=15e3,e.IFramePingTimeout=1e4,e.sPendingRequestInfo={},e.sFrameLoaded={},e.sFramePinged={},e.sFramePingTimeoutId={},e.sFrameLoadTimeoutId={},e.sFrameLoadError={},e.sPostMessageIdToRequestInfoMap={},e.sIFrameInstanceCode={},e.sFormDigestValueCache={},e.sFormDigestExpirationCache={},e.sPostMessageIdCount=0,e.sWindowLoadCalled=!1,e.sRequestExecutorQueue=[],e.sRequestExecutorParameterQueue=[],e.DataWatchSentCallback=null,e.DataWatchRequestId=0,e.DataWatchReceivedCallback=null,e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4);function i(e){return new r.a("Argument Exception: "+e,-2001)}function o(e){return new r.a("Invalid Operation: "+e,-2002)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return y.b})),n.d(t,"b",(function(){return y.a})),n.d(t,"d",(function(){return O}));var r=n(0),i=n(4),o=n(47),a=n(66),s=i.e.SuiteServiceApiRelativePath+"NotificationsSettings/User",u=function(){function e(e){this.suiteApi=e}return e.prototype.readNotificationSettings=function(){var e=this;return new Promise((function(t,n){e.suiteApi.Service.callOwaIframeResourceUrl(s,null,i.b.GET).then((function(e){t(e)})).catch((function(e){i.h.genericServiceRejection("ReadNotificationSettings",6,e,n)}))}))},e.prototype.writeNotificationSettings=function(e){var t=this;return new Promise((function(n,r){if(null==e)throw Object(a.a)("settingValue");t.suiteApi.Service.callOwaIframeResourceUrl(s,e,i.b.PUT).then((function(){n()})).catch((function(e){i.h.genericServiceRejection("WriteNotificationSettings",6,e,r)}))}))},e}(),c=n(17),l=function(){function e(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,Object(c.throwOnNullOrEmpty)(e,"keyScope"),Object(c.throwOnNullOrEmpty)(t,"keyNamespace"),Object(c.throwOnNullOrEmpty)(n,"keyName")}return e.prototype.toString=function(){return this.Scope+i.j.DictionaryStringPartsSeparator+this.Namespace+i.j.DictionaryStringPartsSeparator+this.Name},e.fromDictionaryKey=function(t){Object(c.throwOnNullOrEmpty)(t,"keyString");var n=t.split(i.j.DictionaryStringPartsSeparator);if(n.length<3)throw Object(a.b)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new e(n[0],n[1],n[2])},e}(),d=function(e,t){this.Key=e,this.Value=t,Object(c.throwOnNull)(e,"key"),Object(c.throwOnNull)(t,"value")},p=function(e){function t(t,n){var r=e.call(this,t)||this;return r.Header=t,r.Body=n,r}return Object(r.__extends)(t,e),t}((function(e){this.Header=e})),f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(r.__extends)(t,e)}((function(){})),"Cannot remove a key needed for read or write."),h=function(){function e(e,t,n,r,i){var o=this;void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=[]),void 0===r&&(r={}),void 0===i&&(i=[]),this.clear=e,this.clearAll=t,this.writes=r,this.reads={},this.removes={},n.forEach((function(e){return o.reads[e.toString()]=e})),i.forEach((function(e){return o.removes[e.toString()]=e}))}return e.prototype.getReadStorageKeys=function(){var e=this;return Object.keys(this.reads).map((function(t){return e.reads[t]}))},e.prototype.getWriteStorageKeyValues=function(){var e=this;return Object.keys(this.writes).map((function(t){return e.writes[t]}))},e.prototype.getRemoveStorageKeys=function(){var e=this;return Object.keys(this.removes).map((function(t){return e.removes[t]}))},e.prototype.requestRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(c.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,r=e;n<r.length;n++){var o=r[n];if(Object(c.throwOnNull)(o,"key"),this.isRemoveRequested(o))throw new i.a(f,-2002);this.reads[o.toString()]=o}},e.prototype.requestWrite=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];Object(c.throwOnUndefined)(e,"value"),Object(c.throwOnNullOrEmptyArray)(t,"keys");for(var r=0,o=t;r<o.length;r++){var a=o[r];if(Object(c.throwOnNull)(a,"key"),this.isRemoveRequested(a))throw new i.a(f,-2002);this.writes[a.toString()]=new d(a,e)}},e.prototype.requestRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(c.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,r=e;n<r.length;n++){var o=r[n];if(Object(c.throwOnNull)(o,"key"),o.toString()in this.reads||o.toString()in this.writes)throw new i.a(f,-2002);this.removes[o.toString()]=o}},e.prototype.requestClear=function(){this.clear=!0},e.prototype.requestClearAll=function(){this.clearAll=!0},e.prototype.combine=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Object(c.throwOnNullOrEmptyArray)(t,"requests");for(var r=new e(this.clear,this.clearAll),i=0,o=t.concat(this);i<o.length;i++){var a=o[i];a.getReadStorageKeys().length&&r.requestRead.apply(r,a.getReadStorageKeys());for(var s=0,u=Object.keys(a.writes);s<u.length;s++){var l=u[s];r.requestWrite(a.writes[l].Value,a.writes[l].Key)}a.getRemoveStorageKeys().length&&r.requestRemove.apply(r,a.getRemoveStorageKeys())}return r},e.prototype.valueToBeWritten=function(e){Object(c.throwOnNullOrUndefined)(e,"key");var t=this.writes[e.toString()];if(null==t)throw new i.a("Cannot read key without value.",-2002);return t.Value},e.prototype.isRemoveRequested=function(e){return Object(c.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes},e.prototype.isClearRequested=function(){return this.clear},e.prototype.isClearAllRequested=function(){return this.clearAll},e.prototype.toStorageServerJsonRequest=function(){var e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((function(e){return new d(e.Key,JSON.stringify(e.Value))}))};return new p({},e)},e.prototype.toStorageDataRequest=function(e){return{UserId:e,Clear:this.clear,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((function(e){return e.toString()})),Writes:this.getWriteStorageKeyValues().map((function(e){return{Key:e.Key.toString(),Value:JSON.stringify(e.Value)}})),Deletes:this.getRemoveStorageKeys().map((function(e){return e.toString()})),RequestType:0}},e}(),g=function(){function e(e){void 0===e&&(e={}),this.values=e}return e.fromStorageSessionResponseData=function(t){c.throwOnNullOrUndefined(t,"data");for(var n=new e({}),r=0,i=Object.keys(t.Reads);r<i.length;r++){var o=i[r],a=new d(l.fromDictionaryKey(o),JSON.parse(t.Reads[o]));n.values[a.Key.toString()]=a.Value}return n},e.fromStorageServerResponseData=function(t){c.throwOnNullOrUndefined(t,"data");for(var n=new e({}),r=0,i=t.Settings;r<i.length;r++){var o=i[r],a=new d(o.Key,JSON.parse(o.Value));n.values[a.Key.toString()]=a.Value}return n},e.prototype.hasKey=function(e){return c.throwOnNullOrUndefined(e,"key"),e.toString()in this.values},e.prototype.value=function(e){if(c.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new i.a("Key value missing.",-2002);return this.values[e.toString()]},e.prototype.getStorageKeyValues=function(){var e=this;return Object.keys(this.values).map((function(t){return e.values[t]}))},e}(),m=n(1),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.initializeComponent=function(){this.NotificationsStorage=new u(this.SuiteApi)},t.prototype.createStorageRequest=function(){return this.checkInitialized(),new h},t.prototype.submitStorageRequestToOwaSessionStorage=function(e,t){var n=this;return this.checkInitialized(),new Promise((function(r,o){if(null==e)return o(a.a("request"));n.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(n.SuiteApi.Configuration.CurrentUserUpn)).then((function(e){n.checkStorageResponseErrors(e,o)||r(g.fromStorageSessionResponseData(e))})).catch((function(e){i.h.isCallsBlockedException(e)||Object(m.f)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),o(e)})),null!=t&&window.setTimeout((function(){var e=new Error("Session Storage Request Timeout");Object(m.f)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),o(e)}),t)}))},t.prototype.isServerStorageEnabled=function(e){return i.i.Instance.configuration.UserHasExchangeLicense||e},t.prototype.readNotificationSettings=function(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()},t.prototype.writeNotificationSettings=function(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)},t}(o.a),y=n(151),S=n(3),b=n(48),T=n(73),C=function(){function e(e){void 0===e&&(e=new h),this.storageRequest=e}return e.prototype.requestRead=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.storageRequest).requestRead.apply(e,t)},e.prototype.requestWrite=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(t=this.storageRequest).requestWrite.apply(t,Object(r.__spreadArrays)([e],n))},e.prototype.toStorageDataRequest=function(e){return this.storageRequest.toStorageDataRequest(e)},e.prototype.requestClear=function(){this.storageRequest.requestClear()},e.prototype.requestClearAll=function(){this.storageRequest.requestClearAll()},e}(),_=function(){function e(e){void 0===e&&(e=void 0),this.value=e}return e.prototype.fromStorageSessionResponseData=function(e){this.storageResponse=g.fromStorageSessionResponseData(e)},e.prototype.hasValue=function(e){return S.x.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)},e.prototype.getValue=function(e){return S.x.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.createWebShellStorageRequest=function(){return this.checkInitialized(),new C},t.prototype.readStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryRequest(t,e,n,i.b.GET);return this.useStorage(r)},t.prototype.batchReadStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryBatchRequest(t,e,n,i.b.GET);return this.useStorage(r)},t.prototype.writeStorage=function(e,t,n,r){this.checkInitialized();var o=this.createTokenFactoryRequest(t,e,n,i.b.PUT);return o.body=JSON.stringify(r),this.useStorage(o)},t.prototype.removeStorage=function(e,t,n){this.checkInitialized();var r=this.createTokenFactoryRequest(t,e,n,i.b.DELETE);return this.useStorage(r)},t.prototype.readSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.readLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeLocalStorage=function(e){return Promise.reject(new Error("not implemented"))},t.prototype.createTokenFactoryRequest=function(e,n,r,i){S.x.throwOnNullOrEmpty(r,"keyName");var o=Object(S.C)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(r),t.ApiVersion);return this.createTokenFactoryRequestHelper(o,i)},t.prototype.createTokenFactoryBatchRequest=function(e,n,r,i){S.x.throwOnNullOrEmptyArray(r,"keyNames");var o=Object(S.C)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(r.join(",")),t.ApiVersion);return this.createTokenFactoryRequestHelper(o,i)},t.prototype.createTokenFactoryRequestHelper=function(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:T.b}},t.prototype.useStorage=function(e){var t=this;return new Promise((function(n,r){t.SuiteApi.Service.callEndpointWithOauthToken(e).then((function(e){n(new _(e))})).catch(r)}))},t.prototype.useBrowserStorage=function(e){var t=this;return new Promise((function(n,r){S.x.throwOnNull(e,"StorageRequest");var o=!1,s=e.toStorageDataRequest(t.SuiteApi.Configuration.CurrentUserUpn),u={url:i.i.Instance.configuration.TokenFactoryIframeOrigin,requestObject:s,timeout:3e4,success:function(e){o=!0;var i=e.responseObject;if(!t.checkStorageResponseErrors(i,r)){var a=new _;a.fromStorageSessionResponseData(i),n(a)}},error:function(e,t,n){o=!0;var i=b.f(n);Object(m.f)().tag("StorageApi_RequestError",6,t,i),r(Object(a.b)(i))}},c=null;t.SuiteApi.Service.AreSuiteServiceCallsBlocked||(c=i.d.OauthTokenFactoryInstance),null!=c?(setTimeout((function(){if(!o){o=!0;var e=new Error("StorageTimeout");Object(m.f)().exception("StorageApi_TimeoutError",6,e),r(e)}}),u.timeout),c.executeStorageRequest(u)):r(new i.a("OauthTokenFactoryIframe",-1011))}))},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;if(!n){var r=new Error("Empty response received.");Object(m.f)().exception("StorageApi_NoResponse",6,r),t(r)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0},t.ApiVersion="1",t}(o.a)},function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(r||(r={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(i||(i={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(6),i=n(93),o=n(57),a=n(65),s=n(12),u="SuiteServiceProxy.aspx",c=function(){function e(){}return Object.defineProperty(e,"OwaInstance",{get:function(){return null==e.suiteSvcInstance?e.createOwaRequestExecutor():e.suiteSvcInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OauthTokenFactoryInstance",{get:function(){return null==e.tokenFactoryInstance?e.createOauthTokenFactoryRequestExecutor():e.tokenFactoryInstance},enumerable:!0,configurable:!0}),e.setOauthTokenFactoryInstanceForTesting=function(t){s.a.isUnitTestMode&&(e.tokenFactoryInstance=t)},e.resetAllInstancesForTesting=function(){e.tokenFactoryInstance=null,e.suiteSvcInstance=null},e.createOauthTokenFactoryRequestExecutor=function(){if(s.a.assertInitialized(),null!=s.a.Instance.configuration.TokenFactoryIframeOrigin){var t=Object(r.b)("{0}//{1}",window.location.protocol,window.location.host),n=Object(r.b)(e.TokenFactoryIframePath,encodeURIComponent(t),encodeURIComponent(s.a.Instance.configuration.ShellSID),encodeURIComponent(e.TokenFactoryIframeApiVersion),encodeURIComponent(s.a.Instance.configuration.ClientShellVersion));s.a.Instance.configuration.UserDisambiguationEnabled&&(n+="&upn="+encodeURIComponent(s.a.Instance.configuration.CurrentUserUpn));var i="https://consumer.suite.office.com"===s.a.Instance.configuration.TokenFactoryIframeOrigin;e.tokenFactoryInstance=new a.a(o.a.TokenFactory,s.a.Instance.configuration.TokenFactoryIframeOrigin,n,i)}return e.tokenFactoryInstance},e.createOwaRequestExecutor=function(){if(s.a.assertInitialized(),null!=s.a.Instance.suiteServiceHostPageBaseUrl&&s.a.Instance.configuration.UserHasExchangeLicense){var t=void 0;t=s.a.Instance.configuration.HintUserName?Object(r.b)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",u,encodeURIComponent(s.a.Instance.configuration.CurrentUserUpn),e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion):Object(r.b)("{0}?{1}={2}&{3}",u,e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion),e.suiteSvcInstance=new a.a(o.a.OWA,s.a.Instance.suiteServiceHostPageBaseUrl,t),e.suiteSvcInstance.setBeforeSendRequestAction(i.a.onBeforeSendRequestSuiteService)}return e.suiteSvcInstance},e.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",e.TokenFactoryIframeApiVersion="oneshell",e.SuiteServiceProxyIframeApiVersion="apiver=1",e.SuiteServiceReturnUrlParam="suiteServiceReturnUrl",e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},i={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* Utils.ts
* @author  Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
* File containing utility functions.
*/
var r=n(119),i=n(58),o=/[xy]/g,a=null;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var s=a,u=a,c=a;function l(e){return"string"==typeof e}function d(e){return"number"==typeof e}function p(e){return"boolean"==typeof e}function f(e){return e instanceof Date}function h(e){return 1e4*(e+621355968e5)}function g(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function m(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function v(e){return e<10?"0"+e:e.toString()}function y(e){return void 0===e||e===a||""===e}t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=l,t.isNumber=d,t.isBoolean=p,t.isDate=f,t.msToTicks=h,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return s===a&&(s="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),s},t.isUint8ArrayAvailable=function(){return u===a&&(u="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!g()),u},t.isPriority=function(e){return!(!d(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||y(n)?a:(y(n.value)&&(n={value:n,type:i.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(d(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:i.AWTPropertyType.Unspecified){case i.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return i.AWTPropertyType.String;case"boolean":return i.AWTPropertyType.Boolean;case"number":return i.AWTPropertyType.Double;case"object":return f(e)?i.AWTPropertyType.Date:a}return a}(e);case i.AWTPropertyType.String:return l(e)?t:a;case i.AWTPropertyType.Boolean:return p(e)?t:a;case i.AWTPropertyType.Date:return f(e)&&NaN!==e.getTime()?t:a;case i.AWTPropertyType.Int64:return d(e)&&e%1==0?t:a;case i.AWTPropertyType.Double:return d(e)?t:a}return a}(n.value,n.type),n.type?(f(n.value)&&(n.value=h(n.value.getTime())),n.pii>0&&n.cc>0?a:n.pii?function(e){if(d(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:a:n.cc?function(e){if(d(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:a:n):a)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+v(e.getUTCMonth()+1)+"-"+v(e.getUTCDate())+"T"+v(e.getUTCHours())+":"+v(e.getUTCMinutes())+":"+v(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(c===a){var e=new XMLHttpRequest;c=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return c},t.useFetchRequest=function(){return g()||m()},t.isReactNative=g,t.isServiceWorkerGlobalScope=m},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(18),i=function(e){var t="Activity.Result",n=[];return n.push(Object(r.b)(t+".Code",e.code)),e.type&&n.push(Object(r.c)(t+".Type",e.type)),void 0!==e.tag&&n.push(Object(r.b)(t+".Tag",e.tag)),void 0!==e.isExpected&&n.push(Object(r.a)(t+".IsExpected",e.isExpected)),n.push(Object(r.c)("zC.Activity.Result","Office.System.Result")),n},o={contractName:"Office.System.Activity",getFields:function(e){var t=[];return e.cV&&t.push(Object(r.c)("Activity.CV",e.cV)),t.push(Object(r.b)("Activity.Duration",e.duration)),t.push(Object(r.b)("Activity.Count",e.count)),t.push(Object(r.b)("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(Object(r.a)("Activity.Success",e.success)),e.result&&t.push.apply(t,i(e.result)),t.push(Object(r.c)("zC.Activity",this.contractName)),t}},a={getFields:function(e){var t=[];return e.primaryIdentityHash&&t.push(Object(r.c)("User.PrimaryIdentityHash",e.primaryIdentityHash)),e.primaryIdentitySpace&&t.push(Object(r.c)("User.PrimaryIdentitySpace",e.primaryIdentitySpace)),e.tenantId&&t.push(Object(r.c)("User.TenantId",e.tenantId)),e.tenantGroup&&t.push(Object(r.c)("User.TenantGroup",e.tenantGroup)),void 0!==e.isAnonymous&&t.push(Object(r.a)("User.IsAnonymous",e.isAnonymous)),t}}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){r.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},r=this,i=0;i<this.listeners.length;++i)n(i)},e.eventsDropped=function(e,t){for(var n=this,r=function(r){i.listeners[r].eventsDropped&&setTimeout((function(){return n.listeners[r].eventsDropped(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)r(o)},e.eventsRetrying=function(e){for(var t=this,n=function(n){r.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},r=this,i=0;i<this.listeners.length;++i)n(i)},e.eventsRejected=function(e,t){for(var n=this,r=function(r){i.listeners[r].eventsRejected&&setTimeout((function(){return n.listeners[r].eventsRejected(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)r(o)},e.listeners=[],e}();t.default=r},,,,function(e,t,n){"use strict";n.d(t,"SuppressNexus",(function(){return r}));var r=-1},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),i=n(67),o=(n(23),function(){function e(){}return e.onBeforeSendRequestSuiteService=function(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==r.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}var o="X-OWA-CANARY",a="X-OWA-CANARY-DEBUG",s=Object(i.a)(o),u=Object(i.a)(a);return null!=s&&e.setRequestHeader(o,s),null!=u&&e.setRequestHeader(a,u),null},e.validateOriginWithAllowedEndpoints=function(t,n){for(var i=[],o=0;o<n.length;o++)i[o]=n[o].host;return e.validateOrigin(r.getUrlAuthorityPart(t),i)},e.validateOrigin=function(e,t){if(null==t||e.length>253)return!1;for(var n=!1,r=0;r<t.length;r++)if(""!==t[r]&&new RegExp(t[r],"i").test(e)){n=!0;break}return n},e.validatePathWithAllowedEndpoints=function(e,t){if(r.isNullOrEmptyString(e))return!1;for(var n=!1,i=r.getUrlAuthorityPart(e),o=r.getUrlPath(e),a=0,s=t;a<s.length;a++){var u=s[a];if(new RegExp(u.host,"i").test(i)){if(null==u.paths)return!1;for(var c=0,l=u.paths;c<l.length;c++){var d=l[c];if(new RegExp(d,"i").test(o)){n=!0;break}}break}}return n},e.validatePathWithAllowedResources=function(e,t,n){if(null==e||r.isNullOrEmptyString(t)||null==n)return!1;for(var i=!1,o=r.getUrlAuthorityPart(e),a=r.getUrlAuthorityPart(t),s=0,u=n;s<u.length;s++){var c=u[s],l=!1;if("^"===c.resource.charAt(0))l=new RegExp(c.resource,"i").test(o);else l=r.getUrlAuthorityPart(c.resource)===o;if(l){if(null==c.hosts)return!1;for(var d=0,p=c.hosts;d<p.length;d++){var f=p[d],h=!1;if("^"===f.charAt(0))h=new RegExp(f,"i").test(a);else h=r.getUrlAuthorityPart(f)===a;if(h){i=!0;break}}break}}return i},e.isAllowedApi=function(t){if(null==t)return!1;var n=r.getUrlPath(t);if(n in e.allowedPath){if(!e.allowedPath[n])return!0;if(r.parseQueryString(t).replace("&UA=0","")in e.allowedListOfApi)return!0}else if(r.startsWith(n,r.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===n||"ev.owa2"===n)&&e.checkAllowedPgmParameters(t)},e.checkAllowedPgmParameters=function(t){if(r.isNullOrEmptyString(t)||""===t.trim())return!1;var n=t.split("?");if(2===n.length){var i=n[1];if(r.isNullOrEmptyString(i)||""===i.trim())return!1;for(var o=0,a=i.split("&");o<a.length;o++){var s=a[o].split("=");if(2!==s.length)return!1;if(!(s[0]in e.AllowedPgmQueryStringParametersList))return!1}return!0}return!1},e.createAllowedPgmParamters=function(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}},e.createAllowedApiList=function(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}},e.createAllowedPath=function(){var e;return(e={})[r.OwsRelativePath]=!0,e["SuiteService.svc/"]=!0,e["SuiteService.svc"]=!0,e["owa/ev.owa2"]=!0,e["ev.owa2"]=!0,e["Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model"]=!0,e["api/myapps/GetAllApps"]=!1,e["api/myapps/GetAppDetails"]=!1,e["api/myapps/GetCompleteAppData"]=!1,e["api/myapps/ExecuteAppCustomAction"]=!1,e["api/myapps/ActivatePendingProvisioningApps"]=!1,e["owa/service.svc/s/GetPersonaPhoto"]=!1,e["api/settings/cards"]=!1,e["api/settings/cards/data"]=!1,e["api/settings/theme"]=!1,e["api/settings/darkmode"]=!1,e["api/settings/language"]=!1,e["api/settings/contactPreferences"]=!1,e["api/NotificationsSettings/User"]=!1,e["api/settings/SPO/MySiteUrl"]=!1,e["api/settings/regiontimezone"]=!1,e["api/profile/photo"]=!1,e["v1.0/me/photo/$value"]=!1,e["api/storage/CustomerContent/Tenant/CustomSupportData"]=!0,e},e.allowedPath=e.createAllowedPath(),e.allowedListOfApi=e.createAllowedApiList(),e.AllowedPgmQueryStringParametersList=e.createAllowedPgmParamters(),e}())},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c}));var r=n(1),i="https://outlook.office.com",o="OPX",a=[i,"https://to-do.office.com","https://outlook-sdf.office.com"];function s(e){var t=i;return null!=e&&function(e){return a.indexOf(e)>=0}(e)&&(t=e),t}function u(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function c(){var e="hiddenOpxContainer",t=document.getElementById(e);if(!t){var n=Object(r.g)();if(n){var i=document.getElementById(n.top);i&&((t=document.createElement("div")).id=e,t.style.display="none",i.appendChild(t))}}return t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r,i,o,a,s,u=n(0),c=n(61);i=r||(r={}),o=[],a={},i.setTenantTokens=function(e,t){var n=e.split(".");n.length<2||"Office"!==n[0]||"."===e[e.length-1]?Object(c.b)(0,0,(function(){return"Invalid namespace: "+e})):(o.push({namespace:e,telemetryProperties:t}),o.sort((function(e,t){return t.namespace.length-e.namespace.length})),a={})},i.getTenantTokens=function(e){if(e in a)return a[e];for(var t=0;t<o.length;t++){var n=o[t].namespace;if(e.substring(0,n.length+1)===n+".")return a[e]=o[t].telemetryProperties,a[e]}},i.clear=function(){o=[],a={}},function(e){var t=9007199254740991,n=/^[A-Z][a-zA-Z0-9]*$/,r=/^[a-zA-Z0-9_\.]*$/;function i(e){return void 0!==e&&r.test(e)}function o(e){if(!((t=e.name)&&i(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;2===e.dataType&&a(e.value)}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>t)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){var t=98;if(!e||e.length>t)return!1;var r=e.split("."),i=r[r.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(r)&&(o=i,void 0!==o&&n.test(o));var o}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!i(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)o(e.dataFields[t])},e.validateInt=a}(s||(s={}));var l=n(18);function d(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return t.telemetryProperties=e.telemetryProperties?Object(u.__assign)({},e.telemetryProperties):{},e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t.timestamp=e.timestamp,t}var p=function(){function e(e,t,n){var r,i;this.telemetrySinks=[],this.persistentDataFields=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(u.__assign)(Object(u.__assign)({},e.getConfig()),this.config)),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.sendTelemetryEvent=function(e){if(e.telemetryProperties&&(e.telemetryProperties.customerContentVersion||e.telemetryProperties.customerContentType))Object(c.b)(0,0,(function(){return"Customer content"}));else{var t=d(e);if(!t.telemetryProperties.ariaTenantToken||!t.telemetryProperties.nexusTenantToken){var n=r.getTenantTokens(e.eventName);if(!n)return void Object(c.b)(0,0,(function(){return"No tenant token: "+e.eventName}));t.telemetryProperties.ariaTenantToken=n.ariaTenantToken,t.telemetryProperties.nexusTenantToken=n.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=d(e);return(!t.telemetryProperties.customerContentVersion||t.telemetryProperties.customerContentVersion>1)&&(t.telemetryProperties.customerContentVersion=1),t.telemetryProperties.ariaTenantToken=void 0,t.telemetryProperties.nexusTenantToken=void 0,t.dataFields.push(Object(l.b)("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void Object(c.b)(1,0,(function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e)}catch(e){return void Object(c.a)(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){e.telemetryProperties&&e.telemetryProperties.customerContentVersion&&e.telemetryProperties.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n;e.dataFields&&(null===(n=e.dataFields)||void 0===n||n.unshift(Object(l.c)("OTelJS.Version","4.2.0")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.config.disableValidation||s.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.setTenantToken=function(e,t,n){r.setTenantTokens(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return d(e)},e.prototype.getConfig=function(){return this.config},e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(0),o=n(6),a=n(5),s='{ "kty": "oct", "k": "{0}", "extractable": true }',u=void 0!==typeof btoa,c=function(){function e(){}return e.loadCryptoModule=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,new Promise((function(e){void 0!==r?e():null!=window.crypto?(r=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(null,251,7)).then((function(t){r=t,e()}))}))]}))}))},e.computeSHA256=function(t,n){return void 0===n&&(n=!0),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.loadCryptoModule()];case 1:return i.sent(),[2,new Promise((function(i,o){try{var a=e.textToUInt8Array(t,n),s=r.subtle.digest({name:"SHA-256"},a);s.then((function(t){if(e.verifyResult(t,o)){var n=Array.prototype.map.call(new Uint8Array(t),(function(e){return("00"+e.toString(16)).slice(-2)})).join("");i(e.toBase64(n))}}),(function(t){e.verifyResult(t,o)&&o(t.toString())}))}catch(e){o(e.toString())}}))]}}))}))},e.encryptAES=function(t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.loadCryptoModule()];case 1:return i.sent(),[2,new Promise((function(i,u){try{var c=Object(o.b)(s,e.base64ToBase64Url(t)),l=r.subtle.importKey("jwk",JSON.parse(c),{name:"AES-CBC"},!0,["encrypt","decrypt"]);l.then((function(t){try{var o=t,s=e.textToUInt8Array(e.base64ToString(n),!1),c=e.textToUInt8Array(a,!0),l={name:"AES-CBC",iv:s},d=r.subtle.encrypt(l,o,c);d.then((function(t){try{e.verifyResult(t,u)&&i(e.toBase64(e.bytesToText(t,!1)))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t)}))}catch(e){u(e.toString())}}))]}}))}))},e.decryptAES=function(t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.loadCryptoModule()];case 1:return i.sent(),[2,new Promise((function(i,u){try{var c=Object(o.b)(s,e.base64ToBase64Url(t)),l=r.subtle.importKey("jwk",JSON.parse(c),{name:"AES-CBC"},!0,["encrypt","decrypt"]);l.then((function(t){try{var o=t,s=e.textToUInt8Array(e.base64ToString(n),!1),c=e.textToUInt8Array(e.base64ToString(a),!1),l={name:"AES-CBC",iv:s},d=r.subtle.decrypt(l,o,c);d.then((function(t){try{e.verifyResult(t,u)&&i(e.bytesToText(t,!0))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}))]}}))}))},e.textToUInt8Array=function(e,t){e=t?encodeURI(e):e;for(var n=[],r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new Uint8Array(n)},e.bytesToText=function(e,t){var n=Object(a.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n},e.base64ToBase64Url=function(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")},e.verifyResult=function(e,t){return null!=e||(t("result undefined"),!1)},e.base64ToString=function(e){if(!u)return r.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)},e.toBase64=function(e,t){if(!u)return r.toBase64(e);var n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE",e}()},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTTransmissionManagerCore.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=n(189),i=n(58),o=n(206),a=n(191),s=n(118),u=n(194),c=n(75),l="awt_stats",d=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize((function(e,n){if(t._config.canSendStatEvent(l)){var r=new s.default(l);for(var o in r.setEventPriority(i.AWTEventPriority.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(o)&&r.setProperty(o,e[o].toString());u.default.getLogger(c.StatsApiKey).logEvent(r)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var i=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(i)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===i.AWTEventPriority.Immediate_sync&&(e.priority=i.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=r.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=i.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=i.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=i.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[r.AWT_REAL_TIME]=[4,2,1],this._profiles[r.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[r.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=r.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=d},,,,,function(e,t,n){"use strict";var r,i,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(r||(r={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(i||(i={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(o||(o={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var r,i=n(0),o=n(4),a=n(1),s=n(17),u=n(3),c=n(47),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.getMruDocuments=function(e,t){var n=this;return new Promise((function(r,i){var s=Object(u.C)("{0}?rs={1}&show={2}&sort=date",n.SuiteApi.Configuration.MruOauthEndpointUrl,n.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(s+="&apps="+t);var c={method:o.b.GET,resource:n.SuiteApi.Configuration.MruOauthResourceUrl,url:s};n.SuiteApi.Service.callEndpointWithOauthToken(c).then((function(e){Object(a.f)().perfMarker("shell_mru_fetch_complete"),r(e)})).catch((function(e){o.h.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,i)}))}))},t.prototype.prefetchMruAccessToken=function(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)},t.prototype.initializeGraphApi=function(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)},t.prototype.createNewDocument=function(e){var t=this,n={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},r={method:o.b.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n)};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(r).then(e).catch((function(e){o.h.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,n)}))}))},t.prototype.getDocumentUrl=function(e,t){var n,r=this;return new Promise((function(i){null!=e?r.createNewDocument(e).then((function(e){null!=e&&null!=e.webUrl?-1===(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf("action=editnew")&&(n=Object(u.q)(n,"action","editnew")):n=t,i(n)})):i(n=t)}))},t}(c.a),d=n(152),p=n(70),f=n(5);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(r||(r={}));var h=n(94),g=function(e){function t(){var t=e.call(this)||this;return t.opxFrameToComponentMap={},t.opxComponentData={},t.opxTimers={},t.opxOutstandingOpxQueries={},t.currentOpxQueryID=0,t.OpxInitializationTimeout=15e3,t.handleIncomingOpxMessage=function(e){var n,r=!1,i=t.opxFrameToComponentMap[e.instanceId];if(null!=i)switch(e.notificationType){case p.a.LifeCycle:switch(e.asyncContext){case p.b.GetConfig:var o=null===(n=t.opxComponentData[i])||void 0===n?void 0:n.opxComponentConfiguration;null!=o&&(r=t.onGetConfigRequest(e.instanceId,o));break;case p.b.RefreshToken:r=t.onRefreshTokenRequest(e.instanceId);break;case p.b.Closed:r=t.onOpxClosedRequest(i);break;case p.b.PageReady:case p.b.FatalError:r=t.onReadyOrError(i,e)}break;case p.a.ChallengeToken:r=t.onRefreshTokenRequest(e.instanceId);break;case p.a.DataProviderResponseNotification:var a=e.asyncContext;if(a.success){var s=t.opxOutstandingOpxQueries[e.instanceId];if(s)Object.keys(s).filter((function(e){return s[e].queryType===a.type})).forEach((function(e){s[e].onQueryComplete(a.response)}))}}return r},t.validateIncomingOpxMessage=function(e){return e.apiName===h.a},t.validateIncomingOpxMessageOrigin=function(e){return e.toLowerCase()===t.SuiteApi.Configuration.TokenFactoryIframeOrigin},t.onGetConfigRequest=function(e,n){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:r.UpdateConfig,asyncResult:n}}),!0},t.onRefreshTokenRequest=function(e){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:r.UpdateToken,asyncResult:null}}),!0},t.onOpxClosedRequest=function(e){var t=null;switch(e){case d.a.MyDay:t="MyDay"}return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},t.onReadyOrError=function(e,n){var r=t.opxComponentData[e];if(!r)throw new Error("Message received for an OPX component that no longer exists.");if(r.initCompleteCallback&&!r.initializationResult){var i=n.asyncContext===p.b.PageReady?0:5;r.initCompleteCallback(i)}else r.messageListener&&r.messageListener(n);return!0},t}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()},t.prototype.prefetchOpxAccessToken=function(e){var t=this;this.opxSystemConfigurationPromise.then((function(n){null==t.opxSystemConfiguration&&(t.opxSystemConfiguration=n);var r=t.opxSystemConfiguration.OpxEndpoints[e];void 0!==r&&t.SuiteApi.Service.prefetchAccessToken(r.OpxOAuthResourceUrl,r.OpxOAuthResourceUrl)})).catch((function(e){Object(a.f)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))},t.prototype.initializeOpx=function(e,t,n,r){var i=this,o=document.getElementById(t);if(!o)return Promise.resolve(2);this.prefetchOpxAccessToken(d.a.MyDay);var s=new Promise((function(s){i.opxSystemConfigurationPromise.then((function(u){null==i.opxSystemConfiguration&&(i.opxSystemConfiguration=u),i.opxFrameToComponentMap[t]=e,i.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:function(t){switch(t){case 0:case 5:i.opxComponentData[e].initializationResult=t}s(t)},messageListener:r},o.onerror=function(e,t,n,r,i){var o=JSON.stringify(null!=e?e:"Script error");Object(a.f)().exception(o,6,i,t,n,r),s(3)},o.src=i.createOpxFrameUrl(e,t)})).catch((function(){s(1)}))}));return Promise.race([new Promise((function(t){s.then((function(n){clearTimeout(i.opxTimers[e]),t(n)}))})),new Promise((function(t){clearTimeout(i.opxTimers[e]),i.opxTimers[e]=window.setTimeout((function(){clearTimeout(i.opxTimers[e]),t(4)}),i.OpxInitializationTimeout)}))])},t.prototype.changeTheme=function(e,t,n){var i=this.opxComponentData[e];if(0!==i.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");var o=i.frameID,a={UseDarkMode:n};n?a.DarkPalette=t:a.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:o,message:{eventType:r.ChangeTheme,asyncResult:a}})},t.prototype.updateData=function(e,t,n){var i=this.opxComponentData[e];if(!i||0!==i.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));var o={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:i.frameID,message:{eventType:r.UpdateData,asyncResult:o}})},t.prototype.createOpxFrameUrl=function(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return""+this.opxSystemConfiguration.OpxRootUrlLowerCase+this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl+"?hostApp=o365shell&frameName="+f.TokenFactoryIFrameID+"&opxInstanceId="+t},t.prototype.initializeOpxOrchestrator=function(){var e=this;return new Promise((function(t,n){e.fetchSystemConfiguration().then((function(r){e.SuiteApi.Service.registerOpxHost(e.OpxInitializationTimeout).then((function(){e.registerOpxMessageListener(),t(r)})).catch((function(e){Object(a.f)().exception("OPX_RegisterOpxHost_Failure",6,e),n(e)}))})).catch((function(e){Object(a.f)().exception("OPX_FetchSystemConfiguration_Failure",6,e),n(e)}))}))},t.prototype.fetchSystemConfiguration=function(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:"/calendar/opxdeeplink/myday",OpxOAuthResourceUrl:h.b},ExchangeData:{OpxEndpointUrl:"/calendar/opxdeeplink/dataprovider",OpxOAuthResourceUrl:h.b}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})},t.prototype.registerOpxMessageListener=function(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})},t.prototype.queryOpxIframe=function(e,t){var n=this;void 0===t&&(t=5e3);var r=e.message.asyncResult;return new Promise((function(i,o){n.SuiteApi.Service.callOpxIframe(e),null==n.opxOutstandingOpxQueries[e.targetOpxInstance]&&(n.opxOutstandingOpxQueries[e.targetOpxInstance]={});var a=n.currentOpxQueryID++,s=n.opxOutstandingOpxQueries[e.targetOpxInstance],u=setTimeout((function(){delete s[a],o(new Error("Query timeout."))}),t);s[a]={id:a,opxFrameID:e.targetOpxInstance,queryType:r.type,onQueryComplete:function(e){clearTimeout(u),delete s[a],i(e)}}}))},t}(c.a);var m=n(83),v=n(6),y=n(11),S=n(73),b=function(){function e(e){this.userTheme=e}return e.prototype.GetUserThemeId=function(){return Object(a.i)().getCurrentThemeId()},e.prototype.ChangeTheme=function(e){},e.prototype.SaveTheme=function(e,t){var n=this;return new Promise((function(r,i){n.userTheme.setUserTheme(e,t).then((function(e){e.O365Success||e.OwaSuccess?r():i(new Error("SaveThemeFailure"))})).catch(i)}))},e.prototype.SaveDarkTheme=function(e){var t=this;return new Promise((function(n,r){t.userTheme.setUserThemeSettingsInWCSS(e).then((function(e){e.O365Success||e.OwaSuccess?n():r(new Error("SaveThemeFailure"))})).catch(r)}))},e.prototype.GetModeLogo=function(e){var t=this;return new Promise((function(n,r){t.userTheme.getModeLogo(e).then((function(e){if(e){var t="";e.HasTenantLogo&&(e.LogoUrl?t=e.LogoUrl:e.LogoData&&(t=e.LogoData));var i={isLogoVisible:!0,logoUrl:t,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return n(i)}return r(new Error("GetModeLogoFailure"))})).catch(r)}))},e.prototype.SetUserThemesData=function(e){Object(u.D)().dispatch(Object(u.P)(e))},e}(),T="{0}/api/settings/darkmode",C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){var e=this;Object(a.i)().setUserThemesHandler(new b(this)),this.SuiteApi.User.IsInitialized&&this.SuiteApi.Configuration.IsConsumer&&Object(a.c)().subscribe("ConsumerShellDataAvailable",(function(t){var n=t.ShellClientData.ThemeData.ThemeSettings.ThemeID;e.SuiteApi.User.getOwaUserConfiguration().then((function(t){t&&(null!=n&&n===t.UserOptions.ThemeStorageId||e.setUserThemeInWCSS(""===t.UserOptions.ThemeStorageId?"Base":t.UserOptions.ThemeStorageId,!0))})).catch((function(){}))}),!0)},t.prototype.loadUserThemeChoices=function(){return this.checkInitialized(),Object(a.i)().loadAllThemeJson()},t.prototype.setUserTheme=function(e,t){var n=this;this.checkInitialized(),this.clearUserThemeCache();var r,i=e=e.replace(/^\w/,(function(e){return e.toUpperCase()}));return e.toLowerCase()===y.DefaultThemeId&&t&&(i=y.BasePreferOfficeThemeIdOWA),r=m.b((function(){return n.setUserThemeInWCSS(e,e.toLowerCase()===y.DefaultThemeId&&t)}),2),this.SuiteApi.Configuration.IsPwa?r:r.then((function(){return m.b((function(){return n.setUserThemeInExchange(i,!0)}),2)}))},t.prototype.setUserThemeInWCSS=function(e,t){var n=this;return new Promise((function(r,i){var a={url:Object(v.b)(n.SuiteApi.Configuration.IsConsumer?T:"{0}/api/settings/theme",n.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:n.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.b.PUT,headers:S.b,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};n.SuiteApi.Service.callEndpointWithOauthToken(a).then((function(e){r({OwaSuccess:void 0,O365Success:!0})})).catch((function(e){o.h.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,i)}))}))},t.prototype.setUserThemeSettingsInWCSS=function(e){var t=this;return new Promise((function(n,r){var i={url:Object(v.b)(T,t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.b.PUT,headers:S.b,body:JSON.stringify({IsDarkmode:e})};t.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){n({O365Success:!0})})).catch((function(e){o.h.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,r)}))}))},t.prototype.getModeLogo=function(e){var t=this;return new Promise((function(n,r){var i={url:Object(v.b)("{0}/api/theme/tenant?useDarkMode="+e,t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.b.GET,headers:S.b};t.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){n(e)})).catch((function(e){o.h.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,r)}))}))},t.prototype.setUserThemeInExchange=function(e,t){var n=this;return new Promise((function(r,i){Object(a.i)().getUserThemeByID(e).then((function(a){(n.SuiteApi.Configuration.OpxEnabled&&n.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!n.SuiteApi.Configuration.IsOwa?n.setUserThemeViaOpx(e,t):n.setUserThemeViaSuiteServiceProxy(e,t,a)).then((function(e){r({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((function(e){o.h.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,i)}))}))}))},t.prototype.setUserThemeViaOpx=function(e,t){return n.e("exchangedata").then(n.bind(null,885)).then((function(n){return n.setUserTheme(e,t)}))},t.prototype.setUserThemeViaSuiteServiceProxy=function(e,t,n){var r=this,o={ThemeId:e,SkipO365Call:t};n&&e!==y.BasePreferOfficeThemeIdOWA&&(o.UserThemeJson=JSON.stringify(n));var a,s={request:(a=o,Object(i.__assign)({__type:"SetUserThemeRequest:#Exchange"},a))};return new Promise((function(e,t){r.SuiteApi.User.getOwaUserConfiguration().then((function(t){var n=r.SuiteApi.Service.callOwaIframeAction("SetUserTheme",s);e(n)})).catch((function(e){t(e)}))}))},t.prototype.clearUserThemeCache=function(){var e=this;this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((function(t){if(null!=t.WorkloadUrl&&t.WorkloadUrl.length>0&&(!t.NoRequestInSameWorkload||e.SuiteApi.Configuration.WorkloadId.toLowerCase()!==t.WorkloadId.toLowerCase())&&null!=t.RequestType&&t.RequestType.length>0&&("img"===t.RequestType.toLowerCase()||"iframe"===t.RequestType.toLowerCase())){var n=document.createElement(t.RequestType);n.setAttribute("src",t.WorkloadUrl),n.setAttribute("style","display:none"),"iframe"===t.RequestType.toLowerCase()&&(n.addEventListener("load",(function(){return document.body.removeChild(n)})),document.body.appendChild(n))}}))},t}(c.a);function _(e){return Object(i.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function O(e){return Object(i.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var I={baseUrl:"/owa",isFeatureEnabled:function(e){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(r,i){n.taskList[t].unshift({func:e,resolve:r,reject:i}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),r=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,r.func().then((function(t){r.resolve(t),e.onTaskComplete()})).catch((function(t){r.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},w=I;function A(){var e,t=w.timezone;return _(t?{RequestServerVersion:"V2018_01_08",TimeZoneContext:O({TimeZoneDefinition:(e={Id:t},Object(i.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},e))})}:{RequestServerVersion:"V2018_01_08"})}var D=n(187),x=null,P=o.e.SuiteServiceApiRelativePath+"LanguageTimezone",E=null,k=null,R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){null!=(x=this.SuiteApi.Configuration.GraphOauthResourceUrl)&&(x=Object(u.C)("{0}/{1}",x,"v1.0/me"),E=Object(u.C)("{0}/{1}",x,"outlook/supportedLanguages"),k=Object(u.C)("{0}/{1}",x,"outlook/supportedTimeZones"))},t.prototype.getLanguageAndTimeZone=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()},t.prototype.getLanguageChoices=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()},t.prototype.getTimeZoneChoices=function(){var e=this;return new Promise((function(t,n){var r={url:k,method:o.b.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){t(e.value)})).catch((function(e){o.h.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,n)}))}))},t.prototype.getDateTimeFormats=function(e){var t=this;return new Promise((function(n,r){var i={url:Object(u.C)("{0}/api/settings/datetimeformats?cultureName={1}",t.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.b.GET,headers:S.b};t.SuiteApi.Service.callEndpointWithOauthToken(i).then(n).catch((function(e){o.h.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,r)}))}))},t.prototype.setLanguageAndTimeZone=function(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)},t.prototype.setSuiteLanguage=function(e){var t=this;return new Promise((function(n,r){var i={url:x,method:o.b.PATCH,headers:S.a,body:JSON.stringify({preferredLanguage:e})};t.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){n()})).catch((function(e){o.h.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,r)}))}))},t.prototype.setOwaLanguageAndTimeZone=function(e){var t=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(n,r){e.CurrentCultureLcid=null;var a,s={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},u=(a={Header:A(),Options:s},Object(i.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},a));t.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",u,null).then((function(r){t.setSuiteLanguage(e.CurrentCultureName),n()})).catch((function(e){o.h.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,r)}))})):new Promise((function(n,r){e.CurrentCultureLcid=null,t.SuiteApi.Service.callOwaIframeResourceUrl(P,e,o.b.PUT).then(n).catch((function(e){o.h.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,r)}))}))},t.prototype.getSuiteLanguageChoices=function(){return new Promise((function(e,t){D?e(D):t(new Error("Supported languages not found"))}))},t.prototype.getOwaLanguageChoices=function(){var e=this;return new Promise((function(t,n){var r={url:E,method:o.b.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){var n=e.value.map((function(e){return{Locale:e.locale,DisplayName:e.displayName}}));t(n)})).catch((function(e){o.h.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,n)}))}))},t.prototype.getSuiteLanguage=function(){var e=this;return new Promise((function(t,n){var r={url:x,method:o.b.GET};e.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){var n={CurrentCultureName:e.preferredLanguage};t(n)})).catch((function(e){o.h.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,n)}))}))},t.prototype.getOwaLanguageAndTimeZone=function(){var e=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(t,n){var r,a=(r={Header:A(),VerifyDefaultFolderNameLanguage:!1},Object(i.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},r));e.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",a,null).then((function(e){var n=e.Options,r={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};t(r)})).catch((function(e){o.h.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise((function(t,n){e.SuiteApi.Service.callOwaIframeResourceUrl(P,null,o.b.GET).then((function(e){var n=e.Body.Configuration;t(n)})).catch((function(e){o.h.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,n)}))}))},t}(c.a),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new C:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new R:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)},t.prototype.loadUserThemeChoices=function(){return this.userTheme.loadUserThemeChoices()},t.prototype.setUserTheme=function(e,t){return this.userTheme.setUserTheme(e,t)},t.prototype.getLanguageAndTimeZone=function(){return this.languageAndTimeZone.getLanguageAndTimeZone()},t.prototype.getLanguageChoices=function(){return this.languageAndTimeZone.getLanguageChoices()},t.prototype.getTimeZoneChoices=function(){return this.languageAndTimeZone.getTimeZoneChoices()},t.prototype.getDateTimeFormats=function(e){return this.languageAndTimeZone.getDateTimeFormats(e)},t.prototype.setLanguageAndTimeZone=function(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)},t}(c.a),N=n(69),M="/v1.0/me/photo/$value",U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.initializeComponent=function(){},Object.defineProperty(t.prototype,"OwaUserConfig",{get:function(){return this.userConfig},enumerable:!0,configurable:!0}),t.prototype.getOwaUserConfiguration=function(){null==this.userConfigPromise&&(this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.userConfigPromise=this.getOwaUserConfigurationViaOpx():this.userConfigPromise=this.getOwaUserConfigurationViaSuiteServiceProxy());var e=window.setTimeout((function(){return Object(a.f)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)}),15e3);return this.userConfigPromise.then((function(){return window.clearTimeout(e)})).catch((function(){return window.clearTimeout(e)})),this.userConfigPromise},t.prototype.getOwaUserConfigurationViaOpx=function(){return n.e("exchangedata").then(n.bind(null,885)).then((function(e){return e.getOwaUserConfig()})).catch((function(e){throw Object(a.f)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))},t.prototype.getOwaUserConfigurationViaSuiteServiceProxy=function(){var e=this;return new Promise((function(t,n){var r={command:o.c.OwaUserConfig,timeout:1e4},i=function(){e.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((function(r){if(e.userConfig=r,null!=e.userConfig&&""!==e.userConfig)e.onOwaUserConfigSucceeded(t);else{var i=new o.a("null OwaUserConfiguration received from server");Object(a.f)().exception("User_GetOwaUserConfiguration_NullConfig",4,i),n(i)}})).catch((function(e){o.h.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,n)}))};if(e.SuiteApi.Configuration.IsOwa)i();else{r.success=function(n){e.userConfig=n.responseObject,"GetOwaUserConfiguration"===o.i.Instance.configuration.StartupActionName&&e.SuiteApi.Service.setStartupActionCompleted(),e.onOwaUserConfigSucceeded(t)},r.error=function(e,t,n){Object(a.f)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new o.a(n,t)),i()};var s=o.d.OwaInstance;null==s?n(new o.a("OwaIframe",-1011)):s.getOwaUserConfiguration(r)}}))},t.prototype.getPhotoFromGraph=function(){var e=this,t={method:o.b.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+M,binaryStringResponseBody:!0};return new Promise((function(n,r){e.SuiteApi.Service.callEndpointWithOauthToken(t).then((function(e){n(window.btoa(e))})).catch((function(e){404===e.errorInfo.HttpStatus?n(""):o.h.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,e,r)}))}))},t.prototype.prefetchGraphToken=function(){var e=this;return new Promise((function(t,n){null!=e.SuiteApi.Configuration.GraphOauthResourceUrl?e.SuiteApi.Service.prefetchAccessToken(e.SuiteApi.Configuration.GraphOauthResourceUrl+M,e.SuiteApi.Configuration.GraphOauthResourceUrl).then(t).catch(n):n()}))},t.prototype.uploadPhotoToGraph=function(e){var t=this,n=e.split(","),r=n[0].split(":")[1].split(";")[0],i=n[1],a={method:o.b.PUT,headers:{"Content-Type":r},timeout:7e3,body:window.atob(i),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+M,binaryStringRequestBody:!0};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(a).then(e).catch((function(e){o.h.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,n)}))}))},t.prototype.onOwaUserConfigSucceeded=function(e){null!=this.userConfig.SessionSettings?o.i.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:Object(a.f)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)},t}(c.a),F=function(){function e(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),o.i.Initialize(Object(i.__assign)(Object(i.__assign)({},e),{StartupActionName:this.StartupActionName})),this.service=o.f.Instance,this.storage=null==e.IStorageOverride?new N.a:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new N.d:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new U:e.IUserOverride,this.settings=null==e.ISettingsOverride?new L:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new l:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=o.f.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(o.g.Brs):e.IsPwa&&this.service.blockSuiteServiceCalls(o.g.Pwa):this.service.blockSuiteServiceCalls(o.g.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}return Object.defineProperty(e.prototype,"Configuration",{get:function(){return this.configuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Service",{get:function(){return this.service},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"User",{get:function(){return this.user},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Storage",{get:function(){return this.storage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WebShellStorage",{get:function(){return this.webShellStorage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DocumentsModule",{get:function(){return this.documentsModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OwaPoweredExperiences",{get:function(){return this.owaPoweredExperiences},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),e.CreateInstance=function(t){if(null!=this.instance){var n=new Error("Instance already exists.");throw Object(a.f)().exception("SuiteApi_InstanceAlreadyExists",6,n),n}return this.instance=new e(t),this.instance},e.isInitialized=function(){return null!=this.instance},Object.defineProperty(e,"Instance",{get:function(){if(null==e.instance)throw new Error("Instance not yet created.");return e.instance},enumerable:!0,configurable:!0}),e.clearInstanceForTesting=function(){o.i.isUnitTestMode&&(e.instance=null,o.d.resetAllInstancesForTesting())},e.prototype.validateConfiguration=function(e){s.throwOnNullOrUndefined(e,"configuration"),s.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")},e.prototype.owaUrlSpecialHandling=function(e){if(e.IsOwa){var t=e.SuiteServiceUrl.toLowerCase(),n=o.e.getUrlDomainPart(t),r=o.e.getUrlDomainPart(window.location.href).toLowerCase();n!==r&&(e.SuiteServiceUrl=t.replace(n,r))}},e}()},function(e,t,n){"use strict";function r(e){return null!=e&&0!==e.length&&e.some((function(e){return i(e)}))}function i(e){return!(null==e||o(e.Id)||o(e.Text)||o(e.Url)&&null==e.Action)}function o(e){return""===e||null==e}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var r="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",i="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",o="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",a="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED"},function(e,t,n){var r=n(248);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"o",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"n",(function(){return l})),n.d(t,"q",(function(){return d})),n.d(t,"r",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"m",(function(){return m})),n.d(t,"p",(function(){return v})),n.d(t,"j",(function(){return y})),n.d(t,"b",(function(){return S})),n.d(t,"h",(function(){return b})),n.d(t,"d",(function(){return T}));var r=n(21);function i(e){return{type:r.a,newWorkloadSettingLink:e}}function o(e){return{type:r.i,settingLinkID:e}}function a(e){return{type:r.o,newWorkloadSettingsLinks:e}}function s(e){return{type:r.d,cardData:e}}function u(e){return{type:r.f,selectedLanguage:e}}function c(e){return{type:r.e,languageChoices:e}}function l(e){return{type:r.n,selectedTimeZone:e}}function d(e,t,n){return{type:r.q,timeZoneChoice:e,dateFormatChoice:t,timeFormatChoice:n}}function p(e){return{type:r.r,timeZoneChoices:e}}function f(e){return{type:r.l,selectedLanguage:e}}function h(e){return{type:r.k,selectedDateFormat:e}}function g(e){return{type:r.c,dateFormatChoices:e}}function m(e){return{type:r.m,selectedTimeFormat:e}}function v(e){return{type:r.p,timeFormatChoices:e}}function y(){return{type:r.j}}function S(){return{type:r.b}}function b(e){return{type:r.g,cardId:e}}function T(e){return{type:r.h,isExpanded:e}}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(1),i=240;function o(){var e=Object(r.g)(),t=e&&e.shyHeaderActivationHeight?e.shyHeaderActivationHeight:i;return window.matchMedia("(max-height: "+t+"px)").matches}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTEventProperties.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var r=n(75),i=n(58),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified);var o={value:t,type:n,pii:i.AWTPiiKind.NotSet,cc:i.AWTCustomerContentKind.NotSet};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:n,cc:i.AWTCustomerContentKind.NotSet};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:i.AWTPiiKind.NotSet,cc:n};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},function(e,t,n){"use strict";
/**
* microsoft.bond.primitives.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=i;var o=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),i=n(67),o=n(22),a=n(20),s=n(98),u="$",c="CurrentUserId",l=function(){function e(){}return e.processRequest=function(t,n){var u,l,d={},p=Object(i.a)("SuiteServiceProxyKey");if(r.isNullOrEmptyString(p)){if(p=Object(i.a)("ClientStorageCookie"),r.isNullOrEmptyString(p))throw new o.a(a.k,-2007);p=decodeURIComponent(p)}var f=p.split("&");if(2!==f.length)throw new o.a(a.k,-2007);if(u=f[0],l=f[1],r.isNullOrEmptyString(t.UserId))throw new o.a(a.k,-2004);var h=window.sessionStorage;if(null==h)throw new o.a(a.k,-2005);try{var g=t.UserId;s.a.computeSHA256(g).then((function(r){var i=h.getItem(c);null!=i&&r!==i&&e.doClear({Clear:!0},d,h),h.setItem(c,r),e.doClear(t,d,h),e.doClearAll(t,d,h),e.doDeletes(t,d,h),e.doWritesAndReads(t,u,l,h,d,n)})).catch((function(e){var t=null==e?a.k:e;d.ResetError=new o.a(t,-2008),n(d)}))}catch(e){d.ResetError=e,n(d)}},e.doClear=function(t,n,i){try{if(!0===t.Clear){var o=Object.keys(i).filter((function(e){return!r.startsWith(e,"adal.")}));e.doDeletes({Deletes:o},n,i)}}catch(e){n.ClearError=e}},e.doClearAll=function(t,n,r){try{if(!0===t.ClearAll){var i=Object.keys(r);e.doDeletes({Deletes:i},n,r)}}catch(e){n.ClearError=e}},e.doDeletes=function(e,t,n){try{if(null!=e.Deletes)for(var r=0,i=e.Deletes;r<i.length;r++){var o=i[r];n.removeItem(o)}}catch(e){t.DeleteError=e}},e.doWritesAndReads=function(t,n,r,i,o,a){try{null!=t.Writes?e.encryptWrites(n,r,t.Writes,0,i,(function(){e.doReads(t,n,r,i,o,a)}),(function(s){o.WriteError=s,e.doReads(t,n,r,i,o,a)})):e.doReads(t,n,r,i,o,a)}catch(s){o.WriteError=s,e.doReads(t,n,r,i,o,a)}},e.doReads=function(t,n,r,i,o,a){try{if(null!=t.Reads){e.decryptReads(n,r,t.Reads,0,{},i,(function(e){o.Reads=e,a(o)}),(function(e){o.ReadError=e,a(o)}))}}catch(e){o.ReadError=e,a(o)}},e.encryptWrites=function(t,n,r,i,c,l,d){null!=r&&i<r.length?null==t?(c.setItem(r[i].Key,r[i].Value),e.encryptWrites(t,n,r,i+1,c,l,d)):s.a.encryptAES(t,n,u+r[i].Value+u).then((function(o){c.setItem(r[i].Key,o),e.encryptWrites(t,n,r,i+1,c,l,d)})).catch((function(e){var t=null==e?a.k:e;d(new o.a(t,-2009))})):l()},e.decryptReads=function(t,n,i,a,c,l,d,p){if(null!=i&&a<i.length){var f=i[a],h=l.getItem(f);null===h?e.decryptReads(t,n,i,a+1,c,l,d,p):(null===t&&(c[f]=h,e.decryptReads(t,n,i,a+1,c,l,d,p)),s.a.decryptAES(t,n,h).then((function(o){null==o||!r.startsWith(o,u)||!r.endsWith(o,u)||o.length<2?e.doClear({Clear:!0},{},l):c[f]=o.substr(1,o.length-2),e.decryptReads(t,n,i,a+1,c,l,d,p)})).catch((function(r){"OperationError"===r?(e.doClear({Clear:!0},{},l),e.decryptReads(t,n,i,a+1,c,l,d,p)):p(new o.a(r))})))}else d(c)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(30),o=n(109);var a,s=n(8),u={default:[s.a.NavBarDataLinks,s.a.Theme,s.a.LanguageAndRegion,s.a.DarkMode,s.a.ChangePassword,s.a.ContactPreferences],iwapp:[s.a.NavBarDataLinks,s.a.Theme,s.a.LanguageAndRegion,s.a.DarkMode,s.a.ChangePassword,s.a.ContactPreferences],exchange:[],officepwa:[s.a.Theme,s.a.DarkMode,s.a.AboutBase,s.a.NavBarDataLinks],botdesigner:[s.a.NavBarDataLinks,s.a.Theme,s.a.ChangePassword,s.a.ContactPreferences],dynamics365:[s.a.NavBarDataLinks,s.a.Theme,s.a.LanguageAndRegion,s.a.ChangePassword,s.a.ContactPreferences],dynamics365ci:[s.a.NavBarDataLinks,s.a.Theme,s.a.ChangePassword,s.a.ContactPreferences],dynamics365fraudprotection:[s.a.NavBarDataLinks,s.a.Theme,s.a.ChangePassword,s.a.ContactPreferences],dynamics365powerplatform:[s.a.NavBarDataLinks,s.a.Theme,s.a.ChangePassword,s.a.ContactPreferences],dynamics365productinsights:[s.a.NavBarDataLinks,s.a.ChangePassword,s.a.ContactPreferences],adminportal:[s.a.NavBarDataLinks,s.a.Theme,s.a.LanguageAndRegion,s.a.ChangePassword,s.a.ContactPreferences,s.a.CPNIPin],flow:[s.a.NavBarDataLinks,s.a.Theme,s.a.ChangePassword,s.a.ContactPreferences]},c=n(7),l=((a={})[s.a.NavBarDataLinks]={EnableConsumer:!0},a[s.a.Theme]={Title:c.a.Themes,EnableConsumer:!0},a[s.a.ChangePassword]={Title:c.a.Password,Description:c.a.PasswordDescription,EnableConsumer:!1,ChangePasswordCardData:[{WorkloadId:"dynamics365businesscentral",QueryStringData:[{Key:"ru",Value:"https://businesscentral.dynamics.com?redirectedfromsignup=1"}]}]},a[s.a.ContactPreferences]={Title:c.a.ContactPreferences,Description:c.a.ContactPreferencesDescription,EnableConsumer:!1},a[s.a.LanguageAndRegion]={Title:c.a.LanguageAndTimeZone,Description:c.a.LanguageAndTimeZoneDescription,EnableConsumer:!1},a[s.a.AboutBase]={Title:c.a.About,EnableConsumer:!0,ChildCardIds:[s.a.About]},a[s.a.About]={Title:c.a.About,EnableConsumer:!0},a[s.a.DarkMode]={Title:c.a.DarkThemeTitle,EnableConsumer:!1},a[s.a.CPNIPin]={Title:c.a.CPNIPinCardTitle,EnableConsumer:!1},a);function d(e,t,n){var a,c,d=((a={})[s.a.LanguageAndRegion]=function(e){return!e.UseSimplifiedLanguageCard&&1==(1&e.UserType)&&!Object(i.b)(e.WorkloadId)}(e),a[s.a.NavBarDataLinks]=function(e){return!Object(o.a)(e)}(n),a[s.a.Theme]=function(e){return!(!e.IsConsumerShell||e.CSSExperiencesEnabled&&e.ConsumerThemingEnabled)}(e),a[s.a.ContactPreferences]=function(e){return!e.ShowContactPreferencesCard}(e),a);c=e.CurrentMainLinkElementID&&"shellofficedotcom"===e.CurrentMainLinkElementID.toLowerCase()?"iwapp":e.CurrentMainLinkElementID&&"shellofficepwa"===e.CurrentMainLinkElementID.toLowerCase()?"officepwa":e.WorkloadId.toLowerCase();var p=null!=t?l[t].ChildCardIds:u[c]?u[c]:u.default,f=e.IsConsumerShell;return p?p.filter((function(t){return!e.IsGuestMode||t===s.a.NavBarDataLinks})).filter((function(e){return!f||l[e].EnableConsumer})).filter((function(e){return!d[e]})).map((function(e){return Object(r.__assign)({Id:e},l[e])})):[]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(1),i=n(17),o=n(6),a=n(22),s=n(99),u=n(5),c=n(39),l=n(45),d=n(12),p=function(){function e(e){this.service=e,this.NumMinutesToADReplication=2}return e.prototype.setTargetServerReceivedTime=function(e){if(!d.a.isUnitTestMode)throw new a.a("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e},e.prototype.beforeSuiteServiceCall=function(t){null!=this.targetServer&&((new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(t[e.TargetServerHeader]=this.targetServer))},e.prototype.afterSuiteServiceSuccess=function(t){null==this.targetServer&&null!=t[e.TargetServerHeader]&&(this.targetServer=t[e.TargetServerHeader],this.targetServerReceivedTime=new Date)},e.prototype.afterSuiteServiceError=function(t,n){null!=t[y.XSuiteError]&&t[y.XSuiteError]===e.ShardNotFoundException?(this.service.blockSuiteServiceCalls(c.a.ShardNotDetected),n(l.convertErrorToException(null,-1010,c.a.ShardNotDetected.toString()))):n(t)},e.TargetServerHeader="X-TARGETSERVER",e.ShardNotFoundException="InvalidOrUnavailableMailboxException",e}(),f=n(65),h=n(72),g=n(144),m=function(){function e(){var e=this;this.handleMessage=function(t){var n=!1;if(null!=t)for(var r=0;!n&&r<e.handlers.length;r++)if(t&&t.data&&t.origin){var i=e.handlers[r];if(i.validateOrigin(t.origin)){var o=t.data;i.validateMessage(o)&&(n=i.handleMessage(o))}}},this.handlers=[],Object(u.ensureAttachMessageListener)(this.handleMessage)}return e.prototype.registerHandler=function(e){this.handlers.push(e)},e}(),v=function(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n},y=function(){function e(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new m}return Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConnectionEstablished",{get:function(){return this.owsStartupActionCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AreSuiteServiceCallsBlocked",{get:function(){return null!=this.suiteServiceCallsBlockedReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShouldQueueOwsCalls",{get:function(){return!this.owsStartupActionCompleted&&!d.a.Instance.configuration.IsOwa},enumerable:!0,configurable:!0}),e.prototype.registerPostMessageHandler=function(e){this.messageDispatcher.registerHandler(e)},e.prototype.setStartupActionCompleted=function(){this.owsStartupActionCompleted=!0;for(var e=0,t=this.queuedCalls;e<t.length;e++){var n=t[e];try{n.RequestExecutor.executeAsync(n.RequestInfo)}catch(e){}}this.queuedCalls=[],this.callStartupCallbacks()},e.setInstanceForTesting=function(e){d.a.isUnitTestMode&&(this.instance=e)},e.prototype.callOwaIframeAction=function(e,t,n){return void 0===n&&(n=!0),this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)},e.prototype.callOwaIframeResourceUrl=function(t,n,r){var o=this;return new Promise((function(a,c){i.throwOnNullOrEmpty(t,"resourceUrl"),i.throwOnUndefined(r,"method"),null!==o.owaCallsInterceptor||d.a.Instance.configuration.UserHasExchangeLicense||(o.owaCallsInterceptor=new p(o)),r===s.a.PUT&&i.throwOnUndefined(n,"data");var l={};null!==d.a.Instance.configuration.CurrentUserUpn&&(l[e.UPNAnchorMailboxHeaderKey]=d.a.Instance.configuration.CurrentUserUpn);var f=d.a.Instance.configuration.SuiteServiceUrl.replace(u.OwsRelativePath,t);null!=o.owaCallsInterceptor&&o.owaCallsInterceptor.beforeSuiteServiceCall(l);var h=c;null!=o.owaCallsInterceptor&&(h=function(e){o.owaCallsInterceptor.afterSuiteServiceError(e,c)}),o.callOwaIframeWithOrWithoutRetry(f,l,n,r).then((function(e){return a(""!==e?JSON.parse(e):"")})).catch(h)}))},e.prototype.callOwaIframeActionWithAdditionalHeaders=function(t,n,r,a){var u=this;return void 0===a&&(a=!0),new Promise((function(c,l){i.throwOnNullOrEmpty(t,"action"),i.throwOnUndefined(n,"data");var p=d.a.Instance.configuration.SuiteServiceUrl,f="suiteservice.svc",h=-1!==p.toLowerCase().indexOf(f,p.length-f.length)?"{0}/?action={1}":"{0}?action={1}",g=u.isUserInitiatedCall(t)?t:t+"&UA=0",m=Object(o.b)(h,p,g);null===r&&(r={}),r[e.ActionHeaderKey]=t,u.callOwaIframeWithOrWithoutRetry(m,r,n,s.a.POST,a).then((function(e){return c(""!==e?JSON.parse(e):"")})).catch(l)}))},e.prototype.prefetchAccessToken=function(e,t){void 0===t&&(t=null);var n={url:e,resource:t};return new Promise((function(e,t){n.error=function(e,n,r){t(l.convertErrorToException(e,n,r))},n.success=function(t){return e(t)};var r=h.a.OauthTokenFactoryInstance;null!=r&&r.prefetchOAuthAccessToken(n)}))},e.prototype.registerOpxHost=function(e){return void 0===e&&(e=f.a.DefaultTimeout),new Promise((function(t,n){var r={error:function(e,t,r){n(l.convertErrorToException(e,t,r))},success:function(e){t()},timeout:e},i=h.a.OauthTokenFactoryInstance;null==i?n(new a.a("OauthTokenFactoryIframe",-1011)):i.registerOpxHost(r)}))},e.prototype.callOpxIframe=function(e){var t=h.a.OauthTokenFactoryInstance;if(null==t)throw new a.a("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)},e.prototype.callEndpointWithOauthToken=function(e){return new Promise((function(t,n){null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===d.a.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=d.a.Instance.configuration.WorkloadId),e.success=function(e){try{var r=void 0;r=null!=e.contentType&&e.contentType.indexOf("application/json")>-1?JSON.parse(e.body):e.body,t(r)}catch(e){return void n(new a.a("Invalid response format."))}},e.error=function(e,t,r){n(l.convertErrorToException(e,t,r))};var r=h.a.OauthTokenFactoryInstance;null!=r?d.a.Instance.configuration.IsPwa||0===r.mode?g.a.getToken(e).then((function(t){0===t.responseType&&(e.headers.Authorization="Bearer "+t.token,null!=d.a.Instance.configuration.ServiceWorkerCacheId&&null!=d.a.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=d.a.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=d.a.Instance.configuration.ServiceWorkerFetchStrategy),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],r.executeCrossDomainRequestAsync(e,!0))})).catch((function(t){1===t.responseType&&r.executeCrossDomainRequestAsync(e)})):r.executeCrossDomainRequestAsync(e):n(new a.a("OauthTokenFactoryIframe",-1011))}))},e.prototype.callWebClientShellServiceFunction=function(e,t,n,r){var i=Object(o.b)("{0}/{1}",d.a.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");var a={method:t,url:i,resource:d.a.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(r),headers:n};return this.callEndpointWithOauthToken(a)},e.prototype.owaSessionStorageRequest=function(e){var t=this;return new Promise((function(n,r){if(i.throwOnUndefined(e,"data"),t.shouldBlockCall(4))r(new a.a("SuiteService",-1011));else{var o={url:d.a.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:function(e){return n(e.responseObject)},error:function(e,t,n){return r(new a.a(n,-2002))}},s=h.a.OwaInstance;null==s?r(new a.a("SuiteService",-1011)):s.executeStorageRequest(o)}}))},e.prototype.callOwaIframeWithOrWithoutRetry=function(t,n,r,i,o){var s=this;void 0===o&&(o=!0);var u={};if(null!=n)for(var c=0,p=Object.keys(n);c<p.length;c++){var f=p[c];u[f]=n[f]}u.Accept="application/json",u["Content-Type"]="application/json; charset=utf-8";var g=d.a.Instance.MailboxGuid,m=d.a.Instance.configuration.ShellSID,v=g||m,y=l.generateCorrelationId(v);u["X-OWA-CorrelationId"]=y;var S=JSON.stringify(r);return new Promise((function(r,c){if(null!=s.suiteServiceCallsBlockedReason){var d=new a.a(s.suiteServiceCallsBlockedReason,-1010);return c(d)}var p=h.a.OwaInstance;if(null!==p){s.firstDataRequestSent||(!0,s.firstDataRequestSent=!0);var f=function(e){null!=s.owaCallsInterceptor&&s.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),r(e.body)};s.owaHttpRequest(p,t,S,u,i).then(f).catch(o?function(r){449===r.HttpStatus?s.owaHttpRequest(p,t,S,u,i).then(f).catch((function(e){return s.executeErrorCallback(n,c,e)})):null!=r[e.XSuiteError]&&r[e.XSuiteError]===e.WrongServerException?(y=l.generateCorrelationId(v),u["X-OWA-CorrelationId"]=y,s.owaHttpRequest(p,t,S,u,i).then((function(e){f(e)})).catch((function(e){s.executeErrorCallback(n,c,e)}))):c(r)}:function(){c()})}else s.executeErrorCallback(n,c,l.convertErrorToException(null,-1011,"OwaIframe"))}))},e.prototype.owaHttpRequest=function(t,n,o,a,u){var d=this;return new Promise((function(p,f){if(i.throwOnNullOrUndefined(n,"url"),d.shouldBlockCall(d.getExchangeServiceToCall(n)))return f(l.convertErrorToException(null,-1010,d.suiteServiceCallsBlockedReason));var h=null,g={headers:a,url:n,method:u.toString(),body:u!==s.a.GET?o:void 0,success:function(e){var t=l.getOwaError(e.headers);if(null!=t)return d.checkAndHandleBlockingOwaErrors(t),void f(l.convertErrorToException(e,e.statusCode,t));try{p(e)}catch(e){}null!=h&&h()},error:function(t,n,i){var o=l.getOwaError(t.headers);null!=o&&d.checkAndHandleBlockingOwaErrors(o),t.statusCode!==e.HttpStatusCodeTokenExpired&&t.statusCode!==e.HttpStatusCodeUnauthorized||(d.blockSuiteServiceCalls(c.a.TokenExpired,n,i),Object(r.c)().invoke("AuthenticationExpired")),f(l.convertErrorToException(t,n,i))}};if(d.ShouldQueueOwsCalls)if(d.isStartupAction(a))h=function(){d.setStartupActionCompleted(),h=null};else if(2===d.getExchangeServiceToCall(g.url))return void d.queuedCalls.push(new v(t,g,f));t.executeAsync(g)}))},e.prototype.registerAuthenticationExpiredCallback=function(e){Object(r.c)().subscribe("AuthenticationExpired",e,!0)},e.prototype.registerCultureNotSetCallback=function(e){Object(r.c)().subscribe("CultureNotSet",e,!0)},e.prototype.guaranteeConnectionEstablished=function(e){this.ConnectionEstablished||d.a.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)},e.prototype.blockSuiteServiceCalls=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==c.a.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),Object(r.f)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,c.a[e],t))},e.prototype.stopBlockingCalls=function(){this.suiteServiceCallsBlockedReason=null},e.prototype.callStartupCallbacks=function(){for(var e=0,t=this.startupCallbacks;e<t.length;e++){var n=t[e];null!=n&&n()}this.startupCallbacks=[]},e.prototype.checkAndHandleBlockingOwaErrors=function(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(c.a.LanguageNotSet,e),Object(r.c)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(c.a.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(c.a.ShardMailbox,e)},e.prototype.getExchangeServiceToCall=function(e){var t=null!=e?u.getUrlPath(e):null;if(t){var n=function(e,t){return e.substr(0,t.length)===t};if(n(t,u.SuiteServiceApiRelativePath))return 3;if(n(t,u.OwsRelativePath))return 2;if(n(t,u.DevFabricOwsRelativePath))return 2}var i=new Error("Cannot Acquire Exchange Service to Call");throw Object(r.f)().exception("Service_ExchangeServiceAcquireFail",6,i,t),i},e.prototype.shouldBlockCall=function(t){return null!=this.suiteServiceCallsBlockedReason&&!(2!==t&&e.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))},e.prototype.executeErrorCallback=function(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){var r=n.errorCode||0,i=-1005===r?c.a.CallerOriginNotAllowed:c.a.InitFailed;this.blockSuiteServiceCalls(i,r,n.message);for(var o=l.convertErrorToException(null,-1010,"App initialization failed, call canceled",r,n.message),a=0,s=this.queuedCalls;a<s.length;a++){var u=s[a];try{u.ErrorCallback(o)}catch(e){}}this.queuedCalls=[]}},e.prototype.isUserInitiatedCall=function(t){return e.userInitiatedCalls.indexOf(t.toLowerCase())>=0},e.prototype.isStartupAction=function(t){var n=d.a.Instance.configuration.StartupActionName;return null!=n&&n===t[e.ActionHeaderKey]},e.ActionHeaderKey="Action",e.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",e.XSuiteError=l.XSuiteError,e.HttpStatusCodeUnauthorized=401,e.HttpStatusCodeTokenExpired=440,e.WrongServerException="WrongServerException",e.instance=new e,e.callBlockingReasonsSpecificToOws=[c.a.LanguageNotSet.toString(),c.a.InitFailed.toString(),c.a.InvalidMailbox.toString(),c.a.ShardMailbox.toString()],e.userInitiatedCalls=["getowauserconfiguration"],e}()},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(12),o=function(){function e(){}return e.getToken=function(e){return new Promise((function(t,n){if(i.a.Instance.configuration.GetTokenRequestDictionary){var o=i.a.Instance.configuration.GetTokenRequestDictionary(),a=function(e){e?t({token:e,responseType:0}):(Object(r.f)().tag("GetAccessToken_Empty",6),n({responseType:2}))},s=function(e){Object(r.f)().exception("GetAccessToken_Failed",6,e),n({responseType:2,exception:e})};if(o[e.resource]){var u=o[e.resource];"function"==typeof u?u().then((function(e){a(e)})).catch((function(e){s(e)})):u.then((function(e){a(e)})).catch((function(e){s(e)}))}else n({responseType:1})}else n({responseType:1})}))},e}()},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=6e4,i=60*r,o=24*i},,,function(e,t,n){var r=n(232);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(247);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},,function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(r||(r={})),function(e){e.User="User",e.Tenant="Tenant"}(i||(i={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(154),i=n(58),o=n(117),a="UserInfo.IdType",s=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(r.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext(a,n.toString());else{var r=void 0;switch(t){case i.AWTPiiKind.SipAddress:r=o.AWTUserIdType.SipAddress;break;case i.AWTPiiKind.PhoneNumber:r=o.AWTUserIdType.PhoneNumber;break;case i.AWTPiiKind.SmtpAddress:r=o.AWTUserIdType.EmailAddress;break;default:r=o.AWTUserIdType.Unknown}this._addContext(a,r.toString())}if(isNaN(t)||null===t||t===i.AWTPiiKind.NotSet||t>13)switch(n){case o.AWTUserIdType.Skype:t=i.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=i.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=i.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=i.AWTPiiKind.SipAddress;break;default:t=i.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTAutoCollection.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var r=n(75),i="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",u="Firefox",c="Safari",l="Edge",d="Electron",p="SkypeShell",f="PhantomJS",h="Opera",g="Windows",m="Mac OS X",v="Windows Phone",y="Windows RT",S="iOS",b="Android",T="Linux",C="Chrome OS",_=/(windows|win32)/i,O=/ arm;/i,I=/windows\sphone\s\d+\.\d+/i,w=/(macintosh|mac os x)/i,A=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,D=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,x=/android/i,P=/CrOS/i,E={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},k="([\\d,.]+)",R="Unknown",L="undefined",N=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||typeof navigator===L||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(i),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(i),n=this._getData(o);t!==e&&(n=r.getISOString(new Date)),this._saveData(i,e),this._saveData(o,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(i);e||(e=r.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){typeof document!==L&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),typeof navigator!==L&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(l,e)||this._userAgentContainsString("Edg",e)?l:this._userAgentContainsString(d,e)?d:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(p,e)?p:R},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=r.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===a)return this._getIeVersion(e);if(t===l){var n=this._getOtherVersion(t,e);return n===R?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" "+k));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===c&&(e="Version");var n=t.match(new RegExp(e+"/"+k));return n?n[1]:R},e._getOsName=function(e){return e.match(I)?v:e.match(O)?y:e.match(A)?S:e.match(x)?b:e.match(D)?T:e.match(w)?m:e.match(_)?g:e.match(P)?C:R},e._getOsVersion=function(e,t){return t===g?this._getGenericOsVersion(e,"Windows NT"):t===b?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):R},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" "+k));return n?E[n[1]]?E[n[1]]:n[1]:R},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return R},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],i=0;" "===r.charAt(i);)i++;if(0===(r=r.substring(i)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable=typeof document!==L&&typeof document.cookie!==L,e}();t.default=N},,,,,function(e,t,n){var r=n(233);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(r||(r={}))},,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return f}));var r,i=n(107),o=n(1),a=n(15),s=n(196),u={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};function c(e,t){!t&&swc&&(e?swc.API.triggerEvent(i.b.ApiRecentsShown):swc.API.triggerEvent(i.b.ApiRecentsHidden))}function l(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function d(e,t,n){!n&&swc?(swc.API.registerEvent(i.b.ApiRecentsReady,t),swc.create(i.c.Recents,{},e)):n&&(r=e)}function p(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((function(n){n.render(r).then(e),n.subscribe((function(e){e.type===s.b.ConversationOpened&&t(!1,a.a)}))}))}function f(e,t){swc&&swc.getPresence().then((function(t){t.setMyStatus(e.key)})).catch((function(e){Object(o.f)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},,,,,,,,,,,,,,,,,,,,,,function(e){e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibi)"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)"},{"Locale":"am-ET","DisplayName":" ()"},{"Locale":"ar-AE","DisplayName":" (  )"},{"Locale":"ar-BH","DisplayName":" ()"},{"Locale":"ar-DJ","DisplayName":" ()"},{"Locale":"ar-DZ","DisplayName":" ()"},{"Locale":"ar-EG","DisplayName":" ()"},{"Locale":"ar-ER","DisplayName":" ()"},{"Locale":"ar-IL","DisplayName":" ()"},{"Locale":"ar-IQ","DisplayName":" ()"},{"Locale":"ar-JO","DisplayName":" ()"},{"Locale":"ar-KM","DisplayName":" ( )"},{"Locale":"ar-KW","DisplayName":" ()"},{"Locale":"ar-LB","DisplayName":" ()"},{"Locale":"ar-LY","DisplayName":" ()"},{"Locale":"ar-MA","DisplayName":" ( )"},{"Locale":"ar-MR","DisplayName":" ()"},{"Locale":"ar-OM","DisplayName":" ()"},{"Locale":"ar-PS","DisplayName":" ( )"},{"Locale":"ar-QA","DisplayName":" ()"},{"Locale":"ar-SA","DisplayName":" (  )"},{"Locale":"ar-SO","DisplayName":" ()"},{"Locale":"ar-SS","DisplayName":" ( )"},{"Locale":"ar-TD","DisplayName":" ()"},{"Locale":"ar-TN","DisplayName":" ()"},{"Locale":"as-IN","DisplayName":" ()"},{"Locale":"az-Latn-AZ","DisplayName":"azrbaycan (Azrbaycan)"},{"Locale":"be-BY","DisplayName":" ()"},{"Locale":"bg-BG","DisplayName":" ()"},{"Locale":"bn-BD","DisplayName":" ()"},{"Locale":"bn-IN","DisplayName":" ()"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)"},{"Locale":"ca-AD","DisplayName":"catal (Andorra)"},{"Locale":"ca-ES","DisplayName":"catal (catal)"},{"Locale":"ca-FR","DisplayName":"catal (Frana)"},{"Locale":"ca-IT","DisplayName":"catal (Itlia)"},{"Locale":"cs-CZ","DisplayName":"etina (esko)"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)"},{"Locale":"da-GL","DisplayName":"dansk (Grnland)"},{"Locale":"de-AT","DisplayName":"Deutsch (sterreich)"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)"},{"Locale":"el-CY","DisplayName":" ()"},{"Locale":"el-GR","DisplayName":" ()"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)"},{"Locale":"es-AR","DisplayName":"espaol (Argentina)"},{"Locale":"es-BO","DisplayName":"espaol (Bolivia)"},{"Locale":"es-BR","DisplayName":"espaol (Brasil)"},{"Locale":"es-BZ","DisplayName":"espaol (Belice)"},{"Locale":"es-CL","DisplayName":"espaol (Chile)"},{"Locale":"es-CO","DisplayName":"espaol (Colombia)"},{"Locale":"es-CR","DisplayName":"espaol (Costa Rica)"},{"Locale":"es-CU","DisplayName":"espaol (Cuba)"},{"Locale":"es-DO","DisplayName":"espaol (Repblica Dominicana)"},{"Locale":"es-EC","DisplayName":"espaol (Ecuador)"},{"Locale":"es-ES","DisplayName":"espaol (Espaa, alfabetizacin internacional)"},{"Locale":"es-GQ","DisplayName":"espaol (Guinea Ecuatorial)"},{"Locale":"es-GT","DisplayName":"espaol (Guatemala)"},{"Locale":"es-HN","DisplayName":"espaol (Honduras)"},{"Locale":"es-MX","DisplayName":"espaol (Mxico)"},{"Locale":"es-NI","DisplayName":"espaol (Nicaragua)"},{"Locale":"es-PA","DisplayName":"espaol (Panam)"},{"Locale":"es-PE","DisplayName":"espaol (Per)"},{"Locale":"es-PH","DisplayName":"espaol (Filipinas)"},{"Locale":"es-PR","DisplayName":"espaol (Puerto Rico)"},{"Locale":"es-PY","DisplayName":"espaol (Paraguay)"},{"Locale":"es-SV","DisplayName":"espaol (El Salvador)"},{"Locale":"es-US","DisplayName":"espaol (Estados Unidos)"},{"Locale":"es-UY","DisplayName":"espaol (Uruguay)"},{"Locale":"es-VE","DisplayName":"espaol (Venezuela)"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)"},{"Locale":"fa-IR","DisplayName":" ()"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)"},{"Locale":"fr-BE","DisplayName":"franais (Belgique)"},{"Locale":"fr-BF","DisplayName":"franais (Burkina Faso)"},{"Locale":"fr-BI","DisplayName":"franais (Burundi)"},{"Locale":"fr-BJ","DisplayName":"franais (Bnin)"},{"Locale":"fr-BL","DisplayName":"franais (Saint-Barthlemy)"},{"Locale":"fr-CA","DisplayName":"franais (Canada)"},{"Locale":"fr-CF","DisplayName":"franais (Rpublique centrafricaine)"},{"Locale":"fr-CG","DisplayName":"franais (Congo)"},{"Locale":"fr-CH","DisplayName":"franais (Suisse)"},{"Locale":"fr-CI","DisplayName":"franais (Cte dIvoire)"},{"Locale":"fr-CM","DisplayName":"franais (Cameroun)"},{"Locale":"fr-DJ","DisplayName":"franais (Djibouti)"},{"Locale":"fr-DZ","DisplayName":"franais (Algrie)"},{"Locale":"fr-FR","DisplayName":"franais (France)"},{"Locale":"fr-GA","DisplayName":"franais (Gabon)"},{"Locale":"fr-GF","DisplayName":"franais (Guyane franaise)"},{"Locale":"fr-GN","DisplayName":"franais (Guine)"},{"Locale":"fr-GP","DisplayName":"franais (Guadeloupe)"},{"Locale":"fr-GQ","DisplayName":"franais (Guine quatoriale)"},{"Locale":"fr-HT","DisplayName":"franais (Hati)"},{"Locale":"fr-KM","DisplayName":"franais (Comores)"},{"Locale":"fr-LU","DisplayName":"franais (Luxembourg)"},{"Locale":"fr-MA","DisplayName":"franais (Maroc)"},{"Locale":"fr-MC","DisplayName":"franais (Monaco)"},{"Locale":"fr-MF","DisplayName":"franais (Saint-Martin)"},{"Locale":"fr-MG","DisplayName":"franais (Madagascar)"},{"Locale":"fr-ML","DisplayName":"franais (Mali)"},{"Locale":"fr-MQ","DisplayName":"franais (Martinique)"},{"Locale":"fr-MR","DisplayName":"franais (Mauritanie)"},{"Locale":"fr-MU","DisplayName":"franais (Maurice)"},{"Locale":"fr-NC","DisplayName":"franais (Nouvelle-Caldonie)"},{"Locale":"fr-NE","DisplayName":"franais (Niger)"},{"Locale":"fr-PF","DisplayName":"franais (Polynsie franaise)"},{"Locale":"fr-PM","DisplayName":"franais (Saint-Pierre-et-Miquelon)"},{"Locale":"fr-RE","DisplayName":"franais (La Runion)"},{"Locale":"fr-RW","DisplayName":"franais (Rwanda)"},{"Locale":"fr-SC","DisplayName":"franais (Seychelles)"},{"Locale":"fr-SN","DisplayName":"franais (Sngal)"},{"Locale":"fr-TD","DisplayName":"franais (Tchad)"},{"Locale":"fr-TG","DisplayName":"franais (Togo)"},{"Locale":"fr-TN","DisplayName":"franais (Tunisie)"},{"Locale":"fr-VU","DisplayName":"franais (Vanuatu)"},{"Locale":"fr-WF","DisplayName":"franais (Wallis-et-Futuna)"},{"Locale":"fr-YT","DisplayName":"franais (Mayotte)"},{"Locale":"ga-IE","DisplayName":"Gaeilge (ire)"},{"Locale":"gd-GB","DisplayName":"Gidhlig (An Roghachd Aonaichte)"},{"Locale":"gl-ES","DisplayName":"galego (galego)"},{"Locale":"gu-IN","DisplayName":" ()"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)"},{"Locale":"he-IL","DisplayName":" ()"},{"Locale":"hi-IN","DisplayName":" ()"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarorszg)"},{"Locale":"hy-AM","DisplayName":" ()"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)"},{"Locale":"is-IS","DisplayName":"slenska (sland)"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)"},{"Locale":"it-IT","DisplayName":"italiano (Italia)"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)"},{"Locale":"it-VA","DisplayName":"italiano (Citt del Vaticano)"},{"Locale":"ja-JP","DisplayName":" ()"},{"Locale":"ka-GE","DisplayName":" ()"},{"Locale":"kk-KZ","DisplayName":"  ()"},{"Locale":"km-KH","DisplayName":" ()"},{"Locale":"kn-IN","DisplayName":" ()"},{"Locale":"ko-KR","DisplayName":"()"},{"Locale":"kok-IN","DisplayName":" ()"},{"Locale":"ky-KG","DisplayName":" ()"},{"Locale":"lb-LU","DisplayName":"Ltzebuergesch (Ltzebuerg)"},{"Locale":"lo-LA","DisplayName":" ()"},{"Locale":"lt-LT","DisplayName":"lietuvi (Lietuva)"},{"Locale":"lv-LV","DisplayName":"latvieu (Latvija)"},{"Locale":"mi-NZ","DisplayName":"te reo Mori (Aotearoa)"},{"Locale":"mk-MK","DisplayName":" ( )"},{"Locale":"ml-IN","DisplayName":" ()"},{"Locale":"mn-MN","DisplayName":" ()"},{"Locale":"mr-IN","DisplayName":" ()"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)"},{"Locale":"nb-NO","DisplayName":"norsk bokml (Norge)"},{"Locale":"nb-SJ","DisplayName":"norsk bokml (Svalbard og Jan Mayen)"},{"Locale":"ne-NP","DisplayName":" ()"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)"},{"Locale":"nl-BE","DisplayName":"Nederlands (Belgi)"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaao)"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)"},{"Locale":"or-IN","DisplayName":" ()"},{"Locale":"pa-IN","DisplayName":" ()"},{"Locale":"pl-PL","DisplayName":"polski (Polska)"},{"Locale":"prs-AF","DisplayName":" ()"},{"Locale":"pt-AO","DisplayName":"portugus (Angola)"},{"Locale":"pt-BR","DisplayName":"portugus (Brasil)"},{"Locale":"pt-CH","DisplayName":"portugus (Sua)"},{"Locale":"pt-CV","DisplayName":"portugus (Cabo Verde)"},{"Locale":"pt-GQ","DisplayName":"portugus (Guin Equatorial)"},{"Locale":"pt-GW","DisplayName":"portugus (Guin-Bissau)"},{"Locale":"pt-LU","DisplayName":"portugus (Luxemburgo)"},{"Locale":"pt-MO","DisplayName":"portugus (RAE de Macau)"},{"Locale":"pt-MZ","DisplayName":"portugus (Moambique)"},{"Locale":"pt-PT","DisplayName":"portugus (Portugal)"},{"Locale":"pt-ST","DisplayName":"portugus (So Tom e Prncipe)"},{"Locale":"pt-TL","DisplayName":"portugus (Timor-Leste)"},{"Locale":"quz-PE","DisplayName":"Runasimi (Per)"},{"Locale":"ro-MD","DisplayName":"romn (Republica Moldova)"},{"Locale":"ro-RO","DisplayName":"romn (Romnia)"},{"Locale":"ru-BY","DisplayName":" ()"},{"Locale":"ru-KG","DisplayName":" ()"},{"Locale":"ru-KZ","DisplayName":" ()"},{"Locale":"ru-MD","DisplayName":" ()"},{"Locale":"ru-RU","DisplayName":" ()"},{"Locale":"ru-UA","DisplayName":" ()"},{"Locale":"sd-Arab-PK","DisplayName":" ()"},{"Locale":"si-LK","DisplayName":" ( )"},{"Locale":"sk-SK","DisplayName":"slovenina (Slovensko)"},{"Locale":"sl-SI","DisplayName":"slovenina (Slovenija)"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipri)"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)"},{"Locale":"sq-XK","DisplayName":"shqip (Kosov)"},{"Locale":"sr-Cyrl-BA","DisplayName":" (  )"},{"Locale":"sr-Cyrl-ME","DisplayName":" ( )"},{"Locale":"sr-Cyrl-RS","DisplayName":" ()"},{"Locale":"sr-Cyrl-XK","DisplayName":" ()"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)"},{"Locale":"sv-AX","DisplayName":"svenska (land)"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)"},{"Locale":"ta-IN","DisplayName":" ()"},{"Locale":"ta-LK","DisplayName":" ()"},{"Locale":"ta-MY","DisplayName":" ()"},{"Locale":"ta-SG","DisplayName":" ()"},{"Locale":"te-IN","DisplayName":" ()"},{"Locale":"th-TH","DisplayName":" ()"},{"Locale":"tk-TM","DisplayName":"Trkmen dili (Trkmenistan)"},{"Locale":"tr-CY","DisplayName":"Trke (Kbrs)"},{"Locale":"tr-TR","DisplayName":"Trke (Trkiye)"},{"Locale":"tt-RU","DisplayName":" ()"},{"Locale":"ug-CN","DisplayName":" (  )"},{"Locale":"uk-UA","DisplayName":" ()"},{"Locale":"ur-IN","DisplayName":" ()"},{"Locale":"ur-PK","DisplayName":" ()"},{"Locale":"uz-Arab-AF","DisplayName":" ()"},{"Locale":"uz-Cyrl-UZ","DisplayName":" ()"},{"Locale":"uz-Latn-UZ","DisplayName":"ozbek (Ozbekiston)"},{"Locale":"vi-VN","DisplayName":"Ting Vit (Vit Nam)"},{"Locale":"zh-CN","DisplayName":"()"},{"Locale":"zh-Hans-HK","DisplayName":" ()"},{"Locale":"zh-Hans-MO","DisplayName":" ()"},{"Locale":"zh-HK","DisplayName":"()"},{"Locale":"zh-MO","DisplayName":"()"},{"Locale":"zh-SG","DisplayName":"()"},{"Locale":"zh-TW","DisplayName":"()"}]')},function(e,t,n){var r=n(234);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTLogger.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=n(58),i=n(117),o=n(118),a=n(75),s=n(191),u=n(87),c=n(102),l=n(195),d=n(193),p=n(153),f=n(154),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new p.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,i)},e.prototype.setContextWithCustomerContent=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,i)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var n=!0;a.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(l.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,n),o.priority=r.AWTEventPriority.High,t===i.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==i.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=s.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,i,o,a){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,i&&(s.properties["Failure.Category"]=i),o&&(s.properties["Failure.Id"]=o),s.priority=r.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,i,o,a){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,r&&(s.properties["PageView.Category"]=r),i&&(s.properties["PageView.Uri"]=i),o&&(s.properties["PageView.ReferrerUri"]=o),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),this._sendEvent(e)):u.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)):u.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet,type:r.AWTPropertyType.String}},e._sendEvent=function(e){c.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=a.sanitizeProperty(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var i=e;return i.id=a.newGuid(),i.apiKey=t,i},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTStatsManager.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=n(75),i=n(87),o=n(58),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,i.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==r.StatsApiKey){var i=r.getTenantId(n);this._stats[i]||(this._stats[i]={}),this._stats[i][e]?this._stats[i][e]=this._stats[i][e]+t:this._stats[i][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTSerializer.ts
* @author Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=n(236),i=n(58),o=n(87),a=n(75),s=2936012,u=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,u=!1,c=new r.IO.MemoryStream,l=new r.CompactBinaryProtocolWriter(c);for(var d in l._WriteFieldBegin(r._BondDataType._BT_MAP,3,null),l._WriteMapContainerBegin(t,r._BondDataType._BT_STRING,r._BondDataType._BT_LIST),e)if(u)n||(n={}),n[d]=e[d],delete e[d];else if(e.hasOwnProperty(d)){l._WriteString(d);var p=e[d];l._WriteContainerBegin(1,r._BondDataType._BT_STRUCT),l._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),l._WriteString("act_default_source"),l._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),l._WriteString(a.newGuid()),l._WriteFieldBegin(r._BondDataType._BT_INT64,6,null),l._WriteInt64(a.numberToBondInt64(Date.now())),l._WriteFieldBegin(r._BondDataType._BT_LIST,8,null);var f=c._GetBuffer().length+1;l._WriteContainerBegin(e[d].length,r._BondDataType._BT_STRUCT);for(var h=c._GetBuffer().length-f,g=0;g<p.length;++g){var m=c._GetBuffer().length;if(this.writeEvent(p[g],l),c._GetBuffer().length-m>s)o.default.eventsRejected([p[g]],i.AWTEventsRejectedReason.SizeLimitExceeded),p.splice(g--,1),c._GetBuffer().splice(m),this._addNewDataPackageSize(p.length,c,h,f);else if(c._GetBuffer().length>s){c._GetBuffer().splice(m),n||(n={}),e[d]=p.splice(0,g),n[d]=p,this._addNewDataPackageSize(e[d].length,c,h,f),u=!0;break}}l._WriteStructEnd(!1)}return l._WriteStructEnd(!1),{payloadBlob:c._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,i){for(var o=r._Encoding._Varint_GetBytes(r.Number._ToUInt32(e)),a=0;a<n;++a){if(!(a<o.length)){t._GetBuffer().slice(i+a,n-a);break}t._GetBuffer()[i+a]=o[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(r._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(r._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(r._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},o=0,s={},u=0,c={},l=0,d={},p=0,f={},h=0,g={},m=0,v={},y=0;for(var S in e.properties){if(e.properties.hasOwnProperty(S))if((T=e.properties[S]).cc>0)v[S]=T,y++;else if(T.pii>0)g[S]=T,m++;else switch(T.type){case i.AWTPropertyType.String:n[S]=T.value,o++;break;case i.AWTPropertyType.Int64:s[S]=T.value,u++;break;case i.AWTPropertyType.Double:c[S]=T.value,l++;break;case i.AWTPropertyType.Boolean:d[S]=T.value,p++;break;case i.AWTPropertyType.Date:f[S]=T.value,h++}}if(o)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,r._BondDataType._BT_STRING,r._BondDataType._BT_STRING),n)if(n.hasOwnProperty(S)){var b=n[S];t._WriteString(S),t._WriteString(b.toString())}if(m)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),g)if(g.hasOwnProperty(S)){var T=g[S];t._WriteString(S),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(r._BondDataType._BT_INT32,2,null),t._WriteInt32(T.pii),t._WriteFieldBegin(r._BondDataType._BT_STRING,3,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1)}if(p)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(p,r._BondDataType._BT_STRING,r._BondDataType._BT_BOOL),d)if(d.hasOwnProperty(S)){b=d[S];t._WriteString(S),t._WriteBool(b)}if(h)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),f)if(f.hasOwnProperty(S)){b=f[S];t._WriteString(S),t._WriteInt64(a.numberToBondInt64(b))}if(u)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(u,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),s)if(s.hasOwnProperty(S)){b=s[S];t._WriteString(S),t._WriteInt64(a.numberToBondInt64(b))}if(l)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,r._BondDataType._BT_STRING,r._BondDataType._BT_DOUBLE),c)if(c.hasOwnProperty(S)){b=c[S];t._WriteString(S),t._WriteDouble(b)}if(y)for(var S in t._WriteFieldBegin(r._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(y,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),v)if(v.hasOwnProperty(S)){T=v[S];t._WriteString(S),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(T.cc),t._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Encoding._Base64_GetString(e)},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),
/**
* Version.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
* File for SDK version.
*/
t.Version="1.8.6",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=n(117),o=n(195),a=n(190),s=n(102),u=n(87),c=n(154),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),c.default.addPropertyStorageOverride(this._config.propertyStorageOverride),c.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(i.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(i.AWTSessionState.Ended),s.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,n,i)},e.setContextWithCustomerContent=function(e,t,n,i){void 0===i&&(i=r.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,i)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){u.default.addNotificationListener(e)},e.removeNotificationListener=function(e){u.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTLogManagerSettings.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=n(118),i=n(153),o=function(){function e(){}return e.logManagerContext=new r.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new i.default(!0,e.logManagerContext),e}();t.default=o},function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(r||(r={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.ConversationOpened="conversationOpened"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(198);function i(e){return{type:r.a,dttProps:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="suiteux-dtt.UPDATE_PROPS"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,i=n(0),o=n(95),a=n(79);!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=22,n=[],r=0;r<t;r++)n.push(e.charAt(Math.floor(Math.random()*e.length)));return n.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(r||(r={}));var s=n(61),u=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(u=function(){return 1e3*Math.floor(window.performance.now())});var c=function(e){var t,n=u(),i=Object(o.b)(e.telemetryEvent);return{cv:e.parentCv?r.getNextChild(e.parentCv):r.getNext(),eventName:e.telemetryEvent.eventName,dataFields:i.dataFields,eventFlags:i.eventFlags,telemetryProperties:i.telemetryProperties,createChildActivity:function(t){return c({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!t){void 0===this.success&&void 0===this.result&&Object(s.b)(1,0,(function(){return"Activity does not have success or result set"}));var r=u();t=!0;var i={duration:r-n,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,a.a.getFields(i)),this.eventContract={name:a.a.contractName,dataFields:o},e.sendTelemetryEvent(this)}Object(s.b)(0,0,(function(){return"Already ended"}))}}},l=n(18),d=function(e){var t=[];return t.push(Object(l.c)("Error.ErrorGroup",e.errorGroup)),t.push(Object(l.b)("Error.Tag",e.tag)),void 0!==e.code&&t.push(Object(l.b)("Error.Code",e.code)),void 0!==e.id&&t.push(Object(l.b)("Error.Id",e.id)),void 0!==e.count&&t.push(Object(l.b)("Error.Count",e.count)),t},p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.createActivity=function(e){return function(e,t){return c({telemetryEvent:t,sendTelemetryEvent:function(t){e.sendTelemetryEvent(t)}})}(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:a.a.contractName,dataFields:a.a.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=d(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return function(e,t){return c({telemetryEvent:t,sendTelemetryEvent:function(t){e.sendCustomerContent(t)}})}(this,e)},t}(o.a)},,,,function(e,t,n){"use strict";var r;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(o){var a,s,u,c=arguments,l=(a=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,s=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,u=/[^-+\dA-Z]/g,function(e,t,n,r){if(1!==c.length||"string"!==g(e)||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i=(t=String(l.masks[t]||t||l.masks.default)).slice(0,4);"UTC:"!==i&&"GMT:"!==i||(t=t.slice(4),n=!0,"GMT:"===i&&(r=!0));var o=function(){return n?"getUTC":"get"},m=function(){return e[o()+"Date"]()},v=function(){return e[o()+"Day"]()},y=function(){return e[o()+"Month"]()},S=function(){return e[o()+"FullYear"]()},b=function(){return e[o()+"Hours"]()},T=function(){return e[o()+"Minutes"]()},C=function(){return e[o()+"Seconds"]()},_=function(){return e[o()+"Milliseconds"]()},O=function(){return n?0:e.getTimezoneOffset()},I=function(){return f(e)},w={d:function(){return m()},dd:function(){return d(m())},ddd:function(){return l.i18n.dayNames[v()]},DDD:function(){return p({y:S(),m:y(),d:m(),_:o(),dayName:l.i18n.dayNames[v()],short:!0})},dddd:function(){return l.i18n.dayNames[v()+7]},DDDD:function(){return p({y:S(),m:y(),d:m(),_:o(),dayName:l.i18n.dayNames[v()+7]})},m:function(){return y()+1},mm:function(){return d(y()+1)},mmm:function(){return l.i18n.monthNames[y()]},mmmm:function(){return l.i18n.monthNames[y()+12]},yy:function(){return String(S()).slice(2)},yyyy:function(){return d(S(),4)},h:function(){return b()%12||12},hh:function(){return d(b()%12||12)},H:function(){return b()},HH:function(){return d(b())},M:function(){return T()},MM:function(){return d(T())},s:function(){return C()},ss:function(){return d(C())},l:function(){return d(_(),3)},L:function(){return d(Math.floor(_()/10))},t:function(){return b()<12?l.i18n.timeNames[0]:l.i18n.timeNames[1]},tt:function(){return b()<12?l.i18n.timeNames[2]:l.i18n.timeNames[3]},T:function(){return b()<12?l.i18n.timeNames[4]:l.i18n.timeNames[5]},TT:function(){return b()<12?l.i18n.timeNames[6]:l.i18n.timeNames[7]},Z:function(){return r?"GMT":n?"UTC":(String(e).match(s)||[""]).pop().replace(u,"").replace(/GMT\+0000/g,"UTC")},o:function(){return(O()>0?"-":"+")+d(100*Math.floor(Math.abs(O())/60)+Math.abs(O())%60,4)},p:function(){return(O()>0?"-":"+")+d(Math.floor(Math.abs(O())/60),2)+":"+d(Math.floor(Math.abs(O())%60),2)},S:function(){return["th","st","nd","rd"][m()%10>3?0:(m()%100-m()%10!=10)*m()%10]},W:function(){return I()},WW:function(){return d(I())},N:function(){return h(e)}};return t.replace(a,(function(e){return e in w?w[e]():e.slice(1,e.length-1)}))});l.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},l.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]};var d=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},p=function(e){var t=e.y,n=e.m,r=e.d,i=e._,o=e.dayName,a=e.short,s=void 0!==a&&a,u=new Date,c=new Date;c.setDate(c[i+"Date"]()-1);var l=new Date;l.setDate(l[i+"Date"]()+1);return u[i+"FullYear"]()===t&&u[i+"Month"]()===n&&u[i+"Date"]()===r?s?"Tdy":"Today":c[i+"FullYear"]()===t&&c[i+"Month"]()===n&&c[i+"Date"]()===r?s?"Ysd":"Yesterday":l[i+"FullYear"]()===t&&l[i+"Month"]()===n&&l[i+"Date"]()===r?s?"Tmw":"Tomorrow":o},f=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);var i=(t-n)/6048e5;return 1+Math.floor(i)},h=function(e){var t=e.getDay();return 0===t&&(t=7),t},g=function(e){return null===e?"null":void 0===e?"undefined":"object"!==i(e)?i(e):Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()};void 0===(r=function(){return l}.call(t,n,t,e))||(e.exports=r)}(void 0)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=n(235),o=n(102),a=n(245),s=n(87),u=n(75),c=function(){function e(e,t,n,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[r.AWTEventPriority.High]=[],this._inboundQueues[r.AWTEventPriority.Normal]=[],this._inboundQueues[r.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,500),this._httpManager=new i.default(this._outboundQueue,e,this,n,o)}return e.prototype.addEvent=function(e){u.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),e.priority===r.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],r.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[r.AWTEventPriority.High][0].length>0||this._inboundQueues[r.AWTEventPriority.Normal][0].length>0||this._inboundQueues[r.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],r.AWTEventsDroppedReason.MaxRetryLimit);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(r.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[r.AWTEventPriority.High][0].length+this._inboundQueues[r.AWTEventPriority.Normal][0].length+this._inboundQueues[r.AWTEventPriority.Low][0].length,this._inboundQueues[r.AWTEventPriority.High][0]=[],this._inboundQueues[r.AWTEventPriority.Normal][0]=[],this._inboundQueues[r.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[r.AWTEventPriority.High].shift(),this._inboundQueues[r.AWTEventPriority.Normal].shift(),this._inboundQueues[r.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[r.AWTEventPriority.High].push([]),this._inboundQueues[r.AWTEventPriority.Normal].push([]),this._inboundQueues[r.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=r.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],r.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=r.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(r.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=c},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:1px solid hsla(0,0%,100%,0);box-shadow:0 1px 2px 0 rgba(0,0,0,.1);box-sizing:border-box;width:276px;padding-left:0;align-items:flex-start;margin:0 0 17px 16px}html[dir=rtl] .o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z{margin-left:0;margin-right:16px}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.1);box-shadow:0 8px 16px 0 rgba(0,0,0,.1)}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>button{min-width:30px;width:30px;height:36px;padding-left:10px;padding-right:10px;background-color:transparent;border:none;align-items:flex-start;cursor:pointer}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-ms-clear{display:none}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-cancel-button,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-decoration,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-results-button,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-results-decoration{-webkit-appearance:none;display:none}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z ._2q8vctlvAB-f5fJQsrttcm{width:250px;height:32px;background:transparent;align-items:flex-start;border:none;display:block;font:13px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;text-overflow:ellipsis;padding-left:5px;cursor:pointer;outline:none;margin:.1em}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z ._2q8vctlvAB-f5fJQsrttcm:-internal-autofill-selected{background-color:transparent!important}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z:focus{cursor:text}.o365cs-base ._18OevI2YxDgskrFdnDk1GA{margin:0 0 5px 16px}',""]),t.locals={SearchControl:"_1Fcbxg1PZKNlfmnlw5wn_Z",inputBox:"_2q8vctlvAB-f5fJQsrttcm",SearchControlZoomMargin:"_18OevI2YxDgskrFdnDk1GA"}},function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.o365cs-base ._2IVH-yKibpaBKTUTMsCAXW{position:absolute}.o365cs-base ._2IVH-yKibpaBKTUTMsCAXW ._3CyDPIDunf-mdxvaEXDOuM{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:16px;height:16px;line-height:15px;border-radius:1em;box-sizing:border-box;text-align:center}',""]),t.locals={unseenitems:"_2IVH-yKibpaBKTUTMsCAXW",unseenCount:"_3CyDPIDunf-mdxvaEXDOuM"}},function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._22TDZKfd8po04Ubj0xsW9l{display:block}._3ULy8C7ufHr_RwpL9zRMe3{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.S40eQ7RniUA3-WTWmj-z1{font-family:SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:600}.lrkLSOxXMbvez0pu7_yIi{font-family:SegoeUI-Light-final,Segoe UI Light,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}._3fVHvn0UHaxT0PpiF8GdnD{font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}._1hfKJFEPrttZEl-210qHVZ{font-family:Arial,SegoeUI-Regular-final,Segoe UI,Segoe,Tahoma,Helvetica,sans-serif}',""]),t.locals={displayBlock:"_22TDZKfd8po04Ubj0xsW9l",segoeRegular:"_3ULy8C7ufHr_RwpL9zRMe3",segoeSemibold:"S40eQ7RniUA3-WTWmj-z1",segoeLight:"lrkLSOxXMbvez0pu7_yIi",segoeSemiLight:"_3fVHvn0UHaxT0PpiF8GdnD",arialRegular:"_1hfKJFEPrttZEl-210qHVZ"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=n(192),o=n(242),a=n(243),s=n(244),u=n(193),c=n(75),l=n(87),d=n(102),p="POST",f=function(){function e(e,t,n,r,i){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(i),c.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!c.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,r,i,a){try{if(c.useFetchRequest())fetch(e,{body:t,method:p}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),i(e.status,t)})).catch((function(e){r(0,{})}));else if(c.useXDomainRequest()){var s=new XDomainRequest;s.open(p,e),s.onload=function(){i(200,null)},s.onerror=function(){r(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else{var u=new XMLHttpRequest;u.open(p,e,!a),u.onload=function(){i(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){r(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){n(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=r.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,o){var a=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,u="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(l.default.eventsRejected(e[d],r.AWTEventsRejectedReason.KillSwitch),delete e[d]):(u.length>0&&(u+=","),u+=d,s++));if(s>0){var p=i.default.getPayloadBlob(e,s);p.remainingRequest&&this._requestQueue.push(p.remainingRequest);var f=this._urlString+"&x-apikey="+u+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var d in h=c.isUint8ArrayAvailable()?new Uint8Array(p.payloadBlob):i.default.base64Encode(p.payloadBlob),e)if(e.hasOwnProperty(d))for(var g=0;g<e[d].length;++g)e[d][g].sendAttempt>0?e[d][g].sendAttempt++:e[d][g].sendAttempt=1;if(this._useBeacons&&n&&c.isBeaconsSupported()&&navigator.sendBeacon(f,h))return;this._httpInterface.sendPOST(f,h,(function(r,i){a._retryRequestIfNeeded(r,i,e,s,u,t,n,o)}),(function(r,i){a._retryRequestIfNeeded(r,i,e,s,u,t,n,o)}),(function(r,i){a._retryRequestIfNeeded(r,i,e,s,u,t,n,o)}),n||o)}else n||this._handleRequestFinished(!1,{},n,o)}catch(e){this._handleRequestFinished(!1,{},n,o)}},e.prototype._retryRequestIfNeeded=function(e,t,n,i,a,s,u,c){var p=this,f=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var g=0;g<h.length;++g)l.default.eventsRejected(n[h[g]],r.AWTEventsRejectedReason.KillSwitch),delete n[h[g]],i--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,u,c);(!o.default.shouldRetryForStatus(e)||i<=0)&&(f=!1)}if(f)if(c)this._activeConnections--,n[a][0].priority=r.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var m in n)n.hasOwnProperty(m)&&l.default.eventsRetrying(n[m]);setTimeout((function(){return p._sendRequest(n,s+1,!1)}),o.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,u,c)},e.prototype._handleRequestFinished=function(e,t,n,i){for(var o in e&&d.default.clearBackOff(),t)t.hasOwnProperty(o)&&(e?l.default.eventsSent(t[o]):l.default.eventsDropped(t[o],r.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,i||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var i=n[r].split(": ");t[i[0]]=i[1]}return t},e}();t.default=f},function(e,t,n){"use strict";
/**
* microsoft.bond.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var r=n(237);t._BondDataType=r._BondDataType;var i=n(238);t._Encoding=i;var o=n(241);t.IO=o;var a=n(119);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=i._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=i._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(i._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=i._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?r._BondDataType._BT_STOP_BASE:r._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=i._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=i._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,n){"use strict";
/**
* bond_const.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,n){"use strict";
/**
* microsoft.bond.encoding.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var r=n(119),i=n(239),o=n(240);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],i=e.length%3,o=0,a=e.length-i;o<a;o+=3){var s=(e[o]<<16)+(e[o+1]<<8)+e[o+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(i){case 1:s=e[e.length-1];r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(u>>10)),r.push(n.charAt(u>>4&63)),r.push(n.charAt(u<<2&63)),r.push("=")}return r.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return i.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=r.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,i=n<<1|t>>>31,o=t<<1;2147483648&n&&(i=~i,o=~o);var a=new r.UInt64("0");return a.low=o,a.high=i,a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* microsoft.bond.floatutils.ts
* Copyright: Microsoft 2016
*
* This class will be used to convert float/double to byte array on browsers which don't support html5.
*
* Format: IEEE-754, littleEndian, http://en.wikipedia.org/wiki/IEEE_754-1985
*
*  \note
* 1. Don't have negative zero. All zero will be positive zero.
* 2. If the buffer array passed to ConvertArrayToFloat() is actual NaN or Inifinity value,
*    exception will be raised.
*/
var r=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,i=1-r,o=r,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),u=e-s,c=2*(r+2)+n,l=new Array(c),d=0;d<c;)l[d++]=0;for(d=r+2;d&&s;)l[--d]=s%2,s=Math.floor(s/2);for(d=r+1;d<c-1&&u>0;)(u*=2)>=1?(l[++d]=1,--u):l[++d]=0;for(var p=0;p<c&&!l[p];)p++;var f=r+1-p,h=p+n;if(l[h+1]){for(d=h;d>p&&(l[d]=1-l[d],!l);--d);d===p&&++f}if(f>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<i)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(d=0;d<20;++d)g=g<<1|l[++p];for(var m=0;d<52;++d)m=m<<1|l[++p];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(g=a<<31|2147483647&(g|=f+r<<20)),g>>8&255,g>>16&255,g>>>24]}var v=0;for(d=0;d<23;++d)v=v<<1|l[++p];return[255&(v=a<<31|2147483647&(v|=f+r<<23)),v>>8&255,v>>16&255,v>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=r},function(e,t,n){"use strict";
/**
* microsoft.bond.utils.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* microsoft.bond.io.ts
* Copyright: Microsoft 2016
*/
var r=n(119),i=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(r.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTRetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=r},function(e,t,n){"use strict";
/**
* AWTKillSwitch.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),i=0;i<n.length;++i)this._killedTokenDictionary[n[i]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTClockSkewManager.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var r=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),i=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===r.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102),i=function(){function e(){}return e.setEventsHandler=function(e){r.default.setEventsHandler(e)},e.getEventsHandler=function(){return r.default.getEventsHandler()},e.scheduleTimer=function(){r.default.scheduleTimer()},e}();t.default=i},function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._2uADMJLObqU6-D8E2WMFGs{height:calc(100vh - 115px)}._2FUcIOFrpfKDLRAOeLwVBq{height:calc(100vh - 113px)}._2tOq8gUtSMT8ioGkuRDJ2y{height:calc(100vh - 73px)}",""]),t.locals={flexPaneContentContainer:"_2uADMJLObqU6-D8E2WMFGs",flexPaneContentContainerForThinHeader:"_2FUcIOFrpfKDLRAOeLwVBq",flexPaneContentContainerForShyHeader:"_2tOq8gUtSMT8ioGkuRDJ2y"}},function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'._2fepbX3lMhlNbWhda-NpPt{font-family:ShellFabricMDL2IconsLite,ShellFabricMDL2Icons;line-height:1}._2fepbX3lMhlNbWhda-NpPt .o365cs-base [class*=" ms-Icon--"]:before,._2fepbX3lMhlNbWhda-NpPt .o365cs-base [class^=ms-Icon--]:before{font-family:inherit}.IBLY0F7ZnVavg0dPoF6Xe,.SfEVBSJxpboOJ7hk3TGrV{height:100%}',""]),t.locals={customHeaderButton:"_2fepbX3lMhlNbWhda-NpPt",customHeaderButtonsContainer:"IBLY0F7ZnVavg0dPoF6Xe",customHeaderButtonWrapper:"SfEVBSJxpboOJ7hk3TGrV"}},function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"._18Wa9NhGvSPa8YM3XGsyAk,._20G8i4pj8np9WEPbwGQx8D{-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.Ihgs_qQEHyIRBdeOPH9mY,._3jgcXZoldA7BNi00q9XlE9{width:100%;height:8px;visibility:hidden;display:none}._3jgcXZoldA7BNi00q9XlE9{background:transparent;cursor:pointer}._3jgcXZoldA7BNi00q9XlE9:hover{opacity:.4;background:#404040}._3vj3UeTtRA7c6EIC56t6j1{position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}._3X64oCcCxE8F2x9HwerOe3{-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}._3A7N0wqrn89bSiVx66V_9n{-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}._1EOhrQrF_MCEBXzSuYAtMn{-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.bkpL3WQBjeVDK6fWzuvAC{-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"_18Wa9NhGvSPa8YM3XGsyAk",workloadDivAnimations:"_20G8i4pj8np9WEPbwGQx8D",shyHeader:"Ihgs_qQEHyIRBdeOPH9mY",shyHeaderOverlay:"_3jgcXZoldA7BNi00q9XlE9",shyHeaderGripper:"_3vj3UeTtRA7c6EIC56t6j1",headerSlideIn:"_3X64oCcCxE8F2x9HwerOe3",headerSlideOut:"_3A7N0wqrn89bSiVx66V_9n",workloadDivSlideIn:"_1EOhrQrF_MCEBXzSuYAtMn",workloadDivSlideOut:"bkpL3WQBjeVDK6fWzuvAC"}},,,,,function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(2),o=n(27),a=n(14),s=n(3),u=n(100),c=n(30),l=n(0),d=n(4),p=n(38),f=n(49),h=n(69);function g(e){return new Promise((function(t,n){var i=Object(s.C)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));f.a.Instance.Service.callWebClientShellServiceFunction(i,"GET",null,null).then((function(e){t(e)})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}var m="AppsPinnedData",v=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"],y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastAppsPinnedDataWriteTimestampKey=new h.c("User","Suite","LastAppsPinnedDataWriteTimestamp"),t.cachedAppsDataKey=new h.c("User","Suite","CachedAppsData"),t}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;window.O365Shell.OnSuiteAPILoaded((function(){e.initializeInternal()}))},t.prototype.componentDidUpdate=function(e){this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&((!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)&&this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization())},t.prototype.render=function(){return null},t.prototype.initializeInternal=function(){var e=this,t=this.props.appsPinnedData;this.props.disableSessionStorageCache?this.updateAppsFromStorage():null!=t?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((function(n){n&&t.timestamp<n?e.readAppsPinnedData(1):e.updateApps(t,!0)})).catch((function(){e.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);var n=Object(r.c)();n.subscribe("AppIconRequested",(function(t){g(t).then((function(n){e.props.onSetImageDataUrl(t.CollectorId,t.Id,"data:"+n.MimeType+";base64,"+n.Base64EncodedImage)})).catch((function(){}))})),n.subscribe("AppDataDetailsRequested",(function(t){e.getAppDataDetailsAsync(t).then((function(n){n.CollectorId=t.CollectorId,e.props.onSetAppDataDetails(n)})).catch((function(){}))}),!0),n.subscribe("AppsReset",(function(){e.props.onSetAppsPinnedData({apps:[]})})),n.subscribe("AppsUpdate",(function(){e.updateAppsFromCollectors()}))},t.prototype.readAppsPinnedData=function(e){var t=this;this.readAppsPinnedDataFromStorageAsync().then((function(e){t.updateApps(e,!0)})).catch((function(){t.updateApps(t.props.appsPinnedData,!1),Object(r.f)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e)}))},t.prototype.updateApps=function(e,t){var n=this;e&&e!==this.props.appsPinnedData&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((function(e){if(e)if(Date.now()-e.timestamp>n.props.appsUpdateTimeSpan||e.cultureName!==n.props.cultureName)n.updateAppsFromStorage();else{var t=!0;n.props.appDataCache&&!n.props.moreAppDataAvailable&&n.props.timestamp>=e.timestamp&&(t=!1),t&&n.updateMyApps(e.apps,1)}else n.updateAppsFromStorage()})).catch((function(){n.updateAppsFromStorage()}))},t.prototype.updateAppsFromStorage=function(){var e=this;this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((function(t){e.onReadAppDataCacheSucceeded(t)})).catch((function(){e.updateAppsFromCollectors()}))},t.prototype.onReadAppDataCacheSucceeded=function(e){for(var t={},n=function(n){var i=e[n];if(i&&i.Apps)t[n]=i.Apps;else{var o=r.props.appsData.filter((function(e){return e.CollectorId===n}));o.length>0&&(t[n]=o)}},r=this,i=0,o=v;i<o.length;i++){n(o[i])}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()},t.prototype.updateAppsFromCollectors=function(){var e=this;this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||this.getAllAppsFromCollectorsAsync().then((function(t){e.onGetAllAppsSucceeded(t)})).catch((function(){e.invokeAppsUpdatedEvent(null,0,3)}))},t.prototype.onGetAllAppsSucceeded=function(e){if(0!==Object.keys(e).length){for(var t=function(t){if(!e[t]){var r=n.props.appsData.filter((function(e){return e.CollectorId===t}));r.length>0&&(e[t]=r)}},n=this,r=0,i=v;r<i.length;r++){t(i[r])}this.onAppDataDictionaryFetched(e,3)}},t.prototype.onAppDataDictionaryFetched=function(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((function(){}))},t.prototype.getFirstPartyAppsFromAppsData=function(e,t){for(var n=[],r=0,i=e.filter((function(e){return"FirstParty"===e.CollectorId}));r<i.length;r++){var o=i[r],a=Object(p.b)(t,"FirstParty",o.Id);null!=a&&(o.AlternateNames=a.AlternateNames,o.DateInstalled=a.DateInstalled),n.push(o)}if(!n.some((function(e){return"Partner"===e.Id}))){var s=Object(p.b)(t,"FirstParty","Partner");null!=s&&n.push(s)}return n},t.prototype.updateMyApps=function(e,t){var n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)},t.prototype.invokeAppsUpdatedEvent=function(e,t,n){var i={Apps:e,DataSource:t,FailureReason:n},o=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";Object(r.c)().invoke(o,i)},t.prototype.hasAppsPinnedDataChanged=function(e){var t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(var r=0;r<t.length;r++)if(t[r].CollectorId!==n[r].CollectorId||t[r].Id!==n[r].Id)return!0;return!1},t.prototype.saveCustomization=function(){var e=this,t=this.props.appsPinnedData.apps.map((function(e){return e.Id}));Object(r.f)().tag("AppsManager_SavingAppsCustomizationData",1,t.join());var n=Date.now();if("number"==typeof n)this.props.appsPinnedData.timestamp=n,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((function(){e.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e.props.appsPinnedData.timestamp).catch((function(){}))})).catch((function(){}));else{var i=null;try{i=Date.now.toString()}catch(e){}Object(r.f)().tag("AppsManager_InvalidDateNowFunction",6,n,i)}},t.prototype.aggregateAppDatas=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];e[i]&&t.push.apply(t,e[i])}return t},t.prototype.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var i=f.a.Instance.WebShellStorage.createWebShellStorageRequest();i.requestRead(e.lastAppsPinnedDataWriteTimestampKey),f.a.Instance.WebShellStorage.readSessionStorage(i).then((function(n){n.hasValue(e.lastAppsPinnedDataWriteTimestampKey)?t(n.getValue(e.lastAppsPinnedDataWriteTimestampKey)):t()})).catch((function(e){Object(r.f)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e),n(e)}))}))},t.prototype.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,r){var i=f.a.Instance.WebShellStorage.createWebShellStorageRequest();i.requestWrite(e,t.lastAppsPinnedDataWriteTimestampKey),f.a.Instance.WebShellStorage.writeSessionStorage(i).then((function(){n()})).catch((function(e){d.h.genericServiceRejection("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,r)}))}))},t.prototype.readAppsPinnedDataFromStorageAsync=function(){return new Promise((function(e,t){f.a.Instance.WebShellStorage.readStorage(h.e.User,h.b.SystemMetadata,m).then((function(t){var n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=Object(s.H)(n.timestamp).getTime()),e(n)})).catch((function(e){d.h.genericServiceRejection("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))},t.prototype.writeAppsPinnedDataToStorageAsync=function(e){if(e&&e.apps){var t=e.apps.length;e.apps=Object(p.a)(e.apps),t>e.apps.length&&Object(r.f)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,t,e.apps.length)}return new Promise((function(t,n){f.a.Instance.WebShellStorage.writeStorage(h.e.User,h.b.SystemMetadata,m,e).then((function(){t()})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e),n(e)}))}))},t.prototype.readAppDataCacheFromStorageAsync=function(){var e=this;return new Promise((function(t,n){var i=Object(s.C)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",e.props.hasMailboxInCloud.toString(),e.props.cultureName);f.a.Instance.Service.callWebClientShellServiceFunction(i,"GET",null,null).then((function(e){t(e)})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e),n(e)}))}))},t.prototype.getAllAppsFromCollectorsAsync=function(){var e=this;return new Promise((function(t,n){var i=Object(s.C)("/api/myapps/GetAllApps?culture={0}",e.props.cultureName);f.a.Instance.Service.callWebClientShellServiceFunction(i,"GET",null,null).then((function(e){t(e)})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("AppsManager_AppCollectorFetch_Failed",6,e),n(e)}))}))},t.prototype.readCachedAppsFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var i=f.a.Instance.WebShellStorage.createWebShellStorageRequest();i.requestRead(e.cachedAppsDataKey),f.a.Instance.WebShellStorage.readSessionStorage(i).then((function(n){n.hasValue(e.cachedAppsDataKey)?t(n.getValue(e.cachedAppsDataKey)):t()})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode),n(e)}))}))},t.prototype.writeCachedAppsToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,r){var i=f.a.Instance.WebShellStorage.createWebShellStorageRequest();i.requestWrite(e,t.cachedAppsDataKey),f.a.Instance.WebShellStorage.writeSessionStorage(i).then((function(){n()})).catch((function(e){d.h.genericServiceRejection("AppsManager_WriteCacheAppsData_Failed",6,e,r)}))}))},t.prototype.getAppDataDetailsAsync=function(e){var t=this;return new Promise((function(n,i){var o=Object(s.C)("/api/myapps/GetAppDetails?culture={0}",t.props.cultureName),a={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};f.a.Instance.Service.callWebClientShellServiceFunction(o,"POST",null,a).then((function(e){n(e)})).catch((function(e){d.h.isCallsBlockedException(e)||Object(r.f)().exception("Apps_FetchDetailsForCollector_Failed",6,e),i(e)}))}))},t}(i.Component),S=Object(a.b)((function(e){return{appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,disableSessionStorageCache:Object(c.c)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)}}),(function(e){return{onSetAppsData:function(t,n){e(Object(s.J)(t,n))},onSetAppsPinnedData:function(t){e(Object(u.d)(t))},onEnableCustomization:function(){e(Object(u.a)())},onSetImageDataUrl:function(t,n,r){e(Object(s.L)(t,n,r))},onSetAppDataDetails:function(t){e(Object(u.c)(t))}}}))(y);function b(e,t){return t?Object(l.__assign)(Object(l.__assign)({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil}):e}var T={appsManagerState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=b(s.r,n.clientData)}switch(t.type){case s.h:return b(e,t.shellClientData);default:return e}}},C=n(64),_=n(50),O=Object(s.D)(),I=function(){function e(){this.callbackPairings=[]}return e.prototype.IsCustomizationEnabled=function(){return O.getState().appLauncherState.isCustomizable},e.prototype.IsPinned=function(e,t){return null!=_.b(O.getState().appLauncherState.pinnedAppTiles,e,t)},e.prototype.Pin=function(e,t){var n;"string"==typeof e?n=p.b(O.getState().appsDataState.apps,e,t):(Object(r.f)().tag("AppLauncher_PinnedCalledWithAppData",1),n=p.b(O.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&O.dispatch(Object(C.g)(n))},e.prototype.Unpin=function(e,t){O.dispatch(Object(C.n)(e,t))},e.prototype.Reset=function(){Object(r.c)().invoke("AppsReset")},e.prototype.Update=function(){Object(r.c)().invoke("AppsUpdate")},e.prototype.OnAppsUpdated=function(e){var t=this,n=function(n){e(t.deepCloneAppsUpdatedEventArgs(n))},i=Object(r.c)(),o=i.subscribe("AppsRetrievalSucceeded",n,!0),a=i.subscribe("AppsRetrievalFailed",n,!0);return this.callbackPairings.push({successCallbackToken:o,failureCallbackToken:a}),o},e.prototype.RemoveOnAppsUpdated=function(e){for(var t=0,n=Object(r.c)(),i=0,o=this.callbackPairings;i<o.length;i++){var a=o[i];if(a.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",a.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",a.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)},e.prototype.GetAuthenticatedAppIcon=function(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?g(e).then(t).catch((function(){t(null)})):t(null)},e.prototype.deepCloneAppsUpdatedEventArgs=function(e){var t=JSON.parse(JSON.stringify(e));if(t.Apps)for(var n=0,r=t.Apps;n<r.length;n++){var i=r[n];"FirstParty"===i.CollectorId&&(i.Id=p.e(i.Id,"add"))}return t},e}();function w(e,t){if(e.IsAuthenticated&&t.Timestamp>0){Object(r.c)().unsubscribe("ShellDataUpdated",w);var n=Object(s.D)();o.render(i.createElement(a.a,{store:n},i.createElement(S,null)),document.createElement("div"))}}var A,D=n(46);n(161);var x=n(52),P=n(24),E=n(15),k=n(137),R=n(53),L=n(9),N=n(7),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(r.f)().perfMarker("HelpTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:N.a.Help_Title,affordanceMenuItemText:N.a.Help,iconID:this.props.flipHelpIcon?"HelpMirrored":"Help",iconFontSize:L.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(R.b,Object(l.__assign)({},e)):i.createElement(R.a,Object(l.__assign)({},e))},t}(i.Component),U=Object(a.b)((function(e,t){var n,r;return{isAvailable:!(null===(r=null===(n=e.shellInitDataState)||void 0===n?void 0:n.clientData)||void 0===r?void 0:r.HelpPaneDisabled),id:t&&t.id,isActive:e.flexPaneState&&"Help"===e.flexPaneState.activeProviderKey,flipHelpIcon:e.headerState&&e.headerState.flipHelpIcon,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),Object(r.f)().click("Help","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),e(Object(s.Q)(t&&t.currentTarget&&t.currentTarget.id));var i=Object(r.g)();!i||null!=i.OnHelpButtonClick&&i.OnHelpButtonClick()||e(Object(P.f)("Help")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var r=Object(l.__assign)(Object(l.__assign)({},n),e);return Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(M);var F=n(62),j=n(74),B=n(48),W=n(97),q=null,H=function(){function e(e,t,n,r,i){this.serverRequestInfluxControl=i,this.context={};var o={disableCookiesUsage:!0};t&&t.length>0&&(o.collectorUri=t),F.AWTLogManager.setTransmitProfile(F.AWT_NEAR_REAL_TIME),this.ariaLogger=F.AWTLogManager.initialize(e,o),n||(n="undefined"),r||(r="undefined"),this.registerContextParam("AppInfo.Id",n),this.registerContextParam("AppInfo.Version",r),this.serverRequestInfluxControl||(this.serverRequestInfluxControl=5),this.serverRequestInfluxControl<0&&(this.serverRequestInfluxControl=0),this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.registerContextParam=function(e,t,n){void 0===n&&(n=0),this.context[e]=t,this.ariaLogger.setContextWithPii(e,t,0===n?F.AWTPiiKind.NotSet:F.AWTPiiKind.GenericData)},e.prototype.writeEvent=function(e){if(null!=e){if(!(e.name!==j.a.Impression&&e.name!==j.a.Click||"true"!==this.context.Context_IsConsumer||"ToDo"!==this.context.Context_Site&&"StickyNotes"!==this.context.Context_Site))return;if(e.name===j.a.ServerRequest){var t=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(t.length>0&&t[0].value>=200&&t[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var n=new F.AWTEventProperties(j.a[e.name]);n.setType(j.c[e.type]),n.setTimestamp(e.timestamp),e.properties.forEach((function(e){n.setPropertyWithPii(e.name,e.value,0===e.piiKind?F.AWTPiiKind.NotSet:F.AWTPiiKind.GenericData)})),this.ariaLogger.logEvent(n);0}},e}();function G(e,t){null==q&&t.AriaTelemetryEnabled&&t.AriaTelemetryTenantToken&&(!t.IsConsumerShell&&t.PUID?Object(W.a)(t)&&t.TID&&z(e,t):z(e,t))}function z(e,t){var n=window.O365ShellVerStr||"unknown",i=t.Environment||"unknown",o=t.AriaTelemetryTenantToken||"c6c190a1b73c4a63bba89835d546cf28-f2a0482f-a00d-48d9-822e-e89cc89eb64d-7688",a=Object(r.g)();a&&a.testTraffic&&(o="c0c8ed88b81549bd84e261ebe62ccaae-cea55197-8121-49f9-826d-f682812729c3-7350"),(q=new H(o,t.AriaTelemetryUri,"OneShell",n,t.AriaTelemetryServerRequestInfluxControl)).registerContextParam("Context_Env",i),q.registerContextParam("Context_Site",t.WorkloadId),q.registerContextParam("Context_SiteSubId",e.CurrentMainLinkElementID),q.registerContextParam("Context_WorkloadAppId",Object(c.a)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL)),q.registerContextParam("Context_SID",t.SHSID),window.O365ShellContext.SID=t.SHSID;var s=j.b.getNewID();q.registerContextParam("Context_PID",s),window.O365ShellContext.PID=s,q.registerContextParam("Context_TID",t.TID),q.registerContextParam("Context_UID",t.UID),q.registerContextParam("Context_PUID",t.PUID?t.PUID.toUpperCase():""),q.registerContextParam("Context_IsConsumer",t.IsConsumerShell?"true":"false"),q.registerContextParam("Context_Flights",e.FlightName),q.registerContextParam("Context_FlightRings",t.FlightRing),q.registerContextParam("Context_Segment",t.ActiveExperiences),q.registerContextParam("UserInfo.OMSTenantId",t.TID),q.registerContextParam("UserInfo.Id",t.PUID?t.PUID.toUpperCase():""),q.registerContextParam("UserInfo.IdType",t.IsConsumerShell?"MSAPUID":"OrgIdPUID"),a.correlationID&&(q.registerContextParam("Context_CID",B.f(a.correlationID)),window.O365ShellContext.CID=a.correlationID),a.workloadContext&&q.registerContextParam("Context_WorkloadContext",B.f(a.workloadContext));var u=Object(r.f)();u.registerService(q),u.IsConsumer=t.IsConsumerShell,Object(r.c)().unsubscribe("ShellDataUpdated",G),window.addEventListener("beforeunload",K),window.O365ShellContext.Aria={createLogger:function(e){var t=new F.AWTLogger(e);return t.logSession(F.AWTSessionState.Started),t}}}function K(){try{F.AWTLogManager.flushAndTeardown()}catch(e){}}var V=n(199),Z=n(79),Q=n(18),X=n(91),J=n(61),Y=n(25),$="constructor",ee="prototype",te="function",ne="_dynClass",re="_unknown_",ie=Object,oe=ie.getPrototypeOf,ae=0;function se(e,t){return e&&ie.prototype.hasOwnProperty.call(e,t)}function ue(e){return e&&(e===ie.prototype||e===Array.prototype)}function ce(e){return ue(e)||e===Function.prototype}function le(e){if(e){if(oe)return oe(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function de(e,t){var n=[],r=ie.getOwnPropertyNames;if(r)n=r(e);else for(var i in e)"string"==typeof i&&se(e,i)&&n.push(i);if(n&&n.length>0)for(var o=0;o<n.length;o++)t(n[o])}function pe(e,t,n){return t!==$&&typeof e[t]===te&&(n||se(e,t))}function fe(e){throw new TypeError("DynamicProto: "+e)}function he(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function ge(e,t,n,r){var i=null;if(e&&se(n,ne)){var o=e._dynInstFuncs||{};if((i=(o[n._dynClass]||{})[t])||fe("Missing ["+t+"] "+te),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!se(e,t),s=le(e),u=[];a&&s&&!ce(s)&&!he(u,s);){var c=s[t];if(c){a=c===r;break}u.push(s),s=le(s)}try{a&&(e[t]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function me(e,t,n){var r=t[e];return r===n&&(r=le(t)[e]),typeof r!==te&&fe("["+e+"] is not a "+te),r}function ve(e,t,n,r,i){if(!ue(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),de(n,(function(t){pe(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!se(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(ge(this,t,e,n)||me(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function ye(e,t){return se(e,ee)?e.name||t||re:((e||{}).constructor||{}).name||t||re}function Se(e,t,n,r){se(e,ee)||fe("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){for(var n=le(t);n&&!ce(n);){if(n===e)return!0;n=le(n)}return!1})(i,t)||fe("["+ye(e)+"] is not in class hierarchy of ["+ye(t)+"]");var o=null;se(i,ne)?o=i._dynClass:(o="_dynCls$"+ye(e,"_")+"$"+ae,ae++,i._dynClass=o);var a=Se._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var t={};return de(e,(function(n){!t[n]&&pe(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o={};de(n,(function(e){o[e]=i(t,n,e)}));for(var a=le(e),s=[];a&&!ce(a)&&!he(s,a);)de(a,(function(e){!o[e]&&pe(a,e,!oe)&&(o[e]=i(t,a,e))})),s.push(a),a=le(a);return o}(i,t,u,s));var c=!!oe&&!!a.setInstFuncs;c&&r&&(c=!!r.setInstFuncs),ve(i,o,t,u,!1!==c)}Se._dfOpts={setInstFuncs:!0,useBaseInst:!0};var be=Se,Te=Object,Ce=Te[Y.g],_e=Ce.hasOwnProperty,Oe=Te.defineProperty,Ie=Te.assign;
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */Te.freeze,Te.seal;function we(e){return Ce.toString.call(e)}function Ae(e,t){return typeof e===t}function De(e){return void 0===e||typeof e===Y.h}function xe(e){return null===e||De(e)}function Pe(e){return!xe(e)}function Ee(e,t){return e&&_e.call(e,t)}function ke(e){return typeof e===Y.f}function Re(e){return typeof e===Y.e}function Le(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!xe(e))try{xe(e.addEventListener)?xe(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function Ne(e,t,n,r){if(void 0===r&&(r=!1),!xe(e))try{xe(e.removeEventListener)?xe(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}function Me(e,t){if(e)for(var n in e)_e.call(e,n)&&t.call(e,n,e[n])}function Ue(e,t){if(e&&t){var n=t.length,r=e.length;if(e===t)return!0;if(r>=n){for(var i=r-1,o=n-1;o>=0;o--){if(e[i]!=t[o])return!1;i--}return!0}}return!1}function Fe(e,t){var n=!1;if(e&&t){var r=t.length;if(e===t)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}}return n}function je(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function Be(e){return"[object Date]"===we(e)}function We(e){return"[object Array]"===we(e)}function qe(e){return"[object Error]"===we(e)}function He(e){return"string"==typeof e}function Ge(e){return"number"==typeof e}function ze(e){return"boolean"==typeof e}function Ke(e){if(Be(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Ve(e,t,n){for(var r=e.length,i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}function Ze(e,t,n){for(var r=e.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o;return-1}function Qe(e,t,n){for(var r=e.length,i=n||e,o=new Array(r),a=0;a<r;a++)a in e&&(o[a]=t.call(i,e[a],e));return o}function Xe(e,t,n){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++;return r}function Je(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var Ye=!{toString:null}.propertyIsEnumerable("toString"),$e=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function et(e){var t=typeof e;if(t!==Y.e&&(t!==Y.f||null===e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)e&&_e.call(e,r)&&n.push(r);if(Ye)for(var i=$e.length,o=0;o<i;o++)e&&_e.call(e,$e[o])&&n.push($e[o]);return n}function tt(e,t,n,r){if(Oe)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),Oe(e,t,i),!0}catch(e){}return!1}function nt(){var e=Date;return e.now?e.now():(new e).getTime()}function rt(e,t,n,r,i){var o=n;return e&&((o=e[t])===n||i&&!i(o)||r&&!r(n)||(o=n,e[t]=o)),o}function it(e){return!e}function ot(e){return!!e}function at(e){throw new Error(e)}function st(e){return e&&(e=Te(Ie?Ie({},e):e)),e}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var ut,ct=function(){function e(t,n,r){var i,o=this,a=!1;(o.start=nt(),o.name=t,o.isAsync=r,o.isChildEvt=function(){return!1},Re(n))&&(a=tt(o,"payload",(function(){return!i&&Re(n)&&(i=n(),n=null),i})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,r=o.getCtx(e.ChildrenContextKey);if(We(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}o.time=nt()-o.start,o.exTime=o.time-t,o.complete=function(){},!a&&Re(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),lt=function e(t){this.ctx={},be(e,this,(function(e){e.create=function(e,t,n){return new ct(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))},dt="CoreUtils.doPerf";function pt(e,t,n,r,i){if(e){var o=e;if(o&&Re(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(dt);try{if(a=o.create(t(),r,i)){if(s&&a.setCtx&&(a.setCtx(ct.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(ct.ChildrenContextKey);u||(u=[],s.setCtx(ct.ChildrenContextKey,u)),u.push(a)}return o.setCtx(dt,a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx(dt,s)}}}return n()}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(ut||(ut={}));var ft={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103},ht=Y.h,gt=Y.f,mt=Y.g,vt=(Y.e,"window"),yt="JSON",St="msie",bt="trident/",Tt=null,Ct=null,_t=!1;
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var Ot=Y.c;function It(e){var t=Ot();return t&&t[e]?t[e]:e===vt&&wt()?window:null}function wt(){return Boolean(typeof window===gt&&window)}function At(){return wt()?window:It(vt)}function Dt(){return Boolean(typeof document===gt&&document)?document:It("document")}function xt(){return Boolean(typeof navigator===gt&&navigator)}function Pt(){return xt()?navigator:It("navigator")}function Et(e){if(e&&_t){var t=It("__mockLocation");if(t)return t}return typeof location===gt&&location?location:It("location")}function kt(){return Boolean(typeof JSON===gt&&JSON||null!==It(yt))}function Rt(){return kt()?JSON||It(yt):null}function Lt(){var e=Pt();return!(!e||!e.product)&&"ReactNative"===e.product}function Nt(){var e=Pt();if(e&&(e.userAgent!==Ct||null===Tt)){var t=((Ct=e.userAgent)||"").toLowerCase();Tt=je(t,St)||je(t,bt)}return Tt}function Mt(e){var t=Object[Y.g].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":kt()&&(n=Rt().stringify(e)),t+n}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */function Ut(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Ft=function(){function e(e,t,n,r){void 0===n&&(n=!1);var i=this;i.messageId=e,i.message=(n?"AI: ":"AI (Internal): ")+e;var o="";kt()&&(o=Rt().stringify(r));var a=(t?" message:"+Ut(t):"")+(r?" props:"+Ut(o):"");i.message+=a}return e.dataType="MessageData",e}();var jt=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};be(e,this,(function(e){function i(e,n){var r=t[e];return xe(r)?n:r}xe(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,o,a){void 0===a&&(a=!1);var s=new Ft(n,i,a,o);if(e.enableDebugExceptions())throw s;if(!De(s)&&s&&!De(s.message)){var u=e.consoleLoggingLevel();if(a){var c=+s.messageId;!r[c]&&u>=ut.WARNING&&(e.warnToConsole(s.message),r[c]=!0)}else u>=ut.WARNING&&e.warnToConsole(s.message);e.logInternalMessage(t,s)}},e.warnToConsole=function(e){var t=typeof console!==ht?console:It("console");if(t){var n="log";t.warn&&(n="warn"),Re(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+i.messageId;if(r[a]?o=!1:r[a]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new Ft(ft.MessageLimitPerPVExceeded,s,!1);e.queue.push(u),e.warnToConsole(s)}}}}))},Bt=function(e,t){var n=this,r=null,i=Re(e.processTelemetry),o=Re(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var u=e?e.identifier:"TelemetryPluginChain";pt(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(ut.CRITICAL,ft.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function Wt(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&Re(o.processTelemetry)){var a=new Bt(o,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var qt=function e(t,n,r,i){var o=this,a=null;null!==i&&(t&&Re(t.getPlugin)?a=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var o=e.getPlugin();(i||o===n)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(n),Wt(r,t)}(t,o,i||t.getPlugin()):i?a=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],Ve(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),Wt(r,t)}(t,o,i):De(i)&&(a=Wt(t,o))),o.core=function(){return r},o.diagLog=function(){return function(e,t){return(e||{}).logger||new jt(t)}(r,n)},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},o.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!xe(a[t])?i=a[t]:n&&!xe(n[t])&&(i=n[t]),xe(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,i){return void 0===t&&(t=null),new e(t||a,n,r,i)}},Ht="extensionConfig",Gt=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&Re(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var o=n||new qt(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&rt(i,Ht,[],null,xe),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,n=new qt(s,i,o,u),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}();
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */function zt(e,t){for(var n=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&Re(r.setNextPlugin)&&Re(o.processTelemetry)&&r.setNextPlugin(o),Re(o.isInitialized)&&o.isInitialized()||n.push(o),r=o,i=i.getNext())}Ve(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function Kt(e){return e.sort((function(e,t){var n=0,r=Re(t.processTelemetry);return Re(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var Vt=500,Zt=function(e){function t(){var n,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){Ve(e,(function(e){e.priority<Vt&&at("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,be(t,r,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&Ve(n,(function(n){n.length>0&&r._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(r,o,a){e.isInitialized()||(t.initialize(r,o,a),function(e,t){n=[],e&&Ve(e,(function(e){return i(e)}));if(t){var r=[];Ve(t,(function(e){e.priority>Vt&&r.push(e)})),i(r)}}((r||{}).channels,a),Ve(n,(function(e){return zt(new qt(e,r,o),a)})))}})),r}var n;return __extends(t,e),t._staticInit=(tt(n=t.prototype,"ChannelControls",n.getChannelControls),void tt(n,"channelQueue",n.getChannelControls)),t}(Gt),Qt="toGMTString",Xt="toUTCString",Jt="expires",Yt="",$t=null,en=null,tn=null,nn=Dt(),rn={},on={};function an(e,t){var n=un._ckMgr||on._ckMgr;return n||(n=un._ckMgr=un(e,t),on._ckMgr=n),n}function sn(e){return!e||e.isEnabled()}function un(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(rt(t,"domain",e.cookieDomain,Pe,xe),rt(t,"path",e.cookiePath||"/",null,xe),xe(t.enabled)){var n=void 0;De(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),De(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||on),r=n.path||"/",i=n.domain,o=!1!==n.enabled,a={isEnabled:function(){var e=o&&cn(t),n=on._ckMgr;return e&&n&&a!==n&&(e=sn(n)),e},setEnabled:function(e){o=!1!==e},set:function(e,t,o,s,u){if(sn(a)){var c={},l=Je(t||Yt),d=l.indexOf(";");if(-1!==d&&(l=Je(t.substring(0,d)),c=ln(t.substring(d+1))),rt(c,"domain",s||i,ot,De),!xe(o)){var p=Nt();if(De(c.expires)){var f=nt()+1e3*o;if(f>0){var h=new Date;h.setTime(f),rt(c,Jt,dn(h,p?Qt:Xt)||dn(h,p?Qt:Xt)||Yt,ot)}}p||rt(c,"max-age",Yt+o,null,De)}var g=Et();g&&"https:"===g.protocol&&(rt(c,"secure",null,null,De),null===en&&(en=!gn((Pt()||{}).userAgent)),en&&rt(c,"SameSite","None",null,De)),rt(c,"path",u||r,null,De),(n.setCookie||hn)(e,pn(l,c))}},get:function(e){var t=Yt;return sn(a)&&(t=(n.getCookie||fn)(e)),t},del:function(e,t){sn(a)&&a.purge(e,t)},purge:function(e,r){if(cn(t)){var i=((o={}).path=r||"/",o.expires="Thu, 01 Jan 1970 00:00:01 GMT",o);Nt()||(i["max-age"]="0"),(n.delCookie||hn)(e,pn(Yt,i))}var o}};return a._ckMgr=a,a}function cn(e){if(null===$t){$t=!1;try{$t=void 0!==(nn||{}).cookie}catch(n){e&&e.throwInternal(ut.WARNING,ft.CannotAccessCookie,"Cannot access document.cookie - "+(qe(t=n)?t.name:""),{exception:Mt(n)})}}var t;return $t}function ln(e){var t={};e&&e.length&&Ve(Je(e).split(";"),(function(e){if(e=Je(e||Yt)){var n=e.indexOf("=");-1===n?t[e]=null:t[Je(e.substring(0,n))]=Je(e.substring(n+1))}}));return t}function dn(e,t){return Re(e[t])?e[t]():null}function pn(e,t){var n=e||Yt;return Me(t,(function(e,t){n+="; "+e+(xe(t)?Yt:"="+t)})),n}function fn(e){var t=Yt;if(nn){var n=nn.cookie||Yt;tn!==n&&(rn=ln(n),tn=n),t=Je(rn[e]||Yt)}return t}function hn(e,t){nn&&(nn.cookie=e+"="+t)}function gn(e){return!!He(e)&&(!(!je(e,"CPU iPhone OS 12")&&!je(e,"iPad; CPU OS 12"))||(!!(je(e,"Macintosh; Intel Mac OS X 10_14")&&je(e,"Version/")&&je(e,"Safari"))||(!(!je(e,"Macintosh; Intel Mac OS X 10_14")||!Ue(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!je(e,"Chrome/5")&&!je(e,"Chrome/6"))||(!(!je(e,"UnrealEngine")||je(e,"Chrome"))||!(!je(e,"UCBrowser/12")&&!je(e,"UCBrowser/11")))))))}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var mn=0,vn=1,yn=2,Sn=4,bn=5,Tn=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;be(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Ze(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Ze(e.listeners,t)},e.eventsSent=function(t){Ve(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){Ve(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){Ve(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Ve(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},Cn=function(e){function t(){var n=e.call(this)||this;return be(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],yn)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new jt(e),i||new Tn(e))},e.track=function(r){pt(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),at("Invalid telemetry item")),function(e){if(xe(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Ve(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Ke(new Date),baseType:Ft.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return __extends(t,e),t}((function e(){var t,n,r,i,o,a=!1;be(e,this,(function(e){e._extensions=new Array,n=new Zt,e.logger=Object(Y.d)({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return a},e.initialize=function(t,i,o,s){var u,c,l,d;e.isInitialized()&&at("Core should not be initialized more than once"),t&&!xe(t.instrumentationKey)||at("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=t||{},t.extensions=xe(t.extensions)?[]:t.extensions,(c=Ht,(u=t)?!(d=u[c])&&xe(d)&&(d=De(l)?{}:l,u[c]=d):d=De(l)?{}:l,d).NotificationManager=s,o&&(e.logger=o);var p=[];p.push.apply(p,i.concat(t.extensions)),p=Kt(p);var f=[],h=[],g={};Ve(p,(function(e){(xe(e)||xe(e.initialize))&&at("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(xe(g[t])?g[t]=r:o.warnToConsole("Two extensions have same priority #"+t+" - "+g[t]+", "+r)),!t||t<n.priority?f.push(e):h.push(e)})),p.push(n),f.push(n),p=Kt(p),e._extensions=p,zt(new qt([n],t,e),p),zt(new qt(f,t,e),p),e._extensions=f,0===e.getTransmissionControls().length&&at("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){rt(n,"iKey",e.config.instrumentationKey,null,it),rt(n,"time",Ke(new Date),null,it),rt(n,"ver","4.0",null,xe),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new qt(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=Object(Y.d)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return o||(o=un(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new lt(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Ve(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),_n=0,On=13,In=32,wn=1,An=2,Dn=3,xn=4,Pn=0,En=1,kn=6,Rn=7,Ln=Object(Y.a)(Object(Y.a)({},ft),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),Nn=4294967296,Mn=4294967295,Un=!1,Fn=123456789,jn=987654321;function Bn(e){e<0&&(e>>>=0),Fn=123456789+e&Mn,jn=987654321-e&Mn,Un=!0}function Wn(){try{var e=2147483647&nt();Bn((Math.random()*Nn^e)+e)}catch(e){}}function qn(e){return e>0?Math.floor(Hn()/Mn*(e+1))>>>0:0}function Hn(e){var t,n=It("crypto")||It("msCrypto");return n&&n.getRandomValues?t=n.getRandomValues(new Uint32Array(1))[0]&Mn:Nt()?(Un||Wn(),t=zn()&Mn):t=Math.floor(Nn*Math.random()|0),e||(t>>>=0),t}function Gn(e){e?Bn(e):Wn()}function zn(e){var t=((jn=36969*(65535&jn)+(jn>>16)&Mn)<<16)+(65535&(Fn=18e3*(65535&Fn)+(Fn>>16)&Mn))>>>0&Mn|0;return e||(t>>>=0),t}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var Kn,Vn=null;Y.h;function Zn(e,t){var n=!1,r=At();r&&(n=Le(r,e,t),n=Le(r.body,e,t)||n);var i=Dt();return i&&(n=nr.Attach(i,e,t)||n),n}function Qn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(tr,(function(e){var t=0|qn(15);return("x"===e?t:3&t|8).toString(16)}))}function Xn(){var e=It("performance");return e&&e.now?e.now():nt()}function Jn(e){void 0===e&&(e=22);for(var t=Hn()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Hn()<<2&4294967295|3&t)>>>0,n=0);return r}function Yn(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Hn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Hn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var $n,er={_canUseCookies:void 0,isTypeof:Ae,isUndefined:De,isNullOrUndefined:xe,hasOwnProperty:Ee,isFunction:Re,isObject:ke,isDate:Be,isArray:We,isError:qe,isString:He,isNumber:Ge,isBoolean:ze,toISOString:Ke,arrForEach:Ve,arrIndexOf:Ze,arrMap:Qe,arrReduce:Xe,strTrim:Je,objCreate:Y.d,objKeys:et,objDefineAccessors:tt,addEventHandler:Zn,dateNow:nt,isIE:Nt,disableCookies:function(){rr().setEnabled(!1)},newGuid:Qn,perfNow:Xn,newId:Jn,randomValue:qn,random32:Hn,mwcRandomSeed:Gn,mwcRandom32:zn,generateW3CId:Yn},tr=/[xy]/g,nr={Attach:Le,AttachEvent:Le,Detach:Ne,DetachEvent:Ne};function rr(e,t){var n=an(e,t),r=er._canUseCookies;return null===Vn&&(Vn=[],Kn=r,tt(er,"_canUseCookies",(function(){return Kn}),(function(e){Kn=e,Ve(Vn,(function(t){t.setEnabled(e)}))}))),-1===Ze(Vn,n)&&Vn.push(n),ze(r)&&n.setEnabled(r),ze(Kn)&&n.setEnabled(Kn),n}
/**
 * Utils.ts
 * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 * File containing utility functions.
 */
var ir="1DS-Web-JS-3.1.1",or=(($n={})[0]=Pn,$n[2]=kn,$n[1]=En,$n[3]=Rn,$n[4098]=kn,$n[4097]=En,$n[4099]=Rn,$n),ar=null,sr=(Boolean(Dt()),Boolean(At()));function ur(e){return!(""===e||xe(e))}function cr(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function lr(){return null===ar&&(ar=xt()&&Boolean(Pt().sendBeacon)),ar}function dr(e){return!!(e&&Ge(e)&&e>=wn&&e<=xn)}function pr(e,t,n){if(!t&&!ur(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||We(t))t={value:t};else if("object"!==r||t.hasOwnProperty("value")){if(xe(t.value)||""===t.value||!He(t.value)&&!Ge(t.value)&&!ze(t.value)&&!We(t.value))return null}else t={value:n?JSON.stringify(t):t};if(We(t.value)&&!Sr(t.value))return null;if(!xe(t.kind)){if(We(t.value)||!yr(t.kind))return null;t.value=t.value.toString()}return t}function fr(){if(void 0!==typeof XMLHttpRequest){var e=It("XMLHttpRequest");if(e){var t=new e;return Boolean(De(t.withCredentials)&&void 0!==typeof XDomainRequest)}}}function hr(e,t,n){var r=-1;if(!De(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=or[Cr(e)]||-1;-1!==r&&-1!==i?r|=i:i===kn&&(r=i)}return r}function gr(e){void 0===e&&(e="D");var t=Qn();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function mr(e,t,n,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object[mt],l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){Me(e=l[s],(function(e,t){a&&t&&ke(t)?We(t)?(o[e]=o[e]||[],Ve(t,(function(t,n){t&&ke(t)?o[e][n]=mr(!0,o[e][n],t):o[e][n]=t}))):o[e]=mr(!0,o[e],t):o[e]=t}))}return o}var vr=Xn;function yr(e){return e===_n||e>_n&&e<=On||e===In}function Sr(e){return e.length>0}function br(e){var t=Zn("beforeunload",e);return t=Zn("unload",e)||t,t=Zn("pagehide",e)||t}function Tr(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=vr()}function Cr(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Y.f&&(t=4,We(e)?(t=4096,e.length>0&&(t|=Cr(e[0]))):Ee(e,"value")&&(t=8192|Cr(e.value)))}return t}Y.d;var _r=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",be(t,n,(function(e,t){e.initialize=function(n,r,i,o){pt(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&Ve(n.channels,(function(t){t&&Ve(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&Ve(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,i,o)}catch(t){e.logger.throwInternal(ut.CRITICAL,Ln.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){pt(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=vr(),dr(r.latency)||(r.latency=wn);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=ir;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(Y.b)(t,e),t}(Cn),Or="REAL_TIME",Ir=function(){function e(t,n){var r=n?[].concat(n):[],i=this;i.iKey=function(){return t},i.count=function(){return r.length},i.events=function(){return r},i.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(r=t?r.concat(e):e.concat(r),e.length):0},i.split=function(n,i){var o=new e(t);if(n<r.length){var a=r.length-n;xe(i)||(a=i<a?i:a),o.addEvents(r.splice(n,a),!0)}return o}}return e.create=function(t,n){return new e(t,n)},e}(),wr="constructor",Ar="prototype",Dr="function",xr="_dynClass",Pr="_unknown_",Er=Object,kr=Er.getPrototypeOf,Rr=0;function Lr(e,t){return e&&Er.prototype.hasOwnProperty.call(e,t)}function Nr(e){return e&&(e===Er.prototype||e===Array.prototype)}function Mr(e){return Nr(e)||e===Function.prototype}function Ur(e){if(e){if(kr)return kr(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function Fr(e,t){var n=[],r=Er.getOwnPropertyNames;if(r)n=r(e);else for(var i in e)"string"==typeof i&&Lr(e,i)&&n.push(i);if(n&&n.length>0)for(var o=0;o<n.length;o++)t(n[o])}function jr(e,t,n){return t!==wr&&typeof e[t]===Dr&&(n||Lr(e,t))}function Br(e){throw new TypeError("DynamicProto: "+e)}function Wr(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function qr(e,t,n,r){var i=null;if(e&&Lr(n,xr)){var o=e._dynInstFuncs||{};if((i=(o[n._dynClass]||{})[t])||Br("Missing ["+t+"] "+Dr),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!Lr(e,t),s=Ur(e),u=[];a&&s&&!Mr(s)&&!Wr(u,s);){var c=s[t];if(c){a=c===r;break}u.push(s),s=Ur(s)}try{a&&(e[t]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function Hr(e,t,n){var r=t[e];return r===n&&(r=Ur(t)[e]),typeof r!==Dr&&Br("["+e+"] is not a "+Dr),r}function Gr(e,t,n,r,i){if(!Nr(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),Fr(n,(function(t){jr(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!Lr(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(qr(this,t,e,n)||Hr(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function zr(e,t){return Lr(e,Ar)?e.name||t||Pr:((e||{}).constructor||{}).name||t||Pr}function Kr(e,t,n,r){Lr(e,Ar)||Br("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){for(var n=Ur(t);n&&!Mr(n);){if(n===e)return!0;n=Ur(n)}return!1})(i,t)||Br("["+zr(e)+"] is not in class hierarchy of ["+zr(t)+"]");var o=null;Lr(i,xr)?o=i._dynClass:(o="_dynCls$"+zr(e,"_")+"$"+Rr,Rr++,i._dynClass=o);var a=Kr._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var t={};return Fr(e,(function(n){!t[n]&&jr(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o={};Fr(n,(function(e){o[e]=i(t,n,e)}));for(var a=Ur(e),s=[];a&&!Mr(a)&&!Wr(s,a);)Fr(a,(function(e){!o[e]&&jr(a,e,!kr)&&(o[e]=i(t,a,e))})),s.push(a),a=Ur(a);return o}(i,t,u,s));var c=!!kr&&!!a.setInstFuncs;c&&r&&(c=!!r.setInstFuncs),Gr(i,o,t,u,!1!==c)}Kr._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Vr=Kr,Zr=2e6,Qr=Math.min(Zr,65e3),Xr=/\./,Jr=function e(t,n,r,i){var o="data",a="baseData",s=!!i,u=n,c={};Vr(e,this,(function(e){function n(e,t,i,o,a,l,d){Me(e,(function(e,p){var f=null;if(p||ur(p)){var h=i,g=e,m=a,v=t;if(s&&!o&&Xr.test(e)){var y=e.split("."),S=y.length;if(S>1){m&&(m=m.slice());for(var b=0;b<S-1;b++){var T=y[b];v=v[T]=v[T]||{},h+="."+T,m&&m.push(T)}g=y[S-1]}}if(f=o&&function(e,t){var n=c[e];return void 0===n&&(e.length>=7&&(n=Fe(e,"ext.metadata")||Fe(e,"ext.web")),c[e]=n),n}(h)||!u||!u.handleField(h,g)?pr(g,p,r):u.value(h,g,p,r)){var C=f.value;if(v[g]=C,l&&l(m,g,f),d&&"object"==typeof C&&!We(C)){var _=m;_&&(_=_.slice()).push(g),n(p,C,h+"."+g,o,_,l,d)}}}}))}e.createPayload=function(e,t,n,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&pt(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=n.isBeacon,l=c?65e3:3984588,d=c?Qr:Zr,p=0,f=0;p<t.length;){var h=t[p];if(h){if(a>=i){n.overflow=r.split(p);break}var g=e.getEventBlob(h);if(g.length<=d){var m=g.length;if(o.length+m>l){n.overflow=r.split(p);break}o&&(o+="\n"),o+=g,++f>20&&(o.substr(0,1),f=0),s=!0,a++}else u.push(h),t.splice(p,1),p--}p++}if(u&&u.length>0&&n.sizeExceed.push(Ir.create(r.iKey(),u)),s){n.batches.push(r),n.payloadBlob=o,n.numEvents=a;var v=r.iKey();-1===Ze(n.apiKeys,v)&&n.apiKeys.push(v)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){return pt(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+cr(e.iKey);var r={},i=e.ext;i&&(t.ext=r,Me(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var s=t.data={};s.baseType=e.baseType;var u=s.baseData={};return n(e.baseData,u,a,!1,[a],(function(e,t,n){Yr(r,e,t,n)}),!0),n(e.data,s,o,!1,[],(function(e,t,n){Yr(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}}))};
/*!
 * 1DS JS SDK POST plugin, 3.1.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* Serializer.ts
* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)
* @copyright Microsoft 2018-2020
*/function Yr(e,t,n,r){if(r&&e){var i=hr(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[n]={},We(r.value)?a.a={t:i}:a.t=i}}}
/*!
 * 1DS JS SDK POST plugin, 3.1.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/var $r,ei=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),ti=function e(){var t={};Vr(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(a=e.split(","),s=[],a&&Ve(a,(function(e){s.push(Je(e))})),s);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=nt()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,r=Je(e);return void 0!==n[r]&&n[r]>nt()||(delete n[r],!1)}}))},ni=function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;Vr(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))},ri="POST",ii="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",oi="drop",ai="send",si="requeue",ui="rspFail",ci="kill-duration",li="time-delta-millis",di=(($r={})[1]=si,$r[100]=si,$r[200]="sent",$r[8004]=oi,$r[8003]=oi,$r);function pi(e){try{return e.responseText}catch(e){}return""}var fi=function e(t,n,r,i){this._responseHandlers=[];var o,a,s,u,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-3.1.1",l=new ti,d=!1,p=new ni,f=!1,h=0,g=!0,m=[],v={},y=[],S=null,b=!1;Vr(e,this,(function(e){var T=!0;function C(e,t){var n=new XDomainRequest;n.open(ri,e.urlString),n.onload=function(){var e=pi(n);I(t,200,{},e),U(e)},n.onerror=function(){I(t,400,{})},n.ontimeout=function(){I(t,500,{})},n.send(e.data)}function _(e,t){var n;fetch(e.urlString,(n={body:e.data,method:ri,credentials:"include"},n[ii]=!0,n.headers=e.headers,n)).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),I(t,e.status,n,r),U(r)})).catch((function(e){I(t,0,{})}))}function O(e,t,n){function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Je(r))}return e}function i(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},He(t)&&Ve(Je(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=Je(e.substring(0,t)).toLowerCase(),i=Je(e.substring(t+1));n[r]=i}else n[Je(e)]=1}})),i=n):(i=r(i,e,li),i=r(i,e,ci),i=r(i,e,"kill-duration-seconds")),i}function o(e,n){I(t,e.status,i(e),n)}var a=new XMLHttpRequest;try{a[ii]=!0}catch(e){}T&&(a.withCredentials=!0),a.open(ri,e.urlString,!n),Me(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=pi(a);o(a,e),U(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function I(e,t,n,r){try{e(t,n,r)}catch(e){o.diagLog().throwInternal(ut.WARNING,Ln.SendPostOnCompleteFailure,e)}}function w(){return!d&&h<n}function A(){var e=y;return y=[],e}function D(e,t,n){var r=!1;return e&&e.length>0&&!d&&a&&S&&(r=t||w()&&(n>0||p.allowRequestSending())),r}function x(e){var t={};return e&&Ve(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function P(e,n,r,i,o,a){if(e&&0!==e.length)if(d)F(e,1,i);else{var u=e;pt(s,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var u=[],c=null,d=vr();D(e,i,n);){var p=e.shift();p&&p.count()>0&&(l.isTenantKilled(p.iKey())?u.push(p):(c=c||S.createPayload(n,r,i,a&&k()),S.appendPayload(c,p,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,L(c,d,vr(),o),d=vr(),c=null):(L(c,d,vr(),o),d=vr(),e=[p].concat(e),c=null)))}c&&L(c,d,vr(),o),e.length>0&&(y=e.concat(y)),F(u,8004,i)}),(function(){return{batches:x(u),retryCount:n,isTeardown:r,isSynchronous:i,sendReason:o,useSendBeacon:a}}),!i)}}function E(e){var t=c,n="";Ve(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+nt().toString();var r=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),r=0;r<n.length;r++){var i=(n[r].ext||{}).intweb||{};if(ur(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(ur(r)&&(t=t+"&ext.intweb.msfpc="+r),p.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+p.getClockSkewHeaderValue()),s.getWParam){var i=s.getWParam();i>=0&&(t+="&w="+i)}for(var o=0;o<m.length;o++)t+="&"+m[o].name+"="+m[o].value;return t}function k(){return!g&&f&&lr()}function R(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function L(t,n,i,u){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var c=E(t),d=vr();pt(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var f=0;f<t.batches.length;f++)for(var g=t.batches[f].events(),m=0;m<g.length;m++){var y=g[m];if(b){var T=y.timings=y.timings||{};R(T,"sendEventStart",d),R(T,"serializationStart",n),R(T,"serializationCompleted",i)}y.sendAttempt>0?y.sendAttempt++:y.sendAttempt=1}F(t.batches,1e3+(u||0),t.isSync,!0);var C={data:t.payloadBlob,urlString:c,headers:v},_=null,O=!!e.sendHook;k()&&t.isBeacon?(O=!1,_=function(n){!function(e,t,n){try{if(lr()){var r=Pt();if(r.sendBeacon(e.urlString,e.data))return void N(t,200,n,!1);var i=null;Ve(t.batches,(function(t){if(i&&t&&t.count()>0){for(var n=t.events(),o=0;o<n.length;o++)if(!r.sendBeacon(e.urlString,S.getEventBlob(n[o]))){i.push(t.split(o));break}}else i.push(t.split(0))})),N(t,200,n,!1),F(i,8003,t.isSync,!0)}}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(n,t,u),e.sendListener&&e.sendListener(C,n,t.isSync||t.isTeardown,!0)}):a&&(_=function(n){p.firstRequestSent();var i=function(e,n){!function(e,t,n,i){var o=9e3,a=null,s=!1,u=!1;try{var c=!0;if(typeof e!==ht){if(t){p.setClockSkew(t[li]);var d=t["kill-duration"]||t["kill-duration-seconds"];Ve(l.setKillSwitchTenants(t["kill-tokens"],d),(function(e){Ve(n.batches,(function(t){if(t.iKey()===e){a=a||[];var r=t.split(0);n.numEvents-=r.count(),a.push(r)}}))}))}if(200===e)return void(o=200);(!ei.shouldRetryForStatus(e)||n.numEvents<=0)&&(c=!1),o=9e3+e%1e3}if(c){o=100;var f=n.retryCnt;n.isSync||(f<r?(s=!0,M((function(){n.isSync||h--,P(n.batches,f+1,n.isTeardown,n.isSync,5,n.isBeacon)}),!0,ei.getMillisToBackoffForRetry(f))):u=!0)}}finally{s||(p.setClockSkew(),N(n,o,i,u)),F(a,8004,n.isSync)}}(e,n,t,u)};try{a.sendPOST(n,i,t.isTeardown||t.isSync),e.sendListener&&e.sendListener(C,n,t.isSync||t.isTeardown,!1)}catch(e){I(i,0,{})}}),pt(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(_)if(t.isSync||h++,O){var n={data:C.data,urlString:C.urlString,headers:C.headers},r=!1;pt(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,_(e)}),t.isSync||t.isTeardown)}catch(e){r||_(C)}}))}else _(C)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:u}}),t.isSync)}F(t.sizeExceed,8003,t.isSync)}function N(t,n,r,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(b){var t=vr();Ve(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,b&&Ve(n,(function(e){R(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),F(t.batches,n,t.isSync,!0)}finally{t.isSync||(h--,5!==r&&e.sendQueuedRequests(r,!t.isSync,t.isBeacon))}}function M(e,t,n){t?e():o._setTimeoutOverride(e,n)}function U(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){o.diagLog().throwInternal(ut.CRITICAL,Ln.PostResponseHandler,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);ur(i.webResult)&&ur(i.webResult.msfpc)&&u.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function F(e,t,n,r){if(e&&e.length>0&&i){var a=i[(u=t,c=di[u],ur(c)||(c="oth",u>=9e3&&u<=9999?c=ui:u>=8e3&&u<=8999?c=oi:u>=1e3&&u<=1999&&(c=ai)),c)];a&&pt(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){M((function(){try{a.call(i,e,t,n)}catch(e){o.diagLog().throwInternal(ut.CRITICAL,Ln.NotificationException,"send request notification failed: "+e)}}),r||n,0)}),(function(){return{batches:x(e),reason:t,isSync:n,sendSync:r}}),!n)}var u,c}e.initialize=function(e,t,n,r,i){i||(i={}),c=e+c,s=t,u=t.getCookieMgr(),b=!s.config.disableEventTimings;var l=!!s.config.enableCompoundKey;o=n;var d=i.valueSanitizer,p=i.stringifyObjects;if(De(i.enableCompoundKey)||(l=!!i.enableCompoundKey),S=new Jr(s,d,p,l),!(a=r)){g=!1,f=!Lt();var h=Et();h&&h.protocol&&"file:"===h.protocol.toLowerCase()&&(T=!1);var m=null;fr()?m=C:Lt()?m=_:"undefined"!=typeof XMLHttpRequest&&(m=O),a={sendPOST:m}}},e._getDbgPlgTargets=function(){return[a,l,S]},e.addQueryStringParameter=function(e,t){for(var n=0;n<m.length;n++)if(m[n].name===e)return void(m[n].value=t);m.push({name:e,value:t})},e.addHeader=function(e,t){v[e]=t},e.canSendRequest=function(){return w()&&p.allowRequestSending()},e.sendQueuedRequests=function(e,t,n){var r=!xe(t)&&!t;D(y,r,0)&&P(A(),0,!1,r,e||0,!!n)},e.isCompletelyIdle=function(){return!d&&0===h&&0===y.length},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;y.push(e)}return!0},e.teardown=function(){y.length>0&&P(A(),0,!0,!0,2,!0)},e.pause=function(){d=!0},e.resume=function(){d=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&P([e],0,!1,!0,t||0,!!n)}}))},hi=sr?window:void 0,gi="eventsDiscarded",mi=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.1";var i,o,a,s,u,c=!1,l=[],d=null,p=!1,f=0,h=500,g=0,m=1e4,v={},y=Or,S=null,b=null,T=0,C=0,_={},O=-1;return Vr(t,r,(function(e,t){function r(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=wn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.ext=st(e.ext),e.baseData&&(e.baseData=st(e.baseData)),e.data&&(e.data=st(e.data)),e.sync)if(T||p)e.latency=Dn,e.sync=!1;else if(o)return e=st(e),void o.sendSynchronousBatch(Ir.create(e.iKey,[e]),3);var n=e.latency,r=g,i=m;n===xn&&(r=f,i=h);var a=!1;if(r<i)a=!R(e,t);else{var s=wn,u=20;n===xn&&(s=xn,u=1),a=!0,function(e,t,n,r){for(;n<=t;){var i=E(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return n===xn?f-=a:g-=a,W(gi,[o],bn),!0}n++}return L(),!1}(e.iKey,e.latency,s,u)&&(a=!R(e,t))}a&&B(gi,[e],bn)}function I(e,t,n,r){var i=N(e,t,n);return o.sendQueuedRequests(t,n,r),i}function w(){return g>0}function A(){if(O>=0&&N(O,u,!0)&&o.sendQueuedRequests(u,!0,!1),f>0&&!b&&!p){var e=v[y][2];e>=0&&(b=D((function(){b=null,I(xn,1,!0),A()}),e))}var t=v[y][1];!S&&!d&&t>=0&&!p&&(w()?S=D((function(){S=null,I(0===C?Dn:wn,1,!0),C++,C%=2,A()}),t):C=0)}function D(t,n){0===n&&T&&(n=1);var r=1e3;return T&&(r=ei.getMillisToBackoffForRetry(T-1)),e._setTimeoutOverride(t,n*r)}function x(){null!==S&&(e._clearTimeoutOverride(S),S=null,C=0)}function P(t,n){x(),d&&(e._clearTimeoutOverride(d),d=null),p||I(wn,t,n,!0)}function E(e,t,n){var r=_[t];r||(r=_[t=wn]);var i=r.iKeyMap[e];return!i&&n&&(i=Ir.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function k(t,n){o.canSendRequest()&&!T&&(a>0&&g>a&&(n=!0),n&&null==d&&e.flush(t,null,20))}function R(e,t){var n=(e=st(e)).latency,r=E(e.iKey,n,!0);return!!r.addEvents([e],t)&&(n!==xn?(g++,t&&0===e.sendAttempt&&k(!e.sync,s>0&&r.count()>=s)):f++,!0)}function L(){for(var e=0,t=0,n=function(n){var r=_[n];r&&r.batches&&Ve(r.batches,(function(r){n===xn?e+=r.count():t+=r.count()}))},r=wn;r<=xn;r++)n(r);g=t,f=e}function N(t,n,r){var i=!1;return!r||o.canSendRequest()?pt(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=xn;n>=t;){var r=_[n];r&&r.batches&&(Ve(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),n===xn?f-=t.count():g-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&B(gi,e,Sn),i&&O>=t&&(O=-1,u=0)}),(function(){return{latency:t,sendReason:n}}),r):(O=O>=0?Math.min(O,t):t,u=Math.max(u,n)),i}function M(e,t){I(wn,t,!0),U((function(){e&&e(),l.length>0?d=D((function(){return M(l.shift(),t)}),0):(d=null,w()&&A())}))}function U(e){o.isCompletelyIdle()?e():d=D((function(){U(e)}),.25)}function F(){(v={}).REAL_TIME=[2,1,0],v.NEAR_REAL_TIME=[6,3,0],v.BEST_EFFORT=[18,9,0]}function j(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){e.diagLog().throwInternal(ut.CRITICAL,Ln.NotificationException,t+" notification failed: "+n)}}function B(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&j(e,[t].concat(n))}function W(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&Ve(t,(function(t){t&&t.count()>0&&j(e,[t.events()].concat(n))}))}function q(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,m/6)}F(),_[xn]={batches:[],iKeyMap:{}},_[Dn]={batches:[],iKeyMap:{}},_[An]={batches:[],iKeyMap:{}},_[wn]={batches:[],iKeyMap:{}},q(),o=new fi(500,2,1,{requeue:function(t,n){var i=[];Ve(t,(function(t){t&&t.count()>0&&Ve(t.events(),(function(t){t&&(t.sync&&(t.latency=Dn,t.sync=!1),t.sendAttempt<6?(Tr(t,e.identifier),r(t,!1)):i.push(t))}))})),i.length>0&&B(gi,i,vn)},send:function(e,t,n){e&&e.length>0&&j("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){W("eventsSent",e,t),A()},drop:function(e,t){W(gi,e,t>=8e3&&t<=8999?t-8e3:mn)},rspFail:function(e){W(gi,e,vn),A()},oth:function(e,t){W(gi,e,mn),A()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,u){pt(s,(function(){return"PostChannel:initialize"}),(function(){var c=s;t.initialize(r,s,u),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=l.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(hi),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(hi);var d=c.getWParam;c.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|d()},n.eventsLimitInMem>0&&(m=n.eventsLimitInMem),n.immediateEventLimit>0&&(h=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),q(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),ur(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var p=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(p,e.core,e,i,n),br((function(){P(2,!1)})),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:u}}))},e.processTelemetry=function(t,i){Tr(t,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!n.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=t;a||c||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),A()),e.processNext(s,i)},e.setEventQueueLimits=function(e,t){m=e>0?e:1e4,a=t>0?t:0,q();var n=g>e;if(!n&&s>0)for(var r=wn;!n&&r<=Dn;r++){var i=_[r];i&&i.batches&&Ve(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}k(!0,n)},e.teardown=function(){P(2,!1),c=!0,o.teardown()},e.pause=function(){x(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),A()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){x(),F(),y=Or,A(),Me(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),v[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),p||(x(),n=n||1,e?(N(wn,n,e),L(),null==d?d=D((function(){M(t,n)}),0):l.push(t)):(I(wn,n,!1),null!=t&&t()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=w,e._setTransmitProfile=function(e){y!==e&&void 0!==v[e]&&(x(),y=e,A())},e._backOffTransmission=function(){T<4&&(T++,x(),A())},e._clearBackOff=function(){T&&(T=0,x(),A())}})),r}return Object(Y.b)(t,e),t}(Gt),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new mi;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(_r),yi="Data.",Si="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function bi(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,i;switch(r=n.prependDataToken?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):yi+t.name:t.name,t.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var o={value:t.value,propertyType:i};e[r]=o}}))}function Ti(e,t){try{return e()}catch(e){return Object(J.a)(1,"1DS Sink",e),t}}function Ci(e){return e<10?"0"+e:e.toString()}var _i,Oi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return Object(l.__extends)(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){e.data=mr(e.data,this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){bi(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},t}(Gt),Ii="HttpManager:_sendBatches",wi="HttpManager:_sendBatchesNotification",Ai=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Di=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===Ii||e===wi?new Ai(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Ii:this.handleSendBatches(e);break;case wi:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/"}(_i||(_i={}));var xi=n(95),Pi=function(){function e(){this._optionalEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._optionalEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._optionalEventsEnabled||!!e.eventFlags&&(10===e.eventFlags.diagnosticLevel||110===e.eventFlags.diagnosticLevel||120===e.eventFlags.diagnosticLevel);return t||Object(J.b)(2,1,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setOptionalEventsEnabled=function(e){this._optionalEventsEnabled=e},e}(),Ei=void 0,ki=function(e){function t(t,n){var r,i,o=e.call(this,t,n)||this;o.usePartAPlugin=!0;var a=new Oi,s=function(e){e&&e.addNotificationListener({eventsSent:function(e){Object(J.b)(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),Object(J.b)(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),o.eventsSent+=e.length},eventsDiscarded:function(e,t){Object(J.b)(0,2,(function(){return"Discarded "+e.length+" event(s) because "+t})),Object(J.b)(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),o.eventsDiscarded+=e.length}})};function u(e,t,n,r){var i={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0,extensionConfig:e.extensionConfig,enableCompoundKey:e.enableCompoundKey};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var o=new vi;return o.initialize(i,r),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Di(e.stats)),o}o.sendTelemetryEvent=function(e){return Ti((function(){var t=o.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),Ei)},o.sendCustomerContent=function(e){return Ti((function(){var t=o.getOneDSCustomerContent(e);t&&i&&i.track(t)}),Ei)},o.addPersistentDataFields=function(e){a.addDataFields(e)},o.flush=function(e){r&&r.flush(e)},o.shutdown=function(){try{r&&r.shutdown()}catch(e){Object(J.b)(0,2,(function(){return"An error occurred on shutdown"}))}};var c=[a];if(n.plugins&&c.push.apply(c,n.plugins),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=u(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,c),n.enableCustomerContent&&n.endpointUrl===_i.PUBLIC&&(i=u(n,Si,_i.CUSTOMER_CONTENT,c)),n.disableStatsTracking||(s(r),s(i)),o.addPersistentDataFields(t),o}return Object(l.__extends)(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],i=new Pi,o={},a=gr(),s=(new Date).getTime().toString(),u=function(e,t){if(1===t.eventType)return Si;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},c=function(e,t){return Ti((function(){var i,c,d,p=Object(xi.b)(e);if(function(e){for(var t=0;t<r.length;t++)if(!r[t].processEvent(e))return!1;return!0}(p)){n.eventsProcessed++;var f={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":p.eventName,"Event.Source":"OTelJS","Event.Time":{value:(d=e.timestamp,c=d?new Date(d):new Date,c.getUTCFullYear()+"-"+Ci(c.getUTCMonth()+1)+"-"+Ci(c.getUTCDate())+"T"+Ci(c.getUTCHours())+":"+Ci(c.getUTCMinutes())+":"+Ci(c.getUTCSeconds())+"."+(i=c.getUTCMilliseconds(),(i<10?"00"+i:i<100?"0"+i:i.toString())+"Z")),propertyType:9}};bi(f,p.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),f["Event.Id"]=a+"."+n.eventsProcessed;var h="custom";p.eventContract&&(p.eventContract.name&&(f["Event.Contract"]=p.eventContract.name,h+="."+p.eventContract.name.toLowerCase().replace(/\./g,"_")),bi(f,p.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var g={iKey:u(p,t),name:p.eventName,data:f,time:(new Date).toISOString(),baseType:h,ext:{sdk:{seq:n.eventsProcessed,epoch:s}}};return n.usePartAPlugin||(g.data=Object(l.__assign)(Object(l.__assign)({},g.data),o)),g}}),void 0)};this.getOneDSTelemetryEvent=function(e){return c(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return c(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.addPersistentDataFields=function(e){bi(o,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){i.setOptionalEventsEnabled(e)},this.setFullEventsEnabled=this.setOptionalEventsEnabled,this.addPersistentDataFields(e),this.addPreprocessor(i)})),Ri=null,Li=function(){function e(e,t,n,r){this.otelLogger=new V.a;var i=Object(l.__spreadArrays)(Z.b.getFields({primaryIdentityHash:e,primaryIdentitySpace:t?"MSAPUID":"OrgIdPUID",isAnonymous:!1,tenantId:n,tenantGroup:t?"Consumer":"Commercial"}),[Q.c("App.Platform","Web"),Q.c("Session.Id",r)]),o=new ki(i,{endpointUrl:_i.PUBLIC});this.otelLogger.addSink(o);var a=X.SuppressNexus;this.otelLogger.setTenantToken("Office.Taos.Shell","b0c82c6598ad49f3848b1d3dc0d8dd25-299cbfe9-b72e-4e9d-a5e3-20319efba5b5-7268",a)}return e.prototype.registerContextParam=function(){},e.prototype.writeEvent=function(e){},e}();function Ni(e,t){null==Ri&&t.OTelTelemetryEnabled&&(!t.IsConsumerShell&&t.PUID?Object(W.a)(t)&&t.TID&&Mi(e,t):Mi(e,t))}function Mi(e,t){Ri=new Li(t.PUID,t.IsConsumerShell,t.TID,t.SHSID);var n=Object(r.f)();n.registerService(Ri),n.IsConsumer=t.IsConsumerShell,Object(r.c)().unsubscribe("ShellDataUpdated",Ni)}var Ui=!1;function Fi(e,t){var n;!Ui&&t&&t.FootprintTelemetryEnabled&&(Ui=!0,s.o.isMobileClient()||Object(s.O)(t.WorkloadId,t.FootprintWorkloadExcludeList)||(n="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js",new Promise((function(e,t){var r=encodeURI(n),i=document.createElement("script");i.src=r,i.type="text/javascript",i.crossOrigin="anonymous",i.onerror=function(e){t({ResourceName:n,Details:e.message})},i.onload=function(){e()},document.body.appendChild(i)}))).then((function(){var n="",i=Object(c.a)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL);t.IsConsumerShell?n="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(n=t.TID);try{Footprint.start("O365se",["config.fp.measure.office.com/conf/v2/o365se/fpconfig.min.json","r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"],1e4,JSON.stringify([{TenantId:n,AppId:i}]))}catch(e){Object(r.f)().tag("Footprint_StartFailed",6,e||"")}})).catch((function(e){Object(r.f)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)})),Object(r.c)().unsubscribe("ShellDataUpdated",Fi))}var ji=n(136),Bi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(r.f)().perfMarker("SettingsTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:N.a.Settings,affordanceMenuItemText:N.a.Settings,iconID:"Settings",iconFontSize:L.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(R.b,Object(l.__assign)({},e)):i.createElement(R.a,Object(l.__assign)({},e))},t}(i.Component),Wi=n(131),qi=Object(a.b)((function(e,t){var n=!1;e.shellInitDataState.layout&&(n=!!e.shellInitDataState.clientData.SettingsPaneEnabled&&Object(Wi.a)(Object(l.__assign)(Object(l.__assign)({},e.shellInitDataState.clientData),{CurrentMainLinkElementID:e.shellInitDataState.navBarData.CurrentMainLinkElementID}),null,e.settingsFlexPaneState.workloadSettingLinks).length>0);return{isAvailable:n,id:t&&t.id,isActive:e.flexPaneState&&"Settings"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),Object(r.f)().click("Settings","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),n.onClick&&n.onClick(t),e(Object(s.Q)(t.currentTarget&&t.currentTarget.id)),e(Object(P.f)("Settings"))}}}),(function(e,t,n){var r=Object(l.__assign)(Object(l.__assign)({},n),e);return Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(Bi),Hi=n(109),Gi=n(11),zi=n(133),Ki=n(21),Vi=n(203),Zi=n(6),Qi=n(17),Xi="UTC",Ji="tzone://Microsoft/Utc",Yi=function(){function e(){this.timeZones=null,this.timeZoneOffsets=[]}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return null!=this.timeZones&&this.timeZoneOffsets.length>0},enumerable:!0,configurable:!0}),e.prototype.initializeTimeZoneConverter=function(e){this.timeZoneOffsets=e,this.timeZones={}},e.prototype.convert=function(e,t,n){if(null===this.timeZones)throw Error("LoadTimeZoneOffsets must be called before convert.");if(e===Ji&&(e=Xi),t===Ji&&(t=Xi),null==n||e===t)return n;var r=ro.parseISO8601DateTime(n),i=0;e===Xi?(i=this.findOffsetInUTC(t,r),r=r.addMinutes(i)):t===Xi?(i=this.findOffsetInLocal(e,r),r=r.addMinutes(0-i)):(i=this.findOffsetInLocal(e,r),r=r.addMinutes(0-i),i=this.findOffsetInUTC(t,r),r=r.addMinutes(i));var o=-1===n.indexOf(".")?ro.generateISO8601DateTimeString(r):ro.generateISO8601DateTimeMsString(r);if(t===Xi)o+="Z";else{var a=Math.abs(i),s=Math.floor(a/60),u=a%60;o+=(i<0?"-":"+")+(s<10?"0"+s:s.toString())+":"+(u<10?"0"+u:u.toString())}return o},e.prototype.findOffsetInLocal=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var r=0,i=n;r<i.length;r++){var o=i[r];if(t.compare(o.localStart)>=0&&t.compare(o.localEnd)<0)return o.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.findOffsetInUTC=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var r=0,i=n;r<i.length;r++){var o=i[r];if(t.compare(o.utcStart)>=0&&t.compare(o.utcEnd)<0)return o.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.ConvertDateTimeMembersTimeZone=function(e,t,n,r,i,o){throw new Error("Unimplemented.")},e.prototype.getTimeZoneRanges=function(e){var t=this.timeZones[e];return null==t&&(this.loadOffsetsForTimezone(e),t=this.timeZones[e]),t},e.prototype.loadOffsetsForTimezone=function(e){for(var t,n=0,i=this.timeZoneOffsets;n<i.length;n++){var o=i[n];if(e===o.TimeZoneId){t=o.OffsetRanges;break}}if(t&&0!==t.length){var a=t.map((function(e){return{utcStart:ro.parseISO8601DateTime(e.UtcTime),offset:e.Offset}}));a.forEach((function(e,t){if(0===t?(e.utcStart=ro.MinValue,e.localStart=ro.MinValue):e.localStart=e.utcStart.addMinutes(e.offset),t+1===a.length)e.utcEnd=ro.MaxValue,e.localEnd=ro.MaxValue;else{var n=a[t+1];e.utcEnd=n.utcStart,e.localEnd=e.utcEnd.addMinutes(Math.max(e.offset,n.offset))}})),this.timeZones[e]=a}else Object(r.f)().tag("TimeZoneConverter_NoIncomingOffsetRanges",6,e)},e}(),$i={TimeFormat:"hh:mm tt",DateFormat:"MM/dd/yyyy",TimeZone:"Pacific Standard Time",UserCulture:"default",WeekStartDay:0,FirstWeekOfYear:0,get TimeZoneOffsets(){return[{TimeZoneId:this.TimeZone,OffsetRanges:[{UtcTime:"1970-01-01T00:00:00Z",Offset:-180}]}]}},eo=function(){function e(e){var t=e.UserOptions||{},n=t.MailboxTimeZoneOffset;this.timeFormat=t.TimeFormat||$i.TimeFormat,this.dateFormat=t.DateFormat||$i.DateFormat,this.timeZone=t.TimeZone||$i.TimeZone,this.userCulture=null!=e.SessionSettings?e.SessionSettings.UserCulture:$i.UserCulture,this.weekStartDay=null!=t.WeekStartDay?t.WeekStartDay:$i.WeekStartDay,this.firstWeekOfYear=null!=t.FirstWeekOfYear?t.FirstWeekOfYear:$i.FirstWeekOfYear,this.timeZoneConverter=new Yi,this.timeZoneConverter.initializeTimeZoneConverter(null!=n?n:$i.TimeZoneOffsets)}return Object.defineProperty(e,"Instance",{get:function(){return null==e.instance&&(e.instance=new e({})),e.instance},enumerable:!0,configurable:!0}),e.populate=function(t){e.instance=new e(t)},e}(),to=n(145),no=864e13,ro=function(){function e(t,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),n<0||n>11||r<0||r>31||i<0||i>23||o<0||o>59||a<0||a>59||s<0||s>999)throw new Error("Date part out of range.");this.localTime=new Date(Date.UTC(t,n,r,i,o,a,s)),this.utcOffsetInMinutes=null==u?e.timeZoneConverter.findOffsetInLocal(e.timeZone,e.fromNativeDateTime(this.localTime)):u,e.throwIfDateOutOfRange(this)}return Object.defineProperty(e.prototype,"date",{get:function(){return this.localTime.getUTCDate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return this.localTime.getUTCMonth()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"year",{get:function(){return this.localTime.getUTCFullYear()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hour",{get:function(){return this.localTime.getUTCHours()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.localTime.getUTCSeconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minute",{get:function(){return this.localTime.getUTCMinutes()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"millisecond",{get:function(){return this.localTime.getUTCMilliseconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"timeZone",{get:function(){return eo.Instance.timeZone},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Now",{get:function(){var t=e.timeZoneConverter.convert(Xi,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"timeZoneConverter",{get:function(){return eo.Instance.timeZoneConverter},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UTCNow",{get:function(){return e.fromNativeDateTime(new Date).toUTC()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"now",{get:function(){var t=e.timeZoneConverter.convert(Xi,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!0,configurable:!0}),e.fromNativeDateTime=function(t){return new e(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),-t.getTimezoneOffset())},e.prototype.format=function(t){return Vi(this.localTime,e.getDateFormatMask(t),!0)},e.parseISO8601DateTime=function(t){void 0===t&&(t="");var n=e.isoRegex.exec(t);if(null==n||15!==n.length)throw new Error(Object(Zi.b)("Unexpected datetime format (value: {0}).",t));var r=parseInt(n[1],10),i=parseInt(n[2],10),o=parseInt(n[3],10),a=0,s=0,u=0,c=0,l=0;return null!=n[5]&&null!=n[6]&&null!=n[7]&&(a=parseInt(n[5],10),s=parseInt(n[6],10),u=parseInt(n[7],10),null!=n[9]&&(c=parseInt(n[9],10))),null!=n[10]&&"Z"!==n[10].toUpperCase()&&(l+=60*parseInt(n[13],10),l+=parseInt(n[14],10),"-"===n[12]&&(l=-l)),new e(r,i-1,o,a,s,u,c,l)},e.generateISO8601DateTimeString=function(t){return e.generateISO8601DateTimeMsString(t,!1)},e.generateISO8601DateTimeMsString=function(e,t){void 0===t&&(t=!0);var n="yyyy-MM-dd'T'HH:mm:ss"+(t?".l":"");return e.format(n)},e.generateISO8601DateTimeMsStringWithOffset=function(t){return e.generateISO8601DateTimeMsString(t)+t.getUtcOffsetDisplayString()},e.prototype.getUtcOffsetDisplayString=function(){if(0===this.utcOffsetInMinutes)return"Z";var e=Math.floor(Math.abs(this.utcOffsetInMinutes)/60),t=Math.abs(this.utcOffsetInMinutes)%60,n=this.utcOffsetInMinutes<0?"-":"+";return Object(Zi.b)("{0}{1}:{2}",n,io(e,2),io(t,2))},e.areDatePartsEqual=function(e,t){return null===e&&null===t||null!==e&&null!=t&&0===e.compareDatePart(t)},e.prototype.compare=function(e){return Qi.throwOnNullOrUndefined(e,"other"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.clone=function(){var t=new e(0,0,0,0,0,0,0,0);return t.localTime.setTime(this.localTime.getTime()),t.utcOffsetInMinutes=this.utcOffsetInMinutes,t},e.prototype.addMilliseconds=function(t){e.throwIfNotNumber(t);var n=this.clone(),r=n.localTime.getTime()+t;return n.localTime.setTime(r),e.throwIfDateOutOfRange(n),n},e.prototype.Subtract=function(e){return Qi.throwOnNullOrUndefined(e,"value"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.addSeconds=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(1e3*t)},e.prototype.addMinutes=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*to.c)},e.prototype.addHours=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*to.b)},e.prototype.addDays=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*to.a)},e.prototype.toUTC=function(){if(0===this.utcOffsetInMinutes)return this;var e=this.addMinutes(-this.utcOffsetInMinutes);return e.utcOffsetInMinutes=0,e},e.prototype.getNativeDateTime=function(){return new Date(this.toUTC().getUTCMilliseconds())},e.prototype.getUTCMilliseconds=function(){return this.toUTC().localTime.getTime()},e.prototype.GetMilliseconds=function(){return this.localTime.getTime()},e.prototype.compareDatePart=function(t){return e.getDatePartHashValue(this)-e.getDatePartHashValue(t)},e.throwIfNotNumber=function(e){if("number"!=typeof e)throw Error("Argument must be of type number, but is type "+typeof e)},e.throwIfDateOutOfRange=function(t){if(!e.isValidDate(t))throw new Error("The resulting DateTime is less than MinValue or greater than MaxValue")},e.isValidDate=function(e){return null!=e&&!isNaN(e.localTime.getTime())&&e.localTime.getTime()>=-864e13&&e.localTime.getTime()<=no},e.getDatePartHashValue=function(e){return e.date+(e.month<<5)+(e.year<<9)},e.getDateFormatMask=function(e){var t=!1;return e.replace(/[mMtT']/g,(function(e){if(t)return t="'"!==e,e;switch(e){case"'":return t=!0,e;case"m":return"M";case"M":return"m";case"t":return"T";case"T":return"t";default:return e}}))},e.isoRegex=/^(\d{4})-(\d{2})-(\d{2})(T(\d{2}):(\d{2}):(\d{2})([,\.](\d{3})\d*){0,1}){0,1}(Z|(([-\+])(\d{2}):?(\d{2}))){0,1}$/,e.MaxValue=new e(275760,8,13,0,0,0,0,0),e.MinValue=new e(-271821,3,20,0,0,0,0,0),e}();function io(e,t){for(var n=e.toString();n.length<t;)n="0"+n;return n}function oo(e,t,n,i){return e?Object(l.__assign)(Object(l.__assign)({},e),{workloadData:n,workloadSettingLinksTitle:e.workloadSettingLinksTitle||i&&i.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:Object(l.__spreadArrays)(t.CurrentWorkloadSettingsSubLinks||[],i&&i.workloadSettingsSubLinks||[])}):Object(l.__assign)(Object(l.__assign)({},e),{themeCardState:{selectedThemeId:Object(r.i)().getCurrentThemeId(),themeData:[],preferOfficeTheme:Object(r.i)().getThemeState().preferOfficeTheme,fullBleedThemesEnabled:n&&n.EduThemingEnabled&&(n.ActiveExperiences||"").split(",").some((function(e){return"edu"===e.toLowerCase()}))},languageAndRegionCardState:{selectedLanguage:"",selectedDateFormat:"",selectedTimeFormat:"",selectedTimeZone:"",languageChoices:[],timeZoneChoices:[],dateFormatChoices:[],timeFormatChoices:[],savedLanguage:"",savedDateFormat:"",savedTimeFormat:"",savedTimeZone:""},aboutCardState:{correlationID:i&&i.correlationID?i.correlationID:N.a.NotAvailable,sessionID:i&&i.sessionID?i.sessionID:N.a.NotAvailable,version:i.version?i.version:N.a.NotAvailable},workloadData:n,workloadId:n&&n.WorkloadId?n.WorkloadId:"",expandO365Settings:!1,workloadSettingLinksTitle:i&&i.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:Object(l.__spreadArrays)(t.CurrentWorkloadSettingsSubLinks||[],i&&i.workloadSettingsSubLinks||[]),cards:[]})}function ao(e){var t=-1!==e.indexOf("HH");return new ro(2018,8,1,t?21:9,5).format(e).replace("Sep",N.a.SeptemberAbbrev).replace("September",N.a.September)}var so={settingsFlexPaneState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=oo(null,n.navBarData,n.clientData,n.renderSettings)}switch(t.type){case s.h:var i=t;return oo(e,i.navBarData,i.shellClientData,i.renderSettings);case Ki.a:return function(e,t){var n=t,r=Object(s.A)(e.workloadSettingLinks,(function(e){return e.Id===n.newWorkloadSettingLink.Id}));if(!Object(Hi.b)(n.newWorkloadSettingLink))return e;return r>=0?Object(l.__assign)(Object(l.__assign)({},e),{workloadSettingLinks:Object(l.__spreadArrays)(e.workloadSettingLinks.slice(0,r),[n.newWorkloadSettingLink],e.workloadSettingLinks.slice(r+1))}):Object(l.__assign)(Object(l.__assign)({},e),{workloadSettingLinks:e.workloadSettingLinks.concat(n.newWorkloadSettingLink)})}(e,t);case Ki.i:return function(e,t){var n=t,r=Object(s.A)(e.workloadSettingLinks,(function(e){return e.Id===n.settingLinkID}));if(r>=0)return Object(l.__assign)(Object(l.__assign)({},e),{workloadSettingLinks:Object(l.__spreadArrays)(e.workloadSettingLinks.slice(0,r),e.workloadSettingLinks.slice(r+1))});return e}(e,t);case Ki.o:return function(e,t){var n=t.newWorkloadSettingsLinks.filter((function(e){return Object(Hi.b)(e)}));if(0===n.length)return e;return Object(l.__assign)(Object(l.__assign)({},e),{workloadSettingLinks:n})}(e,t);case Ki.d:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{cards:n.cardData})}(e,t);case s.k:return function(e,t){var n=t,i=Object(r.i)().getUserPersonalizationAllowed(),o=Object(zi.c)(n.themeData||[],e.themeCardState.selectedThemeId,e.themeCardState.preferOfficeTheme,i);return Object(l.__assign)(Object(l.__assign)({},e),{themeCardState:Object(l.__assign)(Object(l.__assign)({},e.themeCardState),{themeData:o})})}(e,t);case s.a:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{themeCardState:Object(l.__assign)(Object(l.__assign)({},e.themeCardState),{selectedThemeId:n.themeInfo.ThemeId||Gi.DefaultThemeId,preferOfficeTheme:n.themeInfo.PreferOfficeTheme})})}(e,t);case Ki.f:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage,savedLanguage:n.selectedLanguage})})}(e,t);case Ki.e:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{languageChoices:n.languageChoices.map((function(e){return{id:e.Locale,text:e.DisplayName,language:e.Locale}}))})})}(e,t);case Ki.l:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage})})}(e,t);case Ki.q:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.timeZoneChoice,selectedDateFormat:n.dateFormatChoice,selectedTimeFormat:n.timeFormatChoice,savedTimeZone:n.timeZoneChoice,savedDateFormat:n.dateFormatChoice,savedTimeFormat:n.timeFormatChoice})})}(e,t);case Ki.r:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{timeZoneChoices:n.timeZoneChoices.map((function(e){return{id:e.alias,text:e.displayName}}))})})}(e,t);case Ki.n:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.selectedTimeZone})})}(e,t);case Ki.c:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{dateFormatChoices:n.dateFormatChoices.map((function(e){return{id:e,text:ao(e)}}))})})}(e,t);case Ki.k:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedDateFormat:n.selectedDateFormat})})}(e,t);case Ki.p:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{timeFormatChoices:n.timeFormatChoices.map((function(e){return{id:e,text:ao(e)}}))})})}(e,t);case Ki.m:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},e.languageAndRegionCardState),{selectedTimeFormat:n.selectedTimeFormat})})}(e,t);case Ki.j:return function(e){var t=e.languageAndRegionCardState;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},t),{savedLanguage:t.selectedLanguage,savedTimeZone:t.selectedTimeZone,savedDateFormat:t.selectedDateFormat,savedTimeFormat:t.selectedTimeFormat})})}(e);case Ki.b:return function(e){var t=e.languageAndRegionCardState;return Object(l.__assign)(Object(l.__assign)({},e),{languageAndRegionCardState:Object(l.__assign)(Object(l.__assign)({},t),{selectedLanguage:t.savedLanguage,selectedTimeZone:t.savedTimeZone,selectedDateFormat:t.savedDateFormat,selectedTimeFormat:t.savedTimeFormat})})}(e);case Ki.g:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{parentCardId:n.cardId})}(e,t);case Ki.h:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{expandO365Settings:n.isExpanded})}(e,t);default:return e}}},uo=n(114),co=function(){function e(){}return e.prototype.AddOrUpdateWorkloadSettingLink=function(e){Object(s.D)().dispatch(Object(uo.a)(e))},e.prototype.RemoveWorkloadSettingLink=function(e){Object(s.D)().dispatch(Object(uo.i)(e))},e.prototype.SetWorkloadSettingsLinks=function(e){Object(s.D)().dispatch(Object(uo.o)(e))},e}();function lo(e,t){var n=Object(r.g)().layout,i=Object(s.D)().getState().settingsFlexPaneState.workloadSettingLinks;if(!n){var o=t.SettingsPaneEnabled&&Object(Wi.a)(Object(l.__assign)(Object(l.__assign)({},t),{CurrentMainLinkElementID:e.CurrentMainLinkElementID}),null,i).length>0,a=document.getElementById(E.k);a&&o&&(a.style.display="block")}}var po=n(135),fo=n(165),ho=n(112);function go(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!s.o.isMobileClient()})}var mo={chatState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=go(s.s,n.clientData||{})}switch(t.type){case s.h:return go(e,t.shellClientData);case s.m:return function(e,t){var n=t;return Object(fo.f)(n.isRecentsOpen,e.isTeamsChatActivated),Object(l.__assign)(Object(l.__assign)({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case ho.b:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case ho.a:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case ho.d:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case ho.c:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);default:return e}}};var vo=!1;function yo(e,t){if(!vo){vo=!0;var u=Object(s.D)(),c=Object(r.g)()&&Object(r.g)().layout;if(c)c.centerCustomizationRegion&&Object(s.z)("ChatIcon",c.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(null,878)).then((function(e){var t=e.ChatHeaderButtonConnector;Object(r.c)().invoke("LazyComponentLoaded",po.b,t),e.initializeChatComponent()}));else{var l=document.getElementById(E.b);l&&n.e("chat").then(n.bind(null,878)).then((function(e){e.initializeChatComponent();var t=e.ChatIconConnector;o.render(i.createElement(a.a,{store:u},i.createElement(t,null)),l)}))}}}var So=n(140),bo=n(149),To=function(e){function t(t){var n=e.call(this,t)||this;return n.preventEscPropagation=function(e){27===e.keyCode&&e.stopPropagation()},n.state={isShyHeaderActive:!1},Object(r.c)().subscribe("ShyHeaderActivated",(function(e){n.setState({isShyHeaderActive:e})}),!0),n}return Object(l.__extends)(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),Object(r.f)().impression("CustomFlexPane","FlexPane",0,void 0,"Loaded"),this.props.onFlexPaneOpen&&this.props.onFlexPaneOpen(),this.customRenderContainer&&this.props.render&&this.props.render(this.customRenderContainer)},t.prototype.onComponentHide=function(){e.prototype.onComponentHide.call(this),this.props.onFlexPaneClose&&this.props.onFlexPaneClose()},t.prototype.componentWillUnmount=function(){this.customRenderContainer&&o.unmountComponentAtNode(this.customRenderContainer),e.prototype.componentWillUnmount.call(this)},t.prototype.render=function(){var e,t,n=this;return i.createElement(P.c,{isActive:this.props.isActive,title:this.props.flexPaneTitle(),customTitle:this.props.customTitle,flexPaneProviderID:this.props.flexPaneProviderID,className:this.props.className},i.createElement("div",{id:"CustomFlexPane_"+this.props.flexPaneProviderID,role:"region",className:Object(s.t)(bo.flexPaneContentContainer,(e={},e[bo.flexPaneContentContainerForThinHeader]=this.props.isThinHeader,e),(t={},t[bo.flexPaneContentContainerForShyHeader]=this.state.isShyHeaderActive,t)),onKeyDown:this.props.customEscapeKeyHandling&&this.preventEscPropagation,ref:function(e){return n.customRenderContainer=e}}))},t}(P.a),Co=Object(a.b)((function(e,t){var n=e.extensibilityState.customFlexPanes[t.flexPaneProviderID];return n?Object(l.__assign)(Object(l.__assign)({},t),{className:n.containerClassName,flexPaneTitle:function(){return"function"==typeof n.flexPaneTitle?n.flexPaneTitle():n.flexPaneTitle},isThinHeader:Object(r.g)().isThinHeader,customTitle:n.customTitle,render:n.render,customEscapeKeyHandling:n.customEscapeKeyHandling,onFlexPaneOpen:n.onFlexPaneOpen,onFlexPaneClose:n.onFlexPaneClose,triggerControlID:n.triggerControlID}):(Object(r.f)().tag("UnrecognizedCustomFlexPane",6,t.flexPaneProviderID),null)}))(To),_o=n(60),Oo=n(13);function Io(e){return!!e&&"iconFontName"in e}var wo="ShellFabricMDL2IconsLite,ShellFabricMDL2Icons",Ao=function(e){function t(t){var n=e.call(this,t)||this;return n.setClickableElement=function(e){n.headerButtonElement=e},n.onClick=function(e){n.props.isStateless&&n.props.onShow&&n.props.onShow(e.currentTarget.getBoundingClientRect()),n.props.onClick&&n.props.onClick(e)},n.state={isHovered:!1},n}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&null!=this.headerButtonElement?this.props.onShow&&this.props.onShow(this.headerButtonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide&&this.props.onHide()},t.prototype.getArialLabel=function(){var e="function"==typeof this.props.ariaLabel?this.props.ariaLabel():this.props.ariaLabel;return void 0!==this.props.badgeValue&&0!==this.props.badgeValue?Object(s.C)(N.a.UnreadBadge_Count,""+e,""+this.props.badgeValue):e},t.prototype.render=function(){var e=this,t={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getArialLabel(),affordanceMenuItemText:"function"==typeof this.props.affordanceMenuItemText?this.props.affordanceMenuItemText():this.props.affordanceMenuItemText,iconData:this.props.iconData?Io(this.props.iconData)?{iconFontName:this.props.iconData.iconFontName,iconFontFamily:this.props.iconData.iconFontFamily||wo,iconFontSize:L.f.toString()}:this.props.iconData:{iconFontName:this.props.iconFontName,iconFontFamily:this.props.iconFontFamily||wo,iconFontSize:L.f.toString()},isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged,setClickableElement:this.setClickableElement};return 0===this.props.renderContext?i.createElement(R.b,Object(l.__assign)({},t),i.createElement(s.n,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:Oo.headerButtonBadgePosition})):i.createElement(R.a,Object(l.__assign)({},t),i.createElement(s.n,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:_o.affordanceContextMenuItemBadgePosition}))},t}(i.Component),Do=Object(a.b)((function(e,t){return Object(l.__assign)(Object(l.__assign)({},t),{badgeValue:e.extensibilityState.badgeValues[t.id],isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId,flexPaneProviderID:e.extensibilityState.customHeaderButtonFlexPaneTriggers[t.id]})}),(function(e,t){return{onClickDispatch:function(n,r){r.stopPropagation(),t.onClick&&t.onClick(r),t.isStateless||e(Object(s.Q)(r.currentTarget&&r.currentTarget.id)),n&&e(Object(P.f)(n))}}}),(function(e,t){return Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},e),t),{onClick:function(n){t.onClickDispatch(e.flexPaneProviderID,n)}})}))(Ao),xo="suiteux-extensibility.SET_BADGE_VALUE",Po="suiteux-extensibility.UPDATE_CUSTOMHEADERBUTTON",Eo=n(68);function ko(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e),{customFlexPanes:{},customFlexPaneHash:void 0});if(t&&t.flexPaneCollection){t.flexPaneCollection.forEach((function(e){var t=e;t.render&&(n.customFlexPanes[t.flexPaneID]=t)}));var r=Object.keys(n.customFlexPanes).sort();n.customFlexPaneHash=Object(s.E)(JSON.stringify(r))}return n}var Ro={extensibilityState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=ko(s.y,n.layout)}switch(t.type){case s.l:return function(e,t){var n=t.buttonId;e.activeButtonId===n&&(n="");return Object(l.__assign)(Object(l.__assign)({},e),{activeButtonId:n})}(e,t);case s.i:return ko(e,t.shellLayout);case Po:return function(e,t){var n=Object(l.__assign)({},e),r=Object(s.A)(e.customHeaderButtons,(function(e){return e.id===t.buttonData.id}));r>=0?n.customHeaderButtons=Object(l.__spreadArrays)(e.customHeaderButtons.slice(0,r),[t.buttonData],e.customHeaderButtons.slice(r+1)):(n.customHeaderButtons=Object(l.__spreadArrays)(e.customHeaderButtons),n.customHeaderButtons.unshift(t.buttonData));return n}(e,t);case Eo.a:return function(e,t){var n=e;t.newProvider.shellControlID&&e.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]!==t.newProvider.key&&((n=Object(l.__assign)(Object(l.__assign)({},e),{customHeaderButtonFlexPaneTriggers:Object(l.__assign)({},e.customHeaderButtonFlexPaneTriggers)})).customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]=t.newProvider.key);return n}(e,t);case xo:return function(e,t){var n=e;e.badgeValues[t.buttonID]!==t.badgeValue&&((n=Object(l.__assign)(Object(l.__assign)({},e),{badgeValues:Object(l.__assign)({},e.badgeValues)})).badgeValues[t.buttonID]=t.badgeValue);return n}(e,t);default:return e}}},Lo=n(78),No=n(113),Mo=n(16),Uo=function(e){function t(t){var n=e.call(this,t)||this;return n.onEntryPointClick=function(){n.props.isStateless?n.props.onShow(n.buttonElement.getBoundingClientRect()):n.props.onToggleButtonState(n.props.id)},n}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&this.buttonElement?this.props.onShow(this.buttonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide()},t.prototype.render=function(){var e,t=this,n=Object(Mo.a)(),r=Object(s.t)(Oo.button,No.customHeaderButton,n.headerButton,((e={})[n.activeHeaderButton]=this.props.isActive,e)),o=this.props.iconData;return i.createElement(Lo.a,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},i.createElement("div",{className:No.customHeaderButtonWrapper},i.createElement("button",{className:r,type:"button",id:"CustomHeader_"+this.props.id,ref:function(e){return t.buttonElement=e},onClick:this.onEntryPointClick,"aria-label":this.props.ariaLabel,style:Io(o)?{fontFamily:o.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},Io(o)?i.createElement(s.e,{fontSize:"16",fontValue:o.iconFontName}):o.element)))},t}(i.Component),Fo=Object(a.b)((function(e,t){return Object(l.__assign)(Object(l.__assign)({},t),{isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId})}),(function(e){return{onToggleButtonState:function(t){e(Object(s.Q)(t))}}}))(Uo),jo=[];var Bo=Object(s.D)(),Wo=function(){function e(){}return e.prototype.AddOrUpdateCustomHeaderButton=function(e){Object(r.f)().tag("AddOrUpdateCustomHeaderButton",1,e.id,e.iconData?Io(e.iconData)?e.iconData.iconFontName:"SVG element":e.iconFontName),function(e){var t=Object(s.D)(),n=Object(s.A)(jo,(function(t){return t.id===e.id}));if(n>=0?jo=Object(l.__spreadArrays)(jo.slice(0,n),[e],jo.slice(n+1)):jo.push(e),t.getState().shellInitDataState.layout){var u=Object(r.e)();u.DefaultLayoutState.CustomHeaderButtons=jo,Object(r.c)().invoke("ShellLayoutUpdated",u.GetDefaultLayout())}else{var c=Object(l.__spreadArrays)(jo).reverse().map((function(e){var t;return i.createElement(Fo,{key:e.id,id:e.id,iconData:null!==(t=e.iconData)&&void 0!==t?t:{iconFontName:e.iconFontName,iconFontFamily:e.iconFontFamily},onHide:e.onHide,onShow:e.onShow,isStateless:e.isStateless,ariaLabel:"function"==typeof e.ariaLabel?e.ariaLabel():e.ariaLabel})})),d=document.getElementById("O365_CustomHeaderButtonsContainer");Object(r.g)().isThinHeader&&(d.style.height="48px"),o.render(i.createElement(a.a,{store:t},i.createElement("div",{className:No.customHeaderButtonsContainer},c)),d)}}(e)},e.prototype.UpdateButtonState=function(e,t){var n=Object(s.D)(),r=n.getState().extensibilityState;r.activeButtonId!==e||t?r.activeButtonId!==e&&t&&n.dispatch(Object(s.Q)(e)):n.dispatch(Object(s.Q)(""))},e.prototype.SetCustomHeaderButtonBadgeValue=function(e,t){Bo.dispatch(function(e,t){return{type:xo,buttonID:e,badgeValue:t}}(e,t))},e}();var qo=!1,Ho=function(){function e(){}return e.prototype.Init=function(e,t,n,i,o){qo||(qo=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=i,this.DisableTrackEvents=o,Object(r.c)().subscribe("ShellDataUpdated",Go,!0))},e}();function Go(e,t){t.PUID&&(t.AuthAbtEnabled&&(qo=!0,window.LoadAbtPromptJs={Download:zo},n.e("abt").then(n.t.bind(null,869,7)).then((function(n){var r=n.Environment.WorldWide;Object(Zi.a)(t.Environment.toLowerCase(),"tbprod")?r=n.Environment.Trailblazer:Object(Zi.a)(t.Environment.toLowerCase(),"pfprod")&&(r=n.Environment.Pathfinder),n.initializeAbt({market:e.CultureName||"en-US",workloadName:Object(c.a)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:r,userId:t.PUID,authType:t.IsConsumerShell?n.AuthType.Msa:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signinState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls})}))),Object(r.c)().unsubscribe("ShellDataUpdated",Go))}function zo(e){n.e("abtprompt").then(n.t.bind(null,870,7)).then((function(t){e&&e()}))}var Ko=n(138),Vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:N.a.FeatureFlags_Title,affordanceMenuItemText:N.a.FeatureFlags_Title,iconID:"FeatureFlagsLogo",iconFontSize:L.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(R.b,Object(l.__assign)({},e)):i.createElement(R.a,Object(l.__assign)({},e))},t}(i.Component),Zo=Object(a.b)((function(e,t){return{id:t&&t.id,isAvailable:!0,isActive:e.flexPaneState&&"FeatureFlags"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),n.onClick&&n.onClick(t),e(Object(s.Q)(t.currentTarget&&t.currentTarget.id)),e(Object(P.f)("FeatureFlags"))}}}),(function(e,t,n){var r=Object(l.__assign)(Object(l.__assign)({},n),e);return Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(Vo),Qo="suiteux-mecontrol.UPDATE_WORKLOAD_FEATURE_FLAG_LIST";var Xo=function(){function e(){}return e.prototype.AddFeatureFlags=function(e){e?Object(s.D)().dispatch(function(e){return{type:Qo,workloadFeatureFlagList:e}}(e)):Object(r.f)().tag("FeatureFlags_Shim_FeatureFlags_Param_Invalid",6)},e.prototype.SubscribeToFeatureFlagStatusChange=function(e){return Object(r.c)().subscribe("FeatureFlagChanged",e,!1)},e}();var Jo={featureFlagsState:function(e,t){switch(e||(e={enabled:!1,workloadFeatureFlagList:{}}),t.type){case Qo:return function(e,t){var n=t;return Object(l.__assign)(Object(l.__assign)({},e),{workloadFeatureFlagList:n.workloadFeatureFlagList})}(e,t);default:return e}}};function Yo(e,t){if(t.FeatureFlagsEnabled){var i=Object(x.a)((function(){return n.e("featureflags").then(n.bind(null,881)).then((function(e){return e.FeatureFlagsFlexPanePanelConnector}))})),o=Object(r.g)().layout,a={component:i,key:"FeatureFlags",width:P.b};if(o)Object(r.c)().invoke("LazyComponentLoaded",Ko.b,Zo),a.nativeControlID="FeatureFlags";else a.btnId=E.c;Object(s.D)().dispatch(Object(P.e)(a))}}var $o,ea,ta,na,ra,ia,oa,aa,sa,ua,ca,la,da,pa,fa=n(41),ha=n(55),ga=n(54);function ma(){wa()?(0!==aa&&window.clearTimeout(aa),aa=window.setTimeout((function(){wa()&&null!=ua&&null!=da&&(pa||function(){if(null!=da&&null!=ua){var e=Object(Mo.a)();(ca=Object(L.b)(ha.shyHeader+" o365cs-base "+e.navbar,"O365_ShyHeader")).setAttribute("tabindex","0"),la=Object(L.b)(ha.shyHeaderOverlay);var t=Object(L.b)(ha.shyHeaderGripper+" "+e.shyHeader);ca.appendChild(la),ca.appendChild(t),da.appendChild(ca),ca.addEventListener(fa.a.MOUSEDOWN,ya),ca.addEventListener(fa.a.FOCUS,Sa),Object(L.a)(ua,ha.headerAnimations),Object(L.a)(da,ha.workloadDivAnimations),pa=!0}}(),Object(L.g)(ua,ha.headerSlideIn),Object(L.g)(da,ha.workloadDivSlideIn),Object(L.a)(ua,ha.headerSlideOut),Object(L.a)(da,ha.workloadDivSlideOut),ua.onanimationend=function(e){"headerSlideOutFrames"===e.animationName&&($o.invoke("ShyHeaderActivated",!0),ta=!0)})}),2e3)):ea.matches&&!oa||va()}function va(e){ta&&null!=ca&&null!=ua&&null!=da&&(ca.style.visibility="hidden",ca.style.display="none",la.style.visibility="hidden",la.style.display="none",ua.style.display="flex",Object(L.g)(ua,ha.headerSlideOut),Object(L.g)(da,ha.workloadDivSlideOut),Object(L.a)(ua,ha.headerSlideIn),Object(L.a)(da,ha.workloadDivSlideIn),ua.onanimationend=function(t){"headerSlideInFrames"===t.animationName&&($o.invoke("ShyHeaderActivated",!1),ta=!1,e&&document.getElementById(ga.b).focus())})}function ya(e){ra=!0}function Sa(e){va(!ra),ra=!1}function ba(e){na=!0}function Ta(e){na=!1,ma()}function Ca(e){ia=!0}function _a(e){ia=!1,0!==sa&&window.clearTimeout(sa),sa=window.setTimeout((function(){ia||ma()}),50)}function Oa(e){oa=e,e||ma()}function Ia(e){e&&null!=ca&&null!=ua&&(ca.style.visibility="visible",ca.style.display="flex",la.style.visibility="visible",la.style.display="flex",ua.style.display="none")}function wa(){return ea.matches&&!ta&&!na&&!ia&&!oa}var Aa=n(116),Da=!1;function xa(e,t){if(!Da){var n=Object(r.g)();if(n&&n.supportShyHeaderMode){var i=document.getElementById(n.top);!function(e,t,n){$o=Object(r.c)(),ea=window.matchMedia("(max-height: "+t+"px)"),aa=0,sa=0,da=n,ua=e,window.addEventListener(fa.a.RESIZE,ma),ua.addEventListener(fa.a.MOUSEENTER,ba),ua.addEventListener(fa.a.MOUSELEAVE,Ta),ua.addEventListener(fa.a.FOCUS,Ca,!0),ua.addEventListener(fa.a.BLUR,_a,!0),$o.subscribe("ContextMenuPopup",Oa),$o.subscribe("ShyHeaderActivated",Ia,!0),ma()}(document.getElementById(E.e),n.shyHeaderActivationHeight?n.shyHeaderActivationHeight:Aa.b,i),Da=!0}}}var Pa=n(71),Ea=n(28),ka=n(40),Ra=n(141),La=n(92),Na=n(124),Ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(r.f)().perfMarker("MyDayTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:N.a.MyDay,affordanceMenuItemText:N.a.MyDay,iconID:"EventToDoLogo",iconFontSize:L.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(La.a,Object(l.__assign)({},e)):i.createElement(Na.a,Object(l.__assign)({},e))},t}(i.Component),Ua=Object(a.b)((function(e,t){var n;return{isAvailable:e.shellInitDataState.clientData.OpxEnabled&&e.shellInitDataState.clientData.MyDayOpxEnabled,id:null==t?void 0:t.id,isActive:"MyDay"===(null===(n=e.flexPaneState)||void 0===n?void 0:n.activeProviderKey),controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){var i;t.stopPropagation(),Object(r.f)().click("MyDay","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),e(Object(s.Q)(null===(i=t.currentTarget)||void 0===i?void 0:i.id)),e(Object(ka.b)("MyDay")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var r=Object(l.__assign)(Object(l.__assign)({},n),e);return Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},r),t),{onClick:function(e){return t.onClick(e,r)},onDimensionsChanged:function(){return t.onDimensionsChanged(r)}})}))(Ma);function Fa(e,t){if(t.OpxEnabled&&t.MyDayOpxEnabled&&!Object(c.c)(t.WorkloadId,e.CurrentMainLinkElementID)){Object(r.c)().unsubscribe("ShellDataUpdated",Fa);var i={component:Object(x.a)((function(){return n.e("myday").then(n.bind(null,883)).then((function(e){return e.MyDayFlexPaneConnector}))})),key:"MyDay",width:Pa.a};Object(r.c)().invoke("LazyComponentLoaded",Ra.b,Ua),i.nativeControlID="MyDay",Object(Ea.a)().dispatch(Object(ka.a)(i))}}var ja=n(197),Ba=n(32),Wa="LazyDocumentTitleComponentName",qa=(Object(Ba.a)(Wa),!1),Ha=function(){function e(){}return e.prototype.SetProps=function(e){(qa?Promise.resolve():n.e("dtt").then(n.bind(null,874)).then((function(e){qa=!0,Object(r.c)().invoke("LazyComponentLoaded",Wa,e.DocumentTitleConnector)}))).then((function(){return Object(s.D)().dispatch(Object(ja.a)(e))}))},e}();var Ga,za,Ka,Va,Za,Qa,Xa,Ja,Ya,$a,es,ts=n(143),ns=function(){function e(){}return e.prototype.UpdateAccount=function(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){Object(r.f)().exception("MAST_UpdateAccount_Failed",6,e)}},e.prototype.SetActiveAccount=function(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){Object(r.f)().exception("MAST_SetActiveAccount_Failed",6,e)}},e.prototype.UpdateMastConfiguration=function(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){Object(r.f)().exception("MAST_UpdateConfiguration_Failed",6,e)}},e.prototype.Init=function(){Object(r.c)().subscribe("ShellDataUpdated",rs,!0)},e}();function rs(e,t){var i=Object(r.g)();if(Ga=e.SignOutLink.Url,t.AccountSwitchingEnabled&&i.shellAuthProviderConfig){var o,a=i.shellAuthProviderConfig.login_Hint,s={authenticatedState:1,upn:a||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},u={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},c=function(e){var t=Object(r.g)(),n=void 0,i=!0,o=t.shellAuthProviderConfig,a=o.appSwitchToUrl||o.appSignInUrl;a&&"string"==typeof a?n=a:i=!1;var s=o.appSignOutUrl,u=s&&"string"==typeof s?s:Ga,c={appFriendlyName:e,switchAccountTitle:N.a.SwitchAccountTitle,switchAccountDescription:N.a.SwitchAccountDescription,switchAccountSubDescription:N.a.SwitchAccountSubDescription,switchAccountButtonText:N.a.SwitchAccountButtonText,switchAccountAlternativeUpnText:N.a.SwitchAccountAlternativeUpnText,signOutTitle:N.a.SignOutTitle,signOutDescription:N.a.SignOutDescription,signOutSubDescription:N.a.SignOutSubDescription,signOutButtonText:N.a.SignOutButtonText};return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:u,postAccountSwitchRedirectUri:n,mastPromptLocalizedStrings:c,appendLoginHint:i,enableConsoleLogging:!1}}(t.AppHeaderLinkText);void 0!==c.postAccountSwitchRedirectUri&&void 0!==c.postLogoutRedirectUri||(o={modifySwitchAccountRedirectUriFunction:is,modifySignoutRedirectUriFunction:os}),window.LoadMastPromptJs={Download:as},n.e("mast").then(n.t.bind(null,871,7)).then((function(n){new n.MultiAccountSessionTracker(c,o),window.MastInteraction&&window.MastInteraction.UpdateAccount(t.PUID,s,!0),window.addEventListener("message",ss.bind(self,u,e.SignOutLink),!1)})).catch((function(e){return Object(r.f)().exception("MASTPackage_DownLoad_Failed",6,e)})),Object(r.c)().unsubscribe("ShellDataUpdated",rs)}}function is(e,t,n){var i=Object(r.g)().shellAuthProviderConfig;if(i&&i.appSwitchToUrl&&"function"==typeof i.appSwitchToUrl){var o={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return i.appSwitchToUrl(o)}}function os(e,t){var n=Object(r.g)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){var i={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return n.appSignOutUrl(i)}}function as(e){n.e("mastprompt").then(n.t.bind(null,872,7)).then((function(){e&&e()})).catch((function(e){return Object(r.f)().exception("MASTPromptPackage_DownLoad_Failed",6,e)}))}function ss(e,t,n){if(null!==n.data)if("SwitchAccountRedirect"===n.data.request)null!==n.data.url&&void 0!==n.data.url&&(Object(r.f)().click("Switch","Mast"),window.removeEventListener("message",ss.bind(n,e,t),!1),Object(ts.a)().then((function(){})).catch((function(e){Object(r.f)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)})),Object(r.c)().invoke("AccountSwitchInitiated",e));else if("SignOutBackToLanding"===n.data.request&&null!==n.data.url&&void 0!==n.data.url){Object(r.f)().click("SignOut","Mast"),window.removeEventListener("message",ss.bind(n,e,t),!1),null!=t.Action&&t.Action();var i={triggerEvent:n};Object(r.c)().invoke("SignOut",i)}}(Va=Object(s.D)().getState()).userState.isConsumer||s.N.register(T),za=new I,Ka=window.O365Shell.Apps,window.O365Shell.Apps=za,Ka.applyCalls(za),Va.userState.isConsumer||Object(r.c)().subscribe("ShellDataUpdated",w,!0),A=Object(r.c)().subscribe("ShellDataUpdated",(function(e,t){if(t.NotificationsEnabled){Object(r.c)().unsubscribe("ShellDataUpdated",A);var i=function(){return n.e("notifications").then(n.bind(null,877)).catch((function(e){return Object(r.f)().exception("NotificationsPackage_LoadFail",6,e)}))},o=Object(r.g)();o&&o.layout?o.layout.centerCustomizationRegion&&Object(D.a)("NotificationBellIcon",o.layout.centerCustomizationRegion.children)&&i():i()}}),!0),function(){var e=function(){return n.e("extraflexpane").then(n.bind(null,879))},t=window.O365Shell.NFD;t.registerShimCallback&&t.registerShimCallback((function(){e()}),["OpenHelp","OpenFeedback"]);var i=Object(x.a)((function(){return e().then((function(e){return e.HelpFlexPanePanelConnector}))})),o=Object(r.g)(),a={component:i,key:"Help",width:P.b,overrideOnClick:o.OnHelpButtonClick};o.layout?(Object(r.c)().invoke("LazyComponentLoaded",k.b,U),a.nativeControlID="HelpIcon"):a.btnId=E.f,Object(s.D)().dispatch(Object(P.e)(a));var u=Object(x.a)((function(){return e().then((function(e){return e.FeedbackFlexPaneConnector}))}));Object(s.D)().dispatch(Object(P.e)({component:u,key:"Feedback",width:P.b}))}(),Object(r.c)().subscribe("ShellDataUpdated",G,!0),Object(r.c)().subscribe("ShellDataUpdated",Ni,!0),Object(r.c)().subscribe("ShellDataUpdated",Fi,!0),function(){var e,t;s.N.register(so),e=new co,t=window.O365Shell.Settings,window.O365Shell.Settings=e,t.applyCalls(e);var i=Object(x.a)((function(){return n.e("extraflexpane").then(n.bind(null,876)).then((function(e){return e.SettingsFlexPanePanelConnector}))}));Object(r.c)().subscribe("ShellDataUpdated",lo,!0);var o=Object(r.g)().layout,a={component:i,key:"Settings",width:P.b};o?(Object(r.c)().invoke("LazyComponentLoaded",ji.b,qi),a.nativeControlID="SettingsIcon"):a.btnId=E.k,Object(s.D)().dispatch(Object(P.e)(a))}(),s.N.register(mo),Object(r.c)().subscribe("ShellDataUpdated",yo,!0),function(){var e,t;s.N.register(Ro),e=new Wo,t=window.O365Shell.Extensibility,window.O365Shell.Extensibility=e,t.applyCalls(e);var n,i=Object(s.D)();function o(){var e=i.getState();n!==e.extensibilityState.customFlexPaneHash&&Object.keys(e.extensibilityState.customFlexPanes).forEach((function(t){if(!e.flexPaneState.registeredProviders.some((function(e){return e.key===t}))){var n=e.extensibilityState.customFlexPanes[t];i.dispatch(Object(P.e)({component:Co,btnId:n.triggerControlID,shellControlID:n.triggerControlID,key:t,width:P.b}))}}));n=e.extensibilityState.customFlexPaneHash}o(),Object(r.c)().invoke("LazyComponentLoaded",So.b,Do),i.subscribe(o)}(),Object(d.k)(),Za=function(){return n.e("diagnostics").then(n.bind(null,884))},(Qa=window.O365Shell.Diagnostics).registerShimCallback&&Qa.registerShimCallback((function(){Za()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&Za(),function(){var e=new Ho,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);var n=Object(r.g)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),s.N.register(Jo),Xa=new Xo,Ja=window.O365Shell.FeatureFlags,window.O365Shell.FeatureFlags=Xa,Ja.applyCalls(Xa),Object(r.c)().subscribe("ShellDataUpdated",Yo,!0),Object(r.c)().subscribe("ShellDataUpdated",xa,!0),(Ya=Object(r.g)())&&Ya.layout&&Ya.layout.centerCustomizationRegion&&Object(D.a)("MyDay",Ya.layout.centerCustomizationRegion.children)&&Object(r.c)().subscribe("ShellDataUpdated",Fa,!0),$a=new Ha,es=window.O365Shell.DTT,window.O365Shell.DTT=$a,es&&es.applyCalls($a),Object(r.g)().shellAuthProviderConfig&&(new ns).Init(),Object(r.c)().invoke("PlusLoaded"),Object(r.f)().perfMarker("shell_plus_executioncomplete")}]]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));