(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0||[]).push([[0],{"+3E/":function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("UWqr"),r=function(){function t(){}return t.isAdditionalMsalTelemetryEnabled=function(){return!n._SPKillSwitch.isActivated(n.Guid.parse("0f83cdbf-a595-48d6-a1b5-ff70e5daf777"),"03/26/20","Add additional telemetry for MSAL calls")},t.isLogAadAdditionalTelemetryEnabled=function(){return!n._SPKillSwitch.isActivated(n.Guid.parse("d6619064-d4fc-4659-8306-7e9edb59d871"),"04/13/20","Add additional logging for the time it takes to fetch Aad tokens")},t.isUpdateTokenForImplicitTokenProviderEnabled=function(){return!n._SPKillSwitch.isActivated(n.Guid.parse("d4f4cc58-9fc2-47f1-a5df-66add6851f7c"),"09/08/20","Allow ImplicitTokenProvider update token")},t.isRetryTimeoutsEnabled=function(){return!n._SPKillSwitch.isActivated("8677b99c-f245-43dd-8e78-a6f512170c24")},t.isRetryWithLoginHintEnabled=function(){return!n._SPKillSwitch.isActivated("a7bec1ab-8f5f-43dc-8723-b7160b9430b5")},t.isRetryIdTokenWithLoginHintEnabled=function(){return!n._SPKillSwitch.isActivated("343c4c23-c2a0-4fb5-8e8a-334c8bad48e5")},t.isRetryOnResolveEndpointsFailureEnabled=function(){return!n._SPKillSwitch.isActivated("d156f602-a884-45d4-817b-afb6405eb98d")},t.isReturnTokenDataEnabled=function(){return!n._SPKillSwitch.isActivated(n.Guid.parse("0a135eef-868e-4f30-9876-5c06736f4d6a"),"02/26/21","Add new api to return token response")},t.isBlockLoginHintForGuestsEnabled=function(){return!n._SPKillSwitch.isActivated(n.Guid.parse("e9d6178f-673d-4440-9463-0ba7c6f4d1f9"),"03/11/2021","Block login hint for guests")},t}()},NUTh:function(t,e,i){"use strict";i.r(e),i.d(e,"DeferredAadTokenProvider",function(){return s});var n=i("UWqr"),r=i("ut3N"),o=i("NJ9J"),a=i("MGiw"),d=i("+3E/"),s=function(){function t(t,e,i,r,o){n.Validate.isNonemptyString(i.aadInstanceUrl,"aadInstanceUrl"),n.Validate.isNonemptyString(i.aadTenantId,"aadTenantId"),n.Validate.isNonemptyString(i.redirectUri,"redirectUri"),n.Validate.isNonemptyString(i.servicePrincipalId,"servicePrincipalId"),this._defaultConfiguration=i,this._oboConfiguration=r,this._oboFirstPartyTokenCallback=o,this._tokenAcquisitionEvent=t,this.onBeforeRedirectEvent=e}return t.prototype.getToken=function(e,i){var r=this;return void 0===i&&(i=!0),this._defaultConfiguration.servicePrincipalId===n.Guid.empty.toString()?Promise.reject(new Error(o.c)):(n._SPKillSwitch.isActivated(t.msalTrialRunKillSwitchGuid,"09/11/19","Run MSAL for only 1/10th of all requests")||0!==Math.floor(10*Math.random())||this._getMsalTokenProvider(this._defaultConfiguration).then(function(t){return r._getToken(t,e,i)}).catch(function(t){}),this._getTokenInternal(e,this._defaultConfiguration,i))},t.prototype._getTokenData=function(t,e){if(void 0===e&&(e=!0),this._defaultConfiguration.servicePrincipalId===n.Guid.empty.toString())return Promise.reject(new Error(o.c));var i=new r._QosMonitor("AadTokenProvider.GetAppTokenResponseTimePerf");if(this._shouldUseMsalTokenProvider())return this._getMsalTokenProvider(this._defaultConfiguration).then(function(i){return i.getTokenData(t,e)}).then(function(t){return i.writeSuccess(),t});var a="Getting token response not supported for the current token provider";throw i.writeUnexpectedFailure(a),new Error(a)},t.prototype._getTokenInternal=function(t,e,i){var o=this;void 0===i&&(i=!0);var s=new r._QosMonitor("AadTokenProvider.GetAppTokenTimePerf"),u=e||this._defaultConfiguration;return(this._shouldUseOboTokenExchange()&&this._oboConfiguration?this._getOboTokenProvider(n._SPFlight.isEnabled(60254)?u:this._defaultConfiguration,this._oboConfiguration,this._oboFirstPartyTokenCallback).then(function(e){return o._getToken(e,t,i)}):this._shouldUseMsalTokenProvider()?this._getMsalTokenProvider(u).then(function(e){return o._getToken(e,t,i)}):n._SPFlight.isEnabled(1476)?this._getImplicitTokenProvider(u).then(function(e){return o._getToken(e,t,i)}):this._getAdalTokenProvider(u).then(function(e){return e.getToken(t,i)})).then(function(e){if(d.a.isLogAadAdditionalTelemetryEnabled()){var i=u.servicePrincipalId===a.a.PRE_AUTHORIZED_APP_PRINCIPAL_ID,n={isInternal:i};i&&(n.name=t),s.writeSuccess(n)}return e}).catch(function(t){throw d.a.isLogAadAdditionalTelemetryEnabled()&&s.writeUnexpectedFailure(),t})},t.prototype._getToken=function(t,e,i){return t.getToken(e,i)},Object.defineProperty(t.prototype,"tokenAcquisitionEvent",{get:function(){return this._tokenAcquisitionEvent},enumerable:!1,configurable:!0}),t.prototype._shouldUseMsalTokenProvider=function(){return!!n.Guid.tryParse(this._defaultConfiguration.aadSessionId)&&n._SPFlight.isEnabled(1887)},t.prototype._getAdalAuthContextManager=function(t){return this._authContextManager||(this._authContextManager=Promise.all([i.e(6),i.e(1)]).then(i.bind(null,"z1gO")).then(function(t){return new t.AdalAuthContextManager})),this._authContextManager},t.prototype._getAdalTokenProvider=function(t){return this._getAdalAuthContextManager(t).then(function(e){return e.getAdalTokenProvider(t)})},t.prototype._getMsalTokenProvider=function(t){var e=this;return Promise.all([i.e(7),i.e(3)]).then(i.bind(null,"X7FI")).then(function(i){return e._isFirstParty(t.servicePrincipalId)?(e._firstPartyMsalTokenProvider||(e._firstPartyMsalTokenProvider=new i.MsalTokenProvider(t)),e._firstPartyMsalTokenProvider):(e._thirdPartyMsalTokenProvider||(e._thirdPartyMsalTokenProvider=new i.MsalTokenProvider(t)),e._thirdPartyMsalTokenProvider)})},t.prototype._getImplicitTokenProvider=function(t){var e=this;return i.e(5).then(i.bind(null,"onrO")).then(function(i){return e._isFirstParty(t.servicePrincipalId)?(e._firstPartyImplicitTokenProvider||(e._firstPartyImplicitTokenProvider=new i.ImplicitFlowTokenProvider(t)),e._firstPartyImplicitTokenProvider):(e._thirdPartyImplicitTokenProvider||(e._thirdPartyImplicitTokenProvider=new i.ImplicitFlowTokenProvider(t)),e._thirdPartyImplicitTokenProvider)})},t.prototype._getOboTokenProvider=function(t,e,i){var n=this;return this._getAdalAuthContextManager(t).then(function(r){return n._thirdPartyOboTokenProvider||(n._thirdPartyOboTokenProvider=r.getOboTokenProvider(t,e,i)),n._thirdPartyOboTokenProvider})},t.prototype._isFirstParty=function(t){return t===a.a.PRE_AUTHORIZED_APP_PRINCIPAL_ID},t.prototype._shouldUseOboTokenExchange=function(){return!!this._oboConfiguration},t.msalTrialRunKillSwitchGuid=n.Guid.parse("fa0b23a7-7b4e-4fbe-b635-bbed397c3ef5"),t}()}}]);