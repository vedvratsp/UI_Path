(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[13],{"3Ilx":function(e,r,t){"use strict";t.d(r,"a",function(){return m});var o=t("17wl"),i=t("6o44"),n=t("OpjN"),s=t("4AK9"),a=t("K9kD"),u=function(){function e(e,r,t,o,i){this._groupsProvider=e,this._parentGroup=r,this._loadPageFromServerDelegate=t,this._pageSize=o&&"number"==typeof o.pageSize?o.pageSize:20,this._shouldAddOwnershipInformation=!o||(o.ownershipInformation,!1)||o.ownershipInformation,this._userLoginName=i,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var r=this,t=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,t,this._pageSize).then(function(e){return r._processPage(e,t)},function(e){return r.error=e,a.Promise.reject(e)}):a.Promise.reject(void 0)},e.prototype._processPage=function(e,r){var t=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var o=r+this._pageSize>=this.totalNumberOfMembers,i=o?void 0:this._computeGetNextPagePromise(r+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,o),a.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(r){return t._addOwnershipInformationToPage(e,o,r),a.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})}):a.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})},e.prototype._addOwnershipInformationToPage=function(e,r,t){var o=this;if(t&&(this.totalNumberOfOwners=t.totalNumberOfOwners,this._ownersDictionary={},t.ownersList.members.forEach(function(e){e.userId&&(o._ownersDictionary[e.userId]=e)}),this.isOwner=t.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=o._ownersDictionary&&!!o._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(o._numberOfOwnersFound++,o._foundOwnersDictionary[e.userId]=!0)}),r&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var n=this._ownersDictionary[i];this._foundOwnersDictionary[n.userId]||(n.isOwnerOfCurrentGroup=!0,e.membersList.members.push(n),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var r=this;return function(){return r.loadPage(e)}},e}(),p=t("3HEj"),c=t("mxVm"),m=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._pageContext=e.pageContext,this._dataRequestor=new a.DataRequestor({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new s.a(e.pageContext);var r=function(e){return e.name?Object(o.__assign)(Object(o.__assign)({},e),{name:"GroupsProvider.PersistentCache."+e.name}):e};this._persistentCache=new c.a({secret:void 0,cacheType:1,telemetry:{engagement:a.Engagement.withData(r),qos:a.Qos.withData(r)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new a.EventGroup(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var r=this;return new u(this,this.group,function(e,t,o){return e?r._userLoginName?r._dataSource.getGroupMembershipPage(e,r._userLoginName,t,o):a.Promise.reject(r._missingLoginNameError):a.Promise.reject("Missing group id.")},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?a.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):a.Promise.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return a.Promise.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,r){var t=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:r.isMember,totalNumberOfMembers:r.totalNumberOfMembers,totalNumberOfOwners:r.totalNumberOfOwners,membersList:r.membersList,isOwner:r.isOwner,isJoinPending:r.isJoinPending,lastLoadTimeStampFromServer:r.lastLoadTimeStampFromServer},t.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var r=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return r._performBasicPropertiesPostProcessing(e),Object(p.f)(r._pageContext)&&r.doesCachedGroupPropertiesDiffer(e)&&r.syncGroupProperties(),e}):a.Promise.reject("Missing group id.")},e.prototype.loadMembershipContainerFromServer=function(e,r,t){return void 0===r&&(r=!1),void 0===t&&(t=!1),e?this._userLoginName?this._dataSource.getGroupMembership(e,this._userLoginName,r,t):a.Promise.reject(this._missingLoginNameError):a.Promise.reject("Missing group id.")},e.prototype.loadOwnershipContainerFromServer=function(e,r){return e?this._dataSource.getGroupOwnership(e,r):a.Promise.reject("Missing group id.")},e.prototype.loadUserGroups=function(e){var r=this;return this.loadUserGroupsFromCache(e).then(function(t){return t&&0!==t.length?a.Promise.resolve(t):r.getCurrentUser().then(function(t){return e?r._dataSource.getUserGroupsFromAAD(t).then(function(e){return r._persistentCache.update({key:"UserGroupsFromAAD"+t.userId},e),e}):r._dataSource.getUserGroups(t).then(function(e){return r._persistentCache.update({key:"UserGroups"+t.userId},e),r._setUsersGroups(e,n.a.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var r=this;return this.getCurrentUser().then(function(t){return(e?a.Promise.resolve(r._persistentCache.read({key:"UserGroupsFromAAD"+t.userId}).then(function(e){return e.data})):a.Promise.resolve(r._persistentCache.read({key:"UserGroups"+t.userId}).then(function(e){return e.data}))).then(function(t){return t&&!e&&r._setUsersGroups(t,n.a.Cache),t})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(r){for(var t=0,o=r.length;t<o;t++)if(r[t].id===e)return!0;return!1})},e.prototype.getGroup=function(e,r){var t=this;if(void 0===r&&(r=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return r||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new a.Promise(function(e,r){var o=t.group;t.group?o.source===n.a.None?t._eventGroup.on(o,i.b.onSourceChange,function(i){i!==n.a.Error?i===n.a.None||e(o):r(t.group.error)}):e(o):r("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?a.Promise.resolve(this.currentUser):this._getUserFromCache("CurrentUser").then(function(r){return e.currentUser=r,r||e._dataSource.getUserInfo(e._userLoginName).then(function(r){return e._saveUserToCache(r,"CurrentUser"),e.currentUser=r,r})}):a.Promise.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,r,t,o){var i,n=this;return e?this._getUserIdForCacheClear(r,t).then(function(s){return i=s,n._dataSource.addGroupMember(e,r,t,o)}).then(function(){n._clearUserGroupsCache(i)}):a.Promise.reject("Missing group id.")},e.prototype.addUserToGroupOwnership=function(e,r,t,o){var i,n=this;return e?this._getUserIdForCacheClear(r,t).then(function(s){return i=s,n._dataSource.addGroupOwner(e,r,t,o)}).then(function(){n._clearUserGroupsCache(i)}):a.Promise.reject("Missing group id.")},e.prototype.removeUserFromGroupMembership=function(e,r,t){var o,i=this;return e?this._getUserIdForCacheClear(r).then(function(n){return o=n,i._dataSource.removeGroupMember(e,r,t)}).then(function(){i._clearUserGroupsCache(o)}):a.Promise.reject("Missing group id.")},e.prototype.removeUserFromGroupOwnership=function(e,r,t){var o,i=this;return e?this._getUserIdForCacheClear(r).then(function(n){return o=n,i._dataSource.removeGroupOwner(e,r,t)}).then(function(){i._clearUserGroupsCache(o)}):a.Promise.reject("Missing group id.")},e.prototype.addUsersToGroup=function(e,r,t,o,i){var n,s=this;return e?this.currentUser?(n=this.currentUser.userId,this._dataSource.addUsersToGroup(e,r,t,o,i).then(function(e){return s._clearUserGroupsCache(n),e})):this.getCurrentUser().then(function(e){n=e.userId}).then(function(){return s._dataSource.addUsersToGroup(e,r,t,o,i)}).then(function(e){return s._clearUserGroupsCache(n),e}):a.Promise.reject("Missing group id.")},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var r=this.group?this.group.id:void 0;if(e&&e!==r){var t=this.getCachedGroup(e);t.load(),this.group=t}},e.prototype.getCachedGroup=function(e,r){var t=this._groups[e];return t||(t=new i.b(r,this,e,this._pageContext),this._groups[e]=t),t},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var r=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:r,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var r=this._pageContext;return r.groupId===e.id&&(r.webTitle!==e.name||(r.siteClassification||e.classification)&&r.siteClassification!==e.classification||(r.sensitivityLabel||e.assignedLabels)&&r.sensitivityLabel.toLocaleLowerCase()!==e.assignedLabels.toLocaleLowerCase()||null===r.groupType||void 0===r.groupType||"Public"===r.groupType!==e.isPublic||!a.Killswitch.isActivated("C846AC33-6AD5-479A-B4FD-8DE1AF891B6F","04/10/2020","Lazt Sync Teams Connected Site")&&!r.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,r){return this._dataSource.teamifyV2(e,r)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return a.Promise.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var r=this;return a.Promise.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(t){return!!t.data||r._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){return"HideTeamify:"+(e||this._pageContext.siteId)},e.prototype._setUsersGroups=function(r,t){var o=this;this.userGroups=r.map(function(e){var r=o.getCachedGroup(e.id,e);return t!==n.a.Server&&r.source===n.a.Server||r.extend(e),r.pictureUrl||r.load(),r}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl=this._pageContext.webAbsoluteUrl+"/_api/GroupService/GetGroupImage",e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations","Yammer.FeedURL"),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,"MicrosoftTeams.TeamHomeURL"))},e.prototype._getWorkloadUrl=function(e,r,t,o){var i=null,n=e.yammerResources,s=e.teamsResources,a=function(e){var r=e.filter(function(e){return e.Key===o});return r&&r[0]?r[0].Value:null};return"MicrosoftTeams.TeamHomeURL"===o?s&&s.results&&s.results.length>0&&(i=a(s.results)):n&&n.results&&n.results.length>0?"Yammer.FeedURL"===o&&(i=a(n.results)):i=e[r]?e[r]:this._pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+e.id+"&target="+t,i},e.prototype._saveUserToCache=function(e,r){if(e)return this._persistentCache.update({key:r},e)},e.prototype._getUserFromCache=function(e){return a.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return a.Promise.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,r){var t;return this.currentUser&&e?(t=e===this.currentUser.userId?e:null,a.Promise.resolve(t)):this.getCurrentUser().then(function(o){return t=e?e===o.userId?o.userId:null:r===o.principalName?o.userId:null})},e.onUserGroupsChange="userGroups",e}()},"4AK9":function(e,r,t){"use strict";var o=t("17wl"),i=t("tOru"),n=t("1tKF"),s=t("K9kD"),a=t("ynV5"),u=t("y88i"),p=t("C21W"),c=t("QVYh"),m="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",h="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",l="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",d=function(e){function r(r){var t=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:r})||this;return t._isTeamifyPromptHiddenCacheKey=r?"isTeamifyPromptHidden_"+(r.siteId+r.groupId):"isTeamifyPromptHidden",t}return Object(o.__extends)(r,e),r._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},r._parseUser=function(e){var t=JSON.parse(e);return r._copyMember(t.d)},r._copyMembers=function(e){var t=new i.b;return t.members=e.map(function(e){return r._copyMember(e)}),t},r._parseGroup=function(e){var t=JSON.parse(e);return r._copyGroup(t.d)},r._parseMembership=function(e){var t=JSON.parse(e);return r._copyMembership(t.d)},r._copyGroup=function(e){var t={description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,membership:r._copyMembership(e)};return r._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&(t.assignedLabels=e.assignedLabels),t},r._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?r._copyMembers(e.results):void 0}},r._parseOwnership=function(e){var t=JSON.parse(e);return r._copyOwnership(t.d)},r._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?r._copyMembers(e.results):void 0}},Object.defineProperty(r,"_isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled",{get:function(){return s.FeatureOverrides.isFeatureEnabled({ODB:1688})},enumerable:!0,configurable:!0}),r.prototype.getGroupBasicProperties=function(e){var t=this;return this.getData(function(){return t._getUrl(a.format(r._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled?"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels":"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic",e),"SP.Directory.DirectorySession")},function(o){var i=r._parseGroup(o);return i.id||(i.id=e),t._calculateMissingGroupProperties(i,e),i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},r.prototype.setGroupBasicProperties=function(e){var t=this;return e?this.getData(function(){return t._getUrl(a.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t;return t=s.Killswitch.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")?{__metadata:{type:"SP.Directory.Group"},displayName:e.name,description:e.description}:{__metadata:{type:"SP.Directory.Group"}},s.Killswitch.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")||(e.name&&(t.displayName=e.name),e.description&&(t.description=e.description)),r._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&e.assignedLabels?(null!=e.isPublic&&(t.isPublic=e.isPublic),e.assignedLabels===s.Guid.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(t.isPublic=e.isPublic),e.classification&&(t.classification=e.classification)),JSON.stringify(t)},"PATCH",void 0,void 0,3):s.Promise.reject("Group parameter is null or undefined")},r.prototype.getGroupByAlias=function(e){var t=this;return this.getData(function(){return t._getUrl(a.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return r._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},r.prototype.getGroupMembership=function(e,t,o,i){var n=this;void 0===o&&(o=!1),void 0===i&&(i=!1);var u=o?"100":"3";return this.getData(function(){return n._getUrl(a.format(m,e,"members","0",u),"SP.Directory.DirectorySession")},function(e){var o=r._parseMembership(e);return n._calculateMissingMembershipProperties(o,t),o},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(r){return i?n._addOwnerInformation(e,t,r):s.Promise.resolve(r)})},r.prototype.getGroupMembershipPage=function(e,t,o,i){var n=this;return this.getData(function(){return n._getUrl(a.format(m,e,"members",o,i),"SP.Directory.DirectorySession")},function(e){var o=r._parseMembership(e);return n._calculateMissingMembershipProperties(o,t),o},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},r.prototype.getGroupOwnership=function(e,t){var o=this,i=t||"100";return this.getData(function(){return o._getUrl(a.format(m,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var t=r._parseOwnership(e);return o._calculateMissingOwnershipProperties(t),t},"GetOwnership",void 0,"GET",void 0,void 0,3)},r.prototype.getUserGroupsFromAAD=function(e){var r=this;return this.getData(function(){return r._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return a.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},r.prototype.getUserGroups=function(e){var r=this,t=function(){return r.getUserGroupsFromAAD(e)};return this.getData(function(){return r._getUrl(a.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:t()},t)},r.prototype.addGroupMember=function(e,r,t,o){var i=this;return r=r||s.Guid.Empty,t=t||"",this.getData(function(){return i._getUrl(a.format(h,e,r,t),"SP.Directory.DirectorySession")},void 0,o||"AddMember",void 0,"POST",void 0,void 0,3)},r.prototype.addGroupOwner=function(e,r,t,o){var i=this;return r=r||s.Guid.Empty,t=t||"",this.getData(function(){return i._getUrl(a.format(l,e,r,t),"SP.Directory.DirectorySession")},void 0,o||"AddOwner",void 0,"POST",void 0,void 0,3)},r.prototype.removeGroupMember=function(e,r,t){var o=this;return this.getData(function(){return o._getUrl(a.format("Group('{0}')/Members/Remove('{1}')",e,r),"SP.Directory.DirectorySession")},void 0,t||"RemoveMember",void 0,"POST",void 0,void 0,3)},r.prototype.removeGroupOwner=function(e,r,t){var o=this;return this.getData(function(){return o._getUrl(a.format("Group('{0}')/Owners/Remove('{1}')",e,r),"SP.Directory.DirectorySession")},void 0,t||"RemoveOwner",void 0,"POST",void 0,void 0,3)},r.prototype.addUsersToGroup=function(e,r,t,i,n){var u=this,c=s.Guid.generate(),m="multipart/mixed; boundary=batch_"+c,d=[],f=[],g=0,v=0,_=function(r,t,o){for(var i=t?l:h,n=0;n<r.length;n++){var p=void 0,c=void 0;if(o?c=r[n]:p=r[n],p||c){p=p||s.Guid.Empty,c=c||"";var m=u._getUrl(a.format(i,e,p,c),"SP.Directory.DirectorySession");t?f.push(m):d.push(m)}}};if(r?(_(r,!0,!1),g=r.length):i&&(_(i,!0,!0),g=i.length),t?(_(t,!1,!1),v=t.length):n&&(_(n,!1,!0),v=n.length),!(f.length<1&&d.length<1)){var b=this.getData(function(){return p.a.getBatchOperationUrl(u._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return p.a.getBatchContent(c,[f,d],"POST",p.a.defaultBatchRequestPostData)},"POST",void 0,m,void 0,void 0,void 0,function(e){var r=e.errorData,t=e.eventData;return r?(r.extraData={OwnersNumber:g,MembersNumber:v},{eventData:Object(o.__assign)(Object(o.__assign)({},t),{resultCode:r.status.toString()})}):{eventData:t}},void 0);return new s.Promise(function(e,r){b.then(function(t){var o=p.a.processBatchResponse(t);o.hasError?r(o):e(o)},function(e){r(e)})})}},r.prototype.addRemoveGroupUsers=function(e,r,t,i,n){var u=this,c=s.Guid.generate(),m="multipart/mixed; boundary=batch_"+c,d=[],f=[],g=[],v=[],_=function(r,t,o){var i="SP.Directory.DirectorySession";if(void 0!==r)for(var n=0;n<r.length;n++)if(t)if(o){var s=u._getUrl(a.format(l,e,r[n],""),i);d.push(s)}else s=u._getUrl(a.format("Group('{0}')/Owners/Remove('{1}')",e,r[n]),i),g.push(s);else o?(s=u._getUrl(a.format(h,e,r[n],""),i),f.push(s)):(s=u._getUrl(a.format("Group('{0}')/Members/Remove('{1}')",e,r[n]),i),v.push(s))};if(_(r,!0,!0),_(i,!0,!1),_(t,!1,!0),_(n,!1,!1),0!==d.length||0!==f.length||0!==g.length||0!==v.length){var b=this.getData(function(){return p.a.getBatchOperationUrl(u._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return p.a.getBatchContent(c,[d,f,g,v],"POST",p.a.defaultBatchRequestPostData)},"POST",void 0,m,void 0,void 0,void 0,function(e){var r=e.errorData,t=e.eventData;return r?(r.extraData={OwnersToAdd:d.length,MembersToAdd:f.length,OwnersToRemove:g.length,MembersToRemove:v.length},{eventData:Object(o.__assign)(Object(o.__assign)({},t),{resultCode:r.status.toString()})}):{eventData:t}},void 0);return new s.Promise(function(e,r){b.then(function(t){var o=p.a.processBatchResponse(t);o.hasError?r(o):e(o)},function(e){r(e)})})}},r.prototype.getUserInfo=function(e){var t=this;return this.getData(function(){return t._getUrl(a.format("User(principalName='{0}')",u.UriEncoding.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(t){var o=r._parseUser(t);return o.email=e,o},"GetGraphUser",void 0,"GET",void 0,void 0,3)},r.prototype.deleteGroup=function(e){var r=this;return e?this.getData(function(){return r._getUrl(a.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):s.Promise.reject("Group parameter is null or undefined")},r.prototype.deleteSite=function(e){var r=this;return this.getData(function(){return r._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},r.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var r=JSON.parse(e);if(r&&r.d)return r.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},r.prototype.teamifyV2=function(e,r){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var r=JSON.parse(e);if(r&&r.d)return r.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(o){return r(o),o&&o.teamsId?t._pinToTeam(o,e):void 0})},r.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){s.Killswitch.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")||(e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0))})},r.prototype.getTeamifyBannerHidden=function(e){var r=this,t=function(){return r._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",r._pageContext.siteAbsoluteUrl)},o=function(e){var r=JSON.parse(e);return!(!r||!r.d)&&r.d.IsTeamifyPromptHidden};return s.Killswitch.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")?this.getData(t,o,"TeamifyBannerHidden",function(){return""},"Get"):this.getDataUtilizingPersistentCache({getUrl:t,qosName:"TeamifyBannerHidden",parseResponse:o,additionalPostData:"",method:"Get",cachingStrategy:e?3:0,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},r.prototype._getUrl=function(e,r){return this._pageContext.webAbsoluteUrl+"/_api/"+r+"/"+e},r.prototype._getCsomUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_vti_bin/client.svc/"+e},r.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+a.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"notebook")},r.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+a.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"documents")},r.prototype._addOwnerInformation=function(e,r,t){return this.getGroupOwnership(e,"100").then(function(e){var o=e.ownersList.members,i=t.membersList.members,n=[],a={};o.forEach(function(e){a[e.userId]=!0,e.principalName.toLowerCase()===r.toLowerCase()&&(t.isOwner=!0)});var u=0,p={};return i.forEach(function(e){a[e.userId]?(e.isOwnerOfCurrentGroup=!0,n.push(e),u++,p[e.userId]=!0):n.push(e),e.principalName===r&&(t.isMember=!0)}),u<o.length&&o.forEach(function(e){p[e.userId]||(e.isOwnerOfCurrentGroup=!0,n.push(e))}),t.membersList.members=n,t.totalNumberOfMembers<n.length&&(t.totalNumberOfMembers=n.length),t.totalNumberOfOwners=e.totalNumberOfOwners,s.Promise.resolve(t)})},r.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(c.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=a.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},r.prototype._calculateMissingMembershipProperties=function(e,r){var t=this;e.membersList.members.forEach(function(e){t._fixUserImages(e)})},r.prototype._calculateMissingOwnershipProperties=function(e){var r=this;e.ownersList.members.forEach(function(e){r._fixUserImages(e)})},r.prototype._calculateMissingGroupProperties=function(e,r){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&r&&(e.notebookUrl=this._getGroupStatusNotebookUrl(r)),!e.filesUrl&&r&&(e.filesUrl=this._getGroupStatusFilesUrl(r))},r.prototype._parseResponseForGetUserGroups=function(e){var r=this,t=JSON.parse(e);if(t.constructor===Array)return t[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var o=t.d.results.map(function(e){var t={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return r._calculateMissingGroupProperties(t,t.id),t}),i=o.filter(function(e){return e.isFavorite});return i.push.apply(i,o.filter(function(e){return!e.isFavorite})),i},r.prototype._pinToTeam=function(e,r){var t=this;return r=r.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return t._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(r){if(r){var t=JSON.parse(r);if(t&&t.d)return{pinToTeam:t.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(t._pageContext&&t._pageContext.navigationInfo&&t._pageContext.navigationInfo.quickLaunch){var o={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:r}}};return JSON.stringify(o)}},"POST",void 0,void 0,0)},r}(n.b);r.a=d},"6o44":function(e,r,t){"use strict";t.d(r,"a",function(){return a});var o=t("7KUI"),i=t("K9kD"),n=t("ynV5"),s=t("OpjN"),a=function(){function e(r,t,n,a){this._eventGroup=new i.EventGroup(this),this.source=s.a.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this.id=n,r?this.extend(r):this.load(),this.membership=new o.c(void 0,this._groupsProvider,this),!a&&t&&(a=t.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(a,n)}return e._getPlannerUrl=function(e,r){if(e)return r||(r=e.groupId),e.webAbsoluteUrl+n.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",r,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(r){var t=this;if(this._groupsProvider&&this.id){var o=i.Promise.resolve();return this.source===s.a.None&&(o=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(r){r&&r.lastLoadTimeStampFromServer>0&&(t.extend(r),t.source=s.a.Cache,t._eventGroup.raise(e.onSourceChange,t.source))})),o.then(function(){if(t._shouldLoadNewData(r))return t._startLoadingFromServer(),t._groupsProvider.loadGroupInfoContainerFromServer(t.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),t.extend(e),t._finishLoadingFromServer(),t._groupsProvider.saveGroupToCache(e)},function(e){t._errorLoading(e)})})}return i.Promise.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==s.a.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=s.a.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(r){this.isLoadingFromServer=!1,this.error=r,this._eventGroup.raise(e.onSourceChange,s.a.Error)},e.onSourceChange="source",e}();r.b=a},"7KUI":function(e,r,t){"use strict";t.d(r,"b",function(){return o}),t.d(r,"a",function(){return a});var o,i=t("tOru"),n=t("OpjN"),s=t("K9kD");!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(o||(o={}));var a=function(){function e(e,r,t){this._eventGroup=new s.EventGroup(this),this.source=n.a.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=r,this._parent=t,e&&this.extend(e,n.a.None),this.membersList||(this.membersList=new i.b)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,r){var t=this;if(void 0===e&&(e=!1),void 0===r&&(r=!1),this._groupsProvider&&this._parent.id){var i=0;e&&(i|=o.allMembers),r&&(i|=o.ownershipInformation);var a=s.Promise.resolve();return this.source!==n.a.None||i||(a=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,n.a.Cache)})),a.then(function(){if(t._shouldLoadNewData(i))return t._startLoadingFromServer(i),t._groupsProvider.loadMembershipContainerFromServer(t._parent.id,e,r).then(function(e){t.extend(e,n.a.Server),t._finishLoadingFromServer(),i||(e.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,e))},function(e){t._errorLoading(e)})})}return s.Promise.resolve()},e.prototype.loadWithOptions=function(e){var r=this;return this._groupsProvider&&this._parent.id&&(this.source!==n.a.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&r.extend(e.membership,n.a.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&o.allMembers)===o.allMembers,e&&(e&o.ownershipInformation)===o.ownershipInformation).then(function(t){r.extend(t,n.a.Server),r._finishLoadingFromServer(),e&&e!==o.forceSkipCache||(t.lastLoadTimeStampFromServer=r.lastLoadTimeStampFromServer,r._groupsProvider.saveMembershipToCache(r._parent.id,t))},function(e){r._errorLoading(e)})):s.Promise.resolve(void 0)},e.prototype.extend=function(r,t){this.isMember=r.isMember,this.isOwner=r.isOwner,this.isJoinPending=r.isJoinPending,this.membersList=r.membersList,this.totalNumberOfMembers=r.totalNumberOfMembers,this.totalNumberOfOwners=r.totalNumberOfOwners,this.lastLoadTimeStampFromServer=r.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=t,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==n.a.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&o.forceSkipCache)===o.forceSkipCache||e&&(e&o.allMembers)===o.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&o.allMembers)===o.allMembers)||e&&(e&o.ownershipInformation)===o.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&o.ownershipInformation)===o.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}();r.c=a},C21W:function(e,r,t){"use strict";t.d(r,"a",function(){return s});var o=t("K9kD"),i=t("m1i4"),n=t("y88i"),s=function(){function e(){}return e.getBatchOperationUrl=function(e,r){return new i.b({webAbsoluteUrl:!e&&r?new n.SimpleUri(r).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,r){var t={id:r};if((e=e.error?e.error:e)&&e.code){var o=e.code?e.code.split(","):e.error.code.split(","),i=Number(o[0]),n=e.message.value;t.error={code:i,message:n}}return{items:[t]}},e.getBatchResponseText=function(e){var r,t,o,i=[];if(e.split("\n").length>0&&(r=e.split("\n")[0]),r){t=(e=e.replace(r.trim()+"--","")).split(r);for(var n=1;n<t.length;n++)(o=t[n].split("\n\r")).length>2&&i.push(o[2])}return i},e.processBatchResponse=function(e,r,t){var o,i,n,s,a=[],u=!1;if(e.split("\n").length>0&&(o=e.split("\n")[0]),o){i=(e=e.replace(o.trim()+"--","")).split(o);for(var p=1;p<i.length;p++)if((n=i[p].split("\n\r")).length>2){try{s=JSON.parse(n[2])}catch(e){s=n[2]}var c=r&&r[p-1],m=c?{key:c.key,id:c.id,newId:t?t+"/"+c.name:null}:{};if((s=s.error?s.error:s)&&s.code){var h=s.code?s.code.split(","):s.error.code.split(","),l=Number(h[0]),d=s.message.value;m.error={code:l,message:d},u=!0}a.push(m)}}return{items:a,hasError:u}},e.getBatchContent=function(e,r,t,i){for(var n=[],s=0;s<r.length;s++){for(var a=r[s],u=o.Guid.generate(),p=[],c=0;c<a.length;c++){var m=a[c];p.push("--changeset_"+u),p.push("Content-Type: application/http"),p.push("Content-Transfer-Encoding: binary"),p.push(""),p.push(t+" "+m+" HTTP/1.1"),p.push(i),p.push("")}p.push("--changeset_"+u+"--");var h=p.join("\r\n");n.push("--batch_"+e),n.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"'),n.push("Content-Length: "+h.length),n.push("Content-Transfer-Encoding: binary"),n.push(""),n.push(h),n.push("")}return n.push("--batch_"+e+"--"),n.join("\r\n")},e.getBatchContentExtended=function(e,r,t,i,n,s,a){var u=o.Guid.generate(),p=[];n&&n.length!==r.length&&(n=null);for(var c=0;c<r.length;c++){var m=r[c];p.push("--changeset_"+u),p.push("Content-Type: application/http"),p.push("Content-Transfer-Encoding: binary"),p.push(""),a?p.push(a[c]+" "+m+" HTTP/1.1"):p.push(t+" "+m+" HTTP/1.1"),p.push(i),s&&p.push(s),n&&(p.push(""),p.push(n[c])),p.push("")}p.push("--changeset_"+u+"--");var h=p.join("\r\n");return(p=[]).push("--batch_"+e),p.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"'),p.push("Content-Length: "+h.length),p.push("Content-Transfer-Encoding: binary"),p.push(""),p.push(h),p.push(""),p.push("--batch_"+e+"--"),p.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();r.b=s},OpjN:function(e,r,t){"use strict";var o;t.d(r,"a",function(){return o}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(o||(o={}))},QVYh:function(e,r,t){var o=t("K9kD");e.exports=o.SPAlternativeUrls},kFKu:function(e,r,t){"use strict";t.r(r),t.d(r,"GroupsProvider",function(){return i.a}),t.d(r,"GroupType",function(){return o}),t.d(r,"MembersList",function(){return n.a}),t.d(r,"Group",function(){return s.a}),t.d(r,"MembershipLoadOptions",function(){return a.b}),t.d(r,"Membership",function(){return a.a}),t.d(r,"SourceType",function(){return u.a});var o,i=t("3Ilx");!function(e){e.public="Public",e.private="Private"}(o||(o={}));var n=t("tOru"),s=t("6o44"),a=t("7KUI"),u=t("OpjN")},m1i4:function(e,r,t){"use strict";t.d(r,"a",function(){return n}),t.d(r,"b",function(){return s});var o=t("17wl"),i=t("y88i"),n=function(){function e(e){var r=e.webAbsoluteUrl,t=e.encodeWebAbsoluteUrl,o=void 0===t||t;this._webAbsoluteUrl=r,this._encodeWebAbsoluteUrl=o,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,r=[];this._parameters.length&&r.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&")),r.push.apply(r,this._rawParameters),e=r.length?"?"+r.join("&"):"";var t=this._webUrl,i=void 0===t?this._webAbsoluteUrl:t;return""+Object(o.__spreadArrays)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments).join("/")+e},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,r){for(var t=this,o=[],i=0,n=Object.keys(r);i<n.length;i++){var s=n[i],a=r[s],u=t._autoParameter(a);t=u.apiUrl,o.push(s+"="+u.name)}return t.segment(e+"("+o.join(",")+")")},e.prototype.method=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o=this,i=[],n=0,s=r;n<s.length;n++){var a=s[n],u=o._autoParameter(a);o=u.apiUrl,i.push(u.name)}return o.segment(e+"("+i.join(",")+")")},e.prototype.parameter=function(e,r){return this._parameter(e,r)},e.prototype.parameters=function(e){for(var r=this,t=0,o=Object.keys(e);t<o.length;t++){var i=o[t],n=e[i];r=r.parameter(i,n)}return r},e.prototype.oDataParameter=function(e,r){return this.parameter(e,{raw:r})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var r=this._lastParameterId+1,t="@a"+r;return{name:t,apiUrl:this._extend({lastParameterId:r})._parameter(t,e)}},e.prototype._parameter=function(e,r){var t;return t=function(e){return!!e&&"object"==typeof e&&"json"in e}(r)?i.UriEncoding.encodeRestUriStringToken(JSON.stringify(r.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(r)?"guid'"+r.guid+"'":function(e){return!!e&&"object"==typeof e&&"raw"in e}(r)?r.raw:"number"==typeof r||"boolean"==typeof r?""+r:"'"+i.UriEncoding.encodeRestUriStringToken(r)+"'",this._extend({parameters:[{name:e,serializedValue:t}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var r,t,o,i,n,s;void 0===e&&(e={});var a=this.clone();return a._webUrl=this._webUrl,a._lastParameterId=this._lastParameterId,(r=a._parameters).push.apply(r,this._parameters),(t=a._segments).push.apply(t,this._segments),(o=a._rawParameters).push.apply(o,this._rawParameters),"webUrl"in e&&(a._webUrl=e.webUrl),"lastParameterId"in e&&(a._lastParameterId=e.lastParameterId),"parameters"in e&&(i=a._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(n=a._rawParameters).push.apply(n,e.rawParameters),"segments"in e&&(s=a._segments).push.apply(s,e.segments),a},e}(),s=function(){function e(e){this._apiUrlType=function(r){function t(){return r.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(o.__extends)(t,r),t}(n)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var r,t=e.indexOf("/_layouts/");if(t>-1)r=e.substring(0,t);else{var o=e.lastIndexOf("/"),i=e.lastIndexOf(".");r=i>o?e.substring(0,i)+"_"+e.substring(i+1):e}return r+"/_api/contextinfo"},e}()},tOru:function(e,r,t){"use strict";t.d(r,"a",function(){return o});var o=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var r=-1,t=0;t<this.members.length;t++)this.members[t].userId===e.userId&&(r=t);r>=0&&this.members.splice(r,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var r=e.toLowerCase(),t=0;t<this.members.length;t++)if(this.members[t].principalName&&this.members[t].principalName.toLowerCase()===r)return!0;return!1},e}();r.b=o}}]);