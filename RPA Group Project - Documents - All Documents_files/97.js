(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["97"],{"1585":function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("knockout-lib"),s=n(1382),o=n(183),u=n(1566),a=n(102),f=n(158),l=n(30),c=n(97),h=n(54),p=n(7),d=n(248),v=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._currentView=n.currentView;r._currentItem=n.currentItem;r._itemUrlHelper=n.itemUrlHelper;r._itemParentHelper=n.itemParentHelper;r._pageContext=n.pageContext;r._newDocumentTemplates=n.newDocumentTemplates;r.fields=r.observables.createArray([]);r.views=r.observables.createArray([]);r._deletedViewIds=[];return r}t.prototype.updateTemplates=function(e){var t=this,r=this._currentView.peek();if(!r.isDefault)for(var i=0,s=this.views.peek();i<s.length;i++){var o=s[i];if(o.isDefault){r=o;break}}var u,a=r.getDomParts().newDocumentTemplates;a&&(u=a.textContent);n.e("279").then(n.bind(null,1683)).then(d.e).then(function(n){try{t._saveTemplatesToView(JSON.parse(u),e,n)}catch(r){t._saveTemplatesToView(n.getTemplates(),e,n)}})};t.prototype.getView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.getView(e,t._getListUrl())}).then(function(e){t.registerView(e);return e})};t.prototype.getFields=function(e){var t=this;return e?this._getListDataSourceExtension().then(function(e){return e.getFields(t._getListUrl()).then(function(e){t.fields(e);return e})}):h.n.wrap(this.fields.peek())};t.prototype.getCurrentListUrl=function(e){var t=e?this._currentItem():this._currentItem.peek(),n=t&&this._itemUrlHelper.getItemUrlParts(t.key);return n&&n.fullListUrl};t.prototype.registerView=function(e){if(-1===this._deletedViewIds.indexOf(e.id)){for(var t=this.views.peek(),n=!1,r=0;r<t.length;r++){var i=t[r];if(e===i){n=!0;break}if(i.id===e.id){t.splice(r,1);break}}n||this._insertViewSorted(e)}};t.prototype.getViews=function(e,t){var n=this;if(e){var r=this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem.peek(),"list"),s=this.peekUnwrapObservable(r),o=s&&s.list.templateType,u=t||this._getListUrl();return this._getListDataSource().then(function(e){return e.getViews(u,o)}).then(function(e){var t=n._currentView.peek();if(t){var r=i.utils.arrayFirst(e,function(e){return e.id===t.id});if(r){t.title=r.title;t.isDefault=r.isDefault;t.isDirty()||(t.baseViewXml=r.baseViewXml);n._currentView.valueHasMutated();i.utils.arrayRemoveItem(e,r);e.push(t)}}e.sort(function(e,t){return e.compareTo(t)});n.views(e);return e})}return h.n.wrap(this.views.peek())};t.prototype.createView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.createView(e,t._getListUrl())}).then(function(e){t._insertViewSorted(e);return e})};t.prototype.saveView=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.saveView(e,n._getListUrl(),t)})};t.prototype.deleteView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.deleteView(e,t._getListUrl())}).then(function(){t._deletedViewIds.push(e);t.views.remove(function(t){return t.id===e})})};t.prototype.modifyView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.modifyView(e,t._getListUrl())}).then(function(){for(var n,r,i=t.views.peek(),s=0;s<i.length;s++)if(i[s].id===e.id){n=i[s];r=s;break}if(n){var o=!1;if("boolean"==typeof e.isDefault){if(e.isDefault)for(var u=0,a=i;u<a.length;u++){var f=a[u];if(f.isDefault){f.isDefault=!1;break}}n.isDefault=e.isDefault;o=!0}if("number"==typeof e.scope&&n.scope!==e.scope){n.scope=e.scope;o=!0}if("string"==typeof e.title&&n.title!==e.title){n.title=e.title;i.splice(r,1);t._insertViewSorted(n);o=!1}o&&t.views.valueHasMutated()}})};t.prototype.createMappedView=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.createMappedView(e,t,n._getListUrl())}).then(function(e){n._insertViewSorted(e);return e})};t.prototype.getMappedApp=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.getMappedApp(e,t,n._getListUrl())})};t.prototype.getMappedApps=function(e){var t=this;return this._getListDataSource().then(function(n){return n.getMappedApps(e,t._getListUrl())})};t.prototype.publishMappedView=function(e,t,n){var r=this;return this._getListDataSource().then(function(e){return e.publishMappedView(t,n,r._getListUrl())}).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};t.prototype.unpublishMappedView=function(e,t,n){var r=this;return this._getListDataSource().then(function(e){return e.unpublishMappedView(t,n,r._getListUrl())}).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};t.prototype.createField=function(e,t,n,r,i){var s=this,o=this._getFieldCreationSchema(e,t,r);return this._getListDataSourceExtension().then(function(e){return e.createField(o,n||s._getListUrl(),i)})};t.prototype.modifyFieldProperties=function(e){var t=this;return this._getListDataSource().then(function(n){return n.modifyFieldProperties(e,t._getListUrl())})};t.prototype.getFieldPropertyAsString=function(e,t){var n=this;return this._getListDataSourceExtension().then(function(r){return r.getField(e,n._getListUrl()).then(function(e){return e[t]})})};t.prototype.setContentApproval=function(e){var t=this;return this._getListDataSource().then(function(n){return n.setContentApproval(e,t._getListUrl())})};t.prototype.ensureSignoffStatusField=function(){var e=this;return this._getListDataSource().then(function(t){return t.ensureSignoffStatusField(e._getListUrl())})};t.prototype.setFieldPropertyValueAsString=function(e,t,n){var r=this;return this._getListDataSourceExtension().then(function(i){return i.setFieldPropertyValueAsString(e,t,n,r._getListUrl())})};t.prototype._getListUrl=function(){var e=this.getCurrentListUrl();if(!e)throw new Error("List URL is not known");return e};t.prototype._insertViewSorted=function(e){for(var t=this.views.peek(),n=!1,r=0;r<t.length;r++)if(e.compareTo(t[r])<1){this.views.splice(r,0,e);n=!0;break}n||this.views.push(e)};t.prototype._getListDataSourceExtension=function(){var e=this,t=h.n.resolve(n.e("45").then(n.bind(null,1618))).then(function(t){var n=t.ListDataSource;return new(e.managed(n))(e._pageContext)});this._getListDataSourceExtension=function(){return t};return t};t.prototype._getFieldCreationSchema=function(e,t,n){var r={Type:t,DisplayName:e,Title:e};n&&(r.StaticName=n);if(t===a.t.User||t===a.t.UserMulti){r.UserSelectionMode="1";r.UserSelectionScope=0}else t===a.t.DateTime&&(r.Format="DateOnly");t===a.t.UserMulti&&(r.Mult=!0);return r};t.prototype._saveTemplatesToView=function(e,t,n){for(var r=this,i=n.getDefaultContentTypeId(),s=n.getDefaultView(this.views.peek()),o=0,u=t;o<u.length;o++){var a=u[o].peek(),f=a.id,l=a.displayName.replace(/\.[^.]+$/,"");e.push({isUpload:!0,visible:!0,title:l,url:f,contentTypeId:i,templateId:l})}s.updateNewDocumentTemplates(n.prepareJsonForSaving(e));this.saveView({sourceView:s,updateViewXml:!0,viewParams:{}},!0).then(function(){r._newDocumentTemplates.valueHasMutated()})};t.prototype._getListDataSource=function(){return this.resources.consumeAsync(c.F)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{pageContext:l.h,currentView:f.l,currentItem:f.o,itemUrlHelper:o.r,itemParentHelper:u.e,newDocumentTemplates:l.l.optional});return t})(s.default),m=Object(p.s)("ListProvider",v)},"1620":function(e,t,n){"use strict";var r=n(0),i=n(1563),s=n(177),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._platform=n.resources.consume(s.e.optional);n._isPermanent="object"==typeof i&&i.isPermanent||!1;n._isReentrant="object"==typeof i&&i.isReentrant||!1;document.activeElement===n.element&&n._select();var o=Object(r.__assign)({focus:n._onFocus,focusin:n._onFocus,mouseup:n._onMouseUp},n._isReentrant?{focusout:n._onFocusOut}:{});n.events.onAll(n.element,o);return n}t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}this._hasSelected=!0;return!0}return!1};t.prototype._onFocus=function(e){this._select();return!0};t.prototype._onFocusOut=function(){this._hasSelected=!1;return!0};t.prototype._onMouseUp=function(e){if(this._select())return!1};return t})(i.t);t.e=o},"1705":function(e,t,n){"use strict";var r=n(150);Object(r.n)([{rawString:".od-Prompt-input{width:100%;display:block}.od-Prompt-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-Prompt-status--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Prompt-input--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"!important}"}]);var i=n(0),s=n(1551),o=n(1620),u=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.state;n.text=r.text;n.isEnabled=r.isEnabled;n.explanation=r.explanation;n.status=r.status;n.checkbox=r.checkbox;n.hasFocus=n.createPureComputed(function(){return n.isEnabled()});n.inputFocused=n.createObservable(!1);n.subscribe(n.status,function(e){e.isError&&n.async.setTimeout(function(){return n.isEnabled(!0)},100);n._shouldClearError=e.isError});n.subscribe(n.text,function(){if(n._shouldClearError){n._shouldClearError=!1;n.status.peek().isError&&r.clearStatus()}});n.addBindingHandlers({selectOnFocus:o.e});return n}return t})(s.t),a=n(1552).e({tagName:"ms-prompt",template:'<div class="od-Prompt"><div class="od-TextField"><label class="od-Label" for="Prompt-input" data-bind="text:explanation"></label><span class="od-Prompt-input"><input class="od-TextField-field" id="Prompt-input" type="text" maxlength="255" data-bind="textInput:text,enable:isEnabled,hasFocus:hasFocus,selectOnFocus,css:{\'od-Prompt-input--error\':status().isError},automation:\'Prompt-input\'"></span></div><div class="od-Prompt-status" aria-live="assertive" role="status" data-bind="text:status().message,css:{\'od-Prompt-status--error\':status().isError}"></div>\x3c!--ko if:checkbox--\x3e<div class="od-CheckBox" data-bind="with:checkbox"><label class="od-CheckBox-field" data-bind="css:{\'is-checked\':isChecked,\'is-disabled\':!isEnabled(),\'in-focus\':$parent.inputFocused()}"><input class="od-CheckBox-input" type="checkbox" data-bind="checked:isChecked,enable:isEnabled,hasFocus:$parent.inputFocused"><span class="od-Label" data-bind="text:label"></span></label></div>\x3c!--/ko--\x3e</div>',viewModel:u,synchronous:!0});t.e=a},"1774":function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(e){void 0===e&&(e={});var t=e.text,n=void 0===t?r.observable(""):t,i=e.explanation,s=void 0===i?"":i,o=e.status,u=void 0===o?r.observable({message:"",isError:!1}):o,a=e.checkbox;this.text=n;this.explanation=s;this.status=u;this.checkbox=a;this.isEnabled=r.observable(!0)}e.prototype.setWaitingStatus=function(e){this.status({message:e,isError:!1});this.isEnabled(!1)};e.prototype.setErrorStatus=function(e){this.status({message:e,isError:!0})};e.prototype.clearStatus=function(){this.status({message:"",isError:!1})};return e})();t.e=i},"1781":function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(6),s=n(1673),o=n(668),u=n(1),a=n(83),f=n(189),l=n(9),c=n(175),h=n(1239),p=n(123),d=(new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e},create:function(e){var t=e.itemCacheStore;return{instance:function(e){var n=void 0;e&&(n=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(u.wt,e)})));return n}}}}}),new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e,itemsScopeCurrentItemKey:s.e},create:function(e){var t=e.itemCacheStore,n=e.itemsScopeCurrentItemKey;return{instance:function(){var e=n.peek(),r=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(a.e,e)}));return r&&r.viewKey&&f.e.serialize(r.viewKey)}}}}})),v=new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e},create:function(e){var t=e.itemCacheStore;return{instance:function(e){var n=void 0;e&&(n=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(u.v,e)})));return n}}}}}),m=new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e,itemsScopeCurrentItemKey:s.e,getItemsScopeCurrentViewKey:d,getItemsScopeCurrentDerivedView:v},create:function(e){var t=e.itemCacheStore,n=e.itemsScopeCurrentItemKey,i=e.getItemsScopeCurrentViewKey,s=e.getItemsScopeCurrentDerivedView;return{instance:function(e){var o,a,f=i(),p=s(f);if(p){p=e(p);t.dispatch(Object(c.e)({items:(o={},o[f]=Object(r.__assign)({},u.v.pack(p)),o)}));t.dispatch(Object(h.e)({items:(a={},a[n.peek()]=[l.e],a[f]=[u.v],a)}))}}}}}})},"1792":function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(1939),i=n(1705),s=n(957),o=n(1806),u=n(1807),a=n(1585),f=n(1568),l=n(1383),c=n(158),h=n(30),p=n(54),d=n(1561),v=n(31),m=n(6),g=n(7),y=n(8),b=(function(){function e(e,t){this._currentView=t.currentView;this._viewParams=t.viewParams;this._dialogProvider=t.dialogProvider;this._listProvider=t.listProvider;this._listContext=t.listContext;this._currentItem=t.currentItem;this._itemProvider=t.itemProvider;this._isColumnTakenKSActive=y.e.isActivated("5FA9698E-E9BA-45B3-8390-B4901FFD9196","3/10/21","Check internalName")}e.prototype.showDialog=function(e){e.listFields&&this._listProvider.getFields(!0).then(function(t){e.listFields(t)});return this._dialogProvider.requestDialog({title:e.title,component:{name:i.e.tagName,params:{state:e.promptState}},actions:[{name:e.confirmButtonText||r.e.columnNameSave,execute:e.onConfirmClick,isDefault:!0,isAvailable:e.promptState.isEnabled,icon:new d.e("Save"),automationId:"ColumnPropertyOK"},{name:r.e.columnNameCancel,execute:function(){return p.n.wrap(3)},isAvailable:e.promptState.isEnabled,icon:new d.e("Cancel"),automationId:"ColumnPropertyCancel"}]}).wait().then(function(){return{resultType:v.e.Success}})};e.prototype.isColumnNameTaken=function(e,t){if(!t)return!1;e=e.toLocaleLowerCase();if(!this._isColumnTakenKSActive){return t.filter(function(e){return!e.isHidden&&"LinkTitle"!==e.internalName&&"LinkTitleNoMenu"!==e.internalName}).some(function(t){return e===t.title.toLocaleLowerCase()})}return t.some(function(t){return e===t.title.toLocaleLowerCase()})};e.prototype.isColumnStaticNameTaken=function(e,t){if(!t)return!1;e=e.toLocaleLowerCase();return t.some(function(t){return t.staticName&&e===t.staticName.toLocaleLowerCase()})};e.prototype.getAddToViewAction=function(e,t){var n;if(this.hasViewBeenModified())n={action:o.ModifyColumnAction,params:{action:1,fieldToActOn:e,fieldToAddAfter:t}};else{var r=this._currentView.peek(),i=r.getEffectiveFieldNames(),s=void 0;t&&(s=i.indexOf(t)+1);s=s||i.length;r.updateField(e,s);n={action:u.default,params:{skipDialog:!0}}}return n};e.prototype.getRemoveFromViewAction=function(e){var t;if(this.hasViewBeenModified())t={action:o.ModifyColumnAction,params:{action:0,fieldToActOn:e}};else{this._currentView.peek().updateField(e);t={action:u.default,params:{skipDialog:!0}}}return t};e.prototype.getAddOrRemoveFromViewAction=function(e,t,n){var r;if(this.hasViewBeenModified())r={action:o.ModifyColumnAction,params:{action:2,fieldToAddAfter:e,addFields:t,removeFields:n}};else{var i=this._currentView.peek(),s=i.getEffectiveFieldNames(),a=void 0;e&&(a=s.indexOf(e)+1);a=a||s.length;if(t)for(var f=0,l=t;f<l.length;f++){var c=l[f];i.updateField(c,a);a++}if(n)for(var h=0,p=n;h<p.length;h++){c=p[h];i.updateField(c)}r={action:u.default,params:{skipDialog:!0}}}return r};e.prototype.invalidateSchema=function(){this._listContext.listSchema=null;this._listContext.rawListSchema=null;this._listContext.needContentTypes=!0;this._itemProvider.invalidateItem(this._currentItem.peek().key,{triggerFetch:!0,emptyAllOtherSets:!0,refreshSchema:!0});this.invalidateInfoPaneCache()};e.prototype.invalidateInfoPaneCache=function(){this._listContext.refreshClientForm=!0};e.prototype.hasViewBeenModified=function(){if(this._currentView.peek().isDirty())return!0;var e=this._viewParams.peek();return Object.keys(e).some(function(e){return s.t.test(e)||s.e.test(e)})};e.prototype.getCurrentViewFields=function(){return this._currentView.peek().getEffectiveFieldNames()};e.dependencies={currentView:c.l,viewParams:c.j,dialogProvider:f.e,listProvider:a.e,listContext:h.o,currentItem:c.o,itemProvider:l.resourceKey};return e})(),w=new m.t({name:"ColumnActionsHelper",factory:new g.n(b)})},"1806":function(e,t,n){"use strict";n.r(t);n.d(t,"ModifyColumnAction",function(){return E});var r=n(0),i=n(1557),s=n(54),o=n(31),u=n(158),a=n(30),f=n(128),l=n(132),c=n(1781),h=n(83),p=n(189),d=n(1177),v=n(1842),m=n(123),g=n(668),y=n(1673),b=n(939),w=n(89),E=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ModifyColumn";n._action=t.action;n._fieldToActOn=t.fieldToActOn;n._addFields=t.addFields;n._removeFields=t.removeFields;n._fieldToAddAfter=t.fieldToAddAfter;n._listContext=n.resources.consume(a.o);n._currentView=n.resources.consume(u.l);n._dataManager=n.resources.consume(f.t.optional);n._isItemsScopeEnabled=n.resources.consume(b.h.lazy);return n}t.prototype.onExecute=function(e,t){var n=this;switch(this._action){case 1:this._unhideColumn();break;case 0:this._hideColumn();break;case 2:this._hideUnhideColumns();break;case 3:case 4:this._moveField()}this._isItemsScopeEnabled()&&this.resources.consumeAsync(c.e).then(function(e){e(function(e){var t=n._currentView.peek().getEffectiveFieldNames();e.replaceFields(t);return e})});Object(l.isFeatureEnabled)(l.ColumnFieldsAutoSave)&&this._isItemsScopeEnabled()&&this.resources.load({itemCacheStore:g.e,itemsScopetemKey:y.e}).then(function(){var e,t,r=n.resources.consume(g.e),i=n.resources.consume(y.e),s=r.dispatch(Object(m.e)(function(e){var t=e.demandItemFacet(h.e,i.peek());return{setKey:t,viewKey:t&&t.viewKey&&p.e.serialize(t.viewKey)}}));s.setKey&&s.viewKey&&r.dispatch(Object(v.e)({items:(e={},e[d.e.serialize(s.setKey)]={views:(t={},t[s.viewKey]={shouldSaveViewFieldsOnly:!0},t),qosName:"autoSaveAddDelete"},e)})).catch(function(e){w.e.logError(e,{eventName:"AddDeleteAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e&&e.errorData&&e.errorData.code,correlationId:e&&e.errorData&&e.errorData.correlationId,status:e&&e.errorData&&e.errorData.status});throw e})});return s.n.wrap({resultType:o.e.Success})};t.prototype.onIsAvailable=function(){var e=this._currentView();if(!e||!e.baseViewXml)return!1;if(3===this._action||4===this._action){var t=e.getEffectiveFieldNames();if(t&&t.length){var n=t.indexOf(this._fieldToActOn),r=this._listContext.isGrouped?1:0;return 3===this._action?n>r+1:n>=r&&n<t.length-1}return!1}return!0};t.prototype._moveField=function(){var e,t=this._currentView.peek(),n=t.getEffectiveFieldNames().indexOf(this._fieldToActOn);e=3===this._action?n-1:n+1;t.updateField(this._fieldToActOn,e);this._currentView.valueHasMutated()};t.prototype._hideColumn=function(){this._currentView.peek().updateField(this._fieldToActOn);this._currentView.valueHasMutated()};t.prototype._unhideColumn=function(){var e=this._currentView.peek(),t=e.getEffectiveFieldNames(),n=t.indexOf(this._fieldToAddAfter);-1===n?e.updateField(this._fieldToActOn,t.length):e.updateField(this._fieldToActOn,n+1);this._currentView.valueHasMutated()};t.prototype._hideUnhideColumns=function(){if(this._addFields)for(var e=0,t=this._addFields;e<t.length;e++){var n=t[e];this._fieldToActOn=n;this._unhideColumn();this._fieldToAddAfter=this._fieldToActOn}if(this._removeFields)for(var r=0,i=this._removeFields;r<i.length;r++){n=i[r];this._fieldToActOn=n;this._hideColumn()}};return t})(i.e);t.default=E},"1807":function(e,t,n){"use strict";n.r(t);n.d(t,"SaveViewAction",function(){return E});var r=n(0),i=n(1557),s=n(1559),o=n(1705),u=n(1774),a=n(33),f=n(1568),l=n(1383),c=n(1585),h=n(158),p=n(30),d=n(1561),v=n(20),m=n(54),g=n(31),y=n(956),b=n(939),w=n(947),E=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="SaveView";n._skipDialog=t.skipDialog;n._viewParams=n.resources.consume(h.j);n._currentView=n.resources.consume(h.l);n._currentItem=n.resources.consume(h.o);n._dialogProvider=n.resources.consume(f.e);n._itemProvider=n.resources.consume(l.resourceKey);n._listProvider=n.resources.consume(c.e);n._listContext=n.resources.consume(p.o);n._isItemsScopeEnabled=n.resources.consume(b.h.lazy);return n}t.prototype.onExecute=function(e,t){var n=this;delete this._result;delete this._switchTo;var r,i,a=this._currentView.peek();if(!a)return m.n.wrap({resultType:g.e.Failure});if(this._skipDialog){r=this._doSaveView(a.title,!1);i={resultType:g.e.Failure}}else{this._viewsPromise=this._listProvider.getViews(!0);var f,l,c=this.observables.create(!1);if(this._listContext.permissions&&this._listContext.permissions.manageLists){f=this.observables.create(a.title||"");l=this.observables.create(!a.isPersonal);this.subscribe(f,function(e){if(e===a.title){c(!1);l(!a.isPersonal)}else c(!0)})}else{l=this.observables.create(!1);f=this.observables.create(a.isPersonal&&a.title||"")}a.isReadOnly&&f("");this._promptState=new u.e({text:f,explanation:s.e.SaveViewExplanation,checkbox:{label:s.e.SaveViewMakePublic,isChecked:l,isEnabled:c}});r=this._dialogProvider.requestDialog({title:s.e.SaveAs,component:{name:o.e.tagName,params:{state:this._promptState}},actions:[{name:s.e.SaveViewCommit,execute:this._saveViewFromDialog.bind(this),isDefault:!0,isAvailable:this.createPureComputed(function(){return n._promptState.isEnabled()&&!!f()}),icon:new d.e("Save"),automationId:"saveViewDialogCommit"},{name:s.e.cancelActionText,execute:function(){return m.n.wrap(3)},isAvailable:this._promptState.isEnabled,icon:new d.e("Cancel"),automationId:"saveViewDialogCancel"}]}).wait();i={resultType:g.e.ExpectedFailure}}return r.then(function(){var t=n._result||i;if(t.resultType===g.e.Success){n._itemProvider.invalidateItem(n._currentItem.peek().key,{triggerFetch:!1,emptyAllOtherSets:!0});var r=n.resources.consume(h.e),s=function(){n._listContext.listSchema=null;n._listContext.needContentTypes=!0;n._itemProvider.invalidateItem(n._currentItem.peek().key,{triggerFetch:!0,emptyAllOtherSets:!0,refreshSchema:!0});n._isItemsScopeEnabled()&&n.resources.consumeAsync(y.e).then(function(e){e.invalidateCurrentItemSet();e.invalidateCurrentView();e.invalidateListContentTypes()});return t};return new(n.managed(r.SwitchViewAction))({newView:n._switchTo}).execute(e).then(s,s)}return t})};t.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this._currentView(),n=this._listContext&&this._listContext.permissions,r=this._viewParams();return t&&!Object(w.t)(t.viewType)&&e&&e.queryType===a.e.Files&&n&&(n.managePersonalViews||n.manageLists)&&!r.needsAttentionView};t.prototype._saveViewFromDialog=function(){var e=this,t=this._promptState.text.peek(),n=t!==this._currentView.peek().title;if(n){t=t.trim();this._promptState.text(t);if(!t){this._promptState.setErrorStatus(s.e.SaveViewErrorNoName);return m.n.wrap(1)}}this._promptState.isEnabled(!1);return this._isViewNameValid(t,n).then(function(r){if(r)return e._doSaveView(t,n);e._promptState.setErrorStatus(v.format(s.e.SaveViewErrorCannotOverwrite,t));return m.n.wrap(1)})};t.prototype._isViewNameValid=function(e,t){var n=this,r=this._currentView.peek();return t?new m.n(function(t){n._viewsPromise.done(function(n){t(!n.some(function(t){return t.title===e}))},function(){t(!0)})}):e!==r.title||r.canUserEdit(this._listContext&&this._listContext.permissions)&&!r.isReadOnly?m.n.wrap(!0):m.n.wrap(!1)};t.prototype._doSaveView=function(e,t){var n=this,r=this._currentView.peek(),i=this._viewParams.peek();if(t){var s={title:e,viewParams:i,sourceView:r,isPublic:this._promptState?this._promptState.checkbox.isChecked.peek():!r.isPersonal};return this._listProvider.createView(s).then(function(e){return n._onComplete(e)},function(e){return n._onError("CreatingView",e)})}s={sourceView:r,viewParams:i,updateViewXml:!0};return this._listProvider.saveView(s).then(function(){return n._onComplete(r)},function(e){return n._onError("SavingView",e)})};t.prototype._onComplete=function(e){this._switchTo=e;this._result={resultType:g.e.Success};return 2};t.prototype._onError=function(e,t){this._promptState&&this._promptState.setErrorStatus(s.e.SaveViewError);this._result={resultType:g.e.Failure,resultCode:e,error:t};return 1};return t})(i.e);t.default=E},"1963":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"i",function(){return f});var r,i,s;(function(e){e[e.NONE=0]="NONE";e[e.ASC=1]="ASC";e[e.DESC=2]="DESC"})(r||(r={}));(function(e){e.id="id";e.reorderable="reorderable"})(i||(i={}));(function(e){e.notStarted="notStarted";e.inProgress="inProgress";e.failed="failed";e.success="success"})(s||(s={}));var o={name:{fieldRefName:"Name",valueType:"TEXT"},parent:{fieldRefName:"Parent",valueType:"TEXT"},group:{fieldRefName:"Group",valueType:"TEXT"},lastPublished:{fieldRefName:"LastPublished",valueType:"TEXT"},source:{fieldRefName:"Source",valueType:"TEXT"}},u="DO_NOT_DELETE_SPLIST_TENANTADMIN_AGGREGATED_CONTENTTYPES",a="DO_NOT_DELETE_SPLIST_SITECOLLECTION_AGGREGATED_CONTENTTYPES",f=[{id:"0x010400691950A997E07447B9CB06D610150755",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt1",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}},{id:"0x010400691950A997E07447B9CB06D610150866",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt2",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}},{id:"0x010400691950A997E07447B9CB06D610150977",description:"",eTag:'"0"',group:"Custom Content Types",hidden:!1,name:"TestCt3",parentId:"0x0104",readOnly:!1,sealed:!1,parentReference:{id:"0x0104",name:"Announcement"}}]},"2138":function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("retryProgressItemsOperation"),o=Object(i.i)({operationTypeFacet:s})},"2453":function(e,t,n){"use strict";var r,i,s,o,u,a=n(0),f=n(73),l=n(1629),c=n(515),h=n(1635),p=n(1963),d=n(594),v=n(2395),m=(function(){function e(e){this._children=e}e.prototype.generateCamlQueryString=function(){var e=this._children.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Where>"+e+"</Where>":""};return e})(),g=(function(){function e(e,t){this._fieldName=e;this._fieldValue=t}e.prototype.generateCamlQueryString=function(){var e=d.e.encodeText(p.n[this._fieldName].fieldRefName),t=d.e.encodeText(this._fieldValue),n=d.e.encodeText(p.n[this._fieldName].valueType);return t?"<Eq><FieldRef Name='"+e+"'/><Value Type='"+n+"'>"+t+"</Value></Eq>":"<IsNull><FieldRef Name='"+e+"'/></IsNull>"};return e})(),y=(function(){function e(e,t){this._filterFieldValueCamlQueries=[];for(var n=0,r=t;n<r.length;n++){var i=r[n];this._filterFieldValueCamlQueries.push(new g(e,i))}}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterFieldValueCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<Or>"+e+r+"</Or>":r}return e};return e})(),b=(function(){function e(e){var t=this,n=e||new Map;this._filterByFieldCamlQueries=[];n.forEach(function(e,n){0!==e.length&&t._filterByFieldCamlQueries.push(new y(n,e))})}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterByFieldCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<And>"+e+r+"</And>":r}return e};return e})(),w=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){if(0===this._condition.direction)throw new Error("OrderBy query direction is set to NONE which is unexpected!");var e=2===this._condition.direction;return"<OrderBy><FieldRef Name='"+d.e.encodeText(p.n[this._condition.field].fieldRefName)+"' Ascending='"+!e+"' /></OrderBy>"};return e})(),E=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){return"<GroupBy><FieldRef Name='"+d.e.encodeText(p.n[this._condition.field].fieldRefName)+"' /></GroupBy>"};return e})(),S=(function(){function e(e){e=e||{};this._queryCamlQueryElements=[];var t=[];t.push(new b(e.filterBys));this._queryCamlQueryElements.push(new m(t));e.orderBy&&this._queryCamlQueryElements.push(new w(e.orderBy));e.groupBy&&this._queryCamlQueryElements.push(new E(e.groupBy))}e.prototype.generateCamlQueryString=function(){var e=this._queryCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Query>"+e+"</Query>":""};return e})(),x=(function(){function e(e){this._fieldRefName=e}e.prototype.generateCamlQueryString=function(){return'<FieldRef Name="'+this._fieldRefName+'"/>'};return e})(),T=(function(){function e(e){this._contentTypeCamlQueryElements=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this._contentTypeCamlQueryElements.push(new x(r))}}e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<ViewFields>"+e+"</ViewFields>":""};return e})(),N=(function(){function e(e,t){this._contentTypeCamlQueryElements=[];e&&this._contentTypeCamlQueryElements.push(new S(e));t&&this._contentTypeCamlQueryElements.push(new T(t))}e.parseCamlQueryString=function(e){var t=v.n(e),n={};if(t.filters){n.filterBys=new Map;for(var r=0,i=t.filters;r<i.length;r++){var s=i[r];if(this._instanceOfIFilter(s)){var o=this._getColumnKeyFromFieldRefName(s.fieldName);o&&(n.filterBys[o]=s.values)}}}if(t.sorts){var u=this._getColumnKeyFromFieldRefName(t.sorts[0].fieldName);u&&(n.orderBy={field:u,direction:t.sorts[0].isAscending?1:2})}if(t.groupBy){var a=this._getColumnKeyFromFieldRefName(t.groupBy.group1.fieldName);a&&(n.groupBy={field:a})}return n};e._instanceOfIFilter=function(e){return"fieldName"in e};e._getColumnKeyFromFieldRefName=function(e){for(var t in p.n)if(p.n[t].fieldRefName===e)return t};e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<View>"+e+"</View>":""};return e})(),C=n(20),k=n(54),L=function(e,t,n){var r="--"+e+"\r\n";r+="Content-ID: "+t+"\r\n";return r+="Content-Type: "+n+"\r\n\r\n"},A=function(e,t,n){var r="--"+e+"\r\n";r+="Content-Type: "+t+"\r\n";return r+="Content-Transfer-Encoding: "+n+"\r\n\r\n"},O=function(e,t,n,r,i){var s=n+" "+r+" HTTP/1.1\r\n";s+="Content-Type: "+e+"\r\n";s+="Accept: "+t+"\r\n";return s+="Content-Length: "+i+"\r\n\r\n"},M=n(71);(function(e){e.JSON="application/json";e.octetStream="application/octet-stream";e.multipartBoundary="multipart/related; boundary=";e.HTTP="application/http";e.multipartMixedBoundary="multipart/mixed; boundary="})(r||(r={}));(function(e){e.metadata="metadata";e.content="content"})(i||(i={}));(function(e){e.binary="binary"})(s||(s={}));(function(e){e.GET="GET";e.POST="POST"})(o||(o={}));(function(e){e.JSON="application/json"})(u||(u={}));var _=(function(e){Object(a.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"ContentTypeDataSource"},{pageContext:t})||this;r.siteUrlTemplate="{0}/_api/v2.1/sites/{1},{2}";r.listUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}";r.updateListUrlTemplate="{0}/_api/web/lists(guid'{1}')";r.contentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes";r.urlTemplateForSharedPackages="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/items?$expand=fields&$top=500";r.listContentTypeDetailedUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes";r.contentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns";r.contentTypeColumnsAddUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns/add";r.sharedPackageListTemplate="{0}/_api/web/GetList(@listUrl)?@listUrl='/sites/contenttypehub/lists/PackageList'";r.sharedPackageUrlTemplate="{0}/_api/web/GetList(@listUrl)/items?@listUrl='/sites/contenttypehub/lists/PackageList'";r.sharedPackageByTitleUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/Shared Packages/items?expand=fields";r.availableContentTypesForListUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/oneDrive.getApplicableContentTypesForList(listId='{3}')";r.siteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/columns";r.ancestorSiteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}?expand=externalColumns";r.currencyListUrlTemplate="{0}/_api/SP.CurrencyList.GetList";r.regionalDateTimeUrlTemplate="{0}/_api/web/GetRegionalDateTimeSchema";r.siteListsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists?$select=system,id,name,displayName,list";r.listFieldsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/columns";r.createContentTypeViewUrl="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/views";r.listContentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes/{4}/columns";r.publishContentTypeUrlTemplate="{0}/_api/v2.1//sites/{1}/contentTypes/{2}/oneDrive.publish";r.unpublishContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/oneDrive.unpublish";r.updateContentTypeColumnUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns/{4}";r.contentTypesPublishedFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/contentTypes/getCompatibleHubContentTypes";r.siteContentTypesPublishedFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/getCompatibleHubContentTypes";r.updateContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}";r.contentTypeListViewUrl="/_api/web/lists/GetByTitle('{0}')";r.createListUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists";r.batchUrlTemplate="{0}/_api/v2.1/$batch";r.addContentTypeToListBatchUrlTemplate="sites/{0},{1}/lists/{2}/contentTypes/addCopyFromContentTypeHub";r.addContentTypeToSiteFromHubUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/addCopyFromContentTypeHub";r.contentTypeOperationsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/operations";r.fetchCustomCTProperty="$filter=custom ne null";r.filterByReorderable="$filter=reorderable eq true";r.selectDocTemplateProperty="$select=documentTemplate";r.reorderColumns="$select=columnOrder";r.getContentTypeColumnsHiddenParam="$select=*,hidden";r.getContentTypeAncestorsParam="$expand=ancestors";r.getContentTypeEnforcemenetParam="$select=*,enforcement";r.contentTypeExpandColumnsParam="$expand=columns";r.getToken=function(e){var t=Object(f.r)(r._pageContext);return r._getOAuthToken?r._getOAuthToken(e):r._tokenProvider.getToken(t)};r._tokenProvider=new l.e(null,{oAuthTokenDataSource:new h.e(t)});r._getOAuthToken=n;return r}t.prototype.getSiteInfo=function(e,t){return this.dataRequestor.getData({url:encodeURI(C.format(this.siteUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetSiteInfo",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.pullContentTypeFromHub=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(C.format(r.addContentTypeToSiteFromHubUrlTemplate,Object(f.r)(r._pageContext),e,t)),qosName:"PullContentTypeFromHub",method:"POST",authToken:i,contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({contentTypeId:n}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.getContentTypesPublishedFromHub=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetPublishedContentTypeFromHub",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getSiteContentTypesPublishedFromHub=function(e,t){return this.dataRequestor.getData({url:encodeURI(C.format(this.siteContentTypesPublishedFromHubUrlTemplate+"?"+this.contentTypeExpandColumnsParam,Object(f.r)(this._pageContext),e,t)),qosName:"GetSitePublishedContentTypeFromHub",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getMockContentTypesPublishedFromHub=function(){return Promise.resolve(p.i)};t.prototype.getContentTypeOperationsForIds=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push({resourceId:i,status:p.e.success})}return new Promise(function(e){setTimeout(function(){e(t)},5e3)})};t.prototype.getContentTypes=function(e,t){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeOperations=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeOperationsUrlTemplate,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetContentTypeOperations",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeAncestors=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeAncestorsParam,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetSiteContentTypeAncestors",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).ancestors},noRedirect:!0})};t.prototype.getContentType=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeUrlTemplate+"/"+n,Object(f.r)(this._pageContext),e,t)),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return}},noRedirect:!0})};t.prototype.getContentTypesDetailedAvailableForList=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.availableContentTypesForListUrlTemplate+"?"+this.fetchCustomCTProperty,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetSiteContentTypeForList",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypesDetailed=function(e,t,n,r,i){var s=this,o=null!=r?r:Object(f.r)(this._pageContext);o.endsWith("/")&&(o=o.substring(0,o.length-2));var u=null!=i?i:"";u=u?"?"+u:"";var a=function(r){return s.dataRequestor.getData({url:encodeURI(C.format(s.listContentTypeDetailedUrlTemplate+u,o,e,t,n)),qosName:"GetListContentType",method:"GET",contentType:"application/json",authToken:null!=r?r:void 0,parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};return r?this._getOAuthToken(r).then(function(e){return a(e)}):a()};t.prototype.getContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeColumnsUrlTemplate+"?"+this.getContentTypeColumnsHiddenParam,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getReorderableContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypeColumns=function(e,t,n,r){return this.dataRequestor.getData({url:encodeURI(C.format(this.listContentTypeColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t,n,r)),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getReorderableListContentTypeColumns=function(e,t,n,r){return this.dataRequestor.getData({url:encodeURI(C.format(this.listContentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,Object(f.r)(this._pageContext),e,t,n,r)),qosName:"GetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getEnforcedHubSites=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeEnforcemenetParam,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetContentTypeEnforcedHubSites",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return{}}},noRedirect:!0})};t.prototype.publishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:encodeURI(C.format(this.publishContentTypeUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetContentTypePublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.publishContentType=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:encodeURI(C.format(n.publishContentTypeUrlTemplate,Object(f.r)(n._pageContext),e,t)),authToken:r,qosName:"PostContentTypePublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentType=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:n.getUrl(n.unpublishContentTypeUrlTemplate,e,t),authToken:r,qosName:"PostContentTypeUnpublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.unpublishContentTypeUrlTemplate,e,t),qosName:"GetContentTypeUnpublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.getSiteColumns=function(e,t,n){return this.dataRequestor.getData({url:n?encodeURI(C.format(this.siteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)+"?select="+n.join(",")):encodeURI(C.format(this.siteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetSiteColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getAncestorColumns=function(e,t,n){return this.dataRequestor.getData({url:n&&n.length>0?encodeURI(C.format(this.ancestorSiteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)+"(select="+n.join(",")+")"):encodeURI(C.format(this.ancestorSiteColumnsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetAncestorColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).externalColumns},noRedirect:!0})};t.prototype.addContentTypesToList=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.listContentTypeDetailedUrlTemplate,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:"AddContentTypeToList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:i.constructContentTypeAddToListPostBody(r),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})})};t.prototype.createContentType=function(e,t,n,r,i,s,o){var u=this;return this.getToken().then(function(a){return u.dataRequestor.getData({url:encodeURI(C.format(u.contentTypeUrlTemplate,Object(f.r)(u._pageContext),i,s)),authToken:a,qosName:"CreateContentType",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:u.constructContentTypeBody(e,t,n,r,void 0,void 0,o),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateContentType=function(e,t,n,r,i,s,o,u,a,l,c){var h=this,p=JSON.parse(this.constructContentTypeBody(r,i,s,o,u,a,c)),d=void 0,v=1;if(void 0!==l){p.documentTemplate={name:l.name};if(void 0!==l.content){p.documentTemplate["@microsoft.graph.sourceUrl"]="cid:content"+v;d=L("A100x","content"+v,"application/octet-stream");v+=1}}var m,g=(function(e,t,n,r){var i=L(e,t,n);return i+=r+"\r\n"})("A100x","metadata","application/json",JSON.stringify(p));if(void 0!==d){g+=d;m=new Blob([g,l.content,"\r\n--A100x--"])}else m=new Blob([g,"--A100x--"]);return this.getToken().then(function(r){return h.dataRequestor.getData({url:encodeURI(C.format(h.updateContentTypeUrlTemplate,Object(f.r)(h._pageContext),e,t,n)),authToken:r,qosName:"UpdateContentType",method:"PATCH",contentType:"multipart/related; boundary=A100x",additionalHeaders:void 0,additionalPostData:m,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.addContentTypesToListFromHub=function(e,t,n,r){for(var i=this,s="batch_36522ad7-fc75-4b56-8c71-56071383e77b",o="",u=0,a=r;u<a.length;u++){var f=a[u],l=C.format(this.addContentTypeToListBatchUrlTemplate,e,t,n);o+=A(s,"application/http","binary");o+=O("application/json","application/json","POST",l,f.length+20);o+=JSON.stringify({contentTypeId:f})+"\r\n\r\n"}var c=new Blob([o,"--batch_36522ad7-fc75-4b56-8c71-56071383e77b--"]);return this.getToken().then(function(e){return i.dataRequestor.getData({url:C.format(i.batchUrlTemplate,i._pageContext.webAbsoluteUrl.replace(/\/$/,"")),authToken:e,qosName:"AddContentTypeToListFromHubBatch",method:"POST",contentType:"multipart/mixed; boundary="+s,additionalHeaders:void 0,additionalPostData:c,parseResponse:function(e){},noRedirect:!0})})};t.prototype.createOrAddContentTypeColumns=function(e,t,n,r,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(C.format(s.contentTypeColumnsUrlTemplate,Object(f.r)(s._pageContext),e,t,n)),authToken:o,qosName:"CreateContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({value:Object(a.__spreadArrays)(r,i)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.addContentTypeColumns=function(e,t,n,r,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(C.format(s.contentTypeColumnsAddUrlTemplate,Object(f.r)(s._pageContext),e,t,n)),authToken:o,qosName:"AddContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"applicatiogetSharedPackagesByUrln/json"},additionalPostData:JSON.stringify({value:Object(a.__spreadArrays)(r,i)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.createContentTypeView=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.createContentTypeViewUrl,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:i.constructCreateContentTypeViewPostBody(r),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return""}},noRedirect:!0})})};t.prototype.getSharedPackagesByUrl=function(e,t){var n=this;return this.getToken(e).then(function(r){return n.dataRequestor.getData({url:encodeURI(C.format(n.sharedPackageUrlTemplate,e+t)),qosName:"GetSharedPackagesByUrl",method:"GET",authToken:r,contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d.results},noRedirect:!0})})};t.prototype.getSharedPackageList=function(e,t){var n=this;return this.getToken(e).then(function(r){return n.dataRequestor.getData({url:encodeURI(C.format(n.sharedPackageListTemplate,e+t)),qosName:"GetSharedPackageList",method:"GET",authToken:r,contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d.Id},noRedirect:!0})})};t.prototype.getSharedPackageListItems=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.urlTemplateForSharedPackages,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetSharedPackageListItems",method:"GET",contentType:"application/json",parseResponse:function(e){var t=JSON.parse(e),n=[];t.value.map(function(e){return n.push(e.fields)});return n},noRedirect:!0})};t.prototype.getSharedPackages=function(e){return this.dataRequestor.getData({url:this.getUrl(this.sharedPackageByTitleUrlTemplate,e),qosName:"GetSharedPackages",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getCurrencyList=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(C.format(t.currencyListUrlTemplate,e)),authToken:n,qosName:"SP.CurrencyList.GetList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).Items}catch(e){return[]}},noRedirect:!0})})};t.prototype.getRegionalDateTimeSchema=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(C.format(t.regionalDateTimeUrlTemplate,e)),authToken:n,qosName:"GetRegionalDateTimeSchema",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{var t=JSON.parse(e);return JSON.parse(t.value)}catch(e){return{}}},noRedirect:!0})})};t.prototype.loadViews=function(e,t){var n=this;return this.dataRequestor.getData({url:""+e+C.format(this.contentTypeListViewUrl,t)+"/Views",qosName:"GetContentTypeViews",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return n._parseReturnedViews(JSON.parse(e))},noRedirect:!0})};t.prototype.updateView=function(e,t,n,r,i,s){var o=this,u=""+i+C.format(this.contentTypeListViewUrl,s)+"/Views('"+e+"')/SetViewXml()",a=this._translateColumnKeysToFieldRefNames(r),f=new N(n,a).generateCamlQueryString().replace("<View>",'<View Name="'+e+'" DisplayName="'+t+'">');return this.getToken().then(function(e){return o.dataRequestor.getData({url:u,authToken:e,qosName:"UpdateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({viewXml:f}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.createView=function(e,t,n,r,i){var s=this,o=""+r+C.format(this.contentTypeListViewUrl,i)+"/Views/Add",u=this._translateColumnKeysToFieldRefNames(n),a=new N(t).generateCamlQueryString();return this.getToken().then(function(t){return s.dataRequestor.getData({url:o,authToken:t,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({parameters:{Title:e,ViewFields:u,Query:a,Paged:!1,PersonalView:!1}}),parseResponse:function(e){return JSON.parse(e).Id},noRedirect:!0})})};t.prototype.setDefaultView=function(e,t,n){return Object(a.__awaiter)(this,void 0,k.n,function(){var r,i=this;return Object(a.__generator)(this,function(s){r=""+e+C.format(this.contentTypeListViewUrl,n)+"/Views('"+t+"')";return[2,this.getToken().then(function(e){return i.dataRequestor.getData({url:r,authToken:e,qosName:"UpdateContentTypeView",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({DefaultView:!0}),parseResponse:function(e){},noRedirect:!0})})]})})};t.prototype.createContentTypeViewList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(C.format(r.createListUrlTemplate,Object(f.r)(r._pageContext),e,t)),authToken:i,qosName:"CreateContentTypeViewList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify(n),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateListSettings=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:encodeURI(C.format(n.updateListUrlTemplate,n._pageContext.webAbsoluteUrl,e)),authToken:r,qosName:"UpdateListSettings",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json","X-HTTP-Method":"MERGE","IF-MATCH":"*"},additionalPostData:JSON.stringify(t),parseResponse:function(e){},noRedirect:!0})})};t.prototype.getAllSitesLists=function(e,t){return this.dataRequestor.getData({url:encodeURI(C.format(this.siteListsUrlTemplate,Object(f.r)(this._pageContext),e,t)),qosName:"GetAllSitesLists",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getListData=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.listUrlTemplate,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetListData",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getListFields=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.listFieldsUrlTemplate,Object(f.r)(this._pageContext),e,t,n)),qosName:"GetListFields",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getContentTypeDocTemplate=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(C.format(this.contentTypeUrlTemplate+"/"+n+"?"+this.selectDocTemplateProperty,Object(f.r)(this._pageContext),e,t)),qosName:"GetContentTypeDocTemplate",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).documentTemplate}catch(e){return{}}},noRedirect:!0})};t.prototype.deleteContentTypeFromList=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.listContentTypeDetailedUrlTemplate+"/"+r,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:"DeleteContentTypeList",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeFromSite=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:encodeURI(C.format(r.contentTypeUrlTemplate+"/"+n,Object(f.r)(r._pageContext),e,t)),authToken:i,qosName:"DeleteContentTypeSite",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.updateContentTypeColumnUrlTemplate,Object(f.r)(i._pageContext),e,t,n,r)),authToken:s,qosName:"DeleteContentTypeColumn",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.updateContentTypeColumn=function(e,t,n,r,i,s,o){var u=this;return this.getToken().then(function(a){return u.dataRequestor.getData({url:encodeURI(C.format(u.updateContentTypeColumnUrlTemplate,Object(f.r)(u._pageContext),e,t,n,r)),authToken:a,qosName:"UpdateContentTypeColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({pushDownChanges:i,hidden:s,required:o}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.reorderContentTypeColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.updateContentTypeUrlTemplate+"?"+i.reorderColumns,Object(f.r)(i._pageContext),e,t,n)),authToken:s,qosName:"ReorderContentTypeColumns",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({columnOrder:r}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateSiteColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(C.format(i.siteColumnsUrlTemplate,i._pageContext.siteAbsoluteUrl,e,t)+"/"+n),authToken:s,qosName:"UpdateSiteColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({customFormatter:r}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype._translateColumnKeysToFieldRefNames=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i in p.n&&t.push(p.n[i].fieldRefName)}return t};t.prototype._parseReturnedViews=function(e){if(!e||!e.value||0===e.value.length)throw new Error("ContentTypeDataSource.parseReturnedViews: viewsData is null or undefined!");for(var t={},n=0,r=e.value;n<r.length;n++){var i=r[n],s=void 0;s=i.ViewQuery.indexOf("<View>")>-1?N.parseCamlQueryString(i.ViewQuery):N.parseCamlQueryString("<View><Query>"+i.ViewQuery+"</Query></View>");t[i.Id]={id:i.Id,title:i.Title,isDefault:i.DefaultView,query:s}}return t};t.prototype.getUrl=function(e,t,n,r,i){var s=Object(f.r)(this._pageContext);return n?r?void 0:i?encodeURI(C.format(e,s,t,n,i)):encodeURI(C.format(e,s,t,n)):r?encodeURI(C.format(e,s,t,r)):encodeURI(C.format(e,s,t))};t.prototype.constructContentTypeBody=function(e,t,n,r,i,s,o){var u={name:e,description:t,group:n,readOnly:i,pushDownChanges:s,enforcement:o};r&&(u.parentReference={id:r});return JSON.stringify(u)};t.prototype.constructContentTypeAddToListPostBody=function(e){var t=[];e.forEach(function(e){return t.push({id:e})});return JSON.stringify({value:t})};t.prototype.constructCreateContentTypeViewPostBody=function(e){var t={columns:e.columns,isDefault:!1,isPersonalView:!1,title:e.name,associatedContentType:{id:e.parentReference.id},displayName:M.e.isActivated("1d8cce13-d7df-463e-8243-1d10761b9759","09/23/2020","Pass displayName in view creation API")?void 0:e.name,legacyType:M.e.isActivated("0039b334-3a6c-4a11-abc7-755e22011543","09/23/2020","Pass legacyType in view creation API")?void 0:"HTML"};return JSON.stringify(t)};return t})(c.t);t.e=_},"2609":function(e,t,n){"use strict";var r=n(0),i=n(54),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"GraphContentTypeInfo"},t)||this;n._oAuthTokenProvider=t.oAuthTokenProvider;n._canUseGraph=n._pageContext.isSPO;return n}t.prototype.getSiteAndWebIdfromUrl=function(e){var t=this;return this._canUseGraph?this._oAuthTokenProvider.getToken(this._pageContext.msGraphEndpointUrl).then(function(n){return t._getSiteAndWebId(n,t._pageContext.msGraphEndpointUrl+e)}).catch(function(){return null}):i.n.resolve(null)};t.prototype._getSiteAndWebId=function(e,t){return this.dataRequestor.getData({url:t,authToken:e,qosName:"GetSiteId",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){var t=JSON.parse(e);return[t.id.split(",")[1],t.id.split(",")[2]]}})};return t})(n(515).e);t.e=s},"2796":function(e,t,n){"use strict";var r=n(0),i=n(1963),s=n(73),o=n(41),u=(function(){function e(e){this.uri=new o.e(""+e.authority+e.path)}e.prototype.getSiteByPathUrl=function(){return"/v1.0/sites/"+this.uri.domain+":"+this.uri.path};e.prototype.getWebAbsoluteUrlValue=function(){return""+this.uri.value};return e})(),a=n(71),f=n(54),l=[{name:"Name",displayName:"Name",required:!1,text:{textType:""}},{name:"Group",displayName:"Group",required:!1,text:{textType:""}},{name:"Parent",displayName:"Parent",required:!1,text:{textType:""}}],c=(function(){function e(t,n,r,i,s,o){this.contentTypeHubPath="/sites/contenttypehub";this._graphDataSource=t;this._contentTypeDataSource=n;this._pageContext=r;this._isAdmin=void 0!==i&&!1!==i;this._siteId=void 0!==s?s:e.removeParenthesisIfExist(this._pageContext.siteId);this._webId=void 0!==o?o:e.removeParenthesisIfExist(this._pageContext.webId)}e.prototype.loadContentTypes=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this._contentTypeDataSource.getContentTypes(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentType=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.getContentType(e.removeParenthesisIfExist(this._pageContext.siteId),this._webId,t).then(function(e){return e})]})})};e.prototype.getSiteInfo=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this._contentTypeDataSource.getSiteInfo(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentTypesDetailedAvailableForList=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getContentTypesDetailedAvailableForList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId)).then(function(e){return e})]})})};e.prototype.loadPublishedContentTypesFromHub=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=[];n.label=1;case 1:n.trys.push([1,3,,5]);return[4,this._contentTypeDataSource.getContentTypesPublishedFromHub(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId))];case 2:t=n.sent();return[3,5];case 3:n.sent();return[4,this._contentTypeDataSource.getMockContentTypesPublishedFromHub()];case 4:t=n.sent();return[3,5];case 5:return[2,t]}})})};e.prototype.loadPublishedSiteContentTypesFromHub=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this._contentTypeDataSource.getSiteContentTypesPublishedFromHub(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId))];case 1:return[2,t.sent()]}})})};e.prototype.pullContentTypeFromHub=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._contentTypeDataSource.pullContentTypeFromHub(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),t)];case 1:return[2,n.sent()]}})})};e.prototype.loadContentTypesOperations=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=[];r.label=1;case 1:r.trys.push([1,3,,5]);return[4,this._contentTypeDataSource.getContentTypeOperations(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId))];case 2:n=r.sent();return[3,5];case 3:r.sent();return[4,this._contentTypeDataSource.getContentTypeOperationsForIds(t)];case 4:n=r.sent();return[3,5];case 5:return[2,n]}})})};e.prototype.loadListContentTypesDetailed=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.getListContentTypesDetailed(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),void 0,t).then(function(e){return e})]})})};e.prototype.addContentTypesToList=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.addContentTypesToList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.addContentTypesToListFromHub=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.addContentTypesToListFromHub(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.updateListSettings=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.updateListSettings(e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadContentTypeColumns=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadReorderableContentTypeColumns=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getReorderableContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadReorderableContentTypeColumnsFromHub=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getReorderableContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadListContentTypeColumns=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.getListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadReorderableListContentTypeColumns=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.getReorderableListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadSiteColumns=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getSiteColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadAncestorColumns=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getAncestorColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.createContentType=function(e,t,n,i,s){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return[2,this._contentTypeDataSource.createContentType(e,t,n,i,this._siteId,this._webId,s).then(function(e){return e})]})})};e.prototype.updateContentType=function(e,t,n,i,s,o,u,a,f){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return[2,this._contentTypeDataSource.updateContentType(this._siteId,this._webId,e,t,n,i,s,o,u,a,f).then(function(e){return e})]})})};e.prototype.publishContentType=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:n.trys.push([0,1,,4]);return[2,this._contentTypeDataSource.publishContentType(this._siteId,e).then(function(e){return e})];case 1:return 400!==(t=n.sent()).status?[3,3]:[4,this._contentTypeDataSource.publishContentTypeGet(this._siteId,e)];case 2:return[2,n.sent()];case 3:throw t;case 4:return[2]}})})};e.prototype.unpublishContentType=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,1,,4]);return[2,this._contentTypeDataSource.unpublishContentType(this._siteId,e).then(function(e){return e})];case 1:return 400!==t.sent().status?[3,3]:[4,this._contentTypeDataSource.unpublishContentTypeGet(this._siteId,e)];case 2:return[2,t.sent()];case 3:return[3,4];case 4:return[2]}})})};e.prototype.deleteContentTypeColumn=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.createOrAddContentTypeColumns=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=[];if(a.e.isActivated("1da97387-b00c-40ac-9251-a39f72cbedcf","12/07/2020","Killswitch for modifying create content type columns API call"))return[3,6];r.label=1;case 1:r.trys.push([1,3,,5]);return[4,this._contentTypeDataSource.addContentTypeColumns(this._siteId,this._webId,e,t,n)];case 2:i=r.sent();return[3,5];case 3:r.sent();return[4,this._contentTypeDataSource.createOrAddContentTypeColumns(this._siteId,this._webId,e,t,n)];case 4:i=r.sent();return[3,5];case 5:return[3,8];case 6:return[4,this._contentTypeDataSource.createOrAddContentTypeColumns(this._siteId,this._webId,e,t,n)];case 7:i=r.sent();r.label=8;case 8:return[2,i]}})})};e.prototype.createContentTypeView=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){t.columns;return[2,this._contentTypeDataSource.createContentTypeView(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.getSharedPackages=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=[];if(a.e.isActivated("ec389545-4106-4ad8-a677-53106625a517","08/28/2020","Kill getting shared packages by title"))return[3,13];r.label=1;case 1:r.trys.push([1,7,,12]);return a.e.isActivated("415bb0d6-03e4-4102-8d98-8cc8bf666829","11/11/2020","Kill for modifying getting shared packages API call")?[3,4]:[4,this._contentTypeDataSource.getSharedPackageList(e,this.contentTypeHubPath)];case 2:n=r.sent();return[4,this._contentTypeDataSource.getSharedPackageListItems(this._siteId,this._webId,n)];case 3:return[2,t=r.sent()];case 4:return[4,this._contentTypeDataSource.getSharedPackagesByUrl(e,this.contentTypeHubPath)];case 5:t=r.sent();r.label=6;case 6:return[3,12];case 7:r.sent();r.label=8;case 8:r.trys.push([8,10,,11]);return[4,this.getSharedPackagesInfo()];case 9:t=r.sent();return[3,11];case 10:r.sent();return[3,11];case 11:return[3,12];case 12:return[3,16];case 13:r.trys.push([13,15,,16]);return[4,this.getSharedPackagesInfo()];case 14:t=r.sent();return[3,16];case 15:r.sent();return[3,16];case 16:return[2,t]}})})};e.prototype.getCurrencyList=function(){return Object(r.__awaiter)(this,void 0,f.n,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:e=this._isAdmin?Object(s.r)(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getCurrencyList(e)];case 1:return[2,t.sent()]}})})};e.prototype.getRegionalDateTimeSchema=function(){return Object(r.__awaiter)(this,void 0,f.n,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:e=this._isAdmin?Object(s.r)(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getRegionalDateTimeSchema(e)];case 1:return[2,t.sent()]}})})};e.prototype.getAllSitesLists=function(){return Object(r.__awaiter)(this,void 0,f.n,function(){return Object(r.__generator)(this,function(e){return[2,this._contentTypeDataSource.getAllSitesLists(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.getListFields=function(e){return Object(r.__awaiter)(this,void 0,f.n,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getListFields(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeDocTemplate=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getContentTypeDocTemplate(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeEnforcedHubSites=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getEnforcedHubSites(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.deleteListContentType=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeFromList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.updateContentTypeColumn=function(e,t,n,i,s){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return[2,this._contentTypeDataSource.updateContentTypeColumn(this._siteId,this._webId,e,t,n,i,s).then(function(e){return e})]})})};e.prototype.reorderContentTypeColumn=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._contentTypeDataSource.reorderContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.getContentTypeAncestors=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.getContentTypeAncestors(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateSiteColumn=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return[2,this._contentTypeDataSource.updateSiteColumn(this._siteId,t,e,n).then(function(e){return e})]})})};e.prototype.deleteSiteContentType=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._contentTypeDataSource.deleteContentTypeFromSite(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateView=function(e,t,n,s){return Object(r.__awaiter)(this,void 0,f.n,function(){var o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o=this._isAdmin?i.t:i.r;return[4,this._contentTypeDataSource.updateView(e,t,n,s,this._pageContext.webAbsoluteUrl,o)];case 1:return[2,r.sent()]}})})};e.prototype.createView=function(e,t,n){return Object(r.__awaiter)(this,void 0,f.n,function(){var s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:s=this._isAdmin?i.t:i.r;return[4,this._contentTypeDataSource.createView(e,t,n,this._pageContext.webAbsoluteUrl,s)];case 1:return[2,r.sent()]}})})};e.prototype.setDefaultView=function(e){return Object(r.__awaiter)(this,void 0,f.n,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=this._isAdmin?i.t:i.r;return[4,this._contentTypeDataSource.setDefaultView(this._pageContext.webAbsoluteUrl,e,t)];case 1:return[2,n.sent()]}})})};e.prototype.loadViews=function(){return Object(r.__awaiter)(this,void 0,f.n,function(){var t,n,s,o,u,a,f,c,h,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this._pageContext.webAbsoluteUrl;n=e.removeParenthesisIfExist(this._pageContext.siteId);s=e.removeParenthesisIfExist(this._pageContext.webId);o=this._isAdmin?i.t:i.r;u=["name","parent","group"];if(this._isAdmin||this._pageContext.webServerRelativeUrl.toLowerCase()===this.contentTypeHubPath){l.push({name:"LastPublished",displayName:"LastPublished",required:!1,text:{textType:""}});u.push("lastPublished")}else{l.push({name:"Source",displayName:"Source",required:!1,text:{textType:""}});u.push("source")}r.label=1;case 1:r.trys.push([1,3,,10]);return[4,this._contentTypeDataSource.loadViews(t,o)];case 2:return[2,r.sent()];case 3:if(404!==(a=r.sent()).status)return[3,8];f={displayName:o,list:{hidden:!0,template:"genericList"},columns:l};c={orderBy:{field:"name",direction:1}};return[4,this._contentTypeDataSource.createContentTypeViewList(n,s,f)];case 4:r.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 5:h=r.sent();p=Object.keys(h)[0];return[4,this._contentTypeDataSource.updateView(p,h[p].title,c,u,this._pageContext.webAbsoluteUrl,o)];case 6:r.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 7:return[2,r.sent()];case 8:throw a;case 9:return[3,10];case 10:return[2]}})})};e.prototype.loadListData=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this._contentTypeDataSource.getListData(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.webId),e.removeParenthesisIfExist(this._pageContext.listId))];case 1:return[2,t.sent()]}})})};e.prototype.getContentTypeHubSiteId=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=new u({path:this.contentTypeHubPath,authority:e});n=t.getSiteByPathUrl();return[4,this._graphDataSource.getSiteAndWebIdfromUrl(n)];case 1:return[2,r.sent()]}})})};e.removeParenthesisIfExist=function(e){return e.indexOf("{")>=0&&e.lastIndexOf("}")===e.length-1?e.substring(1,e.length-1):e};e.prototype.getSharedPackagesInfo=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:e=[];return[4,this._contentTypeDataSource.getSharedPackages(this._siteId)];case 1:t.sent().forEach(function(t){e.push(t.fields)});return[2,e]}})})};return e})();t.e=c},"3415":function(e,t,n){"use strict";var r=n("react-lib"),i=n(0),s=n(2138),o=n(127),u=n(28),a=n(133),f=n(14),l=n(40),c=Object(l.t)(function(e,t){var n=t.itemKeys.filter(function(t){return"failed"===Object(a.i)(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(u.e,{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){f(Object(s.e)({items:Object(o.e)(n,function(){return{}})}));return[2]})})},isAvailable:n.length>0})}),h=Object(f.s)()(c),p=n(2),d=n(251);n.d(t,"e",function(){return v});var v={key:new p.e("retryProgressCommand").id,name:d.e.progressRetryActionText,action:r.createElement(h,null)}},"4422":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(21),o=n(28),u=n(178),a=n(2337),f={title:null,closeButtonAriaLabel:null,dropdownNoneLabel:null,dropdownLabel:null,dropdownTitleSelectedLabel:null,addedContentTypes:null,selectedContentTypesColumnKey:null,nameLabel:null,parentLabel:null,descriptionLabel:null,columnsLabel:null,cancelButtonLabel:null,applyButtonLabel:null,addColumnCurrentViewLabel:null,createNewViewLabel:null,defaultSecondaryPanelLabel:null,contentTypeInformationLabel:null,secondaryPanelFieldsListNameDisplayName:null,secondaryPanelFieldsListTypeDisplayName:null,secondaryPanelFieldsListStatusDisplayName:null,secondaryPanelFieldsListSourceDisplayName:null,removeContentTypeButtonLabel:null,loadingContentTypesSpinner:null,applyingContentTypesSpinner:null,tooltipReadonlyCT:null,ariaLabelAddedCT:null,ariaLabelCTLoaded:null,settingsTitle:null,settingsSubtitle:null,allowContentTypesLabel:null,saveButtonLabel:null,saveContentTypesSettingsSpinner:null},l={cannotRemoveContentType:null,genericErrorMessage:null};var c,h=n(1963),p=n(2609),d=n(2453),v=n(2796),m=n(1629),g=n(1635),y=n(74),b=n(31),w=n(2395),E=n(107),S={ODB:60122};(function(e){e[e.NO_VIEW=0]="NO_VIEW";e[e.DIRTY_VIEW=1]="DIRTY_VIEW";e[e.CLEAN_VIEW=2]="CLEAN_VIEW"})(c||(c={}));var x=(function(){function e(e){var t=this;this._onDismiss=function(){t._params.contentTypeManagementPanelContainer.state.isPanelOpen&&t._params.contentTypeManagementPanelContainer.setState({isPanelOpen:!1});t._params.contentTypeManagementPanelContainer.props.resolve()};this._createNewViewsForContentTypes=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:if(!(e&&e.length>=0))return[3,11];t=new y.e({name:"ContentTypeManagementPanel.CreateNewView"});n={};this._params.contentTypeManagementPanelContainer.props.views&&this._params.contentTypeManagementPanelContainer.props.views.forEach(function(e){if(e){var t=Object(w.n)(e.ListViewXml);t.associatedContentTypeId&&(n[t.associatedContentTypeId]=Object(r.__assign)(Object(r.__assign)({},e),{arrangedColumns:t.fieldNames}))}});l.label=1;case 1:l.trys.push([1,10,,11]);i=0,s=e;l.label=2;case 2:if(!(i<s.length))return[3,9];o=s[i];u=o;return[4,this._getListContentTypeColumns(o.id)];case 3:u.columns=l.sent();a=this.getExistingViewInfo(o,n);switch(a.status){case c.NO_VIEW:return[3,4];case c.DIRTY_VIEW:return[3,6]}return[3,8];case 4:return[4,this._createContentTypeView(o)];case 5:l.sent();return[3,8];case 6:return[4,this.updateViewWithNewColumns(n[o.parentReference.id],a.newColumnsNeeded)];case 7:l.sent();return[3,8];case 8:i++;return[3,2];case 9:t.end({resultType:b.e.Success});return[3,11];case 10:f=l.sent();this.handleError(t,f);return[2];case 11:return[2]}})})};this._getSiteContentTypesAvailableForList=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.contentTypeProvider.loadContentTypesDetailedAvailableForList()]})})};this._getSiteContentType=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.contentTypeProvider.loadContentType(e)]})})};this._getListContentTypes=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.contentTypeProvider.loadListContentTypesDetailed("$filter=custom ne null")]})})};this._getListData=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.contentTypeProvider.loadListData()]})})};this._getPublishedContentTypesFromHub=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.contentTypeProvider.loadPublishedContentTypesFromHub()]})})};this._getContentTypeColumns=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.contentTypeProvider.loadReorderableContentTypeColumns(e)]})})};this._getContentTypeColumnsFromHub=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.contentTypeProvider.loadReorderableContentTypeColumnsFromHub(e)]})})};this._getListContentTypeColumns=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.contentTypeProvider.loadReorderableListContentTypeColumns(e)]})})};this._addContentTypesToList=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,o,u,a,f,l,c,p,d,v,m,g,w,x,T,N,C,k,L;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=[];n=[];if(!E.e.isFeatureEnabled(S))return[3,16];this._onDismiss();if(!this._params.contentTypeManagementPanelContainer.props.onContentTypesAddToList)return[3,15];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._params.contentTypeManagementPanelContainer.props.onContentTypesAddToList(e)];case 2:r.sent();return[3,4];case 3:r.sent();return[3,4];case 4:return[4,this.contentTypeProvider.loadContentTypesOperations(e.map(function(e){return e.id}))];case 5:i=r.sent();return[4,this._getListContentTypes()];case 6:s=r.sent();o=0,u=e;r.label=7;case 7:if(!(o<u.length))return[3,13];T=u[o];a=!1;for(f=0,l=i;f<l.length;f++)(c=l[f]).resourceId===T.id&&c.status===h.e.success&&(a=!0);if(!a)return[3,12];p=0,d=s;r.label=8;case 8:if(!(p<d.length))return[3,12];if((v=d[p]).parentReference.id!==T.id)return[3,11];T.createNewView&&n.push(v);if(!T.addColumnsToCurrentView)return[3,11];if(T.columns||T.isFromContentTypeHub)return[3,10];m=T;return[4,this._getContentTypeColumns(T.id)];case 9:m.columns=r.sent();r.label=10;case 10:T.columns.forEach(function(e){return t.push(e.name)});r.label=11;case 11:p++;return[3,8];case 12:o++;return[3,7];case 13:return[4,this._createNewViewsForContentTypes(n)];case 14:r.sent();this._params.contentTypeManagementPanelContainer.props.onSuccess&&this._params.contentTypeManagementPanelContainer.props.onSuccess(t);r.label=15;case 15:return[3,27];case 16:g=[];w=0,x=e;r.label=17;case 17:if(!(w<x.length))return[3,21];T=x[w];g.push(T.id);T.createNewView&&n.push(T);if(!T.addColumnsToCurrentView)return[3,20];if(T.columns)return[3,19];N=T;return[4,this._getContentTypeColumns(T.id)];case 18:N.columns=r.sent();r.label=19;case 19:T.columns.forEach(function(e){return t.push(e.name)});r.label=20;case 20:w++;return[3,17];case 21:C=new y.e({name:"ContentTypeManagementPanel.addContentTypesToList"});k=[];r.label=22;case 22:r.trys.push([22,24,,25]);return[4,this.contentTypeProvider.addContentTypesToList(g)];case 23:k=r.sent();C.end({resultType:b.e.Success});return[3,25];case 24:L=r.sent();this.handleError(C,L);return[2];case 25:n=this._updateToListContentTypes(n,k);return[4,this._createNewViewsForContentTypes(n)];case 26:r.sent();this._onDismiss();this._params.contentTypeManagementPanelContainer.props.onSuccess&&this._params.contentTypeManagementPanelContainer.props.onSuccess(t);r.label=27;case 27:return[2]}})})};this._updateListSettings=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this.contentTypeProvider.updateListSettings(e)];case 1:t.sent();E.e.isFeatureEnabled(S)&&this._params.contentTypeManagementPanelContainer.props.updateContentTypeSettings&&this._params.contentTypeManagementPanelContainer.props.updateContentTypeSettings(e.ContentTypesEnabled);return[2]}})})};this._createContentTypeView=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.contentTypeProvider.createContentTypeView(e)]})})};this._deleteContentType=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t=this;return Object(r.__generator)(this,function(n){return[2,this.contentTypeProvider.deleteListContentType(e).then(function(){t._params.contentTypeManagementPanelContainer.props.onSuccess([])})]})})};this._updateToListContentTypes=function(e,t){return t=t.filter(function(t){for(var n=0,r=e;n<r.length;n++){if(r[n].id===t.parentReference.id)return!0}return!1})};this.handleError=function(e,n){e.end({resultType:b.e.Failure,error:JSON.stringify(n)});t._params.contentTypeManagementPanelContainer.setState({hasError:!0})};this.getExistingViewInfo=function(e,t){if(!(e.parentReference.id in t))return{status:c.NO_VIEW};var n=new Set;t[e.parentReference.id].arrangedColumns.forEach(function(e){return n.add(e)});for(var r=[],i=0,s=e.columns;i<s.length;i++){var o=s[i];n.has(o.name)||r.push(o.name)}return r.length>0?{status:c.DIRTY_VIEW,newColumnsNeeded:r}:{status:c.CLEAN_VIEW}};this.updateViewWithNewColumns=function(e,n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){if(n&&n.length>0){t=Object(r.__spreadArrays)(e.arrangedColumns,n);this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns&&this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns(e.Id,t)}return[2]})})};this._params=e;var n=this._params.contentTypeManagementPanelContainer.props.pageContext;this.contentTypeProvider=new v.e(new p.e({pageContext:n,oAuthTokenProvider:new m.e({},{oAuthTokenDataSource:new g.e(n)})}),new d.e(n,e.contentTypeManagementPanelContainer.props.getOAuthToken),n);this._params.contentTypeManagementPanelContainer.state={isPanelOpen:!0,hasError:!1}}e.prototype.getRenderProps=function(){var e=this._params.contentTypeManagementPanelContainer.state,t=(function(e){var t=Object(r.__assign)({},f);for(var n in f)t[n]=e[n]?e[n]:n;return t})(this._params.strings),n=(function(e){var t=Object(r.__assign)({},l);for(var n in l)t[n]=e&&e[n]?e[n]:n;return t})(this._params.errorStrings);return{panelProps:{type:a.e.custom,isOpen:e.isPanelOpen,customWidth:"70%",onDismiss:this._onDismiss,isLightDismiss:!0,hasCloseButton:!1,onRenderNavigation:function(){return null},styles:{content:{padding:"0px",margin:"0px"}}},strings:t,errorStrings:n,hasErrorOccurred:e.hasError,onDismiss:this._onDismiss,getSiteContentTypes:this._getSiteContentTypesAvailableForList,getSiteContentType:this._getSiteContentType,getListContentTypes:this._getListContentTypes,getPublishedContentTypesFromHub:this._getPublishedContentTypesFromHub,getContentTypeColumns:this._getContentTypeColumns,getContentTypeColumnsFromHub:this._getContentTypeColumnsFromHub,getListContentTypeColumns:this._getListContentTypeColumns,getListData:this._getListData,addContentTypesToList:this._addContentTypesToList,updateListSettings:this._updateListSettings,removeContentType:this._deleteContentType,isContentTypeEnabled:!E.e.isFeatureEnabled(S)||this._params.contentTypeManagementPanelContainer.props.contentTypesEnabled,pageContext:this._params.contentTypeManagementPanelContainer.props.pageContext}};return e})(),T=n(3759),N=n(1396),C=n(352),k=n(1394),L=n(969),A=n(4154),O=n(2122),M=n(150);Object(M.n)([{rawString:".ms-ContentTypeManagementPanel-Spinner{height:100vh}.ms-ContentTypeManagementPanel{display:-webkit-box;display:-ms-flexbox;display:flex;height:100vh}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{-webkit-box-flex:1;-ms-flex:1;flex:1;background:#ffffff;padding:0px 10px 10px 30px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{padding:0px 30px 10px 10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{font-size:20px;font-family:'Segoe UI';margin:40px 0px 0px 0px;text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{margin:40px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SettingsIcon{float:right;width:10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{width:100%;margin:24px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{margin:24px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:70vh;overflow-y:auto;margin:12px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{margin:12px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{border:none;font-family:'Segoe UI';font-style:normal;font-weight:600;font-size:14px;padding:0px 0px 0px 0px;width:100%;height:100%;text-align:left;background-color:inherit}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{padding:0px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 8px 11px 12px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 12px 11px 8px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px;border:none;width:100%;height:36px;text-align:left}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container:hover,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container:hover{cursor:pointer}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container-selected,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected{background:#f3f2f1;border:none;width:100%;height:36px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-checkbox{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-text{-webkit-box-flex:100;-ms-flex:100;flex:100;border:none}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{-webkit-box-flex:2;-ms-flex:2;flex:2}html[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-left:20px}html[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-right:20px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:1;flex:1;margin:10px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{margin:10px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:8px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{margin:8px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{width:100%;margin-top:8px}[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:right}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content thead{display:table;width:100%;table-layout:fixed}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody{height:calc(100vh - 420px);overflow-y:auto;display:block;overflow-wrap:break-word}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody tr{table-layout:fixed;display:table;width:100%}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Title{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:20px;font-weight:600;line-height:28px;display:block;font-family:'Segoe UI';padding:14px 16px 14px 16px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Title{padding:14px 16px 14px 16px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Subtitle{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:16px;line-height:22px;overflow-wrap:break-word;padding:0px 16px 26px 16px;display:inline-block;font-family:'Segoe UI'}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Subtitle{padding:0px 16px 26px 16px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Checkbox{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Checkbox{padding-left:16px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-Settings .ms-ContentTypeManagementPanel-Settings-Checkbox{padding-right:16px}.ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}[dir='rtl'] .ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}.ms-ContentTypeManagementPanel-CancelButton{background-color:#f3f2f1}.ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{position:absolute;bottom:0}[dir='ltr'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-left:20px}[dir='rtl'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-right:20px}.ms-ContentTypeManagementPanel-SecondaryPanel-Buttons{position:absolute;bottom:0}.ms-ContentTypeManagementPanel-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var _=n(1544),D=n(4514),P=n(1410),H=n(1251),B=n(1543),j=n(1546),F=n(94),I=n(20),q=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.renderPanelContent=function(){var e=H.e(t.props.selectedContentTypeToViewInfo),n=t.props.strings;return i.createElement(i.Fragment,null,!t.props.selectedContentTypeToViewInfo.columns&&i.createElement(N.e,{size:C.e.large}),t.props.selectedContentTypeToViewInfo.columns&&i.createElement("div",null,i.createElement("span",{tabIndex:-1,role:"alert","aria-live":"assertive","aria-label":t.getAriaLabelCTLoaded(),className:"ms-ContentTypeManagementPanel-screenReaderOnly"},t.getAriaLabelCTLoaded()),!t.props.isSelectedAnAddedContentType&&i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle"},i.createElement(D.e,{onText:n.createNewViewLabel,offText:n.createNewViewLabel,onChange:t._onCreateNewViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.createNewView})),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.nameLabel,e.name)),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.parentLabel,e.parentReference.name))),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.descriptionLabel,e.description)))),!t.props.isSelectedAnAddedContentType&&i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView"},i.createElement(D.e,{onText:n.addColumnCurrentViewLabel,offText:n.addColumnCurrentViewLabel,onChange:t._onAddColumnsToCurrentViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.addColumnsToCurrentView})),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Columns"},i.createElement("b",null,n.columnsLabel)),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable"},t.renderFieldsTable()),t.props.cannotBeRemovedError&&i.createElement(j.e,{dismissButtonAriaLabel:n.closeButtonAriaLabel,messageBarType:F.e.error,isMultiline:!0,onDismiss:t.props.dismissErrorMessage},t.props.cannotBeRemovedError),t.props.isSelectedAnAddedContentType&&i.createElement(B.e,null,i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Buttons ms-ContentTypeManagementPanel-Button"},t.renderDeleteWithTooltip()))))};t._onCreateNewViewToggle=function(e,n){t.props.handleCreateNewViewToggle(n)};t._onAddColumnsToCurrentViewToggle=function(e,n){t.props.handleAddColumnsToCurrentViewToggle(n)};t._onRemoveContentTypeWrapper=function(e){t.props.removeContentType(t.props.selectedContentTypeToViewInfo.id,t.props.selectedContentTypeToViewInfo.parentReference.id)};t.renderKeyValueText=function(e,t,n){return i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},i.createElement("b",null,e)),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},n?i.createElement(_.e,{href:n}):t))};t.renderFieldsTable=function(){var e=t.props.strings;return i.createElement(i.Fragment,null,i.createElement("table",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content"},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,e.secondaryPanelFieldsListNameDisplayName),i.createElement("th",null,e.secondaryPanelFieldsListTypeDisplayName),i.createElement("th",null,e.secondaryPanelFieldsListStatusDisplayName),i.createElement("th",null,e.secondaryPanelFieldsListSourceDisplayName))),i.createElement("tbody",null,t.props.selectedContentTypeToViewInfo.columns.map(function(e){return i.createElement("tr",{key:e.id},i.createElement("td",null,e.displayName||e.name),i.createElement("td",null,e.typeDisplayName),i.createElement("td",null,e.required?"Required":"Optional"),i.createElement("td",null,e.sourceContentType?e.sourceContentType.name:""))}))))};t.renderDeleteWithTooltip=function(){return t.props.selectedContentTypeToViewInfo?t.props.selectedContentTypeToViewInfo.readOnly?i.createElement(P.e,{content:t.props.strings.tooltipReadonlyCT},t.renderDeleteButton()):t.renderDeleteButton():i.createElement(i.Fragment,null," ")};t.renderDeleteButton=function(){return i.createElement("div",null,i.createElement(k.e,{onClick:t._onRemoveContentTypeWrapper,disabled:t.props.selectedContentTypeToViewInfo&&t.props.selectedContentTypeToViewInfo.readOnly},t.props.strings.removeContentTypeButtonLabel))};t.getAriaLabelCTLoaded=function(){try{return I.format(t.props.strings.ariaLabelCTLoaded,t.props.selectedContentTypeToViewInfo.name)}catch(e){return""}};return t}t.prototype.render=function(){return i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Content",role:"region"},void 0===this.props.selectedContentTypeToViewInfo?this.props.strings.defaultSecondaryPanelLabel:this.props.strings.contentTypeInformationLabel,i.createElement("br",null),void 0!==this.props.selectedContentTypeToViewInfo?this.renderPanelContent():"")};return t})(i.PureComponent),R=n(1387),U=n(2040),z=n(4517),W=n(1398),X=n(290),V=n(1538),$=n(470),J=n(111),K=n(1377),Q=n(1316),G=n(119),Y=n(835),Z={ODB:60122},ee=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isInnerZoneKeystroke=function(e){return e.which===Object($.t)(J.e.right)};n._onOpenSettingsPane=function(){n.props.onOpenSettingsPane()};n._onRenderDropdownTitle=function(e){var t="",r=e.filter(function(e){return e.selected}).length;t=r>0?r+" "+n.props.strings.dropdownTitleSelectedLabel:n.props.strings.dropdownNoneLabel;return i.createElement("div",null,t)};n._onContentTypesSettingsChanged=function(e,t){n.props.onContentTypesSettingsChanged(t)};n._handleDropdownChange=function(e,t){var i=Object(r.__spreadArrays)(n.state.selectedContentTypesIds),s=n.state.selectedContentTypeToViewInfoId;if(t.selected)i.push(t.key);else{i=i.filter(function(e){return e!==t.key});s&&s===t.key&&(s=void 0)}n.props.onContentTypeSelected(i);n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{selectedContentTypesIds:i,selectedContentTypeToViewInfoId:s}))};n._handleAddedContentTypeSelect=function(e){if(e.columns)n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoadingContentTypeColumn:!1,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));n._updateColumnsOfAddedContentType(e)}};n._handleSelect=function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(s){t=H.e(this.state.availableContentTypes);n=void 0;for(i=0;i<t.length;i++)if(t[i].id===e){n=i;break}if(t[n].columns)this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedContentTypeToViewInfoId:e,isLoadingContentTypeColumn:!1,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{this._updateColumns(t,n);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}return[2]})})};n._onRenderAddedCTItem=function(e,t){return i.createElement(L.e,{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container"+(e.isSelected?" ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected":""),onClick:function(){return n._handleAddedContentTypeSelect(e)},key:e.id,styles:{label:{fontWeight:400}},ariaLabel:n._getAriaLabelforAddedCT(e.name,t+1)},e.name)};n._updateColumnsOfAddedContentType=function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var t=this;return Object(r.__generator)(this,function(n){this.props.getListContentTypeColumns(e.id).then(function(n){for(var i=H.e(t.state.addedContentTypes),s=0;s<i.length;s++)if(i[s].id===e.id){i[s].columns=n;break}t.setState(Object(r.__assign)(Object(r.__assign)({},t.state),{addedContentTypes:Object(r.__spreadArrays)(i),isLoadingContentTypeColumn:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){t.props.onError()});return[2]})})};n._updateColumns=function(e,t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i=this;return Object(r.__generator)(this,function(s){n=e[t];!this.props.isContentTypeHub&&n.isFromContentTypeHub||this.props.getContentTypeColumns(e[t].id).then(function(n){e[t].columns=n;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{availableContentTypes:Object(r.__spreadArrays)(e),isLoadingContentTypeColumn:i.state.selectedContentTypeToViewInfoId!==e[t].id&&i.state.isLoadingContentTypeColumn,isSelectedAnAddedContentType:i.state.selectedContentTypeToViewInfoId!==e[t].id&&i.state.isSelectedAnAddedContentType,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){i.props.onError()});return[2]})})};n._handleListCheckboxChangeWrapper=function(e){return function(t,r){return n._handleListCheckboxChange(r,e)}};n._handleListCheckboxChange=function(e,t){if(!e){var i=Object(r.__spreadArrays)(n.state.selectedContentTypesIds),s=n.state.selectedContentTypeToViewInfoId;i=i.filter(function(e){return e!==t});s&&s===t&&(s=void 0);n.props.onContentTypeSelected(i);n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{selectedContentTypesIds:i,selectedContentTypeToViewInfoId:s}))}};n._handleCreateNewViewToggle=function(e){u.e.logData({name:"ContentTypeManagementPanel.CreateNewViewToggle."+(e?"Enabled":"Disabled")});for(var t=H.e(n.state.availableContentTypes),i=0;i<t.length;i++)if(t[i].id===n.state.selectedContentTypeToViewInfoId){t[i]=Object(r.__assign)({},t[i]);t[i].createNewView=e;break}n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{availableContentTypes:Object(r.__spreadArrays)(t)}))};n._handleAddColumnsToCurrentViewToggle=function(e){u.e.logData({name:"ContentTypeManagementPanel.AddColumnsToCurrentViewToggle."+(e?"Enabled":"Disabled")});for(var t=H.e(n.state.availableContentTypes),i=0;i<t.length;i++)if(t[i].id===n.state.selectedContentTypeToViewInfoId){t[i]=Object(r.__assign)({},t[i]);t[i].addColumnsToCurrentView=e;break}n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{availableContentTypes:Object(r.__spreadArrays)(t)}))};n._handleRemoveContentTypeClick=function(e,t){u.e.logData({name:"ContentTypeManagementPanel.DeleteClick"});var i=new y.e({name:"ContentTypeManagementPanel.DeleteContentType"});n.props.removeContentType(e).then(function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:i.end({resultType:b.e.Success,extraData:{contentTypeId:e}});n=(n=H.e(this.state.addedContentTypes)).filter(function(t){return t.id!==e});return[4,this.props.getContentType(t)];case 1:(s=u.sent()).createNewView=!1;s.addColumnsToCurrentView=!1;(o=H.e(this.state.availableContentTypes)).push(s);o=o.sort(function(e,t){return e.name.localeCompare(t.name)});this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{availableContentTypes:Object(r.__spreadArrays)(o),addedContentTypes:Object(r.__spreadArrays)(n),selectedContentTypeToViewInfoId:void 0,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:void 0,cannotBeRemovedError:void 0}));return[2]}})})}).catch(function(t){if(400===t.status){i.end({resultType:b.e.ExpectedFailure,error:t,extraData:{contentTypeId:e}});n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{hasCannotBeRemovedError:!0,cannotBeRemovedError:t.message}))}else{i.end({resultType:b.e.Failure,error:t,extraData:{contentTypeId:e}});n.props.onError()}})};n._dismissError=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))};n.getSelectedContentTypesWithView=function(){var e=[];Object(r.__spreadArrays)(n.state.availableContentTypes).forEach(function(t){n.state.selectedContentTypesIds.find(function(e){return e===t.id})&&e.push(H.e(t))});return e};n.focusFirstElement=function(){var e;null===(e=n._dropdown)||void 0===e||e.focus()};n.focusFirstSettingsPaneElement=function(){var e;null===(e=n._checkbox)||void 0===e||e.focus()};n.state={availableContentTypes:H.e(n.props.availableContentTypes),selectedContentTypesIds:[],addedContentTypes:H.e(n.props.addedContentTypes),selectedContentTypeToViewInfoId:void 0,isLoadingContentTypeColumn:!0,isSelectedAnAddedContentType:!1,isContentTypeSettingsCheckboxEnabled:n.props.isContentTypeSettingsCheckboxEnabled,hasError:n.props.hasErrorOccurred,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0,isContentTypeSettingsPane:n.props.isContentTypeSettingsPane};return n}t.getDerivedStateFromProps=function(e,t){return Object(r.__assign)(Object(r.__assign)({},t),{hasError:t.hasError||e.hasErrorOccurred,isContentTypeSettingsCheckboxEnabled:e.isContentTypeSettingsCheckboxEnabled,isContentTypeSettingsPane:e.isContentTypeSettingsPane})};t.prototype.render=function(){var e=this,t=this.props.strings;if(this.state.hasError&&!this.state.hasCannotBeRemovedError)return i.createElement(i.Fragment,null,i.createElement(j.e,{isMultiline:!1,messageBarType:F.e.error},this.props.errorStrings.genericErrorMessage));if(E.e.isFeatureEnabled(Z)&&this.state.isContentTypeSettingsPane)return i.createElement("div",{className:"ms-ContentTypeManagementPanel"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-Settings"},i.createElement(U.e,{className:"ms-ContentTypeManagementPanel-Settings-Title",role:"heading","aria-level":3},t.settingsTitle),i.createElement("div",{className:"ms-ContentTypeManagementPanel-Settings-Subtitle"},t.settingsSubtitle),i.createElement(O.e,{checked:this.state.isContentTypeSettingsCheckboxEnabled,onChange:this._onContentTypesSettingsChanged,className:"ms-ContentTypeManagementPanel-Settings-Checkbox",label:t.allowContentTypesLabel,ariaLabel:t.allowContentTypesLabel,componentRef:this._resolveRef("_checkbox")})));var n=[],s=void 0;this.state.availableContentTypes.forEach(function(t){e.state.selectedContentTypesIds.find(function(e){return e===t.id})&&n.push(H.e(t));e.state.isSelectedAnAddedContentType||t.id!==e.state.selectedContentTypeToViewInfoId||(s=H.e(t))});if(this.state.isSelectedAnAddedContentType)for(var o=0;o<this.state.addedContentTypes.length;o++)if(this.state.addedContentTypes[o].id===this.state.selectedContentTypeToViewInfoId){s=H.e(this.state.addedContentTypes[o]);break}var u=this.state.availableContentTypes.map(function(t){return{key:t.id,text:t.name,selected:void 0!==e.state.selectedContentTypesIds.find(function(e){return e===t.id})}}),a=[{key:"checkbox",name:"Checkbox",fieldName:"",minWidth:20,onRender:function(t){return i.createElement(O.e,{checked:!0,onChange:e._handleListCheckboxChangeWrapper(t.id),className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox",ariaLabel:t.name})}},{key:"button",name:"Button",fieldName:"",minWidth:20,className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell",styles:{root:{width:"100%"}},onRender:function(t){return i.createElement(L.e,{text:t.name,className:"ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton",onClick:function(){return e._handleSelect(t.id)},styles:{label:{fontWeight:400}}})}}],f=new K.e;f.setItems(n.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{key:e.id})}));return i.createElement("div",{className:"ms-ContentTypeManagementPanel"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel"},i.createElement("div",{role:"form"},i.createElement("div",null,i.createElement("span",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Title"},t.title),E.e.isFeatureEnabled(Z)&&i.createElement(R.e,{iconProps:{iconName:"Settings"},className:"ms-ContentTypeManagementPanel-PrimaryPanel-SettingsIcon",onClick:this._onOpenSettingsPane,styles:{root:{fontSize:14}}})),i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown"},i.createElement(A.e,{placeholder:t.dropdownNoneLabel,label:t.dropdownLabel,selectedKeys:Object(r.__spreadArrays)(this.state.selectedContentTypesIds),onChange:this._handleDropdownChange,multiSelect:!0,options:u,onRenderTitle:this._onRenderDropdownTitle,disabled:0===this.state.availableContentTypes.length,componentRef:this._resolveRef("_dropdown"),styles:{label:{color:"#323130"}}})),i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container"},i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentTypes"},i.createElement(W.e,{direction:X.e.vertical,isCircularNavigation:!0,isInnerZoneKeystroke:this._isInnerZoneKeystroke,role:"grid"},n.map(function(t,n){return i.createElement(Q.e,{key:t.id,item:Object(r.__assign)(Object(r.__assign)({},t),{key:t.id}),itemIndex:n,columns:a,selectionMode:G.t.none,selection:f,styles:{root:{display:"block",width:"100%",height:"36px",border:"none",backgroundColor:e.state.selectedContentTypeToViewInfoId===t.id?"#F3F2F1":void 0},cell:{padding:"0px"}}})}))),this.state.addedContentTypes.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label"},i.createElement("b",null,t.addedContentTypes)),i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes"},i.createElement(W.e,{direction:X.e.vertical,isCircularNavigation:!0},i.createElement(V.e,{items:this.state.addedContentTypes.map(function(t){return Object(r.__assign)(Object(r.__assign)({},t),{isSelected:e.state.selectedContentTypeToViewInfoId&&e.state.selectedContentTypeToViewInfoId===t.id})}),onRenderCell:this._onRenderAddedCTItem}))))))),i.createElement(z.e,{vertical:!0}),i.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel"},i.createElement(q,{selectedContentTypeToViewInfo:s||void 0,isSelectedAnAddedContentType:this.state.isSelectedAnAddedContentType,strings:this.props.strings,errorStrings:this.props.errorStrings,cannotBeRemovedError:this.state.cannotBeRemovedError,handleCreateNewViewToggle:this._handleCreateNewViewToggle,handleAddColumnsToCurrentViewToggle:this._handleAddColumnsToCurrentViewToggle,removeContentType:this._handleRemoveContentTypeClick,dismissErrorMessage:this._dismissError})))};t.prototype._getAriaLabelforAddedCT=function(e,t){try{return I.format(this.props.strings.ariaLabelAddedCT,e,t,this.state.addedContentTypes.length)}catch(e){}};return t})(Y.e),te={ODB:60122},ne=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addPublishledContentTypes=function(e,t){e.forEach(function(e){e.createNewView=!0;e.addColumnsToCurrentView=!1;e.isFromContentTypeHub=!1});t.forEach(function(t){t.createNewView=!0;t.addColumnsToCurrentView=!1;t.isFromContentTypeHub=!0;0===e.filter(function(e){return e.id===t.id}).length&&e.push(t)});e=e.sort(function(e,t){return e.name.localeCompare(t.name)})};n.addContentTypesToList=function(e){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{showSpinner:!0,spinnerText:n.props.strings.applyingContentTypesSpinner}));n.props.addContentTypesToList(e)};n.onContentTypeSelected=function(e){return n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{selectedContentTypeIds:e}))};n.onErrorOccured=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{hasErrorOccurred:!0}))};n.onOpenSettingsPane=function(){n.setState({isContentTypeSettingsPane:!0})};n.onContentTypesSettingsChanged=function(e){n.setState({isContentTypeSettingsCheckboxEnabled:e})};n._renderFooterButtons=function(){return i.createElement(i.Fragment,null,E.e.isFeatureEnabled(te)&&n.state.isContentTypeSettingsPane?i.createElement(k.e,{className:"ms-ContentTypeManagementPanel-Button",onClick:n._handleSaveSettingsClick,disabled:n.state.isContentTypeSettingsEnabled===n.state.isContentTypeSettingsCheckboxEnabled},n.props.strings.saveButtonLabel):i.createElement(k.e,{className:"ms-ContentTypeManagementPanel-Button",onClick:n._handleApplyClick,disabled:0===n.state.selectedContentTypeIds.length||n.state.showSpinner},n.props.strings.applyButtonLabel),i.createElement(L.e,{className:"ms-ContentTypeManagementPanel-Button ms-ContentTypeManagementPanel-CancelButton",onClick:n._handleCancelClick},n.props.strings.cancelButtonLabel))};n._handleApplyClick=function(){var e=n._content.current.getSelectedContentTypesWithView();u.e.logData({name:"ContentTypeManagementPanel.ApplyClick",extraData:{countContentTypes:e.length}});n.addContentTypesToList(e)};n._handleSaveSettingsClick=function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:u.e.logData({name:"ContentTypeManagementPanel.SaveSettingsClick",extraData:{enableContentTypeSettings:this.state.isContentTypeSettingsCheckboxEnabled}});this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showSpinner:!0,spinnerText:this.props.strings.saveContentTypesSettingsSpinner}));return[4,this.props.updateListSettings({ContentTypesEnabled:this.state.isContentTypeSettingsCheckboxEnabled})];case 1:t.sent();return[4,this.props.getListData()];case 2:(e=t.sent())&&e.list&&e.list.contentTypesEnabled?this.setState({isContentTypeSettingsEnabled:!0,initialLoadComplete:!1,isContentTypeSettingsPane:!1,spinnerText:this.props.strings.loadingContentTypesSpinner}):this.props.onDismiss();return[2]}})})};n._handleCancelClick=function(){u.e.logData({name:"ContentTypeManagementPanel.CancelClick"});n.props.onDismiss()};n._content=i.createRef();n.state={showSpinner:!0,spinnerText:t.strings.loadingContentTypesSpinner,hasErrorOccurred:n.props.hasErrorOccurred,siteContentTypes:[],listContentTypes:[],selectedContentTypeIds:[],initialLoadComplete:!1,isContentTypeHub:!1,isContentTypeSettingsEnabled:t.isContentTypeEnabled,isContentTypeSettingsCheckboxEnabled:t.isContentTypeEnabled,isContentTypeSettingsPane:!t.isContentTypeEnabled};return n}t.prototype.componentDidMount=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,12,,13]);e=[];t=[];n=[];i=!1;s=this.props.pageContext.webServerRelativeUrl;o=new y.e({name:"ContentTypeManagementPanel.PublishedContentTypeFromHub"});s&&s.toLowerCase().startsWith("/sites/contenttypehub")&&(i=!0);return E.e.isFeatureEnabled(te)?this.state.isContentTypeSettingsEnabled?[4,this.props.getSiteContentTypes()]:[3,7]:[3,8];case 1:e=r.sent();return[4,this.props.getListContentTypes()];case 2:t=r.sent();r.label=3;case 3:r.trys.push([3,6,,7]);return i?[3,5]:[4,this.props.getPublishedContentTypesFromHub()];case 4:n=r.sent();o.end({resultType:b.e.Success,extraData:{siteId:this.props.pageContext.siteId,webId:this.props.pageContext.webId}});r.label=5;case 5:return[3,7];case 6:u=r.sent();o.end({resultType:b.e.Failure,error:u,extraData:{siteId:this.props.pageContext.siteId,webId:this.props.pageContext.webId}});return[3,7];case 7:return[3,11];case 8:return[4,this.props.getSiteContentTypes()];case 9:e=r.sent();return[4,this.props.getListContentTypes()];case 10:t=r.sent();r.label=11;case 11:this.addPublishledContentTypes(e,n);this.setState({showSpinner:!1,spinnerText:"",initialLoadComplete:!0,siteContentTypes:e,listContentTypes:t,isContentTypeHub:i});return[3,13];case 12:r.sent();this.setState({showSpinner:!1,hasErrorOccurred:!0});return[3,13];case 13:return[2]}})})};t.prototype.componentDidUpdate=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:this.props.panelProps.isOpen&&this.state.initialLoadComplete&&setTimeout(function(){var e,t;E.e.isFeatureEnabled(te)&&o.state.isContentTypeSettingsPane?o._content&&(null===(e=o._content.current)||void 0===e||e.focusFirstSettingsPaneElement()):o._content&&(null===(t=o._content.current)||void 0===t||t.focusFirstElement())},25);return E.e.isFeatureEnabled(te)&&!this.state.initialLoadComplete&&this.state.isContentTypeSettingsEnabled?[4,this.props.getSiteContentTypes()]:[3,8];case 1:e=r.sent();return[4,this.props.getListContentTypes()];case 2:t=r.sent();n=[];i=new y.e({name:"ContentTypeManagementPanel.PublishedContentTypeFromHub"});r.label=3;case 3:r.trys.push([3,6,,7]);return this.state.isContentTypeHub?[3,5]:[4,this.props.getPublishedContentTypesFromHub()];case 4:n=r.sent();i.end({resultType:b.e.Success,extraData:{siteId:this.props.pageContext.siteId,webId:this.props.pageContext.webId}});r.label=5;case 5:return[3,7];case 6:s=r.sent();i.end({resultType:b.e.Failure,error:s,extraData:{siteId:this.props.pageContext.siteId,webId:this.props.pageContext.webId}});return[3,7];case 7:this.addPublishledContentTypes(e,n);this.setState({showSpinner:!1,spinnerText:"",initialLoadComplete:!0,siteContentTypes:e,listContentTypes:t});r.label=8;case 8:return[2]}})})};t.getDerivedStateFromProps=function(e,t){return Object(r.__assign)(Object(r.__assign)({},t),{showSpinner:!e.hasErrorOccurred&&t.showSpinner,hasErrorOccurred:t.hasErrorOccurred||e.hasErrorOccurred})};t.prototype.render=function(){var e=Object(r.__assign)(Object(r.__assign)({},this.props.panelProps),{type:E.e.isFeatureEnabled(te)&&this.state.isContentTypeSettingsPane?a.e.medium:a.e.custom});return i.createElement("div",null,i.createElement(T.e,Object(r.__assign)({},e),this.state.showSpinner&&i.createElement(N.e,{size:C.e.large,label:this.state.spinnerText,className:"ms-ContentTypeManagementPanel-Spinner"}),!this.state.showSpinner&&i.createElement(ee,{ref:this._content,availableContentTypes:this.state.siteContentTypes,addedContentTypes:this.state.listContentTypes,strings:this.props.strings,errorStrings:this.props.errorStrings,hasErrorOccurred:this.state.hasErrorOccurred,onContentTypeSelected:this.onContentTypeSelected,onOpenSettingsPane:this.onOpenSettingsPane,getContentType:this.props.getSiteContentType,getContentTypeColumns:this.props.getContentTypeColumns,getContentTypeColumnsFromHub:this.props.getContentTypeColumnsFromHub,getListContentTypeColumns:this.props.getListContentTypeColumns,removeContentType:this.props.removeContentType,onDismiss:this.props.onDismiss,onError:this.onErrorOccured,isContentTypeHub:this.state.isContentTypeHub,isContentTypeSettingsPane:this.state.isContentTypeSettingsPane,isContentTypeSettingsCheckboxEnabled:this.state.isContentTypeSettingsCheckboxEnabled,onContentTypesSettingsChanged:this.onContentTypesSettingsChanged}),i.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Buttons",role:"complimentary"},this.state.initialLoadComplete&&this._renderFooterButtons())))};return t})(i.PureComponent),re=n(3898),ie=n(3899),se=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;u.e.logData({name:"ContentTypeManagementPanel.PanelOpened"});n._state=new x({contentTypeManagementPanelContainer:n,strings:Object(r.__assign)({},re.e),errorStrings:Object(r.__assign)({},ie.e)});return n}t.prototype.render=function(){var e=this._state.getRenderProps();return i.createElement(ne,Object(r.__assign)({},e))};return t})(i.Component),oe=n(40),ue=n(5),ae=n(146),fe=n(175),le=n(51),ce=n(82),he=n(9),pe=n(2),de=n(123),ve=n(193),me=n(138),ge=n(103),ye=n(133),be=n(764),we=n(36),Ee=n(2854),Se=n(280),xe=n(11),Te=n(2795),Ne=n(16),Ce=n(598),ke=n(2138),Le=n(3415),Ae=n(130),Oe=n(1044),Me=n(106);var _e,De,Pe=n(3900),He=((_e={})[ce.r.started]=function(e){var t=e.count;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddStartedItemsTitle,Pe.e.contentTypesAddStartedItemsTitleIntervals,t)||"",t)},_e[ce.r.completed]=function(e){var t=e.count;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddCompletedItemsTitle,Pe.e.contentTypesAddCompletedItemsTitleIntervals,t)||"",t)},_e[ce.r.failed]=function(e){var t=e.count;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddFailedItemsTitle,Pe.e.contentTypesAddFailedItemsTitleIntervals,t)||"",t)},_e[ce.r.canceled]=function(e){var t=e.count;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddFailedItemsTitle,Pe.e.contentTypesAddFailedItemsTitleIntervals,t)||"",t)},_e),Be=((De={})[ce.r.started]=function(e){var t=e.count,n=e.itemKey;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddStartedItemsDestinationTitle,Pe.e.contentTypesAddStartedItemsDestinationTitleIntervals,t)||"",t,i.createElement(Te.e,{key:"link",itemKey:n}))},De[ce.r.completed]=function(e){var t=e.count,n=e.itemKey;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddCompletedItemsDestinationTitle,Pe.e.contentTypesAddCompletedItemsDestinationTitleIntervals,t)||"",t,i.createElement(Te.e,{key:"link",itemKey:n}))},De[ce.r.failed]=function(e){var t=e.count,n=e.itemKey;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddFailedItemsDestinationTitle,Pe.e.contentTypesAddFailedItemsDestinationTitleIntervals,t)||"",t,i.createElement(Te.e,{key:"link",itemKey:n}))},De[ce.r.canceled]=function(e){var t=e.count,n=e.itemKey;return Object(I.formatToArray)(Object(I.getLocalizedCountValue)(Pe.e.contentTypesAddFailedItemsDestinationTitle,Pe.e.contentTypesAddFailedItemsDestinationTitleIntervals,t)||"",t,i.createElement(Te.e,{key:"link",itemKey:n}))},De),je=Object(Ne.t)(function(){return function(e){e(Object(Se.e)(Ee.t,Ce.e)(Object(xe.t)()(Fe)));e(Object(me.s)(Ee.t,ke.t)((Ee.t,t=Ee.e,Object(Ne.n)()(function(e){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:n=i(Object(de.e)(function(n){var i={operationTypeFacet:Ee.e,items:{}},s=new ve.e;function o(e){var o,u,a=n.demandItemFacet(ce.g,e),f=a&&a.itemKey,l=n.demandItemFacet(t,e),c=Object(ye.i)(n,{itemKey:e}).phase,h=Ee.t.deserialize(e).taskKey,p=Oe.e.deserialize(h),d=Me.e.serialize(p.listKey);if(f&&l&&d&&"failed"===c){i.items[d]=((o={})[f]=Object(r.__assign)(Object(r.__assign)({},l),{progressItemKey:e}),o);s.resolveItems({items:(u={},u[e]=Object(r.__assign)({},Object(pe.n)({error:Ae.e},{error:new we.o})),u)})}}for(var u=0,a=Object.keys(e.items);u<a.length;u++)o(a[u]);return{itemResolver:s,operationPayload:i}}));i(n.itemResolver.execute());s=i(Object(me.o)(n.operationPayload)),o=s.completed,u=s.items;for(a=0,f=Object.keys(u);a<f.length;a++){l=f[a];c=u[l],h=c.started,p=c.completed;for(d=0,v=Object.keys(n.operationPayload.items[l]);d<v.length;d++){m=v[d];(g=n.operationPayload.items[l][m].progressItemKey)&&i(Object(ye.f)({progressItemKey:g,started:h,completed:p}))}}return[4,o];case 1:y.sent();return[2]}})})}}))));var t}});function Fe(){return function(e){return Ie}}function Ie(e,t){var n,s,o=Object(ye.i)(e,t),u=o.phase,a=o.count,f=e.demandItemFacet(ce.o,t.itemKey),l=f&&f.itemKey,c=[];if("group"===t.format){if(t.itemCountsByPhase.started+t.itemCountsByPhase.created>0){var h=a-t.itemCountsByPhase.started-t.itemCountsByPhase.created-t.itemCountsByPhase.failed;n=Object(I.format)(Pe.e.contentTypeAddedGroupDescription,h,a)}}else if("item"===t.format)if(u===ce.r.completed)n=i.createElement(i.Fragment,null,Pe.e.contentTypeAddCompletedDescription);else if(u===ce.r.failed){n=i.createElement(i.Fragment,null,Pe.e.contentTypeAddFailedDescription);c.push(Le.e)}else n=i.createElement(i.Fragment,null,Pe.e.contentTypeAddStartedDescription);s="group"===t.format&&l?Be[u]({count:a,itemKey:l}):He[u]({count:a});return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s&&"item"!==t.format?{title:s}:{}),n?{description:n}:{}),c?{commands:c}:{})}var qe=Object(ge.t)(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;return Object(r.__generator)(this,function(L){switch(L.label){case 0:n=[];t(je);i=0,s=Object.keys(e.items);L.label=1;case 1:if(!(i<s.length))return[3,4];o=s[i];u=e.items[o];a=ye.u.serializeNext();f=Ee.t.serializeBatchKey(a);l=[];c=new ve.e;for(h=0,p=Object.keys(u);h<p.length;h++){m=p[h];g=((S={})[m]=u[m],S);y=Ee.t.serializeTaskKey(a,m,g);c.resolveItems({items:(x={},x[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ce.g.pack({itemKey:m})),Object(pe.n)({options:Ee.e},{options:g})),ce.v.pack(ce.r.created)),x)});l.push(y)}c.resolveItems({items:(T={},T[ye.a]=Object(pe.n)({childItems:he.e},{childItems:{itemKeys:new we.e([f],function(e){return e})}}),T[f]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(pe.n)({childItems:he.e},{childItems:{itemKeys:new we.e(l,function(e){return e})}})),ce.o.pack({itemKey:o})),le.s.pack(!0)),T)});t(c.execute());for(d=0,v=Object.keys(u);d<v.length;d++){m=v[d];g=((N={})[m]=u[m],N);y=Ee.t.serializeTaskKey(a,m,g);b=t(Object(me.o)({operationTypeFacet:Ee.e,items:(C={},C[o]=(k={},k[m]=Object(r.__assign)(Object(r.__assign)({},g),{progressItemKey:y}),k),C)})),w=b.completed,E=b.items;t(Object(ye.f)(Object(r.__assign)(Object(r.__assign)({progressItemKey:y},E[o]),{onStarted:function(e){},onCompleted:function(e){},onFailed:function(e,n){t(Object(de.e)(function(t){return t.demandItemFacet(ce.v,e.progressItemKey)}))===ce.r.failed&&n&&n(e)}})));n.push(w)}return[4,Object(be.e)(n)];case 2:L.sent();L.label=3;case 3:i++;return[3,1];case 4:return[2]}})})}}),Re=n(46),Ue=n(110),ze=n(939),We=n(956),Xe=n(1792),Ve=n(64),$e=n(189),Je=n(1),Ke=n(1177),Qe=n(97),Ge=n(73),Ye=n(462),Ze=n(65),et=n(1842),tt=n(127),nt=n(117),rt=n(8);n.d(t,"LaunchContentTypeManagementPanelActionBase",function(){return ot});n.d(t,"LaunchContentTypeManagementPanelAction",function(){return ut});var it={ODB:60122},st=function(e,t,n,r,o,u,a,f){return Object(s.o)(function(s){var l=s.resolve;s.reject;return i.createElement(se,{resolve:l,pageContext:e,contentTypesEnabled:n,views:t,onSuccess:r,getOAuthToken:o,updateViewWithNewColumns:u,updateContentTypeSettings:a,onContentTypesAddToList:f})})},ot=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.onSuccess=function(e){var t=n._columnActionsHelper.getAddOrRemoveFromViewAction(void 0,e);new(n.props.resources.injected(t.action))(t.params).execute(null).done(function(){n._columnActionsHelper.invalidateInfoPaneCache()},function(){});n._isItemsScopeEnabled()&&n.props.resources.consumeAsync(We.e).then(function(e){e.invalidateCurrentItemSet();e.invalidateCurrentView();e.invalidateAvailableViews();e.invalidateListContentTypes()})};n.getOAuthToken=function(){return n.props.resources.consumeAsync(Qe.E.bypass).then(function(e){if(!e.getSharePointToken){n._engagement.logData({name:"LaunchContentTypeManagementPanelAction.ErrorInGettInGettingIdentityDataSource"});return"No IdentityDataSource"}return e.getSharePointToken(Object(Ge.r)(n.props.pageContext||{})).then(function(e){return e.accessToken})})};n._isItemsScopeEnabled=t.resources.consume(ze.h.lazy);n._columnActionsHelper=t.resources.consume(Xe.e);n._engagement=t.resources.consume(Ye.e);return n}t.prototype.render=function(){var e=this.props,t=e.pageContext,n=e.isAvailable,r=e.views,s=e.contentTypesEnabled,u=e.updateViewWithNewColumns,a=e.updateContentTypeSettings,f=e.onContentTypesAddToList;return t?i.createElement(o.e,{isAvailable:n,onExecute:st(t,r,s,this.onSuccess,this.getOAuthToken,u,a,f)}):null};return t})(i.PureComponent);var ut=Object(oe.e)(function(e){var t,n=this,i=Object(ae.e)(e),s=Object(Ze.e)(e),o=e.demandItemFacet(Ve.e,i),u=o&&Ke.e.serialize(o),a=o&&Me.e.serialize(o),f=e.demandItemFacet(Je.Be,a),l=e.dispatch,c=void 0;if(o){var h={webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},p=Ke.e.serialize(h),d=e.demandItemFacet(he.e,p),v=d&&d.itemKeys;c=v&&v.map(function(t){return e.demandItemFacet(Je.wt,t)})}var m=!!rt.e.isActivated("60f05460-551b-43bb-bd35-c9c9870d91fc","2/12/2020","Hide command to users who do not have manage lists permissions")||f&&(null===(t=f.permissions)||void 0===t?void 0:t.manageLists);E.e.isFeatureEnabled(it)||(m=m&&f&&f.contentTypesEnabled);return{pageContext:Object(Re.e)(e,i),isAvailable:m,views:c,contentTypesEnabled:f&&f.contentTypesEnabled,updateViewWithNewColumns:function(e,t){var n,r,o=$e.e.serialize({viewId:e}),a=l(Object(nt.e)({derivedView:Je.v},o)).derivedView;if(a){a.replaceFields(t);s&&i&&u&&l(Object(et.e)({items:(n={},n[u]={views:(r={},r[o]={shouldSaveViewFieldsOnly:!0},r),qosName:"saveViewFieldsFromLaunchContentTypeManagementPanel"},n)}))}},updateContentTypeSettings:function(e){var t;a&&l(Object(fe.e)({items:(t={},t[a]=Object(r.__assign)({},Je.Be.pack(Object(r.__assign)(Object(r.__assign)({},f),{contentTypesEnabled:e}))),t)}))},onContentTypesAddToList:function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=new ve.e;n=[];e.forEach(function(e){var i,s=Oe.e.serialize({listKey:{webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},contentTypeId:e.id});t.resolveItems({items:(i={},i[s]=Object(r.__assign)(Object(r.__assign)({},ue.l.pack(e.name)),Je.Ne.pack(e.isFromContentTypeHub)),i)});n.push(s)});l(t.execute());return[4,l(qe({items:(i={},i[a]=Object(tt.e)(n,function(){return{}}),i)}))];case 1:s.sent();return[2]}})})}}})(Object(Ue.r)()(ot))}}]);