(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["96"],{"1484":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(28),o=n(110),u=n(1669),a=n(2555),f=n(1781),l=n(132),c=n(83),h=n(189),p=n(106),d=n(1177),v=n(1),m=n(1842),g=n(123),y=n(668),b=n(1673),w=n(198),E=n(939),S=n(1575),x=n(1590),T=n(1580),N=n(89),C=n(997);var k=n(8);n.d(t,"LaunchColumnsEditorPanelAction",function(){return A});var L=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._panelProvider=n.props.resources.consume(u.e);n._updateItemsScopeCurrentDerivedView=n.props.resources.consume(f.e);n._operationProvider=n.props.resources.consume(x.e);n._resources=n.props.resources;return n}t.prototype.render=function(){var e=this;return i.createElement(s.e,{isAvailable:!0,onExecute:function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,t,n=this;return Object(r.__generator)(this,function(r){e=this._resources.consume(w.e.optional);k.e.isActivated("22C304AE-F92B-4C31-8B42-B7BDD4857F31","10/22/2020","Add Spartan list ColumnsEdtior panel")&&"SpartanList"!==(null==e?void 0:e.hostName)?t=this._panelProvider.requestPanel({hasCommandBar:!0,component:{name:a.e.tagName,params:{onComplete:function(e){var r=!1;n._updateItemsScopeCurrentDerivedView(function(t){r=t.isDirty();t.replaceFields(e);return t});var i=n.props.resources.consume(E.h);Object(l.isFeatureEnabled)(l.ColumnFieldsAutoSave)&&i&&n.props.resources.consumeAsync(y.e).then(function(e){n.props.resources.consumeAsync(b.e).then(function(t){var i,s,o=e.dispatch(Object(g.e)(function(e){var n=e.demandItemFacet(c.e,t.peek());return{setKey:n,viewKey:n&&n.viewKey&&h.e.serialize(n.viewKey)}}));if(o.setKey&&o.viewKey){if(e.dispatch(Object(g.e)(function(e){var t=e.demandItemFacet(v.Be,p.e.serialize({webAbsoluteUrl:o.setKey.webAbsoluteUrl,listFullUrl:o.setKey.listFullUrl}));return!!(t&&t.permissions&&t.permissions.manageLists)}))){var u=n._operationProvider.register({name:"",type:S.e.editViewColumns,payloads:{}});u.state(T.e.started);e.dispatch(Object(m.e)({items:(i={},i[d.e.serialize(o.setKey)]={views:(s={},s[o.viewKey]={shouldSaveViewFieldsOnly:!0},s),qosName:"autoSaveShowHide"},i)})).then(function(){!1===r&&n._updateItemsScopeCurrentDerivedView(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});u.state(T.e.completed)},function(e){N.e.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});n._updateItemsScopeCurrentDerivedView(function(e){e.setIsDirty(!0);return e});u.state(T.e.failed);throw e})}}})});t.state(1)}}}}):(i=this.props.resources,s=i.consume(u.e),o=i.consume(f.e),L=i.consume(x.e),A=i.consume(C.e.optional),(O=s.requestPanel({hasCommandBar:!0,component:{name:a.e.tagName,params:{onComplete:function(e){var t=!1;o(function(n){t=n.isDirty();n.replaceFields(e);return n});var n=i.consume(E.h);Object(l.isFeatureEnabled)(l.ColumnFieldsAutoSave)&&n&&i.consumeAsync(y.e).then(function(e){i.consumeAsync(b.e).then(function(n){var r,i,s=e.dispatch(Object(g.e)(function(e){var t=e.demandItemFacet(c.e,n.peek());return{setKey:t,viewKey:t&&t.viewKey&&h.e.serialize(t.viewKey)}}));if(s.setKey&&s.viewKey&&e.dispatch(Object(g.e)(function(e){var t=e.demandItemFacet(v.Be,p.e.serialize({webAbsoluteUrl:s.setKey.webAbsoluteUrl,listFullUrl:s.setKey.listFullUrl}));return!!(t&&t.permissions&&t.permissions.manageLists)}))){var u=L.register({name:"",type:S.e.editViewColumns,payloads:{}});u.state(T.e.started);e.dispatch(Object(m.e)({items:(r={},r[d.e.serialize(s.setKey)]={views:(i={},i[s.viewKey]={shouldSaveViewFieldsOnly:!0},i),qosName:"autoSaveShowHide"},r)})).then(function(){!1===t&&o(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});null==A||A.sendCommand({command:"columnsEditorChanged",payload:""});O.state(1);u.state(T.e.completed)},function(e){N.e.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});o(function(e){e.setIsDirty(!0);return e});u.state(T.e.failed);null==A||A.sendCommand({command:"onColumnsEditorError",payload:""});throw e})}})});A||O.state(1)}}}})).wait().then(function(){null==A||A.sendCommand({command:"closePanel",payload:""})}));var i,s,o,L,A,O;return[2]})})}})};return t})(i.PureComponent),A=Object(o.r)()(L)},"1585":function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("knockout-lib"),s=n(1382),o=n(183),u=n(1566),a=n(102),f=n(158),l=n(30),c=n(97),h=n(54),p=n(7),d=n(248),v=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._currentView=n.currentView;r._currentItem=n.currentItem;r._itemUrlHelper=n.itemUrlHelper;r._itemParentHelper=n.itemParentHelper;r._pageContext=n.pageContext;r._newDocumentTemplates=n.newDocumentTemplates;r.fields=r.observables.createArray([]);r.views=r.observables.createArray([]);r._deletedViewIds=[];return r}t.prototype.updateTemplates=function(e){var t=this,r=this._currentView.peek();if(!r.isDefault)for(var i=0,s=this.views.peek();i<s.length;i++){var o=s[i];if(o.isDefault){r=o;break}}var u,a=r.getDomParts().newDocumentTemplates;a&&(u=a.textContent);n.e("279").then(n.bind(null,1683)).then(d.e).then(function(n){try{t._saveTemplatesToView(JSON.parse(u),e,n)}catch(r){t._saveTemplatesToView(n.getTemplates(),e,n)}})};t.prototype.getView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.getView(e,t._getListUrl())}).then(function(e){t.registerView(e);return e})};t.prototype.getFields=function(e){var t=this;return e?this._getListDataSourceExtension().then(function(e){return e.getFields(t._getListUrl()).then(function(e){t.fields(e);return e})}):h.n.wrap(this.fields.peek())};t.prototype.getCurrentListUrl=function(e){var t=e?this._currentItem():this._currentItem.peek(),n=t&&this._itemUrlHelper.getItemUrlParts(t.key);return n&&n.fullListUrl};t.prototype.registerView=function(e){if(-1===this._deletedViewIds.indexOf(e.id)){for(var t=this.views.peek(),n=!1,r=0;r<t.length;r++){var i=t[r];if(e===i){n=!0;break}if(i.id===e.id){t.splice(r,1);break}}n||this._insertViewSorted(e)}};t.prototype.getViews=function(e,t){var n=this;if(e){var r=this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem.peek(),"list"),s=this.peekUnwrapObservable(r),o=s&&s.list.templateType,u=t||this._getListUrl();return this._getListDataSource().then(function(e){return e.getViews(u,o)}).then(function(e){var t=n._currentView.peek();if(t){var r=i.utils.arrayFirst(e,function(e){return e.id===t.id});if(r){t.title=r.title;t.isDefault=r.isDefault;t.isDirty()||(t.baseViewXml=r.baseViewXml);n._currentView.valueHasMutated();i.utils.arrayRemoveItem(e,r);e.push(t)}}e.sort(function(e,t){return e.compareTo(t)});n.views(e);return e})}return h.n.wrap(this.views.peek())};t.prototype.createView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.createView(e,t._getListUrl())}).then(function(e){t._insertViewSorted(e);return e})};t.prototype.saveView=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.saveView(e,n._getListUrl(),t)})};t.prototype.deleteView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.deleteView(e,t._getListUrl())}).then(function(){t._deletedViewIds.push(e);t.views.remove(function(t){return t.id===e})})};t.prototype.modifyView=function(e){var t=this;return this._getListDataSource().then(function(n){return n.modifyView(e,t._getListUrl())}).then(function(){for(var n,r,i=t.views.peek(),s=0;s<i.length;s++)if(i[s].id===e.id){n=i[s];r=s;break}if(n){var o=!1;if("boolean"==typeof e.isDefault){if(e.isDefault)for(var u=0,a=i;u<a.length;u++){var f=a[u];if(f.isDefault){f.isDefault=!1;break}}n.isDefault=e.isDefault;o=!0}if("number"==typeof e.scope&&n.scope!==e.scope){n.scope=e.scope;o=!0}if("string"==typeof e.title&&n.title!==e.title){n.title=e.title;i.splice(r,1);t._insertViewSorted(n);o=!1}o&&t.views.valueHasMutated()}})};t.prototype.createMappedView=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.createMappedView(e,t,n._getListUrl())}).then(function(e){n._insertViewSorted(e);return e})};t.prototype.getMappedApp=function(e,t){var n=this;return this._getListDataSource().then(function(r){return r.getMappedApp(e,t,n._getListUrl())})};t.prototype.getMappedApps=function(e){var t=this;return this._getListDataSource().then(function(n){return n.getMappedApps(e,t._getListUrl())})};t.prototype.publishMappedView=function(e,t,n){var r=this;return this._getListDataSource().then(function(e){return e.publishMappedView(t,n,r._getListUrl())}).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};t.prototype.unpublishMappedView=function(e,t,n){var r=this;return this._getListDataSource().then(function(e){return e.unpublishMappedView(t,n,r._getListUrl())}).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};t.prototype.createField=function(e,t,n,r,i){var s=this,o=this._getFieldCreationSchema(e,t,r);return this._getListDataSourceExtension().then(function(e){return e.createField(o,n||s._getListUrl(),i)})};t.prototype.modifyFieldProperties=function(e){var t=this;return this._getListDataSource().then(function(n){return n.modifyFieldProperties(e,t._getListUrl())})};t.prototype.getFieldPropertyAsString=function(e,t){var n=this;return this._getListDataSourceExtension().then(function(r){return r.getField(e,n._getListUrl()).then(function(e){return e[t]})})};t.prototype.setContentApproval=function(e){var t=this;return this._getListDataSource().then(function(n){return n.setContentApproval(e,t._getListUrl())})};t.prototype.ensureSignoffStatusField=function(){var e=this;return this._getListDataSource().then(function(t){return t.ensureSignoffStatusField(e._getListUrl())})};t.prototype.setFieldPropertyValueAsString=function(e,t,n){var r=this;return this._getListDataSourceExtension().then(function(i){return i.setFieldPropertyValueAsString(e,t,n,r._getListUrl())})};t.prototype._getListUrl=function(){var e=this.getCurrentListUrl();if(!e)throw new Error("List URL is not known");return e};t.prototype._insertViewSorted=function(e){for(var t=this.views.peek(),n=!1,r=0;r<t.length;r++)if(e.compareTo(t[r])<1){this.views.splice(r,0,e);n=!0;break}n||this.views.push(e)};t.prototype._getListDataSourceExtension=function(){var e=this,t=h.n.resolve(n.e("45").then(n.bind(null,1618))).then(function(t){var n=t.ListDataSource;return new(e.managed(n))(e._pageContext)});this._getListDataSourceExtension=function(){return t};return t};t.prototype._getFieldCreationSchema=function(e,t,n){var r={Type:t,DisplayName:e,Title:e};n&&(r.StaticName=n);if(t===a.t.User||t===a.t.UserMulti){r.UserSelectionMode="1";r.UserSelectionScope=0}else t===a.t.DateTime&&(r.Format="DateOnly");t===a.t.UserMulti&&(r.Mult=!0);return r};t.prototype._saveTemplatesToView=function(e,t,n){for(var r=this,i=n.getDefaultContentTypeId(),s=n.getDefaultView(this.views.peek()),o=0,u=t;o<u.length;o++){var a=u[o].peek(),f=a.id,l=a.displayName.replace(/\.[^.]+$/,"");e.push({isUpload:!0,visible:!0,title:l,url:f,contentTypeId:i,templateId:l})}s.updateNewDocumentTemplates(n.prepareJsonForSaving(e));this.saveView({sourceView:s,updateViewXml:!0,viewParams:{}},!0).then(function(){r._newDocumentTemplates.valueHasMutated()})};t.prototype._getListDataSource=function(){return this.resources.consumeAsync(c.F)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{pageContext:l.h,currentView:f.l,currentItem:f.o,itemUrlHelper:o.r,itemParentHelper:u.e,newDocumentTemplates:l.l.optional});return t})(s.default),m=Object(p.s)("ListProvider",v)},"1639":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(6),i=n(7),s=new r.t({name:"CommandBar.key",loader:new i.t(function(){return n.e("269").then(n.bind(null,1835)).then(function(e){return e.resourceKey.local})})})},"1756":function(e,t,n){"use strict";var r=n(0),i=n(1563),s=n(1589),o=n("knockout-lib"),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._container=Object(s.t)(n.element);var r=o.unwrap(n.valueAccessor()),i=r.enabled,u=void 0===i?o.observable(!1):i,a=r.y,f=void 0===a?o.observable(0):a;n._enabled=u;n._y=f;n.createComputed(n._computeScrollOnYPosition);return n}t.prototype._computeScrollOnYPosition=function(){var e=this._enabled(),t=this._container;this.async.clearTimeout(this._timeoutId);this._timeoutId=null;if(e){var n=t.getBoundingClientRect(),r=this._y(),i=n.top,s=i+n.height,o=0;r<=i+100?o=-(1-(r-n.top)/100):r>=s-100&&(o=1-(n.top+n.height-r)/100)}if(o){t.scrollTop=Math.min(t.scrollHeight-n.height,Math.max(0,t.scrollTop+15*o));this._timeoutId=this.async.setTimeout(this._computeScrollOnYPosition,30)}};return t})(i.t);t.e=u},"1781":function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(6),s=n(1673),o=n(668),u=n(1),a=n(83),f=n(189),l=n(9),c=n(175),h=n(1239),p=n(123),d=(new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e},create:function(e){var t=e.itemCacheStore;return{instance:function(e){var n=void 0;e&&(n=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(u.wt,e)})));return n}}}}}),new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e,itemsScopeCurrentItemKey:s.e},create:function(e){var t=e.itemCacheStore,n=e.itemsScopeCurrentItemKey;return{instance:function(){var e=n.peek(),r=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(a.e,e)}));return r&&r.viewKey&&f.e.serialize(r.viewKey)}}}}})),v=new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e},create:function(e){var t=e.itemCacheStore;return{instance:function(e){var n=void 0;e&&(n=t.dispatch(Object(p.e)(function(t){return t.demandItemFacet(u.v,e)})));return n}}}}}),m=new i.t({name:"ItemsScopeViewHelper",factory:{dependencies:{itemCacheStore:o.e,itemsScopeCurrentItemKey:s.e,getItemsScopeCurrentViewKey:d,getItemsScopeCurrentDerivedView:v},create:function(e){var t=e.itemCacheStore,n=e.itemsScopeCurrentItemKey,i=e.getItemsScopeCurrentViewKey,s=e.getItemsScopeCurrentDerivedView;return{instance:function(e){var o,a,f=i(),p=s(f);if(p){p=e(p);t.dispatch(Object(c.e)({items:(o={},o[f]=Object(r.__assign)({},u.v.pack(p)),o)}));t.dispatch(Object(h.e)({items:(a={},a[n.peek()]=[l.e],a[f]=[u.v],a)}))}}}}}})},"2555":function(e,t,n){"use strict";var r=n(150);Object(r.n)([{rawString:".od-ColumnsEditor-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0;padding:30px 40px}[dir=ltr] .od-ColumnsEditor-contentContainer{left:0}[dir=rtl] .od-ColumnsEditor-contentContainer{right:0}[dir=ltr] .od-ColumnsEditor-contentContainer{right:0}[dir=rtl] .od-ColumnsEditor-contentContainer{left:0}.od-ColumnsEditor-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:1px;padding:0;background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation:none}}.od-ColumnsEditor-helpText{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-ColumnsEditor-dragProxy,.od-ColumnsEditor-list{font-size:12px;list-style-type:none;padding-left:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:0}.od-ColumnsEditor-listItem{display:block;height:20px;margin:4px 0;outline:0;padding:6px;white-space:nowrap}.od-ColumnsEditor-listItem:not(.is-editable){color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemButtons,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemButtons,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemButtons,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemButtons{display:block}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemLabel,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemLabel,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemLabel,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemLabel{width:150px}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field:before,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-CheckBox-field:before,.od-ColumnsEditor-listItem.is-editable:hover .od-CheckBox-field:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field:before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field.is-checked:before,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-CheckBox-field.is-checked:before,.od-ColumnsEditor-listItem.is-editable:hover .od-CheckBox-field.is-checked:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field.is-checked:before{border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemText,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemText,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemText,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemText{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-ColumnsEditor-listItem.is-editable.is-dragging,.od-ColumnsEditor-listItem.is-editable:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ColumnsEditor-listItem.is-editable .od-ColumnsEditor-itemLabel{cursor:pointer}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem:focus,.od-focus--enabled .od-ColumnsEditor-listItem:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:left}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:right}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel.is-checked{font-weight:600}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{display:none;left:3px;position:relative;top:-6px;width:64px}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:right}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:left}.od-ColumnsEditor-listItem .od-ColumnsEditor-button{background:0 0;border:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:17px;height:32px;line-height:32px;margin:0;outline:0;padding:0;width:32px}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemText{vertical-align:top}.od-ColumnsEditor-listItem .od-CheckBox{min-height:24px;margin-left:1px;display:inline-block;pointer-events:none}.od-ColumnsEditor-listItem .od-CheckBox-field{margin-top:1px}.od-ColumnsEditor-title{margin:0}"}]);var i=n(1642);Object(r.n)([{rawString:".od-Sortable--proxy{position:absolute;z-index:3000}"}]);var s=n(1552),o=n(0),u=n(1756),a=n(942),f=n(1593),l=n(1603),c=n("knockout-lib"),h=n(465),p=n(829),d=n(1589),v=n(1551),m=n(1631),g=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.items,i=t.dragProxyClass,s=void 0===i?void 0:i,o=t.placeholderClass,a=void 0===o?void 0:o;n.addBindingHandlers({autoScroll:u.e,element:f.e,host:l.e});n.overlayTagName=m.e.tagName;n.autoScrollEnabled=c.observable(!1);n.autoScrollY=c.observable(0);n.element=c.observable(null);n.items=r;n.proxyOverlayElement=c.observable(null);n.proxyOverlayVisible=c.observable(!1);n._dragProxyClass=s;n._placeholderClass=a;n._draggables=[];n._scrollParent=n.createPureComputed(function(){if(n.element())return Object(d.t)(n.element())});n.subscribe(n._scrollParent,function(e){n.events.off(e,"scroll",n._onScroll)},!0);n.subscribe(n._scrollParent,function(e){n.events.on(e,"scroll",n._onScroll)});n.events.on(document.body,"dragend",n.onMouseUp);n.events.on(document.body,"mousemove",n._onMouseMove);n.events.on(document.body,"touchmove",n._onTouchMove);n.events.on(document,"mouseup",n.onMouseUp);return n}t.prototype.onAfterMove=function(e,t,n){if(e.nodeType===Node.ELEMENT_NODE){var r=this._getDraggableByData(n);if(r){r.element=e;r.bounds=this._getDraggableBounds(r);r.dataIndex=this.items.peek().indexOf(n)}}};t.prototype.onAfterRender=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.nodeType===Node.ELEMENT_NODE){var s=i.getAttribute("data-draggable");s&&"true"!==s||this._addDraggable(i,t);break}}};t.prototype.onMouseUp=function(e){0===e.button&&this._onDragEnd()};t.prototype.onTouchEnd=function(e){if(this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}var t=!0;this._activeDraggable||(t=!1);this._onDragEnd();return!t};t.prototype._addDraggable=function(e,t){var n={bounds:null,data:t,dataIndex:this.items.peek().indexOf(t),element:e,isDragging:!1};c.utils.domData.set(e,"dragdata",n);this.events.on(e,"mousedown",this._onMouseDown);this.events.on(e,"touchstart",this._onTouchStart);n.bounds=this._getDraggableBounds(n);this._draggables.push(n)};t.prototype._createPlaceholder=function(e){this._placeholder&&this._destroyPlaceholder();var t=e.nodeName.toLowerCase(),n=document.createElement(t);if(this._placeholderClass)a.e.toggleClass(n,this._placeholderClass,!0);else{var r=window.getComputedStyle(e);n.style.margin=r.margin;n.style.padding=r.padding;n.style.width=r.width;n.style.height=r.height}e.parentElement.insertBefore(n,e.nextElementSibling);this._placeholder={baseElement:e,baseElementDisplay:e.style.display,draggable:c.utils.domData.get(e,"dragdata"),element:n};e.style.display="none"};t.prototype._createProxy=function(e,t){this._proxy&&this._destroyProxy();this.proxyOverlayVisible(!0);var n=e.cloneNode(!0),r=window.getComputedStyle(e),i={left:parseInt(r.marginLeft,10)||0,top:parseInt(r.marginTop,10)||0,right:parseInt(r.marginRight,10)||0,bottom:parseInt(r.marginBottom,10)||0};n.removeAttribute("id");n.style.width=r.width;n.style.height=r.height;a.e.toggleClass(n,"is-dragging",!0);a.e.toggleClass(n,"od-Sortable--proxy",!0);this._dragProxyClass&&a.e.toggleClass(n,this._dragProxyClass,!0);var s=e.parentElement,o=e.nextElementSibling;this.proxyOverlayElement.peek().appendChild(n);var u=new h.e(t),f=e.getBoundingClientRect();u=(u=u.subtract(new h.e(f.left,f.top))).add(new h.e(i.left,i.top));var l=new h.e;if(e.offsetParent){var c=e.offsetParent.getBoundingClientRect();l.x=c.left;l.y=c.top}this._proxy={bounds:new p.e(0,0,n.offsetWidth,n.offsetHeight),clickOffset:u,element:n,margins:i,parentOffset:l,parentElement:s,nextElementSibling:o};this._updateProxyPosition(t);this._createPlaceholder(e)};t.prototype._destroyPlaceholder=function(){if(this._placeholder){this._placeholder.element&&this._placeholder.element.parentElement&&this._placeholder.element.parentElement.removeChild(this._placeholder.element);this._placeholder.baseElement&&(this._placeholder.baseElement.style.display=this._placeholder.baseElementDisplay);this._placeholder=null}};t.prototype._destroyProxy=function(){if(this._proxy){var e=this._proxy.element;e&&e.parentElement&&e.parentElement.removeChild(e);this.autoScrollEnabled(!1);this.proxyOverlayVisible(!1);this._proxy=null}};t.prototype._findNearestDraggable=function(){for(var e=null,t=this._proxy.bounds.getCenter(),n=4294967295,r=0,i=this._draggables;r<i.length;r++){var s=i[r],o=s.bounds.getCenter(),u=t.distance(o);if(u<n){n=u;e=s}}return e};t.prototype._getDraggableBounds=function(e){var t=a.e.calculateSubtreeRect(e.element),n=e.element.offsetParent,r=this._scrollParent.peek();if(n&&r){var i=n.getBoundingClientRect();t=(t=t.translate(-i.left,-i.top)).translate(new h.e(r.scrollLeft,r.scrollTop))}return t};t.prototype._getDraggableByData=function(e){for(var t=0,n=this._draggables;t<n.length;t++){var r=n[t];if(r.data===e)return r}return null};t.prototype._onDragEnd=function(){if(this._activeDraggable){if(this._placeholder){var e=this._activeDraggable.dataIndex,t=this._placeholder.draggable.dataIndex;this._destroyProxy();this._destroyPlaceholder();if(e!==t){var n=this.items.peek();n.splice(t,0,n.splice(e,1)[0]);this.items(n)}}this._activeDraggable.isDragging=!1;this._activeDraggable=null}};t.prototype._onDragMove=function(e){if(this._proxy){this._updateProxyPosition(e);this._updatePlaceholder()}this._lastDragOffset=e};t.prototype._onMouseDown=function(e){if(0===e.button){var t=e.currentTarget,n=c.utils.domData.get(t,"dragdata");if(n){this._activeDraggable=n;this._activeDraggable.isDragging=!0;this._startDragPosition=new h.e(e.pageX,e.pageY)}e.preventDefault()}};t.prototype._onMouseMove=function(e){if(this._activeDraggable){var t=new h.e(e.pageX,e.pageY),n=this._startDragPosition.distance(t);!this._proxy&&n>=3&&this._createProxy(this._activeDraggable.element,t);this._onDragMove(t)}};t.prototype._onScroll=function(e){this._lastDragOffset&&this._onDragMove(this._lastDragOffset)};t.prototype._onTouchMove=function(e){var t=e.targetTouches[0],n=new h.e(t.pageX,t.pageY),r=this._startDragPosition.distance(n);if(this._activeDraggable){!this._proxy&&r>=3&&this._createProxy(this._activeDraggable.element,n);this._onDragMove(n);e.preventDefault()}else if(r>5&&this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}};t.prototype._onTouchLongHold=function(e){var t=e.targetTouches[0].target,n=c.utils.domData.get(t,"dragdata");if(n){this._activeDraggable=n;this._activeDraggable.isDragging=!0}this._touchTimerId=void 0};t.prototype._onTouchStart=function(e){var t=e.targetTouches[0];this._touchTimerId&&this.async.clearTimeout(this._touchTimerId);this._startDragPosition=new h.e(t.pageX,t.pageY);this._touchTimerId=this.async.setTimeout(this._onTouchLongHold.bind(this,e),500)};t.prototype._updatePlaceholder=function(){var e=this._findNearestDraggable();if(e&&(!this._placeholder||this._placeholder.draggable!==e)){var t=e.element,n=this._placeholder.element,r=n.parentElement;r.removeChild(n);e.dataIndex<this._activeDraggable.dataIndex?r.insertBefore(n,t):r.insertBefore(n,t.nextElementSibling);this._placeholder.draggable=e}};t.prototype._updateProxyPosition=function(e){var t=new h.e(e),n=this._scrollParent.peek(),r=n?new h.e(n.scrollLeft,n.scrollTop):new h.e,i=t=t.subtract(this._proxy.clickOffset);if(n&&this._proxy&&this._proxy.element&&!h.e.areEqual(this._proxy.bounds.getPoint(),t)){this._proxy.element.style.left=t.x+"px";this._proxy.element.style.top=t.y+"px";t=(t=t.subtract(this._proxy.parentOffset)).add(r);this._proxy.bounds=new p.e(t.x,t.y,this._proxy.bounds.width,this._proxy.bounds.height);this.autoScrollEnabled(!0);this.autoScrollY(i.y)}};return t})(v.t),y=(s.e({tagName:"od-sortable",template:'<div class="od-Sortable" data-bind="autoScroll:{enabled:autoScrollEnabled,y:autoScrollY},element:element,event:{mouseup:onMouseUp.bind($data),touchend:onTouchEnd.bind($data)},foreach:{afterMove:onAfterMove.bind($data),afterRender:onAfterRender.bind($data),data:items}">\x3c!--ko host:{data:{item:$data}}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:proxyOverlayVisible--\x3e\x3c!--ko component:{name:overlayTagName}--\x3e<div class="od-Sortable--proxyOverlay" data-bind="element:proxyOverlayElement"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:g,synchronous:!0}),n(2198)),b=n(1694),w=n(1989),E=n(158),S=n(1822),x=n(462),T=n(1886),N=n(1561),C=n(1572),k=n(1585),L=n(3031),A=n(1701),O=n(2266),M=n(676),_=n(1639),D=n(1555),P=n(128),H={_CopySource:!0,_dlc_DocId:!0,_dlc_DocIdUrl:!0,_ip_UnifiedCompliancePolicyProperties:!0,_ip_UnifiedCompliancePolicyUIAction:!0,_ModerationComments:!0,_UIVersionString:!0,_x0074_wb0:!0,AppAuthor:!0,AppEditor:!0,CheckoutUser:!0,Edit:!0,FileLeafRef:!0,LastSharedByTime:!0,LastSharedByUser:!0,LikesCount:!0,LinkFilenameNoMenu:!0,LinkTitle2:!0,LinkTitleNoMenu:!0,ParentLeafName:!0,ParentVersionString:!0,RatingCount:!0,SharedWithDetails:!0,SharedWithUsers:!0,Title:!0,URLwMenu2:!0,URLNoMenu:!0,URL:!0},B=(function(e){Object(o.__extends)(t,e);function t(n){var r=e.call(this)||this;r.loadingSpinnerTagName=i.e.tagName;r._currentView=r.resources.consume(E.l);r.addBindingHandlers({hasChildFocus:y.e,keyboard:C.e,scrollContainer:d.e,selection:A.e,delayedHasFocus:S.e,control:D.n});r._onComplete=n.onComplete;r.columns=c.observableArray();r.commandSet={commands:c.observableArray([new b.e({text:L.e.columnsEditorApplyCommand,icon:new N.e("CheckMark"),callback:function(){r._applyViewFieldsOverride()}})])};r.commandBarSpecification=Object(D.r)(_.e,{commandSet:r.commandSet});r.focusedColumn=c.observable();r.selectedColumns=c.observableArray();r.selectionModel=new O.e;r.hasData=c.observable(!1);r.strings=L.e;r._dataManager=r.resources.consume(P.t.optional);var s=r.resources.consume(k.e),o=r.resources.consume(E.u),u=r.addDisposable(o().schema.filter(function(e){return t._isColumnVisible(e)})),a=r.addDisposable(u.map(function(e){return r._initializeEditableColumn({checked:c.observable(!0),displayName:e.name||e.internalName,internalName:e.internalName,isEditable:t._isColumnEditable(e)})})),f=r.addDisposable(s.fields.filter(function(e){var t=a().some(function(t){return t.internalName===e.internalName});return e&&!e.isHidden&&!t&&!H[e.internalName]&&-1===M.EXCLUDED_FIELDS.indexOf(e.internalName)})),l=r.addDisposable(f.map(function(e){return r._initializeEditableColumn({checked:c.observable(!1),displayName:r._getDisplayName(e),internalName:e.internalName,isEditable:!0})}));s.getFields(!0).then(function(){r.columns(a().concat(l()));r.hasData(!0)});return r}t._isColumnEditable=function(e){return t._isColumnVisible(e)};t._isColumnVisible=function(e){return e&&(e.isVisible||e.isVisibleMobile)&&"_calloutInvoker"!==e.key&&"_shareHeroCommand"!==e.key&&!!e.internalName&&-1===M.EXCLUDED_FIELDS.indexOf(e.internalName)};t.prototype.onClickMoveUp=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,-1)};t.prototype.onClickMoveDown=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,1)};t.prototype.onToggleCheckbox=function(){var e=this.focusedColumn();e&&e.isEditable&&e.checked(!e.checked());return!1};t.prototype.onKeyEnter=function(e,t){if(T.e(t.target))return!0;var n=this.focusedColumn();n&&n.isEditable&&n.checked(!n.checked());return!1};t.prototype.onKeyLeft=function(e,t){var n=this.focusedColumn();if(n){var r=this.focusedColumn().moveUpFocused;(0,this.focusedColumn().moveDownFocused)()?r(!0):r()&&n.focused(!0)}return!1};t.prototype.onKeyRight=function(e,t){if(this.focusedColumn()){var n=this.focusedColumn().moveUpFocused,r=this.focusedColumn().moveDownFocused;r()||(n()?r(!0):n(!0))}return!1};t.prototype._getDisplayName=function(e){return 1===w.e.getMappedColumnType(e.internalName)?e.internalName:e.title||e.internalName};t.prototype._applyViewFieldsOverride=function(){this.resources.consume(x.e).logData({name:"ColumnsEditor.ApplyViewFields",isIntentional:!0});var e=this._getFieldNames();this._currentView.peek().replaceFields(e);this._currentView.valueHasMutated();this._onComplete&&this._onComplete(e)};t.prototype._getFieldNames=function(){return this.columns().filter(function(e){return e.checked()}).map(function(e){return e.internalName})};t.prototype._initializeEditableColumn=function(e){e.childFocused=c.observable(!1);e.focused=c.observable(!1);e.key=e.internalName;e.moveDownFocused=c.observable(!1);e.moveUpFocused=c.observable(!1);e.selected=c.observable(!1);return e};t.prototype._maintainButtonFocus=function(e){var t=e.moveUpFocused.peek(),n=e.moveDownFocused.peek(),r=this.subscribe(this.focusedColumn,function(i){if(e===i){r.dispose();e.moveUpFocused(!1);e.moveDownFocused(!1);e.moveUpFocused(t);e.moveDownFocused(n)}})};t.prototype._shiftColumnIndex=function(e,t){var n=this.columns(),r=n.indexOf(e),i=r+t;if(r!==(i=Math.max(Math.min(i,n.length-1),0))){var s=n[i];if(e.isEditable&&s.isEditable){n[i]=n[r];n[r]=s;this.columns(n)}}};return t})(v.t),j=s.e({tagName:"ms-columns-editor",template:'<div class="od-ColumnsEditor-commandBar" data-bind="control:commandBarSpecification"></div><div class="od-ColumnsEditor-contentContainer" data-bind="scrollContainer:{}" role="group"><h2 class="od-ColumnsEditor-title ms-font-xl ms-fontWeight-semilight" data-bind="text:strings.columnsEditorTitle"></h2><p id="descriptionList" class="od-ColumnsEditor-helpText" data-bind="text:strings.columnsEditorHelpText"></p>\x3c!--ko if:hasData--\x3e<ol aria-describedby="descriptionList" aria-multiselectable="false" class="od-ColumnsEditor-list" data-bind="keyboard:{allowButtonEvents:true,useRtlMappings:true,mappings:{Enter:onKeyEnter,Space:onKeyEnter,Left:onKeyLeft,Right:onKeyRight}},selection:{data:columns,mode:\'single\',direction:\'vertical\',focused:focusedColumn,selected:selectedColumns,selectionModel:selectionModel,allowInputEvents:true},attr:{tabindex:!focusedColumn()?0:-1},component:{name:\'od-sortable\',params:{dragProxyClass:\'od-ColumnsEditor-dragProxy\',items:columns}}">\x3c!--ko with:$host.item--\x3e<li class="od-ColumnsEditor-listItem" role="checkbox" data-bind="attr:{tabindex:$parent.focusedColumn()===$data?0:-1,\'aria-checked\':checked,\'aria-selected\':selected,\'aria-label\':displayName,\'data-draggable\':String(isEditable)},css:{\'is-childFocused\':childFocused,\'is-editable\':isEditable},hasChildFocus:childFocused,delayedHasFocus:focused"><label class="od-ColumnsEditor-itemLabel"><div class="od-CheckBox"><input tabindex="-1" class="od-CheckBox-input" type="checkbox" data-bind="checked:checked,enable:isEditable"><label class="od-CheckBox-field" data-bind="css:{\'is-checked\':checked}"><span class="od-ColumnsEditor-itemText od-Label" data-bind="attr:{title:displayName},text:displayName"></span></label></div></label>\x3c!--ko if:isEditable--\x3e<div class="od-ColumnsEditor-itemButtons"><button class="od-ColumnsEditor-button" tabindex="-1" data-bind="click:$parent.onClickMoveUp.bind($parent,$data),delayedHasFocus:moveUpFocused,attr:{title:$parent.strings.columnsEditorMoveUpTooltip},keyboard:{mappings:{Space:$parent.onClickMoveUp.bind($parent,$data)}}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronUp" data-bind="icon:true"></i></button><button class="od-ColumnsEditor-button" tabindex="-1" data-bind="click:$parent.onClickMoveDown.bind($parent,$data),delayedHasFocus:moveDownFocused,attr:{title:$parent.strings.columnsEditorMoveDownTooltip},keyboard:{mappings:{Space:$parent.onClickMoveDown.bind($parent,$data)}}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e</ol>\x3c!--/ko--\x3e\x3c!--ko ifnot:hasData--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:strings.columnsEditorLoadingText}}"></span>\x3c!--/ko--\x3e</div>',viewModel:B,synchronous:!0});t.e=j}}]);