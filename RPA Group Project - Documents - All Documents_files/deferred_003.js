(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],Array(1337).concat([function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(524),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})}],Array(15),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(1545),o=n(3586),u=n(2513),a=n(2566),f=n(20),l=n(294),c=n(3981),h=n(966),p=n(18),d=n(72),v=new p.e("dragLayerPreviewControl",{dragLayerPreviewRenderer:Object(d.e)()}),m=n(195),g=n(37),y=n(27);function b(e){var t=e.draggedItem,n=e.dropEffect,r=t.dragSourceKey,s=t.itemKeys,o=void 0===s?[]:s,u=o[0]||r,a=o.length>0?o.length:r?1:0;if(a<1)return null;var p=Object(f.format)(Object(f.getLocalizedCountValue)("copy"===n?c.e.dragCopyItemsPreviewText:c.e.dragMoveItemsPreviewText,"copy"===n?c.e.dragCopyItemsPreviewTextIntervals:c.e.dragMoveItemsPreviewTextIntervals,a)||"",a),d=1===a?i.createElement(h.t,{itemKey:u,size:20,className:"dragPreviewIcon_7aee6371"}):i.createElement(h.e,{type:l.e.genericFile,size:20,className:"dragPreviewIcon_7aee6371"});return p?i.createElement("div",{className:"dragPreviewRoot_7aee6371"},d||null,i.createElement("span",{className:"dragPreviewText_7aee6371"},p)):null}var w=i.memo(function(e){var t=e.draggedItem,n=e.dropEffect,r=i.useCallback(function(e){var r=e.itemCache;if(!t)return null;var s=Object(g.e)(r,{enableDragDropCopy:y.u}).enableDragDropCopy,o=void 0!==s&&s,u=t.dragSourceKey,a=t.itemKeys,f=a||[u],l=r.demandItemFacet(v,u),c=v.evaluate(l)(r,{itemKeys:f,dragLayerPreviewRenderer:b}).dragLayerPreviewRenderer;return i.createElement(c,{draggedItem:t,dropEffect:o?n:"none"})},[t,n]);return i.createElement(m.e,null,r)}),E=n(3982),S=n(511),x=n(122),T=n(168);n.d(t,"DropTargetHook",function(){return N});n.d(t,"DragSourceHook",function(){return C});n.d(t,"DragDropHook",function(){return O});var N=function(e){return i.createElement(o.e,null,i.createElement(u.e,Object(r.__assign)({},e)))};var C=function(e){var t=e.dragSourceKey,n=e.type,s=i.useState(),u=s[0],f=s[1],l=Object(T.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(o.e,null,i.createElement(a.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!u?null:i.createElement(a.e,{dragSourceKey:t,type:n},function(e){return i.createElement(A,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function k(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(w,Object(r.__assign)({},n))}function L(e){var t,n,r=e.draggedItem,s=e.resolve;return i.createElement(o.e,null,i.createElement(a.e,{dragSourceKey:null===(t=r)||void 0===t?void 0:t.dragSourceKey,type:null===(n=r)||void 0===n?void 0:n.type,as:M,getItemStyles:_},function(e){return i.createElement(k,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:s})}))}function A(e){var t=Object(S.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new x.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(L,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var O=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,s=i.useState(),u=s[0],f=s[1],l=Object(T.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(o.e,null,i.createElement(E.e,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!u?null:i.createElement(a.e,{dragSourceKey:t,type:n},function(e){return i.createElement(A,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))}),M=i.forwardRef(function(e,t){return i.createElement(s.e,null,i.createElement("div",{className:e.className,ref:t},e.children))});function _(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}}],Array(69),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return y});var r=n(0),i=n(64),s=n(106),o=n(3038),u=n(16),a=n(117),f=n(2139),l=n(2),c=n(82),h=n(9),p=n(193),d=n(3508),v=n(156),m=n(194),g=n(1),y=Object(u.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,y=i.e.deserialize(n),b=y.webAbsoluteUrl,w=y.listFullUrl,E=Object.keys(u)[0],S=u[E].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=i(Object(a.e)({sourceFile:f.t},E)).sourceFile;u=i(Object(m.e)({listItemUploader:g.qe})).listItemUploader,x=void 0===u?o.e:u;return[4,i(x(e))];case 1:T=M.sent().itemKey;N=new p.e;S&&t&&N.resolveItems({items:(L={},L[S]=Object(r.__assign)(Object(r.__assign)({},c.s.pack({itemKey:T})),Object(l.n)({progressSize:c.m},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[h.t],A)});if(y.listFullUrl){C=new v.e(y.listFullUrl+"/Forms").path;if(y.rootFolder&&(y.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=s.e.serialize({webAbsoluteUrl:b,listFullUrl:w});i(Object(d.e)({items:(O={},O[k]={childItemKey:T},O)}))}}i(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateFolderOperationHandler",function(){return x});n.d(t,"getCreateFolderUrl",function(){return T});var r=n(0),i=n(156),s=n(64),o=n(106),u=n(1),a=n(227),f=n(240),l=n(372),c=n(117),h=n(175),p=n(1239),d=n(16),v=n(82),m=n(9),g=n(5),y=n(822),b=n(249),w=n(39),E=n(3902),S=n(3033),x=Object(d.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,d=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,y,b,S,x,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=Object.keys(d)[0];y=d[t],b=y.progressItemKey,S=y.conflictResolution;x=s.e.deserialize(n);C=x.rootFolder||new i.e(x.listFullUrl).path;k=o.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl});L=e(Object(c.e)({list:u.Be},k));A=Object(E.mapConflictResolutionToNameConflictBehavior)(S);O=T({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,parentFolderPath:C,isDocLib:!!L&&!!L.list&&L.list.isDocumentLibrary,folderName:t,nameConflictBehavior:A});return[4,e(Object(a.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,url:O,method:"POST",qosName:"createFolder",parseResponse:function(e){var t;try{return null===(t=JSON.parse(e))||void 0===t?void 0:t.d}catch(e){}},telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?w.t.expectedFailure:w.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(t){if(t instanceof f.e&&t.message&&C){var n=C;"/"===n[0]&&(n=n.substr(1));"/"!==n[n.length-1]&&(n+="/");t.message=t.message.replace(n,"")}throw new l.e({innerError:t,facets:e(N(t))})})];case 1:M=F.sent();if(b){_=null===(j=M)||void 0===j?void 0:j.Name;D=C+"/"+_;P=s.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,rootFolder:D});e(Object(h.e)({items:(H={},H[b]=Object(r.__assign)(Object(r.__assign)({},v.s.pack({itemKey:P})),_&&t!==_?g.l.pack(_):{}),H[P]=Object(r.__assign)(Object(r.__assign)({},u.fe.pack(D)),g.A.pack({itemKey:n})),H)}))}e(Object(p.e)({items:(B={},B[n]=[m.t],B)}));return[2]}})})}});function T(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.parentFolderPath,s=e.isDocLib,o=void 0===s||s,u=e.folderName,a=e.nameConflictBehavior,f=Object(y.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),l=u?u.trim():"";return(f=o?(f=f.segment("folders")).methodWithAliases("AddUsingPath",Object(r.__assign)({DecodedUrl:i+"/"+l,overwrite:!1},2===a?{EnsureUniqueFileName:!0}:{})).oDataParameter("$Expand","ListItemAllFields/PermMask"):f.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:i}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:l||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function N(e){return function(t){if(e instanceof f.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case Number("-2130575257"):var n=t(Object(S.e)());if(n)return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b.v.pack({})),b.t.pack(n)),b.n.pack(!1));break;case-2147023080:case-2130575282:return b.g.pack({})}}}}},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n(0),i=n(16),s=n(2862);n.d(t,"getCreateDocumentUrl",function(){return s.e});n.d(t,"getRedirectUrlFromResponse",function(){return s.t});var o=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("29")]).then(n.bind(null,4032))];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:t.sent();return[2]}})})}})}],Array(33),[function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return w});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return E});n.d(t,"fetchFileHandlerData",function(){return S});var r=n(0),i=n(16),s=n(2784),o=n(89),u=n(3488),a=n(840),f=n(1674),l=n(2347),c=n(232),h=n(171),p=n(120),d=n(194),v=n(420),m=n(31),g=n(686),y=n(212),b=n(789),w=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){t=e(Object(v.e)({name:"getFileHandlersOperation"}));u={endpoint:s};return[2,e(S(i)).then(function(r){if(r){Object(b.e)({driveAppsKey:i,data:r});e(Object(b.n)(r,n));u.fileHandlerRequestEndpoint=r.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:m.e.Success,extraData:u}))}else e(t({resultType:m.e.Failure,resultCode:"NoFileHandlerData",extraData:u}))}).catch(function(n){o.e.logError(n);e(t({resultType:m.e.Failure,extraData:u}));throw n})]})})}}),E=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=c.t.serialize({endpoint:i});return[4,e(Object(s.e)(function(e){return e.demandItemFacet(h.t,t)}))];case 1:n.sent();return[2]}})})}});function S(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i={endpoint:t,driveId:n},s=e(Object(v.e)({name:"fetchFileHandlerData",extraData:i})),o=e(Object(d.e)({getUserOneDriveEndpoint:p.f,useOneDriveEndpoint:p.N})),c=o.getUserOneDriveEndpoint,h=o.useOneDriveEndpoint,b=Object(a.n)({endpoint:t,driveId:n}),w=new u.e({},{dataRequestor:e(f.e).dataRequestor}),E=Promise.resolve(t);c&&h&&(E=e(c({endpoint:t})));return E.then(function(t){r=t;b=Object(a.n)({endpoint:r});i.fileHandlerRequestEndpoint=r;return e(Object(l.t)(r,b,{qosExtraData:{requestor:"GetFileHandlerData",endPoint:r,driveUrl:b}}))}).then(function(t){i.accessTokenObtained=!!t;return w.getFileHandlerData({accessToken:t,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var o={data:t,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}};e(s({resultType:m.e.Success,extraData:i}));return o}e(s({resultType:m.e.Failure,resultCode:"NoDataFromFileHandlerService",extraData:i}))}).catch(function(t){e(s(Object(g.e)({resultType:m.e.Failure,extraData:i},Object(y.e)(t))));throw t})}).catch(function(t){e(s(Object(g.e)({resultType:m.e.Failure,resultCode:"getSessionTokenError",extraData:i},Object(y.e)(t))));throw t})}}}],Array(14),[function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return p});var r=n(0),i=n(468),s=n(605),o=n(13),u=n(286),a=n(117),f=n(1),l=n(106),c=n(107),h=n(880);function p(e,t,n){var p=l.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=n(Object(a.e)({list:f.Be},p)),v=d&&d.list&&d.list.templateType&&Object(o.s)(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=s.e(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=s.t(T,"Or");if(M){var _=s.t([x,M],"And");y.push(_)}}}0===y.length&&y.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=Object(r.__spreadArrays)(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===o.n.webPageLibrary,F=new i.e("<View Scope='Recursive'/>");j&&c.e.isFeatureEnabled({ODB:1743})?F.title=u.e.PagesThatNeedAttention:F.title=v?u.e.ItemsThatNeedAttention:u.e.FilesThatNeedAttention;F.isReadOnly=!0;F.id=h.e;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=s.t(y,"Or");F.addFilters([I]);return F}},function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(227),s=n(822);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}}],Array(198),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});n.d(t,"i",function(){return w});n.d(t,"s",function(){return E});var r=n(0),i=n(191),s=n(2239),o=n(2347),u=n(532),a=n(440),f=n(469),l=n(194),c=n(1160),h=n(120),p=n(54),d=n(3028),v=n(467),m=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c.e,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType,h=r&&r.cookieOrigin;return{dataRequestor:new s.e({alwaysSendContentType:o},{cookieOrigin:h,apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken,cookieOrigin:h}});function g(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=void 0===c?{}:c,d=e.timeout,g=e.expectedErrors,y=e.driveUrl,b=e.parseResponse,w=e.allowCookies,E=e.apiVersion;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,c,S,x,T,N,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:t=e(m),i=t.dataRequestor,c=t.hasTokenProvider,S=t.cookieOrigin;x=void 0!==typeof u?JSON.stringify(u):void 0;T=new v.e(n).authority;N=S&&T&&S===T;return c||w&&N?[3,2]:[4,e(Object(o.t)(f,y))];case 1:C=O.sent();O.label=2;case 2:k=e(Object(l.e)({clientName:h.t,isClaimsPerSiteEnabled:h.p})),L=k.clientName,A=k.isClaimsPerSiteEnabled;return[4,i.send({path:n,endpoint:f,driveUrl:y,requestType:s,apiName:a,accessToken:C,useAuthorizationHeaders:!0,postData:x,headers:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},p),L?{"X-ClientService-ClientTag":L}:{}),A?{"x-ms-cc":"t"}:{}),expectedErrors:g,allowCookies:w,timeout:d,parseResponse:b,apiVersion:E})];case 3:return[2,O.sent()]}})})}}function b(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.parseResponse,v=e.allowCookies;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,m,g,b,w,E,S;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);m=e(Object(u.n)());g=void 0!==window.navigator.onLine&&!window.navigator.onLine;b=m||g;return[4,e(Object(u.t)(i))];case 1:w=r.sent();if(b&&w)return[2,w];E=y({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,parseResponse:d,allowCookies:v});if(!w)return[3,2];e(E).then(function(t){e(Object(u.r)(i,t))});return[2,w];case 2:return[4,e(E)];case 3:S=r.sent();return[4,e(Object(u.r)(i,S))];case 4:r.sent();return[2,S]}})})}}function w(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){return[2,!!(t=n(Object(l.e)({isODCEndpoint:h.d})).isODCEndpoint)&&t(e)]})})}}function E(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.S})).supportsRandomAccess;return!!r&&r(e,t)}}}],Array(167),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("saveViewCore"),o=Object(i.i)({operationTypeFacet:s})}],Array(142),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n("react-lib"),i=n(3742),s=n(2338),o=n(2787),u=n(1394),a=n(969),f=n(2480),l=n(1422),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.yesText,d=void 0===p?l.e.yes:p,v=e.noText,m=void 0===v?l.e.no:v,g=h?u.e:a.e,y=h?a.e:u.e;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(g,{"data-automationid":"confirmbutton",onClick:t},d),r.createElement(y,{"data-automationid":"cancelbutton",onClick:n,componentRef:function(e){e&&e.focus()}},m))))}}],Array(38),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("refreshItemsInSet"),o=Object(i.i)({operationTypeFacet:s})}],Array(38),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4),i=n(145),s=n(1154),o=new r.e("driveItemSet",{driveItemKey:Object(r.o)(i.e),sortBy:Object(r.s)(),isAscending:Object(r.n)(),extFilters:Object(r.t)(Object(r.s)()),filters:Object(r.t)(Object(r.o)(s.e)),groupBy:Object(r.s)()})}],Array(75),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")}],Array(96),[function(e,t,n){"use strict";var r=n(0),i=n(184),s=n(5),o=n(9),u=n(145),a=n(2063),f=n(3048),l=n(2),c=new l.e("driveItemResponse"),h=n(526),p=n(985),d=n(2399),v=n(163),m=n(51),g=n(1023),y=n(2859),b=n(1008),w=n(2497),E=n(1599),S=n(3050),x=n(3051),T=n(3049),N=n(247),C=new l.e("hasPdfFacet"),k=n(3911);n.d(t,"e",function(){return L});n.d(t,"t",function(){return A});function L(e){var t,n=e.driveItemKey,l=e.driveItem,L=e.endpoint,O=e.parentFolderItemKey,M=e.shouldReturnShareFacets,_=void 0===M||M,D=l.file,P=l.fileSystemInfo,H=l.name,B=l.parentReference,j=l.remoteItem,F=l.root,I=l.size,q=l.thumbnails,R=l.image,U=l.video,z=l.eTag,W=l.specialFolder,X=l.lastModifiedDateTime,V=void 0===X?P&&P.lastModifiedDateTime||j&&j.lastModifiedDateTime:X,$=l.createdDateTime||P&&P.createdDateTime||j&&j.createdDateTime,J=B&&B.driveId,K=B&&B.driveType||j&&j.parentReference&&j.parentReference.driveType,Q="personal"===K,G=P&&P.lastAccessedDateTime||j&&j.fileSystemInfo&&j.fileSystemInfo.lastAccessedDateTime,Y=l.package||j&&j.package,Z=q||j&&j.thumbnails,ee=R||j&&j.image,te=U||j&&j.video,ne=l.shared||j&&j.shared,re={itemId:l.id,driveId:J,endpoint:L},ie=P&&P.systemPath,se=n||j&&j.parentReference&&{itemId:j.id,driveId:j.parentReference.driveId,endpoint:L}||re,oe=u.e.serialize(se),ue=l.webDavUrl||j&&j.webDavUrl;t="business"!==K&&"documentLibrary"!==K&&"personal"!==K||!F?H||j&&j.name||"":d.e.files;var ae=l.folder||j&&j.folder,fe=I||j&&j.size,le=ae&&ae.childCount,ce=A(t,!!ae),he=ce.extension||l.package&&l.package.type,pe=he&&(function(e){var t=e.replace(".",""),n=Object.keys(E.e);for(var r in n)if(E.e.hasOwnProperty(n[r])){var i=n[r];if(E.e[i].indexOf(t)>-1)return i}})(he),de=l.sharepointIds||j&&j.sharepointIds,ve=l.localItem,me=l.webUrl||j&&j.webUrl;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(se)),s.l.pack(t)),void 0!==fe?s.p.pack(fe):{}),P||l.folder||D||j&&j.folder?Object(r.__assign)({},s.d.pack(ae?{}:void 0)):{}),me?s.L.pack(me):{}),b.n.pack(ie)),ue?s.i.pack(decodeURIComponent(ue)):{}),s.a.pack(V?new Date(V).getTime():void 0)),s.o.pack($?new Date($).getTime():void 0)),G?Object(r.__assign)({},s.s.pack(new Date(G).getTime())):{}),i.i.pack(Y&&"oneNote"===Y.type?{}:void 0)),Z?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(Z)),T.e.pack(!0)),C.pack(Object(k.e)(ce.extension))):{}),Object(N.e)().forFacet(v.v).thenInvalidate(oe,f.e).pack()),c.pack(l)),z?s.c.pack(z):{}),ee&&ee.width&&ee.height?v.a.pack({width:ee.width,height:ee.height}):{}),ee&&!te?v.p.pack({}):{}),te?v.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:se,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:h.e.serialize({driveItemKey:se})})),s.A.pack(O?{itemKey:O}:void 0)),!Q&&ue?Object(r.__assign)({},s.O.pack((function(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0})(ue))):{}),g.e.pack(K)),Q?Object(r.__assign)({},y.e.pack(l.vault)):{}),s.h.pack(ce)),_?Object(r.__assign)(Object(r.__assign)({},s.E.pack(!!ne)),p.e.pack(ne)):{}),ve?b.e.pack(ve):{}),"number"==typeof le?m.e.pack(le):{}),b.t.pack(D&&D.mimeType)),pe?w.e.pack(pe):{}),de?S.e.pack(de):{}),W?x.e.pack(W.name):{})}function A(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}}],Array(107),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(18),i=n(72),s=new r.e("itemTileFolderCoverControl",{folderCoverAs:Object(i.e)()}),o=new r.e("itemTileControl",{tileAs:Object(i.e)(),folderCoverControlHandler:Object(r.n)(s)})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(191),i=Object(r.e)(function(e){return{}})},function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(0),i=n(1167),s=n(194),o=n(420),u=n(31),a=n(105),f=n(3028);function l(e,t,n,l){var c=this;return function(h){return Object(r.__awaiter)(c,void 0,void 0,function(){var c,p,d,v,m,g,y,b,w,E,S,x,T,N=this;return Object(r.__generator)(this,function(C){switch(C.label){case 0:c=(l||{}).qosExtraData;p=h(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),d=p.graphDataSourceConfiguration,v=p.graphTokenProviderConfiguration;m=d&&d.ensureAuthToken;g=n&&d&&d.ensureAuthTokenWithAction;y=v&&v.getSessionToken;if(!(w=y?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,y({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:g?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h(g(e,t,n))];case 1:return[2,r.sent()]}})})}:m?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,m(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];E=h(Object(o.e)({name:"graphDataSource.getAuthToken",extraData:c}));C.label=1;case 1:C.trys.push([1,3,,4]);return[4,w()];case 2:b=C.sent();h(E({resultType:u.e.Success,extraData:Object(r.__assign)(Object(r.__assign)({},c),{authTokenObtained:!!b})}));return[3,4];case 3:S=C.sent();x=u.e.Failure;T=void 0;if(S instanceof a.e){S.isExpected&&(x=u.e.ExpectedFailure);T=S.code}else T=S instanceof Error?S.name+"("+S.message+")":"UnknownAuthError";h(E({resultType:x,resultCode:T,error:S&&JSON.stringify(S),extraData:c}));throw S;case 4:return[2,b]}})})}}function c(e,t,n){var i=this;return function(s){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s(l(["Files.ReadWrite.All"],e,t,n))];case 1:(i=r.sent())&&(o={accessToken:i});return[2,o]}})})}}}],Array(41),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(4),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(133),s=n(4),o=new r.e("updateItem"),u=new s.e("updateListItem",{itemDisplayName:Object(s.s)()}),a=new i.e("updateListItemProgress",function(e,t){return u.serialize({})})}],Array(79),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(1106),s=n(164),o=n(90),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),l=r.useRef(),c=l.current||n&&a.keyboardManager||(l.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=f(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("officeApp")},function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"i",function(){return d});n.d(t,"s",function(){return m});var r=n(0),i=n(985),s=n(3047),o=n(3046),u=n(145),a=n(143),f=n(184),l=(new a.e("addToOneDrive",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.e}))}),new a.e("canCreateFolder",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.t}))})),c=(new a.e("canCreateLink",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.n}))}),new a.e("canDelete",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.r}))})),h=new a.e("canDownload",function(e,t){return!e.demandItemFacet(f.i,t.itemKey)&&v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.i}))}),p=(new a.e("canInvite",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.s}))}),new a.e("canMove",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.o}))}),new a.e("canUseOfficeLens",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.u}))}),new a.e("canRename",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.a}))})),d=new a.e("canUpload",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.f}))});function v(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,o.e.serialize({endpoint:s,driveId:a}));return!!f&&!!f.roles&&m(e,{itemKey:n,oneOfRequiredRoles:f.roles})}function m(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t){var n=e.demandItemFacet(i.e,t);return!n||!n.effectiveRoles||!n.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(r||(r={}))}],Array(88),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(3742),s=n(2787),o=n(1394),u=n(2040),a=function(e){var t=e.title,n=e.prompt,a=e.cancelText,f=e.onCancel;return r.createElement(i.e,{onDismiss:f,hidden:!1,title:t,maxWidth:e.maxWidth},r.createElement(u.e,null,n),r.createElement(s.e,null,r.createElement(o.e,{onClick:f,componentRef:function(e){e&&e.focus()}},a)))}}],Array(27),[function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return d});n.d(t,"e",function(){return m});var r=n(0),i=n(227),s=n(194),o=n(822),u=n(420),a=n(31),f=n(1),l=n(532),c=n(105);n(3043);function h(e){return function(t){var n=t(Object(s.e)({spHomeDataSourceConfiguration:f.Rt})).spHomeDataSourceConfiguration,r=n&&n.contextAcquiresAuthToken;return t(Object(i.r)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:v(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:r,crossSiteCollectionCall:r,needsRequestDigest:!r,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,n){var i=this;void 0===n&&(n=8);return function(o){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,u,a,l,c,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=o(Object(s.e)({spFrequentSitesConfiguration:f.It,enableFilesWeightedFrequentSitesConfiguration:f.A})),u=i.spFrequentSitesConfiguration,a=i.enableFilesWeightedFrequentSitesConfiguration;return u&&u.getExternalData?[4,u.getExternalData()]:[3,2];case 1:if(l=r.sent())return[2,l];r.label=2;case 2:return!t&&u&&u.getCacheContext?[4,u.getCacheContext()]:[3,4];case 3:(c=r.sent())&&(t=JSON.stringify(c));r.label=4;case 4:return[4,o(h({tenantRootUrl:e}))];case 5:p=r.sent();return[2,o(m({path:"api/v1/sites/feed?acronyms=true&start=0&count="+n,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:a?"ODBWeb":void 0,cacheContext:t}))]}})})}}function d(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(t=n(Object(s.e)({spFollowedSitesConfiguration:f.Ft})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(i=r.sent())return[2,i];r.label=2;case 2:return[4,n(h({tenantRootUrl:e}))];case 3:o=r.sent();return[2,n(m({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function v(e){var t=e.tenantRootUrl;return Object(o.n)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function m(e){var t=this,n=e.method,s=e.path,o=e.context,f=e.qosName,h=e.clientType,p=e.contentType,d=void 0===p?"application/json;odata=verbose":p,v=e.body,m=e.cacheContext,g=f?"getData."+f:"getData";return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,p,y,b,w,E,S,x,T=this;return Object(r.__generator)(this,function(N){switch(N.label){case 0:t=new Headers;return(p=o.accessToken)?[3,2]:[4,e(Object(i.e)({url:o.resource}))];case 1:p=N.sent();N.label=2;case 2:(f=p)&&t.set("Authorization","Bearer "+f);o.payloadHeader&&t.set("SPHome-ApiContext",o.payloadHeader);m&&t.set("SPHome-CacheContext",m);t.set("SPHome-ClientType",h||"ODSPDocLibsWeb");t.set("Content-Type",d);y={headers:t,credentials:"omit",method:n,mode:"cors",cache:"default",body:v};b=e(Object(u.e)({name:g}));w=o.resource+"/"+s+"__"+n;return[4,e(Object(l.t)(w))];case 3:E=N.sent();S=fetch(o.resource+"/"+s,y).then(function(t){return Object(r.__awaiter)(T,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!t.ok)return[3,2];e(b({resultType:a.e.Success}));return 204===t.status?[2,{}]:[4,t.json()];case 1:n=r.sent();e(Object(l.r)(w,n));return[2,n];case 2:throw new c.e({code:""+t.status,message:t.statusText})}})})}).catch(function(t){e(b({resultType:a.e.Failure,resultCode:t instanceof c.e?t.code:t.name,error:t&&JSON.stringify(t)}));throw t});return(x=E)?[3,5]:[4,S];case 4:x=N.sent();N.label=5;case 5:return[2,x]}})})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(145),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"t",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return g});n.d(t,"n",function(){return y});var r,i=n(1),s=n(5),o=n(42),u=n(1018),a=n(2499),f=n(64),l=n(106),c=n(3509),h=n(1201),p=n(1053);(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(r||(r={}));function d(e,t){var n,r,a;if(!t)return!1;var h=e.demandItem({firstItemKey:f.e,permissions:i.st,checkoutInfo:s.y,needsPublishing:i.Qe},t),d=h.firstItemKey,v=h.permissions,m=h.checkoutInfo,y=h.needsPublishing;if(!d)return!1;var b=e.demandItemFacet(i.Be,l.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));return Boolean(y&&o.e.hasItemPermission({permissions:v},o.e.editListItems)&&(null===(n=b)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=b)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(a=m)||void 0===a?void 0:a.byOther)&&!p.e(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,s=e.demandItem({moderationStatusType:i.Ve},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof s&&s!==u.e.draft&&s!==u.e.denied&&s!==u.e.pending;var o=g(e,n);return 0===o.minor&&0!==o.major})(e,{itemKey:t,listFacets:b})&&!c.t(e,{itemKey:t,includeOneNote:!0}))}function v(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function m(e){return!!e&&0===e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118")}function g(e,t){var n=e.demandItem({uiVersion:i.un},t).uiVersion;return Object(h.t)(n)}function y(e,t){var n,r=e.demandItem({firstItemKey:f.e,moderationStatusType:i.Ve},t),s=r.firstItemKey,o=r.moderationStatusType;return s?(null===(n=e.demandItemFacet(i.Be,l.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===u.e.pending?a.e.CancelApproval:a.e.SubmitForApproval:p.t(e,t)?a.e.SchedulePublish:0===g(e,t).major?a.e.Publish:a.e.Republish:a.e.Publish}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(64),s=n(1),o=n(2784),u=n(123);function a(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=n(Object(u.e)(function(t){return t.demandItemFacet(i.e,e)}));return[4,n(Object(o.e)(function(t){return t.demandItem({listItemId:s.Ie},e)}))];case 1:a=r.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(227),i=n(822),s=n(13),o=n(468);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){var n=f(t,!1,e.listTemplate);t&&n&&!t.ViewData&&(t.ViewData=n.viewData);return{serverView:t,view:n}})},noRedirect:!0}))}}function a(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:f(t,!0)}},noRedirect:!0}))}}function f(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var l=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",l).toString()}},function(e,t,n){"use strict";n.d(t,"t",function(){return y});n.d(t,"e",function(){return E});var r=n(11),i=n(64),s=n(106),o=n(847),u=n(1),a=n(13),f=n(37),l=n(156),c=n(145),h=n(840),p=n(5),d=n(162),v=n(57),m=n(46),g=n(71),y=Object(r.t)()(function(){return function(e){return w}}),b={ODB:1928};function w(e,t){var n=t.itemKey,r=t.desiredSize,f=e.demandItemFacet(i.e,n);if(!f)return{};var l=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=E(e,{itemKey:n,spItem:r});if(s){var o=Math.ceil(i.width),u=Math.ceil(i.height);return{url:s(o,u),width:0,height:0}}})(e,{itemKey:n,spItem:f,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(o.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=s.e.serialize(n),f=e.demandItemFacet(u.Be,i);if(!f)return;var l=f.templateType===a.n.publishingAsset;if(f.isPromotedLinks||l){var c=e.demandItemFacet(u.bt,r),h=void 0;f.isPromotedLinks?h=c&&c.BackgroundImageLocation:l&&c&&c.AlternateThumbnailUrl&&(h=e.demandItemFacet(o.e,r));if(h)return{url:h,width:0,height:0}}})(e,{spItem:f,itemKey:n});return l?{thumbnail:l}:{}}function E(e,t){var n=t.itemKey,r=t.spItem,i=Object(f.e)(e,{enableSharePointDirectThumbnails:u.Q,spCookieDomainConfiguration:u.kt}),s=i.enableSharePointDirectThumbnails,o=void 0===s||s,a=i.spCookieDomainConfiguration,y=Object(m.e)(e,n);if(o&&Object(v.e)(e,{pageContext:y,feature:b})&&y&&!Object(g.t)(y).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var w=r.webAbsoluteUrl,E=r.listFullUrl,S=new l.e(w||E).authority;if(a&&a===S){var x=S+"/_api/v2.1",T=e.demandItemFacet(c.e,n),N=e.demandItemFacet(p.c,n)||"";if(T){var C=T.driveId,k=T.itemId,L=Object(h.t)({endpoint:x,driveId:C,itemId:k});return function(e,t){return L+"/thumbnails/0/c"+e+"x"+(t=t||e)+"/content?"+Object(d.e)({prefer:"noredirect,closestavailablesize",cb:N})}}}}}},,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"ItemSwitchViewAction",function(){return b});n.d(t,"SwitchViewExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(14),o=n(28),u=n(175),a=n(9),f=n(64),l=n(83),c=n(189),h=n(1),p=n(468),d=n(21),v=n(303),m=n(1239),g=n(43),y=n(40),b=Object(y.t)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h.wt,N)?e.demandItemFacet(h.wt,N):void 0,k=Object(g.t)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.St.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.v.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.s.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.e)({items:(o={},o[N]=[h.wt,h.v],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)}],Array(150),[function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(2),o=n(852),u=n(113),a=n(3068),f=n(40),l=n(28),c=n(14),h=n(43),p=n(1020),d=n(321),v=n(2804),m=n(5),g=n(117),y=n(354),b=n(3515),w=n(175),E=new d.e("newDocument"),S=Object(y.t)()(v.e),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:E.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,s=t.fileCreated,o=t.isItemOpened,u=this.props,a=u.itemCacheDispatch,f=u.itemKey,c=u.parentFolderDriveItemUrl,h=u.action,d=Object(r.__rest)(u,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),v=h.availableOn,y=v&&v.file&&v.file.extensions&&v.file.extensions[0]&&v.file.extensions[0].replace(".",""),b=!!y&&!!h.handler,E=void 0;if(b&&y){var x=!h.handler.isPromoted;x&&!c||(E=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a(Object(p.e)({items:(e={},e[f]={newDocumentKey:n,extension:y},e)}))];case 1:t.sent();x&&c&&a((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,s=i.parentFolderDriveItemUrl,o=e(Object(g.e)({fileName:m.l},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(Object(w.e)({items:(t={},t[n]=Object(r.__assign)({},m.j.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var i})})})}return s?o?null:i.createElement(S,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:h})):i.createElement(l.e,Object(r.__assign)({},d,{isAvailable:b,onExecute:E}))};return t})(i.Component),T=Object(c.i)()(Object(f.e)(function(e,t){var n=t.itemKey,i=t.action,s=e.demandItemFacet(b.e,n),o=b.e.evaluate(s)(e,{itemKey:n}).driveItemFullUrl,u=i.handler,a=u.appId,f=u.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",l={appId:a};return Object(r.__assign)(Object(r.__assign)({},Object(h.t)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:l}})),{parentFolderDriveItemUrl:o||""})})(x));var N=Object(c.s)()(Object(f.e)(function(e,t){var n=t.itemKeys,i=t.action,s=i.availableOn,o=s.allowMultiSelect,u=void 0!==o&&o,a=n.length,f=u&&a>0||1===a;f&&(f=n.every(function(t){var n=e.demandItem({fileName:m.h,isFolder:m.d},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(v.t)(s,i,Boolean(o))}));var l=i.handler,c=l.appId,p=l.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",d={appId:c};return Object(r.__assign)({isAvailable:f},Object(h.t)(e,{itemKey:n[0],engagement:{name:p,isIntentional:!0,extraData:d}}))})(v.e)),C=n(3923),k=n(20),L=n(9),A=n(67),O=n(171),M=n(1221),_=n(3061);n.d(t,"e",function(){return F});n.d(t,"t",function(){return I});var D=new s.e("fileHandlerOpenCommand").id,P=new s.e("fileHandlerCreateCommand").id,H=new s.e("fileHandlerCustomCommand").id,B=new s.e("fileHandlerAppCommand").id,j=new s.e("fileHandlerActionsCommand").id,F=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:O.t,version:O.a},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(L.e,n);return r&&r.itemKeys||[]};return{new:R(e,{actionKeys:u("create"),type:"create"})||[],open:R(e,{actionKeys:u("open"),type:"open"})||[],custom:R(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}},I=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function q(e,t){var n,r,s,f,l,c=t.itemKey,h=t.type,p=t.CustomAction,d=void 0,v=void 0;if("app"===h){d=c;if(!(_=c&&e.demandItem({displayName:m.l,appIcon:O.n},c)))return;s=B+"-"+c;f="itemsScopefileHandlerAppCommand";n=_.displayName;_.appIcon&&_.appIcon.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:_.appIcon&&_.appIcon.url||"",title:_.displayName||"",imageFit:u.t.contain,className:"fileHandlerCommandIcon_713927b4"}})}else{var g=e.demandItem({displayName:m.l,handlerKey:O.o,availableOn:O.e,icon:O.i,isPromoted:O.s},c),y=g.displayName,b=g.handlerKey,w=g.availableOn,E=g.icon;v=g.isPromoted;var S=b&&e.demandItemFacet(O.n,b),x="open"===h&&S||E;x&&x.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_713927b4",imageProps:{src:x&&x.url,title:x&&x.displayName,imageFit:u.t.contain,className:"fileHandlerCommandIcon_713927b4"}});var L=Object(M.e)(e,{itemKey:c});n=y;switch(h){case"open":if(!n&&b){var _;n=(_=c&&e.demandItem({displayName:m.l},b))&&_.displayName&&k.format(C.e.openWithCommand,_.displayName)}s=D;f="itemsScopefileHandlerOpenCommand";l=p?i.createElement(p,{action:L}):i.createElement(a.e,{action:L});break;case"create":n||(n=E&&E.displayName||w&&w.file&&w.file.extensions&&k.format(C.e.createFileWithExtension,w.file.extensions[0])||"");s=P;f="itemsScopefileHandlerCreateCommand";l=i.createElement(A.e,null,i.createElement(T,{action:L}));break;case"custom":s=H;f="itemsScopefileHandlerCustomCommand";y&&(f=y.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");l=p?i.createElement(p,{action:L}):i.createElement(N,{action:L})}s+="-"+c;d=b}if(s&&n)return{key:s,automationId:f,name:n,iconProps:r,action:l,handlerKey:d,isPromoted:v,fileHandlerType:h}}function R(e,t){var n=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,u=[];if("open"===i){var f=e.demandItemFacet(_.r,n[0]),l=_.r.evaluate(f)(e,{openActionAs:a.e}).openActionAs;n.forEach(function(t){var n=q(e,{itemKey:t,type:i,CustomAction:l});n&&u.push(n)})}else if("create"===i)n.forEach(function(t){var n=q(e,{itemKey:t,type:i});n&&u.push(n)});else if("custom"===i){f=e.demandItemFacet(_.t,n[0]);var c=_.t.evaluate(f)(e,{customActionAs:N}).customActionAs,h=(function(e,t){var n=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return q(e,{itemKey:t,type:"custom",CustomAction:s})},l=function(t,n){var r=q(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var c=0,h=n;c<h.length;c++){var p=h[c],d=f(p);if(d){var v=d.handlerKey||"";if(o){if(!o.subMenuProps){var m=Object(r.__assign)({},o),g=Object.keys(a)[0];if(E=l(g)){o=E;if(v===g){E.subMenuProps={items:[m,d]};continue}}}var y=Object.keys(a).length;if(void 0!==a[v]){var b=o.subMenuProps;if(1===y)b&&b.items.push(d);else{var w=a[v];if(b){var E;(E=b.items[w]).subMenuProps&&E.subMenuProps.items.push(d)}}}else{var S=l(v,[d]);if(!S)continue;if(1===y){var x=Object(r.__assign)({},o);o={key:""+j,automationId:"itemsScopefileHandlerActionsCommand",name:C.e.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:C.e.fileHandlerRootActionsMenuAriaLabel,className:"fileHandlerCommandIcon_713927b4"},subMenuProps:{items:[x,S]}};a[v]=1}else{o.subMenuProps&&o.subMenuProps.items.push(S);a[v]=y}}}else{o=d;a[v]=0}}}o&&(u=[o])}else for(var T=0,N=function(e){var t=f(e);if(!t)return"continue";var n=t.handlerKey||"",i=l(n,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(n===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}});if(!s){a[n]=T;T++;u.push(i)}}else{a[n]=T;T++;u.push(t)}},k=0,L=n;k<L.length;k++){p=L[k];N(p)}return u})(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:c});h&&u.push.apply(u,h)}return u}},,,,,,function(e,t,n){"use strict";var r=n(347),i=n(0),s=n(4186),o=n(336);var u=n(3007);n.d(t,"e",function(){return a});var a=r.e?function(e,t){var n=this;void 0===t&&(t={});var r=t.cancelToken,s=t.flushOperationQueue,a=t.timeout,f=void 0===a?1/0:a,l=t.contextualControlHandlerCache;return function(t){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:a=Object(o.e)({timeout:f,errorProps:{message:"Timeout demanding items"}},r);i.label=1;case 1:i.trys.push([1,,3,4]);return[4,t(Object(u.e)(e,function(e){n={result:e}},{cancelToken:a.token,flushOperationQueue:s,contextualControlHandlerCache:l}))];case 2:i.sent();return[3,4];case 3:a.dispose();return[7];case 4:if(!n)throw new Error("No result.");return[2,n.result]}})})}}:function e(t,n){var r=this;void 0===n&&(n={});var u=n.cancelToken,a=n.flushOperationQueue,f=n.timeout,l=void 0===f?1/0:f,c=n.contextualControlHandlers;return function(n){return Object(i.__awaiter)(r,void 0,void 0,function(){var r,f,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:f={operation:e};h=Object(o.e)({timeout:l,errorProps:{message:"Timeout demanding items"}},u);i.label=1;case 1:i.trys.push([1,,3,4]);return[4,n(Object(s.e)(t,function(e){r={result:e}},{cancelToken:h.token,flushOperationQueue:a,contextualControlHandlers:c,owner:f}))];case 2:i.sent();return[3,4];case 3:h.dispose();return[7];case 4:if(!r)throw new Error("No result.");return[2,r.result]}})})}}},,,,,,,,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(195),s=n(21),o=n(1544),u=n(678),a=n(5),f=n(146),l=n(334),c=n(623);n.d(t,"e",function(){return h});var h=function(e){var t=e.itemKey,n=e.action;return r.createElement(i.e,null,function(i){var h,p=i.itemCache;if(e.children)h=e.children;else{var d=p.demandItemFacet(a.l,t);h=d}var v=Object(f.e)(p),m=(n||!(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),r=Object(l.e)(e,{itemKey:t.itemKey2});return Object(c.e)(e,{itemKey:n})===Object(c.e)(e,{itemKey:r})})(p,{itemKey1:t,itemKey2:v}))&&t?r.createElement(u.e,{itemKey:t}):null;return r.createElement(s.n,{action:m},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?r.createElement(o.e,{onClick:i},h):r.createElement("span",null,h)})})}},,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(40),o=n(14),u=n(28),a=n(3742),f=n(2787),l=n(1394),c=n(3524),h=n(1136),p=n(3061),d=n(117),v=n(5),m=n(145),g=n(194),y=n(120),b=n(840),w=n(3523),E=n(1674),S=n(2347);function x(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=e.appId,i=e.itemKeys,s=e.getPreAuthUrl,o=e.driveUrl;if(!s)return[2,i.map(function(e){var t=n(Object(d.e)({driveItemKey:m.e},e)).driveItemKey,i=n(Object(g.e)({graphEndpoint:y.l})).graphEndpoint;return t?Object(b.t)(Object(r.__assign)(Object(r.__assign)({},t),{endpoint:i||t.endpoint})):""})];u=i.map(function(e){return n(Object(d.e)({fullUrl:v.i},e)).fullUrl||""});return[4,n(Object(S.t)(o,o))];case 1:a=f.sent();return[2,new w.e({},{dataRequestor:n(E.e).dataRequestor}).getPreAuthUrls({appId:t,items:u,accessToken:a,driveUrl:o})]}})})}}var T=n(186),N=n(3924),C=n(21),k=n(71);n.d(t,"e",function(){return A});n.d(t,"t",function(){return O});var L=Object(s.t)(function(e,t){var n,s=t.itemKeys,o=t.action,d=t.isAvailable,v=t.itemKey,g=o.handler,y=g.appId,w=g.isPromoted,E=v,S="",L="";L=k.e.isActivated("f69e50a3-c176-4a8c-8c48-6adf2b86607b","1/23/2021","Use itemKey instead of parentItemKey.")?E||(1===s.length?s[0]:""):1===s.length?s[0]:E||"";var A=e.demandItem({controlHandler:p.e,driveItemKey:m.e},L),O=A.controlHandler,M=A.driveItemKey;(S=M&&Object(b.n)(M)||"").indexOf("/v2.1")>-1&&(S=S.replace("/v2.1","/v2.0"));var _=p.e.evaluate(O)(e,{itemKey:L}).sharedPostData;n=_;var D=e.dispatch;if(!(d&&o.url&&n&&S))return null;var P=e.demandItemFacet(p.n,v),H=p.n.evaluate(P)(e,{itemKey:v}).onInvokeCallback,B=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e=H?void 0:window.open("","_blank");return[4,D(x({appId:y,itemKeys:s,getPreAuthUrl:!w,driveUrl:S})).catch(function(){})];case 1:t=u.sent();i=Object(r.__assign)(Object(r.__assign)({},n),{appId:y,items:JSON.stringify(t||[])});if(H)H({url:o.url,postdata:i});else if(t&&t.length>0&&e&&e.document){e.opener=null;Object(h.e)({url:o.url,postdata:i,document:e.document})}else e&&e.close();return[2]}})})},j=w?Object(C.o)(function(e){var t=e.resolve,n=e.reject,s=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){n(new T.e);return[2]})})};return i.createElement(a.e,{dialogContentProps:{title:N.e.consentDialogTitle,onDismiss:s},hidden:!1},i.createElement("p",null,N.e.consentDialogMessage),i.createElement(f.e,null,i.createElement(l.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:t();return[4,B()];case 1:e.sent();return[2]}})})}},N.e.consentDialogContinueButton),i.createElement(c.e,{onClick:s},N.e.consentDialogCancelButton)))}):B;return i.createElement(u.e,Object(r.__assign)({isAvailable:d,onExecute:j},t))}),A=Object(o.e)()(L);function O(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;if(!0===n)return!!i;if(r&&t){var o=k.e.isActivated("b0dc9ce2-048d-43d2-ac18-f07fc73030c2","1/23/2021","Check if the extension includes a period")||"."===t.charAt(0)?t:"."+t;return!s||-1!==s.indexOf(o.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*")}return!1}}],Array(29),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(360);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(18),i=new r.e("progressListGroupControl",{}),s=new r.e("progressListControl",{groupControlHandler:Object(r.n)(i)})},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r=n(0),i=n(2),s=n(372),o=n(133),u=new i.e("moveCopyItems"),a=new o.e("moveCopyItems"),f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(s.e)},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(133),s=new r.e("addContentTypesToList"),o=new i.e("addContentTypesToList")},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(2),i=n(138),s=new r.e("pinSite"),o=Object(i.i)({operationTypeFacet:s});t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("vault")},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"e",function(){return a});var r=n(2),i=n(133),s=n(138),o=new r.e("removeFromOneDrive"),u=new i.e("removeFromOneDrive"),a=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(2962),i=n(360),s=n(2834),o=n(822);function u(e){var t=e.responseText,n=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=Object(r.t)(o,n,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=Object(r.t)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}}function a(e){var t=i.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=i.e.Word&&l<=t&&l!==i.e.Text){if(l!==i.e.OneNote||f){if(f){f+=Object(s.t)(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===i.e.ExcelForm&&(l=i.e.ExcelSurvey);return Object(o.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r,i=n(20),s=n(3919);(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(r||(r={}));function o(e){return function(t){return(function(e,t){switch(e){case r.InvalidCharacters:return i.format(s.e.invalidNameError,t.invalidCharacters);case r.InvalidStart:return i.format(s.e.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return i.format(s.e.invalidNameEndError,t.cannotEndWith);case r.Empty:return s.e.emptyNameError;case void 0:return}})((function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0})(t,e),e)}}var u=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),a=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("createFreshView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(138);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(2),i=n(133),s=new r.e("removeItemsFromSharedList"),o=new i.e("removeItemsFromSharedList"),u=Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("react-lib"),s=n(2),o=n(108),u=n(1052),a={key:new s.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:i.createElement(u.t,null),facets:Object(r.__assign)({},o.t.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("react-lib"),s=n(2),o=n(108),u=n(1025),a={key:new s.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:i.createElement(u.n,null),facets:Object(r.__assign)({},o.t.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("saveViewActionControl")}],Array(78),[function(e,t,n){"use strict";var r=n("react-lib"),i=n(286),s=n(690),o=n(415),u=n(53),a=n(0),f=n(14),l=n(40),c=n(28),h=n(64),p=n(345),d=n(106),v=n(1),m=n(13),g=n(1089),y=n(467),b=n(42),w=n(43),E=n(37),S=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},x=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.isEditForm,i=!1,s=S;if(Object(E.e)(e,{enableEditOrViewItemCommandConfiguration:v.k}).enableEditOrViewItemCommandConfiguration){var o=e.demandItem({key:h.e,itemId:v.Ie,contentTypeId:v.p,permissions:v.st},n),u=o.key,f=o.itemId,l=o.contentTypeId,c=o.permissions;if(u&&f&&(!r||c&&b.t.hasItemPermission({permissions:c},b.t.editListItems))){var x=u&&e.demandItemFacet(v.Qt,p.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(x&&!x.isAnonymousGuestUser){var T=e.demandItem({list:v.Be,listFormUrls:v.je},d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),N=T.list,C=T.listFormUrls,k=C?r?C.editFormUrl:C.displayFormUrl:void 0;if(N&&C&&N.templateType&&N.templateType!==m.n.mySiteDocumentLibrary&&k){var L=Object(g.e)(k,u.rootFolder||new y.e(u.listFullUrl).path,f,l);i=!0;s=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){(e=window.open(L,"_blank"))&&e.focus();return[2]})})}}}}}return Object(a.__assign)({isAvailable:i,onExecute:s},Object(w.t)(e,{itemKey:n,engagement:{name:r?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(c.e))),T=n(3520),N=n(480),C=n(1086),k=n(618),L=n(2),A=Object(L.t)("EditItem"),O=Object(L.t)("ViewItem");n.d(t,"t",function(){return M});n.d(t,"e",function(){return D});var M={key:O,name:u.e.Open,action:r.createElement(x,null)},_={key:A,name:i.e.Edit,action:r.createElement(T.e,null),iconProps:{iconName:"Edit"}};function D(e){return[C.e,k.t,_,o.n,o.t,s.e,N.e]}},,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(3781),o=n(2),u=n(108),a=n(963),f=n(14),l=n(28),c=n(709),h=n(40),p=n(1),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.e)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.tt},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(2868),y=n(2867);n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.t.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.t.pack(!0))}},,function(e,t,n){"use strict";var r=n(169),i=n("react-lib"),s=n(1250),o=n(5),u=n(21),a=n(678),f=n(156),l=n(147);var c=n(256),h=n(59),p=n(750),d=n(751),v=n(740),m=n(741),g=n(739);n.d(t,"e",function(){return y});var y=Object(p.e)({key:c.r,name:r.e.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.A,n),h=c&&e.demandItemFacet(o.L,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])}],Array(46),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(255),s=n(122),o=n(186);function u(e,t,n){var u=this;void 0===n&&(n={});var a=n.cancelToken,f=n.flushOperationQueue,l=n.contextualControlHandlerCache;return function(n){return Object(r.__awaiter)(u,void 0,void 0,function(){var u,c,h,p,d=this;return Object(r.__generator)(this,function(v){switch(v.label){case 0:u=n(i.t);if(!(c=u.createItemCacheSelector(e,l,"observeItems")).isResolved())return[3,1];t(c.get());return[3,5];case 1:h=new s.e;p=void 0;v.label=2;case 2:v.trys.push([2,,4,5]);p=c.subscribeToDemandResolution(function(){return Object(r.__awaiter)(d,void 0,void 0,function(){var e,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,5,,6]);return c.isResolved()?(e=t(c.get()))?[4,e]:[3,2]:[3,3];case 1:r.sent();r.label=2;case 2:h.resolve();return[3,4];case 3:a&&a.throwIfCanceled();r.label=4;case 4:return[3,6];case 5:n=r.sent();h.reject(n);return[3,6];case 6:return[2]}})})});c.registerDemands();f&&c.flushDemands();return[4,Object(o.r)(h.promise,a)];case 3:v.sent();return[3,5];case 4:p&&p();c.dispose();return[7];case 5:return[2]}})})}}}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(66),s=n(9),o=n(83),u=n(217),a=n(61),f=n(422),l=n(32);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("20").then(n.bind(null,3647))];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.u,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(133),s=new r.e("assignItemToGroup"),o=new i.e("assignToGroup")},function(e,t,n){"use strict";n.d(t,"n",function(){return p});n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});var r=n(0),i=n(54),s=n(249),o=n(1780),u=n(186),a=n(2100),f=n(1001),l=n(1),c=n(3496),h=n(194);function p(e){throw new f.e({facets:Object(r.__assign)({},s.a.pack({maxFileSize:e}))})}function d(e){return function(t){return i.n.isCanceled(e)?new u.e:e instanceof a.e?new f.e({facets:t((n=e,function(e){if(n.errorType===o.e.conflict||n.errorType===o.e.similarNameExists){var t=e(v());if(!t)return n.errorType===o.e.conflict?Object(r.__assign)({},s.i.pack({supportsRename:!1})):void 0;switch(n.errorType){case o.e.conflict:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.v.pack({})),s.t.pack(!0)),s.n.pack(!0));case o.e.similarNameExists:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.b.pack({})),s.t.pack(!0)),s.n.pack(!1))}}switch(n.errorType){case o.e.accessDenied:return Object(r.__assign)({},s.e.pack({}));case o.e.disconnected:return Object(r.__assign)({},s.m.pack({}));case o.e.emptyFileOrFolder:case o.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},s.s.pack({}));case o.e.folderUploadNotSupported:return Object(r.__assign)({},s.f.pack({}));case o.e.invalidName:return Object(r.__assign)({},s.c.pack({}));case o.e.lockMismatch:return Object(r.__assign)({},s.p.pack({}));case o.e.malwareDetected:return Object(r.__assign)({},s.d.pack({}));case o.e.overQuota:return Object(r.__assign)({},s.g.pack({}));case o.e.targetFolderMissing:return Object(r.__assign)({},s.w.pack({}));case o.e.throttled:return Object(r.__assign)({},s.E.pack({}));case o.e.versionMismatch:return Object(r.__assign)({},s.S.pack({}))}return Object(r.__assign)({},s.y.pack({}))})),innerError:e}):Object(c.t)(e)?new f.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===e.code?Object(r.__assign)({},s.i.pack({supportsRename:t(v())})):Object(r.__assign)({},s.y.pack({}))),l._t.pack(e)),message:Object(c.e)(e)}):e;var n}}function v(){return function(e){var t=e(Object(h.e)({uploadNameCollisionExperiment:l.ln})).uploadNameCollisionExperiment;return!!t&&t.getVariantAndLogExposure()}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(64),s=n(106),o=n(4164),u=n(227),a=n(1),f=n(214),l=n(117),c=n(2139),h=n(175),p=n(2),d=n(82),v=n(822),m=n(123),g=n(5),y=n(13),b=n(3033);function w(e){var t=this,n=e.itemKey,w=e.options.sourceEntries,E=i.e.deserialize(n),S=E.webAbsoluteUrl,x=E.listFullUrl,T=Object.keys(w)[0],N=w[T],C=N.progressItemKey,k=N.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,w,N,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K;return Object(r.__generator)(this,function(Q){switch(Q.label){case 0:t=e(Object(u.n)({webAbsoluteUrl:S,listFullUrl:x})),w=t.dataRequestor,N=t.hasDigest;if(!t.hasTokenProvider)return[3,1];A=void 0;return[3,3];case 1:return[4,e(Object(u.e)({url:S||x,disallowCookies:!N}))];case 2:A=Q.sent();Q.label=3;case 3:L=A;O=e(Object(l.e)({sourceFile:c.t},T)).sourceFile;M=e(Object(l.e)({folderPath:a.fe},n)).folderPath,_=void 0===M?E.rootFolder:M;if(!O)throw new Error("No source file for upload.");if(!_)throw new Error("No path information for target folder.");D=Object(v.r)({webAbsoluteUrl:S,listOrItemFullUrl:x});P=new f.e(void 0);H=P.debounce(function(t){var n;C&&e(Object(h.e)({items:(n={},n[C]=Object(p.n)({progressSize:d.m},{progressSize:{current:t}}),n)}))},300,{leading:!1});B=e(Object(m.e)(function(e){return e.demandItemFacet(a.Be,s.e.serialize({webAbsoluteUrl:S,listFullUrl:x}))}));j=B&&B.contentTypesEnabled&&B.templateType!==y.t.mySiteDocumentLibrary;(F=new o.e({authToken:L,dataRequestor:w,parentItemKey:"",targetItemKey:"",fileUpload:O,iconName:"",serverRelativeItemUrl:_,webApiUrl:D,onProgress:H,expandAllItemFields:j})).nameConflictBehavior="replace"===k?1:0;C&&e(Object(h.e)({items:(J={},J[C]=Object(r.__assign)({},d.m.pack({total:O.size,current:0})),J)}));I=F.start();q=e(Object(m.e)(function(e){return e.demandItemFacet(d.i,C)}));R=q?q.token.subscribe(function(){F.abort()}):void 0;Q.label=4;case 4:Q.trys.push([4,6,7,8]);return[4,I];case 5:Q.sent();return[3,8];case 6:U=Q.sent();F.abort();throw Object(b.t)(U);case 7:R&&R();F.dispose();return[7];case 8:z=F.item;W=z.properties;X=W&&W.ID||z.id;V=W&&W.uniqueId;$=i.e.serialize({webAbsoluteUrl:S,listFullUrl:x,itemId:X});e(Object(h.e)({items:(K={},K[$]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.l.pack(z.displayName)),z.id?a.fe.pack(z.id):{}),V?a.fn.pack(V):{}),g.A.pack({itemKey:n})),K)}));return[2,{itemKey:$}]}})})}}},,,,function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointItemByFullUrlAddon",function(){return O});var r=n(0),i=n(16),s=n(138),o=n(193),u=n(156),a=n(112),f=n(533),l=n(1245),c=n(71),h=n(1170),p=n(106),d=n(175),v=n(293),m=n(595),g=n(64),y=n(83),b=n(345),w=n(1),E=n(5),S=n(9),x=n(306),T=n(274),N=n(328),C=n(117),k=n(382),L=n(367),A=n(314),O=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(d.t)({keyFacet:h.e,facets:[g.e,E.l,E.h,w.fn,E.d,w.fe,S.t,w.We,k.e,k.t,w.st,E.i]}));e(Object(s.s)(h.e,v.e)(Object(i.i)({maxParallelOperationCount:8})(M)));return[2]})})}});function M(e){var t=this,n=e.itemKey,i=h.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,d,v,E,k,O,M,_,D,P,H,B,j,F,I,q,R,U,z;return Object(r.__generator)(this,function(W){switch(W.label){case 0:t=new o.e;s=!1;d=new u.e(i.itemFullUrl);v=e((function(e,t,n){return function(r){var i,s,o=e.itemFullUrl,a=new u.e(o);s=c.e.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[a.path];var f=r(Object(C.e)({contentTypeId:w.p},h.e.serialize(e)));if(t&&t.length>0&&f&&f.contentTypeId)for(var l=0,p=t;l<p.length;l++){var d=p[l];if(d.contentTypeId===f.contentTypeId&&d.Fields)for(var v=0,m=d.Fields.split(",");v<m.length;v++){var g=m[v];"Modified_x0020_By"===g?s.push("Editor"):"Created_x0020_By"===g?s.push("Author"):s.push(g)}}var y=Object(N.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:s});return{webAbsoluteUrl:"",listFullUrl:o,currentPageContext:void 0,qosName:n,viewXml:y,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));return[4,e(Object(x.e)({getItemContext:v}))];case 1:E=W.sent();k=E.WebUrl||m.i(decodeURIComponent(E.HttpRoot||""))||d.authority;O=""+new u.e(k).authority+(E.ListUrl||decodeURIComponent(E.listUrlDir||""));M={webAbsoluteUrl:k,listFullUrl:O,rootFolder:""};_=e(Object(T.t)({serverData:E,itemSetKey:M,currentPageContext:v.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),D=_.itemResolver,P=_.childKeys,H=_.pageContext;B=P[0];j=y.e.serialize(M);B&&t.mapKeys({mappings:(U={},U[B]=h.e.serialize(i),U)});if(H){F=b.e.serialize({webAbsoluteUrl:k,listFullUrl:O});e(Object(C.e)({pageContext:w.Qt},F)).pageContext||e(Object(f.e)({itemKey:F,options:{pageContext:H}}))}t.merge(D);if(g.e.matches(B)){I=g.e.deserialize(B);(q=Object(L.t)(I))&&t.merge(e(Object(L.e)({parentKey:q,serverData:E,pageContext:H})).itemResolver)}R=p.e.serialize({webAbsoluteUrl:k,listFullUrl:O});t.resolveItems({items:(z={},z[g.e.serialize(M)]=Object(r.__assign)({},S.t.pack({itemKey:j})),z[n]=Object(r.__assign)({},a.r.pack(g.e)),z[R]=Object(r.__assign)({},Object(l.e)(E,H)),z)});e(t.execute());e(Object(A.e)({itemSetKey:j,serverData:E,isItemSetRequest:s}));return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r=50,i=8,s=2},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(133),s=new r.e("updateCheckoutState"),o=new i.e("checkout");Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(133),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(138),s=n(133),o=n(4),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.i)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("bulkUpdateListItems"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("modifyView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("updateView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("modifyFieldProperties"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"r",function(){return o});n.d(t,"n",function(){return u});var r=n(18),i=new r.e("fileHandlerActionControl"),s=new r.e("fileHandlerCustomActionControl"),o=new r.e("fileHandlerOpenActionControl"),u=new r.e("fileHandlerInvokeActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return v});n.d(t,"i",function(){return m});var r=n("react-lib"),i=n(3519),s=n(3064),o=n(2),u=n(286),a=n(3521),f=n(3520),l=new o.e("moreCommands").id,c={key:new o.e("CheckOutItem").id,automationId:"checkOutItemCommand",name:s.e.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkOut"})},h={key:new o.e("CheckInItem").id,automationId:"checkInItemCommand",name:s.e.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkIn"})},p={key:new o.e("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:s.e.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"undoCheckOut"})},d={key:new o.e("ViewDocumentProperties").id,name:u.e.ViewProperties,action:r.createElement(f.e,{interactiveSave:!0})},v={key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[d,c,h,p]}};function m(e){var t=e.listFacets,n=Object(a.e)({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[d,c,h,p,n]}}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("itemPropertiesFormControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(0),i=n("react-lib"),s=n(40),o=n(28),u=n(65),a=n(14),f=n(186),l=n(83),c=n(106),h=n(1),p=n(43),d=n(3057),v=n(3509),m=n(42),g=n(1018),y=n(37),b=n(13),w=n(709),E=n(5),S=n(21),x=n(91),T=Object(x.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("23")]).then(n.bind(null,4183))];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),N=Object(s.t)(function(e,t){var n=t.onContinue,s=t.onCancel,o=t.resolve,u=t.reject,a=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(T,Object(r.__assign)({},a,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:u(new f.e);return[2]}})})}}))}),C=Object(s.t)(function(e,t){var n=t.itemKeys,s=Object(u.e)(e);if(!s)return null;var a=e.demandItem({setKey:l.e},s).setKey;if(!a||!n||!n.length)return null;if(!Object(y.e)(e,{enbableApproveRejectConfiguration:h.x}).enbableApproveRejectConfiguration)return null;var f=!0,x=e.demandItemFacet(h.Be,c.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(x&&x.templateType===b.n.webPageLibrary&&n.length>1)return null;for(var T,C,k=!0,L=!0,A=!1,O={},M=0,_=n;M<_.length;M++){var D=_[M];if(!v.e(e,{itemKey:D,listFacets:x}))return null;var P=e.demandItem({permissions:h.st,moderationStatusType:h.Ve,moderationComments:h.Xe},D),H=P.permissions,B=P.moderationStatusType,j=P.moderationComments;if(x&&!x.isDocumentLibrary&&!m.t.hasItemPermission({permissions:H},m.t.layoutsPage))return null;if(void 0!==B){var F=O[g.e[B]];O[g.e[B]]=F?F+1:1}void 0===T?T=j:T!==j&&(k=!1);void 0===C?C=B:C!==B&&(L=!1);B===g.e.draft&&(A=!0);if(!(f=v.t(e,{itemKey:D,includeOneNote:!0})||B===g.e.pending||!!x&&!x.enableMinorVersions))return null}if(x&&x.templateType===b.n.webPageLibrary){if(f){return(D=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(w.e,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var I,q=L&&C===g.e.draft&&!!x&&!!x.enableMinorVersions,R=A,U=e.dispatch,z=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,U(Object(d.e)({items:(i={},i[s]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},W=n.length,X=W>1?"BulkApproveReject":"ApproveReject";1===W&&(I=e.demandItemFacet(E.l,n[0]));var V=Object(S.o)(function(e){return i.createElement(N,Object(r.__assign)({},e,{onContinue:z,hideApproveRejectOptions:q,showDraftOption:R,initialComment:k?T:void 0,initialStatus:L?C:void 0,itemCount:n.length,itemName:I,initialStatusMapForBulkEdit:O}))});return i.createElement(o.e,Object(r.__assign)({isAvailable:f,onExecute:V},Object(p.t)(e,{itemKey:n[0],engagement:{name:X,isIntentional:!0}})))}),k=Object(a.s)()(C)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(600),o=n(473),u=function(e){var t=e.extension,n=e.className,u=e.isOneNote,a=e.size,f=e.brand,l=Object(o.n)({size:a,extension:u?"one":t,brand:f});return l?i.createElement(s.e,Object(r.__assign)({className:n},l)):null}},function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(40),s=n(2804),o=n(14),u=n(5),a=n(43),f=Object(i.e)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var f=e.demandItem({fileName:u.h,isFolder:u.d},n),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;o=Object(s.t)(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(a.t)(e,{itemKey:n,engagement:{name:v,isIntentional:!0,extraData:m}}))})(s.e),l=Object(o.s)()(Object(o.r)()(f))},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(40),s=n(28),o=n(106),u=n(1177),a=n(1),f=n(3058),l=n(43),c=Object(i.e)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,s=!1,u=i&&o.e.serialize(i);if(i&&n){var f=e.demandItemFacet(a.Be,u);s=!(!(f&&f.permissions&&f.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:s},Object(l.t)(e,{itemKey:u,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(r){e(Object(f.e)({items:(t={},t[u.e.serialize(i)]={views:(s={},s[n.id]={isDefault:!0},s)},t)}));return[2]})})}:void 0}})(s.e)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(83),i=n(189);function s(e,t){var n=t.itemSetKey,s=e.demandItemFacet(r.e,n);return s&&s.viewKey&&i.e.serialize(s.viewKey)}},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=new r.e("shortcutExistedAlready"),s=new r.e("nestedDescendantShortcutExists"),o=new r.e("nestedAscendantShortcutExists")}],Array(322),[function(e,t,n){"use strict";var r=n("react-lib"),i=n(0),s=n(14),o=n(40),u=n(9),a=n(1218),f=n(5),l=n(1),c=n(42),h=n(43),p=n(91),d=n(61),v=n(21),m=n(28),g=n(914),y=Object(o.e)()(Object(p.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("11")]).then(n.bind(null,4542))];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),b=Object(o.t)(function(e,t){var n=t.itemKey,s=t.editType,o=Object(d.e)(e).itemsScopeItemKey,p=Object(g.e)(e),b=e.demandItem({isMalwareDetected:f.N,permissions:l.st},n),w=b.isMalwareDetected,E=b.permissions,S=!w&&!!n&&Object(a.e)(e,t)&&!!p&&!!E&&c.e.hasItemPermission({permissions:E},c.e.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(u.e,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),a=o>-1?0!==r:0===r;a&&(2===r?a=0!==o:3===r&&(a=o!==s.length-1));return a})(e,{itemKey:t.itemKey,pinnedItemSetKey:p,editType:s}),x=o?Object(v.o)(function(e){return r.createElement(y,Object(i.__assign)({},e,t,{itemsScopeItemKey:o,pinnedItemSetKey:p}))}):void 0;return r.createElement(m.e,Object(i.__assign)({isAvailable:S,onExecute:x},Object(h.t)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),w=Object(s.s)()(Object(s.r)()(b));var E=n(612),S=n(3070),x=n(2),T=Object(x.t)("pinItem"),N=Object(x.t)("moveLeftPinnedItem"),C=Object(x.t)("moveRightPinnedItem"),k=Object(x.t)("removePinnedItem"),L=Object(x.t)("editPinnedItem");n.d(t,"t",function(){return A});n.d(t,"e",function(){return D});var A={key:T,automationId:"pinItemCommand",name:S.e.pinToTop,iconProps:{iconName:"Pin"},action:r.createElement(w,{editType:0})},O={key:N,automationId:"moveLeftPinnedItemCommand",name:S.e.moveLeftPinnedItem,iconProps:{iconName:E.e.isRightToLeft?"Forward":"Back"},action:r.createElement(w,{editType:2})},M={key:C,automationId:"moveRightPinnedItemCommand",name:S.e.moveRightPinnedItem,iconProps:{iconName:E.e.isRightToLeft?"Back":"Forward"},action:r.createElement(w,{editType:3})},_={key:k,automationId:"removePinnedItemCommand",name:S.e.unpinFromTop,iconProps:{iconName:"UnPin"},action:r.createElement(w,{editType:1})},D={key:L,automationId:"editPinnedItemCommand",name:S.e.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[O,M,_]}}},,,,,,,,,,,function(e,t,n){"use strict";var r,i=n(138),s=n(133),o=n(0),u=n(20),a=n(3901),f=n(3032),l=n(16),c=n(280),h=n(11),p=n(598),d=n(332),v=n(9),m=n(82),g=n(5),y=((r={})[m.r.started]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupStartedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.completed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupCompletedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.failed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[m.r.canceled]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r),b=Object(l.t)(function(){return function(e){e(Object(c.e)(f.t,p.e)(Object(h.t)()(E)));e(Object(c.e)(f.t,d.n)(Object(h.t)()(w)))}});function w(){return function(e){return function(e,t){return{reportMode:d.e.pin}}}}function E(){return function(e){return S}}function S(e,t){var n=t.itemKey,r=Object(s.i)(e,t),i=r.phase,u=r.count,a=y,l=e.demandItemFacet(v.e,n),c=l&&l.itemKeys,h="",p="";if(c&&c.length>0){var d=e.demandItemFacet(f.e,c[0]),m=d&&d.groupKey;m&&(h=e.demandItemFacet(g.l,m)||"");p=a[i](u,h)}else{var b=e.demandItemFacet(f.t,n);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(g.l,w);E&&(p=E)}}return Object(o.__assign)({},p&&"item"!==t.format?{title:p}:{})}n.d(t,"e",function(){return x});n.d(t,"t",function(){return T});var x=Object(i.i)({operationTypeFacet:f.e}),T=Object(s.s)({operationTypeFacet:f.e,progressKeyFacet:f.t,initializeBatch:function(){return b}})},,function(e,t,n){"use strict";var r,i,s=n(0),o=n(399),u=n(64),a=n(822);(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(r||(r={}));(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(i||(i={}));var f=n(227),l=n(156),c=n(1255),h=n(16),p=n(9),d=n(175),v=n(1),m=n(123),g=n(2620),y=n(127),b=n(247),w=n(5);n.d(t,"t",function(){return E});n.d(t,"e",function(){return S});n.d(t,"n",function(){return x});var E=3,S=(function(e){Object(s.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(c.e),x=Object(h.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,c,h,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return Object(s.__generator)(this,function(R){switch(R.label){case 0:r=Object.keys(n)[0];i=n[r].editType;return[4,e(Object(g.e)(r))];case 1:c=R.sent(),h=c.key,x=c.itemId;T=e(Object(m.e)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.e,pinnedItems:p.e},t)})),N=T.deserializedPinnedItemSetKey,C=T.pinnedItems;N||(N=o.e.deserialize(t));if(!h||!N||!x)throw new S({resultType:5});if(!(h&&N&&x))return[3,3];k="";"";N.viewKey&&(k=N.viewKey.viewId);L=N.parentItemKey.rootFolder||new l.e(N.parentItemKey.listFullUrl).path;A=void 0;(O=C&&C.itemKeys||[])&&(M=O.indexOf(r))>-1&&(2===i&&M>=2?A=O[M-2]:3===i&&M<O.length-1&&(A=O[M+1]));_=void 0;A&&(_=e(Object(m.e)(function(e){return e.demandItemFacet(v.Ie,A)})));D={webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:x,editType:i,viewId:k,rootFolder:L,afterItemId:_};t&&(P=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(r,O,A,D)).length<=E&&e(Object(d.e)({items:Object(s.__assign)((I={},I[t]=Object(s.__assign)({},p.e.pack({itemKeys:P})),I),Object(y.e)(P,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));return(H=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,s=e.itemId,o=e.afterItemId,u=e.rootFolder,f=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n});r&&(f=f.methodWithAliases("GetView",{viewGuid:r}));if(1!==i){var l=o?parseInt(o,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:s,folderPath:u||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:s,folderPath:u||""});return f.toString()})(D))?[4,e(Object(f.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,url:H,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:B=R.sent();if(0!==(j=(function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}})(B)).resultType){F=(function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var o=i[r];n.push(u.e.serialize(Object(s.__assign)(Object(s.__assign)({},t),{itemId:o.toString()})))}return n})(j,h);e(Object(d.e)({items:Object(s.__assign)((q={},q[t]=Object(s.__assign)({},p.e.pack({itemKeys:F})),q),Object(y.e)(F,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));throw new S({resultType:j.resultType})}R.label=3;case 3:return[2]}})})}})},,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(83),o=n(189),u=n(40),a=n(186),f=n(5),l=n(28),c=n(21),h=n(43),p=new(n(18).e)("filterActionControl"),d=n(91);n.d(t,"e",function(){return m});var v=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3549))];case 1:return[2,e.sent().ConnectedFilterPanel]}})})}),m=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,d=t.isToggled,m=e.demandItemFacet(f.l,n),g=e.demandItemFacet(p,u),y=e.demandItemFacet(s.e,u),b=y&&y.viewKey&&o.e.serialize(y.viewKey),w=p.evaluate(g)(e,{viewKey:b,isAvailable:!0}).isAvailable,E=Object(c.o)(function(e){return i.createElement(v,{onClose:function(){e.reject(new a.e)},onComplete:function(){e.resolve()},columnName:m||"",columnKey:n,itemSetKey:u})});return i.createElement(l.e,Object(r.__assign)({isAvailable:w,isToggled:d,onExecute:E},Object(h.t)(e,{itemKey:u,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})}],Array(56),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("itemAutoRefreshControl")}],Array(15),[function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return m});var r=n(11),i=n(280),s=n(37),o=n(83),u=n(64),a=n(9),f=n(1157),l=n(5),c=n(1),h=n(3775),p=n(1206),d=n(16),v=Object(r.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(s.e)(e,{isProjectedUploadedItemSetEnabled:c.X}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var p=e.demandItemFacet(o.e,n);if(p){var d=(function(e,t,n){var r=[],i=f.e.serialize({itemSetKey:t}),s=e.demandItemFacet(a.e,i);e.demandItemFacet(h.e,f.e.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var o={},c={},p=0,d=s.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(u.e,v);if(m){m.itemId&&(o[m.itemId]=!0);m.rootFolder&&(c[m.rootFolder]=!0)}o[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(u.e,b);if(w){if(e.demandItemFacet(l.d,b)){if(w.rootFolder&&w.rootFolder in c)continue}else if(w.itemId&&w.itemId in o)continue}r.push(b)}return r})(e,p,r);return d?{itemKeys:d}:{}}}return{}}}}),m=Object(d.t)(function(){return function(e){e(Object(i.e)(o.e,p.e)(Object(r.t)()(v)))}})},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(4),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(16),s=n(193),o=n(694),u=n(840),a=n(1674),f=n(2455),l=n(1156),c=n(330),h=n(247),p=n(3783),d=n(2617),v=n(145),m=n(5),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:t=Object.keys(n);i=t[0];p=o.e.deserialize(i);d=p.driveItemKey,g=d.endpoint,E=d.driveId;if(!g)throw new Error("No endpoint to determine activity items.");S=t.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});x=Object(u.n)({endpoint:(J=g,J.replace("2.1","2.0")),driveId:E});T=x+"/ExtendedActivitiesForItems";N={driveItems:S,badgeOnly:!0};return[4,e(Object(a.n)({url:T,method:"POST",body:N,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:g}))];case 1:if((C=$.sent()).value){k=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(C.value);L=0;A=0;O=0;M=0;_=new s.e;for(D=0,P=t;D<P.length;D++){H=P[D];L++;B=o.e.deserialize(H);j=B.driveItemKey.itemId;F=j&&k[j];I=v.e.serialize(B.driveItemKey);q=void 0;if(F){R=new f.e;U=R.processResponse({item:{name:j||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:T},response:{value:F,"@odata.nextLink":""}}).activities;z=y(U);if(W=b(U)){O++;A++;if(!z){M++;X=w(W,H).itemResolver;_.merge(X);q=W}}}_.resolveItems({items:(V={},V[H]=Object(r.__assign)({},l.e.pack(q)),V[I]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(H,l.e).pack()),V)})}e(_.execute());e(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:L,activityFieldEligibleItemCount:A,activityFieldActiveItemCount:O,activityFieldBadgedItemCount:M,activityFieldBadgedPercent:L?Math.round(M/L*100):0},isIntentional:!1}))}return[2]}var J})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e,i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new s.e,r=0,i=e;r<i.length;r++){var o=E(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){var n=new s.e,r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});var r=n(0),i=n(11),s=n(65),o=n(103),u=n(145),a=n(2063),f=n(9),l=n(175),c=Object(i.t)()(function(){return function(e){return function(e,t){var n,i,o=Object(s.e)(e),f={},l=e.demandItemFacet(a.e,t.itemKey);if(l){n=h(e,{parentItemKey:u.e.serialize(l.driveItemKey),stageItem:t.stageItem});f={itemKey:t.itemKey}}else{n=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:o}))&&h(e,{parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem});f=i?{itemKey:a.e.serialize(i)}:{}}return Object(r.__assign)(Object(r.__assign)({},f),n?{stageItem:n}:{})}}});function h(e,t){var n=this,i=t.parentItemKey,s=t.stageItem;if(i)return s?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e(Object(l.e)({items:(n={},n[o]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(s({currentItemKey:o,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n(64),n(1170);var r=n(156),i=function(e){return""+(""+new r.e(e).authority)+new r.e(e).segments.slice(0,-1).join("/")}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("saveUploadedTemplateToView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(1),i=n(5),s=n(42),o=n(184);function u(e,t){var n=t.itemKey,r=t.includeOneNote,s=e.demandItem({folder:i.d,oneNote:o.i},n),u=s.folder,a=s.oneNote;return r?!!u||!!a:!!u&&!a}function a(e,t){var n=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:r.st,checkoutInfo:i.y},n),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&s.e.hasItemPermission({permissions:f},s.e.editListItems)&&s.e.hasItemPermission({permissions:f},s.e.approveItems)}return u}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("updateItemRating"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("updateItemLikes"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("createView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("modifyColumnAggregateType"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("getDriveItemFullUrlControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("reorderListItems"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n("react-lib"),s=n(1),o=n(42),u=n(5),a=n(184),f=n(40),l=n(64),c=n(345),h=n(106),p=n(13),d=n(91),v=n(21),m=n(197),g=n(43),y=n(65),b=n(28),w=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("deferred.resx-deferred"),n.e("7")]).then(n.bind(null,4178))];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),E=Object(f.t)(function(e,t){var n=t.checkInOutType,f=Object(y.e)(e),d=Object(m.e)(e);if(!d.length)return null;var E=e.demandItem({firstItemKey:l.e},d[0]).firstItemKey;if(!E)return null;var S=E&&e.demandItemFacet(s.Qt,c.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}));if(S&&(S.isAnonymousGuestUser||S.isEmailAuthenticationGuestUser))return null;for(var x=e.demandItemFacet(s.Be,h.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),T=!!x&&x.templateType===p.t.mySiteDocumentLibrary,N=!!x&&!!x.enableMinorVersions,C=!1,k=0,L=d;k<L.length;k++){var A=L[k],O=e.demandItemFacet(u.d,A),M=e.demandItemFacet(a.i,A);if(A&&!O&&!M){var _=e.demandItem({isCheckedOut:u.y,isBFile:s.Se},A),D=_.isCheckedOut,P=_.isBFile,H=e.demandItemFacet(s.st,A),B=o.e.hasItemPermission({permissions:H},o.e.editListItems),j=o.e.hasItemPermission({permissions:H},o.e.cancelCheckout);"checkOut"===n?C=!P&&!T&&!(D&&(D.byYou||D.byOther))&&B:"checkIn"!==n&&"undoCheckOut"!==n||!D||(C=B&&(!!D.byYou||j&&!!D.byOther))}if(!C)break}var F=d?Object(v.o)(function(e){return i.createElement(w,Object(r.__assign)({},e,{itemSetKey:f,itemKeys:d,checkInOutType:n,enableMinorVersions:N}))}):void 0;return i.createElement(b.e,Object(r.__assign)({isAvailable:C,onExecute:F},Object(g.t)(e,{itemKey:d[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:d.length>1}}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(42),o=n(91),u=n(3065),a=n(40),f=n(21),l=n(197),c=n(1),h=n(43),p=n(28),d=n(64),v=n(106),m=n(13),g=n(37),y=Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("10")]).then(n.bind(null,4033))];case 1:return[2,e.sent().EditItemWizard]}})})}),b=Object(a.t)(function(e,t){var n=Object(l.e)(e),o=1===n.length?n[0]:void 0,a=Object(g.e)(e,{enableEditItemCommand:c.C}).enableEditItemCommand,b=e.demandItemFacet(u.e,o),w=u.e.evaluate(b)(e,{itemKey:o}).getPropertiesForm,E=e.demandItemFacet(c.st,o),S=e.demandItemFacet(d.e,o),x=S&&e.demandItemFacet(c.Be,v.e.serialize(S)),T=x&&x.templateType===m.t.mySiteDocumentLibrary,N=a&&!!w&&!!E&&!T&&s.t.hasItemPermission({permissions:E},s.t.editListItems),C=o&&w?Object(f.o)(function(e){return i.createElement(y,Object(r.__assign)({},e,{itemKey:o,interactiveSave:t.interactiveSave,getPropertiesForm:w}))}):void 0;return i.createElement(p.e,Object(r.__assign)({isAvailable:N,onExecute:C},Object(h.t)(e,{itemKey:o,engagement:{name:"EditItem",isIntentional:!0}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n("react-lib"),i=n(2),s=n(286),o=n(3066),u=n(13),a=new i.e("ApproveReject").id;function f(e){var t=e.listFacets,n=t&&t.templateType===u.n.webPageLibrary&&t.isModerated?s.e.ReviewApprovals:s.e.ApproveReject;return{key:a,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:r.createElement(o.e,null)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(108),o=n(963),u=n(3781),a=n(2867),f=n(2868),l={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[a.e,f.e]},onRender:function(e){return i.createElement(u.e,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},s.t.pack(!0))}},,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=new r.e("isViewCommand"),s=new r.e("isSwitchViewCommand"),o=new r.e("isEditViewCommand"),u=new r.e("isCreateViewCommand")},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(13),i=n(156),s=n(232),o=n(2778);function u(e,t){var n,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===r.t.documentLibrary||f)){var c=new i.e(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=s.t.serialize({endpoint:c});n=Object(o.e)(e,{itemKey:h})}return{fileHandlerCommands:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("editNewMenu").id},function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return d});var r=n(0),i=n("react-lib"),s=n(1187),o=n(909),u=n(1),a=n(1599),f=n(175),l=n(16),c=n(453),h=n(360),p=Object(l.i)()(function(e){var t=this,n=e.itemKey,a=s.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){e(Object(f.e)({items:(t={},t[n]=Object(r.__assign)({},u.t.pack(function(){return i.createElement(c.e,{documentType:d(a.templateUrl),templateItemKey:o.e.serialize({listKey:a.listKey,templateUrl:a.templateUrl})})})),t)}));return[2]})})}});function d(e){var t=h.e.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(a.t[r]){case a.i:t=h.e.OneNote;break;case a.s:t=h.e.PowerPoint;break;case a.n:t=h.e.Excel;break;case a.o:t=h.e.Visio}}}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(143),s=n(3747),o=n(252),u=n(106),a=n(64),f=n(46),l=n(1091),c=n(1),h=n(13),p=n(3782),d=n(3527),v=n(71),m=new i.e("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);if(i){var m=a.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),g=e.demandItemFacet(a.e,m);if(g){var y=Object(f.e)(e,m),b=e.demandItemFacet(c.Be,n);if(y&&b){var w=b.templateType===h.t.mySiteDocumentLibrary,E=e.demandItemFacet(c.Ye,n),S=Object(l.t)(e,m,g);Object(v.t)(y).isActivated("97F46AEC-F105-436C-9A00-8268455640F0","11/19/20","Folder always available")||(S=!0);var x=Object(p.e)(e,{key:g,listFacets:b,listKey:i,pageContext:y}),T=x.contentTypes,N=x.contentTypeCommands,C=Object(d.e)(e,{isODB:w,key:g,listFacets:b,pageContext:y}).fileHandlerCommands,k=o.e;return Object(s.e)(e,{contentTypes:T,newCommandMenu:k,fileHandlerCommands:C,isCreateFolderAvailable:S,newDocumentTemplates:E,contentTypeCommands:N,listKey:i}).allCommands}}}})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(138),s=new r.e("saveTemplatesToView"),o=Object(i.i)({operationTypeFacet:s})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(18).e)("removeFromShardListActionControl")},,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(40),o=n(43),u=n(28),a=n(14),f=n(213),l=n(302),c=n(2346),h=n(90),p=n(2345),d=n(57),v=n(46),m={ODB:1024},g=function(e){var t=e.undoRedoActionType,n=e.dispatch,s=e.isAvailable,o=i.useState(0),a=o[0],f=o[1],l=i.useState(0),d=l[0],v=l[1],m=i.useRef(new h.e({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);i.useEffect(function(){var e=n(c.e);m.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return i.createElement(u.e,Object(r.__assign)({},e,{isAvailable:g}))},y=Object(s.t)(function(e,t){var n=t.itemKey,s=t.undoRedoActionType,u="undo"===s,a=Object(v.e)(e,n),y=Object(d.e)(e,{feature:m,pageContext:a});if(y){y=Object(f.e)(e)===l.e}var b=e.dispatch;return i.createElement(g,Object(r.__assign)({undoRedoActionType:s,dispatch:b,isAvailable:y,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=b(c.e);h.e.raise(e,u?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),b=Object(a.n)()(y)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(28),o=n(40),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(2),s=n(53),o=n(67),u=n(3539),a={key:Object(i.t)("launchMovePickerCommand"),automationId:"launchMovePickerCommand",name:s.e.MoveItem,ariaLabel:s.e.MoveItem,action:r.createElement(o.t,null,r.createElement(u.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(14),o=n(28),u=n(21),a=n(40),f=n(146),l=n(68),c=n(91),h=n(43),p=n(736),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("550")]).then(n.bind(null,4135))];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(2),s=n(53),o=n(67),u=n(3539),a={key:Object(i.t)("launchCopyPickerCommand"),automationId:"launchCopyPickerCommand",name:s.e.CopyItem,ariaLabel:s.e.CopyItem,action:r.createElement(o.t,null,r.createElement(u.e,null)),iconProps:{iconName:"Copy"}}},,function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return S});var r=n(0),i=n("react-lib"),s=n(28),o=n(195),u=n(21),a=n(43),f=n(530),l=n(302),c=n(83),h=n(799),p=n(189),d=n(1),v=n(122),m=n(175),g=n(71),y=n(2848),b=n(213),w=n(61),E=g.e.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),S=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return i.createElement(o.e,null,function(n){var o=n.itemCache,g=n.dispatch,S=Object(a.t)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),x=o.demandItem({deserizalizeKey:c.e},t).deserizalizeKey,T=x&&x.viewKey,N=x&&h.e.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:T}),C=T&&p.e.serialize(T),k=Object(w.e)(o).itemsScopeItemKey,L=Object(b.e)(o,{itemsScopeItemKey:k});return i.createElement(u.n,{action:i.createElement(f.e,{layoutType:l.e})},function(t){var n=t.execute;return i.createElement(s.e,Object(r.__assign)({isAvailable:!0,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(!E){y.t();y.e("quickEdit.layoutManager.start")}N&&g(Object(m.e)({items:(e={},e[N]=Object(r.__assign)({},d.h.pack(new v.e)),e)}));C&&g(Object(m.e)({items:(i={},i[C]=Object(r.__assign)({},d.vt.pack(L)),i)}));return[4,n(t)];case 1:s.sent();E||y.e("quickEdit.layoutManager.end");return[2]}})})}},S))})})};return t})(i.PureComponent)},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(372),s=n(1856),o=n(249),u=n(194),a=n(467),f=n(3076),l=n(1674),c=n(145),h=n(120);function p(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,f,c,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(r.__generator)(this,function(_){switch(_.label){case 0:t=e.name,s=e.endpoint,o=e.sharepointIds,f=e.qosName,c=e.webAbsoluteUrl;p=n(Object(u.e)({getUserOneDriveEndpoint:h.f,isTestMode:h.v})),d=p.getUserOneDriveEndpoint,v=p.isTestMode;m=new a.e(c).authority;return(y=s)?[3,3]:(b=d)?[4,n(d({endpoint:m}))]:[3,2];case 1:b=_.sent();_.label=2;case 2:y=b;_.label=3;case 3:if(g=y)return[3,4];throw new i.e({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:w=g.replace("v2.0","v2.1");E=w+"/drives/me/root/children";S=o.listId;x=o.listItemUniqueId;T=o.siteId;N=o.siteUrl;C=o.webId;k={name:t,remoteItem:{sharepointIds:{listId:S,listItemUniqueId:x,siteId:T,siteUrl:N,webId:C}},"@microsoft.graph.conflictBehavior":"rename"};L=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}];return[4,n(Object(l.n)({url:E,qosName:f,method:"POST",body:k,expectedErrors:L,endpoint:g}))];case 5:A=_.sent();if(v&&A){O=[];try{(M=window.localStorage.getItem("TAB.AddShortcut"))&&(O=JSON.parse(M))}catch(e){}window.localStorage.setItem("TAB.AddShortcut",JSON.stringify(Object(r.__spreadArrays)(O,[{name:t,id:A.id,endpoint:g}])))}return[2,A]}})})}}function d(e,t,n){var r=Object(s.t)(e,function(r,i){var s=e.response,u=s&&s.error;if(u){var a=u["@error.fixItItemIds"],l=u["@error.fixItWebUrl"],h=u["@error.fixItItemName"],p=[];if(a&&t&&n)for(var d=0,v=a;d<v.length;d++){var m=v[d],g=c.e.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return o.r.pack({});case"itemNotFound":case 404:return o.u.pack({});case"accessDenied":case 403:return o.e.pack({});case"shortcutAlreadyExists":return f.n.pack({existShortcutUrl:l,existShortcutName:h});case"nestedDescendantShortcutExists":return f.t.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return f.e.pack({existShortcutUrl:l,existShortcutName:h});default:return o.m.pack({})}}});throw new i.e({innerError:e,facets:r})}},function(e,t,n){"use strict";n.r(t);n.d(t,"ConnectedFilterPanel",function(){return L});var r=n(0),i=n("react-lib"),s=n(1),o=n(83),u=n(189),a=n(345),f=n(1194),l=n(106),c=n(40),h=n(9),p=n(175),d=n(28),v=n(195),m=n(21),g=n(303),y=n(43),b=n(29),w=n(1844),E=n(306),S=n(71),x=n(91),T=n(258),N=n(100),C=Object(x.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("22")]).then(n.bind(null,4188))];case 1:return[2,e.sent().FilterPanel]}})})}),k=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.itemSetKey,a=t.filterableSet,f=t.internalName,l=t.filterOptionSet,c=t.fieldType,b=t.checkedFilterKeys;return i.createElement(v.e,null,function(t){var v=t.itemCache,w=t.dispatch;if(!(f&&a&&l&&c))return i.createElement(m.n,null);for(var E=v.demandItemFacet(h.s,n),S=v.demandItemFacet(o.e,n),x=S&&S.viewKey&&u.e.serialize(S.viewKey),T="DateTime"===c,N=[],C=[],k={},L=0,A=l;L<A.length;L++){var O=A[L];k[O.value]=O}for(var M=0,_=b;M<_.length;M++){var D=_[M];if(k[D]){N.push(k[D].value);C.push(k[D].display)}}var P=a.getFilteredItemSetKey({filterField:f,filterValues:N,filterType:c,useLookupId:!1,filterDisplays:T?C:void 0}),H=Object(y.t)(v,{itemKey:n,engagement:{name:"ApplyFilters",isIntentional:!0}});return i.createElement(m.n,{action:i.createElement(g.e,{itemKey:P})},function(t){var n=t.isAvailable,o=t.execute;return i.createElement(d.e,Object(r.__assign)({isAvailable:n,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,n;return Object(r.__generator)(this,function(i){switch(i.label){case 0:w(Object(p.e)({items:Object(r.__assign)((e={},e[P]=Object(r.__assign)({},h.s.pack(E)),e),x?(n={},n[x]=Object(r.__assign)({},s.St.pack(!0)),n):{})}));return[4,o(t)];case 1:i.sent();return[2]}})})}},H))})})};return t})(i.PureComponent),L=Object(c.e)(function(e,t){var n=t.columnKey,c=t.itemSetKey,p=e.demandItem({fieldType:s.ue,mappedColumnFieldType:s.ze,internalName:s.Ee},n),d=p.fieldType,v=p.mappedColumnFieldType,m=p.internalName,g=e.demandItem({deserializedSetKey:o.e,filterableSet:s.Ht,filterOptionSets:h.n,childItems:h.e},c),y=g.deserializedSetKey,x=g.filterableSet,C=g.filterOptionSets,L=g.childItems,A=y&&e.demandItemFacet(s.Qt,a.e.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})),O=y&&e.demandItemFacet(s.Zt,f.e.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})),M=e.demandItemFacet(s.ae,C&&C[n]),_=y&&e.demandItemFacet(s.Be,l.e.serialize(y)),D=[];if((_&&_.itemCount&&_.itemCount>5e3||!M||!M.length)&&L&&L.itemKeys&&void 0!==v&&m){for(var P=[],H=0,B=L.itemKeys;H<B.length;H++){var j=B[H],F=e.demandItemFacet(s.bt,j);F&&P.push({properties:F})}D=(function(e){var t=e.mappedColumnFieldType,n=e.internalName,r=e.items;return w.r(t,n,r,T.e,function(e,t,n,r){var i=t,s=[n];if(void 0===i){i=w.a(e,n);s=[w.f(e,n)]}return{key:i=i||T.e.EmptyFilterOptionLabel,checked:!!r,values:s,label:i}})})({mappedColumnFieldType:v,internalName:m,items:P})}M=(function(e){var t=e.smartFilterOptionsFromItems,n=e.originFilterOptionSet,r=e.mappedColumnFieldType,i=e.includeFilterByMeOptionForUserColumn,s=[],o={},u={value:N.r(),display:T.e.FilterByMeFilterOptionLabel};if(r===b.e.User&&i){s.push(u);o[u.value]=u}if(n)for(var a=0,f=n;a<f.length;a++){var l=f[a];if(!o[l.value]){s.push(l);o[l.value]=l}}for(var c=!1,h=0,p=t;h<p.length;h++){var d=p[h],v=d.values[0];if(!o[v]){c=!0;var m={display:d.label,value:v};s.push(m);o[v]=m}}c&&s.sort(function(e,t){if(r===b.e.User){if(e.value===u.value)return-1;if(t.value===u.value)return 1}return(e.display||"").localeCompare(t.display||"")});return s})({smartFilterOptionsFromItems:D,mappedColumnFieldType:v,originFilterOptionSet:M,includeFilterByMeOptionForUserColumn:!A||!Object(S.t)(A).isActivated("CF05ECB8-6D08-4BE0-9CCD-E804C042441F","03/24/2021","Include special filter by me option for user column")});var I=e.isItemFacetResolved(s.ae,C&&C[n]),q=x&&M&&x.appliedFilters&&m&&x.appliedFilters[m]?x.appliedFilters[m].values:[],R=y&&y.viewKey&&u.e.serialize(y.viewKey),U=R&&e.demandItemFacet(s.v,R),z=e.dispatch,W="User"===d||"UserMulti"===d||v===b.e.Text||v===b.e.Title?{pageContextForPicker:A,peoplePickerDataSource:O,getFilterSuggestions:function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s;return Object(r.__generator)(this,function(r){i=[];if(U&&y){s=w.u(U.getEffectiveViewXml(),e,t,n);return[2,z(Object(E.e)({getItemContext:{webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl,currentPageContext:A,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:s,rootFolder:y.rootFolder}})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var r=t[e],s={display:r,value:r};if(!n.hasOwnProperty(s.value)){n[s.value]=s;i.push(s)}})}return i})]}return[2,i]})})}}:void 0;return{filterOptionSet:M||[],mappedColumnFieldType:void 0!==v?v:b.e.Text,fieldInternalName:m||"",applyFiltersAction:function(e){return i.createElement(k,Object(r.__assign)({},e,{itemSetKey:c,filterableSet:x,fieldType:d,internalName:m}))},isLoading:!I,checkedFilterValues:q,filterPickerProps:W}})(C)},function(e,t,n){"use strict";n.r(t);n.d(t,"GroupByActionExecutor",function(){return y});var r=n(0),i=n("react-lib"),s=n(83),o=n(64),u=n(189),a=n(28),f=n(9),l=n(1),c=n(303),h=n(21),p=n(43),d=n(40),v=n(147),m=n(193),g=n(2395),y=Object(d.t)(function(e,t){var n=t.groupByFieldKey,d=t.itemSetKey,y=e.demandItemFacet(s.e,d);if(!y)return i.createElement(h.n,null);var b=e.demandItemFacet(l.y,d),w=!y.groupByFieldKey&&!!b&&-1!==b.indexOf(n),E=y.groupByFieldKey===n||w,S=s.e.serialize(Object(r.__assign)(Object(r.__assign)({},y),{groupByFieldKey:E?void 0:n})),x=o.e.serialize(y),T=y.viewKey&&u.e.serialize(y.viewKey),N=e.demandItemFacet(l.v,T),C=Object(p.t)(e,{itemKey:d,engagement:{name:"GroupBy",isIntentional:!0}}),k=e.dispatch,L=Object(v.r)(e,i.createElement(c.e,{itemKey:S}));return i.createElement(h.n,{action:L},function(e){var t=e.execute;return i.createElement(a.e,Object(r.__assign)({onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:i=new m.e;if(T&&w&&N&&(s=N.getDomParts())&&s.groupBy){o=Object(g.t)(s.groupBy);u=void 0;o.group1.fieldName===n?o.group2&&(u={isCollapsed:o.isCollapsed,group1:o.group2}):(null===(p=o.group2)||void 0===p?void 0:p.fieldName)===n&&(u={isCollapsed:o.isCollapsed,group1:o.group1});N.updateGroupBy(u);i.invalidateItems({items:(a={},a[S]=[f.e],a[T]=[l.v],a)})}i.resolveItems({items:Object(r.__assign)((c={},c[S]=Object(r.__assign)({},f.s.pack({itemKey:x})),c),T?(h={},h[T]=Object(r.__assign)({},l.St.pack(!0)),h):{})});k(i.execute());return[4,t(e)];case 1:d.sent();return[2]}})})}},C))})})},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_4e4d3e0f",i="socialBarPanel_4e4d3e0f",s="socialBarPanelContent_4e4d3e0f",o="socialBarPanelPersona_4e4d3e0f",u="socialBarPanelPersonaDescription_4e4d3e0f",a="analyticsStatsLink_4e4d3e0f"}],Array(32),[function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return b});var r=n(0),i=n("react-lib"),s=n(40),o=n(83),u=n(106),a=n(345),f=n(1),l=n(65),c=n(2869),h=n(43),p=n(21),d=n(28),v=n(91),m=n(61),g=n(597),y=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("529")]).then(n.bind(null,3653))];case 1:return[2,e.sent().FreshViewCreator]}})})}),b=Object(s.t)(function(e,t){var n=t.isEditing,s=t.currentViewKey,v=Object(l.e)(e),b=Object(m.e)(e).itemsScopeItemKey,w=e.demandItemFacet(o.e,v),E=e.demandItemFacet(c.e,v),S=e.demandItemFacet(f.v,s),x=c.e.evaluate(E)(e,{viewKey:s}).onViewSaved;if(!v||!b)return null;var T=!1;if(w&&S){var N=u.e.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}),C=e.demandItemFacet(f.Be,N);T=!!(C&&S&&"POWER"!==S.viewType&&C.permissions&&(C.permissions.managePersonalViews||C.permissions.manageLists))}var k=w?e.demandItemFacet(f.Qt,a.e.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl})):void 0,L=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:b},i.createElement(y,Object(r.__assign)({},e,t,{pageContext:k,itemSetKey:v,onViewSaved:x})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:T,onExecute:L},Object(h.t)(e,{itemKey:v,engagement:{name:n?"EditView":"CreateNewView",isIntentional:!0}})))})}],Array(143),[function(e,t,n){"use strict";var r=n(0),i=n(16),s=n(138),o=n(175),u=n(293),a=n(904),f=n(1191),l=n(1192),c=n(784),h=n(1190),p=n(903),d=n(64),v=n(5),m=n(9),g=n(1),y=n(2616),b=n(193);function w(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:t=h.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;return[4,n(Object(y.t)({tenantRootUrl:t}))];case 1:s=u.sent();i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},g.zt.pack(s.resource)),g.Ut.pack(s.payloadHeader)),o)});n(i.execute());return[2]}})})}}var E=n(51),S=n(3044),x=n(3500),T=n(4),N=new T.e("spSharedChannelGroupSetKeyFacet",{tenantRootUrl:Object(T.s)()}),C=n(123),k=n(37);function L(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,c,h,d;return Object(r.__generator)(this,function(y){t=p.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;s=n(Object(C.e)(A));o=l.e.serialize({tenantRootUrl:t});u=f.e.serialize({tenantRootUrl:t});a=N.serialize({tenantRootUrl:t});c=[o,u];h=((d={})[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.l.pack(S.e.frequent)),g.it.pack({itemKey:e.itemKey})),d[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.l.pack(S.e.followed)),g.it.pack({itemKey:e.itemKey})),d[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.l.pack(x.e.SharedLibrariesHeader)),E.s.pack(!0)),m.e.pack({itemKeys:c})),d);if(s){c.push(a);h[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E.s.pack(!0)),v.l.pack(S.e.sharedChannels)),g.it.pack({itemKey:e.itemKey}))}i.resolveItems({items:h});n(i.execute());return[2]})})}}function A(e){return!!Object(k.e)(e,{enableSharedChannel:g.Y}).enableSharedChannel}var O=n(1197),M=n(3043),_=n(247),D=n(194);function P(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,h,d;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=l.e.deserialize(e.itemKey).tenantRootUrl;i=new b.e;return[4,n(H(t))];case 1:s=y.sent();o=[];u=p.e.serialize({tenantRootUrl:t});f=void 0;h=void 0;s&&s.Items&&s.Items.forEach(function(t,n){var l,p=a.e.serialize({webAbsoluteUrl:t.Url}),d=c.e.serialize({webAbsoluteUrl:t.Url}),y=t.ItemReference||{},b=y.SiteId,w=void 0===b?void 0:b,E=y.WebId,S=void 0===E?void 0:E,x=y.GroupId,T=void 0===x?void 0:x,N=O.e.serialize({rootItemKey:u,itemKey:p});f=s.Items[n-1]&&s.Items[n-1].PinOrder;h=s.Items[n+1]&&s.Items[n+1].PinOrder;i.resolveItems({items:(l={},l[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.l.pack(t.Title)),g.e.pack(t.Acronym)),g.o.pack(t.BannerColor)),g.u.pack(t.BannerImageUrl)),g.Me.pack(!0)),v.d.pack({})),g.Tt.pack(t.Weight)),a.e.pack({webAbsoluteUrl:t.Url})),g.xt.pack(w)),g.vn.pack(S)),g.me.pack(T)),m.t.pack({itemKey:d})),l[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.pt.pack(f)),g.ut.pack(t.PinOrder)),g.et.pack(h)),Object(_.e)().forFacet(g.ut).thenInvalidate(e.itemKey,m.e).pack()),l[d]=Object(r.__assign)({},m.s.pack({itemKey:p})),l)});o.push(p)});i.resolveItems({items:(d={},d[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.l.pack(S.e.frequent)),m.e.pack({itemKeys:o})),g.it.pack({itemKey:u})),d)});n(i.execute());return[2]}})})}}function H(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=i(Object(D.e)({enableSitePinningConfiguration:g.ee,enableSPHomeServiceConfiguration:g.K})),s=t.enableSitePinningConfiguration;return!1!==t.enableSPHomeServiceConfiguration?[3,3]:[4,n.e("28").then(n.bind(null,4025))];case 1:o=r.sent().getFrequentSitesData;return[4,i(o(e))];case 2:return[2,r.sent()];case 3:u=s?M.t:M.e;return[4,i(Object(y.r)(e,void 0,u))];case 4:return[2,r.sent()]}})})}}function B(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){t=a.e.deserialize(e.itemKey).webAbsoluteUrl;i=new b.e;s=c.e.serialize({webAbsoluteUrl:t});i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)({},m.t.pack({itemKey:s})),o)});n(i.execute());return[2]})})}}var j=n(83),F=n(121),I=n(532),q=n(560),R=n(41),U=n(822),z=n(227);function W(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(Object(D.e)({spHostPageWebAbsoluteUrl:g.Wt,spSitesListsDataWebAbsoluteUrl:g.rn})),i=r.spHostPageWebAbsoluteUrl,s=r.spSitesListsDataWebAbsoluteUrl,o=new R.e(t).authority,u=i||s,a=u&&new R.e(u).authority,f=n&&o===a,l=Object(U.n)({webAbsoluteUrl:a||o}).segment(f?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(Object(z.r)({webAbsoluteUrl:a||o,method:"POST",url:l.toString(),qosName:f?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}function X(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,l,h,p,g,y,w,E,S,x,T,N;return Object(r.__generator)(this,function(C){switch(C.label){case 0:t=c.e.deserialize(e.itemKey),i=t.webAbsoluteUrl,s=t.types;o=a.e.serialize({webAbsoluteUrl:i});u=new b.e;return[4,n(W({webAbsoluteUrl:i,isMediaQuery:!!s&&s.indexOf("media")>-1}))];case 1:f=C.sent();l=[];for(h=0,p=f.d.GetDocumentLibraries.results;h<p.length;h++){g=p[h];y=new F.t({context:{webAbsoluteUrl:i}});w=y.getUrlParts({webUrl:i,listUrl:g.AbsoluteUrl,path:g.AbsoluteUrl});E={webAbsoluteUrl:i,listFullUrl:w.fullListUrl||"",rootFolder:""};S=d.e.serialize(E);x=j.e.serialize({webAbsoluteUrl:i,listFullUrl:w.fullListUrl||"",rootFolder:""});u.merge(n(Object(q.e)({itemKey:S,spItem:E})).itemResolver);u.resolveItems({items:(T={},T[S]=Object(r.__assign)({},v.l.pack(g.Title)),T[x]=Object(r.__assign)({},m.s.pack({itemKey:S})),T)});l.push(S)}u.resolveItems({items:(N={},N[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m.e.pack({itemKeys:l})),Object(_.e)().forFacet(m.e).thenInvalidate(I.e).pack()),a.e.pack({webAbsoluteUrl:i})),m.s.pack({itemKey:o})),N)});n(u.execute());return[2]}})})}}var V=n(170),$=n(689),J=n(11),K=n(1007),Q=Object(J.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=t.handlers,s=e.demandItemFacet(c.e,n);if(i&&s){for(var o=[],u=0,a=i;u<a.length;u++){var f=a[u];".JPEG"===Object(K.e)(f)&&o.push("media")}return o.length<1?{}:{itemKey:c.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{types:o}))}}return{}}}});var G=n(280),Y=new T.e("spSharedChannelGroupKeyFacet",{tenantRootUrl:Object(T.s)(),groupId:Object(T.s)(),tenantId:Object(T.s)()}),Z=n(379),ee=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,f,l,h,p,d,v,y,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=i(Object(D.e)({spHostPageWebAbsoluteUrl:g.Wt})).spHostPageWebAbsoluteUrl;s=Y.deserialize(n);o=t||s.tenantRootUrl;u=new Z.t({webAbsoluteUrl:o}).build().segments("GroupSiteManager","GetSharedChannelSharePointUrl").toString();f={tenantId:s.tenantId,groupId:s.groupId};return[4,i(Object(z.t)({url:u,method:"POST",body:JSON.stringify(f),qosName:"getSharedChannelGroupUrlFromSharePoint",webAbsoluteUrl:o,noRedirect:!0}))];case 1:l=E.sent();h=l.d.GetSharedChannelSharePointUrl;p=a.e.serialize({webAbsoluteUrl:h});d=c.e.serialize({webAbsoluteUrl:h});(v=new b.e).mapKeys({mappings:(y={},y[e.itemKey]=p,y)});v.resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)({},m.t.pack({itemKey:d})),w)});i(v.execute());return[2]}})})}});var te=new(n(2).e)("groupResourceCapability"),ne=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,u,a,f,l,c,h,p,d,y,w,E,S,x,T,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=new b.e;s=N.deserialize(n);a=i(Object(D.e)({spHostPageWebAbsoluteUrl:g.Wt})).spHostPageWebAbsoluteUrl;f=a||s.tenantRootUrl;l=new Z.t({webAbsoluteUrl:f}).build().segments("GroupSiteManager","GetCurrentUserSharedChannelMemberGroups").toString();c={};return[4,i(Object(z.t)({url:l,method:"POST",body:JSON.stringify(c),qosName:"getSharedChannelGroupsFromSharePoint",webAbsoluteUrl:f,noRedirect:!0}))];case 1:u=M.sent();h=[];p=JSON.parse(u.d.GetCurrentUserSharedChannelMemberGroups);for(d=0,y=p.value;d<y.length;d++){w=y[d];E=w.oid,S=w.tid,x=w.DisplayName,T=w.GroupResourceCapability,C=w.Acronym,k=w.BannerColor;L=Y.serialize({groupId:E,tenantId:S,tenantRootUrl:f});i(Object(o.e)({items:(A={},A[L]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.l.pack(x)),te.pack(T)),g.e.pack(C)),g.o.pack(k)),v.d.pack({})),A)}));h.push(L)}t.resolveItems({items:(O={},O[e.itemKey]=Object(r.__assign)({},m.e.pack({itemKeys:h})),O)});i(t.execute());return[2]}})})}});var re=n(422),ie=n(103),se=n(2784),oe=Object(J.t)()(function(){return function(e){return function(e,t){var n=(function(e,t){var n=this,i=t.stageItem;return i?Object(ie.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,e(Object(se.e)(function(e){return e.demandItemFacet(d.e,s,{suppressGetItems:!1})}))];case 1:return n.sent()?[4,e(i({currentItemKey:s,itemsScopeItemKey:t}))]:[3,3];case 2:n.sent();n.label=3;case 3:return[2]}})})}}):void 0})(0,{itemKey:t.itemKey,stageItem:t.stageItem});return n?{stageItem:n}:{}}}});var ue=n(146),ae=n(65),fe=Object(J.t)()(function(){return function(){return function(e,t){var n,i=t.itemKey,s=Object(ue.e)(e),o=Object(ae.e)(e);if(e.demandItemFacet(p.e,i)){var u=e.demandItemFacet(d.e,s),a=e.demandItemFacet(c.e,o);(u||a)&&(n={isToggled:!0})}return Object(r.__assign)({},n||{})}}});n.d(t,"e",function(){return ce});var le=Object(V.t)(Object(V.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("522")]).then(n.bind(null,4297))},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet"),ce=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.t)({keyFacet:a.e,facets:[v.l,m.t]}));e(Object(o.t)({keyFacet:f.e,facets:[f.e,m.e]}));e(Object(o.t)({keyFacet:l.e,facets:[l.e,m.e]}));e(Object(o.t)({keyFacet:c.e,facets:[c.e,m.e,m.t]}));e(Object(s.s)(h.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(w)));e(Object(s.s)(p.e,u.e)(Object(i.i)()(L)));e(Object(s.s)(l.e,u.e)(Object(i.i)()(P)));e(Object(s.s)(a.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(B)));e(Object(s.s)(c.e,u.e)(Object(i.i)({maxParallelOperationCount:8})(X)));e(Object(G.e)(c.e,$.e)(Q));e(Object(s.s)(f.e,u.e)(Object(i.r)(le)));e(Object(o.t)({keyFacet:Y,facets:[d.e]}));e(Object(s.s)(Y,u.e)(ee));e(Object(s.s)(N,u.e)(ne));e(Object(G.e)(Y,re.e)(oe));e(Object(G.e)(p.e,re.e)(fe));return[2]})})}})},,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(243),o=n(106),u=n(1045),a=n(880),f=n(189),l=n(1177),c=n(1),h=n(5),p=n(77),d=n(91),v=n(13),m=n(286),g=n(20),y=n(607),b=n(57),w=n(530),E=n(695),S=n(727),x=n(14),T=n(37),N=n(66),C=n(104),k=n(213),L=n(61),A=n(302),O=n(83),M=new C.e;function _(e,t){var n=Object(T.e)(e,{enableQuickEdit:c.$}).enableQuickEdit,r=Object(L.e)(e).itemsScopeItemKey,i=r&&Object(k.e)(e,{itemsScopeItemKey:r}),s=i&&i.id===A.e.id;return!!(n&&!!s&&!M.isIE)}var D=Object(x.n)()(Object(N.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("15").then(n.bind(null,4301))];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},_,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:O.e},n).deserizalizedKey,s=i&&i.viewKey&&f.e.serialize(i.viewKey),o=s&&e.demandItemFacet(c.dn,s);return _(e)&&o===r})),P=n(501),H=n(40),B=n(345),j=n(43),F=n(28),I=n(162);var q=Object(H.t)(function(e,t){var n,s,u,a,f,l,h=t.viewKey,d=t.itemSetKey,v=void 0,m=d&&e.demandItemFacet(O.e,d),g=e.demandItemFacet(c.v,h);if(m&&g){var y=o.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}),b=e.demandItemFacet(c.Be,y),w=e.demandItemFacet(c.Qt,B.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));w&&b&&b.id&&g&&"POWER"!==g.viewType&&b.permissions&&g.canUserEdit(b.permissions)&&(v=(n={webAbsoluteUrl:m.webAbsoluteUrl,layoutsUrl:w.layoutsUrl,viewId:g.id,listId:b.id,sourceUrl:g.serverRelativeUrl||""},s=n.webAbsoluteUrl,u=n.layoutsUrl,a=n.viewId,f=n.listId,l=n.sourceUrl,s+"/"+u+"/ViewEdit.aspx?"+Object(I.e)({View:p.e.normalizeUpper(a,!0),List:p.e.normalizeUpper(f,!0),Source:l})))}var E=!!v;return i.createElement(F.e,Object(r.__assign)({isAvailable:E,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(v);return[2]})})}},Object(j.t)(e,{itemKey:d,engagement:{name:"CustomizeView",isIntentional:!0}})))});var R=Object(N.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,2627))];case 1:return[2,e.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r}),U=n(65),z=n(2869),W=n(21),X=n(597),V=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,4133))];case 1:return[2,e.sent().ViewCreator]}})})}),$=Object(H.t)(function(e,t){var n=t.currentViewKey,s=Object(U.e)(e),u=Object(L.e)(e).itemsScopeItemKey,a=!1,f=e.demandItemFacet(O.e,s),l=e.demandItemFacet(c.v,n),h=e.demandItemFacet(z.e,s),p=z.e.evaluate(h)(e,{viewKey:n}).onViewSaved;if(f&&l){var d=o.e.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}),v=e.demandItemFacet(c.Be,d);a=!!(v&&l&&"POWER"!==l.viewType&&v.permissions&&(v.permissions.managePersonalViews||v.permissions.manageLists))}if(!l||!s||!u)return null;var m=Object(W.o)(function(e){return i.createElement(X.e,{itemsScopeItemKey:u},i.createElement(V,Object(r.__assign)({},e,t,{itemSetKey:s,viewTitle:l.title,isPublicView:!l.isPersonal,onViewSaved:p})))},{scope:"global"});return i.createElement(F.e,Object(r.__assign)({isAvailable:a,onExecute:m},Object(j.t)(e,{itemKey:s,engagement:{name:"SaveView",isIntentional:!0}})))}),J=n(3069),K=n(2),Q=Object(K.t)("createView"),G=Object(K.t)("switchView"),Y=Object(K.t)("needsAttentionView"),Z=Object(K.t)("setDefaultView"),ee=Object(K.t)("customizeView"),te=Object(K.t)("switchToFixedGridLayoutCommand"),ne=Object(K.t)("switchToDynamicGridLayoutCommand"),re=Object(K.t)("calendarMonth"),ie=Object(K.t)("kanban"),se=Object(K.t)("saveView"),oe=Object(K.t)("syncIssues"),ue=n(108),ae=n(303),fe=n(681),le=n(154),ce=n(9),he=n(3525);n.d(t,"e",function(){return be});var pe=[{ODB:1776},{ODB:1772},{ODB:60020}],de={ODB:1484},ve={iconName:void 0,styles:{root:{display:"none!important"}}},me=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3585))];case 1:return[2,e.sent().CreateViewAction]}})})}),ge={key:te,automationId:"switchToFixedGridLayoutCommand",name:m.e.fixedHeight,action:i.createElement(D,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},ye={key:ne,automationId:"switchToDynamicGridLayoutCommand",name:m.e.dynamicHeight,action:i.createElement(D,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function be(e,t){var n,d,x=t.viewKeys,T=t.webAbsoluteUrl,N=t.listViewSetKey,C=t.itemSetKey,k=t.currentViewKey,L=o.e.serialize({webAbsoluteUrl:N.webAbsoluteUrl,listFullUrl:N.listFullUrl}),A=Object(b.e)(e,{feature:de})&&pe.some(function(t){return Object(b.e)(e,{feature:t})}),O=e.demandItemFacet(c.Be,L),M=!!O&&!!O.templateType&&Object(v.s)(O.templateType),_=!!O&&!!O.templateType&&O.templateType===v.n.webPageLibrary,D=!1,H=m.e.Views,B=e.demandItem({showViewModifiedIndicator:c.St,currentDerivedView:c.v,currentViewBasicInfo:c.hn},k),j=B.showViewModifiedIndicator,F=B.currentDerivedView,I=B.currentViewBasicInfo;O&&F&&"POWER"!==F.viewType&&O.permissions&&F.canUserEdit(O.permissions)&&(D=!0);F&&F.title?H=F.title:I&&I.Title&&(H=I.Title);D&&(j||F&&F.isDirty())&&(H=g.format(m.e.ViewModifiedIndicator,H));var U=x.map(function(t){var n=e.demandItemFacet(c.wt,t),r=e.demandItemFacet(c.hn,t);return n&&!n.Hidden?we(n,T,C,F):r?we(r,T,C,F):void 0}).filter(function(e){return!!e}),z=(function(e,t){var n=e.demandItemFacet(c.Ke,t);return!(!n||!e.demandItemFacet(h.C,n))})(e,C),W=(function(e,t){var n,s,o=t.isPagesLib,u=t.isList,f=t.itemsNeedAttention,l=t.currentDerivedView,c=t.itemSetKey,h=a.e;if(o&&Object(b.e)(e,{feature:{ODB:1743}})){n=m.e.PagesThatNeedAttention;s="PagesThatNeedAttention"}else{n=u?m.e.ItemsThatNeedAttention:m.e.FilesThatNeedAttention;s=u?"ItemsThatNeedAttention":"FilesThatNeedAttention"}return{key:Y,automationId:"needsAttentionViewCommand",name:n,iconProps:f?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:ve,action:i.createElement(R,{viewId:h,currentDerivedView:l,itemSetKey:c}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ue.i.pack(!0)),he.r.pack(!0)),he.n.pack(!0)),engagement:{name:s}}})(e,{isList:M,isPagesLib:_,itemsNeedAttention:z,itemSetKey:C,currentDerivedView:F}),X=(function(e,t,n){var r=o.e.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(c.d,r),s=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(c.Jt,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(s=s.concat(r))});return s.length>0})(e,T,N.listFullUrl),V=M&&Object(b.e)(e,{feature:fe.t})&&!!e.demandItemFacet(c.Mt,le.e),K=u.n.serialize({webAbsoluteUrl:T,listFullUrl:N.listFullUrl}),G=V&&!!(null===(d=null===(n=e.demandItemFacet(ce.e,K))||void 0===n?void 0:n.itemKeys)||void 0===d?void 0:d.length),te=m.e.listSyncIssuesViewMenuItem,ne=G?{key:oe,automationId:"itemsWithSyncIssuesViewCommand",name:te,iconProps:G?{iconName:"error",styles:{root:"needsAttentionIcon_817fe717"}}:ve,action:K?i.createElement(ae.e,{itemKey:K}):void 0,facets:Object(r.__assign)(Object(r.__assign)({},he.n.pack(!0)),he.r.pack(!0))}:void 0,be=F?(function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,s=e.listViewSetKey,o=e.itemSetKey,u=e.allowEditCurrentView,a=f.e.serialize({viewId:n.id}),c=l.e.serialize(s),h=u||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:Q,automationId:"createViewCommand",name:m.e.CreateNewView,iconProps:ve,action:i.createElement(me,{listViewSetKey:c,currentViewKey:a,isEditing:!1}),facets:Object(r.__assign)(Object(r.__assign)({},he.n.pack(!0)),he.e.pack(!0))}]:[],[{key:se,automationId:"saveCommand",name:m.e.SaveViewAs,iconProps:ve,action:i.createElement($,{listViewSetKey:c,currentViewKey:a}),facets:Object(r.__assign)(Object(r.__assign)({},he.n.pack(!0)),he.t.pack(!0))},{key:Z,automationId:"setDefaultViewCommand",name:m.e.SetDefaultView,iconProps:ve,action:i.createElement(J.e,{currentDerivedView:n,listViewSetKey:s}),facets:Object(r.__assign)(Object(r.__assign)({},he.n.pack(!0)),he.t.pack(!0))}],h?[{key:ee,automationId:"customizeViewCommand",name:m.e.CustomizeView,iconProps:ve,action:"MODERNCALENDAR"===n.viewType?i.createElement(me,{listViewSetKey:c,currentViewKey:a,isEditing:!0}):i.createElement(q,{viewKey:a,itemSetKey:o}),facets:Object(r.__assign)(Object(r.__assign)({},he.n.pack(!0)),he.t.pack(!0))}]:[])})({listViewSetKey:N,isCreateNewViewEnabled:A,currentDerivedView:F,itemSetKey:C,allowEditCurrentView:D}):[],Ee=e.demandItemFacet(c.dn,k),Se="MODERNCALENDAR"===Ee?[{key:re,isPermanent:!1,automationId:"calendarMonthCommand",name:m.e.calendarMonthTitle,title:m.e.calendarMonthDesc,action:i.createElement(w.e,{layoutType:E.e}),iconProps:{iconName:"calendar"}}]:[],xe="KANBAN"===Ee?[{key:ie,isPermanent:!1,automationId:"kanbanCommand",name:m.e.kanbanLayoutTitle,title:m.e.kanbanLayoutDesc,action:i.createElement(w.e,{layoutType:S.e}),iconProps:{iconName:"TripleColumn"}}]:[],Te=[];if(y.e.subMenuProps){var Ne=e.demandItemFacet(c.pn,k),Ce=Ne&&Ne.viewFormatter,ke=Ce&&Ce.isTileDesignerTemplateApplied(),Le=Ce&&Ce.getTileProps(),Ae=!!(Le&&Le.formatter&&Le.formatter);if(M&&(ke||Object(b.e)(e,{feature:{ODB:1396}})&&!Ae))for(var Oe=0,Me=y.e.subMenuProps.items;Oe<Me.length;Oe++){var _e=Me[Oe];_e.key!==P.r?Te.push(_e):Te.push(Object(r.__assign)(Object(r.__assign)({},_e),{name:m.e.GalleryLayout,title:m.e.GalleryLayoutCommandTooltip,automationId:"galleryLayoutCommand"}))}else Te=y.e.subMenuProps.items}var De=[];X&&De.push(W);G&&ne&&De.push(ne);De.length>0&&De.push({name:"-",key:"divider_1",itemType:s.e.Divider});var Pe=Object(r.__spreadArrays)(Te,Se,xe,[{name:"-",key:"divider_1",itemType:s.e.Divider}],De,[ge,ye,{name:"-",key:"divider_1",itemType:s.e.Divider}],U,[{name:"-",key:"divider_1",itemType:s.e.Divider}],be,[{name:"-",key:"divider_1",itemType:s.e.Divider}]),He={name:H,key:y.e.key,automationId:y.e.automationId,iconProps:y.e.iconProps,title:m.e.SwitchViewsCommandTitle,ariaLabel:g.format(m.e.SwitchViewsCommandAriaLabel,H),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),z||G?{styles:{root:"needsAttentionIconOverlay_817fe717"}}:{})}:{})},subMenuProps:{items:Pe},facets:Object(r.__assign)({},ue.i.pack(!0))},Be=F?p.e.normalizeLower(F.id,!1):"";He.cacheKey=y.e.key+"_viewId_"+Be;return He}function we(e,t,n,s){var o=p.e.normalizeLower(e.Id,!1);return{key:G+"-"+o,automationId:"switchViewCommand_"+o,name:e.Title,iconProps:ve,action:i.createElement(R,{viewId:o,currentDerivedView:s,itemSetKey:n}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ue.i.pack(!0)),he.n.pack(!0)),he.r.pack(!0))}}},,,,,,,,,,function(e,t,n){"use strict";var r,i=n(0),s=n(706),o=n(458),u="NewFolder",a="NewDOC",f="NewXSL",l="NewPPT",c="NewONE",h="NewXSLSurvey",p="NewXSLForm",d="NewVSDX",v=((r={})[s.e.key]=u,r[o.o.key]=a,r[o.e.key]=f,r[o.i.key]=l,r[o.r.key]=c,r[o.t.key]=h,r[o.n.key]=p,r[o.s.key]=d,r);var m=n(71),g=n(252),y=n(3776),b=n(3528);var w=n(243),E=n("react-lib"),S=n(453),x=n(2),T=n(319),N=n(677),C=n(1632),k=n(67),L=n(3529),A=n(909),O=function(e){var t=e.template,n=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var r,i,s=t.url,o=A.e.serialize({listKey:n,templateUrl:s});return{key:new x.e("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:E.createElement(k.e,null,E.createElement(S.e,{documentType:Object(L.t)(s),templateItemKey:o})),iconProps:Object(T.e)({extension:(r=s,i=Object(N.t)(r,!0),Object(C.t)(i)),size:16})}};var M=n(2778);n.d(t,"e",function(){return _});function _(e,t){var n=t.contentTypes,r=t.newCommandMenu,E=t.fileHandlerCommands,S=t.isCreateFolderAvailable,x=t.newDocumentTemplates,T=t.contentTypeCommands,N=t.listKey,C={},k={},L=(function(){var e;return(e={})[u]=s.e,e[a]=o.o,e[f]=o.e,e[l]=o.i,e[c]=o.r,e[h]=o.t,e[p]=o.n,e[d]=o.s,e})(),A={},_=[],D=[];if(!m.e.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&x&&x.length){if(T)for(var P=0,H=T;P<H.length;P++){(F=H[P]).name&&(C[F.name]=F)}if(n)for(var B=0,j=n;B<j.length;B++){var F;C[(F=j[B]).displayName]&&F.contentTypeId&&(k[F.contentTypeId]=C[F.displayName])}var I=r.subMenuProps&&r.subMenuProps.items;if(I)for(var q=0,R=I;q<R.length;q++){(V=R[q]).name&&(L[V.name]=V);V.automationId&&(L[V.automationId]=V)}for(var U=void 0,z=0,W=x;z<W.length;z++){var X=W[z];X.isContentType&&X.contentTypeId&&(A[X.contentTypeId]=!0);var V=void 0;X.isUpload&&N?V=O({template:X,listKey:N}):X.isContentType&&X.contentTypeId&&k[X.contentTypeId]?V=k[X.contentTypeId]:L[X.title]?V=L[X.title]:X.templateId&&L[X.templateId]&&(V=L[X.templateId]);if(V){var $=X.templateId||v[V.key];$===u&&(U=!0);D.push(Object(i.__assign)(Object(i.__assign)({},X),{templateId:$,command:V}));if(X.visible){_.push(V);L[X.title]&&L[X.title].key===s.e.key&&_.push({name:"-",key:"divider_1",itemType:w.e.Divider})}}}!U&&S&&s.e.name&&D.unshift({command:s.e,templateId:v[s.e.key],title:s.e.name,visible:!1});for(var J in k)if(k.hasOwnProperty(J)&&!A[J]){var K=k[J];K.name&&D.push({command:K,contentTypeId:J,isContentType:!0,templateId:J,title:K.name,visible:!0});_.push(K)}}else{D=(function(e,t){var n=t.isCreateFolderAvailable,r=t.contentTypeCommands,i=void 0===r?[]:r,o=t.contentTypes,u=[];n&&s.e.name&&u.push({command:s.e,templateId:v[s.e.key],title:s.e.name,visible:!0});var a=!(!i||!i.length),f={};if(o)for(var l=0,c=o;l<c.length;l++){var h=c[l];h.contentTypeId&&(f[h.displayName]=h.contentTypeId)}if(a)for(var p=0,d=i;p<d.length;p++){if((x=d[p]).name){var m=f[x.name];u.push({command:x,contentTypeId:m,isContentType:!0,templateId:m,title:x.name||"",visible:!0})}}var w=g.e.subMenuProps&&g.e.subMenuProps.items;if(w)for(var E=0,S=w;E<S.length;E++){var x;(x=S[E]).name&&-1===[s.e.key,"divider_1","divider_2",y.e.key,b.e].indexOf(x.key)&&u.push({command:x,templateId:v[x.key],title:x.name,visible:!a})}return u})(0,{isCreateFolderAvailable:S,contentTypeCommands:T,contentTypes:n});T&&T.length?_.push.apply(_,Object(i.__spreadArrays)([s.e,{name:"-",key:"divider_1",itemType:w.e.Divider}],T)):_=r.subMenuProps?Object(i.__spreadArrays)(r.subMenuProps.items):[]}E&&E.new&&(_=Object(M.t)(_,E.new));return{visibleNewCommands:Object(i.__assign)(Object(i.__assign)({},g.e),{subMenuProps:{items:_}}),allCommands:D}}}],Array(27),[function(e,t,n){"use strict";var r=n(0),i=n(1157),s=n(83),o=n(16),u=n(193),a=n(247),f=n(2),l=n(9),c=n(123),h=n(64),p=n(133),d=n(37),v=n(2389),m=n(82),g=n(175),y=n(1);n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var b=new f.e("projection");var w=Object(o.i)()(function(e){var t=this,n=i.e.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,w;return Object(r.__generator)(this,function(E){t=s.e.serialize(n);(f=new u.e).resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},b.pack({})),Object(a.e)().forFacet(b).thenInvalidate(function(){return function(){o((function(e){var t=this,n=e.itemSetKey,o=s.e.deserialize(n),u=i.e.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){e(Object(c.e)(function(e){var t=Object(d.e)(e,{isProjectedUploadedItemSetEnabled:y.X}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=h.e.serialize(o),r=e.demandItemFacet(y.n,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(l.e,p.a),s=0,u=i&&i.itemKeys||[];s<u.length;s++){var a=u[s];if(e.demandItemFacet(v.t,a)){var f=e.demandItemFacet(m.o,a),c=e.demandItemFacet(h.e,f&&f.itemKey);if(c&&c.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(g.e)({items:(t={},t[u]=Object(r.__assign)({},l.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),w[t]=Object(a.e)().forFacet(l.e).thenInvalidate(e.itemKey,b).pack(),w)});o(f.execute());return[2]})})}})},function(e,t,n){"use strict";var r=n("react-lib"),i=n(67),s=n(2),o=n(286),u=n(0),a=n(755),f=n(234),l=n(551),c=n(146),h=n(36),p=n(64),d=n(106),v=n(935),m=n(477),g=n(1),y=n(13),b=n(42),w=n(467),E=n(40),S=n(71).e.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),x=Object(f.t)(function(){return{type:"file"}})(a.e),T=Object(E.e)(function(){return{fileSelector:x}})(l.e),N=Object(v.n)({uploadItemsAction:m.e},{uploadItemsAction:function(e,t){var n=Object(c.e)(e),r=e.demandItemFacet(p.e,n);if(!r)return{isAvailable:!1};var i=r.listFullUrl;if(!i)return{isAvailable:!1};var s=new w.e(i+"/Forms").path,o=p.e.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:""})),a=p.e.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:s})),f=S?o:n,l=e.demandItemFacet(g.st,f),h=b.t.hasItemPermission({permissions:l},b.t.manageLists);return{targetItemKey:a,isAvailable:h&&k(e,r)}}}),C=Object(E.t)(function(e,t){var n=t.engagement,i=Object(c.e)(e);return i?r.createElement(N,null,r.createElement(T,{itemKey:i,engagement:Object(h.p)({name:"UploadTemplate",isIntentional:!0},n)})):null});function k(e,t){var n=t&&e.demandItemFacet(g.Be,d.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==y.t.webPageLibrary&&!!n.newWOPIDocumentEnabled}n.d(t,"t",function(){return L});n.d(t,"e",function(){return A});var L={key:new s.e("UploadTemplate").id,automationId:"UploadTemplate",name:o.e.UploadTemplate,action:r.createElement(i.e,null,r.createElement(C,{engagement:{name:"UploadTemplate"}}))},A={key:new s.e("AddTemplate").id,automationId:"AddTemplate",name:o.e.AddTemplate,iconProps:{iconName:"Add"},action:r.createElement(i.e,null,r.createElement(C,{engagement:{name:"AddTemplate"}}))}},,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(227),o=n(3918),u=n(167),a=n(822);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=e.currentUserDisplayName,h=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(h=h.parameter("ViewId",i));s&&(h=h.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(h=h.parameter("ExcludeFieldFilteringHtml",!0));if(l){var p=u.default.getFilterParams(l,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:c});h=h.rawParameter(p)}return h.toString()}var l=n(1860),c=n(1185),h=n(64),p=n(345),d=n(217),v=n(29),m=n(16),g=n(117),y=n(193),b=n(194),w=n(77);n.d(t,"getSPFilterOptionSetHandler",function(){return E});var E=Object(m.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,o=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,c,m;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(b.e)({spDataSourceConfiguration:i.Ot})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=h.e.serialize(t),u=e(Object(g.e)({folderPath:i.fe},o)),a=e(Object(g.e)({internalName:i.Ee,mappedColumnFieldType:i.ze,isCalculated:i.xe},d.e.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,c=a&&a.mappedColumnFieldType===v.e.Taxonomy,m=a&&a.isCalculated,y=p.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(Object(g.e)({pageContext:i.Qt},y)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===w.e.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:m,filterParams:t.filterParams,excludeFieldFilteringHtml:c,viewId:x,currentUserDisplayName:E&&E.userDisplayName}}})({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey}));return[4,e((S=t,function(e){return e(Object(s.t)({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl,method:"POST",url:f(S),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:u=E.sent();a=l.e.getFilterData(u,t.fieldInternalName||"",t.isCalculatedField);(c=new y.e).resolveItems({items:(m={},m[n]=Object(r.__assign)({},i.ae.pack(a)),m)});e(c.execute());return[2]}var S})})}})},function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(600),o=n(1416),u=n(1),a=n(3053),f=n(14),l=n(40),c=n(5),h=n(2868),p=n(2867),d=n(2),v=n(3067),m=n(57),g=n(46);n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});var y=new d.e("fileHandlerOpenCommand").id,b={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},w=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:u.tt},n).appMap,s=r.name;r.key===h.e.key?s=s||(i?Object(a.o)(i,!0):a.e.Open):r.key===p.e.key&&(s=s||(i?Object(a.s)(i,!0):a.e.OpenInBrowser));return{name:s}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_8920b193"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8920b193"},e.name))}))),E=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:u.tt,fileName:c.h},n),o=s.appMap,f=s.fileName,l={};if(i&&i.items){var d=i.items[0];d&&-1!==d.key.indexOf(y)&&d.iconProps&&(l=d.iconProps)}var v=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),w={iconName:o?Object(a.t)(o):v?"PDF":"OpenFile"},E=Object(g.e)(e,n),x=Object(m.e)(e,{feature:b,pageContext:E}),T=void 0;i&&i.items&&(T=i.items.map(function(e){return e.key===h.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.o)(o,!0)||a.e.Open,onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e.key===p.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.s)(o,!0)||(v?a.e.OpenInBrowser:a.e.Open),onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e}));return{iconProps:l||w,onRenderIcon:o?S.bind(void 0,o,!1,x):void 0,text:a.e.Open,menuProps:T?Object(r.__assign)(Object(r.__assign)({},i),{items:T}):i}})(o.e)));function S(e,t,n){var r=e&&Object(a.n)(e),o=e&&Object(a.r)(e);return o&&n?i.createElement(v.e,{size:16,extension:"",brand:o.toLowerCase(),className:t?"menuItemBrandIcon_8920b193":"brandIcon_8920b193"}):r?i.createElement("span",{className:t?"menuItemIconContainer_8920b193":"iconContainer_8920b193"},i.createElement(s.e,{iconName:r.logoFill16,className:"logoFillIcon_8920b193"}),i.createElement(s.e,{iconName:r.logo16,className:"logoIcon_8920b193"})):null}},function(e,t,n){"use strict";var r=n(64),i=n(1187),s=n(1188),o=n(106),u=n(1),a=n(1087),f=n(121),l=n(3526);function c(e,t,n,r,i,s,o){return{key:n+r,name:r,action:t(o),iconProps:p(e,s,i)}}function h(e,t,n,r,i,s,o,u){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:p(e,s,i)}}function p(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function d(e,t,n,r,i,s){return Object(l.e)(e,t,c.bind(void 0,t.webAbsoluteUrl,r),h.bind(void 0,t.webAbsoluteUrl,i),n,s)}var v=n(71);n.d(t,"e",function(){return m});function m(e,t){var n,l=t.key,c=t.listKey,h=t.listFacets,p=t.pageContext,m=[],g=(function(e,t){var n=t.listKey,r=t.listFacets,i=t.pageContext,s=o.e.serialize(n),a=e.demandItemFacet(u.d,s);return!!(i&&!Object(v.t)(i).isActivated("2DEF0213-505E-4BB3-8441-19E3AEC0D352","3/19/21a")&&a&&a.length>1&&r.contentTypesEnabled)})(e,{listFacets:h,pageContext:p,listKey:c}),y=r.e.serialize(l),b=e.demandItemFacet(u.d,y);if(b&&b.length){b.forEach(function(t){var n=e.demandItemFacet(u.jt,t);n&&m.push(n)});if((g||!Object(a.e)(m,h))&&p){var w=new f.t({context:{webAbsoluteUrl:l.webAbsoluteUrl,listUrl:l.listFullUrl}}).getUrlParts({path:l.rootFolder});n=d(m,p,w,function(t){return l&&e.demandItemFacet(u.t,i.e.serialize({listKey:c,templateUrl:t}))},function(t){return l&&e.demandItemFacet(u.t,s.e.serialize({listKey:c,contentTypeId:t}))},h)}}return{contentTypes:m,contentTypeCommands:n}}},function(e,t,n){"use strict";var r=n(0),i=n(247),s=n(5),o=n(9),u=n(193),a=n(694),f=n(974),l=n(4),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(287),p=n(3502),d=n(2617),v=n(2236);n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});function m(e){var t,n=e.itemKey,l=e.driveItemKey,h=e.parentFolderItemKey,m=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?v.e:w,S=e.shouldInvalidateItemSetOnChildItemRename,x=void 0===S?void 0:S,T=new u.e,N=a.e.serialize({driveItemKey:l}),C=void 0;if(m){var k=Object(i.e)().forFacet(s.f).thenInvalidate(m,o.e).forFacet(s.A).thenInvalidate(m,o.e);x&&!x(b)||(k=k.forFacet(s.l).thenInvalidate(m,o.e));C=k.pack()}var L=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E({driveItemKey:l,driveItem:y,endpoint:b,parentFolderItemKey:h})),s.e.pack({itemKey:N})),C);T.resolveItems({items:(t={},t[n]=L,t)});if(y.lastModifiedBy){if(_=y.lastModifiedBy.user){var A=_.id&&c.serialize({id:_.id,endpoint:b});if(A=_.email&&d.e.serialize({email:_.email,endpoint:b})){var O=g({itemKey:n,personFacet:s.k,userKey:A,user:_}).itemResolver;T.merge(O)}}}if(y.createdBy){var M=void 0;if((_=y.createdBy.user)&&_.email&&(M=d.e.serialize({email:_.email,endpoint:b}))){O=g({itemKey:n,personFacet:f.r,userKey:M,user:_}).itemResolver;T.merge(O)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var _,D=void 0;if((_=y.remoteItem.shared.sharedBy.user).email&&(D=d.e.serialize({email:_.email,endpoint:b}))){O=g({itemKey:n,personFacet:p.e,userKey:D,user:_}).itemResolver;T.merge(O)}}return{itemResolver:T}}function g(e){var t,n,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,l=new u.e;l.resolveItems({items:Object(r.__assign)((t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.l.pack(f.displayName)),h.e.pack(f.email)),h.n.pack(f.id)),t),o&&(n={},n[i]=Object(r.__assign)({},o.pack({itemKey:a,displayValue:f.displayName})),n))});return{itemResolver:l}}},function(e,t,n){"use strict";var r=n(16),i=n(280),s=n(64),o=n(0),u=n("react-lib"),a=n(11),f=n(91),l=Object(f.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("27")]).then(n.bind(null,2914))];case 1:return[2,e.sent().PropertiesForm]}})})}),c=Object(a.t)()(function(){return function(e){return function(e,t){return{getPropertiesForm:function(e){return u.createElement(l,Object(o.__assign)({},e))}}}}});var h=n(3065);n.d(t,"e",function(){return p});var p=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,h.e)(c))}})},,,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(1398),o=n(3742),u=n(2338),a=n(1396),f=n(352);n.d(t,"e",function(){return l});var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_e592d114",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)}],Array(113),[function(e,t,n){"use strict";n.r(t);n.d(t,"uploadListItem",function(){return O});n.d(t,"mapConflictResolutionToNameConflictBehavior",function(){return M});var r=n(0),i=n(77),s=n(64),o=n(106),u=n(71),a=n(42),f=n(2951),l=n(3903),c=n(227),h=n(1),p=n(214),d=n(120),v=n(117),m=n(2139),g=n(175),y=n(2),b=n(82),w=n(822),E=n(123),S=n(191),x=n(5),T=n(13),N=n(194),C=n(3033),k=n(46),L=Object(S.e)(function(){return new l.e({maxParallelUploads:1/0})}),A=function(e){return function(t){var n=Object(k.e)(t,e);if(n){if(!!Object(u.t)(n).isActivated("3E300045-4874-4525-A1A3-29E5A7BF6BC7","10/21/2020","No longer disable streaming when download is disabled.")&&n.blockDownloadsExperienceEnabled)return!1}var r=t.demandItemFacet(h.st,e);return!(r&&!a.t.hasItemPermission({permissions:r},a.t.editListItems))}};function O(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,a=s.e.deserialize(n),l=a.webAbsoluteUrl,S=a.listFullUrl,O=Object.keys(u)[0],_=u[O],D=_.progressItemKey,P=_.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,_,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae;return Object(r.__generator)(this,function(fe){switch(fe.label){case 0:t=e(Object(c.n)({webAbsoluteUrl:l,listFullUrl:S})),u=t.dataRequestor,_=t.hasDigest;if(!t.hasTokenProvider)return[3,1];B=void 0;return[3,3];case 1:return[4,e(Object(c.e)({url:l||S,disallowCookies:!_}))];case 2:B=fe.sent();fe.label=3;case 3:H=B;if(!(j=e(Object(v.e)({sourceFile:m.t},O)).sourceFile))throw new Error("No source file for upload.");F=e(Object(v.e)({folderPath:h.fe},n)).folderPath;if(!(I=void 0===F?a.rootFolder:F))throw new Error("No path information for target folder.");q=e(Object(E.e)((function(e,t){return function(t){var n=Object(k.e)(t,e);return 1024*(n&&n.maximumFileSize||Number.POSITIVE_INFINITY)*1024}})(n)));j.size>q&&Object(C.n)(q);R=Object(w.r)({webAbsoluteUrl:l,listOrItemFullUrl:S});U=new p.e(void 0);z=U.debounce(function(t){var n;D&&e(Object(g.e)({items:(n={},n[D]=Object(y.n)({progressSize:b.m},{progressSize:{current:t}}),n)}))},300,{leading:!1});W=o.e.serialize({webAbsoluteUrl:l,listFullUrl:S});X=e(Object(E.e)(function(e){return e.demandItemFacet(h.Be,W)}));V=!(!X||!X.contentTypesEnabled||X.templateType===T.t.mySiteDocumentLibrary);$=M(P);J=e(Object(N.e)({clientName:d.t})).clientName;K=new f.e({authToken:H,onProgress:z,dataRequestor:u,nameConflictBehavior:$,webApiUrl:R,fileUpload:j,destinationUrl:I,appName:J||"Unknown",throttler:e(L),canStream:e(Object(E.e)(A(n))),itemExpansion:V?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"});D&&e(Object(g.e)({items:(oe={},oe[D]=Object(r.__assign)({},b.m.pack({total:j.size,current:0})),oe)}));Q=K.upload();G=e(Object(E.e)(function(e){return e.demandItemFacet(b.i,D)}));Y=G?G.token.subscribe(function(){K.abort()}):void 0;fe.label=4;case 4:fe.trys.push([4,6,7,8]);return[4,Q];case 5:Z=fe.sent();return[3,8];case 6:ee=fe.sent();K.abort();throw e(Object(C.t)(ee));case 7:Y&&Y();K.dispose();return[7];case 8:te=Z.ServerRelativeUrl;ne=Z.ListItemAllFields&&Z.ListItemAllFields.Id?String(Z.ListItemAllFields.Id):Z.ServerRelativeUrl;re=s.e.serialize({webAbsoluteUrl:l,listFullUrl:S,itemId:ne});ie=Z.UniqueId?i.e.normalizeLower(Z.UniqueId):"";se=Z.Name;D&&e(Object(g.e)({items:(ue={},ue[D]=Object(r.__assign)({},x.l.pack(se)),ue)}));e(Object(g.e)({items:(ae={},ae[re]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},x.l.pack(se)),ie?h.fn.pack(ie):{}),te?h.fe.pack(te):{}),x.A.pack({itemKey:n})),ae)}));return[2,{itemKey:re}]}})})}}function M(e){switch(e){case"replace":return 1;case"rename":return 2;default:return 0}}}],Array(19),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(16),i=n(3042),s=Object(r.t)(function(){return function(e){e(i.sharePointItemByFullUrlAddon)}})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(309),s=n(2),o=n(3537),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.e.getNPSSurveyFocusShortcut},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}}],Array(196),[function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(16),o=n(138),u=n(1001),a=n(293),f=n(1020),l=n(798),c=n(64),h=n(399),p=n(1177),d=n(83),v=n(745),m=n(1178),g=n(905),y=n(1189),b=n(902),w=n(1170),E=n(106),S=n(3056),x=n(3054),T=n(3055),N=n(3510),C=n(3511),k=n(3032),L=n(3058),A=n(1842),O=n(3513),M=n(2864),_=n(3059),D=n(280),P=n(866),H=n(2);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var B=new H.e("updateColumnFormatter"),j=(Object(o.i)({operationTypeFacet:B}),n(3729)),F=n(1195),I=n(1196),q=n(903),R=n(193),U=n(9),z=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=F.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(i.__generator)(this,function(o){(t=new R.e).resolveItems({items:(s={},s[n]=Object(i.__assign)({},U.e.pack({itemKeys:[I.e.serialize({tenantRootUrl:r}),q.e.serialize({tenantRootUrl:r})]})),s)});e(t.execute());return[2]})})}});var W=n(2784),X=n(123),V=n(184),$=n(27),J=n(154),K=n(589),Q=n(345),G=n(1),Y=n(5),Z=n(2399),ee=n(355),te=n(358),ne=n(688),re=n(258),ie=n(120),se=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=I.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:t=new R.e;return[4,e(Object(W.e)(function(e){var t=K.e.serialize({tenantRootUrl:r});return e.demandItemFacet(c.e,t,{suppressGetItems:!1})}))];case 1:return(s=C.sent())?[4,e(Object(W.e)(function(e){return e.demandItemFacet(G.Qt,Q.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))}))]:[2];case 2:o=C.sent();u=e(Object(X.e)(function(e){return{isSavedForLaterEnabled:e.demandItemFacet($.c,J.e),isSharedWithMeEnabled:!!e.demandItemFacet(ie.h,J.e)}})),a=u.isSavedForLaterEnabled,f=u.isSharedWithMeEnabled;l={};h=o&&o.userDisplayName;p=c.e.serialize(s);l[p]={icon:"FabricFolder",displayName:re.e.files};d=ee.e.serialize({endpoint:r+"/_api/v2.0"});l[d]={icon:"History",displayName:Z.e.recentTitle};v=te.e.serialize({endpoint:r+"/_api/v2.0"});l[v]={icon:"SingleBookmark",displayName:Z.e.saved};m=ne.e.serialize({endpoint:""+r});l[m]={icon:"People",displayName:Z.e.sharedWithMe};g=Object(i.__spreadArrays)([p,d],f?[m]:[],a?[v]:[]);for(y=0,b=g;y<b.length;y++){w=b[y];E=l[w],S=E.icon,x=E.displayName;t.resolveItems({items:(T={},T[w]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},V.t.pack(S)),Y.l.pack(x)),Y.d.pack({})),T)})}t.resolveItems({items:(N={},N[n]=Object(i.__assign)(Object(i.__assign)({},U.e.pack({itemKeys:g})),Y.l.pack(h)),N)});e(t.execute());return[2]}})})}});var oe=n(1197),ue=n(2616),ae=n(162),fe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=this,n=Object.keys(e.options),r=e.itemKey,s=n[0],o=e.options[s],u=o.type,a=o.reorderPinInfo,f=oe.e.serialize({itemKey:s,rootItemKey:r});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,o,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=e(Object(X.e)(function(e){return e.demandItem({siteId:G.xt,webId:G.vn,groupId:G.me},s)})),n=t.siteId,o=t.webId,l=t.groupId;c=new R.e;h=(function(e,t){switch(e){case"pin":return ce();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:ce()}return;default:return}})(u,a);c.resolveItems({items:(d={},d[f]=Object(i.__assign)({},G.ut.pack(h)),d)});e(c.execute());return(p=q.e.deserialize(r).tenantRootUrl)?[4,e(le(p,{siteId:n||"",webId:o||"",groupId:l},u,a))]:[3,2];case 1:m.sent();(c=new R.e).invalidateItems({items:(v={},v[f]=[G.ut],v)});e(c.execute());m.label=2;case 2:return[2]}})})}});function le(e,t,n,r){var s=this;return function(o){return Object(i.__awaiter)(s,void 0,void 0,function(){var s,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if("pin"===n){s="api/v1/sites/pinned/add";u="pinSite"}else if("unpin"===n){s="api/v1/sites/pinned/remove";u="unpinSite"}else{if("reorderPin"!==n)return[2];if(!r)return[2];a=Object(ae.e)({PreviousPinOrder:r.prevPinOrder||"",NextPinOrder:r.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+a;u="reorderSite"}return[4,o(Object(ue.t)({tenantRootUrl:e}))];case 1:f=i.sent();l="";t&&(l=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(Object(ue.e)({path:s,method:"POST",qosName:u,context:f,body:l}))];case 2:i.sent();return[2]}})})}}function ce(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}var he=n(2858),pe=n(1249),de=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(pe.e);e(Object(o.s)(F.e,a.e)(z));e(Object(o.s)(I.e,a.e)(se));e(Object(o.s)(q.e,he.t)(fe));return[2]})})}}),ve=n(1193),me=n(227),ge=n(822),ye=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=ve.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=b.e.serialize({webAbsoluteUrl:r});return[4,n(Object(W.e)(function(e){return e.demandItemFacet(G.nt,t)}))];case 1:s=m.sent();o=n(Object(X.e)(function(e){return e.demandItemFacet($.x,J.e)}));u=!s;f=o&&o.language||"en-US";l=Object(ae.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+l:Object(ge.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(me.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:c=m.sent();h=u?c:JSON.parse(c.d.GetSuiteNavData);p=!(!h.NavBarData||!h.NavBarData.AdminLink)||void 0;(d=new R.e).resolveItems({items:(v={},v[e.itemKey]=Object(i.__assign)({},G.sn.pack(p)),v)});n(d.execute());return[2]}})})}});var be=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.s)(ve.e,a.e)(ye));return[2]})})}}),we=n(2865),Ee=n(175),Se=n(888),xe=n(126),Te=n(57),Ne=n(720),Ce={ODB:1855},ke=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(h){switch(h.label){case 0:r=Object.keys(n)[0];s=n[r],o=s.updateType,u=s.formatter;return 0!==o?[3,1]:[2,e(Object(Ee.e)({items:(l={},l[r]=Object(i.__assign)({},G.m.pack(u)),l)}))];case 1:return 2!==o?[3,4]:[4,e(Object(W.e)(function(e){e.demandItemFacet(xe.e,xe.t.serialize({}))}))];case 2:h.sent();a=!1;f={};return[4,e(Object(W.e)(function(e){if(a=Object(Te.e)(e,{feature:Ce})){var n=e.demandItem({schema:U.o},t).schema,r=n&&n.columnKeys;r&&(f=Object(Ne.e)(e,r))}}))];case 3:h.sent();return[2,e(Object(Ee.e)({items:(c={},c[r]=Object(i.__assign)({},G.pn.pack(Object(Se.e)({formatter:u,fieldFormatters:f,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:a}}))),c)}))];case 4:return[2]}})})}}),Le=n(3060),Ae=n(117),Oe=n(368),Me=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){r=Object.keys(n)[0];s=n[r],o=s.displayName,u=s.fieldDescription,a=s.showInFiltersPane;if((f=e(Object(Ae.e)({setKey:d.e},t)).setKey)&&r&&(l=e(Object(Ae.e)({id:G.oe},r)).id)){c={__metadata:{type:"SP.Field"},Title:o,SchemaXml:u,ShowInFiltersPane:a};h=Object(ge.e)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}).method("Fields",l).toString();return[2,e(Object(me.t)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:h,qosName:"modifyFieldProperties",body:JSON.stringify(c),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(Ee.e)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==a?Oe.n.pack(a):{}),void 0!==o?Y.l.pack(o):{}),t)}))})]}return[2]})})}}),_e=n(204),De=n(880),Pe=n(306),He=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n),s={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:De.e}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(_e.n)({itemSetKey:s}));return[4,e(Object(_e.t)({itemSetKey:s,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,5,,7]);return[4,e(Object(Pe.e)({getItemContext:r}))];case 3:o=i.sent();return[4,e(Be(o,n))];case 4:i.sent();return[3,7];case 5:i.sent();return[4,e(Be(void 0,n))];case 6:i.sent();return[3,7];case 7:return[2]}})})}});function Be(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,s,o,u;return Object(i.__generator)(this,function(a){n=!1;(s=e&&e.ListData&&e.ListData.Row)&&s.length>0&&s[0]&&(n=!0);(o=new R.e).resolveItems({items:(u={},u[t]=Object(i.__assign)({},Y.C.pack(n||void 0)),u)});r(o.execute());return[2]})})}}var je=n(3780),Fe=n(372),Ie=n(39),qe=n(77),Re=n(2134),Ue=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){switch(M.label){case 0:r=void 0;o=void 0;for(u=0,a=Object.keys(t);u<a.length;u++){m=a[u];f=n(Object(Ae.e)({key:c.e,folderPath:G.fe},m));l=e.items[m];if(f&&f.key&&f.folderPath){if(!r){o=f.key.listFullUrl;r={webAbsoluteUrl:f.key.webAbsoluteUrl,items:[],checkInOutType:l.checkInOutType,checkInText:l.checkInText,checkInVersionType:l.checkInVersionType};o=f.key.listFullUrl}r.items.push({key:m,itemFullUrl:f.folderPath})}}if(!(h=r)||!h.items.length)return[3,4];p=h.items.length>1;d=void 0;d="checkIn"===h.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===h.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem";v="checkOut"===h.checkInOutType;if(p)return[3,2];m=h.items[0].key;g=ze(h.webAbsoluteUrl,h.items[0].itemFullUrl,h.checkInOutType,h.checkInText,h.checkInVersionType);return[4,n(Object(me.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:g,method:"POST",qosName:d}))];case 1:M.sent();n(Object(Ee.e)({items:(A={},A[m]=Object(i.__assign)({},Y.y.pack({byYou:!!v,byOther:void 0})),A)}));return[3,4];case 2:y=qe.e.generate();b="multipart/mixed; boundary=batch_"+y;return[4,n(Object(me.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:Re.t.getBatchOperationUrl(h.webAbsoluteUrl),body:We(h,y),method:"POST",additionalHeaders:void 0,contentType:b,parseResponse:function(e){return Re.t.processBatchResponse(e,h.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===Ie.t.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?Ie.t.failure:Ie.t.success})}:{eventData:n}}}))];case 3:if((w=M.sent()).hasError){N={items:{}};for(C=0,k=w.items;C<k.length;C++)(L=k[C]).error&&L.key&&(N.items[L.key]=new Fe.e({message:L.error.message}));throw new s.e(N)}E=new R.e;for(S=0,x=h.items;S<x.length;S++){T=x[S];E.resolveItems({items:(O={},O[T.key]=Object(i.__assign)({},Y.y.pack({byYou:!!v,byOther:void 0})),O)})}n(E.execute());M.label=4;case 4:return[2]}})})}});function ze(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(ge.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function We(e,t){var n=e.items,r=Re.t.defaultBatchRequestPostData,i=n.map(function(t){return ze(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return Re.t.getBatchContentExtended(t,i,"POST",r)}var Xe=n(2499),Ve=n(2619),$e=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:r=void 0;s=void 0;o="";u=!0;for(a=0,f=Object.keys(t);a<f.length;a++){S=f[a];l=n(Object(Ae.e)({key:c.e,folderPath:G.fe},S));h=n(Object(Ae.e)({key:c.e,uiVersion:G.un,contentTypeId:G.p},S)),p=h.uiVersion,d=h.contentTypeId;o=Ve.t(p);u=Ve.i(d);v=e.items[S];m=n(Object(Ae.e)({listItemId:G.Ie},S)).listItemId;if(l&&l.key&&l.folderPath){if(!r){s=l.key.listFullUrl;r={webAbsoluteUrl:l.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText};s=l.key.listFullUrl}r.items.push({key:S,itemFullUrl:l.folderPath,listItemId:m})}}if(!(g=r)||!g.items.length)return[3,4];y=g.publishActionType===Xe.e.SchedulePublish;b=y?"ScheduleItem":"PublishItem";w=0;C.label=1;case 1:if(!(w<g.items.length))return[3,4];E=g.items[w];S=E.key;x=u&&g.publishActionType!==Xe.e.CancelApproval;T=x?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(g.webAbsoluteUrl,E.listItemId,y):(function(e,t,n){var r="Publish";n&&n===Xe.e.CancelApproval&&(r="UnPublish");var i=Object(ge.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType);return[4,n(Object(me.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:s,url:T,body:!y&&x?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:b}))];case 2:C.sent();""!==o&&n(Object(Ee.e)({items:(N={},N[S]=Object(i.__assign)({},G.un.pack(o)),N)}));C.label=3;case 3:w++;return[3,1];case 4:return[2]}})})}});var Je=n(1239),Ke=n(2620),Qe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ke.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(X.e)(function(e){return e.demandItemFacet(G.Be,f)})))&&l.id&&o?[4,e(Object(me.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(ge.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:l.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent();e(Object(Je.e)({items:(c={},c[t]=[Y.l],c)}));i.label=3;case 3:return[2]}})})}}),Ge=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ke.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(X.e)(function(e){return e.demandItemFacet(G.Be,f)})))&&l.id&&o?[4,e(Object(me.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(ge.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:l.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent();e(Object(Je.e)({items:(c={},c[t]=[Y.l],c)}));i.label=3;case 3:return[2]}})})}}),Ye=n(156),Ze=n(121),et=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,s=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:t=c.e.deserialize(n);r=t.rootFolder||new Ye.e(t.listFullUrl).path;u=new Ze.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});a=u.getUrlParts({path:r});f=a.fullItemUrl;return[4,e(Object(me.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:tt({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:a.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,u=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!u)throw"Fail to create custom document";var a=f+"/"+u;e(Object(Ee.e)({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)({},Y.l.pack(u)),Y.i.pack(a)),r)}));e(Object(Je.e)({items:(o={},o[n]=[U.t],o)}))})];case 1:l.sent();return[2]}})})}});function tt(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(ge.e)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var nt=n(3412),rt=n(189),it=n(468),st=n(2212),ot=n(527);function ut(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new it.e(t.getEffectiveViewXml());n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0});n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}});if(r)for(var s in r)if(r.hasOwnProperty(s)){var o=r[s];st.updateFilter(i,o)}try{var u=Object(ot.e)(t.id,!0);if(u){i.updateColumnWidths(u);Object(ot.t)(t.id)}}catch(e){}return i}var at=n(194),ft=n(71),lt=n(46),ct=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,_,D,P;return Object(i.__generator)(this,function(H){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.sourceView,a=o.isPublic,f=o.itemSetKey,l=o.progressItemKey;if(u&&r){c=e(Object(Ae.e)({deserializedItemSetKey:d.e,filterableSet:G.Ht,childItems:U.e,parentItem:U.s,schema:U.o},f)),h=c.deserializedItemSetKey,v=c.filterableSet,m=c.childItems,g=c.parentItem,y=c.schema;b=h&&h.viewKey&&rt.e.serialize(h.viewKey)||"";w=e(Object(Ae.e)({viewType:G.dn},b)).viewType;(E=h?ut({sourceView:u,deserializedItemSetKey:h,appliedFilters:v&&v.appliedFilters}):u).prepareForSaving();S=e(Object(X.e)(function(e){return Object(lt.e)(e,f)}));x=S&&Object(ft.t)(S).isActivated("E05C14DE-D6D7-4E39-9616-2D192123BAC3","2/1/21","Include ViewTypeKind in payload");T=w&&it.e.getViewTypeInfo(w);N=!x&&T?T.viewTypeKind:void 0;C=T?T.viewType2:void 0;k=Object(ge.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add");_=u.getEffectiveAggregatesFieldXml();D=u.viewData,P=u.customFormatter;return[2,e(Object(me.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:k.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:u.getEffectiveFieldNames()},Query:E.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:u.rowLimit},N?{ViewTypeKind:N}:{}),C?{ViewType2:w}:{}),{ViewData:D})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;O={viewId:qe.e.normalizeLower(o.Id,!1)};A=new it.e(t.d);Object(ot.n)(A);var u=new R.e;u.resolveItems({items:(n={},n[rt.e.serialize(O)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},rt.e.pack(O)),G.wt.pack(o)),G.v.pack(A)),G.St.pack(!1)),n)});if(h){M=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:O}));u.resolveItems({items:(r={},r[M]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},m?U.e.pack(m):{}),g?U.s.pack(g):{}),y?U.o.pack(y):{}),r)})}l&&u.resolveItems({items:(s={},s[l]=Object(i.__assign)({},rt.e.pack(O)),s)});return e(u.execute())}).then(function(){var n,r;if(u.scope||_||P){var s={};u.scope&&(s.scope=u.scope);e(Object(at.e)({enableModernColumnTotalsSettings:G.q})).enableModernColumnTotalsSettings&&_&&(s.aggregations=_);P&&(s.customFormatter=P);return e(Object(L.e)({items:(n={},n[t]={views:(r={},r[A.id]=Object(i.__assign)({},s),r)},n)}))}}).then(function(){var n,r;return e(Object(Je.e)({items:Object(i.__assign)((n={},n[t]=[U.e],n),_?(r={},r[rt.e.serialize(O)]=[G.Nt],r):{})}))})]}return[2]})})}}),ht=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.isPublic,a=o.viewType,f=o.viewFields,l=o.viewStyles,c=o.viewData,h=o.queryXml,v=o.rowLimit,m=o.itemSetKey,g=o.progressItemKey;if(r){y=e(Object(Ae.e)({deserializedItemSetKey:d.e,childItems:U.e,parentItem:U.s,schema:U.o},m)),b=y.deserializedItemSetKey,w=y.childItems,E=y.parentItem;S=a&&it.e.getViewTypeInfo(a);x=S?S.viewTypeKind:void 0;T=S?S.viewType2:void 0;N=Object(ge.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});C=N.segment("Views").segment("Add");return[2,e(Object(me.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:C.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:f}},x?{ViewTypeKind:x}:{}),T?{ViewType2:T}:{}),{ViewData:c,CalendarViewStyles:l,Query:h,Paged:!0,PersonalView:!u,RowLimit:v})}),qosName:"CreateFreshView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;L=qe.e.normalizeLower(o.Id,!1);A={viewId:L};k=new it.e(o);Object(ot.n)(k);var u=new R.e;u.resolveItems({items:(n={},n[rt.e.serialize(A)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},rt.e.pack(A)),G.wt.pack(o)),G.v.pack(k)),G.St.pack(!1)),n)});if(b){O=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},b),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:A}));u.resolveItems({items:(r={},r[O]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},w?U.e.pack(w):{}),E?U.s.pack(E):{}),U.o.pack({columnKeys:[]})),r)})}g&&u.resolveItems({items:(s={},s[g]=Object(i.__assign)({},rt.e.pack(A)),s)});return e(u.execute())}).then(function(){var n;return e(Object(Je.e)({items:(n={},n[t]=[U.e],n)}))})]}return[2]})})}}),pt=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,d,v;return Object(i.__generator)(this,function(i){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.viewXml,a=o.viewTitle;if(r){f=r.webAbsoluteUrl,l=r.listFullUrl;c=Object(ge.e)({webAbsoluteUrl:f,listFullUrl:l});h=c.method("Views",s);d=e(Object(X.e)(function(e){return f&&l?e.demandItemFacet(G.Qt,Q.e.serialize({webAbsoluteUrl:f,listFullUrl:l})):void 0}));v=!!d&&!Object(ft.t)(d).isActivated("D554A99B-07B1-4652-8A7E-940F6CD0EE85","01/08/2021","Enable updating View Title in Edit view dialog");return[2,e(Object(me.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.method("SetViewXml").toString(),method:"POST",body:JSON.stringify({viewXml:u}),qosName:"saveViewXML"})).then(function(){v&&a&&e(Object(me.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.toString(),method:"MERGE",body:JSON.stringify({__metadata:{type:"SP.View"},Title:a}),qosName:"updateViewTitle"}))})]}return[2]})})}}),dt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=p.e.deserialize(t),s=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,u,a;return Object(i.__generator)(this,function(f){if(r&&s){o=n[s];u=Object(ge.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",s);a={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title};"number"==typeof o.scope&&(a.Scope=o.scope);if(o.aggregations){a.Aggregations=o.aggregations;a.AggregationsStatus="On"}o.customFormatter&&(a.CustomFormatter="<![CDATA["+o.customFormatter+"]]>");return[2,e(Object(me.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:u.toString(),method:"POST",body:JSON.stringify(a),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,u=e(Object(Ae.e)({childItems:U.e},t)).childItems;if(u){for(var a=new R.e,f=rt.e.serialize({viewId:s}),l=void 0,c=void 0,h=void 0,p=0,d=u.itemKeys;p<d.length;p++){var v=d[p],m=e(Object(Ae.e)({view:G.v},v)).view;if(m){if(m.isDefault){l=m;c=v}v===f&&(h=m)}}if("boolean"==typeof o.isDefault){if(o.isDefault&&l&&c){l.isDefault=!1;a.resolveItems({items:(n={},n[c]=Object(i.__assign)({},G.v.pack(l)),n)})}if(h&&f){h.isDefault=o.isDefault;a.resolveItems({items:(r={},r[f]=Object(i.__assign)({},G.v.pack(h)),r)})}}return e(a.execute())}})]}return[2]})})}}),vt=n(1180),mt=n(287),gt={key:vt.e,displayName:Y.l,email:mt.e,picture:mt.t},yt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=m.e.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=a&&Object(ge.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new R.e;return(f=t)?[4,e(Object(me.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=p.sent();p.label=2;case 2:l=[];(c=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&c.forEach(function(e){var t,n=e.email,i=vt.e.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(H.n)(gt,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});l.push(i)});r.resolveItems({items:(h={},h[n]=Object(i.__assign)({},Y.x.pack({personKeys:l})),h)});e(r.execute());return[2]}})})}});var bt=n(2621),wt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,s=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=p.e.deserialize(t);o=Object.keys(r)[0];if(!n||!o)return[3,4];u=r[o],a=u.itemSetKey,f=u.shouldSaveViewFieldsOnly,l=u.newDocumentTemplatesJsonString,c=u.shouldSaveAggregationsOnly;h=e(Object(Ae.e)({deserializedViewKey:rt.e,currentDerivedView:G.v},o)),v=h.deserializedViewKey,m=h.currentDerivedView;g=v&&v.viewId;if(!m||!g)return[3,4];y=void 0;return f||l||c?[4,e(Object(bt.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,viewId:g}))]:[3,2];case 1:if((b=i.sent())&&b.view){y=b.view;f?y.replaceFields(m.getEffectiveFieldNames()):l?y.updateNewDocumentTemplates(l):c&&y.replaceAggregates(m.getEffectiveAggregatesData())}return[3,3];case 2:w=e(Object(Ae.e)({deserializedItemSetKey:d.e,filterableSet:G.Ht},a)),E=w.deserializedItemSetKey,S=w.filterableSet;if(E){y=ut({sourceView:m,deserializedItemSetKey:E,appliedFilters:S&&S.appliedFilters});(x=e(Object(Ae.e)({viewType:G.dn},o)).viewType)&&y.updateViewType(x)}i.label=3;case 3:if(y){y.prepareForSaving();if(m.isDirty()||y.isDirty()){T=Object(ge.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",g).method("SetViewXml");return[2,e(Object(me.t)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:T.toString(),method:"POST",body:JSON.stringify({viewXml:y.getEffectiveViewXml()}),qosName:s||"saveView"}))]}}i.label=4;case 4:return[2]}})})}}),Et=n(89),St=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,S,x,T,N,C,k,L;return Object(i.__generator)(this,function(O){switch(O.label){case 0:if(!(r=e(Object(Ae.e)({setKey:d.e},t)).setKey))return[3,3];s=Object.keys(n)[0];o=n[s],u=o.modifyType,a=o.targetIndex;if(!(f=r.viewKey?rt.e.serialize(r.viewKey):void 0))return[3,3];if(!(l=e(Object(Ae.e)({currentDerivedView:G.v},f)).currentDerivedView))return[3,3];c=l.getEffectiveFieldNames();if(!(h=e(Object(Ae.e)({internalName:G.Ee},s)).internalName))return[3,3];if((v=c.indexOf(h))<0||1===u&&0===v||2===u&&v===c.length-1)return[2];m=l.isDirty();switch(u){case 0:l.updateField(h);break;case 1:l.updateField(h,v-1);break;case 2:l.updateField(h,v+1);break;case 3:l.updateField(h,a)}g={ODB:1318};y=e(Object(X.e)(function(e){return e.demandItemFacet(G.Qt,Q.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}));b=e(Object(X.e)(function(e){return{isAutoSaveEnabled:Object(Te.e)(e,{feature:g,pageContext:y}),list:e.demandItemFacet(G.Be,E.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}})),w=b.isAutoSaveEnabled,S=b.list;x=!1;return w&&S&&S.permissions&&S.permissions.manageLists?[4,e(Object(A.e)({items:(N={},N[p.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})]={views:(C={},C[f]={shouldSaveViewFieldsOnly:!0},C),qosName:"autoSaveModifyColumn"},N)})).then(function(){m||(l.baseViewXml=l.getEffectiveViewXml());x=!0},function(e){Et.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:h,modifyType:u,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:O.sent();O.label=2;case 2:T=new R.e;w&&x||T.resolveItems({items:(k={},k[f]=Object(i.__assign)({},G.St.pack(!0)),k)});T.invalidateItems({items:(L={},L[t]=[U.e],L[f]=[G.v],L)});e(T.execute());O.label=3;case 3:return[2]}})})}}),xt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,u;return Object(i.__generator)(this,function(a){n=Object.keys(t)[0];r=t[n],s=r.updateType,o=r.formatter;return 0===s?[2,e(Object(Ee.e)({items:(u={},u[n]=Object(i.__assign)({},G.m.pack(o)),u)}))]:[2]})})}}),Tt=n(3410),Nt=n(3038),Ct=n(2139),kt=n(82),Lt=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,s=v.e.deserialize(n),o=s&&s.itemSetKey,u=o.webAbsoluteUrl,a=o.listFullUrl,f=o.rootFolder,l=c.e.serialize({webAbsoluteUrl:u,listFullUrl:a,rootFolder:f}),h=Object.keys(r)[0],p=r[h].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e(Object(Ae.e)({sourceFile:Ct.t},h)).sourceFile;s=e(Object(at.e)({listItemUploader:G.qe})).listItemUploader,o=void 0===s?Nt.e:s;return[4,e(o({itemKey:l,options:{sourceEntries:r}}))];case 1:u=d.sent().itemKey;d.label=2;case 2:d.trys.push([2,4,,5]);return[4,e(Object(Tt.e)({items:(a={},a[u]={groupKey:n},a)}))];case 3:d.sent();return[3,5];case 4:d.sent();return[3,5];case 5:e(Object(Je.e)({items:(f={},f[l]=[U.t],f)}));p&&t&&e(Object(Ee.e)({items:(c={},c[p]=Object(i.__assign)(Object(i.__assign)({},kt.s.pack({itemKey:u})),Object(H.n)({progressSize:kt.m},{progressSize:{current:t.size}})),c)}));return[2]}})})}});var At=n(1199),Ot=Object(s.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,r=p.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,l,c,h,d,v,m;return Object(i.__generator)(this,function(g){switch(g.label){case 0:t=[];u=new R.e;a=E.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});f=e(Object(Ae.e)({list:G.Be},a));l=e(Object(at.e)({localeConfiguration:$.x})).localeConfiguration;return[4,e(Object(bt.t)({webAbsoluteUrl:s,listFullUrl:o,listTemplate:f.list&&f.list.templateType,preferredLanguage:l&&l.language}))];case 1:c=g.sent();h={};d=void 0;c.filter(function(e){return!!e.view}).map(function(n){var r,a=n.serverView,f=n.view,l={viewId:f.id},c=rt.e.serialize(l);if(f.isDefault){d=c;var p=f.getDomParts().newDocumentTemplates;p&&p.textContent&&u.merge(Object(At.e)({webAbsoluteUrl:s,listFullUrl:o,newDocumentTemplatesString:p.textContent}).itemResolver)}h[c]=f;Object(ot.n)(f);var v=e(Object(X.e)(function(e){if(e.isItemFacetResolved(G.v,c))return e.demandItemFacet(G.v,c)})),m=!!v&&v.getEffectiveViewXml().replace(/ \/>/g,"/>")===f.getEffectiveViewXml().replace(/ \/>/g,"/>");u.resolveItems({items:(r={},r[c]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},rt.e.pack(l)),G.wt.pack(a)),m?{}:G.v.pack(f)),G.St.pack(!1)),G.dn.pack(f.viewType)),r)});t.push(c)});t.sort(function(e,t){return h[e].compareTo(h[t])});u.resolveItems({items:(v={},v[n]=Object(i.__assign)(Object(i.__assign)({},p.e.pack(r)),U.e.pack({itemKeys:t})),v)});d&&u.resolveItems({items:(m={},m[a]=Object(i.__assign)({},G.b.pack({viewKey:d})),m)});e(u.execute());return[2]}})})}});var Mt=n(791),_t=n(725),Dt=n(278),Pt=n(502),Ht=n(235),Bt=n(51),jt=n(318),Ft=n(1163),It=n(13),qt=n(911),Rt=n(65),Ut=n(1164),zt=Object(s.i)()(function(e){var t=e.itemKey,n=g.e.deserialize(t),r=n.webAbsoluteUrl,s=n.listFullUrl;return function(e){var n,o=e(Object(Ft.t)({webAbsoluteUrl:r,listFullUrl:s}));if(o.listTemplate===It.t.mySiteDocumentLibrary){var u=new R.e;u.resolveItems({items:(n={},n[t]=Object(i.__assign)({},U.e.pack(void 0)),n)});e(u.execute());return Promise.resolve()}return e(Object(Ft.e)(r,s,o)).then(function(n){return e(Object(Ut.e)({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),Wt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=y.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.targetCustomActionSetKey,f=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,l,c,h,p,d,m,g,y,b;return Object(i.__generator)(this,function(w){switch(w.label){case 0:t=new R.e;r=E.e.serialize({webAbsoluteUrl:s,listFullUrl:o});l=e(Object(X.e)(qt.e));c=function(){var n;t.resolveItems({items:(n={},n[r]=Ht.o.pack(void 0),n)});e(t.execute())};if(!u&&!l){c();return[2]}return(p=l)?[4,l()]:[3,2];case 1:p=w.sent();w.label=2;case 2:d=!1;if(!(h=p))return[3,7];m=h.createListViewAdapter();t.resolveItems({items:(b={},b[r]=Object(i.__assign)({},m?Ht.o.pack(m):{}),b)});g=e(Object(Ae.e)({rawCustomActions:G.mt},a)).rawCustomActions;return[4,Xt({setKey:n,actions:g||[],listViewAdapter:m})];case 3:y=w.sent().itemResolver;t.merge(y);return[4,e(Object(W.e)(function(e){var n=Object(Rt.e)(e,f);if(n&&m){var r=e.demandItemFacet(U.e,n),u=r&&r.itemKeys,a=function(n){var r,s=e.isItemFacetResolved(G.bt,n)?e.demandItemFacet(G.bt,n):void 0;if(s&&m){var o=m.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?Ht.u.pack(o):{}),r)})}else if(e.demandItemFacet(v.e,n)){var u=e.isItemFacetResolved(U.e,n)?e.demandItemFacet(U.e,n):void 0;if(u)for(var f=0,l=u.itemKeys;f<l.length;f++){var c=l[f];a(c)}}};if(u)for(var l=0,c=u;l<c.length;l++){var h=c[l];a(h)}var p=e.demandItemFacet(U.o,n),g=p&&p.columnKeys||[];if(g&&m)for(var y=function(n){var r,i=e.demandItem({fieldId:G.oe,internalName:G.Ee,realFieldName:G.gt,fieldType:G.se,isRequired:Dt.r,displayName:Y.l,clientSideComponentId:Ht.e,clientSideComponentProperties:Ht.t},n),u=i.fieldId,a=i.internalName,f=i.realFieldName,l=i.fieldType,c=i.isRequired,h=i.displayName,p=i.clientSideComponentId,v=i.clientSideComponentProperties;if(u&&a){d=!0;var g={listKey:{webAbsoluteUrl:s,listFullUrl:o},internalName:a},y={id:u,internalName:f||a,fieldType:l||"Text",isRequired:c||!1,isVisible:!0,displayName:h||"",clientSideComponentId:p||qe.e.Empty,clientSideComponentProperties:v||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+a+",\n                      componentId: "+p+", error: "+e.message)}},b=m.addColumnAdapter(y);if(p&&p!==qe.e.Empty){var w=_t.e.serialize(g);t.resolveItems({items:(r={},r[w]=Ht.n.pack(b),r[n]=Ht.r.pack(w),r)})}}},b=0,w=g;b<w.length;b++){y(w[b])}}}))];case 4:w.sent();return d?[4,m.loadFieldCustomizers()]:[3,6];case 5:w.sent();w.label=6;case 6:return[3,8];case 7:c();w.label=8;case 8:e(t.execute());return[2]}})})}});function Xt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=e.setKey,n=e.actions,r=e.listViewAdapter;s=new R.e;o=[];u=0;a=function(e){var t,n,a,f,l,c,h,p,d,v,m,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];if(!Object(jt.t)(e))return[3,5];n=e.children;a=0;f=0,l=n;i.label=1;case 1:if(!(f<l.length))return[3,5];c=l[f];h=c.id?c.id:c.text+u+"."+a;p=Mt.e.serialize({actionId:h});return $t(c)&&r?[4,Vt({action:c,listViewAdapter:r})]:[3,3];case 2:d=i.sent(),g=d.actionKeys,m=d.itemResolver;s.merge(m);g.forEach(function(e){t.push(e)});i.label=3;case 3:t.push(p);a++;i.label=4;case 4:f++;return[3,1];case 5:return!Object(jt.t)(e)&&$t(e)&&r?[4,Vt({action:e,listViewAdapter:r})]:[3,7];case 6:v=i.sent(),m=v.itemResolver,g=v.actionKeys;s.merge(m);o=o.concat(g);i.label=7;case 7:u++;return[2]}})};f=0,l=n;p.label=1;case 1:if(!(f<l.length))return[3,4];c=l[f];return[5,a(c)];case 2:p.sent();p.label=3;case 3:f++;return[3,1];case 4:s.resolveItems({items:(h={},h[t]=Object(i.__assign)(Object(i.__assign)({},Bt.s.pack(!0)),U.e.pack(0===o.length?void 0:{itemKeys:o})),h)});return[2,{itemResolver:s}]}})})}function Vt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a;return Object(i.__generator)(this,function(f){switch(f.label){case 0:t=e.action,n=e.listViewAdapter;r=new R.e;s=[];o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";u=t.clientSideComponentProperties||"";return o&&o!==qe.e.Empty?[4,n.loadCommandSet(o,u).catch(function(){})]:[2,{itemResolver:r,actionKeys:[]}];case 1:(a=f.sent())&&a.commandAdapters&&a.commandAdapters.forEach(function(e){var n,o=t.clientSideComponentId+"."+e.commandId,u=Mt.e.serialize({actionId:o});r.resolveItems({items:(n={},n[u]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Y.l.pack(e.title)),Y.L.pack(t.action)),Pt.e.pack(t.allowMultiSelect)),Pt.n.pack(t.isEnabled||!1)),Pt.t.pack(e.iconUrl||t.iconUrl)),Ht.i.pack(e)),n)});s.push(u)});return[2,{itemResolver:r,actionKeys:s}]}})})}function $t(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==qe.e.Empty)||!1}var Jt=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(ge.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(me.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new R.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},G.nt.pack(a?void 0:{})),G.Qt.pack(o)),l)});n(f.execute());return[2]}})})}});var Kt=n(217),Qt=n(167),Gt=n(3057),Yt=n(2024),Zt=Object(s.n)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(X.e)(function(e){return e.demandItemFacet(v.e,r)}));if(!(s=t&&t.itemSetKey&&d.e.serialize(t.itemSetKey))||n.length<1||!r)return[2];o=e(Object(Ae.e)({spGroupField:G.qt,groupValue:G.be,parentGroupKey:G.it,defaultCollapsed:Bt.t},r)),u=o.spGroupField,a=o.groupValue,f=o.parentGroupKey,l=o.defaultCollapsed;c=[];u&&u.internalName&&a&&c.push({FieldName:u.internalName,FieldValue:a});if(f&&f.itemKey){h=e(Object(Ae.e)({parentGroupField:G.qt,parentGroupValue:G.be},f.itemKey)),p=h.parentGroupField,m=h.parentGroupValue;p&&p.internalName&&m&&c.push({FieldName:p.internalName,FieldValue:m})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(g=Qt.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(y=0;y<g.length;y++){b=g[y];w=e(Object(Ae.e)({isReadOnly:G.ke},Kt.e.serialize({listKey:t.itemSetKey,internalName:b.fieldName}))).isReadOnly;1===b.values.length&&!1===w&&c.push({FieldName:b.fieldName,FieldValue:b.values[0]})}return[4,e(Object(Gt.e)({items:(S={},S[s]={itemKeys:n,formValues:c,qosName:"AssignItemsToGroup"},S)}))];case 1:i.sent();E={};n.forEach(function(e){E[e]={}});return[4,e(Object(Yt.e)({items:(x={},x[s]=E,x)}))];case 2:i.sent();e(l?Object(Je.e)({items:(T={},T[r]=[U.e],T)}):Object(Je.e)({items:(N={},N[s]=[U.e],N)}));return[2]}})})}}),en=n(3516),tn=n(11),nn=n(3062),rn=Object(tn.t)()(function(){return function(e){return sn}});function sn(e,t){var n=t.itemKey,r=e.demandItem({driveItem:c.e,canonicalLinkUrl:Y.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new Ye.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(nn.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new Ye.e(t.webAbsoluteUrl).authority;return[4,n(Object(me.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var on=n(2400),un=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.isNewDocumentUpdate,s=n.checkInComment,o=n.formValues;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o.length>0?[4,e(Object(Ke.e)(t))]:[3,3];case 1:n=i.sent(),u=n.key,a=n.itemId;f=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(ge.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,itemId:a||u.itemId||""});(l={}).formValues=o;l.bNewDocumentUpdate=r;l.checkInComment=s;return[4,e(Object(me.t)({body:JSON.stringify(l),listFullUrl:u.listFullUrl,method:"POST",qosName:"updateItem.ValidateUpdateListItem",url:f,webAbsoluteUrl:u.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:i.sent();i.label=3;case 3:return[2]}})})}});var an=n(328),fn=n(684);var ln=n(274),cn=n(314),hn=Object(s.i)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:r=d.e.deserialize(t);s=n(Object(_e.n)({itemSetKey:r}));o=Object.keys(e.options);return[4,n((h={itemSetKey:t,itemKeys:o},function(e){for(var t=h.itemSetKey,n=h.itemKeys,r=e(Object(X.e)(function(e){var n=e.demandItemFacet(d.e,t)||d.e.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object(lt.e)(e,c.e.serialize(n))})})),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.pageContext,a=[],f=0,l=n;f<l.length;f++){var p=l[f],v=c.e.deserialize(p).itemId;v||(v=e(Object(Ae.e)({listItemId:G.Ie},p)).listItemId);v&&a.push(v)}var m=e(Object(fn.e)({internalName:G.Ee},t)),g=["Modified"];if(m)for(var y=0,b=m;y<b.length;y++){var w=b[y];w.internalName&&"Modified"!==w.internalName&&g.push(w.internalName)}return{webAbsoluteUrl:s,listFullUrl:o,currentPageContext:u,qosName:"refreshItemsInSet",viewXml:Object(an.r)({itemIds:a,recurseInFolders:!0,pageSize:n.length,fieldNames:g.length>0?g:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:u=l.sent();return[4,n(Object(Pe.e)({getItemContext:u}))];case 2:a=l.sent();f=n(Object(ln.t)({serverData:a,itemSetKey:r,currentPageContext:u.currentPageContext,contentTypes:s,isItemSetRequest:!0})).itemResolver;n(f.execute());n(Object(cn.e)({itemSetKey:t,serverData:a,isItemSetRequest:!0}));return[2]}var h})})}}),pn=n(3517),dn=Object(tn.t)()(function(){return function(e){return vn}});function vn(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:c.e},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(nn.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new Ye.e(t.webAbsoluteUrl).authority;return[4,n(Object(me.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var mn=n(3061),gn=Object(tn.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},s=e.demandItemFacet(G.Be,E.e.serialize(i)),o=e.demandItemFacet(G.Qt,Q.e.serialize(i));if(!o)return{};var u=s&&s.templateType===It.t.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:u?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var yn=n(3515),bn=n(145),wn=n(840),En=n(382),Sn=Object(tn.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:c.e,driveItemKey:bn.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(wn.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:En.t},E.e.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],l=s.rootFolder||"",h="";if(l){var p=new Ze.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=l.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var xn=n(495),Tn=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,s=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(n=e(Object(Ae.e)({setKey:d.e},t)).setKey))return[3,2];if(!(o=n.viewKey?rt.e.serialize(n.viewKey):void 0))return[3,2];if(!(u=e(Object(Ae.e)({currentDerivedView:G.v},o)).currentDerivedView))return[3,2];a=e(Object(Ae.e)({internalName:G.Ee,fieldType:G.ue,fieldFieldType:G.se},s)),f=a.internalName,l=a.fieldType,c=a.fieldFieldType;if(!f)return[3,2];h=e(Object(Ae.e)({spFolderAggregates:G.l},t)).spFolderAggregates;v=u.isDirty();if(!(m=h&&h[s]?h[s].aggregateFunctionType:void 0)&&0===r||m===xn.e[r])return[2];g=0===r?void 0:xn.e[r];u.updateColumnAggregateType(f,g);return[4,e(Object(A.e)({items:(y={},y[p.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(b={},b[o]={shouldSaveAggregationsOnly:!0},b),qosName:"SaveModifyColumnAggregateType"},y)})).then(function(){var n,r=u.getEffectiveViewXml(),i=new it.e(u.baseViewXml||"");i.replaceAggregates(u.getEffectiveAggregatesData());u.baseViewXml=i.getEffectiveViewXml();u.setDom(r);u.setIsDirty(v);var s=new R.e;s.invalidateItems({items:(n={},n[t]=[U.e],n[o]=[G.Nt],n)});e(s.execute())},function(e){Et.e.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:l,fieldFieldType:c,currentAggregateType:m||"None",newAggregateType:g||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});u.updateColumnAggregateType(f,m);u.setIsDirty(v);throw e})];case 1:i.sent();i.label=2;case 2:return[2]}})})}}),Nn=n(3514),Cn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.bNewDocumentUpdate,o=n.checkInComment,u=n.formValues,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,f,l,c,h,p,v,m,g,y,b,w,E,S,x;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(u&&u.length&&r&&r.length))return[2];n=d.e.deserialize(t),f=n.viewKey,l=n.rootFolder,c=n.webAbsoluteUrl,h=n.listFullUrl;p=l||"";f&&(!(v=e(Object(Ae.e)({currentDerivedView:G.v},rt.e.serialize(f))).currentDerivedView)||1!==v.scope&&2!==v.scope||(p=""));m=[];g={};y=0,b=r;i.label=1;case 1:if(!(y<b.length))return[3,4];w=b[y];return[4,e(Object(Ke.e)(w))];case 2:E=i.sent().itemId;m.push(parseInt(E,10));g[E]=w;i.label=3;case 3:y++;return[3,1];case 4:S=Object(ge.e)({webAbsoluteUrl:c,listFullUrl:h}).method("BulkValidateUpdateListItems").toString();x={itemIds:m,formValues:u,folderPath:p,bNewDocumentUpdate:s,checkInComment:o};return[4,e(Object(me.t)({body:JSON.stringify(x),listFullUrl:h,method:"POST",qosName:a,url:S,webAbsoluteUrl:c,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{g[a.ItemId]&&(s[g[a.ItemId]]={})}}Object.keys(s).length>0&&e(Object(Yt.e)({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:i.sent();return[2]}})})}}),kn=n(1423),Ln=n(1424),An=n(1425),On=n(1205),Mn=n(2866),_n=n(489),Dn=n(350),Pn=n(467),Hn=Object(s.n)()(jn),Bn=Object(s.n)()(jn);function jn(e){var t=this,n=e.items,r=n[Object.keys(n)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];return[4,e(Fn({itemSetKey:r}))];case 1:o=i.sent();u=function(n){var r=e(Object(X.e)(function(e){return e.demandItemFacet(Y.i,n)}))||"",i={DecodedUrl:decodeURIComponent(r)};i&&t.push(i)};for(a=0,f=Object.keys(n);a<f.length;a++){l=f[a];u(l)}s=JSON.stringify({itemPaths:t});c="RemoveItemsFromSharedWithMeViewByPath";h=Object(ge.n)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+c);return[4,e(Object(me.t)({url:h.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:s,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[c]&&p.d[c].results){if((d=p.d[c].results).length<1)throw new Fe.e({message:_n.e.DefaultTitle});d.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new Fe.e({message:e.ErrorMessage||void 0})})}(v=new R.e).invalidateItems({items:(m={},m[r]=[U.e],m)});e(v.execute());return[2]}})})}}function Fn(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:"";t=e(Object(X.e)(function(e){return e.demandItemFacet(Dn.e,n)}));r=t&&t.driveItemKey.endpoint||"";return[4,e(Object(W.e)(function(e){return e.demandItemFacet(c.e,K.e.serialize({tenantRootUrl:new Pn.e(r).authority}))}))];case 1:s=i.sent();return[2,s&&s.webAbsoluteUrl||""]}})})}}var In=n(4142),qn=n(3922),Rn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.relativeItemKey,o=[];r.forEach(function(e){if(c.e.matches(e)){var t=c.e.deserialize(e).itemId;void 0===t||isNaN(Number(t))||o.push(Number(t))}});var u=d.e.deserialize(t),a=u.webAbsoluteUrl,f=u.listFullUrl,l=u.viewKey,h=!!l&&l.viewId,p=void 0;if(s&&c.e.matches(s)){var v=c.e.deserialize(s);v&&(p=v.itemId&&!isNaN(Number(v.itemId))?Number(v.itemId):void 0)}if(!h||o.length<1||s&&!p)throw new Error("Invalid parameters to reorderListItemsOperationHandler");var m=Object(ge.e)({webAbsoluteUrl:a,listFullUrl:f}).method("AddCustomOrderToView").toString();return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n={viewId:h,itemIds:o,relativeItemId:p};return[4,e(Object(me.t)({webAbsoluteUrl:a,listFullUrl:f,url:m,body:JSON.stringify(n),method:"POST",qosName:"ReorderItems",noRedirect:!0}))];case 1:return i.sent()?[4,e(Object(Je.e)({items:(r={},r[t]=[U.e],r)}))]:[3,3];case 2:i.sent();i.label=3;case 3:return[2]}})})}}),Un=n(3518),zn=n(2854);n.d(t,"spDataOnlyAddonDeferred",function(){return Wn});n.d(t,"spItemUploadItemsOperationHandler",function(){return kn.spItemUploadItemsOperationHandler});n.d(t,"spItemCreateFolderOperationHandler",function(){return Ln.spItemCreateFolderOperationHandler});n.d(t,"spItemCreateDocumentOperationHandler",function(){return An.spItemCreateDocumentOperationHandler});n.d(t,"getSPFilterOptionSetHandler",function(){return je.getSPFilterOptionSetHandler});var Wn=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.s)(l.e,a.e)(He));e(Object(o.s)(c.e,x.t)(Ue));e(Object(o.s)(c.e,T.t)($e));e(Object(o.s)(c.e,N.t)(Qe));e(Object(o.s)(c.e,C.t)(Ge));e(In.sharePointBasicActionsAddonDeferred);e(Object(o.s)(c.e,f.t)(et));e(Object(o.s)(h.e,S.e)(nt.n));e(Object(o.s)(c.e,k.e)(Zt));e(Object(o.s)(p.e,O.t)(ct));e(Object(o.s)(p.e,M.t)(ht));e(Object(o.s)(p.e,_.t)(pt));e(Object(o.s)(p.e,L.t)(dt));e(Object(o.s)(p.e,A.t)(wt));e(Object(o.s)(d.e,P.t)(St));e(Object(o.s)(d.e,Nn.t)(Tn));e(Object(o.s)(d.e,B)(xt));e(Object(o.s)(d.e,Yt.t)(hn));e(Object(o.s)(d.e,Gt.t)(Cn));e(Object(o.s)(v.e,u.t)(Lt));e(Object(o.s)(m.e,a.e)(yt));e(Object(o.s)(p.e,a.e)(Ot));e(Object(o.s)(g.e,a.e)(zt));e(Object(o.s)(y.e,a.e)(Wt));e(Object(o.s)(b.e,a.e)(Jt));e(Object(o.s)(d.e,we.t)(ke));e(Object(o.s)(d.e,Le.t)(Me));e(Object(D.e)(c.e,mn.e)(gn));e(Object(D.e)(c.e,yn.e)(Sn));e(qn.sharePointBasicItemDataAddonDeferred);e(On.e);e(j.e);e(de);e(be);e(Object(D.e)(c.e,en.e)(rn));e(Object(o.s)(c.e,on.e)(un));e(Object(D.e)(c.e,pn.e)(dn));e(Object(o.s)(c.e,Mn.n)(Hn));e(Object(o.s)(w.e,Mn.n)(Bn));e(Object(o.s)(d.e,Un.t)(Rn));e(Object(o.s)(E.e,zn.e)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("36").then(n.bind(null,4299))];case 1:return[2,e.sent().spListAddContentTypesToListOperationHandler]}})})})));return[2]})})}})},,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(16),s=n(138),o=n(280),u=n(145),a=n(1019),f=n(988),l=n(1015),c=n(1001),h=n(622),p=n(874),d=n(873),v=n(477),m=n(610),g=n(621),y=n(840),b=n(1674),w=n(82),E=n(9),S=n(2236),x=n(193),T=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.folders,i=u.e.deserialize(t),s=i.endpoint,o=i.driveId,a=i.itemId,f=Object.keys(n)[0],l=n[f].progressItemKey,c=Object(y.n)(i);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,h,p,d,v,m,g,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:n=Object(y.t)(i)+"/children";h={name:f,folder:{},"@microsoft.graph.conflictBehavior":"rename"};o&&a&&(h.parentReference={driveId:o,id:a});return[4,e(Object(b.n)({url:n,driveUrl:c,method:"POST",body:h,qosName:"createFolder",endpoint:s}))];case 1:p=N.sent();d=u.e.serialize({endpoint:s,driveId:o,itemId:p.id});v=new x.e;l&&v.resolveItems({items:(m={},m[l]=Object(r.__assign)({},w.s.pack({itemKey:d})),m)});v.invalidateItems({items:(g={},g[t]=[E.t],g)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:p,parentFolderItemKey:t,endpoint:s})),T)});e(v.execute());return[2]}})})}}),N=n(1239),C=n(5),k=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=Object(y.t)(n);return[4,e(Object(b.n)({url:i,method:"DELETE",qosName:"deleteItem",endpoint:n.endpoint}))];case 1:r.sent();e(Object(N.e)({items:(s={},s[t]=[C.f],s)}));return[2]}})})}}),L=n(372),A=n(249),O=n(117),M=n(1856),_=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.names,i=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:s=Object.keys(n)[0];o=n[s],u=o.newName,a=o.newExtension;f=Object(y.t)(i);l=Object(y.n)(i);c=e(Object(O.e)({fileName:C.h},t)).fileName;h="string"==typeof a?a:c&&c.extension||"";return[4,e(Object(b.n)({url:f,driveUrl:l,method:"PATCH",body:{name:""+u+h},qosName:"renameItem",endpoint:i.endpoint})).then(function(n){var i,s,o=new x.e;o.invalidateItems({items:(i={},i[t]=[C.l],i)});o.resolveItems({items:(s={},s[t]=Object(r.__assign)(Object(r.__assign)({},C.l.pack(n.name)),C.h.pack(Object(S.t)(n.name||"",!!n.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof M.e&&e.status===L.t)throw new L.e({facets:Object(r.__assign)({},A.m.pack({})),innerError:e});throw e})];case 1:p.sent();return[2]}})})}}),D=n(4030),P=n(4028),H=n(4026),B=n(4029),j=n(4027),F=n(2347),I=n(214),q=n(191),R=n(123),U=n(2139),z=n(175),W=n(2),X=n(54),V=n(186),$=Object(q.e)(function(){return new H.e({},{})}),J=Object(q.e)(function(e){var t=e(b.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:j.t})||this}return t})(j.e),i=new P.e({},{dataRequestor:t}),s=new B.e({},{activityBandwidthVerifierType:n,uploadService:i});return new D.e({},{uploadService:i,uploadStateMachine:s})}),K=0;function Q(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,b,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:if(!(t=e(Object(O.e)({sourceFile:U.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(y.t)(s)+":";l=Object(y.n)(s);c&&e(Object(z.e)({items:(m={},m[c]=Object(r.__assign)({},w.m.pack({total:t.size,current:0})),m)}));return[4,e(G({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=N.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new x.e;c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},w.s.pack({itemKey:d})),Object(W.n)({progressSize:w.m},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(b={},b[n]=[E.t],b)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:h,parentFolderItemKey:n,endpoint:o})),T)});return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function G(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=e(J);f=e($);return[4,e(Object(F.t)(u,o))];case 1:l=b.sent();h=new I.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(z.e)({items:(r={},r[n]=Object(W.n)({progressSize:w.m},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(R.e)(function(e){return e.demandItemFacet(w.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++K},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});g=v?v.token.subscribe(function(){m.cancel()}):void 0;b.label=2;case 2:b.trys.push([2,4,5,6]);return[4,m];case 3:return[2,b.sent()];case 4:y=b.sent();if(X.n.isCanceled(y))throw new V.e;throw new c.e({facets:Object(r.__assign)({},Object(M.t)(y,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return A.e.pack({});case"nameAlreadyExists":case 409:return A.i.pack({supportsRename:!0})}})||Object(W.n)({},{})),innerError:y});case 5:g&&g();h.dispose();return[7];case 6:return[2]}})})}}var Y=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(Q(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var Z=n(11),ee=n(2498),te=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.e,n)}}}});var ne=n(2863),re=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.r,n),validator:ne.e}}}});var ie=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.t,n)}}}});var se=Object(Z.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ee.i,n)}}}});var oe=Object(Z.t)()(function(){return function(e){return ue}});function ue(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(C.d,n))return{};var i=e.demandItemFacet(u.e,n),s=i?Object(y.t)(i):void 0,o=i?Object(y.n)(i):void 0,a=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(ee.n,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(b.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof M.e){f=Object(M.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return A.r.pack({});case"itemNotFound":case 404:return A.u.pack({});case"accessDenied":case 403:return A.e.pack({});default:return A.m.pack({})}});throw new L.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:a})}:void 0}}var ae=Object(Z.t)()(function(){return function(e){return fe}});function fe(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(y.t)(t)+"/invite";s=Object(y.n)(t);return[4,n(Object(b.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var le=Object(Z.t)()(function(){return function(){return function(){return{}}}});var ce=Object(Z.t)()(function(){return function(e){return he}});function he(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(b.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var pe=n(3516),de=n(3517),ve=n(431),me=n(120),ge=n(194),ye=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=n.isFollowed,s=n.progressItemKey,o=ve.e.deserialize(t),a=o.driveItemKey,f=a.itemId,l=void 0===f?"":f,c=Object(y.n)(a);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,f,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=e(Object(ge.e)({saveForLaterGraphEndpoint:me.w})).saveForLaterGraphEndpoint;n=new x.e;f=ve.e.serialize(o);h=t||a.endpoint;s&&e(Object(z.e)({items:(v={},v[s]=Object(r.__assign)({},w.g.pack({itemKey:u.e.serialize(a)})),v)}));p=i?{url:h+"/drives/"+a.driveId+"/items/"+l+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+a.driveId+"/following/"+l,method:"DELETE",qosName:"unfollowItem"};y.label=1;case 1:y.trys.push([1,3,,4]);return[4,e(Object(b.n)({url:p.url,driveUrl:c,method:p.method,qosName:p.qosName,endpoint:h}))];case 2:y.sent();n.invalidateItems({items:(m={},m[f]=[C.b],m)});n.resolveItems({items:(g={},g[f]=Object(r.__assign)({},C.b.pack(i||void 0)),g)});e(n.execute());return[3,4];case 3:d=y.sent();throw new Error(d.message);case 4:return[2]}})})}}),be=n(500),we=n(910),Ee=n(2063),Se=n(2618);function xe(e,t){return Se.e.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Te=Object(Z.t)()(Ce),Ne=Object(Z.t)()(Ce);function Ce(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(Ee.e,r);if(i)n=function(e){return i?xe(i,e):void 0};else{var s=e.demandItemFacet(Se.e,r);n=function(e){return s?xe(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var ke=n(689),Le=n(1007),Ae=n(385),Oe=Object(Z.t)()(function(){return function(e){return Me}});function Me(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Ee.e,i),o=e.demandItemFacet(Se.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===Ae.o.key)u.push("photo");else if(l.key===Ae.u.key)u.push("video");else if(l.key===Ae.e.key)u.push("folder");else if(l.key===Ae.s.key)u.push("onenote");else if(l.key===Ae.r.key)u.push("!photo");else if(l.key===Ae.i.key)u.push("!video");else if(l.key===Ae.t.key)u.push("!folder");else if(l.key===Ae.n.key)u.push("!onenote");else{var c=Object(Le.e)(l);c&&u.push(c)}}if(s)return{itemKey:Ee.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var _e=n(2847),De=n(2784),Pe=n(2860),He=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=Object.keys(n)[0];return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,a,f,l,c,h,p,d,v,m,g,w,S;return Object(r.__generator)(this,function(T){switch(T.label){case 0:if(!e(Object(R.e)(function(e){return e.demandItemFacet(u.e,i)})))throw new Error("Source item does not have a driveItem key");s=n[i],o=s.isMove,a=s.conflictBehavior,f=s.progressItemKey;l=u.e.deserialize(t);return[4,e(Object(De.e)(function(e){return e.demandItemFacet(u.e,i)}))];case 1:if(!(c=T.sent()))throw new Error("Unable to get metadata for destination item.");h=Object(y.t)(c);p=Object(y.n)(c);d=c.endpoint;T.label=2;case 2:T.trys.push([2,4,,5]);return[4,e(Object(b.n)({url:h+(o?"":"/copy"),driveUrl:p,method:o?"PATCH":"POST",body:{parentReference:{id:l.itemId||Pe.n,driveId:l.driveId||""},"@microsoft.graph.conflictBehavior":a},qosName:o?"moveItem":"copyItem",endpoint:d}))];case 3:v=T.sent();(m=new x.e).invalidateItems({items:(w={},w[i]=o?[C.A,C.f]:[],w[t]=[E.t],w)});f&&!o&&v.name&&m.resolveItems({items:(S={},S[f]=Object(r.__assign)({},C.l.pack(v.name)),S)});e(m.execute());return[3,5];case 4:if((g=T.sent())instanceof M.e&&g.status===L.t)throw new _e.e({innerError:g,facets:Object(r.__assign)({},A.l.pack(g.status))});throw g;case 5:return[2]}})})}}),Be=n(1049),je=Object(Z.t)()(function(){return function(){return function(e,t){return{validator:ne.e}}}});var Fe=n(76),Ie=n(170),qe=n(694),Re=n(293),Ue=n(3505),ze=n(136),We=n(705),Xe=n(3050),Ve=n(350),$e=n(3548),Je=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!Ve.e.matches(n))throw new L.e({code:"invalidItemSetForAddToOneDrive"});i=Ve.e.deserialize(n).driveItemKey.endpoint;s=e(Object(R.e)(function(e){return{fileName:e.demandItemFacet(C.h,t),sharepointIds:e.demandItemFacet(Xe.e,t),remoteDriveInfo:e.demandItemFacet(u.e,t)}})),o=s.fileName,a=s.sharepointIds,f=s.remoteDriveInfo;if(!(i&&o&&f&&a))throw new L.e({code:"missingItemInfoForAddToOneDrive"});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,e(Object($e.t)({name:o.name,sharepointIds:a,qosName:"AddToOneDrive_SWM",endpoint:i}))];case 2:r.sent();return[3,4];case 3:if(!((l=r.sent())instanceof M.e))throw l;Object($e.e)(l);return[3,4];case 4:return[2]}})})}});n.d(t,"graphAddonDataOnlyDeferred",function(){return Qe});var Ke=Object(Ie.e)(function(){return Promise.resolve().then(n.bind(null,4374))},{chunkName:"addon-graph-deferredoperations"}),Qe=Object(i.t)(function(){return function(e){var t=e(Object(ge.e)({useBatchedDeleteConfiguration:me.x})).useBatchedDeleteConfiguration;e(Object(ze.e)(function(){e(Object(o.e)(Ee.e,we.e)(Te));e(Object(o.e)(Se.e,we.e)(Ne));e(Object(o.e)(Ee.e,ke.e)(Oe));e(Object(s.s)(u.e,a.t)(T));e(t?Object(s.s)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(Fe.o)())];case 1:t.sent();return[4,Ke()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.s)(u.e,f.t)(k));e(Object(s.s)(u.e,l.t)(_));e(Object(s.s)(u.e,c.t)(Y));e(Object(s.s)(u.e,_e.t)(He));e(Object(s.s)(u.e,We.t)(Je));e(Object(o.e)(u.e,h.e)(te));e(Object(o.e)(u.e,Be.e)(je));e(Object(o.e)(u.e,p.e)(re));e(Object(o.e)(u.e,d.e)(ie));e(Object(o.e)(u.e,v.e)(se));e(Object(o.e)(u.e,pe.e)(ae));e(Object(o.e)(u.e,de.e)(ce));e(Object(o.e)(u.e,m.e)(oe));e(Object(o.e)(u.e,g.e)(le));e(Object(s.s)(ve.e,be.e)(ye));e(Object(s.s)(qe.e,Re.e)(Ue.e))}))}})},function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n("react-lib"),o=n(3788),u=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return s.createElement(o.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(s.PureComponent),a=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(s.PureComponent),f=n(1025),l=n(1052),c=n(40),h=n(28),p=n(43),d=n(64),v=n(106),m=n(1),g=n(488),y=n(5),b=n(3062),w=n(145),E=n(71),S=Object(c.e)(function(e,t){var n=t.itemKey,r=e.demandItem({key:d.e,itemUrl:y.j},n),s=r.key,o=r.itemUrl,u="",a="",f="",l=!1;if(s&&o){var c=v.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),h=e.demandItem({driveUrl:m.S},c).driveUrl,S=e.demandItemFacet(w.e,n);if(h){var x=Object(g.e)(h);if(x){u=x.driveId||"";var T=e.demandItemFacet(y.h,n);if(T){f=T.extension;(x=Object(g.e)(o))&&(l=!!(a=x.itemId||""))}}}else if(S&&!E.e.isActivated("6e01adaa-b3ef-4d29-9210-6ec116fcbadb","9/13/2020","Use driveItem from item to get driveId and itemId")){u=S.driveId||"";l=!!(a=S.itemId||"")}}var N,C=s?Object(b.e)("spo:"+s.webAbsoluteUrl):void 0,k=encodeURIComponent(null!=C?C:""),L=encodeURIComponent(u),A=encodeURIComponent(a),O=f.toLowerCase();if(".note"===O)N="https://www.onenote.com/meetingnotes/"+k+"/"+L+"/"+A;else if(".whiteboard"===O)N="https://whiteboard.microsoft.com/me/whiteboards/p/"+k+"/"+L+"/"+A;else{var M=e.demandItemFacet(y.i,n)||"",_=s?s.webAbsoluteUrl:"";N="https://www.office.com/launch/fluid/content?drive="+u+"&item="+a+"&file="+encodeURIComponent(M)+"&siteUrl="+encodeURIComponent(_)}return Object(i.__assign)({isAvailable:l,onExecute:l?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){window.open(N);return[2]})})}:void 0},Object(p.t)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(h.e),x=n(2627),T=n(3069),N=n(3513),C=n(186),k=n(2621),L=n(2876),A=n(20),O=n(321),M=n(117),_=n(354),D=n(83),P=n(189),H=n(91),B=n(168),j=n(514),F=n(61),I=n(9),q=n(1842),R=n(133),U=n(16),z=n(280),W=n(11),X=n(332),V=n(598),$=n(82),J=new R.e("saveView",function(e,t){return Object.keys(t.views)[0]}),K=((r={})[$.r.started]=L.e.SaveViewOperationStarted,r[$.r.completed]=L.e.SaveViewOperationCompleted,r[$.r.failed]=L.e.SaveViewOperationFailed,r),Q=Object(U.t)(function(){return function(e){e(Object(z.e)(J,V.e)(Object(W.t)()(G)));e(Object(z.e)(J,X.n)(Object(W.t)()(Z)))}});function G(){return function(e){return Y}}function Y(e,t){var n,r=t.itemKey,s=t.format,o=Object(R.i)(e,t).phase,u=void 0,a=e.demandItemFacet(I.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=K)&&u[o];else if("item"===s){var l=e.demandItemFacet(J,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(m.v,c);n=h&&h.title}}return Object(i.__assign)({},n?{title:n}:{})}function Z(){return function(e){return function(e,t){return{reportMode:X.e.pin}}}}var ee=Object(R.s)({operationTypeFacet:q.t,progressKeyFacet:J,initializeBatch:function(){return Q}}),te=n(1380),ne=n(193),re=n(1239),ie=n(548),se=n(46),oe=E.e.isActivated("93C218F9-D649-4531-939E-C60EAEA4509C","06/08/2020","Use switchViewAction after save existing view"),ue=new O.e("saveViewProgressBatch"),ae=Object(H.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("18")]).then(n.bind(null,4561))];case 1:return[2,e.sent().SaveViewDialog]}})})});function fe(){return ue.serializeNext()}var le=Object(_.t)()(x.SwitchViewExecutor);function ce(e){var t=this,n=e.viewTitle,r=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=e.currentDerivedView,d=e.saveViewOperation,v=s.useState(!0),g=v[0],y=v[1],b=s.useState(fe)[0],w=s.useState(),E=w[0],S=w[1],x=s.useState(),T=x[0],O=x[1],_=Object(j.t)(),H=Object(B.e)(function(){O(!0);o&&o();h()}),F=Object(B.e)(function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,r,s,v,g,w,E,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:t=e.viewTitle,n=e.isPublicView;r=p&&p.title!==t;s=_(Object(M.e)({deserializedSetKey:D.e},a)).deserializedSetKey;if(!(r&&s&&p))return[3,3];if(!(v=t.trim()))throw new Error(L.e.CreateViewErrorNoTitle);return[4,_(Object(k.t)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))];case 1:if(T.sent().some(function(e){return e.serverView.Title===t}))throw new Error(A.format(L.e.SaveViewErrorCannotOverwrite,t));return[4,_(Object(N.e)({items:(E={},E[l]={views:(x={},x[v]={itemSetKey:a,isPublic:n,sourceView:p,progressItemKey:b},x)},E)}))];case 2:T.sent();if(g=_(Object(M.e)({createdViewKey:P.e},b)).createdViewKey){S(g.viewId);y(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,_((C={itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u,saveViewOperation:d},function(e){var t,n,r=C.itemsScopeItemKey,s=C.listViewSetKey,o=C.itemSetKey,u=C.currentViewKey,a=C.saveViewOperation,f=e(Object(M.e)({childItems:I.e,parentItem:I.s,deserializedItemSetKey:D.e},o)),l=f.childItems,c=f.parentItem,h=f.deserializedItemSetKey;return e(a({items:(t={},t[s]={views:(n={},n[u]={itemSetKey:o},n)},t)})).then(function(){var t,n;if(h){var s=D.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),o=e(Object(M.e)({filterOptionSets:I.n},s)).filterOptionSets;if(o&&h.filterParams){var a={};for(var f in o)o.hasOwnProperty(f)&&(a[o[f]]=!0);e(Object(te.e)({items:a}))}var p=new ne.e;p.resolveItems({items:(t={},t[s]=Object(i.__assign)(Object(i.__assign)({},l?I.e.pack(l):{}),c?I.s.pack(c):{}),t[u]=Object(i.__assign)({},m.St.pack(!1)),t)});e(p.execute());e(Object(re.e)({items:(n={},n[u]=[m.wt,m.v],n[s]=[I.e],n)}));oe&&e(Object(ie.e)({itemsScopeItemKey:r,currentItemKey:s}))}})}))];case 4:T.sent();if(oe){o&&o();h()}else if(w=_(Object(M.e)({savedViewKey:P.e},u)).savedViewKey){S(w.viewId);y(!1)}T.label=5;case 5:return[2]}var C})})}),q=Object(B.e)(function(){c(new C.e)});return g?s.createElement(ae,{viewTitle:n,isPublicView:r,onContinue:F,onCancel:q}):!T&&E?s.createElement(le,{viewId:E,currentDerivedView:p,onComplete:H,itemSetKey:a}):null}var he=Object(c.t)(function(e,t){var n=Object(F.e)(e).itemsScopeItemKey,r=Object(se.e)(e,t.itemSetKey),o=!!r&&Object(E.t)(r).isActivated("49F1ADD5-332D-4BAF-A4F9-FBEA104C76BE","01/20/21","Use saveViewWithProgress operation"),u=e.demandItemFacet(m.v,t.currentViewKey),a=o?q.e:ee;return s.createElement(ce,Object(i.__assign)({},t,{itemsScopeItemKey:n,currentDerivedView:u,saveViewOperation:a}))});var pe=n(3422),de=n(3549),ve=n(3026),me=n(66),ge=new(n(18).e)("groupByActionControl"),ye=n(13),be=n(37);var we=Object(me.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3550))];case 1:return[2,e.sent().GroupByActionExecutor]}})})},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,s=e.demandItemFacet(D.e,r);if(!s)return!1;var o=v.e.serialize(s),u=e.demandItemFacet(m.Be,o),a=u&&u.templateType===ye.n.mySiteDocumentLibrary,f=Object(be.e)(e,{enableGroupByInOneDrive:m.D}).enableGroupByInOneDrive,l=e.demandItemFacet(m.y,r),c=s.groupByFieldKey===n||!!l&&-1!==l.indexOf(n),h=D.e.serialize(Object(i.__assign)(Object(i.__assign)({},s),{groupByFieldKey:c?void 0:n})),p=s.viewKey&&P.e.serialize(s.viewKey),d=e.demandItemFacet(ge,r);return ge.evaluate(d)(e,{itemSetKey:r,viewKey:p,groupedItemSetKey:h,isAvailable:!a||!!f}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,i=e.demandItemFacet(D.e,r);if(!i)return!1;var s=e.demandItemFacet(m.y,r);return i.groupByFieldKey===n||!!s&&-1!==s.indexOf(n)}),Ee=n(3550),Se=n(866),xe=n(4165),Te=n(57),Ne=n(345),Ce={ODB:1318},ke=!1,Le=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=!1,u=e.demandItem({setKey:D.e,canModifySchema:m.f},n),a=u.setKey,f=u.canModifySchema,l=a&&a.viewKey?P.e.serialize(a.viewKey):void 0,c=e.demandItem({currentDerivedView:m.v},l).currentDerivedView,h=e.demandItemFacet(m.Ee,s);if(a&&f&&c&&c.baseViewXml&&h)if(1===r||2===r){var d=c.getEffectiveFieldNames();if(d&&d.length){var g=d.indexOf(h),y=a.groupByFieldKey?1:0;o=1===r?g>y+1:g>=y&&g<d.length-1}}else o=!0;if(a){var b=e.demandItemFacet(m.Qt,Ne.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})),w=e.demandItemFacet(m.Be,v.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));ke=Object(Te.e)(e,{feature:Ce,pageContext:b})&&!!(w&&w.permissions&&w.permissions.manageLists)}return Object(i.__assign)({isAvailable:o},Object(p.t)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=ke?xe.modifyColumnWithProgress:Se.e;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(o({items:(t={},t[n]={columnModifyTypeMap:(u={},u[s]={modifyType:r},u)},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ae=n(3514),Oe=n(495),Me=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.l,n),u=o&&o[r]&&o[r].aggregateFunctionType||Oe.e[0],a=u===Oe.e[s]?void 0:Oe.e[s];return Object(i.__assign)({isAvailable:!0,isToggled:u===Oe.e[s]},a?Object(p.t)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ae.e)({items:(t={},t[n]={aggregateType:s,columnKey:r},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),_e=n(3066),De=n(3068);n.d(t,"OpenAsHyperLinkExecutor",function(){return u});n.d(t,"OpenAsShortcutExecutor",function(){return a});n.d(t,"NewItemInOfficeClientAction",function(){return f.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return f.e});n.d(t,"OpenInOfficeClientAction",function(){return f.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return l.e});n.d(t,"OpenInOfficeOnlineAction",function(){return l.t});n.d(t,"OpenInBFileAction",function(){return S});n.d(t,"ItemSwitchViewAction",function(){return x.ItemSwitchViewAction});n.d(t,"SwitchViewExecutor",function(){return x.SwitchViewExecutor});n.d(t,"SetDefaultViewAction",function(){return T.e});n.d(t,"ViewCreator",function(){return he});n.d(t,"LaunchFilterPanelAction",function(){return pe.e});n.d(t,"ConnectedFilterPanel",function(){return de.ConnectedFilterPanel});n.d(t,"SortAction",function(){return ve.e});n.d(t,"GroupByAction",function(){return we});n.d(t,"GroupByActionExecutor",function(){return Ee.GroupByActionExecutor});n.d(t,"ModifyColumnAction",function(){return Le});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Me});n.d(t,"ApproveRejectAction",function(){return _e.e});n.d(t,"ItemFileHandlerOpenAction",function(){return De.t});n.d(t,"FileHandlerOpenAction",function(){return De.e})},,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(16),s=n(138),o=n(280),u=n(894),a=n(64),f=n(1170),l=n(988),c=n(1015),h=Object(i.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e("32").then(n.bind(null,4300))];case 1:return[4,(0,r.sent().renameItemCore)(t,e)];case 2:r.sent();return[2]}})})}}),p=n(874),d=n(345),v=n(106),m=n(1),g=n(42),y=n(3920),b=n(11),w=n(5),E=n(2863);function S(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}var x=n(13),T=n(57),N=Object(b.t)()(function(){return function(e){return function(e,t){var n,i,s=t.itemKey,o=e.demandItem({key:a.e,permissions:m.st,isCheckedOut:w.y,isFolder:w.d,rowData:m.bt},s),u=o.key,f=o.permissions,l=o.isCheckedOut,c=o.isFolder,h=o.rowData,p=u&&e.demandItemFacet(m.Qt,d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),b=u&&v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}),N=(null===(n=e.demandItemFacet(m.Be,b))||void 0===n?void 0:n.templateType)===x.n.contentCenterModelLibrary,k=Object(T.e)(e,{feature:C,pageContext:p})&&N,L=void 0,A=!1,O=E.e;if(p){L=h&&l&&!!l.byOther;var M=e.demandItemFacet(m.$e,s,{suppressGetItems:!0}),_=S(null===(i=h)||void 0===i?void 0:i.ProgId);A=!(M||p.isAnonymousGuestUser||_)&&g.e.hasItemPermission({permissions:f},g.e.deleteListItems)&&g.e.hasItemPermission({permissions:f},g.e.editListItems)&&!k;p.supportPercentStorePath&&p.supportPoundStorePath||(O=E.t)}var D={},P=u&&e.demandItemFacet(m.Be,v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(L){D.lockedWarningMessage=y.e.FileCheckedoutOrLockedWarning;D.title=y.e.FileCheckedoutOrLockedWarningTitle}else if(P&&P.isForceCheckout&&l&&!l.byYou&&!c){D.lockedWarningMessage=y.e.CheckoutRequired;D.title=y.e.Error}return Object(r.__assign)({isAvailable:A,validator:O,isFolder:!!c},D)}}}),C={ODB:1517};var k=n(610),L=n("react-lib"),A=n(227),O=n(1048),M=n(3512),_=n(77),D=n(912),P=n(822),H=n(434),B=n(184),j=n(37),F=n(156),I=n(162),q=n(104),R=n(71);function U(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferOpenInBrowser:!0})):null}function z(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferSameWindow:!0})):null}var W=Object(b.t)()(V),X=Object(b.t)()(V);function V(){return function(e){var t=new q.e;return function(e,n){var i=n.itemKeys,s=i[0],o=e.demandItemFacet(w.d,s),u=e.demandItemFacet(B.i,s),f=e.demandItemFacet(m.E,s);return 1!==i.length||o||u||f?i.length>0?(function(e,t){var n=t.itemKeys,i=e.demandItemFacet(a.e,n[0]);if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,o=i.listFullUrl,u=v.e.serialize({webAbsoluteUrl:s,listFullUrl:o}),f=e.demandItem({listFacets:m.Be,downloadZipApiUrl:D.e},u),l=f.listFacets,c=f.downloadZipApiUrl;if(!l||!c||l.templateType===x.t.webPageLibrary)return{};for(var h=[],p=Object(j.e)(e,{enableOAuthTokenInDownload:m.U}).enableOAuthTokenInDownload,d=void 0!==p&&p,y=!1,b=0,E=n;b<E.length;b++){var S=E[b],T=e.demandItem({name:w.l,size:w.p,itemUrl:w.j,folder:w.d,permissions:m.st,itemComplianceStatus:H.e,isOneNote:B.i},S),N=T.name,C=T.size,k=T.itemUrl,L=T.folder,M=T.permissions,P=T.itemComplianceStatus;if(T.isOneNote)return{isAvailable:!1};var I=void 0,q=void 0,R=e.demandItemFacet(m.$e,S,{suppressGetItems:!0});if(R){I=void 0;q=new F.e(R.siteUrl).authority+"/_api/v2.1/drives/"+R.driveId+"/items/"+R.itemId;y=!0}else{if(!k)return{};I=e.demandItemFacet(D.t,u);q=Object(O.n)(k,(I?I.accessToken:void 0)||"")}if(q){var U=!!L;3!==P&&4!==P&&g.e.hasItemPermission({permissions:M},g.e.openItems)&&h.push({name:N||"",size:C||0,docId:q,isFolder:U})}}if(0===h.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,n=e.zipApiUrl,i=e.itemsData,s=e.useOAuthToken;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0;return s?[4,e(Object(A.e)({url:new F.e(n).authority}))]:[3,2];case 1:t=r.sent();r.label=2;case 2:o=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++$+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";u=_.e.generate();return[2,{url:n,method:"POST",postData:{zipFileName:o,guid:u,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}})({zipApiUrl:c,itemsData:h,useOAuthToken:d||y})}}})(e,{itemKeys:i}):{}:(function(e,t){var n=t.itemKey,i=t.platformDetection,s=e.demandItem({spItem:a.e,permissions:m.st,folderPath:m.fe,uniqueId:m.fn,itemComplianceStatus:H.e,isBFile:m.Se},t.itemKey),o=s.spItem,u=s.permissions,f=s.folderPath,l=s.uniqueId,c=s.itemComplianceStatus,h=s.isBFile,p=e.demandItemFacet(w.N,t.itemKey),y=o&&d.e.serialize(o),b=e.demandItemFacet(m.Qt,y);if(!b||!o||h)return{};var E=o.webAbsoluteUrl,S=o.listFullUrl,T=v.e.serialize(o),N=e.demandItemFacet(m.Be,T);if(N&&N.templateType===x.t.webPageLibrary)return{};if(3===c||4===c||!g.e.hasItemPermission({permissions:u},g.e.openItems))return{};var C=Object(j.e)(e,{spCookieDomainConfiguration:m.kt,enableMalwareDownloadInNewWindow:m.j}),k=C.spCookieDomainConfiguration,L=C.enableMalwareDownloadInNewWindow;if(p){if(!b.allowInfectedDownload)return{};var O=e.demandItemFacet(w.i,n);return O?L?{isAvailable:!0,downloader:U,getDownloadData:function(){return J({canconicalUrl:O})}}:k?new F.e(k).authority!==new F.e(O).authority?{}:Object(r.__assign)(Object(r.__assign)({isAvailable:!!l},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return J({canconicalUrl:O})}}):{}:{}}if(!f)return{};var _=b.layoutsUrl;if(!_)return{};var D=!k||new F.e(k).authority!==new F.e(E).authority,B=b&&Object(R.t)(b),q=!!B&&B.isActivated("d1181e40-8c18-49bf-bff9-efd9518c28c0","10/10/2020","Use PostBody Download"),W=Object(j.e)(e,{disableDownloadWithAspxUrlWithToken:m.w}).disableDownloadWithAspxUrlWithToken,X=void 0!==W&&W;return Object(r.__assign)(Object(r.__assign)({isAvailable:!0},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return q||X?k&&l&&!D?(function(e){var t=this,n=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.uniqueId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{url:n+"/"+i+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:"GET"}]})})}})({webAbsoluteUrl:E,uniqueId:l,layoutsUrl:_}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,u=t.hasDigest;if(!t.hasTokenProvider)return[3,1];f=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!u}))];case 2:f=r.sent();r.label=3;case 3:a=f;l=Object(P.r)({webAbsoluteUrl:n,listOrItemFullUrl:i});return[4,Object(M.e)({dataRequestor:o,authToken:a,serverRelativeItemUrl:s,webApiUrl:l})];case 4:return[2,{url:r.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:E,listFullUrl:S,folderPath:f,layoutsUrl:_}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.uniqueId,o=e.layoutsUrl,u=e.isCrossSite;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),a=t.hasDigest;if(!t.hasTokenProvider&&u)return[3,1];l=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!a}))];case 2:l=r.sent();r.label=3;case 3:f=l;return[2,{url:n+"/"+o+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:u?"POST":"GET",postData:{oAuthToken:f||""}}]}})})}})({webAbsoluteUrl:E,listFullUrl:S,uniqueId:l||"",layoutsUrl:_,isCrossSite:D})}})})(e,{itemKey:s,platformDetection:t})}}}var $=0;function J(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}var K=n(873),Q=n(20),G=n(40),Y=n(3921),Z=Object(b.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.isBatchDelete,s=e.demandItemFacet(m.$e,r,{suppressGetItems:!0}),o=e.demandItemFacet(m.st,r,{suppressGetItems:!0}),u=S(null===(n=e.demandItemFacet(m.bt,r,{suppressGetItems:!0}))||void 0===n?void 0:n.ProgId),a=g.e.hasItemPermission({permissions:o},g.e.deleteListItems)&&!u;if(a&&s){a=!!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration&&i}return{isAvailable:a,deleteWizard:ee}}}});var ee=Object(G.t)(function(e,t){var n,i,s,o,u,a,f=t.itemKeys,l=t.defaultRender,c=Object(r.__rest)(t,["itemKeys","defaultRender"]),h=void 0,p=Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration;if(1===f.length){var d=e.demandItemFacet(m.Je,f[0]);if(d){var v=d&&Object(Q.formatToArray)(Object(Q.getLocalizedCountValue)(Y.e.deleteItemThatIsMountedDescription,Y.e.deleteItemThatIsMountedIntervals,d)||"",d),g=c.deleteWizardStrings.confirmText;h=Object(r.__assign)(Object(r.__assign)({},c),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},c.deleteWizardStrings),{confirmTitle:Y.e.deleteItemThatIsMountedTitle,confirmText:[v," ",g]})})}}else if(p){n=0;f.forEach(function(t){e.demandItemFacet(m.$e,t,{suppressGetItems:!0})&&n++});if(n>0){var y=f.length-n;h=Object(r.__assign)(Object(r.__assign)({},c),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},c.deleteWizardStrings),{confirmTitle:Y.e.deleteItems,confirmText:(i=n,s=y,o=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.e.deleteShortcutsFormat,Y.e.deleteShortcutsIntervals,i)||"",i),u=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.e.deleteOtherItemsFormat,Y.e.deleteOtherItemsIntervals,s)||"",s),a=Object(Q.format)(Y.e.deleteItemsAndMountPointsFormat,o,u),a)})})}}var b=h||c;return l?L.createElement(l,Object(r.__assign)({itemKeys:f},b)):null});var te=Object(b.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.N}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.demandItemFacet(m.$e,s,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}});n.d(t,"sharePointBasicActionsAddonDeferred",function(){return ne});var ne=Object(i.t)(function(){return function(e){e(Object(s.s)(a.e,l.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("31").then(n.bind(null,4541))];case 1:return[2,e.sent().spItemDeleteItemsOperationHandler]}})})})));e(Object(s.s)(a.e,c.t)(h));e(Object(o.e)(a.e,p.e)(N));e(Object(o.e)(a.e,k.e)(W));e(Object(o.e)(f.e,k.e)(X));e(Object(o.e)(a.e,K.e)(Z));e(Object(o.e)(a.e,u.e)(te))}})}],Array(22),[function(e,t,n){"use strict";n.r(t);var r,i=n(866),s=n(133),o=n(0),u=n(3953),a=n(16),f=n(280),l=n(11),c=n(598),h=n(332),p=n(2837),d=n(9),v=n(82),m=n(4),g=new m.e("modifyColumnProgressItem",{columnKey:Object(m.s)(),modifyType:Object(m.i)(),targetIndex:Object(m.i)()}),y=new s.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return g.serialize({columnKey:n,modifyType:r,targetIndex:i})}),b=n(1),w=((r={})[v.r.started]=u.e.columnOperationStarted,r[v.r.completed]=u.e.columnOperationCompleted,r[v.r.failed]=u.e.columnOperationFailed,r),E=Object(a.t)(function(){return function(e){e(Object(f.e)(y,c.e)(Object(l.t)()(S)));e(Object(f.e)(y,h.n)(Object(l.t)()(x)));e(Object(f.e)(y,p.t)(Object(l.t)()(T)))}});function S(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,u=Object(s.i)(e,t).phase,a=void 0,f=e.demandItemFacet(d.e,r),l=f&&f.itemKeys;if(l&&l.length>0)n=(a=w)&&a[u];else if("item"===i){var c=e.demandItemFacet(y,r),h=c&&c.taskKey;if(h){var p=e.demandItemFacet(g,h),v=p&&p.columnKey;if(v){n=e.demandItemFacet(b.Ee,v)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function x(){return function(e){return function(e,t){return{reportMode:h.e.pin}}}}function T(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}n.d(t,"modifyColumnWithProgress",function(){return N});var N=Object(s.s)({operationTypeFacet:i.t,progressKeyFacet:y,initializeBatch:function(){return E}})},,,,,,,,,,,function(e,t,n){"use strict";var r=n("react-lib"),i=n(3536),s=n(286),o=n(2),u=Object(o.t)("quickEditUndo");n.d(t,"e",function(){return a});var a={key:u,automationId:"quickEditUndoCommand",name:s.e.quickEditUndo,iconProps:{iconName:"Undo"},isPermanent:!0,action:r.createElement(i.e,{undoRedoActionType:"undo"})}},function(e,t,n){"use strict";var r=n("react-lib"),i=n(286),s=n(2),o=Object(s.t)("quickEditRedo"),u=n(3536);n.d(t,"e",function(){return a});var a={key:o,automationId:"quickEditRedoCommand",name:i.e.quickEditRedo,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},,,,,,,,,function(e,t,n){"use strict";var r=n(347),i=n(0),s=n(827),o=n(387),u=n(123),a=n(485),f=n(18),l=n(186),c=n(364);var h=n(3007);n.d(t,"e",function(){return p});var p=r.e?h.e:function e(t,n,r){var h=this;void 0===r&&(r={});var p=r.cancelToken,d=r.flushOperationQueue,v=r.contextualControlHandlers,m=void 0===v?f.t:v,g=r.owner;return function(r,f){return Object(i.__awaiter)(h,void 0,void 0,function(){var h,v,y,b,w;return Object(i.__generator)(this,function(E){switch(E.label){case 0:h=r(o.t);v=r(c.e);y={selector:t,operation:e,owner:g};E.label=1;case 1:E.trys.push([1,,6,7]);b=function(){var e,o,c,g,b,w;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=h.evaluate({selector:t,controlHandlers:m,owner:y,state:f()}),o=e.result,c=e.demands,g=e.dependencies;return(b=n(o))?[4,b]:[3,2];case 1:i.sent();i.label=2;case 2:w={items:c,flushOperationQueue:d};v.recordLastAccesses(g,Date.now());if(!r(Object(u.e)(function(e){return Object(a.t)(e,w)})))return[2,{value:void 0}];v.registerDemands(y,g);p&&p.throwIfCanceled();return[4,Object(l.r)(r(Object(s.t)(w)),p)];case 3:i.sent();return[2]}})};E.label=2;case 2:return[5,b()];case 3:if("object"==typeof(w=E.sent()))return[2,w.value];E.label=4;case 4:return[3,2];case 5:return[3,7];case 6:v.removeDemands(y);return[7];case 7:return[2]}})})}}},,,function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(1544),o=n(1964),u=n(21),a=n(14),f=n(28),l=n(91),c=n(43),h=n(40),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("42")]).then(n.bind(null,4328))];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(3552));n.d(t,"e",function(){return m});var m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(53),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(14),s=n(40),o=n(3479);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)}],Array(24),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointGraphAddon",function(){return E});var r=n(0),i=n(16),s=n(175),o=n(154),u=n(120),a=n(193),f=n(1170),l=n(64),c=n(112),h=n(36),p=n(2),d=n(3042),v=n(5),m=n(3507),g=n(1),y=n(194),b=n(1198);function w(e){var t=e.itemKey,n=e.driveItem;return function(e){var i,s,o=e(Object(y.e)({enableSharePointItemMapping:g.G})).enableSharePointItemMapping,u=void 0===o||o,d=new a.e,b=n.webDavUrl||n.remoteItem&&n.remoteItem.webDavUrl||n.webUrl,w=b&&decodeURIComponent(b);if(w){var E={itemFullUrl:w},S=Object(m.e)(w),x={itemFullUrl:S},T=f.e.serialize(E),N=f.e.serialize(x);d.mapKeys({mappings:(i={},i[T]=t,i)});d.resolveItems({items:(s={},s[T]=Object(r.__assign)(Object(r.__assign)({},u?Object(r.__assign)({},Object(p.n)({preferredKeyFacet:c.r},{preferredKeyFacet:new h.a(f.e,function(e){return e===l.e})})):{}),v.A.pack({itemKey:N})),s[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.d.pack({})),v.i.pack(S)),v.L.pack(encodeURI(S))),s)})}return{itemResolver:d}}}var E=Object(i.t)(function(){return function(e){var t;e(b.e);e(d.sharePointItemByFullUrlAddon);e(Object(s.e)({items:(t={},t[o.e]=Object(r.__assign)({},u.m.pack({process:w})),t)}))}})}],Array(105),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var r,i=n(0),s=n(372),o=n(16),u=n(336),a=n(127),f=n(82),l=n(175),c=n(1239),h=n(5),p=n(145),d=n(840),v=n(1674),m=n(249);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=Object(o.n)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,g=Object.keys(n),y=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,b,w,E,S,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.m.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:y.map(function(e){return{id:e.itemId,deleted:{}}})};p="";b=Object(d.n)(y[0]);return[4,e(Object(v.n)({url:b+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:T.sent();w=0;E=!1;S=!1;Object(u.t)(3e5).then(function(){return S=!0});x=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:t=i.sent();g.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.m.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];E=!0;w=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(500)];case 3:i.sent();i.label=4;case 4:return[2]}})};T.label=2;case 2:return[5,x()];case 3:T.sent();T.label=4;case 4:if(!E&&!S)return[3,2];T.label=5;case 5:if(S)throw new s.e({facets:Object(i.__assign)({},m.l.pack(408))});e(Object(c.e)({items:Object(a.e)(g,function(){return[h.f]})}));if(w>0)throw new o.e({items:Object(a.e)(g.slice(0,w),function(){return new s.e({facets:Object(i.__assign)({},m.l.pack(500))})})});return[2]}})})}})}],Array(24),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(16),s=n(138),o=n(350),u=n(76),a=n(280),f=n(423),l=n(11),c=n(529),h=n(288),p=Object(r.__assign)(Object(r.__assign)({},c.e),{key:h.n,minWidth:32,maxWidth:32}),d=n(2960),v=n(938),m=n(1084),g=n(59),y=n(985),b=n(685),w=n(27),E=n(154),S=Object(g.i)({name:m.e.dateSharedColumnHeaderText,key:h.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},b.e)(function(e,t){var n=e.demandItemFacet(y.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.x,E.e);return i&&i.language||window.navigator.language?{text:Object(v.r)(new Date(r),!1)}:{dateValue:r}}),x=n(619),T=n(287),N=n(3502),C=n(2617),k=n(3052),L=n("react-lib"),A=n(835),O=n(600),M=n(20),_=n(1410),D=n(3915),P=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=L.createElement(O.e,{className:"topCollaboratorIcon_77af8729",iconName:"TeamFavorite"}),i=L.createElement("span",{className:"topCollaboratorUserName_77af8729"},t),s=L.createElement("div",{className:"topCollaboratorTooltip_77af8729"},M.formatToArray(D.e.topCollaboratorWith,i));return L.createElement("div",{className:"topCollaPlaceHolder_77af8729"},n?null:t?L.createElement(_.e,{content:s},r):r)};return t})(A.e),H=n(9),B=Object(g.i)({name:m.e.sharedByColumnHeaderText,key:h.i,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.r,headerClassName:"columnHeader_77af8729"},x.e)(function(e,t){var n=e.demandItem({shareByPerson:N.e},t).shareByPerson,r=e.demandItem({sharedBy:y.e},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,o=!1;if(i&&C.e.matches(i)){var u=C.e.deserialize(i).email,a=e.demandItemFacet(H.e,k.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));a&&(o=a.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(T.e,t);return!!n&&n===u}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return L.createElement("div",{className:"userWithTopCollaborator_77af8729"},L.createElement(P,{userName:r.title,isPlaceholder:!o}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(T.e,t)}),j=Object(l.t)()(function(){return function(e){return I}});var F=[p,d.e,S,B];function I(e,t){return{columns:F}}var q=n(5),R=n(1008),U=n(175),z=n(293),W=n(145),X=n(840),V=n(1674),$=n(2236),J=n(3783),K=n(2860),Q=n(4),G=new Q.e("driveItem",{endpoint:Object(Q.s)(),driveId:Object(Q.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(Q.s)()}),Y=n(156);function Z(e){var t,n,i,s,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,f=void 0===a?$.e:a,l=o.remoteItem,c=l&&l.parentReference,h=o.parentReference,p=h||c,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!o.root;if(l){s=l.id;c&&(d=c.driveId)}else s=m&&o.root?K.n:o.id;var y={endpoint:u,driveId:d,itemId:s},b=W.e.serialize(y),w=o&&(o.webDavUrl||o.webUrl),E=m&&p&&p.path===K.e?K.n:v||void 0,S=p&&E?W.e.serialize({endpoint:u,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(w){var N=new Y.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=G.serialize({endpoint:u,driveId:p.driveId,canonicalUrl:T}));var C=Object(J.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S})).itemResolver;C.resolveItems({items:Object(r.__assign)({},S&&(t={},t[S]=Object(r.__assign)({},T?q.L.pack(T):{}),t))});if(l&&c){var k=W.e.serialize({endpoint:u,driveId:h&&h.driveId,itemId:o.id}),L=W.e.serialize({endpoint:u,driveId:c.driveId,itemId:l.id});C.mapKeys({mappings:(n={},n[k]=L,n)});C.resolveItems({items:(i={},i[L]=Object(r.__assign)({},f({driveItem:o,endpoint:u})),i)})}return{itemResolver:C,actualDriveItemKey:y,actualItemKey:b}}var ee=n(130),te=n(194),ne=n(120);function re(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(te.e)({getUserOneDriveEndpoint:ne.f,graphEndpoint:ne.l})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}var ie=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=W.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(re({endpoint:i.endpoint}))];case 1:(o=v.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));v.label=2;case 2:u=Object(X.n)(t);return[4,s(Object(V.r)({url:Object(X.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",endpoint:t.endpoint}))];case 3:a=v.sent();f=Z({driveItemResponse:a,endpoint:t.endpoint}),l=f.itemResolver,c=f.actualItemKey;l.resolveItems({items:(h={},h[e.itemKey]=Object(r.__assign)({},ee.r.pack(W.e)),h)});l.mapKeys({mappings:(p={},p[c]=n,p)});i.driveId&&"me"!==i.driveId||l.mapKeys({mappings:(d={},d[W.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=W.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),d[n]=W.e.serialize(t),d)});s(l.execute());return[2]}})})}});var se=n(526),oe=n(974),ue=n(4159),ae=n(3503),fe=n(764),le=n(2348),ce=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=se.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d=this;return Object(r.__generator)(this,function(v){t={Caller:"HoverCard"};o=e(Object(te.e)({enableCookiesForAnalyticsRequests:ne.s})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;a="GetItemAnalytics_addon-graph";f=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(V.r)({url:(v=Object(X.t)(i),m=he(v),g="$expand=analytics($expand=allTime($expand=activities))",y="$select=*,id,reactions,trending",b=y+"&"+g+",insights($expand=keyPoints)",w=m+"?"+b,w),qosName:a+"_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:he(Object(X.n)(i)),allowCookies:u}))];case 1:o=d.sent();f=Object(ue.t)(o);if(l=f.createdBy){c=C.e.serialize({email:l.email,endpoint:s});e(Object(U.e)({items:(h={},h[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(l.displayName)),T.e.pack(l.email)),T.t.pack(l.image)),T.n.pack(l.id)),h[n]=Object(r.__assign)({},oe.r.pack({itemKey:c,displayValue:l.displayName})),h)}))}e(Object(U.e)({items:(p={},p[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.h.pack(f.viewCount)),oe.p.pack(f.viewerCount)),oe.o.pack(f.isTrending)),oe.e.pack(f.activities)),oe.f.pack(f.likeCount)),oe.t.pack(f.commentCount)),oe.a.pack(f.lifeCycleStatus)),oe.u.pack(f.keyPointsData)),oe.s.pack(f.incompleteData)),oe.i.pack(f.createdDateTime)),p)}));return[2]}var v,m,g,y,b,w})});l=[f];c=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f,l,c;return Object(r.__generator)(this,function(h){switch(h.label){case 0:return[4,e(Object(V.r)({url:(p=Object(X.t)(i),d=he(p),d+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:a+"_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:he(Object(X.n)(i)),allowCookies:u}))];case 1:o=h.sent();f=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);l=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:ae.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(U.e)({items:(c={},c[n]=Object(r.__assign)(Object(r.__assign)({},oe.l.pack(f)),oe.n.pack(l)),c)}));return[2]}var p,d})});l.push(c);if(Object(le.t)()){h=Object(r.__awaiter)(d,void 0,void 0,function(){var o,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,e(Object(V.r)({url:(c=Object(X.t)(i),h=he(c),h+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:he(Object(X.n)(i)),qosName:a+"_GetShareWithPeople",endpoint:s,timeout:6e3,headers:t,allowCookies:u}))];case 1:o=l.sent();e(Object(U.e)({items:(f={},f[n]=Object(r.__assign)({},oe.c.pack(o.value)),f)}));return[2]}var c,h})});l.push(h)}else e(Object(U.e)({items:(p={},p[n]=Object(r.__assign)({},oe.c.pack([])),p)}));return[2,Object(fe.e)(l)]})})}});function he(e){return e.replace("2.0","2.1")}var pe=new Q.e("specialDriveItem",{endpoint:Object(Q.s)(),driveId:Object(Q.s)({shouldNormalizeToEmpty:!0}),name:Object(Q.s)()}),de=n(2063),ve=n(193),me=n(112),ge=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=pe.deserialize(n),s=i.driveId,o=i.endpoint,u=Object(X.n)(i);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(V.n)({url:Object(X.i)(i),driveUrl:u,qosName:"getItem",endpoint:o}))];case 1:t=m.sent();a=new ve.e;f=t&&t.parentReference;l=f&&f.driveId;c={endpoint:o,driveId:l||s,itemId:t.id};h=W.e.serialize(c);p=f&&f.id?W.e.serialize({endpoint:o,driveId:l,itemId:f.id}):void 0;a.resolveItems({items:(d={},d[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:t,endpoint:o,parentFolderItemKey:p})),me.r.pack(W.e)),H.t.pack({itemKey:de.e.serialize({driveItemKey:c,sortBy:"",isAscending:!0})})),d)});a.mapKeys({mappings:(v={},v[h]=n,v)});e(a.execute());return[2]}})})}});var ye=new Q.e("driveItemPage",{endpoint:Object(Q.s)(),setItemKey:Object(Q.s)(),token:Object(Q.s)()}),be=n(247),we=n(218);function Ee(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function Se(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function xe(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var Te=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=ye.deserialize(n),s=i.setItemKey,o=i.endpoint,u=i.token,a=Q.e.get(s).deserialize(s),f=a.extFilters,l=a.driveItemKey,c=Object(X.n)(l);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,a,l,h,p,d,v,m,g,y,b,w,E,S,x;return Object(r.__generator)(this,function(T){switch(T.label){case 0:return[4,e(Object(V.n)({endpoint:o,url:u,driveUrl:c,qosName:"getChildrenPage"}))];case 1:t=T.sent();i=f&&f.length>0?xe(f):void 0;a=new ve.e;l=[];h=0,p=t.value;T.label=2;case 2:if(!(h<p.length))return[3,5];d=p[h];if(!!i&&i(d))return[3,4];v=d&&(d.parentReference||d.remoteItem&&d.remoteItem.parentReference);m=v&&v.driveId;g=W.e.serialize({itemId:d.id,driveId:m,endpoint:o});y=v?W.e.serialize({itemId:v.id,driveId:m,endpoint:o}):void 0;l.push(g);a.resolveItems({items:(x={},x[g]=Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:d,endpoint:o,parentFolderItemKey:y})),Object(be.e)().forFacet(q.l).thenInvalidate(n,H.e).forFacet(q.f).thenInvalidate(n,H.e).pack()),x)});return(b=e(Object(te.e)({processDriveItemFromSharePoint:ne.m})).processDriveItemFromSharePoint)?[4,e(b.process({itemKey:g,driveItem:d}))]:[3,4];case 3:w=T.sent().itemResolver;a.merge(w);T.label=4;case 4:h++;return[3,2];case 5:if(E=t["@odata.nextLink"]){S=ye.serialize({setItemKey:s,endpoint:o,token:E});a.merge(Object(we.t)({itemKey:S}).itemResolver);l.push(S)}a.merge(Object(we.e)({itemKey:n,itemSetKey:s,childItemKeys:l}).itemResolver);e(a.execute());return[2]}})})}});var Ne=n(688),Ce=n(2399),ke=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ne.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(u){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:o.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),q.l.pack(Ce.e.sharedWithMe)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var Le=n(532),Ae=n(420),Oe=n(31),Me=n(123),_e=n(51),De=n(2),Pe=new De.e("itemSetEngagementExtraData");var He=n(131),Be=n(211);function je(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.parentItemResponse,u=e.mapItemSetKey,a=n.deserialize(t),f=i.serialize(a.driveItemKey),l=a.driveItemKey.endpoint;return function(n){var i;Be.r(He.e.processData.start);var a=n((function(e){return function(t){var n,i,s,o,u,a=e.itemKey,f=e.parentItemKey,l=e.itemSetKeyFacet,c=e.filterChildItems,h=e.onProcessResponse,p=e.groupChildItems,d=e.response,v=e.skip,m=void 0===v?0:v,g=e.enableRandomAccess,y=void 0!==g&&g,b=e.totalChildCount,w=e.getDriveItemFacets,E=l.deserialize(a),S=E.driveItemKey.endpoint,x=new ve.e,T=t(Object(Ae.e)({name:"remoteItemsMissingParentRef"})),N="number"==typeof d["@odata.count"]?d["@odata.count"]:b||d.value.length,C=d["@odata.nextLink"],k=!!C,L=t(Object(Me.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(H.e,a),prevChildKeys:e.demandItemFacet(H.e,a)}})),A=L.childItemsFacetResolved,O=L.prevChildKeys,M=O&&O.itemKeys,_=0,D=0;y&&(A&&M?u=M.slice(0):"number"==typeof N&&(u=new Array(N+(k&&N<=d.value.length?1:0))));u||(u=new Array(d.value.length+(k?1:0)));for(var P=m,B=0,j=0,F=d.value;j<F.length;j++){var I=F[j],q=c&&c(I),R=I.remoteItem,U=!(I.remoteItem&&I.remoteItem.parentReference&&I.remoteItem.parentReference.driveId),z=R&&U;z&&B++;if(q||z){u.splice(P,1);N--}else{var W=I.webDavUrl||I.remoteItem&&I.remoteItem.webDavUrl||I.webUrl,X=t(Object(te.e)({graphEndpoint:ne.l,graphRecentEndpoint:ne.c,processDriveItemSet:ne.g})),V=X.graphEndpoint,$=X.graphRecentEndpoint,J=X.processDriveItemSet,K=S.indexOf("/_api/v2.0")>-1||S.indexOf("/_api/v2.1")>-1,Q=V||$;if(W&&K){var G=W&&decodeURIComponent(W);S=Q?new Y.e(G).authority+"/_api/v2.0":""+new Y.e(G).authority+new Y.e(S).path}var ee=Z({shouldInvalidateItemSetOnChildItemRename:J&&J.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:I,endpoint:S,getDriveItemFacets:w}),re=ee.itemResolver,ie=ee.actualItemKey,se=ee.actualDriveItemKey,oe=I.thumbnails,ue=I.remoteItem;_++;(oe||ue&&ue.thumbnails)&&D++;u[P]=ie;x.merge(re);if(h){var ae=h({itemKey:a,driveItemKey:se,item:I});ae&&x.merge(ae.itemResolver)}var fe=t(Object(te.e)({processDriveItemFromSharePoint:ne.m})).processDriveItemFromSharePoint;if(fe&&(K||Q)){var le=t(fe.process({itemKey:ie,driveItem:I})).itemResolver;x.merge(le)}P++}}t(T(Object(r.__assign)({resultType:B<1?Oe.e.Success:Oe.e.Failure},B>0?{extraData:{count:B}}:{})));if(k){var ce=ye.serialize({setItemKey:a,endpoint:S,token:C});x.merge(Object(we.t)({itemKey:ce}).itemResolver);u[P]=ce}if(p){var he=p(E);he&&x.merge(he.itemResolver)}else x.resolveItems({items:(n={},n[a]=Object(r.__assign)({},H.e.pack({itemKeys:u})),n)});x.resolveItems({items:(i={},i[a]=Object(r.__assign)({},Pe.pack({childCount:_,childCount_withThumbnail:D})),i)});N!==b&&x.resolveItems({items:(s={},s[f]=Object(r.__assign)({},_e.e.pack(N)),s)});x.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},H.s.pack({itemKey:f})),Object(be.e)().forFacet(H.e).thenInvalidate(Le.e).pack()),o)});return{itemResolver:x}}})(Object(r.__assign)(Object(r.__assign)({},e),{response:s,parentItemKey:f}))).itemResolver;if(u){var c=u().itemResolver;a.merge(c)}if(o){var h=Z({setItemKey:t,driveItemResponse:o,endpoint:l}).itemResolver;a.merge(h)}a.resolveItems({items:(i={},i[f]=Object(r.__assign)({},Object(be.e)().forFacet(H.t).thenInvalidate(e.itemKey,H.e).pack()),i)});Be.r(He.e.processData.end);return{itemResolver:a}}}function Fe(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=i.deserialize(n),c=l.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=Object(X.n)(l.driveItemKey);return[4,n(Object(V.r)({url:s(l),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:c,headers:e.additionalHeaders,expectedErrors:f}))];case 1:i=v.sent();h=Object(r.__spreadArrays)(i.value);p=a?a(h):i.value;d=o?o(p):p;return[4,n(je(Object(r.__assign)(Object(r.__assign)({},e),{childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:d})})))];case 2:return[2,{itemResolver:v.sent().itemResolver}]}})})}}var Ie=n(79),qe=n(677),Re=n(1632),Ue=n(219);function ze(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var We=n(1804),Xe="fileName",Ve="sharedByName",$e="dateModified";var Je=new Map([["code",Ie.e.text],["csv",Ie.e.excel],["docx",Ie.e.word],["dotx",Ie.e.word],["one",Ie.e.onenote],["onepkg",Ie.e.onenote],["onetoc",Ie.e.onenote],["pdf",Ie.e.pdf],["photo",Ie.e.media],["potx",Ie.e.powerpoint],["ppsx",Ie.e.powerpoint],["pptx",Ie.e.powerpoint],["rtf",Ie.e.text],["txt",Ie.e.text],["video",Ie.e.media],["xlsx",Ie.e.excel],["xltx",Ie.e.excel],["zip",Ie.e.zip]]);function Ke(e,t){var n,r,i=(n=e,r=Object(qe.t)(n,!0),Object(Re.t)(r)),s=Je.get(i);return!!s&&Object(Ie.t)(t.filters,s)}function Qe(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===Ve)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===Xe)||(function(e,t){return!!e.name&&Ke(e.name,t)})(e,Object(Ue.t)(t.values)),s=!(t.type===$e)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case We.e.today:return n;case We.e.yesterday:return ze(n,1);case We.e.last7Days:return ze(n,7);case We.e.last30Days:return ze(n,30);case We.e.last3Months:return ze(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(We.e).indexOf(n[0])?We.e.none:We.e[n[0]]));return r&&i&&s})}var Ge=n(256);function Ye(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Ze(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function et(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function tt(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function nt(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var rt=n(3504),it=n(3912),st=n(475),ot=n(32),ut=n(3913);function at(e){if(o.e.matches(e)){var t=o.e.deserialize(e).groupBy;if(t===h.t[h.i])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=W.e.serialize(r);if(u&&u.email){var f=rt.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:function(n){for(var i,s,o=new ve.e,u=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!rt.n.matches(i))return e;var s=rt.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return rt.n.serialize(e)})})(Object.keys(t)),a=[],f=0,l=u;f<l.length;f++){var c=l[f];if(rt.n.matches(c)){var h=rt.n.deserialize(c);o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(h.displayName)),_e.s.pack(!0)),H.e.pack({itemKeys:t[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:a})),ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e);if(t===h.t[h.e])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=W.e.serialize(r);if(o){var a=(function(e,t){if(!e)return it.e.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return st.e.today;n.setDate(n.getDate()-1);if(e>=n)return st.e.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return it.e.thisWeek;n.setDate(n.getDate()-7);if(e>n)return it.e.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return it.e.lastMonth;n.setDate(n.getDate()-7);if(e>n)return it.e.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return it.e.threeWeeksAgo;if(e>=r)return it.e.thisMonth;var s=t.getFullYear()===e.getFullYear(),o=ut.e[e.getMonth()];if(s)return o;return M.format(st.e.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=rt.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:function(n){for(var i,s,o=new ve.e,u=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!rt.e.matches(i))return e;var s=rt.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return rt.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(rt.e.matches(o)){var u=rt.e.deserialize(o).relativeTime,a=rt.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),a=[],f=0,l=Object.keys(u);f<l.length;f++){var c=l[f];if(rt.t.matches(c)){var h=rt.t.deserialize(c).relativeTime;o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(h)),_e.s.pack(!0)),H.e.pack({itemKeys:u[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:a})),ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var ft=Object(i.i)()(function(e){var t=this,n=o.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,u=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=at(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=o.e.deserialize(e.itemKey);c=l.driveItemKey.endpoint;p=n(Object(te.e)({graphSharedWithMeEndpoint:ne.h})).graphSharedWithMeEndpoint;c=p||c;return[4,n(Object(V.i)(c))];case 1:d=m.sent();return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:o.e,parentItemKeyFacet:Ne.e,getUrl:function(e){return d?c+"/drive/view.sharedWithMe?allowExternal=true":c+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!Qe(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=h.t[h.e],s=h.t[h.i],o=h.t[Ge.t],u=h.t[h.r],a=h.t[Ge.r];switch(t){case i:return nt(e,n,r,Ze);case s:return nt(e,n,r,tt);case o:case a:return nt(e,n,r,et);case u:return nt(e,n,r,Ye);default:return e}})(e,s,u,!0)},onProcessResponse:a,groupChildItems:f})))];case 2:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var lt=new Q.e("sharedByMeRootItem",{endpoint:Object(Q.s)()}),ct=new Q.e("sharedByMeItemSet",{driveItemKey:Object(Q.o)(W.e)}),ht=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=lt.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:ct.serialize({driveItemKey:i})})),q.l.pack(Ce.e.sharedByMe)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var pt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:ct,parentItemKeyFacet:lt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var dt=n(357),vt=n(355),mt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=vt.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(u){t=e(Object(te.e)({groupBy:ne.b})).groupBy;(s=new ve.e).resolveItems({items:(o={},o[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:dt.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0,groupBy:t||""})})),q.l.pack(Ce.e.recentTitle)),q.d.pack({})),q.A.pack(void 0)),o)});e(s.execute());return[2]})})}});var gt=n(693),yt=n(358),bt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=yt.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new ve.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:gt.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),q.l.pack(Ce.e.saved)),q.d.pack({})),q.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var wt,Et=n(125),St=new Q.e("recentGroup",{relativeTime:Object(Q.s)()});(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(wt||(wt={}));function xt(e){var t=new Date;return(function(e,t){return Tt(t,e)})(e,t)?wt.today:(function(e,t){return Tt(new Date(t.getTime()-864e5),e)})(e,t)?wt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?wt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?wt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?wt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?wt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?wt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?wt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?wt.twoMonthsAgo:""}function Tt(e,t){return e.toDateString()===t.toDateString()}var Nt=["January","February","March","April","May","June","July","August","September","October","November","December"],Ct=n(3049);var kt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Lt=Object(i.i)()(function(e){var t=this,n=dt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,f=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.photo,Ie.e.video],fileTypeIconMap:Et.e}),l=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.photo],fileTypeIconMap:Et.e}),c=Object(Ue.e)({extFilters:Object(Ue.t)(s),allowedMediaTypes:[Ie.e.video],fileTypeIconMap:Et.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:if(!(t=n(Object(te.e)({graphRecentEndpoint:ne.c})).graphRecentEndpoint))return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,n(re({endpoint:a.driveItemKey.endpoint}))];case 2:(i=F.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})}));F.label=3;case 3:o=dt.e.serialize(a);h=St.serialize({relativeTime:"today"});p=St.serialize({relativeTime:"yesterday"});d=St.serialize({relativeTime:"thisWeek"});v=St.serialize({relativeTime:"lastWeek"});m=St.serialize({relativeTime:"twoWeeksAgo"});g=St.serialize({relativeTime:"threeWeeksAgo"});y=St.serialize({relativeTime:"lastMonth"});b=St.serialize({relativeTime:"twoMonthsAgo"});w=[];E=[];S=[];x=[];T=[];N=[];C=[];k=[];L="";A="date"===u;O=function(e){var t,n=e.driveItemKey,i=e.item,s=new ve.e;if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=W.e.serialize(n);if(A&&a){var l=new Date(a);switch(xt(l)){case wt.today:w.push(f);break;case wt.yesterday:E.push(f);break;case wt.thisWeek:S.push(f);break;case wt.lastWeek:x.push(f);break;case wt.twoWeeksAgo:T.push(f);break;case wt.threeWeeksAgo:N.push(f);break;case wt.lastMonth:C.push(f);break;case wt.twoMonthsAgo:k.push(f);L=Nt[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},q.d.pack(void 0)),t)});return{itemResolver:s}}};M=!f&&A?function(t){var n,i,s=new ve.e;s.resolveItems({items:(n={},n[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Today")),_e.s.pack(!0)),H.e.pack({itemKeys:w})),n[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Yesterday")),_e.s.pack(!0)),H.e.pack({itemKeys:E})),n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("This Week")),_e.s.pack(!0)),H.e.pack({itemKeys:S})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Last Week")),_e.s.pack(!0)),H.e.pack({itemKeys:x})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Two Weeks Ago")),_e.s.pack(!0)),H.e.pack({itemKeys:T})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Three Weeks Ago")),_e.s.pack(!0)),H.e.pack({itemKeys:N})),n[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack("Last Month")),_e.s.pack(!0)),H.e.pack({itemKeys:C})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.l.pack(L)),_e.s.pack(!0)),H.e.pack({itemKeys:k})),n)});var o=[];w.length>0&&o.push(h);E.length>0&&o.push(p);S.length>0&&o.push(d);x.length>0&&o.push(v);T.length>0&&o.push(m);N.length>0&&o.push(g);C.length>0&&o.push(y);k.length>0&&o.push(b);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},H.e.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,n(Object(V.i)(a.driveItemKey.endpoint))];case 4:_=F.sent();D=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":_?"ODC-recent":"recent",itemKey:o,itemSetKeyFacet:dt.e,parentItemKeyFacet:vt.e,getUrl:function(e){var t=e.driveItemKey.endpoint+"/"+(e.driveItemKey.endpoint.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(_)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ee(t):0===t.length?Se(n):Se(Object(r.__spreadArrays)([Ee(t)],n))):""})(s)},getDriveItemFacets:function(e){var t=Object($.e)(e),n=e.driveItem,i=n.thumbnails,s=n.remoteItem,o=i||s&&s.thumbnails;return Object(r.__assign)(Object(r.__assign)({},t),o?Object(r.__assign)({},Ct.e.pack(!1)):{})},expectedErrors:D,preprocessResponse:function(e){l?e=kt(e,"image"):c&&(e=kt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:O,groupChildItems:M})))];case 5:P=F.sent().itemResolver;f&&P.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)({},_e.u.pack({})),B)});P.mapKeys({mappings:(j={},j[o]=e.itemKey,j)});n(P.execute());return[2]}})})}});var At=n(431);function Ot(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Mt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=n(Object(te.e)({saveForLaterGraphEndpoint:ne.w})).saveForLaterGraphEndpoint;i=gt.e.deserialize(e.itemKey);if(!t||t===i.driveItemKey.endpoint)return[3,1];i=Object(r.__assign)(Object(r.__assign)({},i),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},i.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,n(re({endpoint:i.driveItemKey.endpoint}))];case 2:(s=f.sent())!==i.driveItemKey.endpoint&&(i=Object(r.__assign)(Object(r.__assign)({},i),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},i.driveItemKey),{endpoint:s})}));f.label=3;case 3:o=gt.e.serialize(i);u=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:o,qosName:"savedForLater",itemSetKeyFacet:gt.e,parentItemKeyFacet:yt.e,getUrl:function(e){if(e.driveItemKey.endpoint===t){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,n,i=e.itemKey,s=e.driveItemKey,o=e.item,u=new ve.e;if(s&&o){var a=W.e.serialize(s),f=At.e.serialize({driveItemKey:s}),l=o&&(o.webDavUrl||o.webUrl);u.resolveItems({items:(t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.v.pack({itemKey:f})),q.i.pack(l)),q.p.pack(o.size)),t[f]=Object(r.__assign)(Object(r.__assign)({},q.b.pack(!0)),Object(be.e)().forFacet(q.b).thenInvalidate(i,H.e).pack()),t)});u.invalidateItems({items:(n={},n[i]=[H.e],n)})}return{itemResolver:u}},filterChildItems:Ot,getDriveItemFacets:function(e){var t=e.driveItem,n=t.root,i=t.remoteItem,s=t.name,o=n?Ce.e.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))),q.h.pack(Object($.t)(o,u))),a?q.u.pack(new Date(a).getTime()):{}),q.d.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new ve.e;n.mapKeys({mappings:(t={},t[o]=e.itemKey,t)});return{itemResolver:n}},expectedErrors:u})))];case 4:a=f.sent().itemResolver;n(a.execute());return[2]}})})}});var _t=n(3505),Dt=n(2784),Pt=Object(i.n)()(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;return Object(r.__generator)(this,function(S){switch(S.label){case 0:return[4,e(Object(Me.e)(function(e){return e.demandItemFacet(w.c,E.e)}))];case 1:if(!S.sent())return[2];t=Object.keys(n);i=t[0];s=At.e.deserialize(i);if(!(o=s.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");u=gt.e.serialize({driveItemKey:{endpoint:o},sortBy:"",isAscending:!0});return[4,e(Object(Dt.e)(function(e){return e.demandItemFacet(H.e,u)}))];case 2:a=S.sent();f=a&&a.itemKeys||[];l=new ve.e;c={};for(h=0,p=f;h<p.length;h++){g=p[h];c[g]=!0}for(d=0,v=t;d<v.length;d++){m=v[d];g=At.e.deserialize(m).driveItemKey;y=!!c[W.e.serialize(g)];l.resolveItems({items:(b={},b[m]=Object(r.__assign)(Object(r.__assign)({},q.b.pack(y||void 0)),Object(be.e)().forFacet(q.b).thenInvalidate(u,H.e).pack()),b)})}e(l.execute());return[2]}})})}});var Ht=n(2618),Bt=new Q.e("searchRootItem",{endpoint:Object(Q.s)()}),jt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(Fe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:Ht.e,parentItemKeyFacet:Bt,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(X.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var Ft=n(1023);function It(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=e.itemKey,i=e.top,s=e.skip;o=de.e.deserialize(t);u=o.driveItemKey,a=o.extFilters;f=o.sortBy,l=o.isAscending;c=o;h=u;return u.driveId&&"me"!==u.driveId?[3,2]:[4,n(re({endpoint:u.endpoint}))];case 1:if((p=F.sent())!==u.endpoint){h=Object(r.__assign)(Object(r.__assign)({},u),{endpoint:p});c=Object(r.__assign)(Object(r.__assign)({},o),{driveItemKey:h})}F.label=2;case 2:d=W.e.serialize(h);v=Object(X.n)(h);return[4,n(Object(Me.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(W.e,d),totalChildCount:e.isItemFacetResolved(_e.e,d)?e.demandItemFacet(_e.e,d):void 0,driveType:e.isItemFacetResolved(Ft.e,d)?e.demandItemFacet(Ft.e,d):void 0}}))];case 3:m=F.sent(),g=m.isParentItemResolved,y=m.totalChildCount,b=m.driveType;w=Promise.resolve(void 0);g||(w=n(Object(V.r)({url:Object(X.t)(h),driveUrl:v,qosName:"getItem",endpoint:h.endpoint})));E=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];S=Object(X.t)(u);x=s?"&skiptoken="+(s+1)+"/"+y+"&skip="+s:"";T=f&&void 0!==l?Object(V.t)(f,l):"";N=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ee(t):0===t.length?Se(n):Se(Object(r.__spreadArrays)([Ee(t)],n))):""})(a);C=n(Object(V.r)({url:S+"/children?$top="+i+x+T+"&$expand=thumbnails&select=*,webDavUrl"+N,driveUrl:v,qosName:"getChildren.folder",endpoint:h.endpoint,expectedErrors:E}));k=[C,w];L=!1;if(!Be.t(He.e.dataFetch.start)){Be.r(He.e.dataFetch.start);L=!0}return[4,Promise.all(k)];case 4:A=F.sent(),O=A[0],M=A[1];L&&Be.r(He.e.dataFetch.end);if(M){M.folder&&(y=M.folder.childCount);M.parentReference&&M.parentReference.driveType&&(b=M.parentReference.driveType)}_=n(Object(V.s)(h.endpoint,b));(D=new ve.e).mapKeys({mappings:(B={},B[de.e.serialize(c)]=e.itemKey,B[d]=W.e.serialize(o.driveItemKey),B)});o.driveItemKey.driveId&&"me"!==o.driveItemKey.driveId||D.mapKeys({mappings:(j={},j[W.e.serialize(Object(r.__assign)(Object(r.__assign)({},o.driveItemKey),{driveId:"me"}))]=W.e.serialize(Object(r.__assign)(Object(r.__assign)({},o.driveItemKey),{driveId:""})),j)});H=(P=D).merge;return[4,n(je({itemKey:t,itemSetKeyFacet:de.e,parentItemKeyFacet:W.e,parentItemResponse:M,childItemsResponse:O,filterChildItems:a&&a.length>0?xe(a):void 0,skip:s,enableRandomAccess:_,totalChildCount:y,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new ve.e;n&&i.resolveItems({items:(t={},t[W.e.serialize(n)]=Object(r.__assign)({},ee.r.pack(W.e)),t)});return{itemResolver:i}}}))];case 5:H.apply(P,[F.sent().itemResolver]);return[2,D]}})})}}var qt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(te.e)({pageSize:ne.r})).pageSize;return[4,n(It(Object(r.__assign)(Object(r.__assign)({},e),{skip:0,top:t||K.t})))];case 1:i=s.sent();Be.r(He.e.resolveData.start);n(i.execute());Be.r(He.e.resolveData.end);return[2]}})})}});var Rt=n(136),Ut=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(Rt.e)(function(){e(Object(U.t)({keyFacet:de.e,facets:[de.e,H.e]}));e(Object(s.s)(de.e,z.e)(qt))}));return[2]})})}}),zt=n(694),Wt=n(3047),Xt=n(3046),Vt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=e.itemKey;i=Xt.e.deserialize(t);s=i.endpoint;o=Object(X.n)(i);return[4,n($t({url:Object(X.e)(i),driveUrl:o,qosName:"commands",endpoint:s}))];case 1:u=l.sent();(a=new ve.e).resolveItems({items:(f={},f[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Wt.e.pack(u.addToOneDrive)),Wt.t.pack(u.createFolder)),Wt.n.pack(u.createLink)),Wt.r.pack(u.delete)),Wt.i.pack(u.download)),Wt.s.pack(u.invite)),Wt.o.pack(u.move)),Wt.u.pack(u.officeLens)),Wt.a.pack(u.rename)),Wt.f.pack(u.upload)),f)});n(a.execute());return[2]}})})}});function $t(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Jt=n(3506),Kt=n(422),Qt=n(3048),Gt=new Q.e("thumbnailToken",{endpoint:Object(Q.s)(),driveId:Object(Q.s)({shouldNormalizeToEmpty:!0})}),Yt=new De.e("thumbnailAccessToken"),Zt=n(162),en=Object(l.t)()(function(){return function(e){return tn}});function tn(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(W.e,n);if(!i)return{};var s=e.demandItemFacet(Ct.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=(function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t})(e.demandItemFacet(Qt.e,n));if(i&&i.large)return{url:sn(i.large.url,r),width:0,height:0}})(e,{itemKey:n,driveItem:i,desiredSize:r}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(q.i,n),o=e.demandItemFacet(q.c,n,{suppressGetItems:!0})||"";if(s){var u=new Y.e(r.endpoint).authority+"/_api/v2.1",a=Gt.serialize({endpoint:u,driveId:r.driveId}),f=e.demandItemFacet(Yt,a);if(f){var l=Object(X.t)({endpoint:u,driveId:r.driveId,itemId:r.itemId}),c=Math.ceil(i.width),h=Math.ceil(i.height);return{url:l+"/thumbnails/0/c"+c+"x"+h+"/content?"+Object(Zt.e)({prefer:"noredirect,closestavailablesize",cb:o,access_token:{uriValue:f}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:i,desiredSize:r});return s?{thumbnail:s}:{}}var nn=/width=[0-9]*/,rn=/height=[0-9]*/;function sn(e,t){var n="number"==typeof t.width?Math.ceil(t.width):t.width,r="number"==typeof t.height?Math.ceil(t.height):t.height,i=""+(n||"");nn.test(e)?e=e.replace(nn,"width="+i):e+=(e.indexOf("?")>-1?"&":"?")+"width="+i;var s=""+(r||"");rn.test(e)?e=e.replace(rn,"height="+s):e+=(e.indexOf("?")>-1?"&":"?")+"height="+s;return e}var on=n(991),un=n(689),an=n(1007),fn=n(385),ln=Object(l.t)()(function(){return function(e){return cn}});function cn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(dt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===fn.o.key)o.push("photo");else if(f.key===fn.u.key)o.push("video");else if(f.key===fn.e.key)o.push("folder");else if(f.key===fn.s.key)o.push("onenote");else if(f.key===fn.r.key)o.push("!photo");else if(f.key===fn.i.key)o.push("!video");else if(f.key===fn.t.key)o.push("!folder");else if(f.key===fn.n.key)o.push("!onenote");else{var l=Object(an.e)(f);l&&o.push(l)}}return{itemKey:dt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var hn=n(478),pn=n(1097),dn=n(289),vn=Object(l.t)()(gn),mn=Object(l.t)()(gn);function gn(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(dt.e,n);if(r&&r.filters&&Object(Ue.e)({extFilters:Object(Ue.t)(r.filters),allowedMediaTypes:[Ie.e.photo,Ie.e.video],fileTypeIconMap:Et.e}))return{defaultLayout:dn.e,isLayoutResolved:!0}}return{}}}}var yn=n(461),bn=new Q.e("sharesItem",{endpoint:Object(Q.s)(),shareId:Object(Q.s)()}),wn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=bn.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(V.n)({url:Object(X.r)(i)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:s,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=d.sent();o=new ve.e;u=t&&t.parentReference;a=u&&u.driveId;f={endpoint:s,driveId:a,itemId:t.id};l=W.e.serialize(f);c=u&&u.id?W.e.serialize({endpoint:s,driveId:a,itemId:u.id}):void 0;o.resolveItems({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object($.e)({driveItem:t,endpoint:s,parentFolderItemKey:c})),me.r.pack(W.e)),H.t.pack({itemKey:de.e.serialize({driveItemKey:f,sortBy:"",isAscending:!0})})),h)});o.mapKeys({mappings:(p={},p[l]=n,p)});e(o.execute());return[2]}})})}});var En=n(1204),Sn=new Q.e("driveItemVirtualizedPage",{endpoint:Object(Q.s)(),setItemKey:Object(Q.s)(),skip:Object(Q.i)(),top:Object(Q.i)()}),xn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Sn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(It(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(be.e)().forFacet(H.e).thenInvalidate(e.itemKey,H.e).pack()),i)});n(t.execute());return[2]}})})}});var Tn=n(170),Nn=Object(Tn.e)(function(){return Promise.resolve().then(n.bind(null,4132))},{chunkName:"graphaddondeferred"}),Cn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(Rt.e)(function(){e(Object(U.t)({keyFacet:W.e,facets:[W.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A,q.i,q.c,R.n]}));e(Object(U.t)({keyFacet:ye,facets:[ye,H.e,H.r]}));e(Object(U.t)({keyFacet:Ne.e,facets:[Ne.e,q.l,q.p,q.d,q.L,q.i,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:o.e,facets:[o.e,H.e]}));e(Object(U.t)({keyFacet:lt,facets:[lt,q.l,q.p,q.d,q.L,q.i,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:ct,facets:[ct,H.e]}));e(Object(U.t)({keyFacet:vt.e,facets:[vt.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A,R.n]}));e(Object(U.t)({keyFacet:dt.e,facets:[dt.e,H.e]}));e(Object(U.t)({keyFacet:yt.e,facets:[yt.e,q.l,q.p,q.d,q.L,q.a,H.t,q.A]}));e(Object(U.t)({keyFacet:Xt.e,facets:[Wt.e,Wt.t,Wt.n,Wt.r,Wt.i,Wt.s,Wt.o,Wt.u,Wt.a,Wt.f]}));e(Object(U.t)({keyFacet:se.e,facets:[oe.h]}));e(Ut);e(Object(s.s)(W.e,z.e)(ie));e(Object(s.s)(Sn,z.e)(xn));e(Object(s.s)(se.e,z.e)(ce));e(Object(s.s)(pe,z.e)(ge));e(Object(s.s)(bn,z.e)(wn));e(Object(s.s)(ye,z.e)(Te));e(Object(s.s)(Ne.e,z.e)(ke));e(Object(s.s)(o.e,z.e)(ft));e(Object(s.s)(lt,z.e)(ht));e(Object(s.s)(ct,z.e)(pt));e(Object(s.s)(vt.e,z.e)(mt));e(Object(s.s)(yt.e,z.e)(bt));e(Object(s.s)(dt.e,z.e)(Lt));e(Object(s.s)(gt.e,z.e)(Mt));e(Object(s.s)(Ht.e,z.e)(jt));e(Object(U.t)({keyFacet:At.e,facets:[q.b]}));e(Object(s.s)(At.e,z.e)(Pt));e(Object(s.s)(zt.e,z.e)(_t.e));e(Object(s.s)(Xt.e,z.e)(Vt));e(Object(a.e)(W.e,Kt.e)(Jt.t));e(Object(a.e)(de.e,Kt.e)(Jt.t));e(Object(a.e)(dt.e,un.e)(ln));e(Object(a.e)(dt.e,hn.e)(vn));e(Object(a.e)(dt.e,pn.e)(mn));e(Object(a.e)(W.e,on.e)(en));e(En.e)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,Nn()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(yn.e)({error:n}));return[3,5];case 5:return[2]}})})}}),kn=n(1223),Ln=n(438),An=n(862),On=Object(l.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(de.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=W.e.serialize(r.driveItemKey),o=e.demandItemFacet(Ft.e,s),u=e.demandItemFacet(ne.r,E.e)||K.t,a=e.demandItemFacet(ne.S,E.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(_e.e,s),getPageKey:function(e,t){return Sn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var Mn=n(437),_n=n(883),Dn=n(820),Pn=n(918),Hn=n(865),Bn=Object(l.t)()(function(){return function(e){return Fn}});var jn=[c.e,Mn.e,_n.e,Hn.e,Dn.e,Pn.e];function Fn(e,t){return{columns:jn}}var In=n(631),qn=Object(i.t)(function(){return function(e){e(Object(a.e)(W.e,In.e)(Object(l.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("5")]).then(n.bind(null,4283))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),Rn=n(292),Un=n(37),zn=Object(l.t)()(function(){return function(e){return Wn}});function Wn(e,t){return(function(e,t,n){var i=n.itemSetKey,s=n.handler,o=s.columnKey,u=s.isAscending,a=e.demandItemFacet(t,i);if(!a)return{};var f=e.demandItemFacet(Ft.e,W.e.serialize(Object(r.__assign)({},a.driveItemKey)));if(!f||"business"===f||"documentLibrary"===f)return{};if(!a.sortBy&&o===Mn.e.key&&!0===u)return{newItemSetKey:i};var l=Object(Un.e)(e,{customColumnKeysToFieldNamesConfiguration:ne.n}).customColumnKeysToFieldNamesConfiguration,c=Object(r.__assign)(Object(r.__assign)({},h.t),l),p=c?c[o]:void 0;if(!p)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},a),{sortBy:p,isAscending:u}))}})(e,de.e,t)}var Xn=n(491),Vn=Object(l.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var $n=n(2347),Jn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Gt.deserialize(n),s=i.endpoint,o=i.driveId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(X.n)({endpoint:s,driveId:o});return[4,e(Object($n.t)(s,t))];case 1:i=l.sent();u=i&&i.accessToken;(a=new ve.e).resolveItems({items:(f={},f[n]=Object(r.__assign)({},Yt.pack(u)),f)});e(a.execute());return[2]}})})}});var Kn,Qn=n(852),Gn=n(113),Yn=n(40),Zn=n(294),er=n(3051),tr=n(2859),nr=n(284);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(Kn||(Kn={}));var rr={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},ir=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=rr[i][o];"small"===i?e="vaultCoverIsSmall_62866f94":"large"===i&&(e="vaultCoverIsLarge_62866f94");return L.createElement("div",Object(r.__assign)({},a,{className:"root_62866f94 "+e+" "+(u?"isFluent":"")}),L.createElement(O.e,{"aria-hidden":!0,className:"ms-VaultCover cover_62866f94",iconName:f}))};return t})(L.Component);var sr=Object(l.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(tr.e,u);if(a&&a.root){var f=e.demandItemFacet(q.l,u),l=a.isLocked?Kn.vaultClosed:Kn.vaultOpen,c={iconType:Qn.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:Gn.t.contain,className:"fileHandlerFileTypeIcon_a90a8987"}};return{iconAs:function(e){return L.createElement(O.e,Object(r.__assign)({},e,c))}}}return{fileTypeIconAs:or}}}});var or=Object(Yn.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(er.e,o);void 0!==f&&("desktop"===f?a=Zn.e.desktopFolder:"documents"===f?a=Zn.e.documentsFolder:"pictures"===f&&(a=Zn.e.picturesFolder))}return n?L.createElement(n,Object(r.__assign)({},i,{type:a})):null}),ur=n(615),ar=n(2344),fr=n(203),lr=n(147);(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(nr.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:L.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:L.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(nr.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:L.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:L.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var cr=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(tr.e,n);return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:pr}:{}),{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:er.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=L.createElement(fr.n,null):"documents"===e?t=L.createElement(fr.r,null):"pictures"===e&&(t=L.createElement(fr.c,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}})}}});var hr=Object(Yn.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(tr.e,n),o=s&&s.isLocked?Kn.vaultClosed:Kn.vaultOpen;return L.createElement(ir,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),pr=Object(Yn.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(tr.e,o);a&&a.root&&(u=Object(lr.r)(e,L.createElement(hr,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?L.createElement(n,Object(r.__assign)({},s,{foreground:u})):null}),dr=n(963),vr=n(108),mr=n(1416),gr=n(2497),yr=n(3053),br=n(14),wr=n(1379),Er=n(28),Sr=n(43),xr=n(18),Tr=new xr.e("openInOfficeOnlineActionControl"),Nr=Object(Yn.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:q.L,appFacet:gr.e,isMalwareDetected:q.N},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(Tr,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=wr.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);a(Object(Me.e)(function(e){return Tr.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(Sr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(Er.e),Cr=Object(br.s)()(Object(br.r)()(Nr)),kr={key:new De.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:L.createElement(Cr,null),facets:Object(r.__assign)({},vr.t.pack(!0))},Lr=n(104),Ar=n(1220),Or=new xr.e("openInOfficeClientActionControl"),Mr=n(2498),_r=new Lr.e,Dr=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Pr=Object(Yn.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:W.e,appMap:gr.e,fileName:q.h,openUrl:q.L,canonicalUrl:q.i,isMalwareDetected:q.N},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,c=!1,h=Dr,p=Object(Mr.s)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var d=!l&&!!o&&!!a&&(_r.isMac||_r.isWindows||_r.isIOS||_r.isWinPhone||_r.isAndroid),v=e.demandItemFacet(Or,n),m=Or.evaluate(v)(e,{itemKey:n,isAvailable:d,protocolCallback:Br}),g=m.protocolCallback,y=m.isAvailable;c=d&&y;s&&c&&(h=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(Ar.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:_r,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:p,appMap:o,fileName:u,protocolCallback:g}))}return Object(r.__assign)({isAvailable:c,onExecute:h},Object(Sr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(Er.e),Hr=Object(br.s)()(Object(br.r)()(Pr));function Br(e){window.location.href=e}var jr={key:new De.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:L.createElement(Hr,null),facets:Object(r.__assign)({},vr.t.pack(!0))},Fr=new De.e("fileHandlerOpenCommand").id,Ir=(Object(br.s)()(Object(br.r)()(Object(Yn.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:gr.e},n).appMap,s=r.name;r.key===kr.key&&(s=s||(i?Object(yr.s)(i,!0):yr.e.OpenInBrowser));return{name:s}})(function(e){return L.createElement("div",{className:"contextualMenuItemLinkContent_aa42db57"},L.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_aa42db57"},e.name))}))),Object(br.s)()(Object(br.r)()(Object(Yn.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:gr.e,fileName:q.h},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(Fr)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c=o&&Object(yr.n)(o),h={iconName:o?Object(yr.t)(o):l?"PDF":"OpenFile"},p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===kr.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(yr.s)(o,!0)||(l?yr.e.OpenInBrowser:yr.e.Open),onRenderIcon:c?qr.bind(void 0,c,!0):void 0}):e.key===jr.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(yr.i)(o),onRenderIcon:c?qr.bind(void 0,c,!0):void 0}):e}));return{iconProps:a||h,onRenderIcon:c?qr.bind(void 0,c,!1):void 0,text:yr.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(mr.e))));function qr(e,t){return e?L.createElement("span",{className:t?"menuItemIconContainer_aa42db57":"iconContainer_aa42db57"},L.createElement(O.e,{iconName:e.logoFill16,className:"logoFillIcon_aa42db57"}),L.createElement(O.e,{iconName:e.logo16,className:"logoIcon_aa42db57"})):null}var Rr={key:dr.e.key,automationId:dr.e.automationId,subMenuProps:{items:[kr,jr]},onRender:function(e){return L.createElement(Ir,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},vr.t.pack(!0))},Ur=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=zr(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}});function zr(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===dr.e.key?n.push(Rr):n.push(s)}return{overrideDefaultCommands:n}}var Wr=n(381),Xr=n(476),Vr=n(1219),$r=n(21),Jr=n(444),Kr={key:new De.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.L,appMap:gr.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Jr.e,{itemKey:n,action:Object($r.i)(e,L.createElement(Nr,{itemKey:n}))}):void 0}}},Qr={key:new De.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.L,appMap:gr.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(Jr.e,{itemKey:n,action:Object($r.i)(e,L.createElement(Pr,{itemKey:n}))}):void 0}}},Gr=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([Vr.e,Kr,Qr],i)}}}});var Yr=n(575),Zr=n(169),ei=n(305),ti=Object(g.i)({key:new De.e("dateAccessedColumn").id,name:Zr.e.AccessedDate,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.s,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.x,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ei.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.s,t)}),ni=Object(l.t)()(function(){return function(e){return ii}});var ri=[p,d.e,ti];function ii(e,t){return{columns:ri}}var si=n(415),oi=n(678),ui=Object(br.s)()(Object(br.r)()(Object(Yn.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(q.A,n);return r?L.createElement(oi.e,{itemKey:r.itemKey}):null}))),ai=n(337),fi={key:"OpenFileLocation",name:ai.e.OpenFileLocation,title:ai.e.OpenFileLocation,action:ui,iconProps:{iconName:"FabricFolder"}},li=Object(l.t)()(function(){return function(e){return hi}});var ci=[dr.e,fi,si.n,si.t];function hi(e,t){return{commands:zr(0,{defaultCommands:ci}).overrideDefaultCommands}}var pi=n(243),di=Object(l.t)()(function(){return function(e){return gi}});var vi={name:"-",key:"divider_1",itemType:pi.e.Divider},mi=[dr.e,fi,vi,si.n,si.t];function gi(e,t){return{commands:mi}}var yi=n(967),bi=Object(l.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var wi=n(390),Ei=n(65),Si=Object(l.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?xi(e,{itemsScopeItemKey:n}):{})}}}}});function xi(e,t){var n=t.itemsScopeItemKey,i=Object(Ei.e)(e,n),s=e.demandItemFacet(Pe,i);return Object(r.__assign)({},s)}var Ti=Object(i.t)(function(){return function(e){e(Object(a.e)(vt.e,wi.e)(Si))}}),Ni=Object(i.t)(function(){return function(e){e(Object(a.e)(dt.e,f.e)(ni));e(Object(a.e)(vt.e,Wr.e)(li));e(Object(a.e)(vt.e,yi.e)(di));e(Object(a.e)(St,Kt.e)(bi));e(Ti)}}),Ci=n(992),ki=Object(g.i)({key:new De.e("dateFollowedColumn").id,name:Zr.e.SavedDate,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.u,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.x,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ei.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.u,t)}),Li=n(1155),Ai=Object(l.t)()(function(){return function(e){return Mi}});var Oi=[p,d.e,ki,Li.e];function Mi(e,t){return{columns:Oi}}var _i=n(366),Di=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?L.createElement("div",{className:"root_3c32ab3a"},this.props.group.name):null};return t})(L.PureComponent),Pi=n(1437),Hi=n(935),Bi=n(554),ji=n(316),Fi=n(697);function Ii(e,t){var n=t.signals;if(n){var i=Object(ji.t)(n,function(e){return e.key===Fi.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var qi=Object(l.t)()(function(){return function(e){return Ui}});var Ri=function(e){var t=e.defaultRender,n=Object(r.__assign)({},Bi.e.pack(Ii));return t?L.createElement(Hi.e,{controlHandlers:n},L.createElement(t,Object(r.__assign)({},e))):null};function Ui(){return{groupHeaderRenderer:Di,rowRenderer:Ri,groupProps:{collapseAllVisibility:Pi.e.hidden}}}var zi=Object(l.t)()(function(){return function(e){return Vi}});function Wi(e,t){var n=t.itemKey,r=e.demandItemFacet(q.u,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(w.x,E.e),o=s&&s.language||window.navigator.language,u=Object(ei.n)(new Date(i),o);return{itemActivity:u&&L.createElement(b.e,{text:u})||null}}return{}}var Xi=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},Bi.e.pack(Ii)),ar.e.pack(Wi));return t?L.createElement(Hi.e,{controlHandlers:i},L.createElement(t,Object(r.__assign)({},n))):null};return t})(L.PureComponent);function Vi(){return{tileRenderer:Xi}}var $i=n(446),Ji=n(3917),Ki=Object(l.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:Ji.e.savedForLaterEmptyStateTitle}}}});var Qi=Object(i.t)(function(){return function(e){e(Object(a.e)(gt.e,_i.e)(qi));e(Object(a.e)(gt.e,Ci.e)(zi));e(Object(a.e)(gt.e,f.e)(Ai));e(Object(a.e)(gt.e,$i.e)(Ki));e(Object(a.e)(yt.e,Wr.e)(Ur))}}),Gi=n(1246);n.d(t,"graphAddon",function(){return Zi});var Yi=Object(Tn.e)(function(){return Promise.resolve().then(n.bind(null,4417))},{chunkName:"graphaddondeferred"}),Zi=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(Rt.e)(function(){e(Cn);e(Object(a.e)(de.e,f.e)(Bn));e(Object(a.e)(de.e,Rn.e)(zn));e(Object(a.e)(o.e,f.e)(j));e(Object(a.e)(W.e,Ln.e)(kn.e));e(Object(a.e)(de.e,An.e)(On));e(Object(a.e)(W.e,Xn.e)(Vn));e(Object(s.s)(Gt,z.e)(Jn));e(Object(a.e)(W.e,ur.e)(sr));e(Object(a.e)(pe,ur.e)(sr));e(Object(a.e)(W.e,ar.e)(cr));e(Object(a.e)(pe,ar.e)(cr));e(Object(a.e)(W.e,Xr.e)(Gr));e(Object(a.e)(vt.e,Wr.e)(Ur));e(Object(a.e)(W.e,Yr.e)(Gi.e));e(qn);e(Ni);e(Qi)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,Yi()];case 3:if(!(t=r.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(yn.e)({error:n}));return[3,5];case 5:return[2]}})})}})},,,function(e,t,n){"use strict";n.r(t);var r,i,s=n(0),o=n(16),u=n(138),a=n(280),f=n(477),l=n(18),c=new l.e("itemsBreadcrumbControl"),h=n(422),p=n(381),d=n(967),v=n(900),m=n(64),g=n(745),y=n(1187),b=n(1188),w=n(1194),E=n(106),S=n(83),x=n(904),T=n(1157),N=n(1169),C=n(4130),k=n(1177),L=n(189),A=n(1),O=n(2948),M=n(480),_=n(3522),D=n(3737),P=n(3399),H=n("react-lib"),B=n(2),j=n(286),F=n(3055),I=n(127),q=n(2499),R=n(5),U=n(123),z=n(1239),W=n(2619),X=n(13),V=n(11),$=n(598),J=n(20),K=n(133),Q=n(82),G=n(2795),Y=n(9),Z=n(3071),ee=((r={})[Q.r.started]=function(e){var t=e.count,n=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(n?Z.e.schedulePublishStartedItemsTitle:Z.e.publishStartedItemsTitle,Z.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[Q.r.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(n?Z.e.schedulePublishCompletedItemsTitle:Z.e.publishCompletedItemsTitle,Z.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[Q.r.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(n?Z.e.schedulePublishFailedItemsTitle:Z.e.publishFailedItemsTitle,Z.e.publishFailedItemsTitleIntervals,t)||"",t)},r[Q.r.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(n?Z.e.schedulePublishFailedItemsTitle:Z.e.publishFailedItemsTitle,Z.e.publishFailedItemsTitleIntervals,t)||"",t)},r),te=((i={})[Q.r.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(r?Z.e.schedulePublishStartedItemsTitle:Z.e.publishStartedItemsTitle,Z.e.publishStartedItemsDestinationTitleIntervals,t)||"",t,H.createElement(G.e,{key:"link",itemKey:n}))},i[Q.r.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(r?Z.e.schedulePublishCompletedItemsDestinationTitle:Z.e.publishCompletedItemsDestinationTitle,Z.e.publishCompletedItemsDestinationTitleIntervals,t)||"",t,H.createElement(G.e,{key:"link",itemKey:n}))},i[Q.r.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(r?Z.e.schedulePublishFailedItemsDestinationTitle:Z.e.publishFailedItemsDestinationTitle,Z.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,H.createElement(G.e,{key:"link",itemKey:n}))},i[Q.r.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(J.formatToArray)(Object(J.getLocalizedCountValue)(r?Z.e.schedulePublishFailedItemsDestinationTitle:Z.e.publishFailedItemsDestinationTitle,Z.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,H.createElement(G.e,{key:"link",itemKey:n}))},i),ne=Object(o.t)(function(){return function(e){e(Object(a.e)(F.e,$.e)(Object(V.t)()(re)))}});function re(){return function(e){return ie}}function ie(e,t){var n,r,i=Object(K.i)(e,t),o=i.phase,u=i.count,a=(function(e,t){var n=void 0,r=e.demandItemFacet(Y.e,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(Q.g,o),a=u&&u.itemKey,f=e.demandItemFacet(R.A,a),l=f&&f.itemKey;if(l)if(n){if(l!==n)break}else n=l}return n})(e,t),f=e.demandItemFacet(Y.e,t.itemKey),l=f&&f.itemKeys;l&&l.length>0&&(r=e.demandItemFacet(F.t,l[0]));var c=!!r&&r.publishActionType===q.e.SchedulePublish;n="group"===t.format&&a?te[o]({count:u,itemKey:a,isScheduled:c}):ee[o]({count:u,isScheduled:c});return Object(s.__assign)(Object(s.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var se=n(71),oe=n(2024),ue=n(156),ae=se.e.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?Object(K.s)({operationTypeFacet:F.t,progressKeyFacet:F.e}):Object(K.s)({operationTypeFacet:F.t,progressKeyFacet:F.e,initializeBatch:function(){return ne}}),fe=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,s=e.reject,o=n[0],u=t(Object(U.e)(function(e){return e.demandItem({firstItemKey:m.e,displayName:R.l},n[0])})).firstItemKey,a=t(Object(U.e)(function(e){return W.n(e,o)})),f={publishActionType:a},l=!1;if(u){var c=t(Object(U.e)(function(e){return e.demandItemFacet(A.Be,E.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}))}));l=!!c&&c.templateType===X.t.webPageLibrary}if(u&&l&&a===q.e.SubmitForApproval){var h=""+new ue.e(u.webAbsoluteUrl).authority+t(Object(U.e)(function(e){return e.demandItemFacet(A.fe,n[0])}));window.location.href=h}else t(ae({items:Object(I.e)(n,function(){return f})})).then(function(){var e,s;t(Object(z.e)({items:(e={},e[o]=[A.un],e[o]=[A.Qe],e)}));r&&t(Object(oe.e)({items:(s={},s[r]=Object(I.e)(n,function(){return{}}),s)}));i()}).catch(function(e){s(e)})};t.prototype.render=function(){return null};return t})(H.PureComponent),le=n(14),ce=n(40),he=n(186),pe=n(43),de=n(2588),ve=n(21),me=n(28),ge=n(65),ye=n(345),be=n(1053),we=Object(ce.e)()(fe),Ee=Object(ce.e)(function(e,t){var n=t.onCancel,r=t.reject;return{onCancel:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){r(new he.e);n&&n();return[2]})})},title:Z.e.MissingMetadataDialogTitle,prompt:Z.e.MissingMetadataDialogText,cancelText:Z.e.MissingMetadataDialogButton}})(de.e),Se=Object(ce.t)(function(e,t){var n,r=t.itemKeys,i=t.publishType,o=t.source;if(!r||!r.length)return null;var u=Object(ge.e)(e),a=e.demandItem({firstItemKey:m.e,hasMissingMetadata:R.C,contentTypeId:A.p},r[0]),f=a.firstItemKey,l=a.hasMissingMetadata,c=a.contentTypeId;if(!f)return null;var h=f&&e.demandItemFacet(A.Qt,ye.e.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));if(h&&(h.isAnonymousGuestUser||h.isEmailAuthenticationGuestUser))return null;var p=!1,d=!!h&&Object(se.t)(h).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),v=W.n(e,r[0]);if(!(!d&&r.length>1&&((null===(n=h)||void 0===n?void 0:n.listBaseTemplate)!==X.n.webPageLibrary||!(v===q.e.Publish||v===q.e.Republish||v===q.e.PostNews||v===q.e.UpdateNews))))for(var g=0,y=r;g<y.length;g++){var b=y[g];if(!(p=!!W.e(e,b)&&(!(!d&&r.length>1&&!W.i(c))&&(be.t(e,b)?1===i:0===i))))break}var w=Object(ve.o)(function(e){if(l){return H.createElement(Ee,Object(s.__assign)({},e,{onCancel:function(e){}}))}return H.createElement(we,Object(s.__assign)({},e,{itemKeys:r,itemSetKey:u}))});return H.createElement(me.e,Object(s.__assign)({isAvailable:p,onExecute:w},Object(pe.t)(e,{itemKey:r[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:o}}})))}),xe=Object(le.s)()(Se),Te=n(195),Ne=new B.e("Publish").id,Ce=new B.e("Schedule").id,ke=new Map([[q.e.Publish,j.e.Publish],[q.e.CancelApproval,j.e.CancelApproval],[q.e.SubmitForApproval,j.e.SubmitForApproval],[q.e.SchedulePublish,j.e.Schedule],[q.e.Republish,j.e.Republish]]),Le=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,r=Object(s.__rest)(e,["defaultRender","itemKeys"]),i=n[0];return H.createElement(Te.e,null,function(e){var n=e.itemCache,o=Object(W.n)(n,i),u=ke.get(o)||j.e.Publish;return t?H.createElement(t,Object(s.__assign)({},r,{text:u})):null})};return t})(H.PureComponent),Ae={key:Ne,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:j.e.Publish,action:H.createElement(xe,{publishType:0,source:"Command"}),commandBarButtonAs:Object(le.s)()(Le)},Oe={key:Ce,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:j.e.Schedule,action:H.createElement(xe,{publishType:1,source:"Command"}),commandBarButtonAs:Object(le.s)()(Le)},Me=n(3063),_e=n(712),De=n(618),Pe=n(886),He=n(77),Be=n(252),je=n(607),Fe=n(235),Ie=n(905),qe=n(1189),Re=n(502),Ue=n(318),ze=n(1162),We=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},Xe=Object(le.e)()(Object(le.s)()(Object(ce.e)(function(e,t){var n,r,i,o=t.itemKey,u=t.itemKeys,a=t.enabledForMultipleItems,f=void 0===a?t.enabledForMultipleItems||!1:a,l=t.isEnabledFunc,c=t.url,h=!!f||1===u.length,p=void 0,d=void 0;if(h&&u[0]){var v=e.demandItem({key:m.e,permissions:A.st,rowData:A.bt},u[0])||void 0;if(v){d=v.key;p=v.rowData;i=v.permissions}}else if(h&&o){var g=e.demandItem({key:m.e,permissions:A.st},o);if(g){d=g.key;i=g.permissions}}n=d&&d.webAbsoluteUrl;r=d&&d.listFullUrl;var y=n&&r&&e.demandItemFacet(A.Qt,ye.e.serialize({webAbsoluteUrl:n,listFullUrl:r}))||void 0;if(h&&!f)if("boolean"==typeof l)h=l;else if("function"==typeof l){var b="",w="",E="";if(p){var S=p;b=S.File_x0020_Type||"";w=S.ContentTypeId||"";E=S.ProgId||""}else h=!1;h=l({permissions:i||0,extension:b,contentTypeId:w,progId:E})}if(h&&c){var x=[];u.forEach(function(t){var n=e.demandItem({itemId:A.Ie,itemUrl:A.fe},t);n&&x.push({id:n.itemId||"",url:n.itemUrl||""})});y&&(c=Object(Ue.r)(c,x,y))}var T=We;T=c&&"javascript:LaunchApp("===c.substring(0,21)&&");"===c.substring(c.length-2)?function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){c&&y&&Object(ze.e)(c,y);return[2]})})}:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){(e=window.open(c,"_blank"))&&e.focus();return[2]})})};return Object(s.__assign)({isAvailable:h,onExecute:T},Object(pe.t)(e,{itemKey:u[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(me.e))),Ve=n(117),$e=n(175),Je=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},Ke=Object(ce.t)(function(e,t){var n=t.itemKeys,r=t.enabledForMultipleItems,i=void 0===r?t.enabledForMultipleItems||!1:r,o=t.isEnabledFunc,u=t.commandAdapter,a=e.dispatch,f=!!i||1===n.length;if(f&&1===n.length&&"function"==typeof o){var l=e.demandItem({key:m.e,permissions:A.st,rowData:A.bt},n[0]),c="",h="",p="";if(l&&l.rowData){var d=l.rowData;c=d.File_x0020_Type||"";h=d.ContentTypeId||"";p=d.ProgId||""}else f=!1;f=f&&o({permissions:l&&l.permissions||0,extension:c,contentTypeId:h,progId:p})}if(f&&u){var v=[];n.forEach(function(t){var n=e.demandItemFacet(Fe.u,t);n&&v.push(n)});u.refresh(v);f=f&&u.visible}var g=Je;u&&(g=function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2,u.execute()]})})});var y=!se.e.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return H.createElement(H.Fragment,null,y?H.createElement(Qe,{dispatch:a,itemKeys:n}):null,H.createElement(me.e,Object(s.__assign)({isAvailable:f,onExecute:g},Object(pe.t)(e,{itemKey:n[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),Qe=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var r=n[0],i=void 0;if(m.e.matches(r)){var o=m.e.deserialize(r);if(o){var u=E.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});i=t(Object(Ve.e)({listViewAdapter:Fe.o},u)).listViewAdapter}}var a={};if(i){n.forEach(function(e){var n=t(Object(Ve.e)({rowData:A.bt,rowAdapter:Fe.u},e)),r=n.rowData;if(!n.rowAdapter&&r&&i){var o=i.createRowAdapter({values:r});o&&(a[e]=Object(s.__assign)({},Fe.u.pack(o)))}});Object.keys(a).length>0&&t(Object($e.e)({items:a}))}return null},Ge=Object(le.s)()(Ke),Ye=n(852),Ze=n(113),et=n(61),tt=new B.e("customActionNavigationCommand").id;function nt(e){var t=e.key,n=e.name,r=e.url,i=e.iconUrl,s=e.enabledForMultipleItems,o=e.isEnabledFunc,u=e.commandAdapter;return{key:tt+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:Ye.e.image,className:"customActionCommandIcon_cd2598ba",imageProps:{src:i||"",imageFit:Ze.t.contain,className:"customActionCommandIcon_cd2598ba"}},action:u?H.createElement(Ge,{enabledForMultipleItems:s,isEnabledFunc:o,commandAdapter:u}):r?H.createElement(Xe,{url:r,enabledForMultipleItems:s,isEnabledFunc:o}):void 0}}var rt=new B.e("customActionGroupCommand").id;function it(e,t){var n=[],r=e.demandItemFacet(Y.e,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r,i,s,o,u=e.demandItem({displayName:R.l,openUrl:R.L,iconUrl:Re.t,childItemKeys:Y.e,enabledForMultipleItems:Re.e,isEnabledFunc:Re.n,commandAdapter:Fe.i},t);if(u&&u.displayName){var a=u.displayName,f=u.openUrl,l=u.iconUrl,c=u.enabledForMultipleItems,h=u.isEnabledFunc,p=u.childItemKeys,d=u.commandAdapter;if(p&&p.itemKeys&&p.itemKeys.length>0){var v=[];p.itemKeys.forEach(function(n,r,i){var s=e.demandItem({subMenuDisplayName:R.l,openUrl:R.L,iconUrl:Re.t,enabledForMultipleItems:Re.e,isEnabledFunc:Re.n,commandAdapter:Fe.i},n);s&&s.subMenuDisplayName&&v.push(nt({key:t+"-"+n,name:s&&s.subMenuDisplayName,url:s&&s.openUrl,iconUrl:s&&s.iconUrl,enabledForMultipleItems:s&&s.enabledForMultipleItems,isEnabledFunc:s&&s.isEnabledFunc,commandAdapter:s&&s.commandAdapter}))});n.push((i=(r={key:t,name:a,subCommands:v}).key,s=r.name,o=r.subCommands,{key:rt+"-"+i,automationId:"customActionGroupCommand",name:s,subMenuProps:{items:o}}))}else a&&n.push(nt({key:t,name:a,url:f,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:h,commandAdapter:d}))}});return n}function st(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,s=e.targetCustomActionSetKey,o=void 0,u=E.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),a=i.demandItemFacet(Fe.s,u),f=i.demandItemFacet(A.mt,s),l=!!a&&!!f,c=Object(et.e)(i).itemsScopeItemKey;if(l&&c){var h=qe.e.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:l,targetCustomActionSetKey:s,itemsScopeItemKey:c});i.demandItemFacet(Y.e,h)&&(o=h)}return o}var ot=n(415),ut=n(690),at=n(309),ft=n(1394),lt=n(3742),ct=n(2338),ht=n(2787),pt=n(2480),dt=n(168),vt=[{keys:"Ctrl + a",desc:at.e.selectAllDesc},{keys:"Ctrl + d",desc:at.e.deselectAllDesc},{keys:"esc",desc:at.e.escDesc},{keys:"space",desc:at.e.spaceDesc},{keys:"enter",desc:at.e.enterDesc}],mt=[{keys:"F2",desc:at.e.renameDesc},{keys:"Delete",desc:at.e.deleteDesc},{keys:"s",desc:at.e.showShareDesc},{keys:"alt + up",desc:at.e.altUpDesc},{keys:"?",desc:at.e.showKeymapDesc},{keys:"g",desc:at.e.showActionDetailsDesc},{keys:"i",desc:at.e.toggleInfoDesc}];function gt(e){var t=e.resolve,n=Object(dt.e)(function(){t()}),r=[vt,mt],i=-1,s=-1;return H.createElement(pt.e,null,H.createElement(lt.e,{onDismiss:n,hidden:!1,dialogContentProps:{type:ct.e.close,title:at.e.KeyboardMapTitle},styles:bt},r.map(function(e){return H.createElement("div",{className:"keyboardMapGroup_0538ad13",key:"keyMap"+ ++i},H.createElement("ul",{className:"keyboardMapTable_0538ad13",key:""+i},e.map(function(e){return H.createElement("li",{className:"keyboardMapRow_0538ad13",key:""+ ++s},H.createElement("span",{className:"keyboardMapKey_0538ad13",key:i+"."+s+".0.0"},e.keys),H.createElement("span",{className:"keyboardMapVal_0538ad13",key:i+"."+s+".1.1"},e.desc))})))}),H.createElement(ht.e,null,H.createElement(ft.e,{onClick:n},at.e.okButtonText))))}var yt=Object(ce.t)(function(e){var t=Object(ve.o)(gt);return H.createElement(me.e,{onExecute:t})});function bt(){return{main:{maxWidth:"700px !important"}}}var wt={key:new B.e("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:at.e.showKeymapDesc},action:H.createElement(yt,null)},Et=n(303),St=Object(ce.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(R.A,n),i=r&&r.itemKey;return H.createElement(Et.e,{itemKey:i})}),xt=Object(le.i)()(St),Tt=n(108),Nt={key:new B.e("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:at.e.altUpDesc},action:H.createElement(xt,null),facets:Object(s.__assign)({},Tt.i.pack(!0))},Ct=n(2778),kt=n(1091),Lt=n(3747),At=n(3527),Ot=n(3782),Mt=n(57),_t=n(302),Dt=n(37),Pt=n(46),Ht=n(3521),Bt=n(534),jt=n(213),Ft=n(120),It=new B.e("getPrintFileUrlOperation"),qt=new B.e("universalPrintGetFileUrlItem"),Rt=Object(u.i)({operationTypeFacet:It}),Ut=n(103),zt=new l.e("PrintToUniversalPrinterActionControl",{}),Wt=n(1674),Xt=n(2347),Vt=n(91),$t=new B.e("universalPrintSharedPrinterListItem"),Jt=n(4),Kt=new Jt.e("universalPrintSharedPrinterKey",{endpoint:Object(Jt.s)(),fileType:Object(Jt.s)()}),Qt=new B.e("universalPrintLicenseCache"),Gt=Object(Vt.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("550")]).then(n.bind(null,4412))];case 1:return[2,e.sent().UniversalPrint]}})})}),Yt=Object(ce.t)(function(e,t){var r=t.itemKey,i=t.getPrintFileItem,o=void 0===i?Rt:i;if(!r)return null;var u=e.dispatch,a=e.demandItemFacet(zt,r),f=Object(Dt.e)(e,{graphEndpoint:Ft.l,universalPrintCache:Qt}),l=f.graphEndpoint,c=f.universalPrintCache;if(!l)return null;var h=zt.evaluate(a)(e,{itemKey:r,isAvailable:!1}),p=h.isAvailable,d=h.fileType,v=h.fileDisplayName,m=h.fileExtension,g=h.pdfUrlGenerator;if(!v||!d)return null;var y=function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(s.__generator)(this,function(n){switch(n.label){case 0:return o?[4,u(o({items:(t={},t[r]={pdfUrlGenerator:g},t)}))]:[3,2];case 1:n.sent();if(e=u(Object(U.e)(function(e){return e.demandItemFacet(qt,r)})))return[2,e];n.label=2;case 2:throw new Error("Failed to fetch Print File data")}})})},b=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,r;return Object(s.__generator)(this,function(i){switch(i.label){case 0:return[4,n.e("553").then(n.bind(null,1752))];case 1:t=i.sent().demandItems;return[4,u(t(function(t){return t.demandItemFacet($t,Kt.serialize({endpoint:l,fileType:e}))}))];case 2:if(r=i.sent())return[2,r];throw new Error("Failed to fetch list of shared printers")}})})},w=Object(ve.o)(function(e){var t=e.resolve,n=u(Wt.e).dataRequestor;return H.createElement(Gt,{endpoint:l,onClose:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){t();return[2]})})},fileDisplayName:v,fileExtension:m,fileType:d,getPrintFileData:y,dataRequestor:n,getPrintAuthToken:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){switch(t.label){case 0:return[4,u(Object(Xt.e)(["PrinterShare.Read.All","PrintJob.ReadWrite"],l||""))];case 1:if(e=t.sent())return[2,{accessToken:e}];throw new Error("Failed to fetch Print Graph Access Token")}})})},getSharedPrinterList:b,saveUserPreferences:function(e){c&&c.setValue("userpreferernces-"+d,e)},getUserPreferences:function(){if(c)return c.getValue("userpreferernces-"+d)}})});return H.createElement(me.e,Object(s.__assign)({isAvailable:p,onExecute:w},Object(pe.t)(e,{itemKey:r,engagement:{name:"PrintToUniversalPrinter",isIntentional:!0}})))}),Zt=Object(Ut.t)(function(e){return function(t){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(n){switch(n.label){case 0:return[4,t(Rt(e))];case 1:return[2,n.sent()]}})})}});var en=Object(ce.e)(function(){return{getPrintFileItem:Zt}})(Object(le.s)()(Object(le.r)()(Yt))),tn=n(3925),nn={key:new B.e("universalPrint").id,automationId:"universalPrintCommand",action:H.createElement(en,null),name:tn.e.printToUniversalPrinter,title:tn.e.PrintToUniversalPrinterTooltip,iconProps:{iconName:"Print"}},rn=n(696),sn={ODB:1544},on=[Me.t,Me.e,Me.r],un=[wt,Nt],an=Object(V.t)()(hn),fn=Object(V.t)()(hn),ln=function(e,t){var n=Object(s.__rest)(_.e,[]);if(e&&e.open&&e.open.length>0){n.subMenuProps=n.subMenuProps||{};n.subMenuProps.items=Object(Ct.t)(n.subMenuProps&&n.subMenuProps.items||[],e.open,t);!se.e.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return n};function cn(e,t){var n,r,i=t.itemKey,o=t.itemSetKey,u=t.commands,a=t.overflowCommands,f=t.farCommands,l=t.shortcutCommands,c=e.demandItemFacet(m.e,i),h=e.demandItemFacet(S.e,o),p=a?Object(s.__spreadArrays)(a):[],d=!0,v=!1,g=void 0,y=void 0,b=void 0,w=u?Object(s.__spreadArrays)(u):[],x=f,T=[],N="",C=c&&E.e.serialize(c),H=e.demandItemFacet(E.e,C);h&&h.viewKey&&(N=h.viewKey.viewId);var B,j,F,I=[],q=!1;if(c&&H){q=Object(kt.t)(e,i,c);var R=e.demandItemFacet(A.Be,C);d=!!R&&!!R.isDocumentLibrary;B=Object(Pt.e)(e,i);d?T=l?Object(s.__spreadArrays)(l,un):Object(s.__spreadArrays)(un):w=Object(O.e)(B);if(!(v=!!R&&R.templateType===X.t.mySiteDocumentLibrary)){d&&p.push.apply(p,on);p&&p.push(Object(Ht.e)({listFacets:R}));var U={webAbsoluteUrl:H.webAbsoluteUrl,listFullUrl:H.listFullUrl},z=k.e.serialize(U),W=e.demandItemFacet(Y.e,z);if(W&&W.itemKeys&&f){!N&&B&&B.viewId&&(N=He.e.normalizeLower(B.viewId,!1));r=e.demandItemFacet(A.Ye,C);x=(j=f,F=Object(D.e)(e,{viewKeys:W.itemKeys,webAbsoluteUrl:c.webAbsoluteUrl,listViewSetKey:U,itemSetKey:o,currentViewKey:L.e.serialize({viewId:N})}),j.map(function(e){return e.key===je.e.key?F:e}))}}R&&H&&(I=(n=Object(Ot.e)(e,{key:c,listFacets:R,listKey:H,pageContext:B})).contentTypes,g=n.contentTypeCommands);y=(function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=Ie.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),s=st({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=it(e,i);s&&(o=o.concat(it(e,s)));return o})(e,c);B&&R&&(b=Object(At.e)(e,{isODB:v,key:c,listFacets:R,pageContext:B}).fileHandlerCommands)}var V=Object(Dt.e)(e,{enableQuickEdit:A.$,enableUniversalPrint:Ft.u}),$=V.enableQuickEdit,J=V.enableUniversalPrint,K=!!B&&!!$;if(K){var Q=Object(et.e)(e).itemsScopeItemKey;if(Object(jt.e)(e,{itemsScopeItemKey:Q})===_t.e)return{commands:[Pe.e],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var G=(function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,s=t.isODB,o=t.contentTypeCommands,u=t.customActionCommands,a=t.fileHandlerCommands,f=t.newDocumentTemplates,l=t.contentTypes,c=t.isCreateFolderAvailable,h=t.listKey,p=t.pageContext,d=t.printEnabled,v=[],m=!se.e.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),g={},y=0,b=r;y<b.length;y++){var w=b[y];g[w.key]=w}for(var E=0,S=r;E<S.length;E++){if((w=S[E]).key===Be.e.key){var x=Object(Lt.e)(e,{contentTypes:l,newCommandMenu:w,fileHandlerCommands:a,isCreateFolderAvailable:c,newDocumentTemplates:f,contentTypeCommands:o,listKey:h}).visibleNewCommands;v.push(x)}else if(w.key===Bt.e.key&&n&&!g[De.t.key])v.push(w,De.t);else if(w.key===_.e.key){var T=ln(a,m);v.push(T)}else if(w.key===ot.t.key&&i&&!g[_e.e.key])v.push(w,_e.e);else if(w.key===ut.e.key&&i){v.push(w);s||g[M.e.key]||v.push(M.e);v.push(P.t,P.e)}else if(w.key===ot.n.key){!i&&Object(Mt.e)(e,{feature:sn,pageContext:p})?v.push(ot.e):v.push(w);v.push(Ae,Oe)}else w.key===rn.e.key&&d?v.push(rn.e,nn):v.push(w)}u&&u.length>0&&v.push.apply(v,u);a&&a.custom&&a.custom.length>0&&(v=Object(Ct.t)(v,a.custom));return{overrideDefaultCommands:v}})(e,{defaultCommands:w,isDocumentLibrary:d,isODB:v,contentTypeCommands:g,customActionCommands:y,fileHandlerCommands:b,newDocumentTemplates:r,contentTypes:I,isCreateFolderAvailable:q,quickEditEnabled:K,listKey:c,pageContext:B,printEnabled:!!J});return{commands:w=G.overrideDefaultCommands,overflowCommands:p,farCommands:x,shortcutCommands:T}}function hn(){return function(e){return function(e,t){return cn(e,t)}}}var pn=n(906),dn=n(2958),vn=n(232),mn=n(1210),gn=n(1209),yn=n(494),bn=n(194),wn=n(39),En={ODB:1544},Sn=Object(V.t)()(function(){return function(e){return function(t,n){var r,i=n.itemKey,o=n.commands,u=t.demandItemFacet(m.e,i);if(u){var a=E.e.serialize(u);r=t.demandItemFacet(A.Be,a)}var f=o?Object(s.__spreadArrays)(o):[];f.push(P.t,P.e);var l=void 0;if(u){var c=u.listFullUrl,h=u.webAbsoluteUrl,p=Object(Me.i)({listFacets:r}),d=t.demandItemFacet(A.Qt,ye.e.serialize({webAbsoluteUrl:h,listFullUrl:c}));if(r&&!r.isDocumentLibrary){f=[O.t];for(var v=0,g=Object(O.e)(d);v<g.length;v++){var y=g[v];y.key===ot.n.key&&Object(Mt.e)(t,{feature:En,pageContext:d})?f.push(ot.e):y.key!==M.e.key&&f.push(y)}}f.push(p);var b=pn.e.serialize({webAbsoluteUrl:h,listFullUrl:c}),w=st({itemCache:t,targetCustomActionSetKey:b,keys:{webAbsoluteUrl:h,listFullUrl:c}});f=f.concat(it(t,b));w&&(f=f.concat(it(t,w)));if(d&&r&&(r.templateType===X.t.documentLibrary||r.templateType===X.t.mySiteDocumentLibrary)){var S=new ue.e(h||c).authority+"/_api/v2.0",x=vn.t.serialize({endpoint:S});l=Object(Ct.e)(t,{itemKey:x})}}var T=!se.e.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),N=!!Object(Dt.e)(t,{enableUniversalPrint:Ft.u}).enableUniversalPrint;return{commands:xn(f,l,r&&r.templateType===X.t.mySiteDocumentLibrary,T,N),onMenuOpened:function(){e(function(e){var t=(e(Object(bn.e)({spLoggerConfiguration:wn.o})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(yn.t(n))})}}}}});function xn(e,t,n,r,i){for(var s=[],o=0,u=e;o<u.length;o++){var a=u[o],f=a.key;if(f===_.e.key){var l=t&&t.open||[];l.length>0&&dn.t.subMenuProps&&(dn.t.subMenuProps.items=Object(Ct.t)(dn.t.subMenuProps.items,l,r));s.push(dn.t)}else{s.push(a);if(f===ut.e.key)s.push(gn.e);else if(f===rn.e.key){s.push(mn.e);i&&n&&s.push(nn)}}}return t&&t.custom&&t.custom.length>0?Object(Ct.t)(s,t.custom):s}var Tn=n(542),Nn=Object(V.t)()(function(){return function(e){return function(e,t){var n=Object(ge.e)(e),r=(function e(t,n,r){var i=n,o=r;if(n&&r){var u=t.demandItem({spGroupField:A.qt,groupValue:A.be,parentGroupKey:A.it,groupFilterByValue:A.ve,groupValueDisplayValue:A.ye},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue,h=u.groupValueDisplayValue;l&&(o=e(t,l.itemKey,r));var p=t.demandItemFacet(S.e,o);if(p){var d=t.demandItemFacet(g.e,n),v=Object(Tn.e)(Object(s.__assign)(Object(s.__assign)({},p),d?{viewKey:d.viewKey}:{})),m=c||f;if(void 0!==m&&a&&a.internalName&&a.fieldType){var y=!se.e.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===a.fieldType,b=!se.e.isActivated("e278b853-095c-41f6-a0b9-8ad603442ce7","2/22/2021","Use group display value as the filterDisplays");i=v({filterField:a.internalName,filterValues:[m],filterDisplays:b&&!!h&&[h]||y&&[f||m]||[],filterType:a.fieldType,useLookupId:!1})}}}return i})(e,t.itemKey,n),i=e.demandItem({parentItem:Y.s},n).parentItem,o=(function(e){var t=this,n=e.stageItem,r=e.parentItemKey;return n?Object(Ut.t)(function(e){var i=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(u){switch(u.label){case 0:r&&e(Object($e.e)({items:(t={},t[o]=Object(s.__assign)({},Y.s.pack({itemKey:r})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:i}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:i&&i.itemKey,stageItem:t.stageItem});return r?Object(s.__assign)({itemKey:r},o?{stageItem:o}:{}):{}}}});var Cn=n(784),kn=n(143),Ln=n(146),An=new kn.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(Y.t,n),i=r&&r.itemKey,s=e.demandItemFacet(Y.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]}}),On=Object(V.t)()(function(){var e=this;return function(){return function(t,r){var i,o=r.itemKey,u=r.stageItem,a=Object(Ln.e)(t),f=Object(ge.e)(t),l=t.demandItemFacet(x.e,o);if(l){var c=t.demandItemFacet(m.e,a),h=t.demandItemFacet(Cn.e,f);c?l.webAbsoluteUrl===c.webAbsoluteUrl&&(i={isToggled:!0}):h&&l.webAbsoluteUrl===h.webAbsoluteUrl&&(i={isToggled:!0})}var p=t.demandItemFacet(An,o,{suppressGetItems:!0});return Object(s.__assign)(Object(s.__assign)({},i||{}),p?{itemKey:p.itemKey}:{stageItem:function(t){return function(r){return Object(s.__awaiter)(e,void 0,void 0,function(){var e,i,o,a,f,l;return Object(s.__generator)(this,function(c){switch(c.label){case 0:o=[Object(s.__assign)({},t)];return(a=u)?[4,r(u(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=s.__assign.apply(void 0,o.concat([a||{}])).currentItemKey,i=void 0===e?t.currentItemKey:e;return[4,n.e("553").then(n.bind(null,1752))];case 3:f=c.sent().demandItems;return[4,r(f(function(e){return e.demandItemFacet(An,i)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var Mn=n(167),_n=n(922),Dn=n(258),Pn=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(ge.e)(e),o=void 0;if(r){var u=e.demandItemFacet(m.e,r);u&&(o=m.e.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(S.e,s),f=a&&a.filterParams,l=e.demandItemFacet(A.Ht,s),c=l&&l.filterList;!l&&f&&(c=Mn.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||Dn.e.EmptyFilterOptionLabel}),v=Mn.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:Dn.e.booleanFalse,booleanTrue:Dn.e.booleanTrue}),m=Hn(f,c,h+1),g=(y=Object(_n.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:m}))?S.e.serialize(y):i;t.unshift({key:p.fieldName,text:v,onClick:n&&g?n(g):void 0})}for(;i&&!u[i];){u[i]=!0;var y,b=e.demandItem({displayName:R.l,parentFolder:R.A},i),w=b.displayName,E=b.parentFolder;g=(y=Object(_n.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?S.e.serialize(y):i;t.unshift({key:i,text:w||"",onClick:n&&g?n(g):void 0});if(r&&(r===i||o===i))break;i=E&&E.itemKey||""}return t}}}}});function Hn(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=Mn.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var Bn=n(51),jn=n(1152),Fn=n(392),In=n(338),qn=n(313),Rn=In.t.serialize({}),Un={key:new B.e("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(In.n,Rn),i=r&&r.draggedItem,s=!i||i.type===qn.t,o=e.demandItemFacet(Bn.s,n);return{action:s&&o?H.createElement(jn.e,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(Fn.n)(e.event)||!1}}},zn=n(3410),Wn={isAvailable:!1,onExecute:void 0},Xn=Object(ce.e)(function(e,t){var n=t.itemKeys,r=t.groupKey;if(!(!!e.demandItemFacet(g.e,r)&&n&&n.length>0))return Wn;var i=e.demandItem({childItems:Y.e},r).childItems,o=i&&i.itemKeys||[],u=!!e.demandItemFacet(g.e,o[0]);if(0===o.length||u)return Wn;var a=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===a.length)return Wn;var f=a[0],l=e.dispatch;return Object(s.__assign)({isAvailable:!0,onExecute:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){e={groupKey:r};return[2,l(Object(zn.t)({items:Object(I.e)(n,function(){return e})}))]})})}},Object(pe.t)(e,{itemKey:f,engagement:{name:"Move",isIntentional:!0}}))})(me.e),Vn=In.t.serialize({}),$n={key:new B.e("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Bn.s,n),i=e.demandItemFacet(In.n,Vn),s=i&&i.draggedItem;return{action:(!s||s.type===qn.e)&&r?H.createElement(Xn,{itemKeys:s&&s.itemKeys||[],groupKey:n}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer.draggedItem;return n&&n.type===qn.e||!1}return!1}}},Jn=n(66);var Kn=Object(Jn.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("17").then(n.bind(null,4302))];case 1:return[2,e.sent().ReorderListItemsActionExecutor]}})})},function(e,t){var n=t.itemKeys,r=t.targetItemKey,i=t.targetItemIndex;return!!(Object(ge.e)(e)||"")&&n.length>0&&!!r&&void 0!==i}),Qn=In.t.serialize({}),Gn={key:new B.e("reorderListItemsDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=t.itemIndex,i=e.demandItemFacet(A.Ie,n),s=e.demandItemFacet(R.d,n),o=e.demandItemFacet(In.n,Qn),u=o&&o.draggedItem,a=u&&u.itemKeys||[],f=a.length>1||1===a.length&&a[0]!==n;return{action:(!u||u.type===qn.e)&&!!i&&f&&!s&&void 0!==r?H.createElement(Kn,{itemKeys:a,targetItemKey:n,targetItemIndex:r}):void 0}},canHandleEvent:function(e){return function(t){var n,r,i,s,o=null===(n=e.event)||void 0===n?void 0:n.dataTransfer,u=null===(r=o)||void 0===r?void 0:r.dropToPosition;return(null===(s=null===(i=o)||void 0===i?void 0:i.draggedItem)||void 0===s?void 0:s.type)===qn.e&&void 0!==u||!1}}},Yn=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(s.__spreadArrays)([Un,$n],n||[])}}}});var Zn=Object(V.t)()(function(){return function(e){return function(e,t){var n=Object(ge.e)(e)||"",r=e.demandItemFacet(A.s,n),i=t.handlers;return r?{handlers:Object(s.__spreadArrays)([Gn],i||[])}:Object(s.__assign)({},t)}}});var er=n(42),tr=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:g.e,isDropEnabled:Bn.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&m.e.serialize(i.itemSetKey),u=o&&e.demandItemFacet(A.st,o),a=er.e.hasItemPermission({permissions:u},er.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(A.Be,E.e.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==X.t.webPageLibrary}return{isAvailable:a}}}});var nr=n(3529),rr=n(1044),ir=Object(ce.e)()(Object(Vt.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("8").then(n.bind(null,4303))];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),sr=Object(ce.t)(function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(m.e,r),o=!1;if(i&&(n=e.demandItemFacet(A.Qt,ye.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})))&&!n.isAnonymousGuestUser){var u=e.demandItemFacet(A.st,r);o=er.e.hasItemPermission({permissions:u},er.e.insertListItems)}var a=Object(ve.o)(function(e){return H.createElement(ir,Object(s.__assign)({},e,t,{pageContext:n}))});return H.createElement(me.e,Object(s.__assign)({isAvailable:o,onExecute:a},Object(pe.t)(e,{itemKey:r,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),or=Object(le.i)()(sr),ur=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n);return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){t=e(Object(Ve.e)({listFacets:A.Be},E.e.serialize(r.listKey))).listFacets;i=rr.e.serialize({listKey:{webAbsoluteUrl:r.listKey.webAbsoluteUrl,listFullUrl:r.listKey.listFullUrl},contentTypeId:r.contentTypeId});o=!!t&&t.openInClient;e(Object($e.e)({items:(u={},u[n]=Object(s.__assign)({},A.t.pack(function(){return H.createElement(or,{contentTypeId:r.contentTypeId,openInClient:o,contentTypeKey:i})})),u)}));return[2]})})}});var ar=n(293),fr=n(227),lr=n(2133),cr=n(193),hr=Object(o.i)()(function(e){var t=this,n=w.e.deserialize(e.itemKey),r=n.webAbsoluteUrl,i=n.listFullUrl;return function(n){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(s.__generator)(this,function(c){t=n(Object(Ve.e)({pageContext:A.Qt},ye.e.serialize({webAbsoluteUrl:r,listFullUrl:i}))).pageContext;o=n(Object(fr.n)({webAbsoluteUrl:r,listFullUrl:i})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(fr.e)({url:e}))};a=new lr.e({},{pageContext:t,getAuthToken:u});(f=new cr.e).resolveItems({items:(l={},l[e.itemKey]=Object(s.__assign)({},A.Zt.pack(a)),l)});n(f.execute())}return[2]})})}});var pr=n(3508),dr=n(3531),vr=n(909),mr=n(1842),gr=n(3530),yr=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,u,a,f,l,c,h,p,d,v,g,y,b,w,S,x,T;return Object(s.__generator)(this,function(N){r=e(Object(Ve.e)({deserializedItemKey:m.e,displayName:R.l},n)),i=r.deserializedItemKey,o=r.displayName;if(i&&o){u=e(Object(Ve.e)({contentTypeKeys:A.d},t)).contentTypeKeys;a=[];u&&u.length&&u.forEach(function(t){var n=e(Object(Ve.e)({contentType:A.Jt},t)).contentType;n&&a.push(n)});f=a.length?a[0].contentTypeId:void 0;l=o.replace(/\.[^.]+$/,"");if(!(c={contentTypeId:f,isUpload:!0,templateId:l,title:l,url:i.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((h=e(Object(Ve.e)({defaultView:A.b},t)).defaultView)&&h.viewKey){p=h.viewKey;d=e(Object(Ve.e)({existingTemplates:A.Ye},t)).existingTemplates,v=void 0===d?[]:d;(g=Object(s.__spreadArrays)(v)).length||(y=e(Object(Ve.e)({newCommands:gr.e},t)).newCommands)&&y.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;g.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});g.filter(function(e){return e.url===c.url}).length>0||g.push(Object(s.__assign)({},c));b=E.e.deserialize(t);w=vr.e.serialize({templateUrl:c.url,listKey:b});e(Object($e.e)({items:(S={},S[t]=Object(s.__assign)({},A.Ye.pack(g)),S[w]=Object(s.__assign)({},A.Ge.pack(c)),S)}));return[2,e(Object(mr.e)({items:(x={},x[k.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})]={views:(T={},T[p]={newDocumentTemplatesJsonString:JSON.stringify(g)},T),qosName:"saveNewTemplatesToDefaultView"},x)}))]}}return[2]})})}}),br=n(913),wr=n(2861),Er=n(425),Sr=n(1008),xr=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(A.$e,n,{suppressGetItems:!0}),i=e.demandItemFacet(Sr.e,n);return{isAvailable:!(e.demandItemFacet(Er.t,n)||!r&&!i)}}}});var Tr=Object(o.t)(function(){return function(e){e(Object(a.e)(m.e,br.e)(xr));e(Object(u.s)(m.e,wr.t)(Object(o.r)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("38").then(n.bind(null,4298))];case 1:return[2,e.sent().removeFromOneDriveOperationHandler]}})})})))}}),Nr=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r;return Object(s.__generator)(this,function(i){e(Object($e.e)({items:(r={},r[t]=Object(s.__assign)({},A.Ye.pack(n)),r)}));return[2]})})}}),Cr=n(888),kr=n(126),Lr=n(330),Ar=n(3072),Or=n(935),Mr=n(2344),_r=n(684),Dr=n(1216),Pr=n(38),Hr=n(662),Br=n(111),jr=n(720),Fr=n(1398),Ir=n(290),qr=n(74),Rr=n(31),Ur=n(3926),zr=n(140);function Wr(e,t){return{enableItemHoverCard:!1}}var Xr=Object(ce.e)(function(e,t){var n=$r(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied,o=n.qosEndPayload;return{customFormatterFeature:r&&e.demandItemFacet(kr.n,kr.t.serialize({})),viewFormatter:r,isGenerated:i,qosEndPayload:o,telemetry:Object(zr.n)(e).telemetry,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:Object(Mt.e)(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:Object(Dr.e)(e)}})(function(e){var t=H.useMemo(function(){var t=e.telemetry,n=e.qosEndPayload,r=function(){};if(0===e.selectionIndex){var i=new(t(qr.e))({name:"customItemTileRenderQoS"});n&&n.resultType===Rr.e.Failure?i.end(n):r=function(e){i&&i.end(e?{resultType:Rr.e.Failure,error:e.errorString,extraData:e.extraData}:{resultType:Rr.e.Success})}}return{customItemTileRenderQoSEnd:r}},[]).customItemTileRenderQoSEnd;Object(H.useEffect)(function(){if(d&&d.isTileFormatterAvailable()&&0===w){document.querySelectorAll(".sp-card-defaultClickButton")&&t();g||y.isTileDesignerTemplateApplied?e.dispatch(Object(Lr.e)({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(Object(Lr.e)({name:"CustomFormatterTileLoad",isIntentional:!0}));d.hasFormatterReferences()&&e.dispatch(Object(Lr.e)({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var n=H.useState(!1),r=n[0],i=n[1],o=H.useState([]),u=o[0],a=o[1],f=H.useState(-1),l=f[0],c=f[1],h=e.defaultRender,p=e.customFormatterFeature,d=e.viewFormatter,v=e.isDefaultCardEnabled,m=e.cardDesignerFeatureEnabled,g=e.isGenerated,y=Object(s.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled","isGenerated"]);if(!h)return null;var b=p&&p.tileRenderer,w=y.selectionIndex,E=y.itemKey,S=y.itemSetKey,x=void 0===S?"":S;if(d&&d.isTileFormatterAvailable()&&b){var T=d.shouldHideSelectionInTiles(),N=d.getTileFormatter(),C=H.createElement(Ur.e,{qosEvent:t},H.createElement(h,Object(s.__assign)({},y,m?{href:void 0,invokeSelection:!1}:{},{className:Object(Pr.e)(y.className,"customTile_76f7b1c2"),itemName:null,itemActivity:null,foreground:null,isSelectable:!T,selection:T?void 0:y.selection,selectionIndex:T?-1:y.selectionIndex,background:H.createElement(Fr.e,{handleTabKey:Ir.t.all,direction:Ir.e.domOrder,tabIndex:r?0:-1,onKeyDown:function(e){if(e.which===Br.e.tab){var t=l+1;if(t<u.length&&u[t]){u[t].focus();c(t);e.stopPropagation();e.preventDefault()}}else c(-1)},className:"customTileFocusZone_76f7b1c2"},H.createElement(b,{rowIndex:w,itemKey:E,itemSetKey:x,formatter:N,qosEvent:t})),onFocus:function(e){i(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");a(t)},onBlur:function(e){i(!1);a([]);c(-1)}})));return v&&N?H.createElement(Or.e,{controlHandlers:Mr.e.pack(Wr)},C):C}return H.createElement(h,Object(s.__assign)({},y))}),Vr=new kn.e("generatedViewFormatter",function(e,t){var n,r=t.itemKey;if(e.isItemFacetResolved(A.Re,r)&&r){var i=Object(Ar.e)(e,{itemSetKey:r}),s=e.demandItemFacet(kr.n,kr.t.serialize({})),o=e.demandItemFacet(S.e,r);if(o&&i&&s){var u=e.demandItemFacet(A.Be,E.e.serialize(o)),a=Object(_r.t)(e,{mapping:{fieldData:A.re},itemSetKey:r}),f=Object(Mt.e)(e,{feature:{ODB:522}}),l=Object(Mt.e)(e,{feature:{ODB:1822}}),c=a.map(function(e){return e.fieldData}),h={};if(l){var p=e.demandItem({schema:Y.o},r).schema,d=p&&p.columnKeys;d&&f&&(h=Object(jr.e)(e,d))}var v=u&&u.templateType||X.n.invalidType,m=void 0;if(c&&c.length>0&&v===X.n.genericList){var g=Object.keys(h).length>0?{fieldFormatters:h}:void 0;n=void 0===(m=s.tileDesigner.createDefaultTileProps(c,g))?{resultType:Rr.e.Failure,error:"Error generating defaultTileProps",extraData:{fields:JSON.stringify(c)}}:{resultType:Rr.e.Success}}var y=Object(Cr.e)({formatter:void 0,fieldFormatters:h,generatedTileProps:m,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:l}});if(y)return{viewFormatter:y.viewFormatter,qosEndPayload:n}}}});function $r(e,t){var n,r=!1;if(!t)return{viewFormatter:void 0,isGenerated:r,isTileDesignerTemplateApplied:!1,qosEndPayload:n};var i=e.demandItemFacet(A.pn,Object(Ar.e)(e,{itemSetKey:t})),s=i&&i.viewFormatter,o=s&&s.getTileProps(),u=Boolean(s&&s.isTileDesignerTemplateApplied());u&&(s=e.demandItemFacet(Jr,t));if(!(o&&o.formatter&&o.formatter)&&Object(Dr.e)(e)){var a=e.demandItemFacet(Vr,t);s=a&&a.viewFormatter;n=a&&a.qosEndPayload;r=!0}return{viewFormatter:s,isGenerated:r,isTileDesignerTemplateApplied:u,qosEndPayload:n}}var Jr=new kn.e("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(A.pn,Object(Ar.e)(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){for(var s=Object(_r.t)(e,{mapping:{fieldData:A.re},itemSetKey:n}),o=[],u={},a=0;a<s.length;a++){var f=s[a],l=f.fieldData?f.fieldData.RealFieldName:"";if(l){o.push(f.fieldData);u[l]=f.fieldData}}var c=i&&i.getTileFormatterDesignerConfig(),h=e.demandItemFacet(kr.n,kr.t.serialize({})),p=e.demandItemFacet(S.e,n),d=p&&e.demandItemFacet(A.Be,E.e.serialize(p)),v=d&&d.templateType||X.n.invalidType,m=Object(Mt.e)(e,{feature:{ODB:522}}),g=Object(Mt.e)(e,{feature:{ODB:1822}});if(h){var y=h.tileDesigner,b=y.encodeTileDesignerConfig,w=y.decodeTileDesignerConfig,x=y.createJSONFromConfig,T=y.shouldExcludeColumnInCards,N=y.encodeTileDesignerConfigForDocLib,C=c&&w(c),k=[],L={};if(m){var O=e.demandItem({schema:Y.o},n).schema,M=O&&O.columnKeys;M&&(L=Object(jr.e)(e,M))}if(C){var _=!1;for(a=0;a<C.columns.length;a++){var D=C.columns[a],P=void 0;switch(D.id){case"LinkTitle":P="Title";break;case"LinkFilename":P="FileLeafRef";break;default:P=D.id}T(u[P],P)?_=!0:k.push(D)}C.columns=k;var H=v===X.n.documentLibrary?N(C,!0):b(C);if(_||m){var B=x(o,H,Object.keys(L).length>0?{fieldFormatters:L}:void 0,v),j=Object(Cr.e)({formatter:JSON.stringify({tileProps:B}),fieldFormatters:L,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:g}});return j&&j.viewFormatter}}}}return i});function Kr(e){return function(){return Object(s.__assign)(Object(s.__assign)({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}var Qr=n(1217),Gr=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey;if(n)return(function(e,t){var n=$r(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=Object(Hr.t)(e)?Object(Hr.e)(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:Kr(i)}:{};var s=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),o=s.height,u=s.width,a=s.disableMarqueeSelection,f=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:Xr,grid:{minRowHeight:o,mode:f},className:"sp-gallery-listContainer",disableMarqueeSelection:a,tileControlHandler:function(){return{desiredSize:{width:u,height:o}}},groupControlHandler:Kr(i)}})(e,n);var r=Object(Dt.e)(e,{enableMediaTilesInDocumentGroup:A.I}).enableMediaTilesInDocumentGroup;return void 0===r||r?{tileControlHandler:Qr.e}:{}}}});var Yr=n(992),Zr=n(872),ei=n(27),ti=n(1203),ni=n(3748),ri=n(22),ii=n(467),si=n(3028),oi=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=Object(Dt.e)(e,{graphTokenProvider:si.e,spRestTokenProvider:A.nn,logger:wn.o}),i=r.graphTokenProvider,o=r.spRestTokenProvider,u=r.logger,a=Object(Pt.e)(e,n),f=a&&(a.env2||a.env),l=u&&u.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,r=e.sharingInformation,u=e.onError,a=n.defaultRecipients,c=n.itemName,h=n.locale,p=n.mode,d=n.openManageAccess,v=n.theme,m=n.getClientId,g=r.authToken,y=r.isListSharing,b=r.listId,w=r.serverRelativeItemUrl,E=r.shareItemKey,S=r.webAbsoluteUrl,x=m(),T={authToken:g||"",clientId:x,defaultRecipients:a,itemName:c,mode:Number(p),theme:v||Object(ri._)(),webAbsoluteUrl:S||""},N={};if(E&&ti.e.matches(E)){var C=ti.e.deserialize(E);N={listId:C.listId,uniqueId:C.uniqueId,webAbsoluteUrl:C.webAbsoluteUrl}}else{var k=""+new ii.e(S).authority+w;y&&x===wn.e[wn.e.listsHome]&&(l="list");N={isListSharing:y,itemUrl:k,listId:b,scenarioId:l}}new ni.e({element:t,environment:f||ei.e.prod,locale:h,context:Object(s.__assign)(Object(s.__assign)({},T),N),options:{onError:u,openManageAccess:d,graphTokenProvider:i,spRestTokenProvider:o}}).initializeUI()}}}}});var ui=n(1014),ai=n(3533),fi=n(63),li=n(3519),ci=Object(V.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(m.e,r),s=i&&ye.e.serialize(i),o=t.demandItemFacet(A.Qt,s),u=t.demandItemFacet(A.fn,r),a=t.demandItemFacet(R.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(R.h,r);return{checkInAction:H.createElement(li.e,{checkInOutType:"checkIn"}),undoCheckOutAction:H.createElement(li.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(fr.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new fi.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var hi=n(915),pi=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.signalData,r=t.itemKey;if(n&&r&&n.key===hi.t.key){var i=e.demandItemFacet(A.Qe,r),o=e.demandItemFacet(m.e,r),u=o&&ye.e.serialize(o),a=e.demandItemFacet(A.Qt,u);if(!i||!a||a.listBaseTemplate!==X.n.webPageLibrary)return{};var f=a&&Object(se.t)(a);if(!(!!f&&f.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight"))){var l=e.demandItemFacet(A.un,r),c=e.demandItemFacet(A.Ve,r),h=Object(be.t)(e,r),p=!!f&&f.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),d=Z.e.publishNowAction,v=0,g=hi.t.signal,y=Z.e.pageNeedsRepublishing;if(c)d=Z.e.submitNowAction;else if(!p&&h){d=Z.e.scheduleAction;v=1;g=hi.e.signal;y=Z.e.pageNeedsScheduling}else if(l){var b=Math.floor(Number(l)/512);d=0===b?Z.e.publishNowAction:Z.e.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?H.createElement(ve.n,{action:H.createElement(Se,{itemKeys:[r],publishType:v,source:"FileCard"})},function(n){var r=n.isAvailable,i=n.execute,o=r?function(){i()}:void 0,u=Object(s.__assign)(Object(s.__assign)({},e),{actionName:d,action:o,content:y,signal:g});return t(u)}):null}}}return{}}return{}}}});var di=n(749),vi=n(963),mi=n(538),gi=n(53),yi=n(67),bi={key:new B.e("manageAccess").id,automationId:"manageAccessCommand",name:gi.e.ManageAccess,title:gi.e.ManageAccessCommandTooltipV3,action:H.createElement(yi.t,null,H.createElement(mi.t,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(s.__assign)({},Tt.r.pack(!0))},wi=!se.e.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),Ei=Object(V.t)()(function(){return function(e){return xi}});var Si=[vi.e,ot.n,ot.t,bi];function xi(e,t){var n=Ti(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===vi.e.key?ln(t,wi):e})})(Si,n)}}function Ti(e,t){var n,r=e.demandItemFacet(Er.t,t);if(r){var i=new ue.e(r.tenantRootUrl).authority+"/_api/v2.0",s=vn.t.serialize({endpoint:i});n=Object(Ct.e)(e,{itemKey:s})}return n}var Ni=!se.e.isActivated("658D384B-C862-48CC-986B-F1CD32B00BFE","7/5/2019","Show file handler commands before OOB commands"),Ci=[vi.e,ot.n,ot.t],ki=Object(V.t)()(function(){return function(e){return Li}});function Li(e,t){var n=Ti(e,t.itemKey);return{commands:xn(Ci,n,!0,Ni,!1)}}var Ai=n(529),Oi=n(2960),Mi=n(865),_i=Object(V.t)()(function(){return function(e){return Pi}});var Di=[Ai.e,Oi.e,Mi.e];function Pi(e,t){return{columns:Di}}var Hi=n(423),Bi=n(372),ji=n(524),Fi=n(3929),Ii=n(822),qi=n(249),Ri=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=Er.t.deserialize(n).tenantRootUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f;return Object(s.__generator)(this,function(l){switch(l.label){case 0:t=Object(Ii.n)({webAbsoluteUrl:r}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(fr.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 1:if(!((i=l.sent())&&i.d&&i.d.mySite))throw new Bi.e({facets:Object(s.__assign)({},qi.h.pack({}))});o=i.d.mySite.replace(/\/$/,"");u=ji.t.serialize({webAbsoluteUrl:o||r});(a=new cr.e).resolveItems({items:(f={},f[n]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},Y.t.pack({itemKey:u})),R.l.pack(Fi.e.sharedByYou)),R.d.pack({})),f)});e(a.execute());return[2]}})})}});var Ui=n(4262),zi=n(247),Wi=n(287),Xi=n(184),Vi=n(3507),$i=n(1170),Ji=n(1180),Ki=n(294),Qi=n(694),Gi=n(488),Yi=n(526),Zi=n(431),es=n(145),ts=n(200);function ns(e,t){var n=[];e.d.results.forEach(function(e){var r,i,o,u,a=""+new ue.e(e.SiteUrl).authority+e.UrlPath,f=e.LinkingUrl?e.LinkingUrl:a,l=$i.e.serialize({itemFullUrl:a});n.push(l);var c=Object(Ui.t)(e.Modified),h=(function(e){var t=Object(Vi.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:$i.e.serialize(n)}})(a),p=h.parentItemKey,d=h.parentItemUrl;t.mapKeys({mappings:(r={},r[$i.e.serialize({itemFullUrl:d})]=p,r)});var v=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=Ki.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),m=e.SpItemUrl?Object(Gi.e)(e.SpItemUrl):void 0;if(m)for(var g=0,y=Object(Gi.t)(m);g<y.length;g++){var b=y[g];t.mapKeys({mappings:(i={},i[b]=l,i)})}var w=e.Editor,E=Ji.e.serialize({id:w.email}),S={itemKey:E,displayValue:w.name};t.resolveItems({items:(o={},o[E]=Object(s.__assign)(Object(s.__assign)({},R.l.pack(w.name)),Wi.e.pack(w.email)),o)});t.resolveItems({items:(u={},u[l]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},R.l.pack(e.FileLeafRef)),R.E.pack(!0)),R.h.pack({name:e.FileLeafRef,extension:e.Extension})),Xi.e.pack(v.fileIconType)),R.a.pack(c.getTime())),R.i.pack(a)),R.A.pack({itemKey:p})),R.k.pack(S)),Xi.i.pack(v.isOneNote?{}:void 0)),R.d.pack(v.isFolder?{}:void 0)),R.L.pack(f)),es.e.pack(m)),A.Ie.pack(e.ListItemId.toString())),e.UniqueId?A.fn.pack(Object(ts.normalizeLower)(e.UniqueId,!1)):{}),e.ListId?A.Fe.pack(Object(ts.normalizeLower)(e.ListId,!1)):{}),m?Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},R.n.pack({itemKey:Yi.e.serialize({driveItemKey:m})})),R.v.pack({itemKey:Zi.e.serialize({driveItemKey:m})})),R.e.pack({itemKey:Qi.e.serialize({driveItemKey:m})})):{}),Object(zi.e)().forFacet(R.l).thenInvalidate(l,Y.e).pack()),u[p]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},R.d.pack({})),R.i.pack(d)),R.L.pack(d)),u)})});return n}var rs=n(1337),is=n(218),ss=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=ji.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h;return Object(s.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(Ii.r)({webAbsoluteUrl:r,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});i=t.toString();return[4,e(Object(fr.t)({url:i,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:r}))];case 1:o=p.sent();u=new cr.e;a=ns(o,u);f=""+new ue.e(r).authority;l=Er.t.serialize({tenantRootUrl:f});if(o.d.__next){c=rs.e.serialize({itemSet:ji.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(is.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(s.__assign)(Object(s.__assign)({},Y.e.pack({itemKeys:a})),Y.s.pack({itemKey:l})),h[l]=Object(s.__assign)({},Object(zi.e)().forFacet(Y.t).thenInvalidate(n,Y.e).pack()),h)});e(u.execute());return[2]}})})}});var os=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=rs.e.deserialize(n).after,i=rs.e.deserialize(n).itemSet;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return[4,e(Object(fr.t)({url:r,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i.webAbsoluteUrl}))];case 1:t=s.sent();o=ji.t.serialize(i);u=new cr.e;a=ns(t,u);if(t.d.__next){f=rs.e.serialize({itemSet:i,after:t.d.__next});a.push(f);u.merge(Object(is.t)({itemKey:f}).itemResolver)}u.merge(Object(is.e)({itemKey:n,itemSetKey:o,childItemKeys:a}).itemResolver);e(u.execute());return[2]}})})}});var us=n(3775),as=n(753),fs=n(1208),ls=n(685),cs=n(1104),hs=n(147),ps=Object(V.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,r=Object(Dt.e)(e,{enableItemActivityField:A.P}).enableItemActivityField,i=e.demandItemFacet(A.le,n),o=r&&Object(hs.r)(e,H.createElement(cs.e,{itemKey:n,isCompact:!0,hideDate:!0}))||i&&H.createElement(ls.e,{text:i}),u=e.demandItemFacet(A.$e,n);return Object(s.__assign)(Object(s.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return u?{folderCoverAs:ds}:{}}})})(e,t)}}});function ds(e){var t=e.defaultRender,n=Object(s.__rest)(e,["defaultRender"]);return t?H.createElement(t,Object(s.__assign)({},n,{folderCoverType:"linked"})):null}var vs=n(1238),ms=n(991),gs=n(2622),ys=n(1096),bs=n(2784),ws=n(382),Es=n(162),Ss=n(673);function xs(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var r=t[".transformUrl"],i=n[".hasThumbnail"],o=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},t),n),{".method":"thumbnail"});if("True"===i&&r)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(Ss.n)(r,o)+"&"+Object(Es.e)(n)}}}var Ts=Object(o.i)({maxParallelOperationCount:16})(function(e){var t=this,n=ys.e.deserialize(e.itemKey).itemKey;return function(r){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){switch(a.label){case 0:return[4,r(Object(bs.e)(function(e){var t=e.demandItemFacet(m.e,n),r=t&&E.e.serialize(t);return{generator:xs({listMediaTransformSchema:e.demandItemFacet(ws.t,r),itemMediaTransformSchema:e.demandItemFacet(ws.e,n)})}}))];case 1:t=a.sent().generator;(i=new cr.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(s.__assign)({},ws.n.pack(t)),u)})[n]=Object(s.__assign)({},Object(zi.e)().forFacet(ws.e).thenInvalidate(e.itemKey,ws.n).pack()),o));r(i.execute());return[2]}})})}});var Ns=Object(o.t)(function(){return function(e){e(Object(u.s)(ys.e,ar.e)(Ts));e(Object(a.e)(m.e,ms.e)(gs.t))}}),Cs=Object(o.t)(function(){return function(e){e(Object(a.e)(m.e,Mr.e)(ps));e(Ns);e(vs.e)}}),ks=n(3534),Ls=Object(V.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(m.e,n)}}}});var As=n(633),Os=n(1211),Ms=n(3495),_s=n(447),Ds=n(630),Ps=n(726),Hs=n(3930),Bs=n(969),js=n(32),Fs=n(105),Is=Object(V.t)()(function(){return function(e){return function(e,t){return{errorRenderer:qs}}}});var qs=Object(ce.t)(function(e,t){var n=t.defaultRender,r=(t.itemKey,t.title,Object(s.__rest)(t,["defaultRender","itemKey","title"])),i=r.error;if(i instanceof Fs.e&&i.extraData&&404===i.extraData.status){var o=Object(et.e)(e).itemsScopeItemKey,u=e.demandItemFacet(js.n,o),a=e.demandItemFacet(Ds.e,u&&u.itemKey),f=a&&m.e.serialize(a.mountPointItem),l=void 0,c=Hs.e.mountPointNotFoundDefaultErrorMessage;if(f){var h=e.demandItemFacet(R.l,f);h&&(c=J.format(Hs.e.mountPointNotFoundErrorMessage,h));l=H.createElement("div",null,H.createElement(ve.n,{action:H.createElement(Ps.e,{itemKeys:[f]})},function(e){var t=e.execute;return H.createElement(Bs.e,{onClick:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},Hs.e.removeThisShortcut)}))}return H.createElement(H.Fragment,null,n?H.createElement(n,Object(s.__assign)({key:"error"},r,{title:Hs.e.mountPointNotFoundErrorTitle,subText:c,actions:l})):null)}return n?H.createElement(n,Object(s.__assign)({},t)):null}),Rs=n(1090),Us={key:Ji.e,displayName:R.l,email:Wi.e},zs=Object(o.i)()(function(e){var t=e.itemKey,n=Rs.e.deserialize(t);return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,u,a,f,l,c,h;return Object(s.__generator)(this,function(p){switch(p.label){case 0:r=n.siteUrl||"";i=n.listId||"";o=n.uniqueId||"";u=r+"/_api/web/Lists('"+i+"')/GetPlacesInformation('"+o+"')?$expand=places";p.label=1;case 1:p.trys.push([1,3,,4]);return[4,e(Object(Wt.n)({url:u,qosName:"GetPlacesInformation",method:"GET",endpoint:r}))];case 2:a=p.sent();f=new cr.e;l=[];(c=a&&a.places)&&c.forEach(function(e){var t,n=e.userEntity.email,r=Ji.e.serialize({id:String(n)});f.resolveItems({items:(t={},t[r]=Object(B.n)(Us,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});l.push(r)});f.resolveItems({items:(h={},h[t]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},A.ft.pack({locationKeys:l})),A._e.pack(a.itemSourcePath)),R.l.pack(a.itemSourceSiteTitle)),h)});e(f.execute());return[3,4];case 3:throw p.sent();case 4:return[2]}})})}});n.d(t,"SpAddonDeferred",function(){return Ws});n.d(t,"spProjectedUploadedItemSetAddon",function(){return Ms.spProjectedUploadedItemSetAddon});var Ws=Object(o.t)(function(){return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(t){e(Tr);e(di.e);e(as.e);e(C.spDataOnlyAddonDeferred);if(e(Object(bn.e)({enablePltCommands:A.W})).enablePltCommands)e(Object(a.e)(m.e,fs.e)(an));else{e(Object(a.e)(m.e,p.e)(fn));e(Object(a.e)(m.e,As.e)(Os.e))}e(Object(a.e)(m.e,d.e)(Sn));e(Object(a.e)(g.e,h.e)(Nn));e(Object(a.e)(m.e,c)(Pn));e(Object(a.e)(g.e,v.e)(Yn));e(Object(a.e)(m.e,v.e)(Zn));e(Object(a.e)(g.e,f.e)(tr));e(Cs);e(Object(u.s)(y.e,ar.e)(nr.e));e(Object(u.s)(b.e,ar.e)(ur));e(Object(u.s)(w.e,ar.e)(hr));e(Object(u.s)(E.e,pr.t)(yr));e(Object(u.s)(E.e,dr.t)(Nr));e(Object(a.e)(S.e,Yr.e)(Gr));e(Object(a.e)(m.e,Zr.e)(oi));e(Object(a.e)(m.e,ui.e)(ci));e(Object(a.e)(Er.t,p.e)(Ei));e(Object(a.e)(ji.t,Hi.e)(_i));e(Object(a.e)(Er.t,d.e)(ki));e(Object(u.s)(Er.t,ar.e)(Ri));e(Object(u.s)(ji.t,ar.e)(ss));e(Object(u.s)(rs.e,ar.e)(os));e(Object(u.s)(Rs.e,ar.e)(zs));e(Object(a.e)(x.e,h.e)(On));e(Object(a.e)(m.e,ai.e)(pi));e(Object(u.s)(T.e,ar.e)(us.t));e(Object(a.e)(N.e,_s.e)(Is));e(Object(a.e)(m.e,ks.e)(Ls));return[2]})})}})}],Array(14),[function(e,t,n){"use strict";n.r(t);var r,i=n(16),s=n(138),o=n(381),u=n(967),a=n(280),f=n(11),l=n(963),c=n(415),h=n(2),p=n("react-lib"),d=n(337),v=n(747),m={action:p.createElement(v.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:d.e.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new h.e("AddShortcutFromSharedWithMe").id,name:d.e.AddShortcutFromSharedWithMe},g=n(67),y=n(726),b={action:p.createElement(g.t,null,p.createElement(y.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:d.e.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new h.e("RemoveShortcutFromSWM").id,name:d.e.RemoveShortcutFromSWM},w=n(0),E=n(186),S=n(195),x=n(1985),T=n(133),N=n(2866),C=n(5),k=n(40),L=n(65),A=n(127),O=n(21),M=n(28),_=n(14),D=n(3534),P=n(43),H=n(350),B=n(71),j=Object(k.t)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?N.t:i,o=Object(L.e)(e)||"",u=e.demandItemFacet(H.e,o);if(0===n.length)return null;for(var a=u&&n.length<=200,f=r,l=0,c=n;l<c.length;l++){var h=c[l],d=e.demandItemFacet(D.e,h),v=!B.e.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");D.e.evaluate(d)(e,{itemKey:h,isAvailable:v}).isAvailable||(a=!1)}var m=e.dispatch,g=function(){return Object(w.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(w.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(A.e)(n,function(){return e});return[4,m(s({items:t}))];case 1:r.sent();return[2]}})})},y=Object(O.o)(function(e){return p.createElement(f,Object(w.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return p.createElement(M.e,Object(w.__assign)({isAvailable:a,onExecute:y},Object(P.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),F=Object(_.s)()(j),I=n(4031),q=n(3648),R=n(20),U=n(82),z=n(598),W=((r={})[U.r.started]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.e.removeStartedItemsTitle,q.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[U.r.completed]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.e.removeCompletedItemsTitle,q.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[U.r.failed]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.e.removeFailedItemsTitle,q.e.removeFailedItemsTitleIntervals,e)||"",e)},r[U.r.canceled]=function(e){return Object(R.formatToArray)(Object(R.getLocalizedCountValue)(q.e.removeFailedItemsTitle,q.e.removeFailedItemsTitleIntervals,e)||"",e)},r),X=Object(i.t)(function(){return function(e){e(Object(a.e)(N.e,z.e)(Object(f.t)()(V)))}});function V(){return function(e){return $}}function $(e,t){var n,r=Object(T.i)(e,t),i=r.phase,s=r.count;n=W[i](s);return Object(w.__assign)({},n&&"item"!==t.format?{title:n}:{})}var J=(function(e){Object(w.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(w.__awaiter)(e,void 0,void 0,function(){return Object(w.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(w.__awaiter)(e,void 0,void 0,function(){return Object(w.__generator)(this,function(e){r(new E.e);return[2]})})};return p.createElement(S.e,null,function(e){var t=e.itemCache,n=K(t,s),r=n.title,i=n.prompt;return p.createElement(x.e,{onCancel:u,onConfirm:o,yesText:q.e.removeFromSharedListConfirmButtonText,noText:I.e.removeFromSharedListCancelButtonText,defaultToYes:!0,title:r,prompt:i})})};return t})(p.PureComponent),K=function(e,t){if(t.length>1)return{title:I.e.itemsTitleWithAccess,prompt:I.e.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(C.d,t[0]);return{title:n?I.e.folderTitleWithAccess:I.e.fileTitleWithAccess,prompt:n?I.e.folderSubTextWithAccess:I.e.fileSubTextWithAccess}}return{title:"",prompt:""}},Q=Object(T.s)({operationTypeFacet:N.n,progressKeyFacet:N.e,initializeBatch:function(){return X}});var G=Object(k.e)(function(){return{removeFromSharedListWizard:J,removeItemsFromSharedList:Q}})(F),Y={key:new h.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:d.e.removeFromSharedList,title:d.e.removeFromSharedListTooltip,action:p.createElement(g.t,null,p.createElement(G,null)),iconProps:{iconName:"Cancel"}},Z=Object(f.t)()(function(){return function(e){return te}});var ee=[l.e,c.n,c.t,m,b,Y];function te(e,t){return{commands:ee}}var ne=n(4132),re=n(688),ie=Object(f.t)()(function(){return function(e){return oe}});var se=[l.e,c.n,c.t,m,b,Y];function oe(e,t){return{commands:se}}var ue,ae=n(292),fe=n(288),le=n(256),ce=((ue={})[le.t]=!0,ue[le.r]=!0,ue[fe.i]=!0,ue[fe.e]=!0,ue[fe.r]=!0,ue),he=Object(f.t)()(function(){return function(e){return pe}});function pe(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!ce[i])return{};var o=e.demandItemFacet(H.e,n);if(!o)return{};var u=fe.t[i];return u?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var de,ve=n(422),me=n(455),ge=n(3506),ye=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(H.e,n),i=r&&r.driveItemKey.endpoint,s=i&&Object(ge.e)(e,{parentItemKey:re.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(w.__assign)({},s?{stageItem:s}:{})}}});var be=((de={})[fe.i]=!0,de[fe.e]=!0,de),we=Object(f.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!be[r])return{};var i=e.demandItemFacet(H.e,n);if(!i)return{};var s=fe.t[r];return s?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},i),{groupBy:s}))}:{}}var Se=Object(f.t)()(function(){return function(e){return xe}});function xe(e,t){var n=t.itemSetKey,r=e.demandItemFacet(H.e,n);return r?{newItemSetKey:H.e.serialize(Object(w.__assign)(Object(w.__assign)({},r),{groupBy:void 0}))}:{}}var Te=n(3504),Ne=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ce=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var ke=n(136),Le=n(3052),Ae=n(293),Oe=n(193),Me=n(194),_e=n(120),De=n(1674),Pe=n(4),He=new Pe.e("topCollaboratorItemKeyFacet",{id:Object(Pe.s)()}),Be=n(175),je=n(287),Fe=n(9),Ie=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(w.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;return Object(w.__generator)(this,function(b){switch(b.label){case 0:t=new Oe.e;i=r(Object(Me.e)({graphEndpoint:_e.l})).graphEndpoint;s=Le.e.deserialize(n);o=i||s.endpoint;u=o+"/me/people/";return[4,r(Object(De.n)({url:u,qosName:"getTopCollaborator",endpoint:o}))];case 1:a=b.sent();f=[];for(l=0,c=a.value;l<c.length;l++){h=c[l];p=h.id,d=h.displayName,v=h.userPrincipalName;m=He.serialize({id:p});r(Object(Be.e)({items:(g={},g[m]=Object(w.__assign)(Object(w.__assign)({},C.l.pack(d)),je.e.pack(v)),g)}));f.push(m)}t.resolveItems({items:(y={},y[e.itemKey]=Object(w.__assign)({},Fe.e.pack({itemKeys:f})),y)});r(t.execute());return[2]}})})}});n.d(t,"graphAddonDeferred",function(){return qe});var qe=Object(i.t)(function(){return function(e){e(Object(ke.e)(function(){e(ne.graphAddonDataOnlyDeferred);e(Object(a.e)(re.e,o.e)(ie));e(Object(a.e)(re.e,u.e)(Z));e(Object(a.e)(H.e,ae.e)(he));e(Object(a.e)(H.e,ve.e)(ye));e(Object(a.e)(H.e,me.e)(we));e(Object(a.e)(H.e,me.t)(Se));e(Object(a.e)(Te.n,ve.e)(Ne));e(Object(a.e)(Te.t,ve.e)(Ce));e(Object(s.s)(Le.e,Ae.e)(Ie))}))}})}],Array(14),[function(e,t,n){"use strict";n.r(t);var r,i=n(16),s=n(280),o=n(83),u=n(3479),a=n(0),f=n("react-lib"),l=n(420),c=n(11),h=n(37),p=n(9),d=n(5),v=n(193),m=n(161),g=n(107),y=n(1088),b=n(3541),w=n(1856),E=n(74),S=n(31);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var x={ODB:819,ODC:"EnablePushChannelLogging"},T={ODB:459},N=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",b.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:b.t.EventHub},function(){t._log("PushChannelMessageSource",b.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(y.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:i.sent();return[3,4];case 3:t=i.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];n=!1;if(Object(w.s)(t))switch(t.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return r._onPushChannelConnection(r._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(T)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new E.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:S.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];e=new v.e;return[4,this._getChangeMessages()];case 1:t=a.sent();this._log("Change messages",t);n=this._processMessages(t.messages);this._log("Changes",n);e.merge(t.itemResolver);for(i=0,s=n;i<s.length;i++)switch((o=s[i]).type){case r.New:e.invalidateItems({items:(f={},f[o.invalidateKey]=[p.t],f)});break;case r.Update:o.hasSelection&&this._itemScopeItemKey?this._updateItems(o.invalidateKey):e.invalidateItems({items:(l={},l[o.invalidateKey]=[o.invalidateFacet],l)});break;case r.Delete:e.invalidateItems({items:(c={},c[o.invalidateKey]=[d.f],c)})}this._dispatch(e.execute());return[3,3];case 2:u=a.sent();this._log("onNotification error",u);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(x)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),C=n(1674),k=n(2347),L=n(120),A=n(3935),O=n(3934),M=n(13),_=n(71),D=n(382),P=n(57),H=n(1),B=n(64),j=n(345),F=n(106),I=n(227),q=n(117),R=n(123),U=n(194),z=n(145),W=n(488),X=n(595),V=n(1170),$=n(105),J=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(R.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ue,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,A,O,M,P,J,K,Q,G,Y,Z,ee=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";i=n.endpoint+"/drives/"+n.driveId;s=e(Object(U.e)({isTAB:L.v})).isTAB;o=e(Object(R.e)(function(e){var t=e.demandItemFacet(B.e,ee._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(H.Qt,j.e.serialize(t))}})),u=o.spItem,f=o.pageContext;l=new v.e;if("latest"===t&&u){c=F.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl});h=e(Object(R.e)(function(e){return e.demandItemFacet(H.Be,c)}));if(p=null===(r=h)||void 0===r?void 0:r.tick){d=p-621355968e9;d/=1e4;return[2,{syncToken:""+new Date(d).toISOString(),messages:[],itemResolver:l}]}}if(!f||!Object(_.t)(f).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];m=e(Object(R.e)(function(e){var t=u&&F.e.serialize(u),n=e.demandItemFacet(D.t,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(Object(I.e)({url:i,disallowCookies:!0}))];case 2:m=a.sent();a.label=3;case 3:return[3,7];case 4:return(y=n.endpoint)?[4,e(Object(k.t)(n.endpoint,i))]:[3,6];case 5:y=a.sent();a.label=6;case 6:m=(g=y)&&g.accessToken;a.label=7;case 7:if(void 0===m)throw new $.e({code:"authFailure"});this._pendingRequest=!0;b=f&&Object(_.t)(f).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):i+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:b,accessToken:{accessToken:m,tokenUrl:i},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions",ScenarioType:"BGO"}})];case 8:w=a.sent();E=[];if(w&&w.value)for(S=0,x=w.value;S<x.length;S++){T=x[S];N=void 0;C={endpoint:n.endpoint,driveId:n.driveId,itemId:T.id};if(T.root){J=Object(W.t)(C);for(A=0,O=J;A<O.length;A++){G=O[A];l.mapKeys({mappings:(Y={},Y[G]=this._rootItemKey,Y)})}}else if(T.webUrl&&(M=Object(X.n)(T.webUrl))){P=V.e.serialize({itemFullUrl:M});if(e(Object(q.e)({spItemKey:B.e},P)).spItemKey){J=Object(W.t)(C);for(K=0,Q=J;K<Q.length;K++){G=Q[K];l.mapKeys({mappings:(Z={},Z[G]=P,Z)})}}}if(!T.root){T.parentReference&&(N=T.parentReference.id);E.push({itemKey:z.e.serialize(C),parentItemKey:N&&z.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:N}),isDeleted:!!T.deleted,isShared:!!T.shared,name:T.name,dateModified:T.lastModifiedDateTime,eTag:T.eTag})}}this._pendingRequest=!1;return[2,{syncToken:w["@delta.token"],messages:E,itemResolver:l}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(q.e)({deleted:d.f},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(q.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.l},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.l,reason:"Name changed from "+u+" to "+t.name}};return e})(),K=n(468),Q=n(29),G=n(39),Y=n(1764),Z=n(77),ee=n(55),te=n(822),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){ee.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(U.e)({isTest:L.v})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=Z.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,Y.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:G.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:G.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(306),se=n(46),oe=n(197),ue=n(274),ae=n(204),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ue,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,j,I,q,U=this;return Object(a.__generator)(this,function(z){switch(z.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});i=e(Object(R.e)(function(e){return e.demandItemFacet(H.Be,n)}));if(s=null===(r=i)||void 0===r?void 0:r.lastItemModifiedTime){o=new v.e;return[2,{syncToken:"SPO_LIST,"+s,messages:[],itemResolver:o}]}}this._pendingRequest=!0;if(l=!!t&&"SPO_LIST,"===t.substr(0,9)){c=t.split(",");h=c[1];p='<Gt><FieldRef Name="Modified" />';p+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+h+"</Value>";u=p+="</Gt>";f=["ID","FileRef","Modified","Title"];d=this._getListColumns(e);for(m=0,g=d;m<g.length;m++)"ID"!==(y=g[m]).internalName&&"FileRef"!==y.internalName&&"Modified"!==y.internalName&&"Title"!==y.internalName&&f.push(y.internalName)}else f=["ID","FileRef","Modified"];"ID";b=l;w=l?200:1;E=new K.e("<View></View>");u&&E.addFilters([u]);f&&E.replaceFields(f);E.updateSort({fieldName:"ID",isAscending:b});E.updateRowLimit({rowLimit:w,isPerPage:!1});S=e(Object(R.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:U._webAbsoluteUrl,listFullUrl:U._listFullUrl}))}));this._requestDatesInUtc=!S||Object(_.t)(S).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(Object(ie.e)({getItemContext:{webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:E.getEffectiveViewXml(),isBackground:!0,postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:S}}))];case 1:x=z.sent();this._serverResponse=x;T=x.ListData;N=T&&T.Row||[];C=[];k=l?this._getLastModifiedTimeInList(N,S):(new Date).toISOString();for(L=0,A=N;L<A.length;L++)if(void 0!==(O=A[L]).FileRef){M={};D=Object.keys(O);for(P=0,j=D;P<j.length;P++){I=j[P];q=0===I.indexOf("OData_")?I.substr(6):I;M[q]=O[I]}C.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:O.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:O.Title||""},O.Modified?{dateModified:""+O.Modified}:{}),{fields:M}))}0===C.length&&C.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+k,messages:C,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(R.e)(function(e){return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.bt,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.on,t.itemKey),selectedItemKeys:Object(oe.e)(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(q.e)({deleted:d.f},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(q.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.on,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.bt,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(q.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(q.e)({internalName:H.Ee,fieldType:H.ue,mappedFieldType:H.ze},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==Q.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(514),ce=n(191),he=n(61),pe=n(4),de=n(213),ve=n(302),me=n(154),ge=n(1936),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(a.__generator)(this,function(s){switch(s.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabled(i)];case 1:if(s.sent()){this._notificationId=t.addListStatusCallback(this._onNotification.bind(this),i,{sendConnectionNotifications:!0});return[2,!0]}return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(681),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,y=void 0,b=!n||!Object(_.t)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(b||e.subscriptionService)){g=e.pushChannelService;y=e.subscriptionService}else{if(n&&!Object(_.t)(n).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var w=h(C.e).dataRequestor;y=new A.e({listId:r,webAbsoluteUrl:i},{dataRequestor:w})}else y=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new O.e({disableWebSockets:!0},{subscriptionService:y})}m=new fe({pushChannelService:g,subscriptionService:y,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new N({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveAccessToken,u=e.pageContext,f=e.driveUrl,c=e.endpoint,h=e.itemsScopeItemKey;return function(e){var p=e(xe),d=Se.serialize({itemsScopeItemKey:h,spPageContextKey:n}),v=p[d];if(!v){var m,g,y=e(C.e).dataRequestor;g=new J({dataRequestor:y,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});m=new O.e({disableWebSockets:!0},{subscriptionService:new A.e({},{dataRequestor:y}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!u||!Object(_.t)(u).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];t=o;return[3,3];case 1:return[4,e(Object(I.e)({url:f,disallowCookies:!0}))];case 2:t=i.sent();i.label=3;case 3:return[3,7];case 4:return(r=c)?[4,e(Object(k.t)(c,f))]:[3,6];case 5:r=i.sent();i.label=6;case 6:t=(n=r)&&n.accessToken;i.label=7;case 7:if(!t)throw new $.e({code:"authFailure"});return[2,{accessToken:t,tokenUrl:f}]}})})}});v=p[d]=new N({id:d,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:f,dispatch:e,itemsScopeItemKey:h,template:g,pushChannelService:m,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.Qt,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.i)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.Mt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Be,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,b=M.s(v.templateType);if(!g&&!b)return{};var w,E=Object(h.e)(e,{isTAB:L.v}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(y.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var A=x.driveId;return T&&A?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})}],Array(90),[function(e,t,n){"use strict";n.r(t);var r=n(16),i=n(280),s=n(83),o=n(629),u=n("react-lib"),a=n(1153),f=n(11),l=Object(f.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:u.createElement(a.e,null)}}}});var c=n(3542);n.d(t,"sharePointAddonQuickEdit",function(){return h});n.d(t,"QuickEditActionExecutor",function(){return c.QuickEditActionExecutor});var h=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,o.e)(l))}})}])]);