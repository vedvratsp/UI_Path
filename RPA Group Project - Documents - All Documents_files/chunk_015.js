(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[30],{FzFR:function(e,t,o){"use strict";o.d(t,"a",function(){return d});var i,a=o("17wl"),n=o("3HEj"),r=o("1tKF"),s=o("K9kD"),l=o("y88i");!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(i||(i={}));var u=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],d=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(a.__extends)(t,e),t.decodeAcronymColor=function(e){return u.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})},t.prototype.getAcronyms=function(e,t){var o=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var i=t.qosName,a=void 0===i?"GetSiteHeaderLogoAcronym":i;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+l.UriEncoding.encodeURIComponent('"'+e+'"')+"}"}).join(",");return Object(n.c)(o._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:a})}return s.Promise.reject(new Error("No web URL specified for request."))},t}(r.a);t.b=d},KarG:function(e,t,o){"use strict";o.r(t),o.d(t,"FOLLOWED_SITES_IN_STORE_KEY",function(){return k}),o.d(t,"SiteHeaderContainerStateManager",function(){return L});var i,a=o("17wl"),n=o("l9Kh"),r=o("2FRe"),s=o("iNGM"),l=o("Vlqv"),u=o("Y7TA"),d=o("K9kD"),c={ODB:1075},p=o("a4sQ"),h=o.n(p),m=o("3HEj"),g=o("FzFR"),f=o("NacN"),v=o("OpjN"),_=o("71k8"),b=o("y88i"),S=o("1tKF"),y={"SPHome-ClientType":"PagesWeb"},C=function(e){function t(t){var o=e.call(this,{dataSourceName:"FollowDataSource",id:"FavoriteFeed"},{pageContext:t})||this;return o._isSiteFollowedCacheKey="isSiteFollowed_"+(t.siteId+t.webId),o._doubleQuoteKillSwitchIsActivated=d.Killswitch.isActivated("83386358-6d38-48f2-94b4-b91c9c9b1d84","06/29/2020","Double quote for Follow post data"),o}return Object(a.__extends)(t,e),t.prototype.followSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(m.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/add",qosName:"FollowSite",additionalPostData:this._doubleQuoteKillSwitchIsActivated?"'"+e+"'":'"'+e+'"',additionalHeaders:y,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.unfollowSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(m.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/remove",qosName:"UnfollowSite",additionalPostData:this._doubleQuoteKillSwitchIsActivated?"'"+e+"'":'"'+e+'"',additionalHeaders:y,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.isSiteFollowed=function(e,t,o,i,n){void 0===t&&(t=!1),void 0===o&&(o=!1);var r=0;return o?r=3:t&&(r=2),i&&n?this.getDataUtilizingPersistentCache({url:Object(m.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/isFollowed?siteId="+i+"&webId="+n+"&url="+b.UriEncoding.encodeURIComponent(e),parseResponse:function(e){return"true"===e},qosName:"isSiteFollowed",telemetryHandler:function(e){var t=e.errorData,o=e.eventData;if(t){var i=!1;if(t.responseData&&t.responseData.ErrorCode){var n=t.responseData.ErrorCode;500007!==n&&500019!==n&&500020!==n&&500021!==n||(i=!0)}var r=i?d.ResultTypeEnum.ExpectedFailure:d.ResultTypeEnum.Failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},o),{resultType:r})}}return{eventData:o}},additionalHeaders:y,noRedirect:!0,method:"GET",cachingStrategy:r,cacheRequestKey:this._isSiteFollowedCacheKey}).catch(function(e){if(e&&e.responseData&&e.responseData.ErrorCode){var t=e.responseData.ErrorCode;if(500007===t||500019===t||500020===t||500021===t)return!1}throw e}):this.getDataUtilizingPersistentCache({url:Object(m.c)(this._pageContext)+"/_api/social.following/IsFollowed",parseResponse:function(e){return JSON.parse(e).d.IsFollowed},qosName:"isSiteFollowed",noRedirect:!0,method:"POST",additionalPostData:JSON.stringify({actor:{__metadata:{type:"SP.Social.SocialActorInfo"},ActorType:1,ContentUri:e,Id:null}}),cachingStrategy:r,cacheRequestKey:this._isSiteFollowedCacheKey})},t.prototype.isFollowFeatureEnabled=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/SP.Utilities.SPSocialSwitch.IsFollowingFeatureEnabled",cacheRequestKey:"followEnabled_"+(this._pageContext.webId+this._pageContext.siteId),method:"POST",noRedirect:!0,qosName:"isFollowFeatureEnabled",parseResponse:function(e){return JSON.parse(e).d.IsFollowingFeatureEnabled}})},t}(S.a),w=o("vyKV"),P=o("jidH"),x=o("ynV5"),O={ODB:1075},T={ODB:1120},E={ODB:1559},F={ODB:1067},A=[{name:"inboxUrl",eid:"Mail",trimIfAnonymous:!0},{name:"calendarUrl",eid:"Calendar",trimIfAnonymous:!0},{name:"filesUrl",eid:"Files",trimIfAnonymous:!1},{name:"notebookUrl",eid:"Notebook",trimIfAnonymous:!1},{name:"siteUrl",eid:"Home",trimIfAnonymous:!1},{name:"membersUrl",eid:"Members",trimIfAnonymous:!0},{name:"plannerUrl",eid:"Planner",trimIfAnonymous:!0}],k="FollowedSites";!function(e){e[e.quickLaunch=0]="quickLaunch",e[e.globalNav=1]="globalNav",e[e.none=2]="none"}(i||(i={}));var L=function(){function e(e){var t=this;this._openTeamsChannel=function(e){window.open(t._pageContext.webAbsoluteUrl+"/_layouts/15/GroupStatus.aspx?id="+t._pageContext.relatedGroupId+"&Target=TEAMSWEBAPP","_blank")},this._onGoToMembersClick=function(e){d.Engagement.logData({name:"SiteHeader.GoToMembers.Click"}),t._params.goToMembersOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onCreateSiteClick=function(e){d.Engagement.logData({name:"SiteHeader.CreateSite.Click"}),t._params.createSiteOnClick&&t._params.createSiteOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onUserExpirationDismissClick=function(e){d.Engagement.logData({name:"SiteHeader.UserExpirationMessageBarDismiss.Click"}),t.setState({hideUserExpirationBar:!0})},this._onFollowClick=function(e){d.Engagement.logData({name:"SiteHeader.Follow.Click"});var o=t._params.siteHeader.state.followState;t.setState({followState:r.a.transitioning}),o===r.a.followed?t._followDataSource.unfollowSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:r.a.notFollowing})},function(e){t.setState({followState:r.a.followed})}):t._followDataSource.followSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:r.a.followed})},function(e){t.setState({followState:r.a.notFollowing})})},this._getUrlFromEnum=function(e,o){var i=o[A[e].name];return i||e!==n.a.site||(i=t._params.pageContext.webAbsoluteUrl),i},this._updateUsageGuidelineCallback=function(){t._noThrowPromise(t._updateUsageGuidelineUrl()).then(function(e){e&&e.usageGuidelineUrl&&t.setState({usageGuidelineUrl:e.usageGuidelineUrl})})},this._params=e;var o=e.pageContext;this._pageContext=o,this._isGroup=Object(m.f)(o),this._async=new d.Async,this._asyncFetchTopNav=!1,d.Killswitch.isActivated("76048f30-8c23-4145-97e4-f0aadb3b29aa","7/13/2020","FixGuestExperience")?(this._isAnonymousGuest=o.isAnonymousGuestUser||o.isExternalGuestUser,this._isGuest=this._isAnonymousGuest):(this._isAnonymousGuest=o.isAnonymousGuestUser||o.isEmailAuthenticationGuestUser,this._isGuest=this._isAnonymousGuest||o.isExternalGuestUser),this._hasManageLists=w.a.hasPermission(o.webPermMasks,w.a.manageLists),this._chrome=Object(l.a)(this._pageContext);var i,a="";a=d.FeatureOverrides.isFeatureEnabled(F)&&this.shouldUseSiteIconManager(o)?d.Killswitch.isActivated("535d360b-694f-4f0c-8024-51b6ffa98bdd","10/21/2020","UpdateSiteLogoFormat")?"/_api/siteiconmanager/getsitelogo?siteurl='"+o.webAbsoluteUrl+"'&type=1":o.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?type='1'":e.pageContext.webLogoUrl,d.FeatureOverrides.isFeatureEnabled(F)||(a&&(-1===a.indexOf(m.a)||(a=void 0)),!this._isGroup||a&&-1!==a.toLowerCase().indexOf("/_api/GroupService/GetGroupImage".toLowerCase())||(a=o.webAbsoluteUrl+"/_api/GroupService/GetGroupImage"));var s=e.pageContext.webAbsoluteUrl;s&&(i=function(t){d.Engagement.logData({name:"SiteHeader.Logo.Click"}),e.logoOnClick&&(e.logoOnClick(s,t),t.stopPropagation(),t.preventDefault())});var u=this._setupHorizontalNav(),c=this._isGroup?o.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+o.groupId+"&target=conversations":void 0;this._params.siteHeader.state={membersText:void 0,siteClassification:this._getSiteClassification(),usageGuidelineUrl:void 0,siteLogoUrl:a,horizontalNavItems:u,logoOnClick:i,webAbsoluteUrl:s,outlookUrl:c,showCreateSiteButton:!1},D()&&!a&&(this._acronymDatasource=this._params.acronymDatasource||new g.a(o))}return e.prototype.componentDidMount=function(){var e=this,t=[this._isGroup||D()&&!this._acronymDatasource?d.Promise.resolve(void 0):this._noThrowPromise(this._loadSiteAcronym()),this._noThrowPromise(this._setupSiteReadOnlyBar()),this._noThrowPromise(this._setupSiteResourceQuotaBar()),this._noThrowPromise(this._setupFollowButton()),this._noThrowPromise(this._setupUserExpirationBar()),this._noThrowPromise(this._processGroups()),this._noThrowPromise(this._setupCreateSiteButton()),this._noThrowPromise(this._setupSiteStatusBar()),this._noThrowPromise(this._setupSitePolicyBar()),this._noThrowPromise(this._setupUnauthorizedTenantBar()),this._noThrowPromise(this._fetchTopNavigation()),this._noThrowPromise(this._setupNoSharePointSyntexLicenseBar())];d.Promise.all(t).then(function(t){var o={};t.forEach(function(e){e&&(o=Object(a.__assign)(Object(a.__assign)({},o),e))}),e.setState(o)})},e.prototype.componentWillUnmount=function(){this._async.dispose(),this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=null)},e.prototype.getRenderProps=function(e,t,o,a){var n,r,l=this._params,c=l.siteHeader.state,p=l.strings,m=l.pageContext,g=Number(m.webTemplate),v={siteLogoUrl:c.siteLogoUrl,siteAcronym:c.siteAcronym},b=this._computeGoToMembersAction(c.membersUrl),S=c.facepilePersonas&&!d.Killswitch.isActivated("96EC0112-DF6B-41BE-A704-47ABF4B7D922","05/03/2018","Facepile Persona coins with LPC control")?{personas:c.facepilePersonas,getPersonaProps:function(e){return{onRenderCoin:function(i,a){var n,r={personaType:(n=e&&e.data&&e.data.groupPerson)&&2===n.entityType?"Group":"User",identifier:n&&n.email,pageContext:m,moduleLoader:t,customWaiter:o,addGroupMembersCallback:function(e){b(void 0)},lpcHoverTargetProps:{upn:n&&n.email,hostAppPersonaInfo:{PersonaDisplayName:n&&n.name}}};return Object(u.b)(r,a(i))}}}}:{personas:c.facepilePersonas},y={membersText:c.membersText,goToMembersAction:b},C=c.webAbsoluteUrl,P={siteTitle:m.webTitle,headerOptions:this._chrome&&this._chrome.header,groupInfoString:this._getGroupInfoString(m,p),siteClassification:this._getSiteClassification(),siteLogo:v,logoHref:C,logoOnClick:c.logoOnClick,disableSiteLogoFallback:!0,facepile:S,showGroupCard:!!c.groupLinks,groupLinks:c.groupLinks,membersInfoProps:y,moduleLoader:e,lpcModuleLoader:t,lpcModuleLoaderWaiter:o,usageGuidelineUrl:c.usageGuidelineUrl,updateUsageGuidelineUrl:this._updateUsageGuidelineCallback,pageContext:m,groupEmail:c.groupEmail,waitForPLT:this._params.waitForPLT,openTeamsChannel:this._params.openTeamsChannel||this._openTeamsChannel},x=!!l.onEditClicked&&!c.isSiteReadOnly&&!this._isAnonymousGuest&&this._hasManageLists,O=this._chrome.nav.megaMenuEnabled,E={items:c.horizontalNavItems,editLink:x?Object(s.c)(m,!1,l.onEditClicked,void 0,h.a.editButtonAriaLabel):void 0,moduleLoader:e,isEditMode:c.isEditMode,ariaLabel:p.horizontalNavAriaLabel||h.a.ariaLabel,splitButtonAriaLabel:h.a.splitButtonAriaLabelWithName,moreOptionsAriaLabel:p.horizontalNavMoreOptionsAriaLabel||h.a.moreOptionsAriaLabel,hasSelectedState:this._horizontalNavType===i.quickLaunch,pageContext:this._pageContext,useMegaMenu:O};m&&m.navigationInfo&&m.navigationInfo.isAudienceTargeted&&(E.isAudienceTargeted=!0),this._horizontalNavType===i.quickLaunch?n=E:this._horizontalNavType===i.globalNav&&(r=E);var F=void 0!==c.followState?{followLabel:p.follow,followAction:this._onFollowClick,followState:c.followState,followedAriaLabel:p.followButtonAriaLabel,notFollowedAriaLabel:p.followButtonAriaLabel,followedHoverText:p.followedHover,notFollowedHoverText:p.notFollowedHover,notFollowedLabel:p.notFollowed}:void 0,A=void 0;d.Features.isFeatureEnabled(T)&&(A={pageContext:m,moduleLoader:a,moduleLoaderWaiter:o,imageUrls:this._params.imageUrls});var k=void 0;this._isAnonymousGuest||!w.a.hasPermission(this._pageContext.webPermMasks,w.a.editListItems)||m.groupId&&"00000000-0000-0000-0000-000000000000"!==m.groupId||(k={url:m.webAbsoluteUrl+"/_layouts/15/share.aspx?isDlg=1&OpenInTopFrame=1",shareLabel:p.shareLabel,loadingLabel:p.loadingLabel},l.shareButtonOnClick&&(k.url="",k.onShare=l.shareButtonOnClick));var L,U=c.showCreateSiteButton?{createSiteAction:this._onCreateSiteClick}:void 0;c.isSiteReadOnly?(L={isSiteReadOnly:!0,siteReadOnlyString:p.siteIsReadOnly,siteReadOnlyState:c.siteReadOnlyState,siteIsMovingString:p.siteIsMoving,siteMoveCompletedString:p.siteMoveComplete},m.isArchived&&g===_.a.teamChannel&&(L.siteReadOnlyString=p.siteIsArchived)):L=void 0;var D=void 0;0!==c.siteResourceQuotaState&&(D={siteResourceQuotaState:c.siteResourceQuotaState,siteResourceOverQuota:p.siteIsOverQuota,siteResourceQuotaWarning:p.siteIsCloseToQuota});var G=d.Killswitch.isActivated("F88CC3D7-8906-4639-A8FD-DE719C2446F9","2/16/2021","Add create site action to composite header props")?null:{createSiteAction:this._onCreateSiteClick},I=this._horizontalNavType===i.quickLaunch?f.c.FULLBLEED:void 0,N=d.FeatureOverrides.isFeatureEnabled({ODB:1179})?this._pageContext.headerLayout:void 0,B=!c.hideUserExpirationBar&&c.expiringUsers>0&&{userExpirationOnClick:this._params.userExpirationOnClick,onDismiss:this._onUserExpirationDismissClick,expiringUserCount:c.expiringUsers};return{siteHeaderProps:P,horizontalNavProps:n,topNavProps:r,onRenderHorizontalNav:l.onRenderHorizontalNav,createSiteButton:U,shareButton:k,follow:F,siteScriptProgressIndicator:A,messageBarProps:c.messageBarState,siteReadOnlyProps:L,siteResourceQuotaProps:D,policyBarProps:c.policyBarState,unauthorizedTenantBarProps:c.unauthorizedTenantBarState,noSharePointSyntexLicenseBarProps:c.noSharePointSyntexLicenseBarState,layout:I,unifiedLayout:N,userExpirationBarProps:B,getAccessToken:l.getAccessToken,groupsProvider:this._groupsProvider,createSiteAction:G}},e.prototype.updateHorizontalNav=function(e,t){this.setState({horizontalNavItems:e,editModeHorizontalNav:!1},t)},e.prototype._getGroupInfoString=function(e,t){var o;if(this._isGroup)o="Public"===e.groupType?t.publicGroup:t.privateGroup;else if(e.isTeamsChannelSite||Number(e.webTemplate)===_.a.teamChannel){var i=e.teamsChannelType;o=3===i?t.standardChannel:2===i?t.sharedChannel:t.privateChannel}return o},e.prototype._computeGoToMembersAction=function(e){var t=void 0;return this._isGuest||(t=this._onGoToMembersClick),t},e.prototype.setState=function(e,t){this._params.siteHeader.setState(e,t)},e.prototype._noThrowPromise=function(e){return e.catch(function(){})},e.prototype.shouldUseSiteIconManager=function(e){return e.webLogoUrl||e.webLogoUrl.indexOf(m.a)>=0||this.containsSiteAssetsRelativePath(e)||this._isGroup},e.prototype.containsSiteAssetsRelativePath=function(e){return e.webLogoUrl&&e.webAbsoluteUrl&&e.webLogoUrl.toLowerCase().indexOf(e.webAbsoluteUrl.toLowerCase()+"/siteassets")>=0},e.prototype._loadSiteAcronym=function(){return this._acronymDatasource.getAcronymData(this._pageContext.webTitle).then(function(e){return{siteAcronym:e.acronym,siteLogoColor:e.color}})},e.prototype._setupHorizontalNav=function(){var e,t=this._pageContext,o=t.navigationInfo,a=o&&o.quickLaunch,n=o&&o.topNav,r=this._chrome.nav.placement===f.e.HORIZONTAL,s=i.none;return r&&this._params.horizontalQuickLaunchEnabled&&a&&a.length?(e=a,s=i.quickLaunch):t.isHubSite?s=i.none:t.PublishingFeatureOn?(this._asyncFetchTopNav=!0,s=i.globalNav):n&&n.length&&(s=i.globalNav,e=n),this._horizontalNavType=s,this._transformToNavItems(e)},e.prototype._fetchTopNavigation=function(){return this._asyncFetchTopNav?new P.a(this._pageContext,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,depth:3}).then(function(e){if((!U||e)&&e.links)return{horizontalNavItems:e.links}}):d.Promise.resolve(void 0)},e.prototype._transformToNavItems=function(e){var t=this,o=[];if(e&&e.length>0){var a=this._horizontalNavType===i.quickLaunch;o=P.a.transformNodesToLinks(e,function(e,o){(!o||""!==o.url&&o.url!==s.b)&&t._params.topNavNodeOnClick(e,o),e.stopPropagation(),e.preventDefault()},function(e,t){return t>0||!(a&&e.Id===Number("1033"))})}return o},e.prototype._processGroups=function(){var e=this;return this._isGroup?this._params.getGroupsProvider().then(function(t){return t&&(e._groupsProvider=t,e._groupsProvider.group)?(e._groupsProvider.group.membership.load(),e._updateGroupsInfo()):d.Promise.resolve(void 0)}):d.Promise.resolve(void 0)},e.prototype._updateGroupsInfo=function(){var e,t,o,i=this,n={};if(this._isGroup){var r=this._groupsProvider.group,s=function(e){var t={};if(e!==v.a.None&&r.membership&&i._totalNumberOfMembers!==r.membership.totalNumberOfMembers){var o=i._updateFacepilePersonas(r.membership),n=i._getMembersText(r.membership);i._totalNumberOfMembers=r.membership.totalNumberOfMembers,t=Object(a.__assign)(Object(a.__assign)({},t),{membersText:n,facepilePersonas:o})}return d.Promise.resolve(t)},l=function(n){var s={};if(n!==v.a.None&&!i._hasParsedMembers){i._hasParsedMembers=!0,o=i._getSiteClassification(),e=i._isGuest?void 0:r.inboxUrl,t=i._isGuest?void 0:r.membersUrl;var l=i._groupCardLinksFromGroupCardLinkParams(i._params.groupCardInfo,r);if(s={siteClassification:o,outlookUrl:e,membersUrl:t,groupLinks:l,groupEmail:r.mail},!D()||i._acronymDatasource)return i._noThrowPromise(i._loadSiteAcronym()).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),s)})}return d.Promise.resolve(s)};return this._ensureEventGroup(),this._eventGroup.on(r,"source",function(e){l(e).then(function(e){i.setState(e)})}),this._eventGroup.on(r.membership,"source",function(e){s(e).then(function(e){i.setState(e)})}),d.Promise.all([l(r.source),s(r.membership.source)]).then(function(e){return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e[0]),e[1]),n)})}return d.Promise.resolve(n)},e.prototype._ensureEventGroup=function(){this._eventGroup||(this._eventGroup=new d.EventGroup(this))},e.prototype._groupCardLinksFromGroupCardLinkParams=function(e,t){var o=[];if(this._isGroup&&t&&e&&e.length){for(var i=0;i<e.length;i++){var a=e[i].linkType,n=this._getUrlFromEnum(a,t);if(n&&(!this._isAnonymousGuest||!A[a].trimIfAnonymous)){var r="GroupCard."+A[a].eid+".Click";o.push({title:e[i].title,icon:e[i].icon,href:n,engagementId:r})}}return o}return null},e.prototype._updateUsageGuidelineUrl=function(){var e=this;return!Object(m.e)(this._pageContext)&&this._getSiteClassification()&&this._params.getGroupSiteProvider?this._params.getGroupSiteProvider().then(function(t){e._groupSiteProvider=t}).then(function(){var t;return e._groupSiteProvider&&(t=e._groupSiteProvider.getGroupCreationContext()),t}).then(function(e){return{usageGuidelineUrl:e.usageGuidelineUrl}}):d.Promise.resolve(void 0)},e.prototype._getHubDataSource=function(){var e=this;return this._hubDataSource?d.Promise.as(this._hubDataSource):Promise.resolve().then(o.bind(null,"bugI")).then(function(t){return e._hubDataSource=new t.default(e._pageContext),e._hubDataSource})},e.prototype._setupCreateSiteButton=function(){var e=this;if(d.FeatureOverrides.isFeatureEnabled(O)){var t=this._params.waitForPLT;if(t)return t.then(function(){return e._getHubDataSource()}).then(function(t){return function(e,t){return d.FeatureOverrides.isFeatureEnabled(c)&&t&&e&&e.isHubSite?t.canCreateHubJoinedSite(e.hubSiteId):d.Promise.resolve(!1)}(e._pageContext,t)}).then(function(e){return{showCreateSiteButton:!!e}})}return d.Promise.resolve(void 0)},e.prototype._setupFollowButton=function(){var e=this;return this._isGuest?d.Promise.resolve(void 0):(this._followDataSource=this._params.followDataSource||new C(this._pageContext),this._followDataSource.isFollowFeatureEnabled().then(function(t){var o;return t?e._followDataSource.isSiteFollowed(e._pageContext.webAbsoluteUrl,!1,!1,e._pageContext.siteId,e._pageContext.webId).then(function(e){return void 0!==e&&(o={followState:e?r.a.followed:r.a.notFollowing}),o}):{followState:void 0}}))},e.prototype._setupSiteStatusBar=function(){return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(e){return e.getStatusBarInfo()}).then(function(e){return e.StatusBarText?{messageBarState:{message:e.StatusBarText,linkText:e.StatusBarLinkText,linkTarget:e.StatusBarLinkTarget}}:d.Promise.resolve(void 0)}):d.Promise.resolve(void 0)},e.prototype._setupSitePolicyBar=function(){var e;return d.Features.isFeatureEnabled({ODB:749,ODC:null,Fallback:!1})&&(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)?(e=this._params.strings.authenticationPolicyActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.authenticationPolicyActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=823640"}:{message:void 0,linkText:void 0,linkTarget:void 0},d.Promise.resolve({policyBarState:e})):d.Promise.resolve(void 0)},e.prototype._setupUnauthorizedTenantBar=function(){var e;return d.Features.isFeatureEnabled({ODB:1577,ODC:null,Fallback:!1})&&this._pageContext.isUnauthorizedTenant?(e=this._params.strings.unauthorizedTenantActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.unauthorizedTenantActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=2092321"}:{message:void 0,linkText:void 0,linkTarget:void 0},d.Promise.resolve({unauthorizedTenantBarState:e})):d.Promise.resolve(void 0)},e.prototype._setupNoSharePointSyntexLicenseBar=function(){var e=this,t={ODB:1234,ODC:null,Fallback:!1};if(d.Features.isFeatureEnabled({ODB:60031,ODC:null,Fallback:!1})&&Number(this._pageContext.webTemplate)===_.a.contentCenter){var o={noSharePointSyntexLicenseBarState:void 0};if(this._params.getSyntexDataSource)return this._params.getSyntexDataSource().then(function(i){return d.Features.isFeatureEnabled(t)?i.getMachineLearningEnabled().then(function(t){var i,a;if(!t.MachineLearningCaptureEnabled&&!t.MachineLearningExperienceEnabled){var n=d.Features.isFeatureEnabled({ODB:60049,ODC:null,Fallback:!1}),r=null===(i=e._params.strings)||void 0===i?void 0:i.default;o.noSharePointSyntexLicenseBarState={message:n&&(null===(a=r)||void 0===a?void 0:a.noSharePointSyntexLicense)?r.noSharePointSyntexLicense:e._params.strings.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return o}):i.getMachineLearningCaptureEnabled().then(function(t){var i,a;if(!t){var n=d.Features.isFeatureEnabled({ODB:60049,ODC:null,Fallback:!1}),r=null===(i=e._params.strings)||void 0===i?void 0:i.default;o.noSharePointSyntexLicenseBarState={message:n&&(null===(a=r)||void 0===a?void 0:a.noSharePointSyntexLicense)?r.noSharePointSyntexLicense:e._params.strings.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return o})})}return d.Promise.resolve(void 0)},e.prototype._setupSiteReadOnlyBar=function(){if(d.Killswitch.isActivated("40EBE94D-11BC-4926-A75E-6827E8FB6CD8","8/11/2020","Remove Readonly XHR"))return this._setupSiteReadOnlyBarOld();var e={};return void 0===this._pageContext.readOnlyState?e.siteReadOnlyState=-2:null===this._pageContext.readOnlyState?e.siteReadOnlyState=-1:(e.siteReadOnlyState=this._pageContext.readOnlyState,e.isSiteReadOnly=this._pageContext.readOnlyState>=0),this._pageContext.isArchived&&(e.isSiteReadOnly=!0),d.Promise.resolve(e)},e.prototype._setupSiteReadOnlyBarOld=function(){var e=this;return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){return t.getReadOnlyState().then(function(o){var i={siteReadOnlyState:t.getFullSiteReadOnlyState()};return(o||e._pageContext.isArchived)&&(i.isSiteReadOnly=!0),i})}):d.Promise.resolve(void 0)},e.prototype._setupSiteResourceQuotaBar=function(){var e={siteResourceQuotaState:this._pageContext.resourceQuotaExceeded};return d.Promise.resolve(e)},e.prototype._setupUserExpirationBar=function(){var e=this,t=this._pageContext.isSiteAdmin&&d.Features.isFeatureEnabled(E);return this._params.userExpirationOnClick&&this._params.getUserExpirationProvider&&t?this._userExpirationProvider?this._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}}):this._params.getUserExpirationProvider().then(function(t){e._userExpirationProvider=t}).then(function(){return e._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}})}):d.Promise.resolve(void 0)},e.prototype._countExpiringUsers=function(e){var t=0,o=new Date,i=new Date(o.getTime()+18144e5);return e.forEach(function(e){e.expiration<i&&!(e.isSiteAdmin&&e.expiration<o)&&t++}),t},e.prototype._getMembersText=function(e){var t=e.totalNumberOfMembers;if(t){var o=this._params.strings,i=x.getLocalizedCountValue(o.membersCount,o.membersCountIntervals,t);return x.format(i,t)}},e.prototype._updateFacepilePersonas=function(e){return e.membersList.members.slice(0,3).map(function(e,t){return{personaName:e.name,imageUrl:e.image,data:{groupPerson:e,personaType:e.entityType},"data-automationid":"SiteHeaderFacepilePersona_"+t.toString()}})},e.prototype._getSiteClassification=function(){return d.Killswitch.isActivated("149A9D34-BEC1-4FD1-950C-8E5CB81348D2","03-17-2021","Fix classification for channels.")?this._getSiteClassificationOld():(this._pageContext&&(e=this._pageContext.sensitivityLabelName),!e&&this._groupsProvider&&this._groupsProvider.group&&(t=this._groupsProvider.group.classification),e||t||this._pageContext&&this._pageContext.siteClassification);var e,t},e.prototype._getSiteClassificationOld=function(){var e,t;return this._groupsProvider&&this._groupsProvider.group&&(this._pageContext&&(e=this._pageContext.sensitivityLabelName),e||(t=this._groupsProvider.group.classification)),e||t||this._pageContext&&this._pageContext.siteClassification},e}();function U(){return d.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function D(){return!d.Killswitch.isActivated("4f8452f7-e57d-4fcd-978c-fb72127955a9","09/08/2020","Skip call to get acronym if cusotm site logo exists")}t.default=L},OpjN:function(e,t,o){"use strict";var i;o.d(t,"a",function(){return i}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(i||(i={}))},Vlqv:function(e,t,o){"use strict";o.d(t,"a",function(){return h});var i,a,n=o("17wl"),r=o("K9kD"),s=o("71k8"),l=o("3HEj"),u=o("NacN"),d="c8b3137a-ca4c-48a9-b356-a8e7987dd693",c=((i={})[s.b.teamSite]=d,i[s.b.group]=d,i[s.b.sitePagePublishing]="96c933ac-3698-44c7-9f4a-5fd17d71af9e",i[s.b.pointPublishingPersonal]="400955b3-329f-4b22-ade5-002653506aee",i[s.b.contentCenter]="ab120c41-0d36-490b-a048-b39f65675858",i),p=((a={})[d]=function(){return{id:d,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.LEFT},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[s.b.teamSite,s.b.group]}},a["96c933ac-3698-44c7-9f4a-5fd17d71af9e"]=function(){return{id:"96c933ac-3698-44c7-9f4a-5fd17d71af9e",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[s.b.sitePagePublishing]}},a["6142d2a0-63a5-4ba0-aede-d9fefca2c767"]=function(){return{id:"6142d2a0-63a5-4ba0-aede-d9fefca2c767",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[s.b.sitePagePublishing]}},a["f6cc5403-0d63-442e-96c0-285923709ffc"]=function(){return{id:"f6cc5403-0d63-442e-96c0-285923709ffc",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[s.b.sitePagePublishing]}},a["400955b3-329f-4b22-ade5-002653506aee"]=function(){return{id:"400955b3-329f-4b22-ade5-002653506aee",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.LEFT,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[s.b.pointPublishingPersonal]}},a["fbf8ec01-846c-44c4-b17b-8fe1e4e5adae"]=function(){return{id:"fbf8ec01-846c-44c4-b17b-8fe1e4e5adae",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[s.b.sitePagePublishing]}},a["ab120c41-0d36-490b-a048-b39f65675858"]=function(){return{id:"ab120c41-0d36-490b-a048-b39f65675858",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[s.b.contentCenter]}},a["67f52693-99aa-428d-8670-0b1b2d291aa8"]=function(){if(!r.Killswitch.isActivated("5ff3cf56-b6b0-4ac9-8162-f87f7a49a5cf","04/09/2020","Deactivate knowledge center design package"))return{id:"67f52693-99aa-428d-8670-0b1b2d291aa8",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:u.f.none},nav:{hidden:!1,placement:u.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[s.b.contentCenter]}},a);function h(e){var t,o=function(e){if(!e)throw new Error("pageContext missing");var t=function(e){var t,o=r.Guid.Empty;return e.DesignPackageId&&(t=e.DesignPackageId,void 0!==p[t])&&(o=e.DesignPackageId),o===r.Guid.Empty&&void 0!==c[e.webTemplate]&&(o=c[e.webTemplate]),o===r.Guid.Empty&&(o=d),o}(e);return Object(n.__assign)(Object(n.__assign)({},p[t]().chromeOptions),{footer:{emphasis:u.a.Strong,hidden:!0,layout:u.b.SIMPLE}})}(e),i=(e.webPropertyFlags2&l.b.FooterEmphasis1)>>8,a=(e.webPropertyFlags2&l.b.FooterEmphasis0)>>8;o.footer.emphasis=i|a;var s=(e.webPropertyFlags2&l.b.FooterLayout1)>>10,h=(e.webPropertyFlags2&l.b.FooterLayout0)>>10;o.footer.layout=s|h,o.footer.hidden=0==(2&e.webPropertyFlags2),o.nav&&!o.nav.hidden&&(o.nav.megaMenuEnabled=0!=(128&e.webPropertyFlags2),o.nav.quickLaunchEnabled=!!(null===(t=e.navigationInfo)||void 0===t?void 0:t.quickLaunch)),o.header.layout=e.headerLayout,o.header.emphasis=e.headerEmphasis,o.header.logoAlignment=e.logoAlignment;var m=0!=(e.webPropertyFlags2&l.b.HideTitleInHeader);return o.header.hideTitle=m,o}}}]);