/*! Version: 2.8.1; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-cc492c6a472a276ee649a400c121df18573af4a3003c97ab1959d9b940f4531c30b437d7fce70845cd97b4e2a90b57d63fe65a6a66c75d44b2702981b66a4cd8.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[83,69],{1085:function(t,e,n){"use strict";function o(t,e,n){}n.d(e,"a",function(){return o})},1086:function(t,e,n){"use strict";function o(t,e,n){}n.d(e,"a",function(){return o})},1088:function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(976);function o(t,e,n,o,i){}},1126:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a});var o=["setState","render","componentWillMount","UNSAFE_componentWillMount","componentDidMount","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","getSnapshotBeforeUpdate","UNSAFE_componentWillUpdate","componentDidUpdate","componentWillUnmount"];function i(t,e,n){void 0===n&&(n=o);var i=[],a=function(o){"function"!=typeof e[o]||void 0!==t[o]||n&&-1!==n.indexOf(o)||(i.push(o),t[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e[o].apply(e,t)})};for(var r in e)a(r);return i}function a(t,e){e.forEach(function(e){return delete t[e]})}},1127:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"c",function(){return r}),n.d(e,"b",function(){return s});var o=n(1),i=o.createContext({window:"object"==typeof window?window:void 0}),a=function(){return o.useContext(i).window},r=function(){var t;return null===(t=o.useContext(i).window)||void 0===t?void 0:t.document},s=function(t){return o.createElement(i.Provider,{value:t},t.children)}},1128:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o,i=n(52);function a(t){if(void 0===o||t){var e=Object(i.a)(),n=e&&e.navigator.userAgent;o=!!n&&-1!==n.indexOf("Macintosh")}return!!o}},1129:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)}},1130:function(t,e,n){"use strict";n.d(e,"a",function(){return u}),n.d(e,"b",function(){return d});var o=n(5),i=n(1),a=n(511),r=n(303),s=n(1088),l=n(1086),p=n(1085),u=function(t){function e(n,o){var i=t.call(this,n,o)||this;return function(t,e,n){for(var o=0,i=n.length;o<i;o++)c(t,e,n[o])}(i,e.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),i}return Object(o.__extends)(e,t),e.prototype.componentDidUpdate=function(t,e){this._updateComponentRef(t,this.props)},e.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},e.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var t=0,e=this._disposables.length;t<e;t++){var n=this.__disposables[t];n.dispose&&n.dispose()}this.__disposables=null}},Object.defineProperty(e.prototype,"className",{get:function(){if(!this.__className){var t=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=t&&t.length>1?t[1]:""}return this.__className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_async",{get:function(){return this.__async||(this.__async=new a.a(this),this._disposables.push(this.__async)),this.__async},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_events",{get:function(){return this.__events||(this.__events=new r.a(this),this._disposables.push(this.__events)),this.__events},enumerable:!0,configurable:!0}),e.prototype._resolveRef=function(t){var e=this;return this.__resolves||(this.__resolves={}),this.__resolves[t]||(this.__resolves[t]=function(n){return e[t]=n}),this.__resolves[t]},e.prototype._updateComponentRef=function(t,e){void 0===e&&(e={}),t&&e&&t.componentRef!==e.componentRef&&(this._setComponentRef(t.componentRef,null),this._setComponentRef(e.componentRef,this))},e.prototype._warnDeprecations=function(t){Object(p.a)(this.className,this.props,t)},e.prototype._warnMutuallyExclusive=function(t){Object(l.a)(this.className,this.props,t)},e.prototype._warnConditionallyRequiredProps=function(t,e,n){Object(s.a)(this.className,this.props,t,e,n)},e.prototype._setComponentRef=function(t,e){!this._skipComponentRefResolution&&t&&("function"==typeof t&&t(e),"object"==typeof t&&(t.current=e))},e}(i.Component);function c(t,e,n){var o=t[n],i=e[n];(o||i)&&(t[n]=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return i&&(t=i.apply(this,e)),o!==i&&(t=o.apply(this,e)),t})}function d(){return null}},1191:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o=n(5),i=n(1),a=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isRendered:!1},n}return Object(o.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout(function(){t.setState({isRendered:!0})},e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?i.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(i.Component)},1247:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n(112);function i(t){for(var e,n=[],i=Object(o.a)(t)||document;t!==i.body;){for(var a=0,r=t.parentElement.children;a<r.length;a++){var s=r[a];s!==t&&"true"!==(null===(e=s.getAttribute("aria-hidden"))||void 0===e?void 0:e.toLowerCase())&&n.push(s)}if(!t.parentElement)break;t=t.parentElement}return n.forEach(function(t){t.setAttribute("aria-hidden","true")}),function(){!function(t){t.forEach(function(t){t.setAttribute("aria-hidden","false")})}(n),n=[]}}},2053:function(t,e,n){"use strict";n.r(e),n.d(e,"ProfilePhotoPickerStore",function(){return _}),n.d(e,"ProfilePhotoPicker",function(){return ft}),n.d(e,"StandaloneProfilePhotoPicker",function(){return It}),n.d(e,"initIcons",function(){return Ut});var o=n(7),i=n(41),a=n(36),r=n(2),s="ProfilePhotoPicker";function l(t,e){void 0===e&&(e=null);var n=""+s+t+"Action";return Object(r.a)(n,{featureName:s,exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var p=l("CancelButtonClicked","ProfilePhotoPickerCancelButtonClicked"),u=l("CloseButtonClicked","ProfilePhotoPickerCloseButtonClickedAction"),c=l("DoneButtonClicked","ProfilePhotoPickerDoneButtonClickedAction"),d=l("UploadNewPhotoButtonClicked","ProfilePhotoPickerUploadNewPhotoButtonClickedAction"),h=l("ImageEditPaneDismissed","ProfilePhotoPickerImageEditPaneDismissed"),m=l("ImageUpdated"),f=l("LoadedCurrentImage"),g=l("LoadedEmptyImage"),v=l("LoadedNewImage"),y=l("SomethingWentWrong"),S=l("UploadStarted","ProfilePhotoPickerApplyButtonClicked"),b=l("UploadProgress"),C=l("UploadSucceeded"),E=l("WarningDismissed"),w={dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0},U=Object(i.a)().handleAction(p,P).handleAction(u,P).handleAction(c,P).handleAction(h,P).handleAction(E,function(t){return Object(o.l)(t,{status:"READY",warning:void 0})}).handleAction(f,function(t,e){var n=e.payload.dataUrl;return Object(o.l)(t,{dataUrl:t.dataUrl||n,currentImageDataUrl:t.currentImageDataUrl||n,isUpdated:!!e.payload.isSuggestedPhoto})}).handleAction(v,function(t,e){return Object(o.l)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl})}).handleAction(g,function(t){return Object(o.l)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl})}).handleAction(S,function(t,e){return Object(o.l)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})}).handleAction(b,function(t,e){return"IN_PROGRESS"===t.status?Object(o.l)(t,{uploadDuration:e.payload.now-t.uploadStart}):t}).handleAction(C,function(t,e){return Object(o.l)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})}).handleAction(y,function(t,e){return Object(o.l)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})}).handleAction(m,function(t){return Object(o.l)(t,{isUpdated:!0})}).done(w),_=Object(a.a)("ProfilePhotoPickerStore",U,function(t){return t});function P(t){return Object(o.l)(t,{dataUrl:"",currentImageDataUrl:"",status:"READY",warning:void 0,isUpdated:!1})}var I=n(589),O=n.n(I),x=n(408),D=n.n(x),k=n(115),R=n(986),N=n(1582),B=n(1396),A=n(1463),L=n(1375),W=n(425),T=n(1612),M=n(1618),j=n(831),z=n(179),F=n(1),H=n(155);function G(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var Y=n(3),X=n.n(Y),K=n(215),Z=n(573),q=n(1720),V=n(64);function J(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),n=atob(e),o=n.length,i=new ArrayBuffer(o),a=new Uint8Array(i),r=0;r<o;r++)a[r]=n.charCodeAt(r);return i}(t));if(65496!==e.getUint16(0,!1))return 1;for(var n,o=e.byteLength,i=2;i<o;){var a=e.getUint16(i,!1);if(i+=2,65505===a){if(1165519206!==e.getUint32(i+=2,!1))break;var r=18761===e.getUint16(i+=6,!1);i+=e.getUint32(i+4,r);var s=e.getUint16(i,r);i+=2;for(var l=0;l<s;l++)if(274===e.getUint16(i+12*l,r))return(n=e.getUint16(i+12*l+8,r))<1||n>8?1:n}else{if(65280!=(65280&a))break;i+=e.getUint16(i,!1)}}return 1}var Q,$=n(18),tt=n(282),et=function(){return(et=X.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},nt=Object(tt.c)(function(t,e){var n=t.palette;return Object($.cb)({editControls:{display:"flex",flexDirection:"row",width:"100%",height:54},zoomButton:{selectors:{"&:disabled":{background:n.white}}},editCanvas:{backgroundColor:n.white,cursor:e?"move":"inherit"},invisible:et({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),slider:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{".ms-Slider-thumb":{border:"2px solid "+n.themePrimary},".ms-Slider-active":{backgroundColor:n.themePrimary},".ms-Slider-inactive":{backgroundColor:n.themeLight}}},canvasContainer:{margin:"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:{color:n.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},initials:{fontSize:128,lineHeight:128}})}),ot=(Q=function(t,e){return(Q=D.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Q(t,e),t.prototype=null===e?O()(e):(n.prototype=e.prototype,new n)}),it={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},at=function(t,e,n){return Math.min(n,Math.max(t,e))},rt=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]},st=function(t){function e(e){var n=t.call(this,e)||this;return n.hasUnmounted=!1,n.editorCanvas=null,n.textBoy=null,n.initialState={xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0},n.state=X()({},n.initialState),n}return ot(e,t),e.prototype.render=function(){var t=this,e=!this.state.image||this.state.maximumScale<=1||this.props.progress>0,n=!e||this.state.naturalHeight!==this.state.naturalWidth,o=nt(this.props.theme,n),i=1===this.props.progress?F.createElement("div",{className:o.textboy},F.createElement("span",{className:o.invisible},this.props.strings.success),F.createElement(Z.a,{className:o.initials,iconName:"CheckMark"})):null,a=at(2*this.state.stepSize,.1,.2),r=e?F.createElement("div",{className:o.editControls}):F.createElement("div",{className:o.editControls},F.createElement(N.a,{className:o.zoomButton,iconProps:{iconName:"CalculatorSubtract"},title:this.props.strings.zoomOut,ariaLabel:this.props.strings.zoomOut,onClick:function(){return t.zoom(-a,128,128)},disabled:this.state.zoomOutDisabled,tabIndex:-1}),F.createElement(q.a,{ariaValueText:function(e){return Math.round(100*(e*(t.state.maximumScale-1)+1))+"%"},ariaLabel:this.props.strings.zoom,className:o.slider,min:0,max:1,step:at(this.state.stepSize,.05,.1),value:this.state.relativeScale,showValue:!1,onChange:function(e){return t.handleZoomSlider(e)}}),F.createElement(N.a,{className:o.zoomButton,iconProps:{iconName:"CalculatorAddition"},title:this.props.strings.zoomIn,ariaLabel:this.props.strings.zoomIn,onClick:function(){return t.zoom(a,128,128)},disabled:this.state.zoomInDisabled,tabIndex:-1}));return F.createElement("div",{className:o.canvasContainer},F.createElement("canvas",{className:o.editCanvas,role:"img",tabIndex:this.state.image?0:void 0,ref:function(e){return t.editorCanvas=e},width:256,height:256,onKeyDown:function(e){return t.onKeyboardHandler(e)},"aria-label":this.props.strings.dropZone}),F.createElement("div",{className:o.textboy,ref:function(e){return t.textBoy=e}},F.createElement("div",{className:o.initials},this.props.initials),F.createElement("div",null,this.props.strings.dropZone)),F.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},i),r)},e.prototype.componentWillUnmount=function(){this.hasUnmounted=!0},e.prototype.componentDidMount=function(){var t=this;this.props.dataUrl&&setTimeout(function(){return t.props.dataUrl&&t.loadImage(t.props.dataUrl)},0),this.attachEventListeners(),this.renderCanvasContent()},e.prototype.shouldComponentUpdate=function(t,e){return!Object(K.a)(t,this.props)||!Object(K.a)(e,this.state)},e.prototype.componentWillReceiveProps=function(t){t.dataUrl&&t.dataUrl!==this.props.dataUrl?this.loadImage(t.dataUrl):t.dataUrl!==this.props.dataUrl&&(this.state=X()({},this.initialState))},e.prototype.componentDidUpdate=function(t){this.renderCanvasContent(),1===this.props.progress&&t.progress!==this.props.progress&&this.props.onRefocus()},e.prototype.getImageDataUrlFromCanvas=function(t){var e=this;if(void 0===t&&(t=648),!this.state.image)return"";var n=document.createElement("canvas"),o=this.state.naturalMin/this.state.absoluteScale;n.width=o,n.height=o;var i=n.getContext("2d");if(!i)return this.props.onError("UNSUPPORTED_BROWSER"),"";i.fillStyle=this.props.customBackgroundColor||"white",i.fillRect(0,0,n.width,n.height),this.state.image&&this.withCenterRotated(i,n.width,this.state.orientation,this.state.image,function(t,o){return i.drawImage(o,e.state.xpos*n.width/256,e.state.ypos*n.height/256,e.state.naturalWidth,e.state.naturalHeight)});for(var a=1;n.width*a/4>=t;)a/=2,i.drawImage(n,0,0,n.width*a,n.height*a);var r=document.createElement("canvas"),s=Math.min(this.state.naturalMin/this.state.absoluteScale,t);r.width=s,r.height=s;var l=r.getContext("2d");return l?(l.drawImage(n,0,0,n.width*a,n.width*a,0,0,s,s),G(r,this.props.isComponentInline)):(this.props.onError("UNSUPPORTED_BROWSER"),"")},e.prototype.loadImage=function(t){var e=this;if(t){var n=new Image;n.onload=function(){return e.imageLoaded(n)},n.src=t}else this.setState(this.initialState)},e.prototype.imageLoaded=function(t){var e,n,i=this,a=1;"Fit"===this.props.imageScaling?(a=1.2,e=Math.max(t.naturalWidth,t.naturalHeight),n=e*a/256):(e=Math.min(t.naturalWidth,t.naturalHeight),n=e/256);var r=function(t){return-.5*(t/n-256)},s=Math.min(1,Math.max(.01,256/(2*Math.max(t.naturalWidth,t.naturalHeight)))),l=Object(o.l)(this.initialState,{naturalMin:e,naturalWidth:t.naturalWidth*a,naturalHeight:t.naturalHeight*a,stepSize:s,maximumScale:n,orientation:J(t.src),image:t,zoomInDisabled:!1,initialRender:!1,xpos:r(t.naturalWidth*a),ypos:r(t.naturalHeight*a)});!this.state.initialRender&&l.maximumScale<1&&(l.naturalHeight<48||l.naturalWidth<48?setTimeout(function(){return i.props.onError("IMAGE_TOO_SMALL_ERROR")},0):setTimeout(function(){return i.props.onError("IMAGE_TOO_SMALL_WARNING")},0)),this.props.isUploadedPhotoTooSmall(l.naturalHeight<48||l.naturalWidth<48),this.hasUnmounted||this.setState(l)},e.prototype.renderCanvasContent=function(){var t=this,e=this.editorCanvas;if(e&&this.textBoy){var n=e.getContext("2d");if(n){var o=window.getComputedStyle(e);n.fillStyle=o.backgroundColor||"#ffffff",n.fillRect(0,0,1,1);var i=n.getImageData(0,0,1,1).data,a="rgba("+i[0]+", "+i[1]+", "+i[2]+", 0.6)",r="rgba("+i[0]+", "+i[1]+", "+i[2]+", 1)";""===this.props.dataUrl?(n.fillStyle=this.props.textboyColor,this.textBoy.style.display="flex"):(n.fillStyle=this.props.customBackgroundColor||"white",this.textBoy.style.display="none"),n.fillRect(0,0,256,256),this.state.image&&(this.withCenterRotated(n,256,this.state.orientation,this.state.image,function(e,n){return e.drawImage(n,t.state.xpos,t.state.ypos,t.state.naturalWidth*t.state.absoluteScale/t.state.maximumScale,t.state.naturalHeight*t.state.absoluteScale/t.state.maximumScale)}),this.props.onCanvasUpdated&&this.props.onCanvasUpdated(e)),"Circle"===this.props.imageCropShape&&(n.save(),n.beginPath(),n.rect(0,0,256,256),n.arc(128,128,125,0,2*Math.PI,!0),n.clip(),n.fillStyle=a,n.fillRect(0,0,256,256),n.restore(),n.save(),n.beginPath(),n.arc(128,128,126,0,2*Math.PI,!0),n.lineWidth=2,n.strokeStyle=r,n.stroke(),n.restore(),n.save(),n.beginPath(),n.lineWidth=4,n.fillStyle="rgba(0, 120, 215, 0.5)",n.strokeStyle="rgba(0, 120, 215, 0.5)",n.arc(128,128,125,-Math.PI/2,2*this.props.progress*Math.PI-Math.PI/2,!1),1===this.props.progress&&n.fill(),n.stroke(),n.restore())}else this.props.onError("UNSUPPORTED_BROWSER")}},e.prototype.withCenterRotated=function(t,e,n,o,i){t.save(),t.translate(e/2,e/2),t.transform.apply(t,it[n]),t.translate(-e/2,-e/2),i(t,o),t.restore()},e.prototype.rotate=function(t,e,n){var o=it[n],i=o[0],a=o[2];return{x:(t-=128)*i+(e-=128)*o[1]+128,y:t*a+e*o[3]+128}},e.prototype.attachEventListeners=function(){var t=this;this.editorCanvas&&this.textBoy&&(this.editorCanvas.addEventListener("dragenter",this.handleDragEnter.bind(this),!1),this.editorCanvas.addEventListener("dragleave",this.handleDragLeave.bind(this),!1),this.editorCanvas.addEventListener("dragover",this.stopEventDefaults.bind(this),!1),this.editorCanvas.addEventListener("drop",this.handleFileDrop.bind(this),!1),this.textBoy.addEventListener("dragenter",this.handleDragEnter.bind(this),!1),this.textBoy.addEventListener("dragleave",this.handleDragLeave.bind(this),!1),this.textBoy.addEventListener("dragover",this.stopEventDefaults.bind(this),!1),this.textBoy.addEventListener("drop",this.handleFileDrop.bind(this),!1),this.editorCanvas.addEventListener("mousedown",this.handleDragStart.bind(this),!1),this.editorCanvas.addEventListener("mousemove",function(e){return t.handleDrag(e,!0)},!1),this.editorCanvas.addEventListener("mouseup",function(e){return t.handleDrag(e,!1)},!1),this.editorCanvas.addEventListener("mouseleave",function(e){return t.handleDrag(e,!1)},!1),this.editorCanvas.addEventListener("wheel",this.handleWheel.bind(this),!1),this.editorCanvas.addEventListener("touchstart",this.handleDragStart.bind(this),!1),this.editorCanvas.addEventListener("touchmove",function(e){return t.handleDrag(e,!0)},!1),this.editorCanvas.addEventListener("touchend",function(e){return t.handleDrag(e,!1)}))},e.prototype.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},e.prototype.keepInside=function(t,e){return"Fit"===this.props.imageScaling&&e<256?(256-e)/2:t>0?0:t+e<256?256-e:t},e.prototype.handleZoomSlider=function(t){!this.state.image||this.state.maximumScale<1||this.zoom(t-this.state.relativeScale,128,128,!1)},e.prototype.newScaledPosition=function(t,e,n,o){var i=t+(e-t)*o/this.state.absoluteScale,a=o*n/this.state.maximumScale;return this.keepInside(i,a)},e.prototype.zoom=function(t,e,n,i){var a=this;if(void 0===i&&(i=!0),this.state.image&&!(this.state.maximumScale<1)){var r=Math.min(1,Math.max(0,this.state.relativeScale+t));if(r!==this.state.relativeScale){var s=Math.exp(r*Math.log(this.state.maximumScale));this.setState(function(t,l){var p=s<=1,u=s>=t.maximumScale;return i&&(p||u)&&a.props.onRefocus(),Object(o.l)(t,{absoluteScale:s,relativeScale:r,zoomOutDisabled:p,zoomInDisabled:u,xpos:a.newScaledPosition(e,a.state.xpos,a.state.naturalWidth,s),ypos:a.newScaledPosition(n,a.state.ypos,a.state.naturalHeight,s)})}),this.props.onUpdate()}}},e.prototype.handleWheel=function(t){if(this.state.image){this.stopEventDefaults(t);var e=t.deltaY>0?-1:1,n=this.rotate(t.offsetX,t.offsetY,this.state.orientation),o=n.x,i=n.y;this.zoom(at(this.state.stepSize,.05,.1)*e,o,i)}},e.prototype.handleDragStart=function(t){var e=rt(t),n=e[0],i=e[1],a=this.rotate(n,i,this.state.orientation),r=a.x,s=a.y;this.state.image&&(this.stopEventDefaults(t),this.setState(function(t,e){return Object(o.l)(t,{moving:!0,lastMouseX:r,lastMouseY:s})}))},e.prototype.handleDrag=function(t,e){this.stopEventDefaults(t);var n=rt(t),i=n[0],a=n[1],r=this.rotate(i,a,this.state.orientation),s=r.x,l=r.y;if(this.state.image&&this.state.moving){var p=this.keepInside(this.state.xpos+(s-this.state.lastMouseX),this.state.naturalWidth*this.state.absoluteScale/this.state.maximumScale),u=this.keepInside(this.state.ypos+(l-this.state.lastMouseY),this.state.naturalHeight*this.state.absoluteScale/this.state.maximumScale);(this.state.xpos!==p||this.state.ypos!==u)&&this.props.onUpdate(),this.setState(function(t,n){return Object(o.l)(t,{moving:e,xpos:p,ypos:u,lastMouseX:s,lastMouseY:l})})}},e.prototype.handleDragEnter=function(t){this.stopEventDefaults(t),this.editorCanvas&&(this.editorCanvas.style.outline="1px solid purple")},e.prototype.handleDragLeave=function(t){this.stopEventDefaults(t),this.editorCanvas&&(this.editorCanvas.style.outline="none")},e.prototype.handleFileDrop=function(t){this.handleDragLeave(t),t.dataTransfer&&this.props.onFileSelected(t.dataTransfer.files[0])},e.prototype.onKeyboardHandler=function(t){var e=this;switch(t.key){case"+":return this.zoom(this.state.stepSize,128,128,!1);case"-":return this.zoom(-this.state.stepSize,128,128,!1)}var n=(t.which===V.a.left?1:t.which===V.a.right&&-1)||0,i=(t.which===V.a.up?1:t.which===V.a.down&&-1)||0,a=this.rotate(n,i,this.state.orientation),r=a.x,s=a.y;this.state.image&&this.setState(function(t,n){var i=r*t.naturalWidth/100,a=s*t.naturalHeight/100;return Object(o.l)(t,{xpos:e.keepInside(t.xpos+i,t.naturalWidth*t.absoluteScale/t.maximumScale),ypos:e.keepInside(t.ypos+a,t.naturalHeight*t.absoluteScale/t.maximumScale)})})},e}(F.Component),lt=n(1398),pt=n(1709),ut=Object(tt.c)(function(t){var e=t.palette;return Object($.cb)({picker:t.fonts.medium,uploadHeader:t.fonts.xLarge,messageBarText:t.fonts.medium},{modal:{width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button":{height:32,border:"none"},"#lpc-photo-picker .ms-Button--default":{marginLeft:0,backgroundColor:e.neutralLighter},"#lpc-photo-picker .ms-Button--icon &hover":{color:e.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:e.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:e.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:e.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:e.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:e.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:e.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:e.neutralTertiaryAlt}}},picker:{padding:32,overflow:"hidden"},header:{display:"flex",alignContent:"space-between"},uploadHeader:{color:e.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},messageBar:{margin:"7px 0"},messageBarText:{color:e.neutralPrimary},fileInput:{display:"none"},fileInputButton:{color:e.themePrimary,padding:0,margin:"0 0 12px -4px"},closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"},endActions:{alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:90,padding:"0px 16px"}}}})}),ct=function(t){var e=ut(t.theme),n="UNKNOWN"===t.warning,o="IMAGE_TOO_SMALL_ERROR"===t.warning,i=n||o?lt.a.error:lt.a.warning,a=n?void 0:t.onDismiss;return F.createElement(pt.a,{className:e.messageBar,messageBarType:i,onDismiss:a,isMultiline:!0,"aria-live":"polite",role:"region"},F.createElement("div",{className:e.messageBarText},t.warningText))},dt=function(){var t=function(e,n){return(t=D.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?O()(n):(o.prototype=n.prototype,new o)}}(),ht=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var n=.5/e(1);return function(t){return t<=0?0:t>1?1:n*e(2*t-1)+.5}}(5),mt=function(t){function e(e){var n=t.call(this,e)||this;return n.editCanvas=null,n.fileInput=null,n.focusTrap=null,n.primaryButton=null,n.handleOnRemoveButtonClicked=function(){n.props.onLoadedEmptyImage()},n.handleOnSaveButtonClicked=function(){switch(n.props.status){case"SUCCESS":return n.props.onDone(),n.props.onDismiss();default:if(!n.editCanvas)return;var t=n.editCanvas.getImageDataUrlFromCanvas();n.props.onStartUpload(performance.now(),t,n.props.onUpload)}},n.handleUploadAnimation=function(){"IN_PROGRESS"===n.props.status&&n.props.onUploadProgress(performance.now())},n.handleOnCancelButtonClicked=function(){n.props.onCancel(),n.props.onDismiss()},n.handleOnCloseButtonClicked=function(){n.props.onClose(),n.props.onDismiss()},n.state={isUploadedPhotoTooSmall:!1},n}return dt(e,t),e.prototype.render=function(){var t,e,n=this,o=ut(this.props.theme),i=this.getSaveButtonText(this.props.status),a=this.getWarningText(this.props.warning),r=Object(W.b)({text:this.props.personDisplayName}),s=Object(j.a)(this.props.personDisplayName,Object(z.a)()),l=F.createElement(F.Fragment,null,!this.props.isComponentInline&&F.createElement(N.a,{className:o.closeButton,iconProps:{iconName:"Cancel"},onClick:this.handleOnCloseButtonClicked,title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),!this.props.hideUploadHeader&&F.createElement("div",{className:o.header,id:"dialogTitle",role:"heading","aria-level":1},F.createElement("div",{className:o.uploadHeader},this.props.strings.uploadHeader)),a&&F.createElement(ct,{theme:this.props.theme,warning:this.props.warning,status:this.props.status,warningText:a,onDismiss:this.props.onDismissInfoBar}),this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:F.createElement(F.Fragment,null,F.createElement("input",{role:"button",className:o.fileInput,type:"file",ref:function(t){return n.fileInput=t},onClick:function(t){return t.currentTarget.value=""},onChange:function(t){return t.currentTarget.files&&n.props.onFileSelected(t.currentTarget.files[0])},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),F.createElement(B.a,{className:o.fileInputButton,iconProps:{iconName:"Add"},onClick:function(){n.fileInput&&n.fileInput.click(),n.props.onUploadNewPhoto()}},this.props.strings.upload)),F.createElement(st,{theme:this.props.theme,ref:function(t){return n.editCanvas=t},dataUrl:this.props.dataUrl,initials:s,textboyColor:r,progress:this.props.progress,warning:a,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return n.setState({isUploadedPhotoTooSmall:t})},onFileSelected:this.props.onFileSelected,onRefocus:function(){return n.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.props.onCanvasUpdated,isComponentInline:this.props.isComponentInline||!1,customBackgroundColor:this.props.customBackgroundColor}),this.props.strings.imageEditorDescription,!this.props.hideButtons&&F.createElement("div",{className:o.endActions},F.createElement(A.a,{disabled:!this.props.isUpdated||"IN_PROGRESS"===this.props.status||this.state.isUploadedPhotoTooSmall,onClick:this.handleOnSaveButtonClicked,"data-log-name":"PhotoPickerOkay",componentRef:function(t){return n.primaryButton=t}},i),this.props.progress>0?null:F.createElement(L.a,{onClick:this.handleOnCancelButtonClicked,"data-log-name":"PhotoPickerCancel"},this.props.strings.cancel),this.props.isImageRemovable&&F.createElement(B.a,{className:o.removeButton,iconProps:{iconName:"Delete"},onClick:this.handleOnRemoveButtonClicked,"data-log-name":"PhotoPickerDelete"},this.props.strings.remove)),null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto}));return F.createElement("div",null,this.props.isComponentInline&&F.createElement("div",{id:"lpc-photo-picker",className:o.picker},l),!this.props.isComponentInline&&F.createElement(M.a,{className:"lpc_nested_popup",containerClassName:o.modal,isOpen:!0,onDismiss:this.props.onDismiss,titleAriaId:"dialogTitle"},F.createElement(T.a,{id:"lpc-photo-picker",className:o.picker,componentRef:function(t){return n.focusTrap=t},firstFocusableSelector:o.fileInputButton},l)))},e.prototype.componentDidMount=function(){var t=this;this.loadCurrentImage(),requestAnimationFrame(function(){return t.focusTrap&&t.focusTrap.focus()})},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(k.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.loadCurrentImage=function(){var t=this,e=new Image;e.crossOrigin="Anonymous",e.onload=function(){return t.profileImageLoaded(e)},e.onerror=function(){return t.profileImageLoadFailed()},e.src=this.props.personImageUrl},e.prototype.profileImageLoaded=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight;var n=e.getContext("2d");n?(n.drawImage(t,0,0),this.props.onLoadedCurrentImage(G(e,this.props.isComponentInline),!!this.props.isSuggestedPhoto)):this.props.onError("UNSUPPORTED_BROWSER")},e.prototype.profileImageLoadFailed=function(){this.props.onLoadedEmptyImage()},e}(F.Component);var ft=Object(R.a)(Object(H.c)(function(t,e){var n=_.getSelectors(t),o=0;switch(n.status){case"IN_PROGRESS":var i=n.uploadDuration/2e3;o=.999999*ht(i);break;case"SUCCESS":o=1;break;case"READY":case"SOMETHING_WENT_WRONG":o=0;break;default:Object(k.a)(n.status)}return{dataUrl:n.dataUrl,initialImage:n.currentImageDataUrl,warning:n.warning,status:n.status,isUpdated:n.isUpdated,progress:o}},function(t){return{onDismissInfoBar:function(){return t(E())},onError:function(e){return t(y({warning:e}))},onUploadNewPhoto:function(){return t(d())},onFileSelected:function(e){return function(t,e){var n=new FileReader,o=function(){return t(y({warning:"NOT_AN_IMAGE"}))};n.onerror=o,n.onloadend=function(){var e=document.createElement("img");e.onerror=o,e.onload=function(){return t(v({dataUrl:e.src}))},e.src=String(n.result)},n.readAsDataURL(e)}(t,e)},onCancel:function(){return t(p())},onClose:function(){return t(u())},onDone:function(){return t(c())},onImageEditPaneDismissed:function(){return t(h())},onImageUpdated:function(){return t(m())},onLoadedCurrentImage:function(e,n){return t(f({dataUrl:e,isSuggestedPhoto:n}))},onLoadedEmptyImage:function(){return t(g())},onStartUpload:function(e,n,o){return function(t,e,n,o){t(S({now:e})),o(n,function(){return t(C({dataUrl:n}))},function(){return t(y({warning:"UNKNOWN"}))})}(t,e,n,o)},onUploadProgress:function(e){return t(b({now:e}))}}})(mt)),gt=n(791),vt=n(409),yt=n(971),St=n(1005),bt=n(60),Ct=function(){var t=function(e,n){return(t=D.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?O()(n):(o.prototype=n.prototype,new o)}}(),Et=function(){return(Et=X.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},wt=!1;function Ut(){wt||(wt=!0,Object(St.a)(void 0,{disableWarnings:!0}))}var _t=null,Pt=0,It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.componentWillMount=function(){if(Pt>=1)throw new Error("Can only mount one StandaloneProfilePhotoPicker at a time.");if(Pt+=1,Ut(),null===_t){var t=Object(bt.createStore)(Object(gt.a)([_]));_t=new vt.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){Pt-=1},e.prototype.render=function(){return _t?F.createElement(yt.a,{context:_t},F.createElement(ft,Et({},this.props))):null},e}(F.Component)}}]);