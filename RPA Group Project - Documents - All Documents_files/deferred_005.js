(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-shared-react"],{"466":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(3020),s=n(6),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},"1457":function(e,t,n){"use strict";n.r(t);var r=n(178),i=n(71),s=n(1037),o=(function(){function e(){}e.registerContentElement=function(t){if(e===Object(s.n)()){if(t!==e._contentElement){e._contentElement&&e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement=t;if(t)e._manageEventAttachment();else{e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}}}else Object(s.n)().registerContentElement(t)};e.registerCallbacks=function(t){if(e===Object(s.n)()){if(e._callbacks.indexOf(t)<0){e._callbacks.push(t);e._totalHeightDifference+=t.heightDifference;try{e._contentElement&&(e._contentElement.scrollTop-=t.heightDifference);this._isShyMode&&t.onShy()}catch(e){}e._manageEventAttachment();return!0}return!1}Object(s.n)().registerCallbacks(t)};e.unregisterCallback=function(t){if(e===Object(s.n)()){var n=e._callbacks.indexOf(t);if(n>=0){var r=e._callbacks[n];try{if(e._isShyMode){e._contentElement&&(e._contentElement.scrollTop+=r.heightDifference);r.onUnshy()}}catch(e){}e._totalHeightDifference-=r.heightDifference;e._callbacks.splice(n,1);e._manageEventAttachment();return!0}return!1}Object(s.n)().unregisterCallback(t)};e.unshy=function(){if(e===Object(s.n)()){e._onShyEventSent=!1;e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}else Object(s.n)().unshy()};e._manageEventAttachment=function(){if(e.enabled&&e._contentElement){var t=!i.e.isActivated("A2EE05E1-7A4E-4A5B-97D2-8BF10F0BC846","9/02/20","no scrollTop adjustment for anchor navigation");e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement.removeEventListener("mousedown",e._onMouseDown);e._contentElement.removeEventListener("mouseup",e._onMouseUp);t&&window.removeEventListener("hashchange",e._onHashChange);if(e._callbacks.length){e._contentElement.addEventListener("scroll",e._onScroll);e._contentElement.addEventListener("mousedown",e._onMouseDown);e._contentElement.addEventListener("mouseup",e._onMouseUp);t&&window.addEventListener("hashchange",e._onHashChange)}}};e._onScroll=function(t){e._queueScrollEvent=!0;if(!e._isMouseDown){window.clearTimeout(e._handleScrollTimeoutId);e._handleScrollTimeoutId=window.setTimeout(e._handleScroll,25)}};e._onMouseDown=function(t){e._isMouseDown=!0};e._onMouseUp=function(t){e._isMouseDown=!1;e._queueScrollEvent&&e._handleScroll()};e._onHashChange=function(t){e._hashChangedRecently=!0;window.clearTimeout(e._handleHashChangeTimeoutId);e._handleHashChangeTimeoutId=window.setTimeout(function(){e._hashChangedRecently=!1},500)};e._handleScroll=function(){if(e._queueScrollEvent){e._queueScrollEvent=!1;var t=e._contentElement.scrollTop-e._lastScrollPosition;if(t>=0&&!e._isShyMode){e._scrolledAmountConsecutively>=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(e._scrolledAmountConsecutively>e.scrollThresholdDown&&e._contentElement.scrollTop-e._totalHeightDifference>e.scrollThresholdDown){if(!e._onShyEventSent){e._onShyEventSent=!0;Math.random()<.01&&r.e.logData({name:"ShyConductor.OnShy"})}e._isShyMode=!0;e._callbacks.forEach(function(e){try{e.onShy()}catch(e){}});e._hashChangedRecently?r.e.logData({name:"ShyConductor.HashNavNoAutoscrollShy"}):e._contentElement.scrollTop-=e._totalHeightDifference}}else if(t<0&&e._isShyMode){e._scrolledAmountConsecutively<=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(-e._scrolledAmountConsecutively>e.scrollThresholdUp||e._contentElement.scrollTop<e.scrollThresholdDown){e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}});e._hashChangedRecently?r.e.logData({name:"ShyConductor.HashNavNoAutoscrollUnshy"}):e._contentElement.scrollTop+=e._totalHeightDifference}}e._lastScrollPosition=e._contentElement.scrollTop}};e.scrollThresholdDown=300;e.scrollThresholdUp=500;e.enabled=!0;e._callbacks=[];e._totalHeightDifference=0;e._isShyMode=!1;e._lastScrollPosition=0;e._scrolledAmountConsecutively=0;e._isMouseDown=!1;e._queueScrollEvent=!1;e._hashChangedRecently=!1;e._onShyEventSent=!1;return e})();t.default=o;Object(s.n)()||(window[s.e]=o)},"1779":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n("react-lib");function s(e,t,n,s){var o=e.split("{0}");s=Object(r.__assign)({key:"key"},s||{});return[o[0],i.createElement(n,s,t),o[1]]}},"1872":function(e,t,n){"use strict";var r=n(0),i=n(54),s=n(73),o=n(2339),u=n(449),a=n(3460),f=n(4565),l=n(188),c=n(222),h=n(2585),p=n(664),d=n(1144),v=n(1375),m=n(4232),g=n(55),y=(function(){function e(t){var n,s=this;this.removePreviewTheme=function(){s.previewTheme(e.OriginalOptions.theme);e.PreviewOptions.theme=e.OriginalOptions.theme};this.previewTheme=function(t){var n,i,o,a,f,l,c=(null===(n=t)||void 0===n?void 0:n.backgroundImageUri)?'url("'+t.backgroundImageUri+'")':"none",h=(null===(o=null===(i=t)||void 0===i?void 0:i.theme)||void 0===o?void 0:o.backgroundOverlay)||"",p=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e._getGeneratedThemeColors(null===(a=t)||void 0===a?void 0:a.theme)),null===(f=t)||void 0===f?void 0:f.theme),{backgroundImageUri:c,backgroundOverlay:h});Object(u.t)({palette:p,isInverted:!!(null===(l=t)||void 0===l?void 0:l.isInverted)});e.PreviewOptions.theme=t;s.previewHeaderEmphasis(e.PreviewOptions.chromeOptions.header.emphasis)};this.getAvailableThemesPromise=function(){return i.n.all([s._getAllThemes(),s.getCurrentTheme(!1)]).then(function(t){e.OriginalOptions.theme=t[1];e.PreviewOptions.theme=e.PreviewOptions.theme||t[1];return Object(r.__assign)(Object(r.__assign)({},t[0]),{currentTheme:e.OriginalOptions.theme})})};this.getLoadingThemes=function(){return s._loadingThemes};this.getCurrentTheme=function(t){if(t){e.OriginalOptions.theme=null;s._originalThemePromise=s._loadAndRememberCurrentTheme(!0);return s._originalThemePromise}if(e.OriginalOptions.theme)return i.n.resolve(e.OriginalOptions.theme);s._originalThemePromise||(s._originalThemePromise=s._loadAndRememberCurrentTheme(!0));return s._originalThemePromise};this.saveTheme=function(){var t,n=e.PreviewOptions.theme;if(!(null===(t=n)||void 0===t?void 0:t.theme))return i.n.resolve();var o={};for(var u in n.theme)o[u]=l.e.fromHtmlColor(n.theme[u]);var a={name:n.name,theme:{backgroundImageUri:n.backgroundImageUri||"",palette:o,cacheToken:"",isDefault:!0,isInverted:n.isInverted,version:""}};return s._tenantThemeProvider.setTheme(a).then(function(t){e.OriginalOptions.theme=Object(r.__assign)(Object(r.__assign)({},n),{name:h.e.currentTheme});e.PreviewOptions.theme=Object(r.__assign)(Object(r.__assign)({},n),{name:h.e.currentTheme});return t})};this.getColorThemes=function(e,t){return Object(o.r)(e,t)};this.getAccentColors=function(e){return Object(o.e)(e)};this.previewHeaderEmphasis=function(t,n){var r,i;e.PreviewOptions.chromeOptions.header.emphasis=t||p.e.None;Object(d.e)(t,n||{palette:null===(r=e.PreviewOptions.theme)||void 0===r?void 0:r.theme,isInverted:!!(null===(i=e.PreviewOptions.theme)||void 0===i?void 0:i.isInverted)})};this.previewDiffNewChromeOptions=function(t){for(var n in t)e.PreviewOptions.chromeOptions[n]=Object(r.__assign)(Object(r.__assign)({},e.PreviewOptions.chromeOptions[n]),t[n]);c.e.applySettings({chromeOptions:e.PreviewOptions.chromeOptions});s.previewHeaderEmphasis(e.PreviewOptions.chromeOptions.header.emphasis)};this.previewFooterOptionsChange=function(t){e.PreviewOptions.footerLinks=Object(r.__spreadArrays)(t);c.e.applySettings({footerLinks:e.PreviewOptions.footerLinks})};this.previewLogo=function(e,t){t?s._updateLogoPreview(t):e?m.e.readFile(e).then(function(e){s._updateLogoPreview(e)}):s._updateLogoPreview(null)};this.previewBackgroundImage=function(e,t){t?s._updateBackgroundPreview(t):e?m.e.readFile(e).then(function(e){s._updateBackgroundPreview(e)}):s._updateBackgroundPreview(null)};this.previewBackgroundImageFocalPoint=function(e){s._updateBackgroundFocalPoint(e)};this.savingOptions=function(){e.OriginalOptions=JSON.parse(JSON.stringify(e.PreviewOptions));s.cancelPreview()};this.cancelPreview=function(){var t,n;c.e.applySettings({chromeOptions:e.OriginalOptions.chromeOptions});c.e.applySettings({footerLinks:e.OriginalOptions.footerLinks});s.removePreviewTheme();Object(d.e)(e.OriginalOptions.chromeOptions.header.emphasis,{palette:null===(t=e.OriginalOptions.theme)||void 0===t?void 0:t.theme,isInverted:!!(null===(n=e.OriginalOptions.theme)||void 0===n?void 0:n.isInverted)});s._updateLogoPreview(e.OriginalOptions.logoUrl,!e.OriginalOptions.logoCustomized);if(g.n.isFeatureEnabled({ODB:672})){s._updateBackgroundPreview(e.OriginalOptions.backgroundUrl,!e.OriginalOptions.backgroundCustomized);s._updateBackgroundFocalPoint(e.OriginalOptions.backgroundFocalPoint)}e.PreviewOptions=JSON.parse(JSON.stringify(e.OriginalOptions))};this._loadAndRememberCurrentTheme=function(t){return s._themeProvider.loadFullFormattedThemeData(t).then(function(t){var n={name:h.e.currentTheme,theme:t&&t.palette};e.OriginalOptions.theme=n;e.PreviewOptions.theme=e.PreviewOptions.theme||n;s._originalThemePromise=null;return n})};this._getAllThemes=function(){return s._tenantThemeProvider.getTenantThemingOptions().then(function(e){var t=[];e.themes.forEach(function(e){t.push({name:e.name,isInverted:e.theme.isInverted,backgroundImageUri:e.theme.backgroundImageUri,theme:s._convertPaletteToHTMLStrings(e.theme.palette),error:e.error})});return{defaultThemes:e.hideDefaultThemes?null:s._getDefaultThemes(),customThemes:t}})};this._convertPaletteToHTMLStrings=function(e){var t={};for(var n in e)e[n]&&(t[n]=l.e.toHtmlString(e[n]));return t};this._getDefaultThemes=function(){var e=Object(o.n)(),t=[];if(h.e)for(var n in h.e)if(e[n]){e[n].name=h.e[n];e[n].extraData={isOutOfBoxTheme:!0};t.push(e[n])}return t};this._updateLogoPreview=function(t,n){void 0===n&&(n=!1);e.PreviewOptions.logoCustomized=!n;e.PreviewOptions.logoUrl=n?void 0:t;c.e.applySettings({logoPreview:e.PreviewOptions.logoUrl,hasLogoPreview:e.PreviewOptions.logoCustomized})};this._updateBackgroundPreview=function(t,n){void 0===n&&(n=!1);e.PreviewOptions.backgroundCustomized=!n;e.PreviewOptions.backgroundUrl=n?void 0:t;c.e.applySettings({backgroundPreview:e.PreviewOptions.backgroundUrl,hasBackgroundPreview:e.PreviewOptions.backgroundCustomized})};this._updateBackgroundFocalPoint=function(t){e.PreviewOptions.backgroundFocalPoint=t;c.e.applySettings({backgroundFocalPoint:e.PreviewOptions.backgroundFocalPoint})};var y=Object(v.e)(t.pageContext),b=c.e.getSettings(["chromeOptions"]).chromeOptions;if(b)for(var w in y)y[w]=Object(r.__assign)(Object(r.__assign)({},y[w]),b[w]);e.OriginalOptions={chromeOptions:y,theme:void 0,logoUrl:c.e.getSettings(["logoPreview"]).logoPreview,logoCustomized:c.e.getSettings(["hasLogoPreview"]).hasLogoPreview,footerLinks:c.e.getSettings(["footerLinks"]).footerLinks,backgroundUrl:c.e.getSettings(["backgroundPreview"]).backgroundPreview,backgroundCustomized:c.e.getSettings(["hasBackgroundPreview"]).hasBackgroundPreview,backgroundFocalPoint:(null===(n=t.pageContext)||void 0===n?void 0:n.focalPoint)||{x:50,y:50}};e.PreviewOptions=JSON.parse(JSON.stringify(e.OriginalOptions));this._themeProvider=t.themeProvider?t.themeProvider:Object(a.e)(t.pageContext);this._tenantThemeProvider=t.TenantThemesProvider?t.TenantThemesProvider:new f.e({pageContext:t.pageContext});this._originalThemePromise=this._loadAndRememberCurrentTheme(!0)}e._getGeneratedThemeColors=function(e){return e?{primaryBackground:e.PageBackground||e.backgroundColor,primaryText:e.primaryText||e.neutralPrimary,backgroundOverlay:e.BackgroundOverlay,suiteBarBackground:e.SuiteBarBackground||e.themePrimary,suiteBarText:e.SuiteBarText||e.white,suiteBarDisabledText:e.SuiteBarDisabledText||e.neutralLight,topBarBackground:e.TopBarBackground||e.neutralLight,topBarText:e.TopBarText||e.neutralSecondary,topBarHoverText:e.TopBarHoverText||e.neutralPrimary,dialogBorder:e.DialogBorder||e.neutralLighter}:{}};return e})(),b=n(74),w=n(31),E=n(178),S=n(3459),x=n(2575),T=n(20),N=n(3866),C=n(3867),k=n(4234),L=n(1770),A=n(703),O=n(4233),M=n(3864),_=n(4157),D=n(2232),P=n(71),H=n(2090);var B=n(1929),j=n(42);n.d(t,"e",function(){return q});var F={ODB:1067},I={ODB:672},q=(function(){function e(e){var t=this;this.getRenderProps=function(){var e=t._canEditCurrentTheme(),n=t._getEditingThemeProps(),r=n.colorThemes,i=n.accentColorMap,s=t._isThemeLocked(),o=s?T.format(S.e.themeLockedText,t._hubSiteName):void 0,u=function(n){var u=n.customThemes,a=n.defaultThemes,f=[y.OriginalOptions.theme];s||(f=u);return{themeCustomizerProps:{themes:f,onThemeClick:t._onThemeClick,onUneditableThemeClick:t._onUneditableThemeClick,isThemeLocked:s,themeLockedText:o,errorText:t._errorText,onEditThemeClick:t._onEditThemeClick,currentlyAppliedTheme:y.OriginalOptions.theme,defaultThemes:a,currentThemeEditable:e,currentlySelectedTheme:y.PreviewOptions.theme,editingTheme:t._editingTheme,colorThemes:r,accentColorMap:i},headerCustomizerProps:{options:y.PreviewOptions.chromeOptions.header,onChange:t._themeManager.previewDiffNewChromeOptions,onLogoChange:t._onLogoChange,onRectLogoChange:t._onRectLogoChange,onBackgroundImageChange:t._onBackgroundImageChange,imageUrls:t._params.headerImageUrls,onHeaderEmphasisChanged:t._onHeaderEmphasisChanged,selectedEmphasis:y.PreviewOptions.chromeOptions.header.emphasis,pageContext:t._pageContext,onHideTitleChange:t._themeManager.previewDiffNewChromeOptions,selectedLogoAlignment:y.PreviewOptions.chromeOptions.header.logoAlignment,onBackgroundImageFocalPointChange:t._onBackgroundImageFocalPointChange},pageContext:t._pageContext,onSave:t._onSave,saveEnabled:!0,onCancel:t._onCancel,isOpen:t._isOpen,onDismiss:t._onDismiss,changeTheLookPageLink:t._getClassicChangeTheLookUrl(),isLoading:t._loading,isSaving:t._saving,onBackButtonClick:t._onBackClick,renderL2PanelType:t._renderL2PanelType,renderL3PanelType:t._renderL3PanelType,chromeOptions:y.PreviewOptions.chromeOptions,onChromeOptionsChanged:t._themeManager.previewDiffNewChromeOptions,onEditChromeOptionsClick:t._onEditChromeOptionsClick,onFooterTranslationClick:t._onFooterTranslationClick,onFooterLinksEditClicked:t._onFooterLinksEditClicked,exitL3Panel:t._exitL3Panel,footerOptions:t._currFooterOptions,onFooterOptionsChanged:t._onFooterOptionsChanged,footerTitleKey:t._footerTitleKey,footerTitleCurrentLCID:t._footerTitleCurrentLCID,emptyImageUrl:t._params.emptyImageUrl,isHubSite:t._pageContext.isHubSite,navImageUrls:t._params.navImageUrls}},a=new b.e({name:"ChangeTheLookPanelStateManager.LoadThemes"});return t._themeManager.getAvailableThemesPromise().then(function(e){var n=[];if(e.defaultThemes&&e.defaultThemes.length)for(var r=0,i=e.defaultThemes;r<i.length;r++){(l=i[r]).error?t._errorText=S.e.errorFetchingThemes:n.push(l)}var s=[];if(e.customThemes&&e.customThemes.length)for(var o=0,f=e.customThemes;o<f.length;o++){var l;(l=f[o]).error?t._errorText=S.e.errorFetchingThemes:s.push(l)}a.end({resultType:w.e.Success});return u({currentTheme:e.currentTheme,customThemes:s,defaultThemes:n})},function(e){a.end({resultType:w.e.Failure,error:"There was an error while loading the themes: "+JSON.stringify(e)});t._errorText=S.e.errorFetchingThemes;return u({currentTheme:y.PreviewOptions.theme,customThemes:[],defaultThemes:[]})})};this._onDismiss=function(){if(t._isOpen){t._isOpen=!1;E.e.logData({name:"ChangeTheLookPanelStateManager.Cancel.Click"});var e=new b.e({name:"ChangeTheLookPanelStateManager.CancelClick"});try{t._themeManager.cancelPreview();e.end({resultType:w.e.Success})}catch(t){e.end({resultType:w.e.Failure,error:t})}t._updateStateWithRenderProps(function(){return t._verifyAndCallFunction(t._params.onDismiss)})}};this._onSave=function(){var e,n,o=new b.e({name:"ChangeTheLookPanelStateManager.SaveTheme"}),u=[];void 0!==t._renderL2PanelType&&E.e.logData({name:"ChangeTheLookPanelStateManager.Save"+t._renderL2PanelType+".Click"});t._themeManager.savingOptions();var a=!P.e.isActivated("CF518056-C2F2-486A-95F4-62664AAE0349","04/21/2020","ThemeProvider error logging")&&t._isServerVersionAtLeast("16.0.20020.12764");if(a){var f=g.n.isFeatureEnabled(F),l=y.PreviewOptions.chromeOptions,c={headerLayout:l.header.layout,headerEmphasis:l.header.emphasis,megaMenuEnabled:l.nav.megaMenuEnabled,footerEnabled:!l.footer.hidden,footerLayout:l.footer.layout,footerEmphasis:l.footer.emphasis,hideTitleInHeader:f?l.header.hideTitle:void 0,logoAlignment:l.header.logoAlignment};u.push(function(){return t._chromeOptionsDataSource.setChromeOptions(c).then(function(){return t._getLogoSaverPromise()})})}else{u.push(function(){return t._chromeOptionsDataSource.setNavMegaMenu(y.PreviewOptions.chromeOptions.nav.megaMenuEnabled)});u.push(function(){return t._chromeOptionsDataSource.setFooterVisibility(!y.PreviewOptions.chromeOptions.footer.hidden).then(function(){return t._getLogoSaverPromise()})});u.push(function(){return t._chromeOptionsDataSource.setHeaderLayout(y.PreviewOptions.chromeOptions.header.layout)})}t._logoEdited&&u.push((function(e){var t=e.imageFile,n=e.pageContext;if(Object(s.s)(n)){var r=new _.e({pageContext:n});return function(){if(t){if(-1===D.n.indexOf(t.type))throw new Error(H.e.setLogoUnsupportedTypeError);if(t.size>D.e)throw new Error(H.e.setLogoTooBigError);return r.setGroupImage(t).catch(function(e){throw e&&e.status&&404===e.status?new Error(H.e.setLogo404Error):new Error(H.e.setLogoGenericError)})}}}var i=new M.e(n);if(t){var o="__sitelogo__"+t.name;return function(){return Object(L.e)(new O.e(n),i,o,t).then(function(e){return P.e.isActivated("bedcb6d9-f854-4548-8b3f-a4e9344d97ef","01/14/2021","Switch to SetSiteLogo API")?i.setBasicWebProperties({siteLogoUrl:Object(s.r)(n)+e.serverRelativeUrl}):i.setSiteLogo(e.serverRelativeUrl,0,0)})}}if(null===t)return P.e.isActivated("bedcb6d9-f854-4548-8b3f-a4e9344d97ef","01/14/2021","Switch to SetSiteLogo API")?function(){return i.setBasicWebProperties({siteLogoUrl:""})}:function(){return i.setSiteLogo("",0,0)}})({imageFile:t._newSiteLogo,pageContext:t._pageContext}));if(g.n.isFeatureEnabled(F)){t._rectLogoEdited&&u.push((function(e,t){var n=new M.e(t);if(e){var r="__rectSitelogo__"+e.name;return function(){return Object(L.e)(new O.e(t),n,r,e).then(function(e){return n.setSiteLogo(e.serverRelativeUrl,0,1)})}}if(null===e)return function(){return n.setSiteLogo("",0,1)}})(t._newRectSiteLogo,t._pageContext));a||u.push(function(){return t._chromeOptionsDataSource.setTitleVisibility(y.PreviewOptions.chromeOptions.header.hideTitle)})}g.n.isFeatureEnabled(I)&&t._backgroundImageEdited&&u.push((function(e,t,n){var r=new M.e(n);if(e){var i="__extendedHeaderBackgroundImage__"+e.name;return function(){return Object(L.e)(new O.e(n),r,i,e).then(function(e){var n,i;r.setSiteLogo(encodeURIComponent(e.serverRelativeUrl),2,0,null===(n=t)||void 0===n?void 0:n.x,null===(i=t)||void 0===i?void 0:i.y)})}}return null===e?function(){return r.setSiteLogo("",2)}:function(){var e,n;return r.setSiteLogo("",2,0,null===(e=t)||void 0===e?void 0:e.x,null===(n=t)||void 0===n?void 0:n.y,!0)}})(t._newBackgroundImage,t._backgroundFocalPoint,t._pageContext));!P.e.isActivated("e04142b5-2f68-499c-b44f-60e54d1c82a1")&&Object(A.e)(t._pageContext)&&j.e.hasPermission(t._pageContext.webPermMasks,j.e.manageWeb)&&u.push(function(){return t._webDataSource.setBasicWebProperties({quickLaunchEnabled:y.PreviewOptions.chromeOptions.nav.quickLaunchEnabled})});if(!a){u.push(function(){return t._chromeOptionsDataSource.setFooterLayout(y.PreviewOptions.chromeOptions.footer.layout)});u.push(function(){return t._chromeOptionsDataSource.setFooterEmphasis(y.PreviewOptions.chromeOptions.footer.emphasis)})}E.e.logData({name:"ChangeTheLookPanelStateManager.SaveTheme.Click",extraData:Object(r.__assign)(Object(r.__assign)({},null===(e=y.PreviewOptions.theme)||void 0===e?void 0:e.extraData),{isInverted:null===(n=y.PreviewOptions.theme)||void 0===n?void 0:n.isInverted})});a||u.push(function(){return new N.e(t._pageContext).setHeaderEmphasis(y.PreviewOptions.chromeOptions.header.emphasis).then(function(e){t._pageContext.headerEmphasis=Number(y.PreviewOptions.chromeOptions.header.emphasis)})});t._loading=!0;t._saving=!0;t._updateStateWithRenderProps();u.push(function(){return new i.n(function(e){t._updateStateWithRenderProps(function(){t._themeBeingEdited&&(t._themeBeingEdited=y.PreviewOptions.theme);t._themeManager.saveTheme().then(function(n){t._pageContext.themedCssFolderUrl=n;o.end({resultType:w.e.Success});e()},function(t){o.end({resultType:w.e.Failure,error:t});e()})})})});return i.n.serial(u).then(function(){t._logoEdited=!1;t._rectLogoEdited=!1;t._backgroundImageEdited=!1;t._verifyAndCallFunction(t._params.onSave)}).catch(function(e){i.n.reject(e);e&&e.message&&(t._errorText=e.message.value||e.message)}).then(function(){t._loading=!1;t._saving=!1;t._updateStateWithRenderProps()})};this._onCancel=function(){t._onDismiss()};this._onFooterTranslationClick=function(){t._renderL3PanelType="MUIEditing";t._updateStateWithRenderProps()};this._exitL3Panel=function(e,n,r){void 0===e&&(e=!1);t._renderL3PanelType="";if(e){var i=new b.e({name:"ChangeTheLookPanelStateManager.ExitL3"});try{t._themeManager.cancelPreview();n&&t._onFooterOptionsChanged({name:n,translatedTitles:r});i.end({resultType:w.e.Success})}catch(e){i.end({resultType:w.e.Failure,error:e})}}t._updateStateWithRenderProps()};this._onFooterLinksEditClicked=function(e){t._verifyAndCallFunction(t._params.onFooterLinksEditClicked)};this._onThemeClick=function(e,n){var r;if("Theme"===t._renderL2PanelType&&t._editingTheme){r=new b.e({name:"ChangeTheLookPanelStateManager.EditThemePreviewClick"});E.e.logData({name:"ChangeTheLookPanelStateManager.EditThemePreview.Click"})}else{r=new b.e({name:"ChangeTheLookPanelStateManager.PreviewThemeClick"});E.e.logData({name:"ChangeTheLookPanelStateManager.PreviewTheme.Click"})}if(n){y.PreviewOptions.theme=n;t._updateStateWithRenderProps(function(){try{t._themeManager.previewTheme(n);r.end({resultType:w.e.Success})}catch(e){r.end({resultType:w.e.Failure,error:"There was an error attempting to preview the theme"});t._errorText=S.e.errorPreviewingTheme;t._updateStateWithRenderProps()}})}else{r.end({resultType:w.e.Failure,error:"No theme was provided to preview"});t._errorText=S.e.errorPreviewingTheme;t._updateStateWithRenderProps()}};this._onEditThemeClick=function(e){E.e.logData({name:"ChangeTheLookPanelStateManager.EditTheme.Click"});t._editingTheme=!0;t._themeBeingEdited=y.PreviewOptions.theme;e.stopPropagation();t._updateStateWithRenderProps()};this._onEditChromeOptionsClick=function(e){t._renderL2PanelType=e.currentTarget.dataset.chromeType;e.stopPropagation();t._updateStateWithRenderProps()};this._onBackClick=function(e){if("Theme"===t._renderL2PanelType&&t._editingTheme){var n=new b.e({name:"ChangeTheLookPanelStateManager.ExitEditThemeClick"});E.e.logData({name:"ChangeTheLookPanelStateManager.ExitEditTheme.Click"});t._editingTheme=!1;t._themeBeingEdited=null;n.end({resultType:w.e.Success})}else{E.e.logData({name:"ChangeTheLookPanelStateManager.Exit"+t._renderL2PanelType+".Click"});void 0!==t._renderL3PanelType&&""!==t._renderL3PanelType?t._renderL3PanelType="":t._renderL2PanelType=""}e.stopPropagation();t._updateStateWithRenderProps()};this._onHeaderEmphasisChanged=function(e){t._themeManager.previewHeaderEmphasis(e)};this._onLogoChange=function(e,n){t._logoEdited=!0;t._newSiteLogo=e||null;t._themeManager.previewLogo(e,n)};this._onRectLogoChange=function(e,n){t._rectLogoEdited=!0;t._newRectSiteLogo=n||null;t._themeManager.previewLogo(n,e)};this._onBackgroundImageChange=function(e,n){t._backgroundImageEdited=!0;t._newBackgroundImage=n||null;t._themeManager.previewBackgroundImage(n,e)};this._onBackgroundImageFocalPointChange=function(e){t._backgroundImageEdited=!0;t._backgroundFocalPoint=e;t._themeManager.previewBackgroundImageFocalPoint(e)};this._onFooterOptionsChanged=function(e){t._currFooterOptions=Object(r.__assign)(Object(r.__assign)({},t._currFooterOptions),e);var n,i=[];void 0!==e.logoUrl&&i.push({url:e.logoUrl,name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"});if(void 0!==e.name||void 0!==e.translatedTitles){var s=void 0;if(void 0!==e.translatedTitles){var o=B.t.getDisplayLanguage(e.translatedTitles,t._pageContext);n=o[0].code;s=t._footerTitleKey?void 0:o[1].value;t._footerTitleCurrentLCID=n}i.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",links:[{url:void 0,name:e.name,webDefaultTitle:s,currentLCID:n,translatedTitles:e.translatedTitles}]})}t._themeManager.previewFooterOptionsChange(i)};this._params=e;this._pageContext=e.pageContext;this._themeManager=new y({pageContext:e.pageContext});this._editingTheme=!1;this._renderL2PanelType="";this._renderL3PanelType="";this._isOpen=!0;this._errorText="";this._hubSiteName="";this._loading=!0;this._saving=!1;this._chromeOptionsDataSource=new C.e(this._pageContext);this._logoEdited=!1;this._rectLogoEdited=!1;this._backgroundImageEdited=!1;this._editNavDataSource=new k.e(this._pageContext);this._webDataSource=new M.e(this._pageContext);this._spListCollectionDataSource=new O.e(this._pageContext);this._currFooterOptions={};this._updateStateWithRenderProps();E.e.logData({name:"ChangeTheLookPanelStateManager.LoadPanel"})}e.prototype.componentDidMount=function(){var e=this,t=[];if(this._isThemeLocked()){var n=new x.HubDataSource(this._pageContext);t.push(n.getHubData().then(function(t){e._hubSiteName=t.name}))}t.push(this._editNavDataSource.getMenuState({menuNodeKey:"13b7c916-4fea-4bb2-8994-5cf274aeb530"}).then(function(t){for(var n=0,r=t.links;n<r.length;n++){var i=r[n];if("2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===i.name)e._currFooterOptions.logoUrl=i.url;else if("7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===i.name&&i.links&&i.links.length>0){var s=i.links[0];e._currFooterOptions.name=s.name;e._footerTitleCurrentLCID=s.currentLCID;e._footerTitleKey=s.key}if(e._currFooterOptions.name&&e._currFooterOptions.logoUrl)break}}));var r=function(){e._loading=!1;e._updateStateWithRenderProps()};i.n.all(t).then(r,r)};e.prototype.componentWillUnmount=function(){this._onDismiss()};e.prototype._updateStateWithRenderProps=function(e){var t=this;this.getRenderProps().then(function(n){t._params.updateState(n,e)})};e.prototype._isServerVersionAtLeast=function(e){var t="$$".length,n=this._pageContext&&this._pageContext.siteClientTag,r=n&&n.indexOf("$$"),i=r&&n.substr(r+t),s=i&&i.split("."),o=e&&e.split(".");if(s&&o&&4===s.length&&4===o.length){for(var u=0;u<4;u++){var a=+s[u],f=+o[u];if(f<a)return!0;if(a<f)return!1}return!0}return!1};e.prototype._getLogoSaverPromise=function(){var e=this,t=[],n=i.n.resolve();if(this._currFooterOptions.logoFile){var r="__footerlogo__"+this._currFooterOptions.logoFile.name;n=Object(L.t)(this._spListCollectionDataSource,this._webDataSource,r,this._currFooterOptions.logoFile).then(function(n){e._currFooterOptions.logoUrl=Object(s.r)(e._pageContext)+n.serverRelativeUrl;t.push({name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",url:e._currFooterOptions.logoUrl})})}else""===this._currFooterOptions.logoUrl&&t.push({name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",url:void 0,isDeleted:!0});if(void 0===this._currFooterOptions.name)t.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",isDeleted:!0});else{var o=void 0;if(void 0!==this._currFooterOptions.translatedTitles){var u=B.t.getDisplayLanguage(this._currFooterOptions.translatedTitles,this._pageContext);o=this._footerTitleKey?void 0:u[1].value}t.push({url:void 0,name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",links:[{url:void 0,name:this._currFooterOptions.name,webDefaultTitle:o,translatedTitles:this._currFooterOptions.translatedTitles}]})}return n.then(function(){return e._editNavDataSource.onSave(t,void 0,"13b7c916-4fea-4bb2-8994-5cf274aeb530").then(function(){})})};e.prototype._onUneditableThemeClick=function(){};e.prototype._getEditingThemeProps=function(){return{colorThemes:this._getColorThemes(),accentColorMap:this._getAccentColors()}};e.prototype._getColorThemes=function(){var e=this._themeBeingEdited;if(e)return this._themeManager.getColorThemes(e.isInverted,e.theme.primaryBackground)};e.prototype._getAccentColors=function(){var e=this._themeBeingEdited;if(e)return this._themeManager.getAccentColors(e.theme.primaryBackground)};e.prototype._canEditCurrentTheme=function(){var e=y.PreviewOptions.theme;if(e&&e.theme){var t=this._themeManager.getColorThemes()[e.theme.themePrimary],n=this._themeManager.getColorThemes(!0,e.theme.primaryBackground)[e.theme.themePrimary];if(t&&t.primaryBackground===e.theme.primaryBackground||n&&n.primaryBackground===e.theme.primaryBackground)return!0}return!1};e.prototype._getClassicChangeTheLookUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/designgallery.aspx"};e.prototype._verifyAndCallFunction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&"function"==typeof e&&e.apply(void 0,t)};e.prototype._isThemeLocked=function(){var e=this._pageContext,t=e.isHubSite;return e.hubSiteId&&!t};return e})()},"1887":function(e,t,n){"use strict";n.r(t);n.d(t,"SiteScriptProgressIndicator",function(){return v});var r=n(0),i=n("react-lib"),s=n(1546),o=n(94),u=n(1544),a=n(178),f=n(1900),l=n(3877),c=n(91),h=n(1074),p=n(1143),d=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("475")]).then(n.bind(null,4150))];case 1:return[2,e.sent().SiteScriptProgressPanel]}})})}),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onNewDataReceived=function(e){if(e.isSiteDesignPending&&!n._firstRunPanelExperience){a.e.logData({name:"SiteScripts.BarAppeared"});n._firstRunPanelExperience=!0}var t=!1;e.canRenderWebTemplatesGalleryFirstRun&&Object(h.n)(n.props.pageContext)&&(t=!0);n.setState({isComplete:n._siteScriptProgressStateManager.isRunComplete(e.displayedRunKey),isVisible:e.isSiteDesignPending,renderWebTemplatesGalleryFirstRun:t})};n._onOpenPanelAction=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromGear.Click"});n.state.isPanelOpen||n.setState({isPanelOpen:!0})};n._onClickOpenPanel=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromBar.Click"});n.setState({isPanelOpen:!0});e.stopPropagation();e.preventDefault()};n._onClickRefreshPage=function(e){a.e.logData({name:"SiteScripts.RefreshFromBar.Click"});window.location.href=n.props.pageContext?n.props.pageContext.webServerRelativeUrl:window.location.href};n._onPanelDismissed=function(){n.setState({isPanelOpen:!1})};n.state={isPanelOpen:!1,isComplete:!1,isVisible:!1,renderWebTemplatesGalleryFirstRun:!1};n._siteScriptProgressStateManager=f.SiteScriptProgressStateManager.getInstance({pageContext:t.pageContext});n._panelWasEverOpen=!1;n._firstRunPanelExperience=!1;return n}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressIndicator"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction,this._onOpenPanelAction)};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction)};t.prototype.render=function(){var e,t;this._panelWasEverOpen=this._panelWasEverOpen||this.state.isPanelOpen;if(this.state.isVisible||this._siteScriptProgressStateManager.getState().isSiteDesignPending)if(this.state.isComplete){3!==(c=l.e.SiteScriptProgressIndicatorCompleteText.split(/{[01]}/)).length&&(c=[l.e.SiteScriptProgressIndicatorCompleteText,"",""]);var n=i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewLink),a=i.createElement(u.e,{onClick:this._onClickRefreshPage},l.e.SiteScriptProgressIndicatorCompleteLink),f=void 0;f=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{0}")<=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{1}")?[n,a]:[a,n];t=i.createElement(s.e,{messageBarType:o.e.warning},c[0],f[0],c[1],f[1],c[2])}else{var c;2!==(c=l.e.SiteScriptProgressIndicatorIncompleteText5.split("{0}")).length&&(c=[l.e.SiteScriptProgressIndicatorIncompleteText5,""]);t=i.createElement(s.e,{messageBarType:o.e.warning},c[0],i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewProgressLink5),c[1])}else{if(this.state.renderWebTemplatesGalleryFirstRun)return i.createElement(p.e,Object(r.__assign)({},{pageContext:this.props.pageContext,imageUrls:{webTemplatesFirstRunIllustration:null===(e=this.props.imageUrls)||void 0===e?void 0:e.webTemplatesFirstRunIllustration}}));if(!this._panelWasEverOpen)return null;t=void 0}return i.createElement("div",null,t,i.createElement(d,{onDismissed:this._onPanelDismissed,siteScriptProgressStateManager:this._siteScriptProgressStateManager,isOpen:this.state.isPanelOpen,firstRunPanelExperience:this._firstRunPanelExperience,responsiveMode:this.props.responsiveMode,imageUrls:this.props.imageUrls,pageContext:this.props.pageContext}))};return t})(i.Component)},"2081":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(835),o=n(38),u=n(1396),a=n(352),f=n(3759),l=n(2337),c=n(3856),h=n(71),p=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.panelProps,n=e.isOpen,s=e.onDismiss,o=e.isWidgetRendered,p=e.showError,v=e.errorImgUrl,m="ms-FlowWidgetPanel";h.e.isActivated("B6ED8C76-76FE-46FC-B122-B5E8C1EC7028 ","1/13/2020","FlowWidgetPanel Safari min height fix ")||(m+=" ms-FlowWidgetPanel-safariFix");return i.createElement(f.e,Object(r.__assign)({},t,{className:m,type:l.e.smallFixedFar,isLightDismiss:!0,isOpen:n,onDismiss:s,closeButtonAriaLabel:c.e.closeButtonAriaLabel}),i.createElement("div",{className:"ms-FlowPanel-contents","data-automationid":"flowControl"},!o&&!p&&i.createElement(u.e,{className:"ms-FlowPanel-center",size:a.e.large}),p&&i.createElement("div",{className:"ms-FlowPanel-center"},i.createElement("img",{className:"ms-FlowPanel-errorImage",role:"presentation",src:v}),i.createElement("div",{className:"ms-FlowPanel-errorMessage ms-font-s ms-fontColor-neutralSecondary"},c.e.error)),i.createElement(d,Object(r.__assign)({},this.props))))};return t})(s.e),d=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._iframeContainer=i.createRef();return n}t.prototype.render=function(){var e=this.props,t=e.showError,n=e.isWidgetRendered;return i.createElement("div",{className:Object(o.e)("ms-FlowPanel-iframeContainer",{"ms-FlowPanel--hidden":t,"ms-FlowPanel--loadingWidget":!n}),ref:this._iframeContainer,"aria-hidden":!n})};t.prototype.componentDidMount=function(){this.props.isOpen&&this.props.onIFrameContainerRendered&&this.props.onIFrameContainerRendered(this._iframeContainer.current)};t.prototype.componentDidUpdate=function(e){!e.isOpen&&this.props.isOpen&&this.props.onIFrameContainerRendered&&this.props.onIFrameContainerRendered(this._iframeContainer.current)};return t})(s.e),v=n(4181);n.d(t,"e",function(){return m});var m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onDismiss=function(){n._flowWidgetProvider&&n._flowWidgetProvider.dispose();n.props.onDismiss&&n.props.onDismiss()};n._onIFrameContainerRendered=function(e){var t=n.props.widgetParams;t.widgetStyleSettings||(t.widgetStyleSettings={backgroundColor:"white"});n._getFlowWidgetProvider().launchFlowWidget(e,t)};n._onWidgetRendered=function(){n.setState({isWidgetRendered:!0});n.props.onWidgetRendered&&n.props.onWidgetRendered()};n._onWidgetError=function(e){n.setState({showError:!0});n.props.onWidgetError&&n.props.onWidgetError(e)};n._onTokenError=function(e){n.props.onTokenError&&n.props.onTokenError(e)};n._onFlowCreationSucceeded=function(e,t){n.props.onFlowCreationSucceeded&&n.props.onFlowCreationSucceeded(e,t)};n._onFlowCreationFailed=function(e){n.props.onFlowCreationFailed&&n.props.onFlowCreationFailed(e)};n._onWidgetClose=function(e){n.props.onWidgetClose&&n.props.onWidgetClose(e)};n._onTriggerFlowStarted=function(e){n.props.onTriggerFlowStarted&&n.props.onTriggerFlowStarted(e)};n._onTriggerFlowSucceeded=function(e,t){n.props.onTriggerFlowSucceeded&&n.props.onTriggerFlowSucceeded(e,t)};n._onTriggerFlowDoneClicked=function(e){n.props.onTriggerFlowDoneClicked&&n.props.onTriggerFlowDoneClicked(e)};n._onTriggerFlowCancelClicked=function(e){n.props.onTriggerFlowCancelClicked&&n.props.onTriggerFlowCancelClicked(e)};n._onApprovalStatusChanged=function(e){n.props.onApprovalStatusChanged&&n.props.onApprovalStatusChanged(e)};n._onGetStrings=function(e){n.props.onGetStrings&&n.props.onGetStrings(e)};n.state={isWidgetRendered:!1,showError:!1};return n}t.prototype.render=function(){return i.createElement(p,Object(r.__assign)({},this.getRenderProps()))};t.prototype.getRenderProps=function(){var e=this.props,t=this.state;return{isOpen:e.isOpen,isWidgetRendered:t.isWidgetRendered,showError:t.showError,errorImgUrl:e.errorImgUrl,panelProps:e.panelProps,onDismiss:this._onDismiss,onIFrameContainerRendered:this._onIFrameContainerRendered}};t.prototype._getFlowWidgetProvider=function(){this._flowWidgetProvider||(this._flowWidgetProvider=new v.e({onWidgetRendered:this._onWidgetRendered,onWidgetError:this._onWidgetError,onTokenError:this._onTokenError,onFlowCreationSucceeded:this._onFlowCreationSucceeded,onFlowCreationFailed:this._onFlowCreationFailed,onWidgetClose:this._onWidgetClose,onTriggerFlowStarted:this._onTriggerFlowStarted,onTriggerFlowSucceeded:this._onTriggerFlowSucceeded,onTriggerFlowDoneClicked:this._onTriggerFlowDoneClicked,onTriggerFlowCancelClicked:this._onTriggerFlowCancelClicked,onApprovalStatusChanged:this._onApprovalStatusChanged,onGetStrings:this._onGetStrings},{pageContext:this.props.pageContext,oAuthTokenProvider:this.props.oAuthTokenProvider}));return this._flowWidgetProvider};return t})(s.e);t.t=m},"2125":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(38),o=n(835),u=n(1387),a=n(1394),f=n(969),l=n(3742),c=n(2338),h=n(600),p=n(1544),d=n(1410),v="teamifyBanner_a8ceaba1",m="titleWrapper_a8ceaba1",g="teamsIcon_a8ceaba1",y="infoIcon_a8ceaba1",b="description_a8ceaba1",w="teamifySpinner_a8ceaba1",E=n(4070),S=n(1779),x=n(178),T=n(4157),N=n(20),C=n(3633),k=n(299),L=n(1396),A=n(352),O=n(71),M=n(55),_=n(74);n.d(t,"e",function(){return H});var D=i.lazy(function(){return n.e("625").then(n.bind(null,4423))}),P={ODB:1936},H=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._hideTeamifyKillswitch=!1;n._experimentKillswitch=!1;n._renderTooltipContent=function(){return M.n.isFeatureEnabled(P)||!n._experimentKillswitch?i.createElement("div",{className:"tooltip_a8ceaba1"},E.e.toolTipContent):i.createElement("div",{className:"tooltip_a8ceaba1"},E.e.teamsDescription1,i.createElement("br",null),i.createElement("br",null),Object(S.e)(E.e.teamsDescription2,E.e.createTeam,"span",{className:"createTeamText_a8ceaba1"}))};n._onHideTeamifyBanner=function(){new T.e({pageContext:n.props.pageContext}).hideTeamifyBanner();x.e.logData({name:"TeamifyBanner.Hide",isIntentional:!0});n.setState({hasDismissed:!0});n._onCloseHideTeamifyDialog()};n._onDismissTeamifyBanner=function(){var e=new T.e({pageContext:n.props.pageContext});x.e.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0});e.dismissTeamifyBanner().then(function(){n._onCloseHideTeamifyDialog();n.setState({hasDismissed:!0})})};n._onClick=function(){if(M.n.isFeatureEnabled(P))n._onClickV2Experience();else if(n._experimentKillswitch)n._onClickV1Experience();else{switch(Object(k.n)(90010,n.props.pageContext)){case 1:n._onClickV2Experience();break;default:n._onClickV1Experience()}}x.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._onClickV2Experience=function(){n._teamifyQos=new _.e({name:"TeamifyWizardLoader.Load"});n._toggleTeamify()};n._onClickV1Experience=function(){n.setState({hasClickedLink:!0});new T.e({pageContext:n.props.pageContext}).teamify().done(function(e){if(void 0!==e){n.setState({responseHasFailure:!1,responseHasSuccess:!0,teamUrl:e});x.e.logData({name:"TeamifyBanner.Teamify.Success",isIntentional:!1})}else n.setState({responseHasFailure:!0})},function(e){n.setState({responseHasFailure:!0})})};n._onCloseHideTeamifyDialog=function(){n.setState({hideTeamifyDialogOpen:!1})};n._onOpenHideTeamifyDialog=function(){x.e.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0});n.setState({hideTeamifyDialogOpen:!0})};n._logClick=function(){n.setState({hasClickedLink:!0});x.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._toggleTeamify=function(){n.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})};n.state={};n._createUrl=t.pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?Target=TEAM&Create=TRUE";n._usePostmethod=!O.e.isActivated("67615EE2-7930-41EE-A90D-4D174AB85A58","01/15/2019","Enable Teamify through POST method only.");n._hideTeamifyKillswitch=O.e.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner");n._experimentKillswitch=O.e.isActivated("DB52012D-C103-4653-928C-16AC57D214B9","11/05/2020","Enable v2 Experiment");return n}t.prototype.render=function(){return M.n.isFeatureEnabled(P)?this._renderV2Experience():this._experimentKillswitch?this._renderV1Experience():this._renderExperimentalExperience()};t.prototype.componentDidMount=function(){x.e.logData({name:"TeamifyBanner.Render",isIntentional:!1})};t.prototype._renderV1Experience=function(){if(this._usePostmethod){var e="Microsoft Teams",t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:y,tabIndex:0,ariaLabel:e+". "+E.e.description})),n=void 0;this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?n=i.createElement("div",{className:b},E.e.error):this.state.responseHasSuccess&&(n=i.createElement("div",{className:b},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},E.e.visitTeam))):n=i.createElement("div",{className:b},E.e.description,i.createElement("br",null),i.createElement(L.e,{size:A.e.xSmall,className:w+" "+w})," ",E.e.creating):n=i.createElement("div",{className:b},E.e.description,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_a8ceaba1"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},E.e.createTeam));return i.createElement("div",{className:Object(s.e)(this.props.className,v)},this._renderHideTeamifyButton(),i.createElement("div",{className:m},i.createElement(h.e,{className:g,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_a8ceaba1"},e),this._hideTeamifyKillswitch&&t),n)}if(this.state.hasClickedLink)return null;e="Microsoft Teams";return i.createElement("div",{className:Object(s.e)(this.props.className,v)},this._renderHideTeamifyButton(),i.createElement("div",{className:m},i.createElement(h.e,{className:g,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_a8ceaba1"},e),i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:y,tabIndex:0,ariaLabel:e+". "+E.e.description}))),i.createElement("div",{className:b},E.e.description,i.createElement("br",null),i.createElement(p.e,{href:this._createUrl,onClick:this._logClick,target:"_blank"},E.e.createTeam)))};t.prototype._renderV2Experience=function(){var e=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:y,tabIndex:0}));return i.createElement("div",null,i.createElement("div",{className:Object(s.e)(this.props.className,v)},this._renderHideTeamifyButton(),i.createElement("div",{className:m},i.createElement(h.e,{className:g,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_a8ceaba1"},E.e.title)),i.createElement("div",{className:b},E.e.teamifyDescription,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_a8ceaba1"},e),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},E.e.linkDescription))),this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(D,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:C.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))};t.prototype._renderExperimentalExperience=function(){var e,t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:y,tabIndex:0}));this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?e=i.createElement("div",{className:b},E.e.error):this.state.responseHasSuccess&&(e=i.createElement("div",{className:b},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},E.e.visitTeam))):e=i.createElement("div",{className:b},E.e.description,i.createElement("br",null),i.createElement(L.e,{size:A.e.xSmall,className:w+" "+w})," ",E.e.creating):e=i.createElement("div",{className:b},E.e.teamifyDescription,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_a8ceaba1"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},E.e.linkDescription));return i.createElement("div",{className:Object(s.e)(this.props.className,v)},this._renderHideTeamifyButton(),i.createElement("div",{className:m},i.createElement(h.e,{className:g,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_a8ceaba1"},"Microsoft Teams")),e,this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(D,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:C.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))};t.prototype._renderHideTeamifyButton=function(){if(!this._hideTeamifyKillswitch)return this.state.hasDismissed?null:[i.createElement(u.e,{className:"hideTeamifyButton_a8ceaba1",ariaLabel:E.e.hideTeamifyButtonAriaLabel,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_a8ceaba1"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]};t.prototype._renderHideTeamifyDialog=function(){return i.createElement(l.e,{hidden:!this.state.hideTeamifyDialogOpen,type:c.e.close,dialogContentProps:{type:c.e.close,title:E.e.hideTeamifyDialogTitle,subText:N.format(E.e.hideTeamifyDialogDescription,E.e.hideTeamifyDialogPermanentDismissLink),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},i.createElement("div",{className:"hideTeamifyDialogButtonContainer_a8ceaba1"},i.createElement("div",{className:"hideTeamifyDialogButton_a8ceaba1"},i.createElement(a.e,{onClick:this._onHideTeamifyBanner}," ",E.e.hideTeamifyDialogYesButton," ")),i.createElement("div",{className:"hideTeamifyDialogButton_a8ceaba1"},i.createElement(f.e,{onClick:this._onCloseHideTeamifyDialog}," ",E.e.hideTeamifyDialogNoButton," "))),i.createElement("div",{className:"hideTeamifyDialogButtonContainer_a8ceaba1"},i.createElement(p.e,{className:"dismissPermanentlyLink_a8ceaba1",onClick:this._onDismissTeamifyBanner},E.e.hideTeamifyDialogPermanentDismissLink)))};return t})(o.e)},"2169":function(e,t,n){"use strict";var r,i=n(0),s=n("react-lib"),o=n(3759),u=n(2337),a=n(1394),f=n(969),l=n(1387),c=n(1435),h=n(600),p=n(1544),d=n(38),v=n(439),m=n(470),g=n(835),y=n(1396),b=n(4149),w=n(2587),E=n(4514),S=n(71),x=n(42),T=n(703);(function(e){e.megaMenu="megamenu";e.cascade="cascade"})(r||(r={}));var N=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onQuickLaunchToggleChanged=function(e,t){if(n.props.onChange){var r=Object(i.__assign)(Object(i.__assign)({},n.props.options),{quickLaunchEnabled:t});n.props.onChange({nav:r})}};n._onMenuStyleChanged=function(e,t){var r=t.key;if(r!==n.state.selectedKey){n.setState({selectedKey:r});var s="megamenu"===r,o=Object(i.__assign)(Object(i.__assign)({},n.props.options),{megaMenuEnabled:s});n.props.onChange&&n.props.onChange({nav:o})}};n.state={selectedKey:n.props.options.megaMenuEnabled?"megamenu":"cascade",quickLaunchEnabled:n.props.options.quickLaunchEnabled};return n}t.prototype.render=function(){return s.createElement("div",{className:Object(d.e)("sp-ChangeTheLookPanel-content","sp-ChangeTheLookPanel-customizeNav-layout")},s.createElement(b.e,{label:w.e.navMenuStyleOptionGroupLabel,selectedKey:this.state.selectedKey,options:[{imageSrc:this.props.imageUrls&&this.props.imageUrls.megaMenu,key:"megamenu",text:w.e.navMenuStyleOption_MegaMenu,selectedImageSrc:this.props.imageUrls&&this.props.imageUrls.megaMenu},{imageSrc:this.props.imageUrls&&this.props.imageUrls.cascade,key:"cascade",text:w.e.navMenuStyleOption_Cascade,selectedImageSrc:this.props.imageUrls&&this.props.imageUrls.cascade}],onChange:this._onMenuStyleChanged}),!S.e.isActivated("e04142b5-2f68-499c-b44f-60e54d1c82a1")&&Object(T.e)(this.props.pageContext)&&x.e.hasPermission(this.props.pageContext.webPermMasks,x.e.manageWeb)&&s.createElement(E.e,{styles:{root:{marginTop:20}},label:w.e.QuickLaunchToggleLabel,defaultChecked:this.state.quickLaunchEnabled,onChange:this._onQuickLaunchToggleChanged,onText:w.e.QuickLaunchToggleOnText,offText:w.e.QuickLaunchToggleOffText}))};return t})(g.e),C=n(148),k=n(2820),L=n(55),A=n(2040),O=n(22),M=n(2965),_=n(4569),D=n(346),P=n(1432),H=n(650),B=n(664),j=n(1376),F=n(2585),I=Object(D.e)(),q=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onChange=function(e,t){var r=B.e.None;switch(t.key){case String(B.e.Neutral):r=B.e.Neutral;break;case String(B.e.Soft):r=B.e.Soft;break;case String(B.e.Strong):r=B.e.Strong}n.setState({selectedEmphasis:t.key});n.props.onChange&&n.props.onChange(e,r)};n._getRenderEmphasisOption=function(e){var t=Object(j.r)(n.props.theme||Object(O._)(),e),r=I(n.props.styles||n.props.getStyles,{theme:t});return function(e){return s.createElement("div",{className:r.option},s.createElement(P.e,{settings:{theme:t}},s.createElement(h.e,{className:r.icon,iconName:"Font"})))}};n.state={selectedEmphasis:String(t.selectedEmphasis)||String(B.e.None)};return n}t.prototype.render=function(){var e=this.props,t=e.theme,n=e.styles,r=void 0===n?this.props.getStyles:n,i=I(r,{theme:t});return s.createElement("div",{className:i.root},s.createElement(b.e,{label:this.props.noTitle?null:this.props.title||F.e.headerEmphasisTitle,selectedKey:this.state.selectedEmphasis,options:[{key:String(B.e.None),text:F.e.headerEmphasisOptionNone,ariaLabel:F.e.headerEmphasisOptionNone,onRenderLabel:this._getRenderEmphasisOption(B.e.None)},{key:String(B.e.Neutral),text:F.e.headerEmphasisOptionNeutral,ariaLabel:F.e.headerEmphasisOptionNeutral,onRenderLabel:this._getRenderEmphasisOption(B.e.Neutral)},{key:String(B.e.Soft),text:F.e.headerEmphasisOptionSoft,ariaLabel:F.e.headerEmphasisOptionSoft,onRenderLabel:this._getRenderEmphasisOption(B.e.Soft)},{key:String(B.e.Strong),text:F.e.headerEmphasisOptionStrong,ariaLabel:F.e.headerEmphasisOptionStrong,onRenderLabel:this._getRenderEmphasisOption(B.e.Strong)}],onChange:this._onChange}))};return t})(s.PureComponent),R=Object(H.e)(q,function(e){var t=e.theme||Object(O._)(),n=t.semanticColors,r=t.palette;return{root:["sp-EmphasisSelector-container",{selectors:{".ms-Label":{padding:0},".ms-ChoiceField":{display:"inline-block",marginRight:8},".ms-ChoiceField-field":{height:68,width:64,boxSizing:"border-box"},".ms-ChoiceField:first-child .ms-ChoiceField-field:not(:hover):not(.is-checked)":{border:"1px solid "+r.neutralLight},".ms-ChoiceField-field:hover":{padding:4,border:"4px solid "+r.neutralLight},".ms-ChoiceField-field.is-checked":{padding:4,border:"4px solid "+r.neutralTertiaryAlt},"& .ms-ChoiceField-field::before, & .ms-ChoiceField-field::after":{display:"none"}}}],option:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:n.bodyBackground,color:n.bodyText},icon:{fontSize:20}}}),U=!1,z=function(){if(!U){Object(O.R)({icons:{"headercustomization-standard":s.createElement("svg",{viewBox:"0 0 32 18"},s.createElement("path",{d:"M32,18H0V0H32V18h0ZM2,16H30V2H2Zm8-4H4V6h6v6h0ZM6,10H8V8H6Zm14,2V10h6v2Zm-8,0V10h6v2Zm0-4V6h8V8Z"})),"headercustomization-compact":s.createElement("svg",{viewBox:"0 0 32 10"},s.createElement("path",{d:"M32,10H0V0H32V10h0ZM2,8H30V2H2ZM22,6V4h6V6ZM14,6V4h6V6ZM4,6V4h8V6Z"})),"headercustomization-minimal":s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 6"},s.createElement("rect",{width:"32",height:"2"})),"headercustomization-extended":s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 22"},s.createElement("path",{d:"M0,0V22H32V0ZM30,20H2V14H30Zm0-8H2V2H30Z"}),s.createElement("path",{d:"M10,4H4v6h6ZM8,8H6V6H8Z"}),s.createElement("rect",{x:"12",y:"6",width:"11",height:"2"}),s.createElement("rect",{x:"4",y:"16",width:"6",height:"2"}),s.createElement("rect",{x:"12",y:"16",width:"6",height:"2"}),s.createElement("rect",{x:"20",y:"16",width:"6",height:"2"})),"footercustomization-simple":s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 14"},s.createElement("path",{id:"icn_footer_simple",d:"M32,14H0V0H32V14h0ZM2,12H30V2H2Zm8-2H4V4h6v6h0ZM6,8H8V6H6ZM24,8V6h4V8ZM18,8V6h4V8ZM12,8V6h4V8Z"})),"footercustomization-extended":s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 14"},s.createElement("path",{id:"icn_footer_extended",d:"M32,14H0V0H32V14h0ZM2,12H30V2H2Zm16-2V8h4v2Zm-6,0V8h4v2Zm-2,0H4V4h6v6h0ZM6,8H8V6H6ZM24,6V4h4V6ZM18,6V4h4V6ZM12,6V4h4V6Z"})),"footercustomization-stacked":s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 20"},s.createElement("path",{id:"icn_footer_stacked",d:"M32,20H0V0H32V20h0ZM2,18H30V2H2Zm22-2V14h4v2Zm-6,0V14h4v2Zm-6,0V14h4v2Zm6-6V8h4v2Zm-6,0V8h4v2Zm-2,0H4V4h6v6h0ZM6,8H8V6H6ZM24,6V4h4V6ZM18,6V4h4V6ZM12,6V4h4V6Z"}))}});U=!0}},W=n(2340),X=n(359),V=n(3427),$=n(1929),J=n(178),K=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onSaveClick=function(e){if(!S.e.isActivated("6921c992-ef26-401f-8ee8-3c156da6ff3a","02/17/2021","logging MUIEditing telemetry")){var t=e?e.filter(function(e){return e.value&&e.value.length>0}):[];J.e.logData({name:"FooterPanel.TranslationsPanelOK.Click",extraData:{translatedItems:t.length}})}n.props.onExitClick(!1,e)};n._onCancelClick=function(){n.props.onExitClick(!0)};n._textUpdateCallback=function(e){var t=$.t.getDisplayLanguage(e,n.props.pageContext),r={name:t[0].value,translatedTitles:e};r.name!==n.props.currentDisplay&&n.props.updateFooterName(r.name,t[0].code);n.props.onFooterOptionsChanged(r)};n._shouldReuseDefaultClass=!S.e.isActivated("efb2d7d8-5efa-4ca3-830b-dc0d6c6ff3ee","03/11/2021","reuse default mui editing class");return n}t.prototype.render=function(){return s.createElement(V.e,{currentDisplay:this.props.currentDisplay,currentLCID:this.props.currentLCID,dataSourceType:this.props.dataSourceType,navNodeId:this.props.navNodeId,pageContext:this.props.pageContext,onCancelClick:this._onCancelClick,onSaveClick:this._onSaveClick,translations:this.props.translations,textUpdateCallback:this._textUpdateCallback,contentClassNames:this._shouldReuseDefaultClass?void 0:"ms-MUIEditingCustomization",defaultLanguageIsOptional:!0})};return t})(g.e),Q=n(20),G=n(2586),Y=n(1410);z();var Z=["image/png","image/jpeg","image/gif","image/bmp","image/tiff"],ee=(function(e){Object(i.__extends)(t,e);function t(t){var n,r=e.call(this,t)||this;r._updateFooterName=function(e,t){r.setState({name:e,titleCurrentLCID:t})};r._onRenderDisplayNameLabel=function(e,t){var n,i,o,u;if(null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage){var a=Q.format(W.e.TranslationInfoTextUpdateTranslations,G.e.getResourceByCode(null===(i=r.props.pageContext)||void 0===i?void 0:i.webLanguage));return s.createElement("div",null,t(e),s.createElement(Y.e,{content:s.createElement("span",null,r.state.titleCurrentLCID===(null===(o=r.props.pageContext)||void 0===o?void 0:o.webLanguage)&&r.state.titleCurrentLCID!==(null===(u=r.props.pageContext)||void 0===u?void 0:u.currentLanguage)?a:W.e.TranslationInfoTextDefaultLanguage)},s.createElement(l.e,{iconProps:{iconName:"Info"},className:"sp-MUIEditing-InfoIcon"})))}};r._onL3ExitClick=function(e,t){void 0===e&&(e=!1);if(e)r.setState({name:r._originalName});else{r._originalName=r.state.name;r._originalTranslatedTitles=t}r.props.onL3ExitClick&&r.props.onL3ExitClick(e,r._originalName,r._originalTranslatedTitles)};r._toggleTranslationpanel=function(e){return function(){!S.e.isActivated("6921c992-ef26-401f-8ee8-3c156da6ff3a","02/17/2021","logging MUIEditing telemetry")&&e&&J.e.logData({name:"FooterPanel.TranslationsPanelOpen.Click"});r.setState({showTranslationPanel:e});r.props.onTranslationsButtonClick&&r.props.onTranslationsButtonClick()}};r._onVisibilityChanged=function(e){if(e!==r.state.footerVisible){r.setState({footerVisible:e});var t=Object(i.__assign)(Object(i.__assign)({},r.props.chromeOptions),{hidden:!e});r.props.onChromeOptionsChange&&r.props.onChromeOptionsChange({footer:t})}};r._onImageChanged=function(e,t){if(e!==r.state.logoUrl){r.setState({logoUrl:e||""});var n={logoUrl:e||"",logoFile:t,name:r.state.name};r.props.onFooterOptionsChanged&&r.props.onFooterOptionsChanged(n)}};r._onNameTextFieldChanged=function(e,t){var n;r._shouldDisplayMUIEditing&&r.props.footerOptions.translatedTitles&&(n=r.props.footerOptions.translatedTitles.map(function(e){e.code===r.state.titleCurrentLCID&&(e.value=t);return e}));r.setState({name:t});var i={logoUrl:r.state.logoUrl,name:t,translatedTitles:n};r.props.onFooterOptionsChanged&&r.props.onFooterOptionsChanged(i)};r._onFooterLayoutChange=function(e,t){var n;switch(t.key){case String(C.t.SIMPLE):n=C.t.SIMPLE;break;case String(C.t.EXTENDED):n=C.t.EXTENDED;break;default:n=C.t.STACKED}r.props.onChromeOptionsChange({footer:{layout:n}});r.setState({footerType:n})};r._onEmphasisChange=function(e,t){var n=r._convertFabricToFooterEmphasis(t);r.props.onChromeOptionsChange({footer:{emphasis:n}});r.setState({selectedVariant:n})};r.state={footerType:r.props.chromeOptions.layout?r.props.chromeOptions.layout:C.t.SIMPLE,footerVisible:!r.props.chromeOptions.hidden,logoUrl:r.props.footerOptions.logoUrl,name:r.props.footerOptions.name,selectedVariant:r.props.chromeOptions.emphasis,titleCurrentLCID:r.props.titleCurrentLCID||(null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage)};r._originalName=r.props.footerOptions.name;r._originalTranslatedTitles=r.props.footerOptions.translatedTitles;return r}t.prototype.render=function(){var e,t,n,r=Object(O._)(),i=this.state.footerType,o=w.e.footerNameLabel;this._shouldDisplayMUIEditing&&this.state.titleCurrentLCID?o=Q.format(W.e.CalloutDisplayLabelWithDefaultLocale,G.e.getResourceByCode(this.state.titleCurrentLCID)):this._shouldDisplayMUIEditing&&(null===(e=this.props.pageContext)||void 0===e?void 0:e.webLanguage)&&(o=Q.format(W.e.CalloutDisplayLabelWithDefaultLocale,G.e.getResourceByCode(null===(t=this.props.pageContext)||void 0===t?void 0:t.webLanguage)));return this.props.renderL3PanelType?s.createElement("div",{className:"sp-ChangeTheLookPanel-content"},s.createElement(K,{currentDisplay:this.state.name,currentLCID:this.state.titleCurrentLCID||(null===(n=this.props.pageContext)||void 0===n?void 0:n.webLanguage),navNodeId:this.props.titleKey,dataSourceType:this.props.titleKey?$.e.ExistingNavNode:$.e.NewNavNode,translations:this.props.footerOptions.translatedTitles,pageContext:this.props.pageContext,onFooterOptionsChanged:this.props.onFooterOptionsChanged,onExitClick:this._onL3ExitClick,updateFooterName:this._updateFooterName})):s.createElement("div",{className:"sp-ChangeTheLookPanel-content"},s.createElement("div",{"data-automation-id":"sp-ChangeTheLookPanel-footerVisibility"},s.createElement(A.e,null,w.e.footerVisibilityLabel),s.createElement(E.e,{onText:w.e.footerVisibilityOption_On,offText:w.e.footerVisibilityOption_Off,checked:this.state.footerVisible,onChanged:this._onVisibilityChanged})),this.state.footerVisible&&s.createElement(s.Fragment,null,s.createElement(A.e,{id:"footerTypeLabel"},w.e.footerTypeLabel),s.createElement(b.e,{ariaLabelledBy:"footerTypeLabel",className:"sp-ChangeTheLookPanel-customizeHeader-layout",options:[{key:String(C.t.SIMPLE),iconProps:{iconName:"footercustomization-simple",styles:{root:{width:32,height:32,fill:r.palette.neutralSecondary}}},text:w.e.simpleFooterOption},{key:String(C.t.EXTENDED),iconProps:{iconName:"footercustomization-extended",styles:{root:{width:32,height:32,fill:r.palette.neutralSecondary}}},text:w.e.extendedFooterOption}],selectedKey:String(i),onChange:this._onFooterLayoutChange}),s.createElement("div",{className:"sp-ChangeTheLookPanel-footerProperty"},s.createElement(A.e,null,w.e.footerLogoLabel),s.createElement(_.e,{ref:this._resolveRef("_imageBrowser"),emptyImageUrl:this.props.emptyImageUrl,imageHeight:32,imageWidth:32,initialPreviewUrl:this.state.logoUrl,disableRemove:!this.state.logoUrl,supportedImageTypes:Z,onImageChanged:this._onImageChanged})),s.createElement("div",{className:"sp-ChangeTheLookPanel-footerProperty"},s.createElement(M.e,{label:o,onChange:this._onNameTextFieldChanged,value:this.state.name,onRenderLabel:this._shouldDisplayMUIEditing?this._onRenderDisplayNameLabel:void 0,styles:this._shouldDisplayMUIEditing?{subComponentStyles:{label:{root:{display:"inline-block"}}}}:void 0}),this._shouldDisplayMUIEditing&&s.createElement(p.e,{onClick:this._toggleTranslationpanel(!0),"aria-label":W.e.Translations,styles:{root:{marginBottom:"4px"}},className:"sp-ChangeTheLookPanel-footerTranslation"},W.e.Translations)),s.createElement(R,{selectedEmphasis:this._spEmphasis,onChange:this._onEmphasisChange})))};Object.defineProperty(t.prototype,"_isMUIEditingFlightOn",{get:function(){return L.n.isFeatureEnabled({ODB:675})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_shouldDisplayMUIEditing",{get:function(){var e=!1;if(this._isMUIEditingFlightOn&&this.props.pageContext){var t=new X.e(this.props.pageContext.featureInfo);if(t){var n=t.get("MultilingualPages");e=!!n&&n.enabled}}return this._isMUIEditingFlightOn&&e},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_spEmphasis",{get:function(){switch(this.state.selectedVariant){case C.e.Strong:return k.e.Strong;case C.e.Neutral:return k.e.Neutral;case C.e.Soft:return k.e.Soft;default:return k.e.None}},enumerable:!0,configurable:!0});t.prototype._convertFabricToFooterEmphasis=function(e){switch(e){case k.e.None:return C.e.None;case k.e.Neutral:return C.e.Neutral;case k.e.Soft:return C.e.Soft;default:return C.e.Strong}};return t})(g.e),te=n(90),ne=n(3863),re=n(2232),ie=n(73),se=Object(O._)(),oe=Object(O.B)({accordionContainer:{borderTop:"1px solid "+se.palette.neutralLight,paddingTop:0,paddingBottom:24,position:"relative"},accordionContainerSlim:{paddingTop:0,paddingBottom:0,position:"relative"},accordionHeader:{position:"relative",height:44,display:"flex",cursor:"pointer",paddingLeft:24,paddingRight:24,selectors:{label:{lineHeight:"1.8em",fontSize:O.i.mediumPlus,marginRight:"auto",cursor:"inherit"},button:{fontSize:O.i.mediumPlus,color:se.palette.neutralSecondary,backgroundColor:"transparent",border:"none",cursor:"pointer",height:44,marginRight:-20,paddingRight:0,paddingLeft:0},".chevronIcon":{transition:"transform .1s linear"},".collapsed":{transform:"rotate(180deg)"},":hover":{backgroundColor:se.palette.neutralLight}}},accordionContent:{padding:"0px 24px"},collapsedContent:{display:"none"}}),ue=function(e){var t=Object(s.useState)(!1),n=t[0],r=t[1];if(void 0===e.children)return null;var i=!1,o=s.Children.toArray(e.children);for(var u in o)if(u){i=!0;break}return i?s.createElement("div",{className:oe.accordionContainer+" "+(n?oe.accordionContainerSlim:"")},s.createElement("div",{className:oe.accordionHeader,onClick:function(){r(!n)}},s.createElement(A.e,null,e.title),s.createElement(f.e,{ariaLabel:e.title,"aria-expanded":!n},s.createElement(h.e,{className:Object(d.e)("ms-Nav-chevron","chevronIcon",{collapsed:n}),iconName:"ChevronUp"}))),s.createElement("div",{className:n?oe.collapsedContent:oe.accordionContent},e.children)):null},ae=n(113);z();var fe={ODB:1067},le={ODB:628},ce={ODB:672},he=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isHubJoined=!1;n._renderContentNew=function(){var e,t=Object(O._)(),r=L.n.isFeatureEnabled(le),i=L.n.isFeatureEnabled(ce),o=n.state.selectedLayout===String(C.s.extended),u=r?{root:{marginRight:2,selectors:{":last-child":{marginRight:0}}}}:void 0,a={root:{width:32,height:32,fill:t.palette.neutralSecondary}},f={key:String(C.s.minimal),text:w.e.headerLayoutOption_Minimal,styles:u,iconProps:{iconName:"headercustomization-minimal",styles:a}},l={key:String(C.s.compact),text:w.e.headerLayoutOption_Compact,styles:u,iconProps:{iconName:"headercustomization-compact",styles:a}},c={key:String(C.s.standard),text:w.e.headerLayoutOption_Standard,styles:u,iconProps:{iconName:"headercustomization-standard",styles:a}},h={key:String(C.s.extended),text:w.e.headerLayoutOption_Extended,styles:u,iconProps:{iconName:"headercustomization-extended",styles:a}},p=r?[f,l,c]:[c,l];i&&p.push(h);return s.createElement(s.Fragment,null,s.createElement(ue,{title:w.e.headerLayoutLabel},s.createElement(b.e,{className:"sp-ChangeTheLookPanel-customizeHeader-layout",selectedKey:n.state.selectedLayout,options:p,onChange:n._onLayoutChange})),s.createElement(ue,{title:w.e.HeaderCustomizerBackgroundPaneLabel},!n._isHubJoined&&s.createElement(s.Fragment,null,s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.EmphasisSelectorLabel),s.createElement(R,{selectedEmphasis:n.state.selectedEmphasis,onChange:n._onEmphasisChange,noTitle:!0})),i&&o&&s.createElement(s.Fragment,null,s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.ExtendedHeaderBackgroundImage),s.createElement(_.e,{supportedImageTypes:re.n,onImageChanged:n._onBackgroundImageChanged,initialPreviewUrl:n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?target='2'",imageFit:ae.t.cover,isFocalPointEnabled:!0,imageWidth:292,changeButtonAriaLabel:w.e.ChangeBackgroundImageAriaLabel,removeButtonAriaLabel:w.e.RemoveBackgroundImageAriaLabel,imageAlt:w.e.ExtendedHeaderBackgroundImageAlt,onFocalPointMove:n._onFocalPointMove,initialFocalPoint:null===(e=n.props.pageContext)||void 0===e?void 0:e.focalPoint}))),n.props.pageContext&&s.createElement(ue,{title:w.e.HeaderCustomizerBrandingPaneLabel},s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.SiteTitleVisibilityLabel),s.createElement(E.e,{checked:!n.state.hideTitle,onText:w.e.SiteTitleVisibilityToggle_On,offText:w.e.SiteTitleVisibilityToggle_Off,onChange:n._onTitleVisiblityChanged}),s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.SiteLogoThumbnailUploaderTitle,n._renderInfoTip("site-thumbnail-info",w.e.SiteThumbnailInfoTip)),s.createElement(_.e,{supportedImageTypes:re.n,onImageChanged:n._onLogoChanged,initialPreviewUrl:L.n.isFeatureEnabled(fe)?n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo":n.state.siteLogoUrl,disableRemove:Object(ie.s)(n.props.pageContext),changeButtonAriaLabel:w.e.ChangeSiteLogoThumbnailAriaLabel,removeButtonAriaLabel:w.e.RemoveSiteLogoThumbnailAriaLabel,imageAlt:w.e.SiteLogoThumbnailUploaderTitle}),s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.SiteLogoUploaderTitle,n._renderInfoTip("site-logo-info",w.e.SiteLogoInfoTip)),s.createElement(_.e,{supportedImageTypes:re.n,onImageChanged:n._onRectLogoChanged,initialPreviewUrl:n.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?type='1'",imageWidth:292,changeButtonAriaLabel:w.e.ChangeSiteLogoAriaLabel,removeButtonAriaLabel:w.e.RemoveSiteLogoAriaLabel,imageAlt:w.e.SiteLogoUploaderTitle,imageAlignment:ne.e.left}),i&&o&&s.createElement(s.Fragment,null,s.createElement("div",{className:"sp-ChangeTheLookPanel-customizeHeader-Section"},w.e.ExtendedHeaderLogoAlignment),s.createElement(b.e,{selectedKey:n.state.selectedLogoAlignment,options:n._getLogoAlignmentOptions(t),onChange:n._onLogoAlignmentChange}))))};n._renderInfoTip=function(e,t){return s.createElement(Y.e,{content:t,id:e,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block",position:"relative",top:4}}},s.createElement(l.e,{iconProps:{iconName:"Info"},ariaLabel:t,disabled:!1,checked:!1,styles:{rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"}}}))};n._getLogoAlignmentOptions=function(e){var t=function(t){return{root:{backgroundColor:e.palette.white},field:[{width:32,height:32,padding:0,border:"none"},t.checked&&{borderRadius:2,backgroundColor:e.semanticColors.bodyBackgroundChecked,selectors:{"::before, ::after":{border:"none",width:0,height:0}}},{selectors:{":hover":{borderRadius:2,backgroundColor:e.semanticColors.bodyBackgroundHovered},":hover::before":{border:"none",width:0,height:0}}}],choiceFieldWrapper:{width:32,height:32},iconWrapper:{color:e.palette.themePrimary,fontSize:16,width:32,height:32},innerField:{padding:0},labelWrapper:{margin:0}}};return[{key:String(C.r.left),text:"",styles:t,iconProps:{iconName:"AlignHorizontalLeft"}},{key:String(C.r.middle),text:"",styles:t,iconProps:{iconName:"AlignHorizontalCenter"}},{key:String(C.r.right),text:"",styles:t,iconProps:{iconName:"AlignHorizontalRight"}}]};n._renderContentOld=function(){var e=Object(O._)();return s.createElement("div",{className:"sp-ChangeTheLookPanel-content"},s.createElement(b.e,{className:"sp-ChangeTheLookPanel-customizeHeader-layout",label:w.e.headerLayoutLabel,selectedKey:n.state.selectedLayout,options:[{key:String(C.s.standard),text:w.e.headerLayoutOption_Standard,iconProps:{iconName:"headercustomization-standard",styles:{root:{width:32,height:32,fill:e.palette.neutralSecondary}}}},{key:String(C.s.compact),text:w.e.headerLayoutOption_Compact,iconProps:{iconName:"headercustomization-compact",styles:{root:{width:32,height:32,fill:e.palette.neutralSecondary}}}}],onChange:n._onLayoutChange}),n.props.pageContext&&s.createElement("div",{className:"sp-CustomizeTheme-headerEmphasis-title"},"Site logo"),n.props.pageContext&&s.createElement(_.e,{supportedImageTypes:re.n,onImageChanged:n._onLogoChanged,initialPreviewUrl:n.state.siteLogoUrl,disableRemove:Object(ie.s)(n.props.pageContext)}),!n._isHubJoined&&s.createElement(R,{selectedEmphasis:n.state.selectedEmphasis,onChange:n._onEmphasisChange}))};n._onLogoChanged=function(e,t){n.props.onLogoChange(t,e)};n._onRectLogoChanged=function(e,t){n.props.onRectLogoChange(e,t)};n._onBackgroundImageChanged=function(e,t){n.props.onBackgroundImageChange&&n.props.onBackgroundImageChange(e,t)};n._onTitleVisiblityChanged=function(e,t){if(t!==!n.state.hideTitle){n.setState({hideTitle:!t});n.props.onHideTitleChange&&n.props.onHideTitleChange({header:{hideTitle:!t}})}};n._onFocalPointMove=function(e){n.props.onBackgroundImageFocalPointChange&&n.props.onBackgroundImageFocalPointChange(e)};n._onLogoAlignmentChange=function(e,t){if(t.key!==n.state.selectedLogoAlignment){n.setState({selectedLogoAlignment:t.key});var r=C.r.left;switch(t.key){case String(C.r.left):r=C.r.left;break;case String(C.r.middle):r=C.r.middle;break;case String(C.r.right):r=C.r.right}var i={logoAlignment:r};n.props.onChange&&n.props.onChange({header:i})}};n._onLayoutChange=function(e,t){if(t.key!==n.state.selectedLayout){n.setState({selectedLayout:t.key});var r=C.s.standard;switch(t.key){case String(C.s.standard):r=C.s.standard;break;case String(C.s.compact):r=C.s.compact;break;case String(C.s.minimal):r=C.s.minimal;break;case String(C.s.extended):r=C.s.extended}var i={layout:r};n.props.onChange&&n.props.onChange({header:i});!S.e.isActivated("73ea761e-b7df-4b36-9130-c0201950927e")&&Object(ie.o)(n.props.pageContext)&&te.e.raise(window,"Header_Layout_Changed",{layout:r})}};n._onEmphasisChange=function(e,t){if(t!==n.state.selectedEmphasis){n.props.onHeaderEmphasisChanged&&n.props.onHeaderEmphasisChanged(t);n.setState({selectedEmphasis:t})}};n.state={selectedLayout:String(t.options.layout)||String(C.s.none),selectedEmphasis:n.props.selectedEmphasis||B.e.None,siteLogoUrl:n.props.pageContext&&n.props.pageContext.webLogoUrl,hideTitle:n.props.options&&n.props.options.hideTitle,selectedLogoAlignment:String(t.selectedLogoAlignment)};n._isHubJoined=n.props.pageContext.hubSiteId&&!n.props.pageContext.isHubSite;return n}t.prototype.render=function(){return L.n.isFeatureEnabled(fe)?this._renderContentNew():this._renderContentOld()};return t})(g.e),pe=n(418),de=n(1538),ve=n(980),me=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.palette,t=void 0===e?{}:e,n=t.white||"transparent";return s.createElement("svg",{role:"presentation",className:"sp-ThemeListItem-svgIcon",viewBox:"0 0 84 46","aria-hidden":!0},s.createElement("rect",{height:"100%",width:"100%",fill:n,stroke:"none"}),this._renderShades(),s.createElement("text",{x:"10%",y:"84%",fill:t.neutralPrimary,role:"presentation"},this.props.sampleText))};t.prototype._renderShades=function(){var e=this.props.palette||{},t=this.props.isInverted;return[s.createElement("rect",{key:"primary",y:"0%",height:"50%",width:"50%",fill:e.themePrimary,stroke:"none"}),s.createElement("rect",{key:"secondary",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDark:e.themeSecondary,stroke:"none",x:"50%"}),s.createElement("rect",{key:"accent",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDarker:e.themeTertiary,stroke:"none",x:50+50/3+"%"}),s.createElement("rect",{key:"last",y:"0%",height:"50%",width:50/3+"%",fill:e.accent||e.themePrimary,stroke:"none",x:50+50/3+50/3+"%"})]};return t})(s.PureComponent),ge=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(this.props.selected!==e.selected){var t=e.selected;e.editable&&this.setState({buttonAnimation:t?O.t.fadeIn100:O.t.fadeOut100,titleAnimation:t?O.t.slideUpIn10:O.t.slideDownIn10})}else!this.props.selected&&this.state.buttonAnimation&&this.setState({buttonAnimation:void 0,titleAnimation:void 0})};t.prototype.render=function(){var e=this,t=this.props,n=t.selected,r=t.editable,o=t.themeOption,u=o.theme,a=o.name,f=o.isInverted,l={key:"choice",text:a};return s.createElement(b.e,{name:"ThemeListItems",selectedKey:n&&"choice",options:[Object(i.__assign)(Object(i.__assign)({},l),{onRenderLabel:function(){return s.createElement("div",{className:Object(d.e)("sp-ThemeListItem",n&&"sp-ThemeListItem-selected")},s.createElement("div",{className:"sp-ThemeListItem-container"},s.createElement("div",{"aria-hidden":!0,className:"sp-ThemeListItem-colorIcon"},s.createElement(me,{palette:u,isInverted:f,sampleText:F.e.themeSampleText})),s.createElement("div",{className:"sp-themeListItem-content"},s.createElement("div",{className:"sp-ThemeListItem-itemContentTitleContainer",style:Object(i.__assign)({},e.state.titleAnimation)},s.createElement("span",{className:"sp-ThemeListItem-choice"},a)),n&&r&&s.createElement(ve.e,{style:Object(i.__assign)({},e.state.buttonAnimation),className:"sp-ThemeListItem-commandButton","data-automationid":"ThemeListItemEditButton",onClick:e.props.onEditThemeClick,styles:{label:{margin:0}}},F.e.customizeThemeButton))))}})]})};return t})(g.e),ye=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){return s.createElement(de.e,{componentRef:this._resolveRef("_themeList"),role:"group",className:Object(d.e)("sp-ThemeList",this.props.className),items:this.props.themes,renderedWindowsAhead:4,onRenderCell:this._onRenderTheme.bind(this),"aria-labelledby":this.props["aria-labelledby"]})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.selectedThemeId!==this.props.selectedThemeId&&(e.selectedThemeId.listId!==this.props.themeListId&&this.props.selectedThemeId.listId!==this.props.themeListId||this.forceUpdate())};t.prototype.forceUpdate=function(){this._themeList.forceUpdate();e.prototype.forceUpdate.call(this)};t.prototype._onRenderTheme=function(e,t){var n=this,r=this.props.selectedThemeId,i=r.index===t&&this.props.themeListId===r.listId,o=i?void 0:function(r){return n._onThemeClick(r,e,t)};return s.createElement("div",{onClick:o,onFocus:o,title:e.name,"data-automationid":"ThemeListItem-"+t},s.createElement(ge,{themeOption:e,index:t,selected:i,onEditThemeClick:this.props.onEditThemeClick,editable:this.props.editEnabled}))};t.prototype._onThemeClick=function(e,t,n){this.props.onThemeClick&&this.props.onThemeClick(e,t,n)};return t})(g.e),be=n(1398),we=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onThemeClick=function(e,t,r,i,s){void 0===i&&(i=0);void 0===s&&(s=!1);!s&&n.props.onUneditableThemeClick&&n.props.onUneditableThemeClick();n.props.onThemeClick&&n.props.onThemeClick(e,t);n.setState({selectedThemeId:{listId:r,index:i}})};n._spThemeListLabel=Object(pe.e)("spThemeList");n.state={selectedThemeId:{index:0,listId:F.e.siteThemeHeader}};return n}t.prototype.focus=function(){this._focusZone.focus()};t.prototype.render=function(){var e=this.props,t=e.currentlyAppliedTheme,n=e.themes,r=e.defaultThemes,i=e.themeErrorText,o=e.currentlyAppliedThemeEditable,u=e.isThemeLocked,a=!u&&n&&n.length>0,f=!u&&r&&r.length>0,l=!u&&o;return s.createElement(be.e,{className:"sp-ThemeList-focusZone sp-ChangeTheLookPanel-content",componentRef:this._resolveRef("_focusZone"),ariaLabelledBy:this._spThemeListLabel},s.createElement("label",{id:this._spThemeListLabel,className:"sp-ThemeList-ariaLabel"},this.props.ariaLabel||F.e.themeListContainerAriaLabel),t&&this._renderThemeList(F.e.siteThemeHeader,[t],l),a&&this._renderThemeList(F.e.companyThemes,n),f&&this._renderThemeList(F.e.sharePointThemes,r,!0),i&&i)};t.prototype._renderThemeList=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=this.props.onEditThemeClick,o=this.state.selectedThemeId,u=String(Math.floor(1e4*Math.random()));return s.createElement("div",{key:e},s.createElement("div",{className:"sp-ChangeTheLookPanel-themeListHeader","data-automationid":"ThemeListHeader",id:u},e),s.createElement(ye,{themes:t,onThemeClick:function(t,i,s){return r._onThemeClick(t,i,e,s,n)},className:"sp-ChangeTheLookPanel-themeList",onEditThemeClick:i,selectedThemeId:o,themeListId:e,editEnabled:n,"aria-labelledby":u}))};return t})(g.e),Ee=n(4429),Se=n(486),xe={width:30,height:30},Te=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){var e=this;setTimeout(function(){e._focusZone&&e._focusZone.focus()},50)};t.prototype.render=function(){var e=this.props,t=e.onPrimaryColorClick,n=e.onAccentColorClick,r=e.currentPrimaryColor,o=e.currentAccentColor,u=e.primaryColors,a=e.accentColors;return s.createElement("div",{"aria-label":F.e.customizerAriaNavigationInstructions,ref:this._resolveRef("_focusZone"),className:Object(d.e)("sp-CustomizeTheme-container","sp-ChangeTheLookPanel-content"),tabIndex:0},s.createElement("div",{id:"sp-CustomizeTheme-accentTitle"},F.e.mainColor),s.createElement(Ee.e,{key:"primaryColors",className:"sp-CustomizeTheme-colorPicker",colorCells:this._convertColorsToCells(u),cellShape:"square",selectedId:r,columnCount:6,onColorChanged:function(e,n){return t(n)},shouldFocusCircularNavigate:!1,getColorGridCellStyles:function(){var e;return{colorCell:Object(i.__assign)(Object(i.__assign)({},xe),{selectors:(e={$svg:xe},e["."+Se.e+" &:focus $svg"]=xe,e[":hover $svg"]=xe,e[":focus $svg"]=xe,e[":active $svg"]=xe,e)}),svg:Object(i.__assign)(Object(i.__assign)({},xe),{boxSizing:"border-box"})}}}),a&&s.createElement("div",{className:"sp-CustomizeTheme-accentColors"},s.createElement("div",{key:"AccentColorsTitle"},F.e.accentColor),s.createElement(Ee.e,{key:"accentColors",className:"sp-CustomizeTheme-colorPicker",cellShape:"square",colorCells:this._convertColorsToCells(a),columnCount:6,selectedId:o,onColorChanged:function(e,t){return n(t)},getColorGridCellStyles:function(){var e;return{colorCell:Object(i.__assign)(Object(i.__assign)({},xe),{selectors:(e={$svg:xe},e["."+Se.e+" &:focus $svg"]=xe,e[":hover $svg"]=xe,e[":focus $svg"]=xe,e[":active $svg"]=xe,e)}),svg:Object(i.__assign)(Object(i.__assign)({},xe),{boxSizing:"border-box"})}}})))};t.prototype._convertColorsToCells=function(e){var t=this;return e.map(function(e,n){return{id:e,color:e,index:n,label:t.props.colorNameMap[e]}})};return t})(g.e),Ne=n(2339),Ce=n(3868),ke=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onPrimaryColorClick=function(e){var t=Object(i.__assign)(Object(i.__assign)({},n.state.currentTheme),{name:e,theme:Object(i.__assign)({},n.props.themes[e])});n.props.onPreviewThemeClick(null,t);n.setState({currentTheme:t,accentColors:n._getAccents(t)})};n._onAccentColorClick=function(e){var t=Object(i.__assign)(Object(i.__assign)({},n.state.currentTheme),{theme:Object(i.__assign)(Object(i.__assign)({},n.state.currentTheme.theme),{accent:e})});n.props.onPreviewThemeClick(null,t);n.setState({currentTheme:t})};var r=t.defaultTheme;n.state={currentTheme:r,primaryColors:n._loadPrimaryColors(t.themes),accentColors:n._getAccents(r)};n._defaultTheme=r;return n}t.prototype.render=function(){return s.createElement(Te,Object(i.__assign)({},this.getRenderProps()))};t.prototype.resetTheme=function(){this.props.onPreviewThemeClick(null,this._defaultTheme);this.setState({currentTheme:this._defaultTheme,accentColors:this._getAccents(this._defaultTheme)})};t.prototype.getCurrentTheme=function(){return this.state.currentTheme};t.prototype.getRenderProps=function(){var e=this.state,t=e.currentTheme,n=e.primaryColors,r=e.accentColors,i="#03787c",s=null;t&&t.theme&&t.theme.themePrimary&&(i=t.theme.themePrimary);t&&t.theme&&t.theme.accent&&(s=t.theme.accent);var o=t&&Object(Ne.t)(t.isInverted,t.theme.primaryBackground),u={};if(o)for(var a=0,f=Object.keys(o);a<f.length;a++){var l=f[a];if(Ce.e[l]){u[o[l]]=Ce.e[l]}}return{onPrimaryColorClick:this._onPrimaryColorClick,onAccentColorClick:this._onAccentColorClick,primaryColors:n,accentColors:r,currentPrimaryColor:i,currentAccentColor:s,colorNameMap:u}};t.prototype._loadPrimaryColors=function(e){var t=[];for(var n in e){var r=e[n];r&&r.themePrimary&&t.push(r.themePrimary)}return t};t.prototype._getAccents=function(e){var t=e.theme.themePrimary,n=e.isInverted,r=this.props.accentColorMap;return n?[t].concat(r[t]):r[t].concat([t])};return t})(g.e),Le=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){return this.props.isThemeLocked?s.createElement("div",{className:"sp-ChangeTheLookPanel-themeLockedText"},this.props.themeLockedText):this.props.editingTheme?this._renderEditTheme():this._renderThemesList()};t.prototype._renderThemesList=function(){var e=this.props,t=e.themes,n=e.errorText,r=e.defaultThemes,i=e.currentlyAppliedTheme,o=e.onThemeClick,u=e.onUneditableThemeClick,a=e.onEditThemeClick,f=e.currentThemeEditable,l=e.isThemeLocked,c=e.themeLockedText,h=t&&t.length>0,p=r&&r.length>0,d="";n||(h||p)||(d=w.e.noThemesFoundText||"");var v=l?c:void 0;return s.createElement("div",{"data-automationid":"ThemesListContainer"},s.createElement(we,{isThemeLocked:l,currentlyAppliedTheme:i,themeErrorText:d,themes:t,defaultThemes:r,onThemeClick:o,onUneditableThemeClick:u,onEditThemeClick:a,currentlyAppliedThemeEditable:f,ariaLabel:v}),n&&s.createElement("div",{key:"errorText",className:"sp-ChangeTheLookPanel-errorText"},n))};t.prototype._renderEditTheme=function(){var e=this.props,t=e.currentlySelectedTheme,n=e.colorThemes,r=e.accentColorMap,i=e.onThemeClick;return s.createElement(ke,{defaultTheme:t,themes:n,accentColorMap:r,onPreviewThemeClick:i})};return t})(g.e),Ae=n(3459);n.d(t,"e",function(){return Oe});var Oe=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._root=Object(s.createRef)();t._onDismiss=function(){t.props.onDismiss&&t.props.onDismiss()};t._onSave=function(e){t.props.onSave?t.props.onSave(e).then(function(){return t._onDismiss()}):t._onDismiss()};t._onCancel=function(e){if(t.props.onCancel){t.props.onCancel(e);t._onDismiss()}};t._renderFooterContent=function(){return t._isL2Panel?s.createElement("div",{className:"sp-ChangeTheLookPanel-footer"},s.createElement(a.e,{"data-automationid":"changethelookpanel-savebutton",onClick:t._onSave,className:"sp-ChangeTheLookPanel-footerButton",disabled:!t.props.saveEnabled},w.e.saveButton),s.createElement(f.e,{"data-automationid":"changethelookpanel-cancelbutton",onClick:t._onCancel,className:"sp-ChangeTheLookPanel-footerButton"},w.e.cancelButton)):s.createElement("div",{className:"sp-ChangeTheLookPanel-footer"},s.createElement("div",null,s.createElement(a.e,{"data-automationid":"changethelookpanel-savebutton",onClick:t._onSave,className:"sp-ChangeTheLookPanel-footerButton",disabled:!t.props.saveEnabled},w.e.saveButton),s.createElement(f.e,{"data-automationid":"changethelookpanel-cancelbutton",onClick:t._onCancel,className:"sp-ChangeTheLookPanel-footerButton"},w.e.cancelButton)),s.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinkContainer"},s.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinks"},s.createElement(p.e,{className:"sp-ChangeTheLookPanel-footerLink",href:t.props.changeTheLookPageLink},w.e.changeTheLookPageLinkText))))};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.isOpen,r=t.isLoading,i=t.isSaving,a=t.chromeOptions,f=t.isHubSite;return s.createElement(o.e,{type:u.e.smallFixedFar,className:"sp-ChangeTheLookPanel",onDismiss:this._onDismiss,isOpen:n,onRenderFooterContent:this._isL3Panel?void 0:this._renderFooterContent,onRenderNavigationContent:function(t,n){var r;switch(e.props.renderL2PanelType){case"Theme":r=w.e.themeCustomizationHeading;break;case"Header":r=w.e.headerCustomizationHeading;break;case"Nav":r=w.e.navCustomizationHeading;break;case"Footer":r=w.e.footerCustomizationHeading;break;default:r=w.e.title}if(e.props.renderL3PanelType)switch(e.props.renderL3PanelType){case"MUIEditing":r=W.e.Translations}return s.createElement(s.Fragment,null,s.createElement("div",{className:Object(d.e)("sp-ChangeTheLookPanel-headerContainer",e._isL2Panel&&"editing")},e._isL2Panel&&s.createElement(l.e,{iconProps:{iconName:"Back"},ariaLabel:Ae.e.backButtonAriaLabel,onClick:e.props.onBackButtonClick}),s.createElement("h4",{className:"sp-ChangeTheLookPanel-headerText"},r)),n(t))},closeButtonAriaLabel:w.e.cancelButton,isFooterAtBottom:!0,isBlocking:!1},s.createElement("div",{ref:this._root},!r&&!this._isL2Panel&&this._renderChromeCustomization("Theme",this.props.onEditChromeOptionsClick),!r&&!this._isL2Panel&&this._renderChromeCustomization("Header",this.props.onEditChromeOptionsClick),!r&&(a&&a.nav.placement===C.i.HORIZONTAL||f)&&!this._isL2Panel&&this._renderChromeCustomization("Nav",this.props.onEditChromeOptionsClick),!r&&a&&a.nav.placement===C.i.HORIZONTAL&&!this._isL2Panel&&this._renderChromeCustomization("Footer",this.props.onEditChromeOptionsClick),this._isL2Panel&&!r&&this._renderL2Panel(),r&&s.createElement("div",{key:"spinner",className:"sp-ChangeTheLookPanel-spinnerContainer",role:"alert"},s.createElement(y.e,{label:i?w.e.savingSpinner:w.e.loadingSpinner}))))};t.prototype.componentDidUpdate=function(e){var t=this;e.renderL2PanelType===this.props.renderL2PanelType&&e.isLoading===this.props.isLoading||setTimeout(function(){var e=Object(v.i)(t._root.current,t._root.current,!0);e&&e.focus()},50)};t.prototype._renderL2Panel=function(){switch(this.props.renderL2PanelType){case"Theme":return this._renderThemeCustomizer();case"Nav":return this._renderNavCustomization();case"Footer":return this._renderFooterCustomization();case"Header":return this._renderHeaderCustomizer()}};t.prototype._renderThemeCustomizer=function(){return s.createElement(Le,Object(i.__assign)({},this.props.themeCustomizerProps))};t.prototype._renderNavCustomization=function(){return s.createElement(N,{pageContext:this.props.pageContext,options:this.props.chromeOptions.nav,onChange:this.props.onChromeOptionsChanged,imageUrls:this.props.navImageUrls})};t.prototype._renderFooterCustomization=function(){return s.createElement(ee,{chromeOptions:this.props.chromeOptions.footer,onChromeOptionsChange:this.props.onChromeOptionsChanged,onFooterLinksEditClicked:this.props.onFooterLinksEditClicked,onL3ExitClick:this.props.exitL3Panel,cancelCallback:this._onCancel,footerOptions:this.props.footerOptions,onFooterOptionsChanged:this.props.onFooterOptionsChanged,emptyImageUrl:this.props.emptyImageUrl||"",pageContext:this.props.pageContext,onTranslationsButtonClick:this.props.onFooterTranslationClick,renderL3PanelType:this.props.renderL3PanelType,titleCurrentLCID:this.props.footerTitleCurrentLCID,titleKey:this.props.footerTitleKey})};t.prototype._renderHeaderCustomizer=function(){return s.createElement(he,Object(i.__assign)({},this.props.headerCustomizerProps))};Object.defineProperty(t.prototype,"_isL2Panel",{get:function(){return void 0!==this.props.renderL2PanelType&&""!==this.props.renderL2PanelType},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isL3Panel",{get:function(){return void 0!==this.props.renderL3PanelType&&""!==this.props.renderL3PanelType},enumerable:!0,configurable:!0});t.prototype._renderChromeCustomization=function(e,t){var n;switch(e){case"Theme":n=w.e.themeCustomizationHeading;break;case"Header":n=w.e.headerCustomizationHeading;break;case"Nav":n=w.e.navCustomizationHeading;break;case"Footer":n=w.e.footerCustomizationHeading}return s.createElement(c.e,{className:"sp-ChangeTheLookPanel-section","data-chrome-type":e,onClick:t},n,s.createElement(h.e,{iconName:Object(m.e)()?"Back":"Forward",className:"sp-ChangeTheLookPanel-drillDownArrow"}))};return t})(g.e)},"2170":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(3759),o=n(2337),u=n(650),a=n(1543),f=n(119),l=n(96),c=n(785),h=n(1377),p=n(1548),d=n(418),v=n(1387),m=n(178),g=n(1410),y=n(851),b=n(1416),w=n(3742),E=n(2338),S=n(2787),x=n(1394),T=n(969),N=n(3454),C=n(4171),k=n(600),L=n(20),A=n(4230),O=n(3851),M=n(4515),_=n(3455),D=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getColumns=function(e,t,r){return[{key:"column1",name:N.e.Name,fieldName:"Title",minWidth:1,isRowHeader:!0,isResizable:!1,isSorted:"Title"===t,isSortedDescending:r,sortAscendingAriaLabel:N.e.AscendingName,sortDescendingAriaLabel:N.e.DescendingName,onRender:n._renderNameColumn,onColumnClick:n._onColumnClick,data:"string",isPadded:!1,ariaLabel:N.e.Name},{key:"column2",name:N.e.Expiration,fieldName:"UserExpiration",minWidth:95,maxWidth:105,isSorted:"UserExpiration"===t,isSortedDescending:r,isResizable:!1,sortAscendingAriaLabel:N.e.AscendingDate,sortDescendingAriaLabel:N.e.DescendingDate,onColumnClick:n._onColumnClick,data:"number",className:"ms-UserExpirationList-ExpirationColumn",onRender:n._renderExpirationDate,isPadded:!1,ariaLabel:N.e.Expiration},{key:"column3",name:"",isResizable:!1,onRender:function(t){return n._renderOptionsBox(t,e)},minWidth:10,maxWidth:10,isPadded:!1}]};n._renderNoUsersMessage=function(){return n.state.filterText?i.createElement(A.e,{stickyPosition:O.e.Header},i.createElement("div",null,N.e.NoUsersFound)):i.createElement(A.e,{stickyPosition:O.e.Header},i.createElement("div",null,N.e.NoUsers))};n._renderButtonArea=function(){var e=n.state.isUserSelected;return i.createElement("div",{className:"ms-UserExpirationList-ButtonAreaPadding"},i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},!e&&n._renderSearch(),e&&n._renderButtons()))};n._renderSearch=function(){var e=n.state.filterText;return i.createElement(C.e,{placeholder:N.e.Search,className:"ms-UserExpirationList-Search",value:e,onChange:function(e,t){return n._searchForUser(t)},styles:{field:"ms-UserExpirationList-SearchField"}})};n._renderButtons=function(){var e={root:"ms-UserExpirationList-ButtonAreaButton"};return n.props.userExpirationPolicyEnabled?i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},i.createElement(b.e,{"data-automation-id":"CommandBarExtend",iconProps:{iconName:"DateTime2"},text:N.e.Extend,onClick:n._showExtendDialog,styles:e}),i.createElement(b.e,{"data-automation-id":"CommandBarExpire",iconProps:{iconName:"UserRemove"},text:N.e.RemoveAccess,onClick:n._showExpireDialog,styles:e})):i.createElement("div",{className:"ms-UserExpirationList-ButtonArea"},i.createElement(b.e,{"data-automation-id":"CommandBarClear",iconProps:{iconName:"RemoveEvent"},text:N.e.ClearExpiration,onClick:n._showClearDialog,styles:e}),i.createElement(b.e,{"data-automation-id":"CommandBarExpire",iconProps:{iconName:"UserRemove"},text:N.e.RemoveAccess,onClick:n._showExpireDialog,styles:e}))};n._renderList=function(){var e=n.state,t=e.users,r=e.columns,s=e.hasMoreUsers;return i.createElement(a.e,null,i.createElement(p.e,{"data-automation-id":"UserExpirationDetailsList",className:"ms-UserExpiration-UserExpirationList",checkboxCellClassName:"ms-UserExpirationList-Checkbox",items:t||[],compact:!1,columns:r,selectionMode:t&&t.length>0?f.t.multiple:f.t.none,layoutMode:l.i.justified,isHeaderVisible:!0,selection:n._selection,selectionPreservedOnEmptyClick:!0,enterModalSelectionOnTouch:!0,ariaLabelForSelectionColumn:N.e.ToggleSelection,ariaLabelForSelectAllCheckbox:N.e.SelectAll,onRowDidMount:function(e,t){n._onRenderItem(e,t)},constrainMode:l.r.horizontalConstrained,enableShimmer:t?0===t.length&&s:s,onRenderDetailsHeader:n._onRenderDetailsHeader,onRenderRow:n._onRenderRow}))};n._onRenderRow=function(e,t){return t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderCheck:n._onRenderCheck}))};n._onRenderCheck=function(e,t){void 0===t&&(t=c.e);return i.createElement(t,Object(r.__assign)({},e,{styles:{root:"ms-UserExpirationList-CheckBoxRoot",check:"ms-UserExpirationList-CheckBoxCheck",isDisabled:"ms-UserExpirationList-CheckBoxDisabled"}}))};n._onRenderDetailsHeader=function(e,t){return i.createElement(A.e,{stickyPosition:O.e.Header},t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderColumnHeaderTooltip:n._onRenderDetailsHeaderTooltip,onRenderDetailsCheckbox:n._onRenderDetailsCheckbox,styles:{cellIsCheck:"ms-UserExpirationList-CheckBoxRoot",check:"ms-UserExpirationList-CheckBoxRoot"}})))};n._onRenderDetailsCheckbox=function(e,t){return t(Object(r.__assign)({},e))};n._onRenderDetailsHeaderTooltip=function(e){return i.createElement(g.e,Object(r.__assign)({},e))};n._renderNameColumn=function(e){var t=n.state,r=t.isNameTooltipVisible,s=t.isEmailTooltipVisible;if(e){var o=e.uniqueId+"name",u=e.uniqueId+"nameTooltip",a=e.uniqueId+"email",f=e.uniqueId+"emailTooltip";return i.createElement("div",null,i.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i.createElement(g.e,{content:e.title,overflowMode:y.e.Parent,id:u,onTooltipToggle:n._onNameTooltip,calloutProps:{gapSpace:0,target:"#"+o}},i.createElement("span",{className:"ms-UserExpirationList-UserName","aria-labelledby":r?u:void 0,id:o},e.title))),i.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i.createElement(g.e,{content:e.email,overflowMode:y.e.Parent,id:f,onTooltipToggle:n._onEmailTooltip,calloutProps:{gapSpace:0,target:"#"+a}},i.createElement("span",{className:"ms-UserExpiratinLIst-UserEmail","aria-labelledby":s?f:void 0,id:a},e.email?e.email:""))))}};n._renderOptionsBox=function(e,t){var r=t?[{key:"extend",text:N.e.ExtendAccess,onClick:function(){n.setState({selectedUser:e,isExtendDialogVisible:!0})}},{key:"expire",text:N.e.RemoveAccess,onClick:function(){n.setState({selectedUser:e,isExpireDialogVisible:!0})}}]:[{key:"clear",text:N.e.ClearExpiration,onClick:function(){n.setState({selectedUser:e,isClearDialogVisible:!0})}},{key:"expire",text:N.e.RemoveAccess,onClick:function(){n.setState({selectedUser:e,isExpireDialogVisible:!0})}}],s={iconName:"MoreVertical",styles:{root:{fontSize:"16px"}}};return i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-actionButton",ariaLabel:"stringsResx.moreOptionsLabel",menuIconProps:s,menuProps:{shouldFocusOnMount:!0,items:r}})};n._renderExpirationDate=function(e){var t=n.state.isExpirationTooltipVisible;if(e.isExpiring)return i.createElement("div",null,N.e.Expiring);if(e.isExtending)return i.createElement("div",null,N.e.Extending);if(e.isClearing)return i.createElement("div",null,N.e.Clearing);var r=n.daysAway(e.expiration),s="ms-UserExpirationList-Expiration"+(r<7&&r>0?" Soon":"")+(e.isSiteAdmin?" Admin":""),o=e.uniqueId+"expiration",u=o+"tooltip";return i.createElement("div",null,i.createElement(g.e,{content:L.format(N.e.ExpiresTooltip,e.expiration.toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"})),id:u,onTooltipToggle:n._onExpirationTooltip,calloutProps:{gapSpace:0,target:"#"+o}},i.createElement("div",{className:s,id:o,"aria-labelledby":t?u:void 0},n._ExpirationDate(e))),e.isSiteAdmin&&n._renderAdminNotification(o))};n._renderAdminNotification=function(e){return i.createElement(g.e,{content:N.e.AdminWontExpireInfo,calloutProps:{gapSpace:0,target:"#"+e+"test"}},i.createElement(k.e,{id:e+"test",iconName:"Info",className:"ms-UserExpirationList-AdminWarning"}))};n._renderDialog=function(){var e,t,r,s,o,u,a,f=n.state,l=f.isExpireDialogVisible,c=f.isExtendDialogVisible,h=f.isClearDialogVisible,p=f.selectedUser,d=n.props.userExpirationPolicyDays,v=n._selection.getSelectedCount();if(p){o=p.title;u=p.email}else if(1===v){var m=n._selection.getSelection()[0];o=m.title;u=m.email}if(l){e=N.e.ExpireTitle;t=v<=1?L.format(N.e.ExpireMessage,o,u):L.formatWithLocalizedCountValue(N.e.ExpireMessagePlural,N.e.ExpireMessageInterval,v);r=N.e.ExpireConfirm;s=N.e.Cancel;if(p){var g=[];g.push(p);a=function(){n._expireNow(g);n._closeDialog()}}else a=function(){n._expireNow(n._selection.getSelection());n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else if(c){var y=new Date;y.setDate(y.getDate()+d);e=N.e.ExtendTitle;t=v<=1?L.format(N.e.ExtendMessage,o,u,y.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})):L.format(L.getLocalizedCountValue(N.e.ExtendMessagePlural,N.e.ExtendMessageInterval,v),v,y.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}));r=N.e.ExtendConfirm;s=N.e.Cancel;if(p){var b=[];b.push(p);a=function(){n._setUserExpiration(b,y);n._closeDialog()}}else a=function(){n._setUserExpiration(n._selection.getSelection(),y);n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else if(h){e=N.e.ClearTitle;t=v<=1?L.format(N.e.ClearMessage,o,u):L.formatWithLocalizedCountValue(N.e.ClearMessagePlural,N.e.ClearMessageInterval,v);r=N.e.ClearConfirm;s=N.e.Cancel;if(p){var C=[{}];C.push(p);a=function(){n._clearExpiration(C);n._closeDialog()}}else a=function(){n._clearExpiration(n._selection.getSelection());n._selection.setItems(n._selection.getSelection(),!0);n._closeDialog()}}else n._closeDialog();return i.createElement(w.e,{hidden:!1,onDismiss:n._closeDialog,dialogContentProps:{type:E.e.normal,title:e,subText:t},modalProps:{isBlocking:!1,containerClassName:"ms-dialogMainOverride"}},i.createElement(S.e,null,i.createElement(x.e,{onClick:a,text:r}),i.createElement(T.e,{onClick:n._closeDialog,text:s})))};n._onNameTooltip=function(e){n.setState({isNameTooltipVisible:e})};n._onEmailTooltip=function(e){n.setState({isEmailTooltipVisible:e})};n._onExpirationTooltip=function(e){n.setState({isExpirationTooltipVisible:e})};n._showExtendDialog=function(){n.setState({isExtendDialogVisible:!0})};n._showClearDialog=function(){n.setState({isClearDialogVisible:!0})};n._showExpireDialog=function(){n.setState({isExpireDialogVisible:!0})};n._clearExpiration=function(e){e.forEach(function(e){e.isClearing=!0});n._updateUsers(e);n._userExpirationProvider.setUserExpiration(e,void 0).then(function(t){var r=[];t.forEach(function(t,n){t?r.push(e[n]):e[n].isClearing=!1});n._removeUsers(r);return e.filter(function(e,n){return!t[n]})}).then(function(e){if(e.length>0){e.forEach(function(t,n){e[n].isExpiring=!1});n._updateUsers(e)}})};n._fetchExpiringUsers=function(){var e=n.state,t=e.orderBy,r=e.ascending,i=e.filterText,s=e.hasMoreUsers,o=e.allUsers,u=n.props.pageSize;if(s){var a;a=o?n.state.allUsers:[];n._userExpirationProvider.getUsersWithExpirationsWithCache(t,r,u,a.length,void 0,3).then(function(e){if(Array.isArray(e)&&e.length>0){e.forEach(function(e){e.uniqueId=Object(d.e)();a.push(e)});var t=n._mergeInNewUsers(e),r=n.filterUsers(i,t),s=e.length===u&&r&&r.length<u;n.setState({allUsers:t,users:r,hasMoreUsers:e.length===u});return s}n.setState({hasMoreUsers:!1});return!1}).then(function(e){e&&n._fetchExpiringUsers()}).catch(function(e){m.e.logData({name:"error fetching users"})})}};n._setUserExpiration=function(e,t){e.forEach(function(e){e.isExtending=!0});n._updateUsers(e);n._userExpirationProvider.setUserExpiration(e,t).then(function(r){var i=!1;r.forEach(function(n,r){n?e[r].expiration=t:i=!0;e[r].isExtending=!1});n._updateUsers(e);return i}).then(function(e){})};n._expireNow=function(e){e.forEach(function(e){e.isExpiring=!0});n._updateUsers(e);n._userExpirationProvider.expireUser(e).then(function(t){var r=e.filter(function(e,n){return t[n]});n._removeUsers(r);return e.filter(function(e,n){return!t[n]})}).then(function(e){if(e.length>0){e.forEach(function(t,n){e[n].isExpiring=!1});n._updateUsers(e)}})};n._removeUsers=function(e){var t=n.state,r=t.allUsers,i=t.filterText,s=n._mapUsers(e),o=r.filter(function(e){return!(e.id in s)});n.setState({allUsers:o.concat(),users:n.filterUsers(i,o)},function(){o.length<=10&&n._fetchExpiringUsers()})};n._updateUsers=function(e){var t=n.state,r=t.allUsers,i=t.filterText,s=n._mapUsers(e),o=r.map(function(e){return s[e.id]||e});n.setState({allUsers:o,users:n.filterUsers(i,o)})};n._mergeInNewUsers=function(e){var t=n.state.allUsers;if(t&&t.length>0){var i=n._mapUsers(t),s=e.filter(function(e){return!(e.id in i)});return Object(r.__spreadArrays)(t,s)}return e};n._mapUsers=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i.id]=i}return t};n._sort=function(e,t,n){var r=t?function(e,t){return e.title.toLocaleUpperCase().localeCompare(t.title.toLocaleUpperCase())}:function(e,t){return e.expiration.valueOf()-t.expiration.valueOf()};e.sort(r);n&&e.reverse();return e};n._closeDialog=function(){n.setState({isExpireDialogVisible:!1,isExtendDialogVisible:!1,isClearDialogVisible:!1,selectedUser:void 0})};n._onRenderItem=function(e,t){var r=n.state.users;(t===r.length-10||r.length<10&&t===r.length-1)&&n._fetchExpiringUsers()};n._ExpirationDate=function(e){var t=e.expiration,r=n.daysAway(t);return r<7&&r>0?L.formatWithLocalizedCountValue(N.e.DaysLeft,N.e.DaysLeftInterval,r):t.toLocaleString("en-us",{month:"short",day:"numeric"})};n.daysAway=function(e){var t=e.getTime(),n=Date.now();return Math.ceil((t-n)/864e5)};n._getSelectionDetails=function(){return n._selection.getSelectedCount()>0};n._onColumnClick=function(e,t){var i=n.state,s=i.columns,o=i.hasMoreUsers,u=i.users,a=s.map(function(e){var n=e.key===t.key;return Object(r.__assign)(Object(r.__assign)({},e),{isSorted:n,isSortedDescending:n&&!e.isSortedDescending})});o?n.setState({allUsers:[],hasMoreUsers:!0,orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a},function(){return n._fetchExpiringUsers()}):n.setState({users:Object(r.__spreadArrays)(n._sort(u,"Title"===t.fieldName,!t.isSortedDescending)),orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a})};n._searchForUser=function(e){var t=n.state.allUsers;t&&t.length>0?n.setState({filterText:e,users:n.filterUsers(e,t)},function(){var e=n.state.users;e&&e.length<10&&n._fetchExpiringUsers()}):n.setState({filterText:e})};n.filterUsers=function(e,t){var n=e.toLocaleUpperCase();return t&&t.length>0?t.filter(function(e){return e&&e.email&&e.email.toLocaleUpperCase().indexOf(n)>-1||e&&e.title&&e.title.toLocaleUpperCase().indexOf(n)>-1}):t};n._userExpirationProvider=t.userExpirationProvider;var s=n._getColumns(t.userExpirationPolicyEnabled,"UserExpiration",!1);n._selection=new h.e({onSelectionChanged:function(){n.setState({isUserSelected:n._getSelectionDetails()})}});n.state={users:void 0,allUsers:void 0,columns:s,isUserSelected:n._getSelectionDetails(),isNameTooltipVisible:!1,isEmailTooltipVisible:!1,isExpirationTooltipVisible:!1,isClearDialogVisible:!1,isExpireDialogVisible:!1,isExtendDialogVisible:!1,selectedUser:void 0,hasMoreUsers:!0,orderBy:"UserExpiration",ascending:!0,filterText:""};return n}t.prototype.render=function(){var e=this.state,t=e.users,n=e.isExtendDialogVisible,r=e.isClearDialogVisible,s=e.isExpireDialogVisible,o=e.hasMoreUsers,u=!(t&&0!==t.length||o);return i.createElement("div",{className:"ms-userExpirationList"},this._renderButtonArea(),i.createElement(M.e,{scrollbarVisibility:_.t.always,className:"ms-userExpirationList-ScrollablePane"},this._renderList(),u&&this._renderNoUsersMessage()),(s||n||r)&&this._renderDialog())};t.prototype.componentDidMount=function(){this._fetchExpiringUsers()};t.prototype.componentDidUpdate=function(e){e.userExpirationPolicyEnabled!==this.props.userExpirationPolicyEnabled&&this.setState({columns:this._getColumns(this.props.userExpirationPolicyEnabled,this.state.orderBy,this.state.ascending)})};return t})(i.Component),P=Object(u.e)(D,function(e){return{root:[],label:{}}});n.d(t,"e",function(){return B});var H=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._renderCloseButton=function(){var e={iconName:"cancel",styles:{root:"ms-UserExpiration-CloseButton"}};return i.createElement("div",{className:"ms-UserExpiration-Navigation"},i.createElement(v.e,{"data-is-focusable":!0,ariaLabel:"Close panel",iconProps:e,onClick:n._closePanel}))};n._renderHeader=function(){var e=n.props.userExpirationPolicyDays,t=n.state.hideNoExpirationPolicyInfo,r={iconName:"Back",styles:{root:"ms-UserExpirationPanel-Back"}};return i.createElement("div",{className:"ms-UserExpirationPanel-Header"},i.createElement("div",{className:"ms-UserExpirationPanel-TitleRow"},i.createElement("div",{className:"ms-UserExpirationPanel-Title"},n.props.onBackButton&&i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-BackButton",ariaLabel:N.e.Back,iconProps:r,onClick:n._onBackButton}),N.e.userExpiration),n._renderCloseButton()),i.createElement("div",{className:"ms-UserExpirationPanel-HeaderText"},L.formatWithLocalizedCountValue(N.e.Header,N.e.userExpirationHeaderInterval,e)),!t&&n._renderNoExpirationPolicyInfo())};n._renderGuestExpiration=function(){var e=n.props,t=e.userExpirationPolicyDays,r=e.userExpirationPolicyEnabled;return i.createElement("div",{className:"ms-UserExpirationList"},i.createElement(P,{userExpirationProvider:n.props.userExpirationProvider,userExpirationPolicyDays:t,userExpirationPolicyEnabled:r,pageSize:50}))};n._renderNoExpirationPolicyInfo=function(){if(!n.props.userExpirationPolicyEnabled){return i.createElement("div",{className:"ms-UserExpiration-NoPolicy"},i.createElement(k.e,{iconName:"Error",className:"ms-UserExpiration-Warning"}),i.createElement("div",{className:"ms-UserExpiration-NoPolicyText"},N.e.NoPolicySetInfo),i.createElement(v.e,{"data-is-focusable":!0,className:"ms-UserExpiration-HideNoPolicyInfo",ariaLabel:"hide no policy info",menuIconProps:{iconName:"cancel"},onClick:n._hideNoPolicyInfo}))}};n._hideNoPolicyInfo=function(){n.setState({hideNoExpirationPolicyInfo:!0})};n._closePanel=function(){n.setState({showPanel:!1});n.props.onDismiss&&n.props.onDismiss()};n._onBackButton=function(){n.setState({showPanel:!1});n.props.onBackButton&&n.props.onBackButton()};n.state={showPanel:!0,hideNoExpirationPolicyInfo:!1};return n}t.prototype.render=function(){return i.createElement(s.e,{className:"ms-UserExpirationPanel",isOpen:this.props.isOpen,type:o.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,forceFocusInsideTrap:!1,styles:{content:"ms-UserExpirationPanel-content",scrollableContent:"ms-UserExpirationPanel-ScrollableContent"},onRenderHeader:this._renderHeader,hasCloseButton:!1,onRenderBody:this._renderGuestExpiration})};return t})(i.Component),B=Object(u.e)(H,function(e){return{root:[],label:{}}})},"2177":function(e,t,n){"use strict";n.r(t);var r=n(2125);n.d(t,"TeamifyBanner",function(){return r.e});n.d(t,"default",function(){return r.e})},"2196":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(1872),o=n(2169),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._changeTheLookPanelStateManager=new s.e(Object(r.__assign)(Object(r.__assign)({},t),{updateState:n.setState.bind(n)}));n._changeTheLookPanelStateManager.getRenderProps().then(function(e){return n.setState(e)});return n}t.prototype.componentDidMount=function(){this._changeTheLookPanelStateManager.componentDidMount()};t.prototype.render=function(){return this.state&&i.createElement(o.e,Object(r.__assign)({},this.state))};return t})(n(835).e)},"2231":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(3759),o=n(2337),u=n(1387),a=n(2175),f=n(1819),l=n(1326),c=n(115),h=n(38),p=n(1398),d=n(290),v=n(600),m=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onClick=function(){r.setState({isContextualMenuVisible:!r.state.isContextualMenuVisible})};r._onDismiss=function(e){r.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};r._resolveMenu=function(e){return r.menu=e};r.state={isContextualMenuVisible:!1};return r}t.prototype.render=function(){return this.props.menuItems?i.createElement("div",{className:"ms-sitePerm-ContextMenuButton","data-automationid":"SitePermissionsPersonaContextMenuButton"},i.createElement(p.e,{direction:d.e.horizontal},i.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveMenu},i.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0,"data-automationid":"SitePermissionsPersonaContextMenuButton","aria-expanded":!!this.state.isContextualMenuVisible},this.props.permLevelTitle,i.createElement(v.e,{iconName:"ChevronDown",className:Object(h.e)("ms-sitePermMenu-chevron",this.props.permLevelTitle&&"has-permLevelTitle")}))),this.state.isContextualMenuVisible&&i.createElement(l.e,{className:"ms-sitePerm-PersonaContextMenu",items:this.props.menuItems,isBeakVisible:!1,target:this.menu,directionalHint:c.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0}))):i.createElement("div",{className:"ms-sitePerm-noButtonArea","data-automationid":"SitePermissionsNoButtonArea"},this.props.permLevelTitle)};return t})(i.Component),g=n(470),y=n(111),b=n(1381),w=n(71),E=n(3853),S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(){n.setState({isExpanded:!n.state.isExpanded})};n._onLPCOpen=function(){n.props.isLPCOpenHandler&&n.props.isLPCOpenHandler(!0)};n._onLPCClose=function(){n.props.isLPCOpenHandler&&n.props.isLPCOpenHandler(!1)};n.state={isExpanded:t&&t.hideHeader};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.personas,r=t.hideHeader,s=this.state.isExpanded;return i.createElement("div",{className:"ms-sitePerm-body","data-automationid":"SitePermissionsBody"},i.createElement(p.e,{direction:d.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(g.t)(y.e.right)}},!r&&i.createElement("span",{className:"ms-sitePerm-itemBtn",onClick:this._onClick,"data-is-focusable":!0,"data-automationid":"SitePermHeader"+t.permLevel,"aria-expanded":!!s,role:"button"},i.createElement(v.e,{iconName:"ChevronDown",className:Object(h.e)("ms-sitePerm-chevron",s&&"is-expanded")}),i.createElement("span",{className:"ms-sitePerm-itemBtn-title","data-automationid":"SitePermissionsBodyButton"},t.title)),i.createElement("div",{className:"ms-sitePerm-personaContainer"},s&&n&&n.length?n.map(function(t,n){if(t.currentUserCannotViewMembers)return i.createElement("div",{className:"ms-sitePerm-cannotViewMembersText"},E.e.cannotViewMembersText);var r=e._getPersonaControl(t);return e._getPersona(r,t,n)}):s&&i.createElement("div",{className:"ms-sitePerm-emptyGroupText"},E.e.emptyGroupText))))};t.prototype._makeDeferredLpcProps=function(e){var t,n=2===e.type?"Group":"User";t={cardParameters:{personaInfo:{identifiers:{Smtp:e.groupId?void 0:e.email,PersonaType:n,Upn:e.email,AadObjectId:e.groupId,DisplayName:e.name}},behavior:{onCardOpen:this._onLPCOpen,onCardClose:this._onLPCClose}}};return{personaType:n,identifier:e.email,pageContext:this.props.pageContext,moduleLoader:this.props.lpcModuleLoader,customWaiter:this.props.lpcModuleCustomWaiter,addGroupMembersCallback:void 0,lpcHoverTargetProps:void 0,lpcHoverTargetV2Props:t}};t.prototype._wrapPersona=function(e){var t=this;return function(n,r){var s=t._makeDeferredLpcProps(e);return Object(b.t)(s,i.createElement("div",null,r(n)))}};t.prototype._getPersonaControl=function(e){var t=!w.e.isActivated("C3DECEDD-44C3-4A2F-8DA3-27AB01A6E1E1","05/21/2018","LPC interactivity in SiteSettings Panel")&&this.props.lpcModuleLoader?this._wrapPersona(e):void 0;return i.createElement(a.e,{"data-is-focusable":!0,imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,primaryText:e.name,size:f.n.small,hidePersonaDetails:!1,onRenderCoin:t,onRenderInitials:t,onRenderPrimaryText:t,"data-automationid":"SitePermissionsPersonaControl"},i.createElement(m,{menuItems:e.menuItems,title:this.props.title,permLevelTitle:this.props.permLevelTitle}))};t.prototype._getPersona=function(e,t,n){return i.createElement("div",{className:"ms-sitePerm-Persona",title:t.name,key:n+t.name,"data-automationid":"SitePermissionsPersona"},i.createElement("div",{className:"ms-sitePerm-personName","data-automationid":"SitePermissionsPersonaName"},e))};return t})(i.Component),x=n(1394),T=n(969),N=n(1879),C=n(2999),k=n(2014),L=n(1396),A=n(1544),O=n(178),M=n(4560),_=n(2965),D=n(2122),P=n(73),H=n(4185),B=n(1546),j=n(94),F=n(42),I=n(20),q=n(3846),R=n(1640);function U(e){for(var t=e.selectedItems,n=e.sharingLinkKind,r=e.canAddExternalPrincipal,s=e.hasDlpPolicyTip,o=e.viewPolicyTipCallback,u=e.permissionsMap,a=0,f=t;a<f.length;a++){var l=f[a];if(!l.isResolved)return s&&!r?i.createElement("div",null,i.createElement("span",null,q.e.PolicyTipNotifyAndBlock," "),i.createElement(A.e,{onClick:o},q.e.ViewPolicyTip)):l.rawData?l.rawData.Description:i.createElement("span",null,q.e.noExactMatch);if(l.isExternal&&l.principalType===R.e.distributionList&&2===l.entityType)return i.createElement("span",null,q.e.peoplePickerErrorDLNotSupported);var c=3===n||2===n;if(l.isExternal&&c)return i.createElement("span",null,q.e.peoplePickerErrorCsl)}if(u&&1===n){var h=0;for(var p in u)1===u[p]&&h++;if(1===h)return i.createElement("span",null,q.e.insufficientPermissionsError);if(h>1)return i.createElement("span",null,q.e.insufficientPermissionsErrorPlural)}return null}var z,W,X,V=n(1779),$=n(77),J=n(3452),K=n(107),Q=n(4534),G=n(650),Y=n(3849),Z=n(4514),ee=n(4149),te=n(2040),ne=n(3742),re=n(2338),ie=n(2787);(function(e){e[e.Default=0]="Default";e[e.Email=1]="Email"})(z||(z={}));(function(e){e[e.FileFolderSite=0]="FileFolderSite";e[e.FileFolder=1]="FileFolder";e[e.None=2]="None"})(W||(W={}));(function(e){e[e.Unspecified=0]="Unspecified";e[e.On=1]="On";e[e.Off=2]="Off"})(X||(X={}));var se=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.onDismiss=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();O.e.logData({name:"SiteSharingSettingsPanel.OnDismiss.Click"})};n.onBackButtonClick=function(){if(!n.hasInvalidSettings()&&n.haveSettingsChanged())n.setState({showConfirmDialog:!0});else{n.resetState();n.props.onDismiss&&n.props.onDismiss()}O.e.logData({name:"SiteSharingSettingsPanel.BackButton.Click"})};n.onSaveClick=function(){var e=n.state.selectedPersons&&1===n.state.selectedPersons.length?n.state.selectedPersons[0]:null,t="someone@example.com",r=!1;n.state.accessRequestEnabled?n.state.accessRequestOption===z.Email?t=e.email:r=!0:t="";n.setMembersCanShareFromOption(n.state.membersCanShareOption);var i={membersCanShare:n.membersCanShareEnabled,requestAccessEmail:t,useAccessRequestDefault:r,accessRequestSiteDescription:n.state.accessRequestSiteDescription,defaultMembersGroupAddMembers:n.membersCanShareEnabled&&n.membersCanAddToGroupEnabled,membersGroup:n.siteSharingSettings.membersGroup,ownersGroup:n.siteSharingSettings.ownersGroup};n.sharingSiteProvider.setSiteSharingSettings(i).then(function(e){n.siteSharingSettings=i;n.setState({showLoadingSpinner:!1});n.props.onDismiss&&n.props.onDismiss()},function(e){var t=[];if(e&&e.hasError&&e.items)for(var r=e.items,i=0;i<r.length;i++){var s=r[i];s&&s.error&&t.push(s.error.message)}n.setState({showLoadingSpinner:!1,saveFailed:!0,serverErrorDetails:t})});n.setState({showLoadingSpinner:!0,showConfirmDialog:!1});O.e.logData({name:"SiteSharingSettingsPanel.Save.Click"})};n.onDiscardClick=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();O.e.logData({name:"SiteSharingSettingsPanel.Discard.Click"})};n.onAccessRequestChange=function(){n.setState({accessRequestEnabled:!n.state.accessRequestEnabled});O.e.logData({name:"SiteSharingSettingsPanel.AccessRequest.Click"})};n.onAccessRequestSiteDescriptionChange=function(e,t){n.setState({accessRequestSiteDescription:t});O.e.logData({name:"SiteSharingSettingsPanel.AccessRequestSiteDescription.Click"})};n.onAccessRequestOptionChanged=function(e,t){n.setState({accessRequestOption:z[t.key]})};n.onMembersCanShareOptionChanged=function(e,t){n.setState({membersCanShareOption:W[t.key]})};n.onSelectedPeopleChange=function(e){var t,r=U({selectedItems:e});if(!r&&e.length>0){e[0].email||(r=i.createElement("span",null,Y.e.selectedPersonNoEmailError))}r&&(t=i.createElement(B.e,{className:"ms-siteSharingSettingsPanel-peoplePicker-error",messageBarType:j.e.error},r));var s=e.length>0&&!t;n.setState({selectedPersons:e,peoplePickerError:t,personaSelected:s})};n.onSuggestionSelected=function(e){return n.peoplePickerProvider.resolve(e.userId,n.pickerParams).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);return e})};n.onDiscardDialogClick=function(){n.resetState();n.props.onDismiss&&n.props.onDismiss();O.e.logData({name:"SiteSharingSettingsPanel.DialogDiscard.Click"})};n.onDismissSaveErrorMessage=function(){n.setState({saveFailed:!1,serverErrorDetails:[]});O.e.logData({name:"SiteSharingSettingsPanel.ErrorMessage.Click"})};n.state={showLoadingSpinner:!0};n.peoplePickerProvider=t.peoplePickerProvider;n.sharingSiteProvider=t.sharingSiteProvider;n.pickerParams={principalSource:15,principalType:7,allowEmailAddresses:!0,maximumEntitySuggestions:30,forceResolve:!0};O.e.logData({name:"SiteSharingSettingsPanel.Opened.Click"});return n}t.prototype.render=function(){var e=this,t=this.props,n=t.pageContext,r=t.isOpen,a=this.state,f=a.showLoadingSpinner,l=a.accessRequestOption,c=a.membersCanShareOptionDisabled,h=a.membersCanShareOption,p=a.accessRequestEnabled,d=a.accessRequestSiteDescription,v=a.selectedPersons,m=a.peoplePickerError,g=a.showConfirmDialog,y={iconName:"Back"};return i.createElement(s.e,{className:"ms-siteSharingSettingsPanel",isOpen:r,type:o.e.smallFixedFar,onDismiss:this.onDismiss,isLightDismiss:!0,forceFocusInsideTrap:!1,closeButtonAriaLabel:Y.e.closeButtonAriaLabel,onRenderNavigationContent:function(t,n){return i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-siteSharingSettingsPanel-Header"},i.createElement("div",{className:"ms-siteSharingSettingsPanel-Title-Container"},i.createElement(u.e,{"data-is-focusable":!0,className:"ms-siteSharingSettings-BackButton",ariaLabel:Y.e.closeButtonAriaLabel,iconProps:y,onClick:e.onBackButtonClick}),i.createElement("p",{className:"ms-siteSharingSettingsPanel-Title"}," ",Y.e.siteSharingSettingsPanelHeader))),n(t))},onRenderFooterContent:function(t,n){return i.createElement("div",{className:"ms-siteSharingSettingsPanel-Footer"},i.createElement(x.e,{className:"ms-siteSharingSettingsPanel-saveButton",onClick:e.onSaveClick,"data-automationid":"SiteSharingSettingsPanelSaveButton",disabled:e.hasInvalidSettings()||!e.haveSettingsChanged()},Y.e.saveButtonText),i.createElement(T.e,{className:"ms-siteSharingSettingsPanel-discardButton",onClick:e.onDiscardClick,"data-automationid":"SiteSharingSettingsPanelPanelDiscardButton"},Y.e.discardButtonText),e.state.saveFailed&&i.createElement("div",{className:"ms-groupMember-errorMessage"},i.createElement(B.e,{messageBarType:j.e.error,isMultiline:!0,onDismiss:e.onDismissSaveErrorMessage,dismissButtonAriaLabel:Y.e.closeButtonAriaLabel},i.createElement("span",null,Y.e.saveFailureMessage),e.state.serverErrorDetails.map(function(e){return i.createElement("span",null,e)}))))},styles:{content:"siteSharingSettingsPanel-content"}},i.createElement("div",{className:"ms-siteSharingSettingsPanel-Content"},!f&&i.createElement("div",null,i.createElement("div",{className:"SiteSharingSettingsPanelDescription","data-automationid":"SiteSharingSettingsPanelDescription"},Y.e.siteSharingSettingsPanelDescription),c?i.createElement(te.e,{className:"ms-siteSharingSettingsPanel-tenantAdminMembersCanShareMessage"},Y.e.tenantAdminMembersCanShareMessage):null,i.createElement("div",{className:"ms-siteSharingSettingsPanel-SharingPermissionsChoiceGroup"},i.createElement(ee.e,{selectedKey:W[h],options:[{key:W[0],text:Y.e.membersCanShareChoiceFileFolderSite},{key:W[1],text:Y.e.membersCanShareChoiceFileFolder},{key:W[2],text:Y.e.membersCanShareChoiceNone}],label:Y.e.membersCanShareHeader,styles:{applicationRole:{marginBottom:48},label:{fontWeight:"600",fontSize:16}},required:!1,disabled:c,onChange:this.onMembersCanShareOptionChanged})),i.createElement("div",{className:"ms-siteSharingSettingsPanel-sectionHeader"},i.createElement(te.e,{className:"ms-siteSharingSettingsPanel-sectionHeaderLabel"},Y.e.accessRequestHeader)),i.createElement(Z.e,{checked:p,label:Y.e.accessRequestToggleLabel,inlineLabel:!0,onChange:this.onAccessRequestChange,onText:Y.e.toggleOnText,offText:Y.e.toggleOffText,styles:{root:{justifyContent:"space-between"}}}),p&&i.createElement("div",{className:"ms-siteSharingSettingsPanel-AccessRequestsChoiceGroup"},i.createElement(ee.e,{selectedKey:z[l],options:[{key:z[0],text:this.siteSharingSettings.ownersGroup&&this.siteSharingSettings.ownersGroup.title||Y.e.accessRequestOwnersGroupRadioButtonLabel},{key:z[1],text:Y.e.accessRequestEmailRadioButtonLabel}],label:Y.e.accessRequestChoicesDescription,required:!1,onChange:this.onAccessRequestOptionChanged,styles:{applicationRole:{marginBottom:16},label:{fontWeight:"600"}}})),p&&l===z.Email&&i.createElement("div",{className:"ms-siteSharingSettingsPanel-container"},i.createElement(N.e,{noResultsFoundText:" ",context:n,peoplePickerType:k.e.normal,onSelectedPersonasChange:this.onSelectedPeopleChange,onSuggestionSelected:this.onSuggestionSelected,dataProvider:this.peoplePickerProvider,itemLimit:1,peoplePickerQueryParams:this.pickerParams,selectedItems:v}),m),p&&i.createElement(_.e,{label:Y.e.accessRequestSiteDescriptionLabel,className:"ms-siteSharingSettingsPanel-textField",placeholder:Y.e.accessRequestSiteDescriptionPlaceholder,multiline:!0,rows:4,resizable:!1,value:d,onChange:this.onAccessRequestSiteDescriptionChange,maxLength:500,styles:{subComponentStyles:{label:{root:{paddingBottom:16}}}}})),f&&i.createElement(L.e,null),i.createElement(ne.e,{hidden:!g,className:"ms-siteSharingSettingsPanel-confirmDialog",onDismiss:this.onDiscardDialogClick,dialogContentProps:{type:re.e.normal,title:Y.e.dialogTitleText},modalProps:{isBlocking:!1}},i.createElement(ie.e,null,i.createElement(x.e,{className:"ms-siteSharingSettingsPanel-saveButton",onClick:this.onSaveClick,text:Y.e.saveButtonText}),i.createElement(T.e,{className:"ms-siteSharingSettingsPanel-discardButton",onClick:this.onDiscardDialogClick,text:Y.e.discardButtonText})))))};t.prototype.componentDidMount=function(){this.loadSiteSharingSettings()};t.prototype.loadSiteSharingSettings=function(){var e=this;this.getSiteSharingSettings().then(function(){e.setState({showLoadingSpinner:!1,membersCanShareOption:e.getMembersCanShareOption(),membersCanShareOptionDisabled:e.siteSharingSettings&&e.siteSharingSettings.tenantAdminMembersCanShare&&e.siteSharingSettings.tenantAdminMembersCanShare!==X.Unspecified,accessRequestEnabled:e.siteSharingSettings&&(e.siteSharingSettings.useAccessRequestDefault||!!e.siteSharingSettings.requestAccessEmail),accessRequestOption:!e.siteSharingSettings||!e.siteSharingSettings.useAccessRequestDefault&&e.siteSharingSettings.requestAccessEmail?z.Email:z.Default,requestAccessEmail:e.siteSharingSettings&&e.siteSharingSettings.requestAccessEmail,accessRequestSiteDescription:e.siteSharingSettings&&e.siteSharingSettings.accessRequestSiteDescription});e.state.requestAccessEmail?e.peoplePickerProvider.resolve(e.state.requestAccessEmail,e.pickerParams).then(function(t){!t.email&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);e.setState({selectedPersons:[t],showLoadingSpinner:!1,personaSelected:!0})}):e.setState({showLoadingSpinner:!1})})};t.prototype.getSiteSharingSettings=function(){var e=this;return this.sharingSiteProvider.getSiteSharingSettings().then(function(t){e.siteSharingSettings=t}).catch(function(t){e.siteSharingSettings=void 0})};t.prototype.haveSettingsChanged=function(){var e=this.state,t=e.accessRequestOption,n=e.membersCanShareOption,r=e.accessRequestEnabled,i=e.accessRequestSiteDescription,s=e.selectedPersons,o=e.personaSelected,u=r&&t===z.Email&&o?s[0].email:"";this.setMembersCanShareFromOption(n);return this.siteSharingSettings&&(this.siteSharingSettings.membersCanShare!==this.membersCanShareEnabled||this.siteSharingSettings.membersGroup&&this.siteSharingSettings.membersGroup.allowMembersEditMembership!==this.membersCanAddToGroupEnabled||this.siteSharingSettings.requestAccessEmail!==u||this.siteSharingSettings.useAccessRequestDefault!==(r&&t===z.Default)||this.siteSharingSettings.accessRequestSiteDescription!==i)};t.prototype.hasInvalidSettings=function(){return this.state.accessRequestEnabled&&this.state.accessRequestOption===z.Email&&!this.state.personaSelected};t.prototype.setMembersCanShareFromOption=function(e){this.membersCanShareEnabled=!1;this.membersCanAddToGroupEnabled=!1;switch(e){case W.FileFolderSite:this.membersCanShareEnabled=!0;this.membersCanAddToGroupEnabled=!0;break;case W.FileFolder:this.membersCanShareEnabled=!0;this.membersCanAddToGroupEnabled=!1;break;default:this.membersCanShareEnabled=!1;this.membersCanAddToGroupEnabled=!1}};t.prototype.getMembersCanShareOption=function(){W.FileFolderSite;if(this.siteSharingSettings)return this.siteSharingSettings.tenantAdminMembersCanShare&&this.siteSharingSettings.tenantAdminMembersCanShare!==X.Unspecified?this.siteSharingSettings.tenantAdminMembersCanShare===X.On?W.FileFolderSite:W.None:this.siteSharingSettings.membersCanShare&&this.siteSharingSettings.membersGroup&&this.siteSharingSettings.membersGroup.allowMembersEditMembership?W.FileFolderSite:this.siteSharingSettings.membersCanShare?W.FileFolder:W.None};t.prototype.resetState=function(){this.setState({membersCanShareOption:this.getMembersCanShareOption(),accessRequestEnabled:this.siteSharingSettings&&(this.siteSharingSettings.useAccessRequestDefault||!!this.siteSharingSettings.requestAccessEmail),accessRequestOption:this.siteSharingSettings&&this.siteSharingSettings.useAccessRequestDefault?z.Default:z.Email,requestAccessEmail:this.siteSharingSettings&&this.siteSharingSettings.requestAccessEmail,accessRequestSiteDescription:this.siteSharingSettings&&this.siteSharingSettings.accessRequestSiteDescription,serverErrorDetails:[],saveFailed:!1})};return t})(i.Component),oe=Object(G.e)(se,function(e){return{root:[],label:{}}}),ue=n(4227),ae=n(3847),fe=n(2170),le=n(4505),ce=n(3848),he=n(3400),pe=n(3456),de=n(119),ve=n(96),me=n(785),ge=n(1377),ye=n(4231),be=n(1543),we=n(4515),Ee=n(3455),Se=n(4230),xe=n(3851),Te=n(1548),Ne=n(305),Ce=n(4154),ke=n(2803),Le=n(1410),Ae=n(980),Oe=n(1974),Me=n(1400),_e=n(294),De=n(4226),Pe=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._getColumns=function(e,t){return[{key:"column1",name:"     "+pe.e.Name,fieldName:"RequestedForDisplayName",iconName:"Contact",minWidth:200,isRowHeader:!0,isResizable:!1,isSorted:"RequestedForDisplayName"===e,isSortedDescending:t,onRender:n._renderNameColumn,onColumnClick:n._onColumnClick,data:"string",isPadded:!1,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-NameColumn"},{key:"column2",name:"File type",isResizable:!1,iconName:"Page",isIconOnly:!0,minWidth:16,maxWidth:16,onColumnClick:n._onColumnClick,onRender:n._renderFileType,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-IconColumn"},{key:"column3",name:pe.e.Item,fieldName:"ObjectRequestedTitleDisp",minWidth:280,isSorted:"ObjectRequestedTitleDisp"===e,isSortedDescending:t,isResizable:!1,onColumnClick:n._onColumnClick,data:"string",className:"ms-AccessRequestsList-Column ms-AccessRequestsList-ItemColumn",onRender:n._renderFilename,isPadded:!1},{key:"column4",name:pe.e.RequestDate,fieldName:"RequestDate",minWidth:138,isSorted:"RequestDate"===e,isSortedDescending:t,isResizable:!1,onColumnClick:n._onColumnClick,data:"string",onRender:n._renderRequestDate,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-RequestDateColumn",isPadded:!1},{key:"column5",name:pe.e.Permissions,isResizable:!1,onRender:n._renderPermissionsDropdown,minWidth:138,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-PermissionsColumn",isPadded:!1},{key:"column6",name:"",isResizable:!1,onRender:n._renderRequestComment,minWidth:78,className:"ms-AccessRequestsList-Column ms-AccessRequestsList-CommentColumn",isPadded:!1}]};n._renderNoRequestsMessage=function(){return i.createElement(Se.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:xe.e.Header},i.createElement("div",null,pe.e.NoRequests))};n._renderNoInternalRequestsMessage=function(){return i.createElement(Se.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:xe.e.Header},i.createElement("div",null,pe.e.NoInternalRequests))};n._renderNoExternalRequestsMessage=function(){return i.createElement(Se.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:xe.e.Header},i.createElement("div",null,pe.e.NoExternalRequests))};n._renderContainsError=function(){return i.createElement(he.e,{horizontal:!0,tokens:{childrenGap:10,padding:10},styles:{root:{width:"100%"}}},i.createElement(he.e.Item,{order:1,className:"ms-accessRequestsList-Blocked"},i.createElement(v.e,{iconName:"Blocked2"})),i.createElement(ke.e,{order:2,className:"ms-accessRequestsList-ErrorText"},pe.e.ErrorInSelection),i.createElement(ke.e,{order:3},i.createElement(u.e,{className:"ms-accessRequestsList-Cancel",iconProps:{iconName:"Cancel"},onClick:function(){n.setState({containsError:!1})}})))};n._renderTopButtons=function(){var e,t,r=n._selection.getSelection(),s=r.length>1,o=!(r.length>0);e=function(){n._approveDeclineAll(r,ye.e.Approve)};t=function(){n._approveDeclineAll(r,ye.e.Decline)};return i.createElement(he.e,{horizontal:!0,className:"ms-accessRequestsButtons",tokens:{childrenGap:10,padding:10},styles:{root:{width:"100%"}}},i.createElement(he.e.Item,{order:1},i.createElement("span",null,i.createElement(Ae.e,{iconProps:{iconName:"CheckMark"},allowDisabledFocus:!0,onClick:e,disabled:o},s?pe.e.ApproveAll:pe.e.Approve))),i.createElement(he.e.Item,{order:2},i.createElement("span",null,i.createElement(Ae.e,{iconProps:{iconName:"Cancel"},allowDisabledFocus:!0,onClick:t,disabled:o},s?pe.e.DeclineAll:pe.e.Decline))),i.createElement(he.e.Item,{order:3},0===r.length?i.createElement(Ae.e,{iconProps:{iconName:"Refresh"},allowDisabledFocus:!0,onClick:n._refreshPage},pe.e.Refresh):null))};n._refreshPage=function(){n.setState({allRequests:[],hasMoreRequests:!0,orderBy:"RequestDate"},function(){return n._fetchPendingRequests()})};n._approveDeclineAll=function(e,t){var r=!1;e.forEach(function(e){!0===e.completed&&(r=!0)});if(r)n.setState({containsError:!0});else{n.setState({containsError:!1});n._accessRequestsProvider.changeRequestStatus(e,t).then(function(r){e.forEach(function(e){e.completed=!0;e.completedStatus=t===ye.e.Approve?pe.e.Approved:pe.e.Declined});n._selection.setAllSelected(!0);n._selection.setAllSelected(!1)})}};n._renderList=function(){"internal"===n.props.currentFilter?n._filterForInternal():"external"===n.props.currentFilter&&n._filterForExternal();var e=n.state,t=e.allRequests,r=e.internalRequests,s=e.externalRequests,o=e.columns,u=e.hasMoreRequests;return i.createElement(be.e,null,i.createElement(Te.e,{"data-automation-id":"AccessRequestDetailsList",className:"ms-AccessRequest-AccessRequestList",checkboxCellClassName:"ms-AccessRequestList-Checkbox",items:"all"===n.props.currentFilter?t:"internal"===n.props.currentFilter?r||[]:"external"===n.props.currentFilter&&s||[],compact:!1,columns:o,selectionMode:t&&t.length>0?de.t.multiple:de.t.none,layoutMode:ve.i.justified,isHeaderVisible:!0,selection:n._selection,selectionPreservedOnEmptyClick:!0,enterModalSelectionOnTouch:!0,ariaLabelForSelectionColumn:pe.e.SelectionAriaLabel,ariaLabelForSelectAllCheckbox:pe.e.SelectAllAriaLabel,onRowDidMount:function(e,t){n._onRenderItem(e,t)},constrainMode:ve.r.horizontalConstrained,enableShimmer:t?0===t.length&&u:u,onRenderDetailsHeader:n.onRenderDetailsHeader,onRenderRow:n._onRenderRow}))};n._onRenderRow=function(e,t,i){return t(Object(r.__assign)(Object(r.__assign)({},e||{}),{onRenderCheck:n._onRenderCheck}))};n._onRenderCheck=function(e,t){void 0===t&&(t=me.e);return i.createElement(t,Object(r.__assign)({},e,{styles:{root:"ms-AccessRequestsList-CheckBoxRoot",check:"ms-AccessRequestsList-CheckBoxCheck",isDisabled:"ms-AccessRequestsList-CheckBoxDisabled"}}))};n._renderFileType=function(e){if(e){var t=n._getItemIcon(e.itemUrl);return i.createElement(v.e,{iconName:t})}};n._renderRequestComment=function(e){if(e&&e.comment&&e.comment.length)return i.createElement("div",null,i.createElement(Le.e,{content:n._renderRequestCommentToolTip(e),calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},i.createElement(u.e,{iconProps:{iconName:"Message"},title:pe.e.MessageTitle,ariaLabel:pe.e.MessageTitle})))};n._renderRequestCommentToolTip=function(e){var t,r;t=function(){n._selection.setAllSelected(!1);n._approveDeclineAll([e],ye.e.Approve)};r=function(){n._selection.setAllSelected(!1);n._approveDeclineAll([e],ye.e.Decline)};return i.createElement("div",{className:"ms-AccessRequestsList-CommentToolTip"},i.createElement("div",{className:"ms-AccessRequestsList-Comment"}," ",e.comment," "),e.completed?null:i.createElement(he.e,{horizontal:!0},i.createElement(he.e.Item,{order:1},i.createElement(Ae.e,{iconProps:{iconName:"CheckMark"},allowDisabledFocus:!0,onClick:t},pe.e.Approve)),i.createElement(he.e.Item,{order:2},i.createElement(Ae.e,{iconProps:{iconName:"Cancel"},allowDisabledFocus:!0,onClick:r},pe.e.Decline))))};n._renderRequestDate=function(e){var t=n.props.pageContext;if(e){if(!0===e.completed)return i.createElement("div",{className:"ms-AccessRequestsList-CompletedStatus"},e.completedStatus);var r=e.requestDate,s=r&&new Date(r).getTime();if("number"==typeof s&&!isNaN(s)){var o=t.currentUICultureName;return i.createElement("div",{className:"ms-AccessRequestsList-RequestDate"},Object(Ne.n)(new Date(s),o))}}};n._onRenderOption=function(e){return i.createElement("div",null,e.data&&e.data.icon&&i.createElement(v.e,{style:{marginRight:"8px"},iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),i.createElement("span",null,e.text))};n._onRenderPlaceholder=function(e){return i.createElement("div",{className:"dropdownExample-placeholder"},i.createElement(v.e,{style:{marginRight:"8px"},iconName:"Edit","aria-hidden":"true"}),i.createElement("span",null,e.placeholder))};n._onRenderTitle=function(e){var t=e[0];return i.createElement("div",null,t.data&&t.data.icon&&i.createElement(v.e,{style:{marginRight:"8px"},iconName:t.data.icon,"aria-hidden":"true",title:t.data.icon}),i.createElement("span",null,t.text))};n._renderPermissionsDropdown=function(e){var t;e.dropRef=i.createRef();if(e.isWeb){n._associatedGroups&&0!==n._associatedGroups.length||n._fetchAssociatedGroups();(!n._associatedGroups||n._associatedGroups.length<2)&&(e.isWeb=!1)}t=function(){var t=e.dropRef.current.selectedOptions[0].key;return n._onChangePermission(t,e)};var r=e.isWeb?pe.e.Member:pe.e.Edit,s=e.isWeb?pe.e.Visitor:pe.e.View;return i.createElement(he.e,{tokens:{childrenGap:20},verticalAlign:"end"},i.createElement(Ce.e,{componentRef:e.dropRef,disabled:e.completed,placeholder:r,ariaLabel:pe.e.SelectPermissions,options:[{key:"Edit",text:r,data:{icon:"Edit"}},{key:"View",text:s,data:{icon:"Uneditable2"}}],styles:{dropdown:{width:120}},onRenderOption:n._onRenderOption,onRenderPlaceholder:n._onRenderPlaceholder,onRenderTitle:n._onRenderTitle,onChange:t}))};n._renderNameColumn=function(e){var t=n.state.resolvedPersons;if(t[e.userLogin]){var r=t[e.userLogin],s={personaType:"User",identifier:r.userId,pageContext:n.props.pageContext,lpcHoverTargetProps:{upn:r.email,hostAppPersonaInfo:{PersonaDisplayName:e.requesterDispName}}};return Object(b.t)(s,i.createElement("div",{className:"ms-AccessRequestsList-card"},i.createElement(a.e,{"data-is-focusable":!0,imageUrl:r.image,primaryText:e.requesterDispName,size:f.n.small,hidePersonaDetails:!1,showInitialsUntilImageLoads:!0})))}if(!e.queried){n._queryForPersonaInfo(e.userLogin);e.queried=!0}return i.createElement("div",{className:"ms-AccessRequestsList-name"},i.createElement(Le.e,{content:pe.e.UserNotInOrg,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},e.requesterDispName))};n._renderFilename=function(e){return i.createElement("div",{className:"ms-AccessRequestsList-ColumnText"},i.createElement(A.e,{href:e.itemUrl.toString(),target:"_blank",className:"ms-AccessRequestsList-Link"},e.item))};n._fetchPendingRequests=function(){var e=n.state,t=e.hasMoreRequests,r=e.allRequests,i=e.orderBy,s=e.ascending,o=n.props.pageSize;if(t){var u;u=r?n.state.allRequests:[];n._accessRequestsProvider.getPendingAccessRequests(i,s,o,u.length).then(function(e){if(Array.isArray(e)&&e.length>0){e.forEach(function(e){e.queried=!1;u.push(e)});var t=n._mergeInNewRequests(e),r=e.length===o&&t&&t.length<o;n.setState({allRequests:t,hasMoreRequests:e.length===o});return r}n.setState({hasMoreRequests:!1});return!1}).then(function(e){e&&n._fetchPendingRequests()}).catch(function(e){O.e.logData({name:"AccessRequests.Error"})})}};n._queryForPersonaInfo=function(e){var t=n.state.resolvedPersons,r=n.state.resolvedPersons;t[e]||n._onGetMoreResults(e).then(function(t){r[e]={userId:t.userId,name:t.name,email:t.email,image:t.image,department:t.department,job:t.job,office:t.office,phone:t.phone,isResolved:t.isResolved,isExternal:t.isExternal};n.setState({resolvedPersons:r})});return!0};n._onGetMoreResults=function(e){var t=n.props.pageContext,r=!w.e.isActivated("34c10010-00ae-48db-8ec7-d9fd2f8d7804","3/19/2020","use IBSegment"),i={allowEmailAddresses:!1,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:1,required:null,urlZone:null,urlZoneSpecified:null,filterExternalUsers:!1,blockExternalUsers:!1,useGraph:!!w.e.isActivated("F18F4F84-A337-4C37-81BF-20545B8B9BD9","4/28/2020","Use enforceIBSegmentFilter.")||!t.enforceIBSegmentFilter,useSubstrate:r&&t.IBSegments&&t.IBSegments.length>0,conversationId:$.e.generate(),siteIBSegmentIDs:r&&t.IBSegments};return n._peoplePickerProvider.resolve(e,i)};n._mergeInNewRequests=function(e){var t=n.state.allRequests;if(t&&t.length>0){var i=n._mapRequests(t),s=e.filter(function(e){return!(e.id in i)});return Object(r.__spreadArrays)(t,s)}return e};n._mapRequests=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i.id]=i}return t};n._sort=function(e,t,n){var r="RequestedForDisplayName"===t?function(e,t){return e.requesterDispName.toLocaleUpperCase().localeCompare(t.requesterDispName.toLocaleUpperCase())}:"ObjectRequestedTitleDisp"===t?function(e,t){return e.item.toLocaleUpperCase().localeCompare(t.item.toLocaleUpperCase())}:function(e,t){return e.requestDate.valueOf()-t.requestDate.valueOf()};e.sort(r);n&&e.reverse();return e};n._onRenderItem=function(e,t){var r=n.state.allRequests,i=n.props.pageSize;(t===r.length-i||r.length<i&&t===r.length-1)&&n._fetchPendingRequests()};n._getSelectionDetails=function(){return n._selection.getSelectedCount()>0};n._onColumnClick=function(e,t){var i=n.state,s=i.columns,o=i.hasMoreRequests,u=i.allRequests,a=s.map(function(e){var n=e.key===t.key;return Object(r.__assign)(Object(r.__assign)({},e),{isSorted:n,isSortedDescending:n&&!e.isSortedDescending})});o?n.setState({allRequests:[],hasMoreRequests:!0,orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a},function(){return n._fetchPendingRequests()}):n.setState({allRequests:Object(r.__spreadArrays)(n._sort(u,t.fieldName,!t.isSortedDescending)),orderBy:t.fieldName,ascending:!t.isSortedDescending,columns:a})};n._accessRequestsProvider=t.accessRequestsProvider;n._peoplePickerProvider=new H.e({pageContext:t.pageContext,peoplePickerDataSource:t.peoplePickerDataSource});n._sitePermissionsProvider=new De.e(t.pageContext);var s=n._getColumns("RequestDate",!1);n._selection=new ge.e({onSelectionChanged:function(){n.setState({isRequestSelected:n._getSelectionDetails()})}});n.state={columns:s,allRequests:[],isRequestSelected:n._getSelectionDetails(),internalRequests:[],externalRequests:[],selectedRequest:void 0,hasMoreRequests:!0,orderBy:"RequestDate",ascending:!0,isCommentTooltipVisible:!1,resolvedPersons:new Map,containsError:!1};Object(Oe.e)();return n}t.prototype.render=function(){var e=this.state,t=e.allRequests,n=e.internalRequests,r=e.externalRequests,s=e.hasMoreRequests,o=!(t&&0!==t.length||s),u=n&&!n.length,a=r&&!r.length;return i.createElement("div",{className:"ms-accessRequestsList"},this._renderTopButtons(),i.createElement("div",{className:"ms-accessRequestsList-ErrorMessage"},this.state.containsError&&this._renderContainsError()),i.createElement("div",{className:"ms-accessRequestsList-ScrollablePane"},i.createElement(we.e,{scrollbarVisibility:Ee.t.auto},this._renderList(),"all"===this.props.currentFilter?o&&this._renderNoRequestsMessage():"internal"===this.props.currentFilter?u&&this._renderNoInternalRequestsMessage():"external"===this.props.currentFilter?a&&this._renderNoExternalRequestsMessage():"")))};t.prototype.componentDidMount=function(){this._fetchAssociatedGroups();this._fetchPendingRequests()};t.prototype.componentDidUpdate=function(e){e.accessRequestsEnabled!==this.props.accessRequestsEnabled&&this.setState({columns:this._getColumns(this.state.orderBy,this.state.ascending)})};t.prototype.onRenderDetailsHeader=function(e,t){return i.createElement(Se.e,{stickyClassName:"ms-AccessRequest-AccessRequestListHeader",stickyPosition:xe.e.Header,isScrollSynced:!0},t(Object(r.__assign)({},e)))};t.prototype._filterForInternal=function(){for(var e=this.state,t=e.allRequests,n=e.internalRequests,r=e.resolvedPersons,i=[],s=!1,o=0,u=t;o<u.length;o++){var a=u[o];if(r[a.userLogin]&&!r[a.userLogin].isExternal){i.push(a);n&&n.length>=i.length&&i[i.length-1]!==n[i.length-1]&&(s=!0)}}n&&n.length!==i.length&&(s=!0);s&&this.setState({internalRequests:i})};t.prototype._filterForExternal=function(){for(var e=this.state,t=e.allRequests,n=e.externalRequests,r=e.resolvedPersons,i=[],s=!1,o=0,u=t;o<u.length;o++){var a=u[o];if(r[a.userLogin]&&r[a.userLogin].isExternal){i.push(a);n&&n.length>=i.length&&i[i.length-1]!==n[i.length-1]&&(s=!0)}}n&&n.length!==i.length&&(s=!0);s&&this.setState({externalRequests:i})};t.prototype._getItemIcon=function(e){if(e){var t=null,n=e.toString().split("/"),r=n[n.length-1];if(!r.includes(".")){return"teams"===n[n.length-2]?"SharepointLogo":Object(Me.n)({type:_e.e.folder,size:16}).iconName}t=r.split(".")[1].split("?")[0];return Object(Me.n)({extension:t,size:16}).iconName}};t.prototype._onChangePermission=function(e,t){if("Edit"===e){t.isEditor=!0;t.isWeb&&this._associatedGroups&&this._associatedGroups.length>2&&(t.groupId=this._associatedGroups[1].id)}else{t.isEditor=!1;t.isWeb&&this._associatedGroups&&this._associatedGroups.length>2&&(t.groupId=this._associatedGroups[2].id)}};t.prototype._fetchAssociatedGroups=function(){var e=this;this._sitePermissionsProvider.getAssociatedPermissionGroups().then(function(t){e._associatedGroups=t})};return t})(i.Component),He=Object(G.e)(Pe,function(e){return{root:[],label:{}}}),Be=n(4228),je=n(4229),Fe=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.handlePivotClick=function(e){"all"===e.props.itemKey?n.setState({currentFilter:"all"}):"internal"===e.props.itemKey?n.setState({currentFilter:"internal"}):"external"===e.props.itemKey&&n.setState({currentFilter:"external"})};n.state={currentFilter:"all"};return n}t.prototype.render=function(){return i.createElement(ne.e,{hidden:!this.props.showAccessRequestDialog,onDismiss:this.props.onDismiss,containerClassName:"ms-dialogMainOverride ms-AccessRequestsDialogContainer",dialogContentProps:{type:re.e.normal,showCloseButton:!0,className:"ms-AccessRequestsDialogContent",styles:{header:{className:"ms-AccessRequestsDialogHeader"},inner:{className:"ms-AccessRequestsDialog-inner"},content:{className:"ms-AccessRequestsDialog-content"}}},modalProps:{isBlocking:!0,isDarkOverlay:!1}},i.createElement(he.e,{horizontal:!0,disableShrink:!0},i.createElement(he.e.Item,{order:1},i.createElement("div",{className:"ms-AccessRequestsDialogHeader"},i.createElement("div",{className:"ms-AccessRequestsDialogTitle"},pe.e.AccessRequests))),i.createElement(he.e.Item,{order:2},this.renderPivot())),i.createElement("div",{className:"ms-AccessRequestsDialogListContainer"},i.createElement(He,{pageSize:10,accessRequestsEnabled:!0,accessRequestsProvider:new Be.e({dataSource:new je.e({pageContext:this.props.pageContext})}),peoplePickerDataSource:this.props.peoplePickerDataSource,pageContext:this.props.pageContext,currentFilter:this.state.currentFilter})),i.createElement("div",{className:"ms-AccessRequestsDialog-Footer"},this.renderClassicLink()))};t.prototype.renderClassicLink=function(){var e=this.props.pageContext.webAbsoluteUrl+"/Access%20Requests/pendingreq.aspx?mbypass=1";return i.createElement(A.e,{href:e,className:"ms-AccessRequestsDialog-ClassicExperience-link","data-automationid":"SitePermissionsPanelAccessRequestsDialogClassicLink",target:"_blank"},pe.e.ClassicExperience)};t.prototype.renderPivot=function(){return i.createElement("div",null,i.createElement(le.e,{"aria-label":"Filtering between all, internal, and external only users",onLinkClick:this.handlePivotClick,headersOnly:!0},i.createElement(ce.e,{headerText:pe.e.All,itemKey:"all"}),i.createElement(ce.e,{headerText:pe.e.Internal,itemKey:"internal"}),i.createElement(ce.e,{headerText:pe.e.External,itemKey:"external"})))};return t})(i.Component);n.d(t,"e",function(){return Re});var Ie={ODB:1559},qe={ODB:1479},Re=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onGetErrorMessage=function(e){var t="";w.e.isActivated("eeaffa7b-8676-4d7c-810b-21efa975dd2a","02/16/2021","Max length hit error message")||Object(r.__spreadArrays)(e).length>500&&(t=J.e.maxMessageLengthHitErrorMsg);return t};n._onChangeSendEmail=function(e){n.setState({shouldSendEmail:!n.state.shouldSendEmail})};n._removePermControl=function(e){n.setState({shouldHidePermControl:!0})};n._onChangeEnableHubPermissionSync=function(e,t){n.props.onSaveHubPermissionSync&&n.props.onSaveHubPermissionSync(t)};n._closePanel=function(){if(!n._isLPCOpen){n.setState({showPanel:!1,showUserExpirationPanel:!1});n.props.onDismiss&&n.props.onDismiss()}};n._onClick=function(){n.setState({isInvitePeopleContextualMenuVisible:!n.state.isInvitePeopleContextualMenuVisible});O.e.logData({name:"SitePermissionsPanel.InvitePeople.Click"})};n._onDismiss=function(e){n.setState({isInvitePeopleContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};n._onSaveClick=function(e){n.setState({showSavingSpinner:!0,saveButtonDisabled:!0});var t=n._peoplePicker.selectedPeople;t&&t.length&&n.props.onSave&&n.props.onSave(t,n.state.shouldSendEmail,n._mailMessage).done(function(e){n.setState({showSavingSpinner:!1,saveButtonDisabled:!1,showPanel:n._showPanel()});n._resetSharePanel()});O.e.logData({name:"SitePermissionsPanel.Save.Click"})};n._showPanel=function(){return!(w.e.isActivated("b28e2168-4010-4a1d-8daa-379e19c1960a","03/12/2021","Block share site panel dismissal when open it directly")||!n.props.shareSiteErrorMsg)||!n.props.shouldLoadSharePanelOnly&&n.state.showPanel};n._onCancelClick=function(e){if(n.props.onCancel){n._resetSharePanel();n.props.onCancel()}O.e.logData({name:"SitePermissionsPanel.Cancel.Click"})};n._onAccessRequestsClick=function(){n.setState({showAccessRequestDialog:!0})};n._onDismissAccessRequestsDialog=function(){n.setState({showAccessRequestDialog:!1})};n._onSuggestionSelected=function(e){var t=n.props.pickerSettings,r={principalSource:t.PrincipalSource,principalType:t.PrincipalAccountType,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,forceResolve:!0};if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===R.e.distributionList){r.isGraphDistributionList=!0;r.useGraph=!0;r.useSubstrate=!0}return n._peoplePickerProvider.resolve(e.userId,r).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);!e.name&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})};n._onSelectHubPersona=function(e){var t=e&&e[0];n.props.onAddHubUserCallback&&n.props.onAddHubUserCallback(t)};n._onSelectedPeopleChange=function(e){var t,r,s=[],o=U({selectedItems:e}),u=(function(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(o=r.join(", ")).lastIndexOf(","),s=o.substring(0,i)+" "+q.e.and+" "+o.substring(i+1);return I.format(q.e.outsideOfYourOrgPlural,s)}if(n>2){var o;i=(o=r.join(", ")).lastIndexOf(","),s=o.substring(0,i+1)+" "+q.e.and+" "+o.substring(i+1);return I.format(q.e.outsideOfYourOrgPlural,s)}return 1===n?I.format(q.e.outsideOfYourOrgSingular,r[0]):""})(e),a=(function(e,t){var n=e.filter(function(e){return 2===e.entityType}).length,r="";1===n?r=q.e.oneGroupInvited:n>1&&(r=I.format(q.e.multipleGroupsInvited,n));t>=1e3?r+=" "+q.e.groupsMemberCountLargeLabel:t>=25&&(r+=" "+I.format(q.e.groupsMemberCountLabel,t));return r})(e);o&&(t=i.createElement(B.e,{className:"ms-SitePermPanel-PeoplePicker-error",messageBarType:j.e.error},o));u&&s.push(i.createElement(B.e,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:j.e.warning},u));a&&s.push(i.createElement(B.e,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:j.e.warning},a));s.length>0&&(r=i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker-warnings"},s));n.setState({isPersonaSelected:n._peoplePicker.selectedPeople.length>0&&!t,peoplePickerError:t,peoplePickerWarnings:r})};n._siteSharingSettingsOnClick=function(){n.setState({showSiteSharingSettingsPanel:!0});O.e.logData({name:"SitePermissionsPanel.SiteSharingSettings.Click"})};n._onDismissSiteSharingSettingsPanel=function(){n.setState({showSiteSharingSettingsPanel:!1});O.e.logData({name:"SitePermissionsPanel.DismissSiteSharingSettings.Click"})};n._onUserExpirationClick=function(){n.setState({showUserExpirationPanel:!0});O.e.logData({name:"SitePermissionsPanel.UserExpirationPanel.Click"})};n._onDismissUserExpirationPanel=function(){n.setState({showUserExpirationPanel:!1});O.e.logData({name:"SitePermissionsPanel.DismissUserExpirationPanel.Click"})};n._isLPCOpenHandler=function(e){n._isLPCOpen=e};n._isUserExpirationPanelEnabled=t.pageContext.isSiteAdmin&&K.e.isFeatureEnabled(Ie);n._isAccessRequestDialogEnabled=!1;n._isGroup=Object(P.s)(t.pageContext);n._resolveMenu=function(e){return n._menu=e};n._mailMessage="";n._isLPCOpen=!1;n.state={showPanel:!0,showShareSiteOnly:t.showShareSiteOnly,shouldSendEmail:!0,showSiteSharingSettingsPanel:!1,showUserExpirationPanel:!1,showAccessRequestDialog:!1};n._peoplePickerProvider=new H.e({pageContext:t.pageContext,peoplePickerDataSource:t.peoplePickerDataSource});if(n._isUserExpirationPanelEnabled){n._userExpirationProvider=new ue.UserExpirationProvider({dataSource:new ae.UserExpirationDataSource({pageContext:t.pageContext})});n._userExpirationProvider.getExternalUserExpirationPolicy().then(function(e){return n.setState({userExpirationPolicyDays:e})})}if(K.e.isFeatureEnabled(qe)){n._accessRequestsProvider=new Be.e({dataSource:new je.e({pageContext:t.pageContext})});n._accessRequestsProvider.hasAccessRequests().then(function(e){n._isAccessRequestDialogEnabled=e&&(t.pageContext.isSiteAdmin||t.pageContext.isSiteOwner)})}O.e.logData({name:"SitePermissionsPanel.Opened.Click"});return n}t.prototype.render=function(){var e=this,t=this.props,n=t.showShareSiteOnly,r=t.shouldDismissPanel,a=t.pickerSettings,f=t.showHubPivot,l=t.shouldLoadSharePanelOnly,c=l?t.shareSiteTitle||J.e.shareSiteTitle:null;return i.createElement(s.e,{className:"ms-SitePermPanel",isOpen:this.state.showPanel&&!r,type:o.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,headerText:n?c:t.title||J.e.title,forceFocusInsideTrap:!1,closeButtonAriaLabel:J.e.closeButtonAriaLabel,onRenderFooterContent:function(t,r){return n&&a?i.createElement("div",{className:"ms-SitePermPanelButton"},i.createElement("span",{className:"ms-SitePermPanelButton-container"},i.createElement(x.e,{className:"ms-SitePermPanel-saveButton",disabled:!e.state.isPersonaSelected,onClick:e._onSaveClick,"data-automationid":"SitePermissionsPanelSaveButton"},e.props.saveButton)),i.createElement("span",{className:"ms-SitePermPanelButton-container"},i.createElement(T.e,{className:"ms-SitePermPanel-cancelButton",onClick:e._onCancelClick,"data-automationid":"SitePermissionsPanelCancelButton"},J.e.cancelButton))):null},onRenderNavigationContent:function(t,r){return n&&!l?i.createElement("div",{className:"ms-SitePermPanel-NavigationContent"},i.createElement(u.e,{iconProps:{iconName:"Back"},className:"ms-SitePermPanel-BackIcon",onClick:e._onCancelClick,ariaLabel:J.e.backButtonAriaLabel}),i.createElement("p",{className:"ms-SitePermPanel-Title"},e.props.shareSiteTitle||J.e.shareSiteTitle),r(t)):i.createElement("div",{className:"ms-SitePermPanel-NavigationContentDismiss"}," ",r(t)," ")}},n&&a&&this._renderShareSiteOnly(),!n&&f&&i.createElement(le.e,{className:"ms-SitePermPanel-Pivot"},i.createElement(ce.e,{headerText:J.e.pivotThisSite},this._renderPermissions()),i.createElement(ce.e,{headerText:J.e.pivotHubSite},this._renderHubPermissions())),!n&&!f&&this._renderPermissions())};t.prototype._renderAdvancedPermSettings=function(){var e,t=this.props,n=t.advancedPermSettingsUrl,r=t.hasCustomizedGroups,s=t.pageContext,o=t.permissionLevelOfCurrentUser,u=t.isDefaultPermissionsChanged,a=t.showShareSiteOnly;if(n&&(o===C.e.FullControl||F.e.hasPermission(s.webPermMasks,F.e.managePermissions))){var f=i.createElement(A.e,{href:n,target:"_blank",className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelAdvancedPermLink"},J.e.advancedPermSettings),l=void 0;u?l=a?J.e.sharePanelUniquePermissionDescription:J.e.uniquePermissionDescription:r&&(l=J.e.additionalGroupsDescription);if(l){-1===l.indexOf("{0}")&&(l+=" {0}.");f=i.createElement("span",null,I.formatToArray(l,f))}e=i.createElement("div",{className:"ms-SitePermPanel-AdvancedPerm"},f)}return e};t.prototype._renderSiteSharingSetting=function(){var e,t=this.props,n=t.pageContext,r=t.permissionLevelOfCurrentUser,s=this.state.showSiteSharingSettingsPanel;if(r===C.e.FullControl||F.e.hasPermission(n.webPermMasks,F.e.managePermissions)){var o=i.createElement(A.e,{className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelSiteSharingSettingsLink",onClick:this._siteSharingSettingsOnClick},J.e.siteSharingSectionText);e=i.createElement("div",{className:"ms-SitePermPanel-SharingSettings"},i.createElement("div",{className:"ms-SitePermPanel-sectionTitle"}," ",J.e.siteSharingSectionTitle),o,s&&i.createElement(oe,{isOpen:s,onDismiss:this._onDismissSiteSharingSettingsPanel,pageContext:n,peoplePickerProvider:this._peoplePickerProvider,sharingSiteProvider:new Q.e({pageContext:n})}))}return e};t.prototype._renderUserExpiration=function(){var e=this.props.pageContext,t=this.state,n=t.showUserExpirationPanel,r=t.userExpirationPolicyDays,s=i.createElement(A.e,{className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelUserExpirationLink",onClick:this._onUserExpirationClick},J.e.userExpirationLink);return null!=r&&i.createElement("div",{className:"ms-SitePermPanel-UserExpiration"},i.createElement("div",{className:"ms-SitePermPanel-sectionTitle"},J.e.userExpiration),i.createElement("div",null,I.formatWithLocalizedCountValue(J.e.userExpirationText,J.e.userExpirationInterval,r)),s,n&&i.createElement(fe.e,{isOpen:n,onBackButton:this._onDismissUserExpirationPanel,onDismiss:this._closePanel,pageContext:e,userExpirationProvider:this._userExpirationProvider,userExpirationPolicyDays:r,userExpirationPolicyEnabled:r>0}))};t.prototype._renderAccessRequestsDialog=function(){var e=this.state.showAccessRequestDialog,t=this.props.pageContext,n=i.createElement(A.e,{className:"ms-AccessRequests-link","data-automationid":"SitePermissionsPanelAccessRequestsDialogLink",onClick:this._onAccessRequestsClick},J.e.accessRequestsLink);return i.createElement("div",{className:"ms-SitePermPanel-AcessRequests"},n,e&&i.createElement(Fe,{showAccessRequestDialog:e,onDismiss:this._onDismissAccessRequestsDialog,pageContext:t,peoplePickerDataSource:this.props.peoplePickerDataSource}))};t.prototype._renderPermissions=function(){var e=this,t=this.props,n=t.menuItems,r=t.onShareSiteCallback,s=t.sitePermissions,o=t.permissionLevelOfCurrentUser,u=t.pickerSettings;return i.createElement("div",null,i.createElement("div",null,i.createElement("p",{className:"ms-sitePermPanel-TextArea","data-automationid":"SitePermissionsPanelDescription"},J.e.panelDescription),i.createElement("div",{className:"ms-sitePerm-ContextMenu"},u&&s&&(o===C.e.FullControl||o===C.e.Edit)&&i.createElement("div",{className:"ms-sitePermPanel-buttonArea",ref:this._resolveMenu},i.createElement(x.e,{className:Object(h.e)("ms-sitePermPanel-itemBtn",this._isGroup?"ms-sitePermPanel-invitePeopleButton":"ms-sitePermPanel-shareSiteButton"),onClick:this._isGroup?this._onClick:r,"data-automationid":"SitePermissionsPanelInviteButton"},this._isGroup?J.e.invitePeople:J.e.shareSiteTitle)),this.state.isInvitePeopleContextualMenuVisible&&i.createElement(l.e,{className:"ms-sitePermPanel-invitePeopleContextualMenu",items:n,isBeakVisible:!1,target:this._menu,directionalHint:c.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0}))),s&&i.createElement("div",null,s.map(function(t){return e._getSitePermissions(t)})),this._renderSiteSharingSetting(),this._isAccessRequestDialogEnabled&&this._renderAccessRequestsDialog(),this._isUserExpirationPanelEnabled&&this._renderUserExpiration(),this._renderAdvancedPermSettings())};t.prototype._renderHubPermissions=function(){var e,t=this,n=this.props,s=n.isHubSite,o=n.hubSiteTitle,u=n.enableHubPermissionsSync,a=n.showHubSyncToggleSpinner,f=n.hubSyncControlsAreDisabled,l=n.hubPivotErrorString,c=s?J.e.enableHubSitePermissionSyncToggle:J.e.enableAssociatedSitePermissionSyncToggle,h=void 0;s?h=u?J.e.hubSitePivotHelperTextLabel:J.e.hubSitePivotDisabledHelperTextLabel:o&&(h=u?I.format(J.e.associatedSitePivotHelperTextLabel,null===(e=this.props.pageContext)||void 0===e?void 0:e.webTitle,o):I.format(J.e.hubSiteSyncDisallowedHelperTextLabel,o));var p=u&&!a,d=p&&s,v=this._getPeoplePickerProps(),m=Object(r.__assign)(Object(r.__assign)({},v),{itemLimit:1,peoplePickerType:k.e.normal,onSelectedPersonasChange:this._onSelectHubPersona,peoplePickerQueryParams:Object(r.__assign)(Object(r.__assign)({},v.peoplePickerQueryParams),{allowEmailAddresses:!1}),inputProps:{"aria-label":J.e.hubVisitorsPeoplePickerArialLabel,placeholder:J.e.hubPeoplePickerPlaceholder}});return i.createElement("div",{className:"ms-SitePermPanel-HubPivotDiv"},i.createElement(Z.e,{checked:u,disabled:a||f,label:c,onText:J.e.toggleOn,offText:J.e.toggleOff,onChange:this._onChangeEnableHubPermissionSync}),a?i.createElement(L.e,null):null,h&&i.createElement(te.e,{className:"ms-SitePermPanel-HubPivot-helperText"},h+" ",i.createElement(A.e,{href:"https://go.microsoft.com/fwlink/?linkid=2133626"},J.e.LearnMoreLinkText)),p&&i.createElement(te.e,null,J.e.hubVisitors),d?i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelHubPeoplePicker"},i.createElement(N.e,Object(r.__assign)({},m))):null,l&&i.createElement(B.e,{className:"ms-SitePermPanel-HubPivot-error",messageBarType:j.e.error},l),!a&&u&&this.props.hubSitePermissions&&i.createElement("div",{className:"ms-SitePermPanel-HubPivot-permissions"},this.props.hubSitePermissions.map(function(e){return t._getSitePermissions(e)})))};t.prototype._renderShareSiteOnly=function(){var e=this,t=this.props,n=t.goToOutlookOnClick,s=t.isEmailSharingEnabled,o=t.pageContext,u=t.shouldLoadSharePanelOnly,a=t.sitePermissions,f=t.sitePreviewLoader,l=t.isDefaultPermissionsChanged,c=t.shareSiteErrorMsg,h=this.state,p=h.isPersonaSelected,d=h.peoplePickerError,v=h.peoplePickerWarnings,m=h.shouldHidePermControl,g=h.shouldSendEmail,y=h.showSavingSpinner,b=null;this._isGroup&&n&&(b=i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},Object(V.e)(J.e.shareSiteOnlyVerboseText,J.e.shareSiteOnlyAddMembersLinkText,A.e,{className:"ms-SitePermPanel-Link",onClick:n,"data-automationid":"SitePermissionsPanelAddMemberLink"})));return l?this._renderAdvancedPermSettings():i.createElement("div",{className:"ms-SitePermPanel-SharePanel"},i.createElement("div",{onClick:this._removePermControl,className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},i.createElement("div",{className:"ms-SitePermPanel-PeoplePicker"},o.isSPO?J.e.addUserOrGroupText:J.e.addUserOrGroupTextNoO365Group),b,i.createElement(N.e,Object(r.__assign)({},this._getPeoplePickerProps(),{componentRef:function(t){t&&(e._peoplePicker=t)}})),d||v),i.createElement("div",null,u&&!m&&i.createElement("div",null,a&&a.map(function(t){return e._getSitePermissions(t)})),s&&p&&i.createElement("div",{className:"ms-SitePermPanel-ShareSiteEmail"},i.createElement(D.e,{className:"ms-SitePermPanel-ShareSiteEmail-checkbox",defaultChecked:g,label:J.e.sendEmailText,onChange:this._onChangeSendEmail}),g&&i.createElement("div",{className:"ms-SitePermPanel-ShareSiteEmail-message-div"},i.createElement(_.e,{className:"ms-SitePermPanel-ShareSiteEmail-message",multiline:!0,resizable:!1,placeholder:J.e.messagePlaceHolderText,onChange:function(t,n){return e._mailMessage=n},onGetErrorMessage:this._onGetErrorMessage}),f))),y&&i.createElement(L.e,null),!w.e.isActivated("5a013444-053c-4234-8a89-3443d47a5952","02/04/2021","Improve share site error handling")&&c&&i.createElement(B.e,{"aria-label":J.e.sharingIsDisabledByOwners,messageBarType:j.e.error,isMultiline:!0,dismissButtonAriaLabel:J.e.closeButtonAriaLabel},J.e.sharingIsDisabledByOwners))};t.prototype.renderPeoplePickerItemWithMenu=function(e){var t,n=this.props.sitePermissionsContextualMenuItems.map(function(e){return e.permissionLevel});t=e.item.permissionLevel?e.item.permissionLevel:n.indexOf(this.props.addMemberDefaultPermissionLevel)>-1?this.props.addMemberDefaultPermissionLevel:n.indexOf(C.e.Edit)>-1?C.e.Edit:n.indexOf(C.e.Read)>-1?C.e.Read:C.e.FullControl;var s=this.props.permissionLevelOfCurrentUser===C.e.FullControl?this.props.sitePermissionsContextualMenuItems.filter(function(e){return e.permissionLevel!==t}).map(function(t){return Object(r.__assign)(Object(r.__assign)({},t),{onClick:function(t,n){var r=e.item;r.permissionLevel=n.permissionLevel;e.onItemChange(r,e.index)}})}):void 0;return i.createElement(M.e,Object(r.__assign)(Object(r.__assign)({},e),{menuTitle:this.props.permissionLevelOfCurrentUser!==C.e.FullControl?"":this.props.permissionStrings[t],menuItems:s}))};t.prototype._getSitePermissions=function(e){return i.createElement(S,Object(r.__assign)({},e,{key:e.permLevel,pageContext:this.props.pageContext,lpcModuleLoader:this.props.lpcModuleLoader,lpcModuleCustomWaiter:this.props.lpcModuleCustomWaiter,isLPCOpenHandler:this._isLPCOpenHandler}))};t.prototype._resetSharePanel=function(){this.setState({shouldSendEmail:!0,isPersonaSelected:!1,peoplePickerWarnings:void 0,peoplePickerError:void 0})};t.prototype._getPeoplePickerProps=function(){var e=this,t=this.props,n=t.pageContext,r=t.pickerSettings,i=!w.e.isActivated("34c10010-00ae-48db-8ec7-d9fd2f8d7804","3/19/2020","use substrate");return{noResultsFoundText:" ",context:n,peoplePickerType:k.e.listBelow,onSelectedPersonasChange:this._onSelectedPeopleChange,onRenderItem:function(t){return e.renderPeoplePickerItemWithMenu(t)},onSuggestionSelected:this._onSuggestionSelected,dataProvider:this._peoplePickerProvider,peoplePickerQueryParams:{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:r&&r.PrincipalSource,blockExternalUsers:!0,principalType:r&&r.PrincipalAccountType,required:null,urlZone:null,urlZoneSpecified:null,useGraph:!!w.e.isActivated("F18F4F84-A337-4C37-81BF-20545B8B9BD9","4/28/2020","Use enforceIBSegmentFilter.")||!n.enforceIBSegmentFilter,useSubstrate:i&&n.IBSegments&&n.IBSegments.length>0,conversationId:$.e.generate(),siteIBSegmentIDs:i&&n.IBSegments},suggestionsAvailableAlertText:J.e.suggestionsAvailableAlertText,enableSelectedSuggestionAlert:!0,inputProps:{"aria-label":J.e.shareSitePeoplePickerArialLabel,autoFocus:!0}}};return t})(i.Component)},"2232":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(2089),o=n(1394),u=n(969),a=n(600),f=n(1387),l=n(2122),c=n(4514),h=n(3742),p=n(2338),d=n(2787),v=n(4154),m=n(4569),g=n(2040),y=n(1544),b=n(3759),w=n(2337),E=n(22),S=n(38);var x=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._initialThemeColor=r._getCurrentSiteLogoColor();return r}t.prototype.render=function(){return i.createElement("div",null,this.renderGroupSiteLogo())};t.prototype.renderGroupSiteLogo=function(){var e,t,n,r=null;if(this.props){if(!!(r=this.props.siteLogoUrl)&&/(?=_api\/groupservice\/getgroupimage)(?!color)/.test(r.toLowerCase())){var i=this._getCurrentSiteLogoColor();i!==this._initialThemeColor&&(r=(t=i,n=-1!==(e=r).indexOf("?")?"&":"?",""+e+n+"color='"+encodeURIComponent(t)+"'"))}}return this.renderSiteLogo(r)};t.prototype._getCurrentSiteLogoColor=function(){var e=Object(E._)();return this.props.siteLogoBgColor?this.props.siteLogoBgColor:e&&e.palette.themePrimary};return t})((function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._handleOnClick=function(e){r.props.logoOnClick&&r.props.logoOnClick(e)};r._imgLoadHandler=function(){r.setState({imageLoaded:!0})};r._imgLoadErrorHandler=function(){r.setState({imageError:!0})};r.state={imageLoaded:!1};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.siteLogoUrl!==this.props.siteLogoUrl&&this.setState({imageLoaded:!1})};t.prototype.render=function(){return i.createElement("div",null,this.renderSiteLogo(this.props?this.props.siteLogoUrl:null))};t.prototype.renderSiteLogo=function(e){var t;if(this.props){e&&!this.state.imageError&&(t=i.createElement("img",{role:"presentation","aria-hidden":"true",src:e,onLoad:this._imgLoadHandler,onError:this._imgLoadErrorHandler,style:{display:this.state.imageLoaded?void 0:"none"}}));!this.props.siteAcronym||e&&!this.state.imageError||(t=i.createElement("div",null,i.createElement("div",{role:"presentation","aria-hidden":"true",className:"ms-siteLogoAcronym ms-font-xxl",style:this._addOverrideStyle({backgroundColor:this.props.siteLogoBgColor,display:this.state.imageLoaded?"none":void 0},!0,!0)},this.props.siteAcronym),t))}var n=!this.state.imageLoaded&&!this.props.disableSiteLogoFallback,r=this.props,s=r.logoHref,o=r.siteTitle,u=i.createElement(s?"a":"div",{className:Object(S.e)("ms-siteLogo-defaultLogo",n&&Object(E.L)("Group")),onClick:this._handleOnClick,href:s,style:this._addOverrideStyle(void 0,!0),"aria-label":o},i.createElement("div",{className:"ms-siteLogo-actual"},t));return i.createElement("div",{className:"ms-siteLogoContainerOuter",style:this._addOverrideStyle()},i.createElement("div",{className:"ms-siteLogoContainerInner",style:this._addOverrideStyle()},u))};t.prototype._addOverrideStyle=function(e,t,n){var r=this.props,i=r.size,s=r.roundedCorners;if(i){var o=i.toString()+"px";e=this._addPropToStyleObj(e,"width",o);e=this._addPropToStyleObj(e,"height",o);if(t){var u=n?Math.round(i/3):i;e=this._addPropToStyleObj(e,"fontSize",u.toString()+"px")}}if(s){var a=i?(i/2).toString()+"px":"15px";e=this._addPropToStyleObj(e,"borderRadius",a)}return e};t.prototype._addPropToStyleObj=function(e,t,n){(e=e||{})[t]=n;return e};return t})(i.Component)),T=n(1396),N=n(2965),C=n(178),k=n(20),L=n(161),A=n(71),O=n(2081),M=n(835),_=n(3004),D=n(1410),P=n(2478),H=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._renderInfoTip=function(){var e=i.createElement("a",{href:"https://aka.ms/SPOIBUser",target:"_blank"},P.e.learnMoreLinkText),t=k.formatToArray(P.e.infoTip,e),n=k.format(P.e.infoTip,"");return i.createElement(D.e,{content:t,id:"IBSegment-info",calloutProps:{gapSpace:0},styles:{root:{display:"inline-block",position:"relative",top:4}}},i.createElement(f.e,{iconProps:{iconName:"Info"},ariaLabel:n,disabled:!1,checked:!1,styles:{rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"}}}))};return n}t.prototype.render=function(){var e=this.props,t=e.ibDisplayLabels,n=e.errorString,r=t.map(function(e,t){return i.createElement(i.Fragment,{key:e.objectId},i.createElement("span",{key:e.objectId},(t?", ":"")+e.displayName))});return this.props.isLoading?i.createElement(T.e,null):i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-sectionTitle"},P.e.displayTitle,this._renderInfoTip()),r,n?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-ErrorMessage","data-automationid":"CurrentIBSegmentDisplayView-ErrorMessage"},n):null)};return t})(M.e),B=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._setIBSegmentLabelsFromPromise=function(e){e.then(function(e){e.length>0?n.setState({ibDisplayLabels:e,isLoading:!1}):n.setState({errorString:P.e.errorLabelPresent,isLoading:!1})}).catch(function(){n.setState({errorString:P.e.error,isLoading:!1})})};n.state={errorString:"",ibDisplayLabels:[],isLoading:!0};return n}t.prototype.componentDidMount=function(){if(this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){this._isIBSite=!0;this._ibSegmentDatasource=new _.e(this.props.pageContext);var e=this._ibSegmentDatasource.getIBSegmentLabels();this._setIBSegmentLabelsFromPromise(e)}};t.prototype.render=function(){return this._isIBSite?i.createElement(H,Object(r.__assign)({},this.state)):null};return t})(M.e),j=n(55),F=n(77),I=n(980),q=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onRemoveDropdownElement=function(e){n.props.onRemoveDropdown&&n.props.onRemoveDropdown(e.currentTarget.id)};n._onDropdownChange=function(e,t){n.props.onDropdownChange&&n.props.onDropdownChange(t.key.toString(),e.target.id)};n._onAddAdditionalDropdown=function(e){n.props.additionalIBSegmentDropdownPairs.forEach(function(e){e.isIBSegmentDropdownPairDisabled=!0});n.setState({isAddingSegment:!0});n.props.onAddAdditionalDropdown&&n.props.onAddAdditionalDropdown()};n._getAdditionalTitleString=function(){return n._isShowEditPanelInfoBarrierFlightEnabled&&n.props.isHostSiteAdmin?P.e.displayTitleAdditionalSPAC:P.e.displayTitleAdditional};n._getAriaDescriptionForRemoveButton=function(e,t){if(n._isShowEditPanelInfoBarrierFlightEnabled){var r=P.e.removeAriaDescription;e.map(function(e){e.key===t&&(r=r+" "+e.text)});return r}};n.state={isAddingSegment:!1};n._isShowEditPanelInfoBarrierFlightEnabled=j.n.isFeatureEnabled({ODB:1975});return n}t.prototype.componentDidUpdate=function(e){this.props.additionalIBSegmentDropdownPairs.length!==e.additionalIBSegmentDropdownPairs.length&&this.setState({isAddingSegment:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.additionalIBSegmentDropdownPairs,r=t.errorString,s=t.areAllSelected,o=t.noAdditionalSegmentsString,u=n.map(function(t,r){return i.createElement("div",{key:t.key,id:t.key+"-parent",className:"ms-CompatibleIBSegmentElement-DropdownContainer",tabIndex:-1},i.createElement(v.e,{"aria-label":P.e.additionalSegmentPlaceholder,options:t.options,selectedKey:t.selectedKey,placeHolder:P.e.additionalSegmentPlaceholder,id:t.key,className:"ms-CompatibleIBSegmentElement-Dropdown",onChange:e._onDropdownChange,disabled:r<n.length-1||t.isIBSegmentDropdownPairDisabled}),i.createElement(f.e,{allowDisabledFocus:!0,key:t.key,iconProps:{iconName:"Cancel"},title:"Remove",ariaLabel:P.e.removeAriaLabel,ariaDescription:e._getAriaDescriptionForRemoveButton(t.options,t.selectedKey),id:t.key,className:"ms-CompatibleIBSegmentElement-DropdownRemove",onClick:e._onRemoveDropdownElement,disabled:!t.selectedKey}))});return this.props.isLoading?i.createElement(T.e,null):i.createElement(i.Fragment,null,i.createElement("div",{"aria-label":this._getAdditionalTitleString(),role:"group",className:"ms-CurrentIBSegmentDisplayView-additionalSectionTitle"},this._getAdditionalTitleString()),u,o?null:this.state.isAddingSegment?i.createElement(T.e,null):i.createElement("div",null,i.createElement(I.e,{allowDisabledFocus:!0,iconProps:{iconName:"Add"},onClick:this._onAddAdditionalDropdown,disabled:!s},P.e.addAdditionalSegment)),r?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-ErrorMessage","data-automationid":"CurrentIBSegmentDisplayView-ErrorMessage"},r):null,o?i.createElement("div",{className:"ms-CurrentIBSegmentDisplayView-NoAdditionalSegments","data-automationid":"CurrentIBSegmentDisplayView-NoAdditionalSegments"},o):null,this.props.isSaving?i.createElement(T.e,null):null)};return t})(M.e),R=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._createDropdownOptions=function(e){return e.map(function(e){return{key:e.objectId,text:e.displayName}})};n._removeDropdownOption=function(e){var t,r,i=n.state.additionalIBSegmentDropdownPairs,s=!0;i=i.filter(function(n){n.isIBSegmentDropdownPairDisabled||(r=n);if(n.key!==e){n.selectedKey&&n.selectedKey.length>0||(s=!1);return!0}n.selectedKey&&n.selectedKey.length>0&&n.options.some(function(e){if(e.key===n.selectedKey){t=e;return!0}return!1});return!1});if(r&&t){var o=n._getCurrentIBSegments().filter(function(e){return e!==t.key&&e!==r.selectedKey});(n.props.isHostSiteAdmin?n._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments(o):n._ibSegmentDatasource.getCompatibleSegments(o)).then(function(e){r.options=n._createDropdownOptions(e);n.setState({additionalIBSegmentDropdownPairs:i})})}n.setState({additionalIBSegmentDropdownPairs:i,areAllSelected:s,noAdditionalSegmentsString:""},function(){n._validateAndEnableDisableSaveButtonForSPAC();if(!A.e.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&r){var e=document.getElementById(r.key+"-parent");e&&e.focus()}})};n._dropdownChange=function(e,t){var i=n.state.additionalIBSegmentDropdownPairs,s=!0;i=i.map(function(n){if(n.key===t)return Object(r.__assign)(Object(r.__assign)({},n),{selectedKey:e});n.selectedKey&&n.selectedKey.length>0||(s=!1);return n});n.setState({additionalIBSegmentDropdownPairs:i,areAllSelected:s},function(){n._validateAndEnableDisableSaveButtonForSPAC()})};n._addAdditionalDropdown=function(){if(n.state.areAllSelected){var e=n._getCurrentIBSegments();if(n.props.isHostSiteAdmin){var t=n._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments(e);n._setAdditionalIBSegmentDropdownPairsFromPromise(t,!0)}else{t=n._ibSegmentDatasource.getCompatibleSegments(e);n._setAdditionalIBSegmentDropdownPairsFromPromise(t,!0)}}else n.setState({errorString:P.e.additionalSegmentNotSelected})};n._setAdditionalIBSegmentDropdownPairsFromPromise=function(e,t){e.then(function(e){if(e&&e.length>0){var i={options:n._createDropdownOptions(e),key:F.e.generate()};n.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n.state.additionalIBSegmentDropdownPairs,[i]),isLoading:!1,areAllSelected:!1,noAdditionalSegmentsString:""},function(){if(!A.e.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&t){var e=document.getElementById(i.key+"-parent");e&&e.focus()}})}else n.setState({noAdditionalSegmentsString:P.e.noCompatibleadditionalSegments,areAllSelected:!1,isLoading:!1},function(){if(!A.e.isActivated("AA3645AE-B971-446B-93FD-BCD469EACC2A","01/28/2021","focus the active dropdown")&&t){var e=document.querySelector(".ms-CurrentIBSegmentDisplayView-NoAdditionalSegments");e&&e.focus()}})}).catch(function(e){n.setState({errorString:n._getErrorString(e),isLoading:!1})})};n._saveIBSegments=function(){var e=n._getCurrentIBSegments();n.setState({additionalIBSegmentDropdownPairs:n.state.additionalIBSegmentDropdownPairs.map(function(e){e.isIBSegmentDropdownPairDisabled=!0;return e})});n.props.isHostSiteAdmin&&n.props.onIBSegmentsSaved?n.props.onIBSegmentsSaved(e):e.length!==n.props.pageContext.IBSegments.length?n._ibSegmentDatasource.setIBSegments(e).then(function(){n.setState({isSaving:!1});n.props.onIBSegmentsSaved&&n.props.onIBSegmentsSaved(e)}).catch(function(e){n.setState({errorString:n._getErrorString(e),isSaving:!1})}):n.props.onIBSegmentsSaved&&n.props.onIBSegmentsSaved(e)};n._getCurrentIBSegments=function(){var e=[];n.props.isHostSiteAdmin||(e=Object(r.__spreadArrays)(n.props.pageContext.IBSegments));n.state.additionalIBSegmentDropdownPairs.forEach(function(t){t.selectedKey&&t.selectedKey.length>0&&e.indexOf(t.selectedKey)<0&&e.push(t.selectedKey)});return e};n._getIBSegmentsFromIBSegmentLabelMap=function(){return n.props.pageContext.IBSegments&&0!==n.props.pageContext.IBSegments.length?Object.keys(n.props.ibSegmentLabelMap).filter(function(e){return n.props.pageContext.IBSegments.indexOf(e)>-1}).map(function(e){return{objectId:e,displayName:n.props.ibSegmentLabelMap[e]}}):Object.keys(n.props.ibSegmentLabelMap).map(function(e){return{objectId:e,displayName:n.props.ibSegmentLabelMap[e]}})};n._validateAndEnableDisableSaveButtonForSPAC=function(){if(n.props.isHostSiteAdmin&&n._isShowEditPanelInfoBarrierFlightEnabled){var e=n.state.additionalIBSegmentDropdownPairs,t=n.props.pageContext.IBSegments;if(e.length===t.length&&t.every(function(t){return e.find(function(e){return e.selectedKey===t})})){if(n.props.disableSaveButtonForAdminSite&&n._isSaveButtonForAdminSiteEnabled){n.props.disableSaveButtonForAdminSite();n._isSaveButtonForAdminSiteEnabled=!1}}else if(n.props.enableSaveButtonForAdminSite&&!n._isSaveButtonForAdminSiteEnabled){n.props.enableSaveButtonForAdminSite();n._isSaveButtonForAdminSiteEnabled=!0}}};n.state={errorString:"",isLoading:!0,additionalIBSegmentDropdownPairs:[],areAllSelected:!1,noAdditionalSegmentsString:"",isSaving:!1};n._isShowEditPanelInfoBarrierFlightEnabled=j.n.isFeatureEnabled({ODB:1975});n._isSaveButtonForAdminSiteEnabled=!1;return n}t.prototype.componentDidMount=function(){if(this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin||this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){this._ibSegmentDatasource=new _.e(this.props.pageContext);if(this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin)this._setInitialIBSegmentDropdownPairsForAdmin();else{var e=this._ibSegmentDatasource.getCompatibleSegments(this.props.pageContext.IBSegments);this._setAdditionalIBSegmentDropdownPairsFromPromise(e,!1)}}};t.prototype._setInitialIBSegmentDropdownPairsForAdmin=function(){var e=this;if(this.props.ibSegmentLabelMap)try{var t=this._getIBSegmentsFromIBSegmentLabelMap(),n=[];if(0===this.props.pageContext.IBSegments.length){var i=this._createDropdownOptions(t);n.push({options:i,key:F.e.generate()})}else t.map(function(t){var r=e._createDropdownOptions([t]);n.push({options:r,key:t.objectId,selectedKey:t.objectId,isIBSegmentDropdownPairDisabled:!0})});this.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n),isLoading:!1,areAllSelected:this.props.pageContext.IBSegments.length>0,noAdditionalSegmentsString:""})}catch(e){this.setState({errorString:P.e.error,isLoading:!1})}else if(0===this.props.pageContext.IBSegments.length){var s=this._ibSegmentDatasource.getTenantAllOrCompatibleIBSegments([]);this._setAdditionalIBSegmentDropdownPairsFromPromise(s,!1)}else{this._ibSegmentDatasource.getIBSegmentLabels().then(function(t){if(t&&t.length>0){var n=[];t.map(function(t){var r=e._createDropdownOptions([t]);n.push({options:r,key:t.objectId,selectedKey:t.objectId,isIBSegmentDropdownPairDisabled:!0})});e.setState({additionalIBSegmentDropdownPairs:Object(r.__spreadArrays)(n),isLoading:!1,areAllSelected:!0,noAdditionalSegmentsString:""})}}).catch(function(t){e.setState({errorString:e._getErrorString(t),isLoading:!1})})}};t.prototype.render=function(){return this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin||this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0?i.createElement(q,Object(r.__assign)({},this.state,{onRemoveDropdown:this._removeDropdownOption,onDropdownChange:this._dropdownChange,onAddAdditionalDropdown:this._addAdditionalDropdown,isSaving:this.state.isSaving,isHostSiteAdmin:this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin})):null};t.prototype.componentDidUpdate=function(e){if(this.props.saveIBSegmentsClicked&&!e.saveIBSegmentsClicked){this.setState({isSaving:!0});this._saveIBSegments()}this._isShowEditPanelInfoBarrierFlightEnabled&&this.props.isHostSiteAdmin&&!this.props.saveIBSegmentsClicked&&e.saveIBSegmentsClicked&&this.setState({isSaving:!1})};t.prototype._getErrorString=function(e){return e&&e.message?e.message.value||e.message:P.e.error};return t})(M.e),U=n(470),z=n(4517),W=n(359),X=n(3427),V=n(1929),$=n(73),J=n(2586);n.d(t,"n",function(){return Z});n.d(t,"e",function(){return ee});n.d(t,"t",function(){return ne});var K={ODB:681},Q={ODB:1067},G={ODB:675},Y={ODB:60028},Z=["image/png","image/jpeg","image/gif","image/bmp","image/tiff"],ee=4194304,te=0,ne=(function(e){Object(r.__extends)(t,e);function t(n){var o=e.call(this,n)||this;o._nameText=Object(i.createRef)();o._descriptionText=Object(i.createRef)();o._privacyDropdown=Object(i.createRef)();o._classificationDropdown=Object(i.createRef)();o._imageBrowser=Object(i.createRef)();o._joinHubSiteDropdown=Object(i.createRef)();o._onRenderMUIEditingInfoLabel=function(e,t){return function(n,r){var u,a,l,c;if(null===(u=o.props.pageContext)||void 0===u?void 0:u.webLanguage){var h=k.format(s.e.translationInfoText,J.e.getResourceByCode(null===(a=o.props.pageContext)||void 0===a?void 0:a.webLanguage),e?s.e.translateSiteName:s.e.translateSiteDescription),p=k.format(s.e.translationInfoTextDefaultLanguage,e?s.e.translateSiteName:s.e.translateSiteDescription);return i.createElement("div",null,r(n),i.createElement(D.e,{content:i.createElement("span",null,t===(null===(l=o.props.pageContext)||void 0===l?void 0:l.webLanguage)&&t!==(null===(c=o.props.pageContext)||void 0===c?void 0:c.currentLanguage)?h:p)},i.createElement(f.e,{className:"ms-MUIEditing-InfoIcon",iconProps:{iconName:"Info"}})))}}};o._onMakeHubCheckboxChecked=function(e,t){C.e.logData({name:"SiteSettingsPanel.MakeHub.Click",isIntentional:!0});o.setState({makeHubCheckboxChecked:t,hubDisplayType:t?0:o.props.hubDisplayType})};o._onHubPermSyncCheckboxChange=function(e,t){o.setState({hubPermSyncCheckboxChecked:t})};o._onHubPermSyncToggleChange=function(e,t){o.setState({hubPermSyncCheckboxChecked:t})};o._onDeleteConfirmationCheckboxChange=function(e,t){o.setState({deleteConfirmationCheckboxChecked:t})};o._onDeleteConfirmationDialogAccept=function(){C.e.logData({name:"SiteSettingsPanel.DeleteGroupConfirmation.Click"});o.setState({showDeletingSpinner:!0});o.props.onDeleteGroup&&o.props.onDeleteGroup()};o._onDeleteConfirmationDialogCancel=function(){o.setState({showDeleteConfirmationDialog:!1});o.props.onDeleteGroupDismiss&&o.props.onDeleteGroupDismiss()};o._onDescriptionChange=function(e,t){t!==o.state.description&&o.setState({description:t})};o._onDeleteGroupClick=function(){C.e.logData({name:"SiteSettingsPanel.DeleteGroup.Click"});o.props.deleteSiteFallbackUrl?window.location.href=o.props.deleteSiteFallbackUrl:o.setState({showDeleteConfirmationDialog:!0,showDeletingSpinner:!1,deleteConfirmationCheckboxChecked:!1})};o._onSaveClick=function(e){var t=o,n=t.props,r=t.state,i=o._nameText.current,s=o._descriptionText.current,u=o._imageBrowser.current;C.e.logData({name:"SiteSettingsPanel.Save.Click"});o.setState({showSavingSpinner:!0,saveButtonDisabled:!0});if(n.onSave){var a="",f="";if(o._useTitleDescriptionState){a=o.state.name?o.state.name.trim():"";f=o.state.description?o.state.description.trim():""}else{a=i&&i.value?i.value.trim():"";f=s&&s.value?s.value.trim():""}n.onSave(n.groupNameWithPrefixAndSuffix?n.groupNameWithPrefixAndSuffix:a,f,o._findDropdownOption(n.privacyOptions,r.privacySelectedKey),o._findDropdownOption(n.classificationOptions,r.classificationSelectedKey),u&&u.getImageFile(),o._findDropdownOption(n.joinHubSiteOptions,r.joinHubSiteSelectedKey),r.makeHubCheckboxChecked,!o._hidePermSyncControl&&r.hubPermSyncCheckboxChecked,o.state.titleTranslations,o.state.descriptionTranslations)}};o._onCancelClick=function(e){C.e.logData({name:"SiteSettingsPanel.Cancel.Click"});o._closePanel()};o._onNameTextChanged=function(e,t){var n=o._nameText.current,r=o._useTitleDescriptionState?t?t.trim():"":n&&n.value?n.value.trim():"";o._useTitleDescriptionState&&o.state.name!==t&&o.setState({name:t});if(o.props.onValidateGroupName){var i=new L.e(o);o.state.saveButtonDisabled||o.setState({saveButtonDisabled:!0});i.setTimeout(function(){var e=this,t=n&&n.value?n.value.trim():"";t===r&&this.props.onValidateGroupName(t).then(function(){e.setState({saveButtonDisabled:e.props.isGroupNameValidationInProgress||!Boolean(t)||Boolean(e.props.groupNameValidationError)})})}.bind(o),500)}else o.setState({saveButtonDisabled:!Boolean(r)})};o._onClassificationOptionChanged=function(e){o.setState({classificationSelectedKey:e.key,errorMessage:void 0})};o._onClassificationOptionChangedPrivacy=function(e){o._onClassificationOptionChanged(e);var n=t._getDerivedPrivacyStateForClassification(o.props,e.key.toString());o.setState(Object(r.__assign)({},n))};o._onJoinHubSiteOptionChanged=function(e){o.setState({joinHubSiteSelectedKey:e.key,makeHubDisplayType:e.key?0:o.props.makeHubDisplayType})};o._onCancelPendingHubSiteJoinClicked=function(){o.props.onCancelPendingHubSiteJoinClicked&&o.props.onCancelPendingHubSiteJoinClicked()};o._onPrivacyOptionChanged=function(e){o.setState({privacySelectedKey:e.key})};o._closePanel=function(){o.props.onDismiss&&o.props.onDismiss()};o._focusOnTranslationLink=function(e){if(o._shouldRestoreFocusWhenExitMUIEditing)switch(e){case 2:o._translateSiteDescriptionLink&&o._translateSiteDescriptionLink.current.focus();break;case 1:o._translateSiteNameLink&&o._translateSiteNameLink.current.focus()}};o._renderLanguageEditingComponent=function(e){var t=e===V.e.SiteTitle,n=o._nameText.current,r=o._descriptionText.current,s=o._useTitleDescriptionState?o.state.name:n.value,u=o._useTitleDescriptionState?o.state.description:r.value;return i.createElement("div",{className:"ms-SiteSettingsPanel-LanguagePanel"},i.createElement(X.e,{dataSourceType:e,pageContext:o.props.pageContext,onSaveClick:o._onTranslationSaveClick(e),onCancelClick:o._onTranslatePanelDismiss,multilineInput:!t,translations:t?o.state.titleTranslations:o.state.descriptionTranslations,currentDisplay:t?s:u,currentLCID:t?o.state.nameCurrentLCID:o.state.descriptionCurrentLCID,defaultLanguageIsOptional:!t}))};o._onTranslationSaveClick=function(e){return function(t){var n=e===V.e.SiteTitle,r=e===V.e.SiteDescription,i=o._getDisplayLanguage(t),s=o.state.translatePanelType;o.setState({name:n?i.value:o.state.name,nameCurrentLCID:n?i.code:o.state.nameCurrentLCID,description:r?i.value:o.state.description,descriptionCurrentLCID:r?i.code:o.state.descriptionCurrentLCID,translatePanelType:0,titleTranslations:n?t:o.state.titleTranslations,descriptionTranslations:r?t:o.state.descriptionTranslations},function(){return o._focusOnTranslationLink(s)});if(!A.e.isActivated("6921c992-ef26-401f-8ee8-3c156da6ff3a","02/17/2021","logging MUIEditing telemetry")){var u=o.state.titleTranslations?o.state.titleTranslations.filter(function(e){return e.value&&e.value.length>0}):[];n?C.e.logData({name:"SiteSettingsPanel.SiteTitleTranslationsPanelOK.Click",extraData:{translatedItems:u.length}}):C.e.logData({name:"SiteSettingsPanel.SiteDescriptionTranslationsPanelOK.Click",extraData:{translatedItems:u.length}})}}};o._getDisplayLanguage=function(e){var t=e.filter(function(e){var t;return e.code===(null===(t=o.props.pageContext)||void 0===t?void 0:t.currentLanguage)}),n=e.filter(function(e){var t;return e.code===(null===(t=o.props.pageContext)||void 0===t?void 0:t.webLanguage)});return 1===t.length&&t[0].value.trim().length>0?t[0]:n[0]};o._handleOpenTranslatePanel=function(e){return function(){o.setState({translatePanelType:e});if(!A.e.isActivated("6921c992-ef26-401f-8ee8-3c156da6ff3a","02/17/2021","logging MUIEditing telemetry"))switch(e){case 1:C.e.logData({name:"SiteSettingsPanel.SiteTitleTranslationsPanelOpen.Click"});break;case 2:C.e.logData({name:"SiteSettingsPanel.SiteDescriptionTranslationsPanelOpen.Click"})}}};o._onTranslatePanelDismiss=function(){var e=o.state.translatePanelType;o.setState({translatePanelType:0},function(){o._focusOnTranslationLink(e)})};o._onClassificationDescriptionsClick=function(){C.e.logData({name:"SiteSettingsPanel.ClassificationDescriptions.Click"});o.setState({showClassificationDescriptions:!0})};o._onClassificationDescriptionsDismiss=function(){o.setState({showClassificationDescriptions:!1})};o._onAddIBSegmentLinkClick=function(){o.setState({showAddIBSegments:!0})};o._onAddIBSegmentsDismiss=function(){o.setState({showAddIBSegments:!1,isSavingIBSegments:!1})};o._onSaveClickIBSegment=function(){o.setState({isSavingIBSegments:!0})};o._onAddIBSegmentsSaved=function(e){o.props.pageContext.IBSegments=e;o.setState({showAddIBSegments:!1,isSavingIBSegments:!1})};o.state={privacySelectedKey:void 0,classificationSelectedKey:void 0,joinHubSiteSelectedKey:void 0,showClassificationDescriptions:!1,makeHubCheckboxChecked:n.isHubSite,hubDisplayType:n.hubDisplayType,makeHubDisplayType:n.makeHubDisplayType,isPrivacyDisabled:!1,showAddIBSegments:!1,isSavingIBSegments:!1,translatePanelType:0,name:void 0,description:void 0,nameCurrentLCID:o.props.nameCurrentLCID,descriptionCurrentLCID:o.props.descriptionCurrentLCID};o._classificationDropdownId="SiteClassificationDropdown"+te++;o._isRootWebContext=Object($.l)(o.props.pageContext);o._isTeamsChannelSite=o.props.pageContext.isTeamsChannelSite;C.e.logData({name:"SiteSettingsPanel.Opened"});return o}t.prototype.componentDidMount=function(){if(this._isMUIEditingFlightOn&&this.props.pageContext){var e=new W.e(this.props.pageContext.featureInfo);if(e){var t=e.get("MultilingualPages");this._multilingualFeatureOn=!!t&&t.enabled}if(this._multilingualFeatureOn){this._translateSiteNameLink=i.createRef();this._translateSiteDescriptionLink=i.createRef()}}this._useTitleDescriptionState=!A.e.isActivated("a1c80eb7-8f58-497e-93c3-507ce9af9cc4","12/10/2020","utilize title descripltion from state");this._useLocalizedMSLEFT=!A.e.isActivated("a05b4b1b-76b5-4363-90bd-0a3a0cfae4be","2/9/2021","use RTL logic to display back button");this._shouldRestoreFocusWhenExitMUIEditing=!A.e.isActivated("e3c98a95-86fb-4855-9d72-bb3d0f1aad65","2/16/2021","restore focus to link after existing MUI Editing")};t.getDerivedStateFromProps=function(e,n){var i={};if(e.errorMessage||e.groupDeleteErrorMessage){i.showSavingSpinner=!1;i.showDeletingSpinner=!1;i.saveButtonDisabled=!1;i.errorMessage=e.errorMessage}if(!e.showLoadingSpinner){void 0===n.privacySelectedKey&&(i.privacySelectedKey=e.privacySelectedKey);if(void 0===n.classificationSelectedKey){i.classificationSelectedKey=e.classificationSelectedKey;if(e.useSensitivityLabels){var s=t._getDerivedPrivacyStateForClassification(e,e.classificationSelectedKey);i=Object(r.__assign)(Object(r.__assign)({},i),s)}}if(e.joinHubSiteSelectedKey!==n.lastJoinHubSiteSelectedKeyProp){i.joinHubSiteSelectedKey=e.joinHubSiteSelectedKey;i.lastJoinHubSiteSelectedKeyProp=e.joinHubSiteSelectedKey}}e.hubDisplayType!==n.hubDisplayType&&(i.hubDisplayType=e.hubDisplayType);e.makeHubDisplayType!==n.makeHubDisplayType&&(i.makeHubDisplayType=e.makeHubDisplayType);void 0===n.hubPermSyncCheckboxChecked&&(i.hubPermSyncCheckboxChecked=e.isHubPermSyncEnabled);e.name!==n.name&&""!==e.name&&void 0===n.name&&(i.name=e.name);e.description!==n.description&&""!==e.description&&void 0===n.description&&(i.description=e.description);e.nameCurrentLCID!==n.nameCurrentLCID&&e.nameCurrentLCID&&void 0===n.nameCurrentLCID&&(i.nameCurrentLCID=e.nameCurrentLCID);e.descriptionCurrentLCID!==n.descriptionCurrentLCID&&e.descriptionCurrentLCID&&void 0===n.descriptionCurrentLCID&&(i.descriptionCurrentLCID=e.descriptionCurrentLCID);return i};t.prototype.render=function(){var e,t=this,n=this.props,c=this.props,h=c.classificationOptions,p=c.classificationDescriptions,d=c.makeHubDisplayType,m=c.name,E=c.privacyOptions,x=c.groupNameValidationError,C=c.groupNameWithPrefixAndSuffix,L=c.isGroupNameValidationInProgress,M=c.useSensitivityLabels,_=this.state,P=s.e.title;if(n.showLoadingSpinner)e=i.createElement(T.e,null);else if(_.showClassificationDescriptions){e=this._renderClassificationDescriptions();P=M?s.e.classificationLabelO365:s.e.classificationDescriptionsTitle}else if(j.n.isFeatureEnabled(K)&&_.showAddIBSegments){P=s.e.addIBSegmentsTitle;e=this._renderAddIBSegments()}else if(0!==_.translatePanelType){var H=1===_.translatePanelType;P=H?s.e.translateSiteName:s.e.translateSiteDescription;e=this._renderLanguageEditingComponent(H?V.e.SiteTitle:V.e.SiteDescription)}else{var F=this._shouldDisplayMUIEditing&&this.state.nameCurrentLCID?k.format(s.e.nameLabelWithLanguage,J.e.getResourceByCode(this.state.nameCurrentLCID)):s.e.nameLabel,I=this._shouldDisplayMUIEditing&&this.state.descriptionCurrentLCID?k.format(s.e.descriptionLabelWithLanguage,J.e.getResourceByCode(this.state.descriptionCurrentLCID)):s.e.descriptionLabel;e=i.createElement("div",{className:"ms-SiteSettingsPanel-content"},this._renderSiteLogo(),this._isRootWebContext&&this._renderUsageLink(),i.createElement("div",{className:"ms-SiteSettingsPanel-SiteInfo","data-automationid":"SiteSettingsPanelSiteInfo"},i.createElement(N.e,{className:Object(S.e)("ms-SiteSettingsPanel-nameText",{"prefix-suffix":!!C},{"ms-SiteSettingsPanel-nameText-translateLink":this._shouldDisplayMUIEditing}),componentRef:this._nameText,label:F,defaultValue:this._useTitleDescriptionState?void 0:m,value:this._useTitleDescriptionState?this.state.name:void 0,onChange:this._onNameTextChanged,errorMessage:L?null:x,required:!0,"data-automationid":"SiteSettingsPanelNameText",onRenderLabel:this._shouldDisplayMUIEditing?this._onRenderMUIEditingInfoLabel(!0,this.state.nameCurrentLCID):void 0,styles:this._shouldDisplayMUIEditing?{subComponentStyles:{label:{root:{":after":{paddingRight:0,paddingLeft:0},display:"inline-block"}}}}:void 0}),this._shouldDisplayMUIEditing&&i.createElement(y.e,{componentRef:this._translateSiteNameLink,onClick:this._handleOpenTranslatePanel(1),className:"ms-SiteSettingsPanel-translationButton","aria-label":s.e.translateSiteName},s.e.translateSiteName),L?i.createElement(T.e,{label:s.e.validateGroupNameSpinnerLabel}):C?i.createElement("span",{className:"ms-SiteSettingsPanel-groupNameWithPrefixAndSuffix"},C):null,i.createElement(N.e,{componentRef:this._descriptionText,label:I,defaultValue:this._useTitleDescriptionState?void 0:n.description,multiline:!0,onChange:this._useTitleDescriptionState?this._onDescriptionChange:void 0,value:this._useTitleDescriptionState?this.state.description:void 0,resizable:!1,"data-automationid":"SiteSettingsPanelDescriptionText",className:Object(S.e)("ms-SiteSettingsPanel-siteDescription",{"ms-SiteSettingsPanel-siteDescription-translateLink":this._shouldDisplayMUIEditing}),onRenderLabel:this._shouldDisplayMUIEditing?this._onRenderMUIEditingInfoLabel(!1,this.state.descriptionCurrentLCID):void 0,styles:this._shouldDisplayMUIEditing?{subComponentStyles:{label:{root:{display:"inline-block"}}}}:void 0}),this._shouldDisplayMUIEditing&&i.createElement(y.e,{componentRef:this._translateSiteDescriptionLink,onClick:this._handleOpenTranslatePanel(2),className:"ms-SiteSettingsPanel-translationButton","aria-label":s.e.translateSiteDescription},s.e.translateSiteDescription),this._isRootWebContext&&this._renderJoinHubDropdown(),i.createElement(O.t,Object(r.__assign)({},n.flowWidgetPanelProps)),this._isRootWebContext&&i.createElement(i.Fragment,null,2===d?i.createElement("div",{className:"ms-SiteSettingsPanel-makeHubCheckbox"},i.createElement(l.e,{label:s.e.makeHubSiteLabel,checked:_.makeHubCheckboxChecked,onChange:this._onMakeHubCheckboxChecked,disabled:!!_.joinHubSiteSelectedKey})):null),this._isRootWebContext&&h&&h.length?i.createElement("div",{className:"ms-SiteSettingsPanel-classification"},i.createElement(g.e,{className:"ms-Dropdown-label ms-SiteSettingsPanel-classificationDropDownLabel",htmlFor:this._classificationDropdownId},M?s.e.classificationLabelO365:s.e.classificationLabel),p&&p.length>0?i.createElement(y.e,{onClick:this._onClassificationDescriptionsClick,"data-automationid":"SiteSettingsPanelclassificationInfoIcon"},i.createElement(a.e,{iconName:"Info",className:"ms-SiteSettingsPanel-classificationInfoIcon"})):null,i.createElement(v.e,{className:"ms-SiteSettingsPanel-ClassificationDropdown",componentRef:this._classificationDropdown,id:this._classificationDropdownId,options:h,selectedKey:_.classificationSelectedKey,onChanged:M?this._onClassificationOptionChangedPrivacy:this._onClassificationOptionChanged,disabled:this._isTeamsChannelSite&&!A.e.isActivated("BFCC0647-0268-49F0-9AD9-966BFF0BEFF9","09/17/2020","Disable sensitivity label / classification dropdown on private channel sites")&&j.n.isFeatureEnabled(Y)})):null,this._isRootWebContext&&E&&E.length?i.createElement(v.e,{className:"ms-SiteSettingsPanel-PrivacyDropdown",componentRef:this._privacyDropdown,label:s.e.privacyLabel,options:E,selectedKey:_.privacySelectedKey,onChanged:this._onPrivacyOptionChanged,disabled:!!M&&_.isPrivacyDisabled}):null,this._isRootWebContext&&this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0&&i.createElement("div",{className:"ms-SiteSettingsPanel-IBSegmentsSection"},i.createElement("div",{className:"ms-SiteSettingsPanel-CurrentIBSegmentDisplay"},i.createElement(B,{pageContext:this.props.pageContext})," "),j.n.isFeatureEnabled(K)&&i.createElement("div",{className:"ms-SiteSettingsPanel-UsageLink"},i.createElement(D.e,{content:this.props.pageContext.isTeamsConnectedSite?s.e.manageIBSegmentsInTeamsMessage:null},i.createElement(y.e,{onClick:this._onAddIBSegmentLinkClick,disabled:this.props.pageContext.isTeamsConnectedSite},s.e.addIBSegments)))),_.errorMessage?i.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage","data-automationid":"SiteSettingsPanelErrorMessage"},_.errorMessage):null,_.showSavingSpinner?i.createElement(T.e,{className:"ms-SiteSettingsPanel-savingSpinner"}):null,this._renderHelpTextFooter(),this._renderDeleteGroupLink()))}var q=this._useLocalizedMSLEFT&&Object(U.e)()?"Forward":"Back",R=this._useLocalizedMSLEFT?"ms-SiteSettingsPanel-BackIcon-RTL":"ms-SiteSettingsPanel-BackIcon";return i.createElement(b.e,{className:"ms-SiteSettingsPanel",isOpen:n.isPanelOpen,type:w.e.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,closeButtonAriaLabel:s.e.closeButton,"aria-live":this._shouldDisplayMUIEditing?"polite":"off",headerText:_.showClassificationDescriptions||_.showAddIBSegments||0!==_.translatePanelType?null:P,onRenderNavigationContent:function(e,n){return _.showClassificationDescriptions?i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent"},i.createElement(f.e,{iconProps:{iconName:q},className:R,onClick:_.showClassificationDescriptions?t._onClassificationDescriptionsDismiss:t._closePanel,ariaLabel:s.e.backButtonLabel}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",P),n(e)):_.showAddIBSegments?i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent"},i.createElement(f.e,{iconProps:{iconName:q},className:R,onClick:t._onAddIBSegmentsDismiss,ariaLabel:s.e.backButtonLabel}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",P),n(e)):0!==_.translatePanelType?i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContent ms-SiteSettingsPanel-NavigationContentTranslate"},i.createElement(f.e,{iconProps:{iconName:q},className:R,onClick:t._onTranslatePanelDismiss,ariaLabel:s.e.backButtonLabel}),i.createElement("p",{className:"ms-SiteSettingsPanel-Title"}," ",P),n(e)),i.createElement(z.e,null)):i.createElement("div",{className:"ms-SiteSettingsPanel-NavigationContentDismiss"}," ",n(e)," ")},onRenderFooterContent:function(e,n){return _.showClassificationDescriptions?i.createElement(o.e,{className:"ms-ClassificationDescriptions-dismissButton",onClick:t._onClassificationDescriptionsDismiss},s.e.classificationDescriptionDismiss):_.showAddIBSegments?i.createElement("div",{className:"ms-SiteSettingsPanel-Buttons","data-automationid":"SiteSettingsPanelButtons"},i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(o.e,{className:"ms-SiteSettingsPanelButton-saveButton",disabled:_.saveButtonDisabled,onClick:t._onSaveClickIBSegment,"data-automationid":"SiteSettingsPanelSaveButtonIBSegment"},s.e.saveButton)),i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(u.e,{className:"ms-SiteSettingsPanelButton-cancelButton",onClick:t._onAddIBSegmentsDismiss,"data-automationid":"SiteSettingsPanelCancelButtonIBSegment"},s.e.closeButton))):0===_.translatePanelType?i.createElement(i.Fragment,null,!_.showClassificationDescriptions&&i.createElement("div",{className:"ms-SiteSettingsPanel-Buttons","data-automationid":"SiteSettingsPanelButtons"},i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(o.e,{className:"ms-SiteSettingsPanelButton-saveButton",disabled:_.saveButtonDisabled,onClick:t._onSaveClick,"data-automationid":"SiteSettingsPanelSaveButton"},s.e.saveButton)),i.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},i.createElement(u.e,{className:"ms-SiteSettingsPanelButton-cancelButton",onClick:t._onCancelClick,"data-automationid":"SiteSettingsPanelCancelButton"},s.e.closeButton)))):void 0}},e,this._renderDeleteConfirmationDialog())};t._getDerivedPrivacyStateForClassification=function(e,t){var n={},r=e.classificationPrivacy;if(r.length>0&&t){var i=r.filter(function(e){return e.classificationTitle===t}).pop(),s=i?i.classificationPrivacy:void 0;if(s){var o=void 0;o=A.e.isActivated("8770829e-3a57-4518-ac8b-d9ee1f50697c","10/02/2020","UnspecifiedPrivacyOption")?"private"===s.toLowerCase()?"private":"unspecified"===s.toLocaleLowerCase()&&e&&e.privacySelectedKey?e.privacySelectedKey:"public":"private"===s.toLowerCase()?"private":"public"===s.toLocaleLowerCase()?"public":e&&t===e.classificationSelectedKey&&e.privacySelectedKey?e.privacySelectedKey:"private";var u="unspecified"!==s.toLowerCase();n.privacySelectedKey=o;n.isPrivacyDisabled=u}else n.isPrivacyDisabled=!1}return n};t.prototype._findDropdownOption=function(e,t){return e&&e.filter(function(e){return e.key===t})[0]};t.prototype._renderJoinHubDropdown=function(){if(!this.props.isHubSite){var e,t=this.props,n=this.state,r=t.hubDisplayType,o=t.joinHubSiteOptions,u=t.isHubOptionsReady,a=t.isHubSitePermSyncSupported,f=t.hubSites,h=n.joinHubSiteSelectedKey;if(!u)return i.createElement(T.e,{className:"ms-SiteSettingsPanel-hubLoadingSpinner"});if(f)for(var p in f)if(f[p].id===h){e=f[p];break}this._hidePermSyncControl=!A.e.isActivated("790e5187-5849-4513-8df3-17b4b4fa857d","02/23/2021","Fix qfe 1041490")&&!e||e&&!e.enablePermissionsSync;A.e.isActivated("5bf81a9d-f1e3-43af-94e0-351a993cbdb3","02/24/2021","Fix qfe 1041360")||(this._hidePermSyncControl=!this.props.pageContext.isSiteAdmin||this._hidePermSyncControl);var d=null;if(t.isHubSiteJoinPending)d=i.createElement("span",null,s.e.hubSiteJoinPendingTip,"  ",i.createElement(y.e,{onClick:this._onCancelPendingHubSiteJoinClicked},s.e.hubSiteJoinCancelPendingText));else if(t.joinHubSiteSelectedKey!==h)if(h){var m=this._findDropdownOption(o,h);d=i.createElement("span",null,s.e.joinHubSiteTip,a&&!this._hidePermSyncControl&&i.createElement(i.Fragment,null," "+s.e.hubPermSyncCheckBoxTip+" ",i.createElement(y.e,{href:"https://go.microsoft.com/fwlink/?linkid=2133626"},s.e.LearnMoreLinkText)),m.data&&m.data.requiresJoinApproval&&i.createElement("div",{style:{marginTop:20}},s.e.hubSiteJoinApprovalRequiredTip))}else d=s.e.disconnectHubSiteTip;return i.createElement("div",{className:"ms-SiteSettingsPanel-joinHubSite"},i.createElement(v.e,{className:"ms-SiteSettingsPanel-joinHubSiteDropdown",componentRef:this._joinHubSiteDropdown,label:s.e.hubLabel,options:o,selectedKey:h,onChanged:this._onJoinHubSiteOptionChanged,disabled:!!n.makeHubCheckboxChecked||!!t.isHubSiteJoinPending||1===r}),i.createElement("span",{className:"ms-SiteSettingsPanel-hubDropdownTip",role:"alert"},i.createElement("span",{key:h||"none"},d)),a&&!this._hidePermSyncControl&&h&&i.createElement(i.Fragment,null,A.e.isActivated("8da0b73e-4a0c-4fbb-9f94-a27396270ff6","06/24/2020","Use toggle button")?i.createElement(l.e,{className:"ms-SiteSettingsPanel-HubPermSyncCheckbox",checked:n.hubPermSyncCheckboxChecked,label:s.e.syncHubPermissionsCheckboxLabel,disabled:1===r,onChange:this._onHubPermSyncCheckboxChange}):i.createElement(c.e,{className:"ms-SiteSettingsPanel-HubPermSyncCheckbox",onText:"On",offText:"Off",checked:n.hubPermSyncCheckboxChecked,label:s.e.syncHubPermissionsCheckboxLabel,disabled:1===r,onChange:this._onHubPermSyncToggleChange})))}};t.prototype._renderDeleteGroupLink=function(){var e=null;this.props.enableDelete&&(e=i.createElement("div",{className:"ms-SiteSettingsPanel-DeleteGroupLink"},i.createElement(y.e,{onClick:this._onDeleteGroupClick,"data-automationid":"SiteSettingsPanelDeleteGroupLink"},i.createElement(a.e,{iconName:"Delete",className:"ms-SiteSettingsPanel-DeleteGroupLinkIcon"}),i.createElement("span",{className:"ms-SiteSettingsPanel-DeleteGroupLinkLabel"},s.e.deleteGroupLinkText))));return e};t.prototype._renderDeleteConfirmationDialog=function(){var e=this.props,t=e.enableDelete,n=e.groupDeleteErrorMessage,r=e.name,a=e.useDeleteSiteStrings,f=this.state,c=null;t&&(c=i.createElement(h.e,{hidden:!f.showDeleteConfirmationDialog,type:p.e.close,onDismiss:this._onDeleteConfirmationDialogCancel,isBlocking:!0,closeButtonAriaLabel:s.e.closeButton,title:a?s.e.deleteSiteConfirmationDialogTitle:s.e.deleteGroupConfirmationDialogTitle},i.createElement("div",null,k.format(a?s.e.deleteSiteConfirmationDialogText:s.e.deleteGroupConfirmationDialogText,r)),i.createElement(l.e,{className:"ms-SiteSettingsPanel-DeleteGroupConfirmationCheckbox",label:a?s.e.deleteSiteConfirmationDialogCheckbox:s.e.deleteGroupConfirmationDialogCheckbox,onChange:this._onDeleteConfirmationCheckboxChange}),n?i.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage"},n):null,i.createElement(d.e,null,i.createElement(o.e,{disabled:!f.deleteConfirmationCheckboxChecked||f.showDeletingSpinner,onClick:this._onDeleteConfirmationDialogAccept,text:s.e.deleteGroupConfirmationDialogButtonDelete}),i.createElement(u.e,{onClick:this._onDeleteConfirmationDialogCancel,text:s.e.closeButton}),f.showDeletingSpinner?i.createElement(T.e,null):null)));return c};t.prototype._renderHelpTextFooter=function(){var e=this.props.classicSiteSettingsUrl,t=null;e&&(t=i.createElement("div",{className:"ms-SiteSettingsPanel-HelpText","data-automationid":"SiteSettingsPanelHelperText"},i.createElement(y.e,{href:e},s.e.classicSiteSettingsLinkText)));return t};t.prototype._renderSiteLogo=function(){var e=this.props,t=this.props,n=t.siteLogo,r=t.showImageBrowser,o=null;n&&!r?o=i.createElement(x,{siteTitle:e.name,siteLogoUrl:n.imageUrl,siteAcronym:n.acronym,siteLogoBgColor:n.backgroundColor,disableSiteLogoFallback:!1,size:64}):r&&(o=i.createElement(m.e,{ref:this._imageBrowser,initialPreviewUrl:j.n.isFeatureEnabled(Q)?this.props.pageContext.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo":n&&n.imageUrl,disableRemove:e.disableRemoveLogo,supportedImageTypes:Z}));return i.createElement("div",{className:"ms-SiteSettingsPanel-SiteLogo","data-automationid":"SiteSettingsPanelSiteLogo"},i.createElement(g.e,{className:"ms-SiteSettingsPanel-SiteLogo-Title"},s.e.logoLabel),o)};t.prototype._renderUsageLink=function(){var e=this.props.usageGuidelinesUrl,t=null;e&&(t=i.createElement("div",{className:"ms-SiteSettingsPanel-UsageLink"},i.createElement(y.e,{href:e,target:"_blank","data-automationid":"SiteSettingsPanelUsageLink"},s.e.usageGuidelinesLinkText)));return t};t.prototype._renderClassificationDescriptions=function(){var e=this.props.classificationDescriptions;return e&&e.length>0?i.createElement("div",{className:"ms-SiteSettingsPanel-ClassificationDescriptions"},e.map(function(e,t){return i.createElement("div",{className:"ms-ClassificationDescriptions-item",key:t},i.createElement("div",{className:"ms-ClassificationDescriptions-itemTitle"},e.classificationTitle),i.createElement("div",{className:"ms-ClassificationDescriptions-itemDescription"},e.classificationDescription))})):null};t.prototype._renderAddIBSegments=function(){if(this.props.pageContext.IBSegments&&this.props.pageContext.IBSegments.length>0){var e=i.createElement("a",{href:"https://aka.ms/SPOInfoBarriers",target:"_blank"},s.e.LearnMoreLinkText),t=k.formatToArray(s.e.addIBSegmentsDescription,e);return i.createElement(i.Fragment,null,i.createElement("div",{className:"ms-SiteSettingsPanel-AddSegmentsDescription"},t),i.createElement("div",{className:"ms-SiteSettingsPanel-CompatibleIBSegmentDisplay"},i.createElement(B,{pageContext:this.props.pageContext}),i.createElement(R,{pageContext:this.props.pageContext,saveIBSegmentsClicked:this.state.isSavingIBSegments,onIBSegmentsSaved:this._onAddIBSegmentsSaved})))}return null};Object.defineProperty(t.prototype,"_isMUIEditingFlightOn",{get:function(){return j.n.isFeatureEnabled(G)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_shouldDisplayMUIEditing",{get:function(){return this._isMUIEditingFlightOn&&this._multilingualFeatureOn},enumerable:!0,configurable:!0});return t})(i.Component)},"2339":function(e,t,n){"use strict";n.d(t,"n",function(){return l});n.d(t,"e",function(){return c});n.d(t,"r",function(){return h});n.d(t,"t",function(){return p});var r,i,s,o=n(0),u=n(823);(function(e){e[e.Red=0]="Red";e[e.Orange=1]="Orange";e[e.Yellow=2]="Yellow";e[e.Green=3]="Green";e[e.Teal=4]="Teal";e[e.Blue=5]="Blue";e[e.Dark_Blue=6]="Dark_Blue";e[e.Indigo=7]="Indigo";e[e.Plum=8]="Plum";e[e.Purple=9]="Purple";e[e.Gray=10]="Gray";e[e.Warm_Gray=11]="Warm_Gray"})(s||(s={}));var a={red:"#a4262c",orange:"#ca5010",yellow:"#986f0b",green:"#498205",teal:"#03787c",blue:"#0078d4",dark_Blue:"#004e8c",indigo:"#4f6bed",plum:"#881798",purple:"#8764b8",gray:"#69797e",warm_Gray:"#7a7574"},f={red:"#ef6950",yellow:"#ffc83d",green:"#00b294",blue:"#3a96dd",purple:"#9c89e9",gray:"#b1adab"};function l(){return S}function c(e){return"#1b1a19"===e||"#182534"===e?d:v}function h(e,t){var n=(function(e,t){var n=m,r=w;if(e){n="#182534"===t?y:g;r=b}return{partialThemes:r,neutrals:n}})(e,t),r=n.neutrals,i=n.partialThemes,s={};for(var u in i){var a=i[u];s[a.themePrimary]=Object(o.__assign)(Object(o.__assign)({},a),r)}return s}function p(e,t){return e?f:a}var d={"#ef6950":["#9c89e9","#00b294","#3a96dd","#b1adab"],"#ffc83d":["#3a96dd","#ef6950","#9c89e9","#b1adab"],"#00b294":["#3a96dd","#9c89e9","#ef6950","#b1adab"],"#3a96dd":["#9c89e9","#00b294","#ef6950","#b1adab"],"#9c89e9":["#3a96dd","#ef6950","#ffc83d","#b1adab"],"#b1adab":["#3a96dd","#9c89e9","#ef6950","#ffc83d"]},v={"#a4262c":["#ca5010","#881798","#498205","#7a7574"],"#ca5010":["#986f0b","#a4262c","#498205","#7a7574"],"#986f0b":["#ca5010","#498205","#0078d4","#69797e"],"#498205":["#03787c","#0078d4","#ca5010","#69797e"],"#03787c":["#4f6bed","#0078d4","#ca5010","#69797e"],"#0078d4":["#8764b8","#03787c","#ca5010","#69797e"],"#004e8c":["#03787c","#0078d4","#986f0b","#69797e"],"#4f6bed":["#8764b8","#0078d4","#03787c","#69797e"],"#881798":["#03787c","#0078d4","#ca5010","#69797e"],"#8764b8":["#03787c","#0078d4","#986f0b","#69797e"],"#69797e":["#0078d4","#ca5010","#498205","#a4262c"],"#7a7574":["#ca5010","#0078d4","#498205","#a4262c"]},m=Object(o.__assign)(Object(o.__assign)({},u.e),{black:"#000000",white:"#ffffff",primaryBackground:"#ffffff",primaryText:"#333333"}),g={neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1b1a19",primaryText:"#f3f2f1"},y={neutralLighterAlt:"#1d2b3c",neutralLighter:"#223244",neutralLight:"#2b3d51",neutralQuaternaryAlt:"#324459",neutralQuaternary:"#374a5f",neutralTertiaryAlt:"#4f637a",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#182534",primaryBackground:"#182534",primaryText:"#ffffff"},b=((r={})[s.Red]={themePrimary:"#ef6950",themeLighterAlt:"#0a0403",themeLighter:"#26110d",themeLight:"#481f18",themeTertiary:"#903e2f",themeSecondary:"#d35b46",themeDarkAlt:"#f17660",themeDark:"#f38a77",themeDarker:"#f6a89a",accent:"#ef6950"},r[s.Yellow]={themePrimary:"#ffc83d",themeLighterAlt:"#0a0802",themeLighter:"#29200a",themeLight:"#4d3c12",themeTertiary:"#997825",themeSecondary:"#e0b036",themeDarkAlt:"#ffce51",themeDark:"#ffd56c",themeDarker:"#ffe092",accent:"#ffc83d"},r[s.Green]={themePrimary:"#00b294",themeLighterAlt:"#000706",themeLighter:"#001d18",themeLight:"#00362d",themeTertiary:"#006b59",themeSecondary:"#009d83",themeDarkAlt:"#13ba9e",themeDark:"#2fc5ac",themeDarker:"#5dd4c0",accent:"#00b294"},r[s.Blue]={themePrimary:"#3a96dd",themeLighterAlt:"#020609",themeLighter:"#091823",themeLight:"#112d43",themeTertiary:"#235a85",themeSecondary:"#3385c3",themeDarkAlt:"#4ba0e1",themeDark:"#65aee6",themeDarker:"#8ac2ec",accent:"#3a96dd"},r[s.Purple]={themePrimary:"#9c89e9",themeLighterAlt:"#060509",themeLighter:"#191625",themeLight:"#2f2946",themeTertiary:"#5e528b",themeSecondary:"#8978cc",themeDarkAlt:"#a594ea",themeDark:"#b2a4ee",themeDarker:"#c6bbf2",accent:"#9c89e9"},r[s.Gray]={themePrimary:"#b1adab",themeLighterAlt:"#070707",themeLighter:"#1c1c1b",themeLight:"#353433",themeTertiary:"#6a6766",themeSecondary:"#9b9896",themeDarkAlt:"#b8b5b3",themeDark:"#c3c0be",themeDarker:"#d3d0cf",accent:"#b1adab"},r),w=((i={})[s.Red]={themePrimary:"#a4262c",themeLighterAlt:"#fbf4f4",themeLighter:"#f0d3d4",themeLight:"#e3afb2",themeTertiary:"#c86c70",themeSecondary:"#ae383e",themeDarkAlt:"#932227",themeDark:"#7c1d21",themeDarker:"#5b1519",accent:"#ca5010"},i[s.Orange]={themePrimary:"#ca5010",themeLighterAlt:"#fdf7f4",themeLighter:"#f6dfd2",themeLight:"#efc4ad",themeTertiary:"#df8f64",themeSecondary:"#d06228",themeDarkAlt:"#b5490f",themeDark:"#993e0c",themeDarker:"#712d09",accent:"#986f0b"},i[s.Yellow]={themePrimary:"#986f0b",themeLighterAlt:"#fbf8f2",themeLighter:"#efe5cb",themeLight:"#e0cfa2",themeTertiary:"#c2a356",themeSecondary:"#a57f1e",themeDarkAlt:"#8a650a",themeDark:"#745608",themeDarker:"#563f06",accent:"#ca5010"},i[s.Green]={themePrimary:"#498205",themeLighterAlt:"#f6faf0",themeLighter:"#dbebc7",themeLight:"#bdda9b",themeTertiary:"#85b44c",themeSecondary:"#5a9117",themeDarkAlt:"#427505",themeDark:"#386304",themeDarker:"#294903",accent:"#03787c"},i[s.Teal]={themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446",accent:"#4f6bed"},i[s.Blue]={themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",accent:"#8764b8"},i[s.Dark_Blue]={themePrimary:"#004e8c",themeLighterAlt:"#f0f6fa",themeLighter:"#c7dced",themeLight:"#9abfdd",themeTertiary:"#4a88ba",themeSecondary:"#125d9a",themeDarkAlt:"#00457e",themeDark:"#003b6b",themeDarker:"#002b4f",accent:"#03787c"},i[s.Indigo]={themePrimary:"#4f6bed",themeLighterAlt:"#f7f9fe",themeLighter:"#e1e6fc",themeLight:"#c7d1fa",themeTertiary:"#92a4f4",themeSecondary:"#627cef",themeDarkAlt:"#4661d5",themeDark:"#3b52b4",themeDarker:"#2c3c85",accent:"#8764b8"},i[s.Plum]={themePrimary:"#881798",themeLighterAlt:"#faf2fb",themeLighter:"#ebceef",themeLight:"#daa7e0",themeTertiary:"#b65fc2",themeSecondary:"#972aa5",themeDarkAlt:"#7c158a",themeDark:"#691174",themeDarker:"#4d0d56",accent:"#03787c"},i[s.Purple]={themePrimary:"#8764b8",themeLighterAlt:"#f9f8fc",themeLighter:"#e9e2f4",themeLight:"#d7c9ea",themeTertiary:"#b29ad4",themeSecondary:"#9372c0",themeDarkAlt:"#7959a5",themeDark:"#664b8c",themeDarker:"#4b3867",accent:"#03787c"},i[s.Gray]={themePrimary:"#69797e",themeLighterAlt:"#f8f9fa",themeLighter:"#e4e9ea",themeLight:"#cdd5d8",themeTertiary:"#9fadb1",themeSecondary:"#78888d",themeDarkAlt:"#5d6c70",themeDark:"#4f5b5f",themeDarker:"#3a4346",accent:"#0078d4"},i[s.Warm_Gray]={themePrimary:"#7a7574",themeLighterAlt:"#faf9f9",themeLighter:"#eae8e8",themeLight:"#d7d5d4",themeTertiary:"#afabaa",themeSecondary:"#8a8584",themeDarkAlt:"#6e6a69",themeDark:"#5d5958",themeDarker:"#454241",accent:"#ca5010"},i),E={default_SharePoint:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Teal]),m)}},S=Object(o.__assign)(Object(o.__assign)({},E),{default_Office:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Blue]),m)},default_Orange:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Orange]),m)},default_Red:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Red]),m)},default_Purple:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Purple]),m)},default_Green:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Green]),m)},default_Gray:{name:"",backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},w[s.Gray]),m)},default_DarkYellow:{name:"",backgroundImageUri:"",isInverted:!0,theme:Object(o.__assign)(Object(o.__assign)({},b[s.Yellow]),g)},default_DarkBlue:{name:"",isInverted:!0,backgroundImageUri:"",theme:Object(o.__assign)(Object(o.__assign)({},b[s.Blue]),y)}})},"2999":function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r,i,s,o,u,a,f,l=n(0),c=n(73),h=n(4226),p=n(3844),d=n(2575),v=n(1342),m=n(54),g=n(178),y=n(20),b=n(42),w=n(4534),E=n(3452),S=n(107),x=n(71),T={ODB:1145};(function(e){e[e.Limited=0]="Limited";e[e.FullControl=1]="FullControl";e[e.Edit=2]="Edit";e[e.Read=3]="Read"})(f||(f={}));var N=((r={})[1]=f.Limited,r[2]=f.Read,r[3]=f.Edit,r[4]=f.Edit,r[6]=f.Edit,r[5]=f.FullControl,r),C=1073741830,k=1073741826,L=((i={})[5]=1073741829,i[6]=C,i[2]=k,i),A=48,O=128,M=2147483647,_=((s={})[5]=1,s[6]=A,s[2]=O,s),D=((o={})[f.Edit]=E.e.edit,o[f.FullControl]=E.e.fullControl,o[f.Read]=E.e.read,o),P=((u={})[f.FullControl]=E.e.siteOwners,u[f.Edit]=E.e.siteMembers,u[f.Read]=E.e.siteVisitors,u),H=((a={})[f.Read]=E.e.hubVisitors,a),B=(function(){function e(e){var t=this;this._permissionGroups={};this._shareSite=function(e,n,r){var i=t._assignUsersToPermssionGroup(e),s=[];t._sharingSiteProvider||(t._sharingSiteProvider=new w.e({pageContext:t._pageContext}));for(var o in i)if(i[o]&&i[o].length>0){var u=t._pageContext.isExternalGuestUser&&t._permissionLevelOfCurrentUser!==f.FullControl?"":"group:"+t._permissionGroups[o];s.push(t._sharingSiteProvider.shareSite(i[o],{siteUrl:t._pageContext.webAbsoluteUrl,roleValue:u,sendEmail:t._params.isEmailSharingEnabled&&n,message:r,requireSignIn:!0}))}return m.n.all(s).then(function(e){if(!x.e.isActivated("5a013444-053c-4234-8a89-3443d47a5952","02/04/2021","Improve share site error handling")&&e&&e.length>0)for(var n in e)if(e[n]&&e[n].errorMessage){t._setState({shareSiteErrorMsg:t._getShareSiteErrorMsg(e[n])});return!1}t._setState({showShareSiteOnly:!!t._params.shouldLoadSharePanelOnly});t._fetchUpdatedPermissions();return!0})};this._onCancel=function(){t._params.shouldLoadSharePanelOnly?t._setState({shouldDismissPanel:!0,shareSiteErrorMsg:null}):t._setState({showShareSiteOnly:!1,shareSiteErrorMsg:null});t._fetchUpdatedPermissions()};this._onDismiss=function(){t._setState({shareSiteErrorMsg:null})};this._saveHubPermissionSync=function(e){t._setState({showHubSyncToggleSpinner:!0});var n=void 0;g.e.logData({name:e?"SitePermissionsPanel.EnableHubPermSync":"SitePermissionsPanel.DisableHubPermSync",extraData:{isHubSite:t._pageContext.isHubSite}});(n=t._pageContext.isHubSite?t._hubDataSource.getHubSite(t._pageContext.hubSiteId).then(function(n){return t._hubDataSource.updateHubSite(Object(l.__assign)(Object(l.__assign)({},n),{description:n.description||"",enablePermissionsSync:e}))}):t._siteDataSource.setCanSyncHubSitePermissionsProperty(e))&&n.then(function(){t._fetchHubPermissions()},function(e){t._setState({hubPivotErrorString:t._getErrorString(e),showHubSyncToggleSpinner:!1})})};this._addHubUser=function(e){g.e.logData({name:"SitePermissions.AddHubUser"});t._setState({showHubSyncToggleSpinner:!0});var n=t._hubSiteGroups&&t._hubSiteGroups[0];n&&e&&t._sitePermissionsDataSource.ensureUser(e.userId).then(function(e){return t._sitePermissionsDataSource.addUserToGroup(String(n.id),e.loginName)}).then(function(){t._fetchHubPermissions()},function(e){t._setState({hubPivotErrorString:t._getErrorString(e),showHubSyncToggleSpinner:!1})})};this._shareSiteOnlyOnClick=function(){g.e.logData({name:"SitePermissions.ShareSiteOnlyClick"});t._setState({showShareSiteOnly:!t._params.sitePermissionsPanelContainer.state.showShareSiteOnly,showSavingSpinner:!1})};this._goToOutlookClick=function(){g.e.logData({name:"SitePermissions.GoToOutlookClick"});t._params.goToOutlookOnClick()};var n=e.pageContext;this._params=e;this._pageContext=n;this._sitePermissionsProvider=new h.e(n);this._sitePermissionsDataSource=new p.e(n);this._sharingSiteProvider=new w.e({pageContext:n});this._hubDataSource=new d.HubDataSource(n);this._siteDataSource=new v.SiteDataSource(n);this._permissionLevelOfCurrentUser=this._getPermissionLevelOfCurrentUser();this._isGroup=Object(c.s)(this._pageContext);this._isHubSitePermSyncEnabled=S.e.isFeatureEnabled(T)&&n.isSiteAdmin}e.prototype.componentDidMount=function(){var e=this;this._fetchUpdatedPermissions();this._getPickerSettings().then(function(){e._params.sitePermissionsPanelContainer.setState({pickerSettings:e._pickerSettings})})};e.prototype.componentWillUnmount=function(){};e.prototype.getRenderProps=function(e,t){var n,r=this._params,i=r.sitePermissionsPanelContainer.state,s=E.e,o=i&&i.hubSite&&i.hubSite.enablePermissionsSync,u=void 0;this._isHubSitePermSyncEnabled&&(u=this._pageContext.isHubSite?o:i&&i.canSyncHubSitePermissions);return{sitePermissions:i&&i.sitePermissions,showShareSiteOnly:!(!i||!i.showShareSiteOnly),showSavingSpinner:!(!i||!i.showSavingSpinner),menuItems:this._getPanelAddMenu(),pageContext:this._pageContext,onSave:this._shareSite,onCancel:this._onCancel,onDismiss:this._onDismiss,saveButton:r.shouldLoadSharePanelOnly?s.share:s.addButton,advancedPermSettingsUrl:r.advancedPermSettingsUrl,permissionStrings:D,sitePermissionsContextualMenuItems:this._getSitePermissionsContextualMenuItems(),goToOutlookOnClick:r.goToOutlookOnClick,addMemberDefaultPermissionLevel:r.addMemberDefaultPermissionLevel,sitePreviewLoader:r.sitePreviewLoader,shouldDismissPanel:i&&i.shouldDismissPanel,shouldLoadSharePanelOnly:r.shouldLoadSharePanelOnly,onShareSiteCallback:this._shareSiteOnlyOnClick.bind(this),permissionLevelOfCurrentUser:this._permissionLevelOfCurrentUser,isEmailSharingEnabled:r.isEmailSharingEnabled,pickerSettings:i&&i.pickerSettings,hasCustomizedGroups:i&&i.hasCustomizedGroups,lpcModuleLoader:e,lpcModuleCustomWaiter:t,strings:s,peoplePickerDataSource:r.peoplePickerDataSource,isDefaultPermissionsChanged:i&&i.isDefaultPermissionsChanged,showHubSyncToggleSpinner:i&&i.showHubSyncToggleSpinner,shareSiteErrorMsg:null===(n=i)||void 0===n?void 0:n.shareSiteErrorMsg,showHubPivot:this._isHubSitePermSyncEnabled&&(this._pageContext.isHubSite||o),onSaveHubPermissionSync:this._saveHubPermissionSync,enableHubPermissionsSync:u,isHubSite:this._pageContext.isHubSite,hubSiteTitle:i&&i.hubSite&&i.hubSite.name,hubSyncControlsAreDisabled:i&&i.hubSite&&!this._pageContext.isHubSite&&!i.hubSite.enablePermissionsSync,hubSitePermissions:i&&i.hubSitePermissions,onAddHubUserCallback:this._addHubUser,hubPivotErrorString:i&&i.hubPivotErrorString}};e.prototype._setState=function(e){this._params.sitePermissionsPanelContainer.setState(e)};e.prototype._fetchUpdatedPermissions=function(){var e=this;this._sitePermissionsProvider.getAssociatedPermissionGroups().then(function(t){e._associatedGroups=t}).then(function(){return e._checkIfDefaultPermissionsChanged(e._associatedGroups)}).then(function(t){e._isDefaultPermissionsChanged=t;t?e._setState({sitePermissions:void 0,menuItems:e._getPanelAddMenu(),isDefaultPermissionsChanged:!0,hasCustomizedGroups:e._hasCustomizedGroups}):e._sitePermissionsProvider.getSiteGroupsAndUsersWithPermissions(e._associatedGroups).then(function(t){if(t&&t.length){for(var n=0,r=t;n<r.length;n++){var i=r[n],s=N[i.roleType];e._permissionGroups[s]=i.id}var o=t.map(function(t){var n=N[t.roleType];return{personas:e._getPersona(t),title:P[n]||"",permLevel:n,permLevelTitle:e._permissionLevelOfCurrentUser!==f.FullControl?"":D[n]||"",emptyGroupText:e._params.emptyGroupText}});e._setState({sitePermissions:o,menuItems:e._getPanelAddMenu(),isDefaultPermissionsChanged:!1,hasCustomizedGroups:e._hasCustomizedGroups})}})});this._fetchHubPermissions()};e.prototype._fetchHubPermissions=function(){var e=this;if(this._isHubSitePermSyncEnabled&&this._pageContext.hubSiteId){this._setState({showHubSyncToggleSpinner:!0});var t,n,r,i=[],s=this._hubDataSource.getHubSite(this._pageContext.hubSiteId).then(function(e){t=e});i.push(s);if(!this._pageContext.isHubSite){var o=this._siteDataSource.getCanSyncHubSitePermissionsProperty(!0).then(function(e){n=e});i.push(o)}var u=this._sitePermissionsProvider.getHubSitePermissionGroups().then(function(t){e._hubSiteGroups=t;return e._sitePermissionsProvider.getSiteGroupsAndUsersWithPermissions(t).then(function(t){t&&t.length&&(r=t.map(function(t){var n=N[t.roleType];return{personas:e._getPersona(t,!0),title:H[n]||"",permLevel:n,permLevelTitle:D[n]||"",emptyGroupText:e._params.emptyGroupText,hideHeader:!0}}))})});i.push(u);m.n.all(i).then(function(){e._setState({hubSite:t,canSyncHubSitePermissions:n,hubSitePermissions:r,showHubSyncToggleSpinner:!1,hubPivotErrorString:void 0})},function(t){e._setState({hubPivotErrorString:e._getErrorString(t),showHubSyncToggleSpinner:!1})})}};e.prototype._checkIfDefaultPermissionsChanged=function(e){var t=this;if(this._permissionLevelOfCurrentUser===f.FullControl||b.e.hasPermission(this._pageContext.webPermMasks,b.e.managePermissions)){var n=function(e,n){if(t._isGroup)return!1;for(var r=!1,i=!1,s=0,o=n[e.id];s<o.length;s++){var u=o[s],a=L[e.roleType];if(u.id===a)r=!0;else if(u.order<_[e.roleType]||u.order===M){i=!0;break}}return!r||i};return this._sitePermissionsProvider.getRoleAssignments().then(function(r){if(!r)return!1;t._hasCustomizedGroups=Object.keys(r).length>3;for(var i=0,s=e;i<s.length;i++){var o=s[i];if(n(o,r))return!0}return!1}).catch(function(e){return!1})}return m.n.wrap(!1)};e.prototype._getPersona=function(e,t){void 0===t&&(t=!1);var n=[];if(e.users)for(var r=0,i=e.users;r<i.length;r++){var s=i[r],o=this._isGroupLoginName(s.loginName);if("SHAREPOINT\\system"!==s.loginName){var u=this._permissionLevelOfCurrentUser;n.push({name:this._getUserTitle(s),email:s.email,imageUrl:s.urlImage,initialsColor:s.initialsColor,imageInitials:s.imageInitials,groupId:o&&this._parseGroupId(s.loginName),type:o&&2,menuItems:this._isGroupClaimOwner(s.loginName)||u!==f.FullControl&&(u!==f.Edit||N[s.roleType]!==f.Edit)?void 0:this._getUserPermissions(s,e,t)})}}else e.currentUserCannotViewMembers&&n.push({currentUserCannotViewMembers:!0});return n};e.prototype._getUserPermissions=function(e,t,n){var r=this;void 0===n&&(n=!1);var i=[];if(n&&this._pageContext.hubSiteId&&!this._pageContext.isHubSite)return null;if(!n)for(var s=function(t){t.onClick=function(){return r._updatePerm(e,t.permissionLevel)}},o=0,u=i=this._getSitePermissionsContextualMenuItems().filter(function(e){return e.permissionLevel!==N[t.roleType]});o<u.length;o++){s(u[o])}this._isGroupClaim(e.loginName)||i.push({name:E.e.remove,key:"remove",onClick:function(t){return r._removePerm(e)}});return i&&i.length>0?i:void 0};e.prototype._getSitePermissionsContextualMenuItems=function(){var e=this,t=[{name:E.e.read,key:"read",permissionLevel:f.Read},{name:E.e.fullControl,key:"full",permissionLevel:f.FullControl},{name:E.e.edit,key:"edit",permissionLevel:f.Edit}];this._permissionLevelOfCurrentUser===f.Edit?t=[t[2]]:this._permissionLevelOfCurrentUser===f.Read&&(t=[t[0]]);return t.filter(function(t){return e._permissionGroups[t.permissionLevel]})};e.prototype._updatePerm=function(e,t){var n=this,r=this._permissionGroups[t];this._sitePermissionsDataSource.addUserToGroup(r,e.loginName).then(function(){n._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){n._fetchUpdatedPermissions()})});g.e.logData({name:"SitePermissionsPanel.UpdatePermTo"+f[t]})};e.prototype._removePerm=function(e){var t=this;this._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){t._fetchUpdatedPermissions()})};e.prototype._getUserTitle=function(e){return this._isGroupClaim(e.loginName)?this._isGroupClaimOwner(e.loginName)?y.format(E.e.groupOwners,this._pageContext.webTitle):y.format(E.e.groupMembers,this._pageContext.webTitle):e.title};e.prototype._isGroupLoginName=function(e){return e&&-1!==e.indexOf("federateddirectoryclaimprovider")};e.prototype._isGroupClaim=function(e){return this._isGroupLoginName(e)&&-1!==e.indexOf(this._pageContext.groupId)};e.prototype._isGroupClaimOwner=function(e){return this._isGroupClaim(e)&&-1!==e.indexOf("_o")};e.prototype._parseGroupId=function(e){var t;if(this._isGroupClaim(e))t=this._pageContext.groupId;else if(this._isGroupLoginName(e)){var n=e.indexOf("federateddirectoryclaimprovider")+"federateddirectoryclaimprovider".length+1;t=e.substring(n,n+36)}return t};e.prototype._getPanelAddMenu=function(){var e=[];this._isGroup&&e.push({name:E.e.addMembersToGroup,key:"addToGroup",onClick:this._goToOutlookClick,className:"SitePermissionsPanel-addToGroup"});this._isDefaultPermissionsChanged||e.push({name:E.e.shareSiteOnly,key:"shareSiteOnly",onClick:this._shareSiteOnlyOnClick,className:"SitePermissionsPanel-shareSiteOnly"});return e.length>0?e:void 0};e.prototype._getPermissionLevelOfCurrentUser=function(){var e=this._pageContext.webPermMasks;return b.e.hasPermission(e,b.e.manageWeb)?f.FullControl:b.e.hasPermission(e,b.e.editListItems)?f.Edit:b.e.hasPermission(e,b.e.viewPages)?f.Read:void 0};e.prototype._assignUsersToPermssionGroup=function(e){for(var t,n=((t={})[f.FullControl]=[],t[f.Edit]=[],t[f.Read]=[],t),r=0,i=e;r<i.length;r++){var s=i[r],o=this._params.addMemberDefaultPermissionLevel,u=this._getSitePermissionsContextualMenuItems().map(function(e){return e.permissionLevel}),a=s.permissionLevel;a||(a=o&&this._permissionGroups[o]&&u.indexOf(o)>-1?o:this._permissionGroups[f.Edit]&&u.indexOf(f.Edit)>-1?f.Edit:this._permissionGroups[f.Read]&&u.indexOf(f.Read)>-1?f.Read:f.FullControl);n[a]&&n[a].push(s)}return n};e.prototype._getPickerSettings=function(){var e=this;return this._sharingSiteProvider.getSharingSettings().then(function(t){e._pickerSettings=t.pickerProperties}).catch(function(t){e._pickerSettings=void 0})};e.prototype._getErrorString=function(e){return e&&e.message?String(e.message.value||e.message):E.e.genericHubPivotError};e.prototype._getShareSiteErrorMsg=function(e){var t;return(null===(t=e)||void 0===t?void 0:t.errorMessage)?e.errorMessage:E.e.genericShareSiteError};return e})();t.t=B},"3020":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});var r=n(0),i=n("react-lib"),s={dependencies:n("prop-types-lib").object.isRequired};function o(e,t){var n=e,o={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return o};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},s);return t})(i.Component)}function u(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},"3427":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(2965),o=n(1394),u=n(969),a=n(1396),f=n(352),l=n(1929),c=n(3855),h=n(2340),p=n(2586),d=n(20),v=n(38),m=n(71);n.d(t,"e",function(){return g});var g=(function(e){Object(r.__extends)(t,e);function t(t){var n,r=e.call(this,t)||this;r._focusOnElement=function(){r._shouldRestoreFocusWhenExitMUIEditing&&r._defaultTextField&&r._defaultTextField.current.focus()};r._IsRequiredFields=function(e){return 0===e&&!r.props.defaultLanguageIsOptional};r._insertMetaData=function(e){var t=d.format(c.e.DefaultLanguageLabel,p.e.getResourceByCode(r._webLanguage)||"");return e.map(function(e){return{code:e.code,language:e.code===r._webLanguage?t:e.language||"",value:e.code===r.props.currentLCID?r.props.currentDisplay:e.value}})};r._onChange=function(e){return function(t,n){var i=r.state.translations.map(function(t,r){e===r&&(t.value=n||"");return t});r.props.textUpdateCallback&&r.props.textUpdateCallback(i);r.setState({translations:i,errorState:r._validateErrorState(i)})}};r._handleSaveClick=function(){r.props.onSaveClick&&r.props.onSaveClick(r.state.translations)};r._handleCancelClick=function(){r.props.onCancelClick&&r.props.onCancelClick()};r._validateErrorState=function(e){if(e&&0!==e.length&&(m.e.isActivated("3997930c-2770-4c54-8a47-7aea575aaf97","3/2/2021","Do not dispaly error message for required field")||r._IsRequiredFields(0))&&!r.props.multilineInput)return 0===e[0].value.trim().length?c.e.EnterDefaultLanguageErrorMessage:void 0};r._webLanguage=null===(n=r.props.pageContext)||void 0===n?void 0:n.webLanguage;var s=t.translations?r._insertMetaData(t.translations):void 0;r.state={errorState:s?r._validateErrorState(s):void 0,translations:s||void 0};r._defaultTextField=i.createRef();r._shouldRestoreFocusWhenExitMUIEditing=!m.e.isActivated("e3c98a95-86fb-4855-9d72-bb3d0f1aad65","2/16/2021","restore focus to link after existing MUI Editing");return r}t.prototype.componentDidMount=function(){var e=this;if(this.state.translations&&0!==this.state.translations.length)setTimeout(function(){e._focusOnElement()},50);else{var t=new l.t(this.props.pageContext);switch(this.props.dataSourceType){case l.e.ExistingNavNode:case l.e.SiteTitle:case l.e.SiteDescription:t.getTranslations(this.props.dataSourceType,this.props.navNodeId).then(function(t){e.setState({translations:e._insertMetaData(t)},function(){e._focusOnElement()})});break;case l.e.NewNavNode:t.getAllSupportedLanguages().then(function(t){e.setState({translations:e._insertMetaData(t)},function(){e._focusOnElement()})})}}};t.prototype.render=function(){var e=this;return this.state.translations?i.createElement("div",null,i.createElement("div",{className:Object(v.e)("ms-MultilingualInputs-Links",this.props.contentClassNames),"data-automationid":"MultilingualInputs-Inner"},this.state.translations.map(function(t,n){return i.createElement(s.e,{componentRef:0===n?e._defaultTextField:void 0,key:"MUIEditing_"+t.language,id:"MUIEditing_TextField_"+n,className:"ms-MultilingualInputs-Link",label:t.language,multiline:e.props.multilineInput,value:t.value,required:e._IsRequiredFields(n),"aria-required":e._IsRequiredFields(n),onChange:e._onChange(n),styles:{root:{marginRight:"6px"}},errorMessage:0===n&&e.state.errorState})})),i.createElement("div",{className:"ms-MultilingualInputs-ButtonArea"},i.createElement(o.e,{className:"ms-MultilingualInputs-SaveButton",onClick:this._handleSaveClick,disabled:!!this.state.errorState,"data-automationid":"MultilingualInputs-SaveTranslation"},h.e.CalloutOkButton),i.createElement(u.e,{className:"ms-MultilingualInputs-CancelButton",onClick:this._handleCancelClick,"data-automationid":"MultilingualInputs-CancelTranslation"},h.e.CancelButtonLabel))):i.createElement(a.e,{styles:{root:{marginTop:"50vh"}},ariaLabel:c.e.LoadingLabel,size:f.e.large})};return t})(i.Component)},"3863":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.center=0]="center";e[e.left=1]="left"})(r||(r={}))},"4472":function(e,t,n){"use strict";n.r(t);var r,i=n(650),s=n(0),o=n(3840),u=n("react-lib"),a=n(71),f=n(1398),l=n(290),c=n(86),h=n(38),p=n(470),d=n(835),v=n(456),m=n(115),g=n(1139),y=n(1236),b=n(600),w=n(150),E=n(346),S=n(418),x=n(1432),T=n(90),N=n(22),C=n(20),k=n(859),L=n(74),A=n(31),O=n(178),M=n(482),_=n(531),D=Object(E.e)();(function(e){e[e.KeyPress=0]="KeyPress";e[e.Hover=1]="Hover";e[e.Click=2]="Click"})(r||(r={}));var P;function H(e){return e.key+e.name+e.url}var B,j=(function(e){Object(s.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i._horizontalNavItemsRef={};i._boundItemClick={};i._boundMainItemHover={};i._renderShimmer=function(e,n){var r=e&&e.data;i._asyncFetch(r);return i._getDeferredShimmer({customElementsGroup:i._getOneLeveOndemandElements(),width:t.MENU_WIDTH})};i._getOneLeveOndemandElements=function(){var e={type:3,width:t.MENU_ITEM_SIDE_MARGIN,height:t.MENU_ITEM_HEIGHT};return i._getDeferredShimmerElementsGroup({flexWrap:!0,shimmerElements:[e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e,e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e]})};i._onOverflowClick=function(e){if(i.state.contextMenuItems||"overflow"===i.state.lastTriggeringItem){i._onNavMenuDismiss();i.setState({lastTriggeringItem:null})}else i.setState({contextMenuItems:i.state.overflowItems,contextMenuRef:e.currentTarget,lastTriggeringItem:"overflow"})};i._onEditClick=function(e){i.props.editLink.onClick(e);i._fixNavEditExperienceKSActivated()?i.setState({isEditMode:!1}):i.setState({isEditMode:!0})};i._onMouseLeave=function(){i._async.clearTimeout(i._navItemHoverTimerId)};i._closeMegaMenu=function(e){i._useMegaMenu&&0!==i.state.lastTriggeringAction&&i._onNavMenuDismiss()};i._onNavMenuDismiss=function(e){if(e&&e.relatedTarget&&i._horizontalNavRegion.contains(e.relatedTarget)){e.stopPropagation();e.preventDefault()}else i.setState({contextMenuItems:null})};i._instanceIdPrefix=Object(S.e)("HorizontalNav");a.e.isActivated("fcf17a35-9f5b-41a0-a61c-012617651178","2020-08-17","Fire post-message for sub-links for in-place nav")||(i._inPlaceNavEnabled=i.props.inplaceNavigationEnabled);i._getItemHoverMegaMenuCallback=Object(c.t)(function(e){return function(t){i._onMainItemHoverMegaMenu(e,t)}});i._getItemHoverCallback=Object(c.t)(function(e){return function(t){i._onMainItemHover(e,t)}});i._getItemClickCallback=Object(c.t)(function(e){return function(t){i._onItemClick(e,t)}});i._getKeyPressCallback=Object(c.t)(function(e){return function(t){i._handleKeyPress(e,t)}});i._getAnchorClickCallback=Object(c.t)(function(e){return function(t){i._onAnchorClick(e,t)}});if(i._isAudienceTargeted()){i.state=i._getStateFromProps(Object(s.__assign)(Object(s.__assign)({},i.props),{items:[]}));i._applyInitialAudienceTargeting()}else i.state=i._getStateFromProps(i.props);i._editLinkWidth=-1;i._resolvedElement=function(e){return function(t){return i._horizontalNavItemsRef[e]=t}};Object(w.t)();i._foundSelectedLink=!1;i._qosEvent=new L.e({name:"HorizontalNav"});return i}t._isHeader=function(e){return!e||e===k.t};t.prototype.componentDidMount=function(){if(!this._isAudienceTargeted()||(this.state.items||[]).length>0){this._updateItemMeasurements();this._updateRenderedItems()}this._events.on(window,"resize",this._updateRenderedItems);this.props.onRendered&&this.props.onRendered(!0);this._isMounted=!0;this._qosEvent.end({resultType:A.e.Success});this._events.on(window,t.SUBMENU_OPEN_EVENT,this._onNavMenuDismiss);this._events.on(document,"mouseleave",this._closeMegaMenu);var e=document.getElementById("SuiteNavWrapper");e&&this._events.on(e,"mouseenter",this._closeMegaMenu);if(!this._isMegaMenuTopPlaceholderKSActive()){var n=document.getElementById("spTopPlaceholder");n&&this._events.on(n,"mouseenter",this._closeMegaMenu)}};t.prototype.componentWillUnmount=function(){this._isMounted=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this._hasItemWidthChanged(this.props.items||[],e.items||[]),n=this._hasItemWidthChanged(this.props.overflowItems||[],e.overflowItems||[]);if(t){this._navItemWidths=void 0;this._navItemMargin=void 0}(t||n||!this._fixNavEditExperienceKSActivated()&&this.state.isEditMode&&this.state.isEditMode!==e.isEditMode||this.props.isEditMode!==e.isEditMode)&&this.setState(this._getStateFromProps(e))};t.prototype.componentDidUpdate=function(e,t){var n=this.state.overflowItems,r=t.overflowItems;if(!this._navItemWidths&&!this.state.isEditMode||!this._overflowStateChangedKSActive()&&n&&(!r||r.length!==n.length)||!this._fixNavEditExperienceKSActivated()&&t.isEditMode&&t.isEditMode!==this.state.isEditMode){this._updateItemMeasurements();this._updateRenderedItems()}this.props.onRendered&&this.props.onRendered(!1)};t.prototype.render=function(){var e=this,t=this.props,n=t.styles,r=void 0===n?this.props.getStyles:n,i=t.theme;this._classNames=D(r,{theme:i});var o=this.state,c=o.contextMenuItems,h=o.isEditMode,p=this._useMegaMenu&&"overflow"!==this.state.lastTriggeringItem;this._foundSelectedLink=!1;if(this._fixNavEditExperienceKSActivated()&&h)return u.createElement("div",null);var d=void 0;if(c){var v=Object(k.r)()?c:c.map(function(t){var n;return Object(s.__assign)(Object(s.__assign)({},t),{url:Object(k.i)(t.url,null===(n=e.props.pageContext)||void 0===n?void 0:n.webAbsoluteUrl)})});d=p?this._getDeferredMegaMenu(this._getMegaMenuProps(v)):u.createElement(x.e,{settings:{theme:Object(N._)()}},this._getDeferredContextualMenu(this._getContextualMenuProps(v)))}var m=this.props.skipRole?void 0:"navigation";return u.createElement("div",{className:this._classNames.root,onMouseLeave:!a.e.isActivated("14829911-0e8d-4963-864d-e5f8d0f35149","11/12/2019","Mega menu hover off close")&&"overflow"!==this.state.lastTriggeringItem&&this._useMegaMenu?this._closeMegaMenu:void 0,ref:this._resolveRef("_horizontalNavRegion"),role:m,"aria-label":this.props.ariaLabel},u.createElement(f.e,{direction:l.e.horizontal},u.createElement("div",{className:"ms-HorizontalNavItems",role:"menubar"},this._renderHorizontalNavItems(p&&d),this._renderOverflow(),this._renderEditLink())),!p&&c&&d)};t.prototype._asyncFetch=function(e){var t=this;if(!parent)return Promise.resolve();new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,depth:1,menuNodeKey:e}).then(function(n){a.e.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")&&!n||!n.links||t._UpdateRenderedItemsWithSubmenuItems(e,n.links)},function(){t._qosEvent.verbose("HorizontalNav: FetchGlobalNavFailed")})};Object.defineProperty(t.prototype,"_useMegaMenu",{get:function(){var e=!1;this.props.ignoreChromeOptions||void 0===this.props.chromeOptions?e=this.props.useMegaMenu:this.props.chromeOptions&&(e=this.props.chromeOptions.nav.megaMenuEnabled);return e},enumerable:!0,configurable:!0});t.prototype._getDeferredContextualMenu=function(e){var t={modulePath:"office-ui-fabric-react/lib/ContextualMenu",moduleLoader:{load:function(){return n.e("623").then(n.bind(null,324)).then(function(e){return e.ContextualMenu})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredMegaMenu=function(e){var t={modulePath:"../MegaMenu/MegaMenuCallout",moduleLoader:{load:function(){return n.e("603").then(n.bind(null,1898)).then(function(e){return e.MegaMenuCallout})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmer=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("536").then(n.bind(null,1324)).then(function(e){return e.Shimmer})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmerElementsGroup=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("536").then(n.bind(null,1324)).then(function(e){return e.ShimmerElementsGroup})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getContextualMenuProps=function(e){return{className:"ms-HorizontalNav",labelElementId:this._instanceIdPrefix+"overflow",items:this._getContextualItemProps(e),target:this.state.contextMenuRef,onDismiss:this._onNavMenuDismiss,gapSpace:10,isBeakVisible:!1,directionalHint:m.e.bottomLeftEdge,shouldFocusOnMount:!0}};t.prototype._getMegaMenuProps=function(e){var t=this;return{layoutProps:{maxColumnCount:4,showDivider:!0,gridSpacingFromEdge:8,enforceGridWidth:!0},onDismiss:this._onNavMenuDismiss,onItemClick:this._onNavMenuDismiss,target:this.state.contextMenuRef,shouldFocusOnMount:0===this.state.lastTriggeringAction,pageContext:this.props.pageContext,theme:Object(N._)(),sections:e.map(function(e){return{heading:{name:e.name,url:e.url,target:e.target,onClick:e.onClick},items:e.links&&t._getContextualItemProps(e.links),theme:Object(N._)()}}),navigationSource:this.props.navigationSource}};t.prototype.measureLayout=function(){this._updateItemMeasurements();this._updateRenderedItems()};t.prototype._getContextualItemProps=function(e,n){var r=this;void 0===n&&(n=0);return e.filter(function(e){return!!e&&"1033"!==e.key}).map(function(e){var i,s=F(e),o=(function(e){return!!e&&e.hasChildLinks})(e),u=[];o&&u.push({key:"shimmerItem",text:"shimmer",data:e.key,onRender:r._renderShimmer});var a=g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",f=e.onClick?function(t){e.onClick(t,e);if(!r._isLinkPropagateKSActive())return!0}:function(e){if(!r._isLinkPropagateKSActive())return!0};i={key:H(e),name:e.name,split:s||o,target:a,href:s||o||t._isHeader(e.url)?void 0:e.url,onClick:f,subMenuProps:s?{items:r._getContextualItemProps(e.links,n+1)}:o?{items:u}:void 0};!s&&!o||t._isHeader(e.url)||(i.onClick=function(){if(r._inPlaceNavEnabled)window.postMessage("router://"+e.url,window.location.origin);else{window.open(e.url,a);e.forceAnchor&&e.onClick&&e.onClick()}});return i})};t.prototype._renderHorizontalNavItems=function(e){var t=this,n=this.state.renderedItems;if(n&&0!==n.length)return n.map(function(n){var r,i,o=Object(k.r)()?n:Object(s.__assign)(Object(s.__assign)({},n),{url:Object(k.i)(n.url,null===(r=t.props.pageContext)||void 0===r?void 0:r.webAbsoluteUrl)}),f=H(n),l=t._useMegaMenu?t._getItemHoverMegaMenuCallback(n):t._boundMainItemHover[f]||t._getItemHoverCallback(n),c=t._useMegaMenu?t._onNavMenuDismiss:t._onMouseLeave,p=C.format(t.props.splitButtonAriaLabel,n.name);a.e.isActivated("70ce4e23-8db2-4c57-840b-639317332050","7/23/20","compute Selected link includes its children")?i=!!t.props.hasSelectedState&&t._isLinkSelected(o):(i=!!t.props.hasSelectedState&&(!t._foundSelectedLink&&t._isLinkSelected(o)))&&(t._foundSelectedLink=!0);return u.createElement("span",{className:"ms-HorizontalNavItem","data-automationid":"HorizontalNav-link",key:f,ref:t._resolvedElement(f),onMouseEnter:t._isItemHoverEventKSActive()?void 0:l,onMouseLeave:t._isItemHoverEventKSActive()?void 0:c},t._shouldRenderAsAnchor(o)?t._renderAnchorLink(o,f,l,c,i):t._renderButtonLink(o,f,l,c,i),F(o)?u.createElement("button",{className:Object(h.e)("ms-HorizontalNavItem-splitbutton",t._classNames.splitButton,{"ms-HorizontalNavItem-splitbutton-width":!t._chevronSpacingHardcodedKSActive()}),onClick:t._getItemClickCallback(o),onMouseEnter:t._isItemHoverEventKSActive()?l:void 0,onMouseLeave:t._isItemHoverEventKSActive()?t._onMouseLeave:void 0,"aria-label":p,"aria-expanded":!!t.state.contextMenuItems,onKeyDown:t._getKeyPressCallback(o),role:"menuitem"},u.createElement(b.e,{iconName:"ChevronDownMed",className:Object(h.e)("ms-HorizontalNav-chevronDown",t._classNames.chevron)})):null,t.state.contextMenuItems===n.links&&e)})};t.prototype._renderAnchorLink=function(e,t,n,r,i){return u.createElement("a",{className:Object(h.e)("ms-HorizontalNavItem-link",{"is-selected":i},{"is-not-selected":!i},this._classNames.link,i?this._classNames.linkSelected:this._classNames.linkUnselected),href:e.url,"aria-label":e.ariaLabel,onMouseEnter:this._isItemHoverEventKSActive()?n:void 0,onMouseLeave:this._isItemHoverEventKSActive()?r:void 0,onKeyDown:this._getKeyPressCallback(e),onClick:e.onClick?this._boundItemClick[t]:void 0,role:"menuitem",target:g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",rel:"noopener","aria-current":i?"page":void 0,"data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._shouldRenderAsAnchor=function(e){return(e.forceAnchor||void 0===e.forceAnchor)&&!t._isHeader(e.url)};t.prototype._renderButtonLink=function(e,n,r,i,s){var o=t._isHeader(e.url);return u.createElement("button",{className:Object(h.e)("ms-HorizontalNavItem-link",{"is-selected":s},{"is-header":o},this._classNames.link,s?this._classNames.linkSelected:this._classNames.linkUnselected),"aria-label":e.ariaLabel,onClick:this._boundItemClick[n]||this._getItemClickCallback(e),onMouseEnter:this._isItemHoverEventKSActive()?r:void 0,onMouseLeave:this._isItemHoverEventKSActive()?i:void 0,onKeyDown:this._getKeyPressCallback(e),"aria-haspopup":F(e),disabled:o,"aria-current":"page",role:"menuitem","data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._renderOverflow=function(){var e=this.state,t=e.overflowItems,n=e.lastTriggeringItem,r=this.props.moreOptionsAriaLabel||_.e.moreOptionsAriaLabel;return t&&t.length?u.createElement("div",{className:"ms-HorizontalNavItem",key:"overflow",ref:this._resolveRef("_overflowElementRef"),"data-automationid":"HorizontalNav-overflow"},u.createElement("button",{id:this._instanceIdPrefix+"overflow","aria-label":r,className:Object(h.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.overflowButton),onClick:this._onOverflowClick,"aria-haspopup":!0,"aria-expanded":"overflow"===n,onKeyDown:this._getKeyPressCallback("overflow"),role:"menuitem"},u.createElement(b.e,{iconName:"More",className:"ms-HorizontalNavItem-overflow"}))):null};t.prototype._renderEditLink=function(){var e=this.props,t=e.editLink,n=e.isEditMode,r="portals"===window.teamsCustomAppType;return!t||n||r?null:u.createElement("div",{className:"ms-HorizontalNavItem",ref:this._resolveRef("_editLinkElementRef"),"data-automationid":"HorizontalNav-edit"},u.createElement("button",{id:this._instanceIdPrefix+"EditLink",className:Object(h.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.editButton),onClick:this._onEditClick,"aria-label":t.ariaLabel?t.ariaLabel:t.name},t.name))};t.prototype._updateItemMeasurements=function(){this._currentOverflowWidth=this._overflowElementRef||this.props.overflowItems&&this.props.overflowItems.length?32.67:0;-1===this._editLinkWidth&&this.props.editLink&&this._editLinkElementRef&&(this._editLinkWidth=this._getElementWidth(this._editLinkElementRef,this._getElementMargin(this._editLinkElementRef)));this._navItemWidths||(this._navItemWidths={});for(var e=0,t=this.state.items;e<t.length;e++){var n=H(t[e]),r=this._horizontalNavItemsRef[n];void 0===this._navItemMargin&&(this._navItemMargin=this._getElementMargin(r));this._navItemWidths[n]||(this._navItemWidths[n]=this._getElementWidth(r,this._navItemMargin))}};t.prototype._getElementWidth=function(e,t){return e?e.getBoundingClientRect().width+t:0};t.prototype._getElementMargin=function(e){return parseInt(Object(p.e)()?window.getComputedStyle(e).marginLeft:window.getComputedStyle(e).marginRight,10)};t.prototype._updateRenderedItems=function(){this._horizontalNavRegion&&this._UpdateRenderedItemsCore(this.state.items)};t.prototype._UpdateRenderedItemsCore=function(e){for(var t=Object(s.__spreadArrays)(e),n=this._horizontalNavRegion.clientWidth-this._currentOverflowWidth-this._editLinkWidth,r=this.props.overflowItems||[],i=0,o=!1,u=0;u<t.length;u++){var a=H(t[u]),f=this._navItemWidths[a];if(i+f>=n){u>0&&0===r.length&&n-i<32.67&&u--;r=t.splice(u).concat(r);o=!0;break}i+=f}!o&&this.state.overflowItems.length>0&&(o=!0);o&&this.setState({renderedItems:t,overflowItems:r})};t.prototype._UpdateRenderedItemsWithSubmenuItems=function(e,t){var n=this.state.items;this._InsertItemsWithSubmenuItems(n,e,t);this._UpdateRenderedItemsCore(n)};t.prototype._InsertItemsWithSubmenuItems=function(e,t,n){if(!e||!parent||!n)return!1;for(var r=!1,i=0;i<e.length;i++){if(e[i].key===t){e[i].links=n;r=!0;break}if(e[i].links&&e[i].links.length>0&&this._InsertItemsWithSubmenuItems(e[i].links,t,n)){r=!0;break}}return r};t.prototype._onAnchorClick=function(e,t){this._foundSelectedLink=!1;e.onClick&&e.onClick(t,e)};t.prototype._onItemClick=function(e,n){this._foundSelectedLink=!1;this._navItemHoverTimerId&&this._async.clearTimeout(this._navItemHoverTimerId);n.stopPropagation();n.preventDefault();if(this.state.contextMenuItems||this.state.lastTriggeringItem===e){this.setState({lastTriggeringItem:null});this._onNavMenuDismiss()}else"I"!==n.target.tagName?e.onClick?e.onClick(n,e):t._isHeader(e.url)||window.open(e.url,g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank"):this._openSubMenu(e.links,n.currentTarget,e,2)};t.prototype._onMainItemHover=function(e,n){var r=this;t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();var i=n.currentTarget;F(e)&&(this._navItemHoverTimerId=this._async.setTimeout(function(){if(r.state.contextMenuItems!==e.links){r.state.contextMenuItems&&r._onNavMenuDismiss();r._openSubMenu(e.links,i,e,1)}},500))};t.prototype._onMainItemHoverMegaMenu=function(e,n){t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();if(F(e)&&this.state.contextMenuItems!==e.links){this.state.contextMenuItems&&this._onNavMenuDismiss();this._openSubMenu(e.links,n.currentTarget,e,1)}else F(e)||this._onNavMenuDismiss()};t.prototype._handleKeyPress=function(e,t){if(32===t.which||40===t.which||13===t.which&&t.target&&-1!==t.target.className.indexOf("ms-HorizontalNavItem-splitbutton")){t.stopPropagation();t.preventDefault();"overflow"===e?this._openSubMenu(this.state.overflowItems,t.target,e,0):this._openSubMenu(e.links,t.target,e,0)}};t.prototype._openSubMenu=function(e,n,r,i){T.e.raise(window,t.SUBMENU_OPEN_EVENT);if(-1!==n.className.indexOf("ms-HorizontalNavItem-splitbutton")||"i"===n.tagName&&"overflow"!==r){for(var s=n;s&&"span"!==s.tagName.toLowerCase();)s=s.parentElement;s&&s.children&&s.children.length>0&&(n=s.children[0])}this.setState({lastTriggeringItem:r,contextMenuItems:e,contextMenuRef:n,lastTriggeringAction:i})};t.prototype._isAudienceTargeted=function(){if(!this.props||!this.props.pageContext)return!1;var e=new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider");return this.props.pageContext&&this.props.isAudienceTargeted&&e.isNavAudienceTargetedEnabled()};t.prototype._applyInitialAudienceTargeting=function(){var e=this;y.e.getInstance(this.props.pageContext).getCurrentUserMemberships("SiteNav").then(function(t){e._audienceMemberships=t;if(a.e.isActivated("0123f94e-245a-4fca-a866-b5ebd969abe9","2020-08-06","Refine audience targeting logging for header nav"))e._isMounted?e.setState(e._getStateFromProps(e.props)):e.state=e._getStateFromProps(e.props);else{var n=e._getStateFromProps(e.props);e._isMounted?e.setState(n):e.state=n;O.e.logData({name:"SiteNav.Render",extraData:{audienceTargetingEnabled:!0,audienceTargetingProvided:y.e.containsAudienceTargetedNode(e.props.items),audienceTargetingAffected:g.e.checkIfLinksAffected(e.props.items,n.items)}})}}).catch(function(){e.setState(e._getStateFromProps(e.props))})};t.prototype._getStateFromProps=function(e){var t=e.overflowItems,n=e.isEditMode,r=this._isAudienceTargeted()?y.e.filterLinksWithMemberships(e.items,this._audienceMemberships):e.items;this._boundItemClick={};this._boundMainItemHover={};for(var i=0,s=r=r||[];i<s.length;i++){var o=s[i],u=H(o);this._boundItemClick[u]=this._shouldRenderAsAnchor(o)?this._getAnchorClickCallback(o):this._getItemClickCallback(o);this._boundMainItemHover[u]=this._getItemHoverCallback(o)}return{renderedItems:r,overflowItems:t||[],contextMenuItems:null,isEditMode:n,selectedKey:void 0,items:r}};t.prototype._isLinkSelected=function(e){if(a.e.isActivated("70ce4e23-8db2-4c57-840b-639317332050","7/23/20","compute Selected link includes its children")){if(void 0!==this.props.selectedKey)return e.key===this.props.selectedKey;if(void 0!==this.state.selectedKey&&e.key===this.state.selectedKey)return!0;if("undefined"==typeof window)return!1;if(t._isHeader(e.url))return!1;(P=P||document.createElement("a")).href=e.url||"";var n=I()?P.href:P.href.toLowerCase(),r=I()?n+"/SitePages/Home.aspx":(n+"/SitePages/Home.aspx").toLowerCase(),i=I()?location.href:location.href.toLowerCase();if(i===n||i===r)return!0;var s=I()?location.protocol+"//"+location.host+location.pathname:(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(s===n||s===r)return!0;if(location.hash){if(location.hash===e.url)return!0;P.href=location.hash.substring(1);return P.href===n}return!1}B=this.props.selectedKey||this.state.selectedKey;return R(e)};t.prototype._isCompareNestedLinksKSActivated=function(){return a.e.isActivated("1df78d95-7807-4ad1-8af8-9bb521fe1d3d","11/23/2020","Compare nested horizontal nav links")};t.prototype._hasItemWidthChanged=function(e,t){var n=this;return e.length!==t.length||e.map(function(e,r){var i=t[r];if(n._isCompareNestedLinksKSActivated())return e.name!==i.name||1==((e.links||[]).length^(i.links||[]).length);if(e.name!==i.name)return!0;if(e.links||i.links){if((e.links||[]).length!==(i.links||[]).length)return!0;for(var s=0;s<e.links.length;s++)if(e.links[s].name!==i.links[s].name)return!0;return!1}return!1}).reduce(function(e,t){return e||t},!1)};t.prototype._fixNavEditExperienceKSActivated=function(){return a.e.isActivated("30b9a746-134f-4465-8f2c-f38c2440159a","03/02/2020","fix nav edit experience")};t.prototype._chevronSpacingHardcodedKSActive=function(){return a.e.isActivated("9ab54c9f-d74c-4739-82ad-0cc1696009e5","4/10/2020","hardcode the widths of horizontalNav chevron icons")};t.prototype._overflowStateChangedKSActive=function(){return a.e.isActivated("34034F80-F8DD-4FB2-99B2-A2931D4FC65F","4/22/2020","update item measurements when horizontal nav overflow changes")};t.prototype._isLinkPropagateKSActive=function(){return a.e.isActivated("ce44885f-f77b-48b2-8391-af0256fb0a0f","8/12/2020","allow link propagation for ContextualMenu links")};t.prototype._isMegaMenuTopPlaceholderKSActive=function(){return a.e.isActivated("575f60b2-1ef4-4ce7-8494-b4bfdf0390b9","3/24/2021","close the MegaMenu when mousing over the top placeholder for custom extensions")};t.prototype._isItemHoverEventKSActive=function(){return a.e.isActivated("0c944fd9-6c07-458b-98f2-6b96472433e5","2/16/2021","move mega menu and cascading menu event handlers to a different DOM node")};t.SUBMENU_OPEN_EVENT="submenu_open";t.MENU_WIDTH=200;t.MENU_ITEM_SIDE_MARGIN=8;t.MENU_ITEM_HEIGHT=32;return t})(d.e);function F(e){return!!(e&&e.links&&e.links.length)}function I(){return a.e.isActivated("8a8d92e8-6c30-46d8-aa0b-7c6e761cc1ee","5/1/2020","make the selected url logic case insensitive")}function q(e){return e.key===B||!!F(e)&&e.links.some(q)}function R(e){if(void 0!==B)return q(e);if("undefined"==typeof window)return!1;if(j._isHeader(e.url))return!!F(e)&&e.links.some(R);(P=P||document.createElement("a")).href=e.url||"";var t=I()?P.href:P.href.toLowerCase(),n=I()?t+"/SitePages/Home.aspx":(t+"/SitePages/Home.aspx").toLowerCase(),r=I()?location.href:location.href.toLowerCase();if(r===t||r===n)return!0;var i=I()?location.protocol+"//"+location.host+location.pathname:(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(i===t||i===n)return!0;if(location.hash){if(location.hash===e.url)return!0;P.href=location.hash.substring(1);if(P.href===t)return!0}return!!F(e)&&e.links.some(R)}n.d(t,"HorizontalNav",function(){return U});var U=Object(i.e)(j,function(e){var t=e.theme,n=t.palette,r=t.semanticColors;return{root:"ms-HorizontalNav",link:[Object(s.__assign)(Object(s.__assign)({color:r.bodySubtext},t.fonts.small),{selectors:{":hover":{color:n.themePrimary},"&.is-header":{cursor:"auto",color:r.bodySubtext}}})],linkUnselected:{border:"none"},linkSelected:Object(s.__assign)({color:r.bodyText,borderBottom:"2px solid "+n.themePrimary},Object(o.e)(t).semibold),splitButton:{selectors:{":hover":{color:n.themePrimary}}},chevron:{color:r.bodySubtext},editButton:["ms-HorizontalNavItem-Edit",{border:"none",color:n.themePrimary,selectors:{":hover":{color:n.themeDarker,textDecoration:"underline"}}}],overflowButton:{border:"none"}}})},"4569":function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(980),o=n(624),u=n(600),a=n(113),f=n(683),l=n(1398),c=n(290),h=n(111),p=n(38),d=n(3863),v=n(4232),m=n(71),g=n(3857),y=n.n(g),b=n(3862);n.d(t,"e",function(){return S});var w={x:50,y:50},E={image:{height:64,background:"linear-gradient(45deg, #d2d0ce 25%, transparent 25%, transparent 75%, #d2d0ce 75%, #d2d0ce 0), linear-gradient(45deg, #d2d0ce 25%, transparent 25%, transparent 75%, #d2d0ce 75%, #d2d0ce 0), white",backgroundPosition:"0px 0, 5px 5px",transformOrigin:"0 0 0",backgroundSize:"10px 10px, 10px 10px"}},S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._fileBrowser=Object(i.createRef)();n._defaultFocusButton=Object(i.createRef)();n._onChangeClick=function(){n.props.onChangeClick&&n.props.onChangeClick();var e=n._fileBrowser.current;e&&e.click()};n._onImageChange=function(e){var t=e.target,r=t&&t.files&&t.files[0];r&&v.e.readFile(r).then(function(e){n.setState({newPreviewSrc:e,fileToUpload:r,removeImage:!1,isError:!1,isLoaded:!0});n.props.onImageChanged&&n.props.onImageChanged(e,r)})};n._onRemoveClick=function(){n.props.onRemoveClick&&n.props.onRemoveClick();n.setState({newPreviewSrc:void 0,fileToUpload:void 0,removeImage:!0,isError:!1,isLoaded:!1});n.props.onImageChanged&&n.props.onImageChanged(void 0,void 0)};n._onFocalPointDrag=function(e,t){if(n.props.onFocalPointMove){var r={x:n._pixelToPercentage(t.x,n.imageWidth),y:n._pixelToPercentage(t.y,n.imageHeight)};n.setState({focalPoint:r});n.props.onFocalPointMove(r)}};n._onHandleKeyDown=function(e){if(n.props.onFocalPointMove){e.stopPropagation();e.preventDefault();var t=n.state.focalPoint;if(n._isKey(h.e.enter,e)){n.props.onFocalPointMove(t);n._defaultFocusButton&&n._defaultFocusButton.current.focus();return}n._isKey(h.e.escape,e)?t.x=t.y=50:n._isKey(h.e.left,e)?t.x--:n._isKey(h.e.up,e)?t.y--:n._isKey(h.e.right,e)?t.x++:n._isKey(h.e.down,e)&&t.y++;n._ensureFocalPointInBound(t);n.setState({focalPoint:t})}};n._ensureFocalPointInBound=function(e){var t=n._percentageToPixel(e.x,n.imageWidth),r=n._percentageToPixel(e.y,n.imageHeight);t<0?t=0:t>n.imageWidth-52&&(t=n.imageWidth-52);r<0?r=0:r>n.imageHeight-52&&(r=n.imageHeight-52);e.x=n._pixelToPercentage(t,n.imageWidth);e.y=n._pixelToPercentage(r,n.imageHeight)};n._percentageToPixel=function(e,t){return(e||50)/100*t-26};n._pixelToPercentage=function(e,t){return(e+26)/t*100};n._onLoadingStateChange=function(e){e===a.n.error?n.setState({isError:!0,isLoaded:!1}):e===a.n.loaded?n.setState({isLoaded:!0,isError:!1}):n.setState({isLoaded:!1,isError:!1})};n.state={focalPoint:t.initialFocalPoint||w};n.imageHeight="imageHeight"in t?t.imageHeight:64;n.imageWidth="imageWidth"in t?t.imageWidth:64;n.imageFit="imageFit"in t?t.imageFit:a.t.contain;return n}t.prototype.render=function(){var e,t,n,r,a=this.props,h=this.state,v=a.initialPreviewUrl,g=a.disableRemove,w=!1,S=!this.state.isError&&this.state.isLoaded;if(h.newPreviewSrc){n=h.newPreviewSrc;r=!g}else if(v&&!this.state.removeImage){n=v;r=!g}else{n=a.emptyImageUrl||"";r=!1;w=a.useUploadWithEmptyImage}if(!m.e.isActivated("f1e042ab-231e-4018-a97f-1df3356f39ca","06/24/2020","Refine image browser control")){w=!this.state.isLoaded;r=this.state.isLoaded&&!g}return i.createElement(l.e,{direction:c.e.bidirectional,defaultTabbableElement:".ms-ImageBrowser-change"},i.createElement("div",{className:"ms-ImageBrowser"},i.createElement("div",{className:Object(p.e)("ms-ImageBrowser-imageContainer",S?"":"ms-ImageBrowser-defaultBackground"),style:{width:this.imageWidth,height:this.imageHeight}},this.props.isFocalPointEnabled&&S&&i.createElement(y.a,{bounds:"parent",onDrag:this.debounce(this._onFocalPointDrag,250),defaultPosition:{x:this._percentageToPixel(50,this.imageWidth),y:this._percentageToPixel(50,this.imageHeight)},position:{x:this._percentageToPixel(null===(e=this.state.focalPoint)||void 0===e?void 0:e.x,this.imageWidth),y:this._percentageToPixel(null===(t=this.state.focalPoint)||void 0===t?void 0:t.y,this.imageHeight)}},i.createElement("div",{"aria-roledescription":b.e.focalPointAriaRoleDescription,"aria-label":b.e.focalPointAriaLabel,className:"ms-ImageBrowser-focalCircle",onKeyDown:this._onHandleKeyDown,"data-is-focusable":"true"},i.createElement(o.e,{iconName:"SIPMove",className:"ms-ImageBrowser-focalIcon"}))),i.createElement(f.Image,{className:Object(p.e)("ms-ImageBrowser-image",this.props.imageAlignment===d.e.left?"ms-ImageBrowser-leftAlignment":""),width:this.imageWidth,height:this.imageHeight,imageFit:this.imageFit,src:n,alt:a.imageAlt||"",onLoadingStateChange:this._onLoadingStateChange,styles:!m.e.isActivated("09186f6d-1c9c-4d7d-80e8-5dbd70c63e66","11/03/2020","Support checkers for white/transparent images")&&this.state.isLoaded&&E}),!S&&i.createElement(u.e,{iconName:"Photo2",className:"ms-ImageBrowser-PlaceHolder",style:{top:this.imageHeight/2-12,left:this.imageWidth/2-12}})),i.createElement("div",{className:"ms-ImageBrowser-actionBar"},i.createElement(s.e,{componentRef:this._defaultFocusButton,className:"ms-ImageBrowser-change",onClick:this._onChangeClick,iconProps:{iconName:w?"Upload":"EditPhoto"},ariaLabel:a.changeButtonAriaLabel||(w?b.e.uploadAriaLabel:b.e.changeAriaLabel)},w?b.e.uploadLabel:b.e.changeLabel),r&&i.createElement(s.e,{className:"ms-ImageBrowser-remove",onClick:this._onRemoveClick,iconProps:{iconName:"Delete"},ariaLabel:a.removeButtonAriaLabel||b.e.removeAriaLabel},b.e.removeLabel)),i.createElement("input",{ref:this._fileBrowser,style:{display:"none"},type:"file",accept:(a.supportedImageTypes||["image/*"]).join(","),onChange:this._onImageChange,tabIndex:-1,multiple:!1})))};t.prototype.getImageFile=function(){return this.state.removeImage?null:this.state.fileToUpload};t.prototype._isKey=function(e,t){return t.keyCode===e&&!t.altKey&&!t.ctrlKey&&!t.shiftKey};t.prototype.debounce=function(e,t,n){void 0===n&&(n=!1);var r;return function(){var i=this,s=arguments,o=function(){r=null;n||e.apply(i,s)},u=n&&!r;clearTimeout(r);r=setTimeout(o,t);u&&e.apply(i,s)}};return t})(i.Component)}}]);