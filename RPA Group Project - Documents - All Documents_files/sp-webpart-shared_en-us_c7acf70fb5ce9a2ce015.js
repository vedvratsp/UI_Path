define("914330ee-2df2-4f6e-a858-30c23a812408_1.15.105",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-image-helper","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-deferred-component","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,r,a,n,i,o,s,c,l,d,h,u,p,f,_,m,g,b){return function(e){function t(t){for(var r,n,i=t[0],o=t[1],s=0,c=[];s<i.length;s++)n=i[s],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&c.push(a[n][0]),a[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(l&&l(t);c.length;)c.shift()()}var r={},a={4:0};function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(t){for(var r=[],o=function(e){return{2:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}],0:[{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.1.57",m:"K9kD"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){r.push(i.SPComponentLoader.loadComponentById(t.i,t.v).then(function(r){e[t.m]=function(e){e.exports=r}}))}(o[s]);var c=a[t];if(0!==c)if(c)r.push(c[2]);else{var l=new Promise(function(e,r){c=a[t]=[e,r]});r.push(c[2]=l);var d,h=document.createElement("script");h.charset="utf-8",h.timeout=120,n.nc&&h.setAttribute("nonce",n.nc),h.src=function(e){return n.p+"chunk."+({0:"live-persona-card-loader",1:"sp-caption-element-edit",2:"sp-edit-utilities",3:"sp-fabric-teaching-bubble",5:"vendors~live-persona-card-loader"}[e]||e)+"_"+(["en-us","none"])[{"0":0,"1":0,"2":1,"3":1,"5":1}[e]]+"_"+{0:"0e990ae1b2d25494465a",1:"a2d566087da29e3b7487",2:"3d24562449eaa60d489b",3:"ceb150fb20b5bbd89c34",5:"9c2cac85863e3b123036"}[e]+".js"}(t);var u=new Error;d=function(e){h.onerror=h.onload=null,clearTimeout(p);var r=a[t];if(0!==r){if(r){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",u.name="ChunkLoadError",u.type=n,u.request=i,r[1](u)}a[t]=void 0}};var p=setTimeout(function(){d({type:"timeout",target:h})},12e4);h.onerror=h.onload=d,document.head.appendChild(h)}return Promise.all(r)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var i=n("I6O9");n.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_914330ee_2df2_4f6e_a858_30c23a812408_1_15_105=window.webpackJsonp_914330ee_2df2_4f6e_a858_30c23a812408_1_15_105||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=s;return function(){var e,t=document.getElementsByTagName("script"),r="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-webpart-shared_en-us_c7acf70fb5ce9a2ce015\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var i=t[a].getAttribute("src");if(i&&i.match(r)){e=i.substring(0,i.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(r)){e=o.substring(0,o.lastIndexOf("/")+1);break}n.p=e}(),n(n.s="mwqp")}({"0l0e":function(e){e.exports=JSON.parse('{"c":"Opens Profile Card for {0}","a":"Opens Profile Card","b":"Getting detailsâ€¦"}')},"17wl":function(t,r){t.exports=e},"2q6Q":function(e,r){e.exports=t},"7Awa":function(e,t){e.exports=r},"8dK2":function(e,t){e.exports=a},Ar4x:function(e,t,r){"use strict";r.d(t,"b",function(){return _}),r.d(t,"a",function(){return m});var a=r("17wl"),n=r("cDcd"),i=r("KL1q"),o=r("ut3N"),s=r("Pk8u"),c=r("2q6Q"),l=r("edZz"),d=n.lazy(function(){return r.e(1).then(r.bind(null,"Emhs")).then(function(e){return{default:e.default}})});function h(e){return n.createElement(n.Suspense,{fallback:!1},n.createElement(d,Object(a.__assign)({},e)))}var u=r("vpvl"),p=r("pDlU"),f=r("aKQJ"),_={Caption:1,Title:2},m={PageDirection:1,Center:2},g=function(e){function t(t){var r=e.call(this,t)||this;return r.focusOnCaptionElement=function(){var e;null===(e=r._textarea)||void 0===e||e.focus()},r._handleReceiveRef=function(e){Object(f.a)()||(r._textarea=e)},r._handleClick=function(e){Object(f.a)()||(e.stopPropagation(),r.focusOnCaptionElement())},r._handleChange=function(e){var t=e.target.value;r.setState({text:t},function(){r.props.onChange&&r.props.onChange(t,e)})},r._handleFocus=function(){r.props.moduleName&&r.props.isEditMode&&(r._initialValue=r.state.text)},r._handleBlur=function(){if(r.props.moduleName&&r.props.isEditMode){var e=void 0,t=r.state.text;r._initialValue!==t&&(e=0===t.length?"Clear":0===r._initialValue.length?"Add":"Edit",c._EngagementLogger.logEventWithLogEntry(new o._LogEntry(r.props.moduleName,"CaptionElement",o._LogType.Event,{action:e,length:t.length.toString()})))}},r.state={text:t.text},r}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({text:e.text})},t.prototype.render=function(){var e,t,r,o,s,c,d,h,f=Object(i.css)(((e={})[u.a.captionElement__NoMargin]=!this.props.marginBottomSize||"None"===this.props.marginBottomSize,e),((t={})[u.a.captionElement__MiddleMargin]="Middle"===this.props.marginBottomSize,t),((r={})[u.a.captionElement__LargeMargin]="Large"===this.props.marginBottomSize,r)),g=Object(l.a)("WebPartChrome")?Object(i.mergeStyles)(this.props.type===_.Caption&&u.a.captionElement__caption,this.props.type===_.Title&&u.a.captionElement__title,u.a.fluent,this.props.type===_.Title&&(h={theme:Object(i.getTheme)()},{title:Object(a.__assign)({},h.theme.fonts.xLarge)}).title):Object(i.css)(((o={})[u.a.captionElement__caption]=this.props.type===_.Caption,o),((s={})[u.a.captionElement__title]=this.props.type===_.Title,s)),b=Object(i.css)(((c={})[u.a.captionElement__leftAlign]=this.props.alignPosition===m.PageDirection,c),((d={})[u.a.captionElement__centerAlign]=this.props.alignPosition===m.Center,d)),y=u.a.titleBreakInLines,v=Object(i.css)(f,g,b,y,this.props.className),P=this.props.isEditMode&&(p.a.topicPageTitleNotEditableEditMode.isActivated()||!1!==this.props.isTitleEditable)?this._renderEditMode:this._renderViewMode;return this.props.useFigCaptionTag?n.createElement("figcaption",{className:v,"data-automation-id":"captionElement"},P):n.createElement("div",{className:v,"data-automation-id":"captionElement"},P)},t.prototype.value=function(){return this.state.text},Object.defineProperty(t.prototype,"_renderEditMode",{get:function(){return n.createElement(h,{handleChange:this._handleChange,placeholder:this.props.placeholder,text:this.state.text,handleFocus:this._handleFocus,handleBlur:this._handleBlur,handleClick:this._handleClick,receiveElement:this._handleReceiveRef,type:_.Title})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_renderViewMode",{get:function(){var e=this.props.headingLevel;return n.createElement("span",{role:e&&"heading","aria-level":e},this.state.text)},enumerable:!1,configurable:!0}),t.defaultProps={isEditMode:!1,text:void 0,onChange:s.noop,placeholder:void 0,type:_.Caption,alignPosition:m.Center},t}(i.BaseComponent);t.c=g},EpOV:function(e){e.exports=JSON.parse('{"a":"Month"}')},GrTz:function(e){e.exports=JSON.parse('{"a":"{0} at {1}"}')},I6O9:function(e,t){e.exports=n},IBxL:function(e){e.exports=JSON.parse('{"a":"The page context is not provided by the host environment.","d":"The page context does not provide a web instance.","e":"The page context does not provide a web identifier.","b":"The page context does not provide a site instance.","c":"The page context does not provide a site identifier.","f":"A data source is required.","i":"Title","h":"We didn\\u0027t find anything to show here.","g":"A layout is required."}')},KL1q:function(e,t){e.exports=i},Pk8u:function(e,t){e.exports=o},UWqr:function(e,t){e.exports=s},WTsn:function(e){e.exports=JSON.parse('{"a":"Page {0}","c":"Previous","b":"Next","d":"Go to the {0} page, you are currently on page {1}.","e":"Go to the {0} page."}')},"X+PM":function(e,t){e.exports=c},Ycni:function(e,t){e.exports=l},aKQJ:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var a=r("UWqr");function n(){return a._SPKillSwitch.isActivated("587cc554-4692-4233-be0e-83f353afa3bd")}},br4S:function(e,t){e.exports=d},cDcd:function(e,t){e.exports=h},edZz:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var a=r("UWqr"),n=r("hiL/"),i=new Map([["BingPreviewLayout",new n.KillSwitch("6b97fd96-8919-4573-b4a1-39c3c8eeb85c")],["CardLayout",new n.KillSwitch("ce40e47f-c3e5-42d2-9efe-4b6188db03d1")],["CarouselLayout",new n.KillSwitch("6e3efcdb-adea-446e-b6d4-478e12d9496e")],["Comments",new n.KillSwitch("06a4b297-8a39-42f0-8146-4fcf15fd9f28")],["CountdownWebPart",new n.KillSwitch("c6fa633c-4a49-41bb-bd61-7ad3dd3d3454")],["EmbedVideoWebPart",new n.KillSwitch("ffdc82e4-1f7e-4e32-86ba-ee7eaa5e72f4")],["EmbedWebPart",new n.KillSwitch("a3df45a2-bcb9-44cc-a627-4b09d4380fc3")],["EventPage",new n.KillSwitch("6270b19a-4c92-4495-ad4e-1f1f570e6090")],["EventsWebPart",new n.KillSwitch("51737f74-23f0-4561-b1ce-effeb15cb292")],["FilePicker",new n.KillSwitch("71d414f5-27f8-4b93-a33a-f3f29553ea12")],["GridLayout",new n.KillSwitch("d6eeb7f8-ed0d-4a68-b6fb-ec66727d7cc1")],["HeroWebPart",new n.KillSwitch("8b97c8da-b25b-4d07-9515-46eaccb3c73d")],["HighlightedContentWebPart",new n.KillSwitch("ef7e4a68-45ff-424f-a5e6-e26c12f69b19")],["ImageWebPart",new n.KillSwitch("cab84481-432c-4dbf-9ce9-709caad5e633")],["ImageGalleryWebPart",new n.KillSwitch("ee689cfa-5c47-4164-927b-cb0a45c1c1e3")],["LinkPreviewWebPart",new n.KillSwitch("3ec632bc-a93c-4f10-bb68-aa7fc31a4488")],["NewsLink",new n.KillSwitch("33fdacb6-7922-46c3-a714-37bb86d77e91")],["NewsWebPart",new n.KillSwitch("a8f14b1a-2490-4c19-a00d-41a8c1cfce3a")],["PeopleWebPart",new n.KillSwitch("a2f6df81-a3a3-41cb-ba37-cc1950ca6dba")],["Placeholder",new n.KillSwitch("d5c0b7e0-1cda-4d45-9c2a-3dd032eebbde")],["QuickLinksWebPart",new n.KillSwitch("359dce78-87f7-46fb-a45f-b39db2c61420")],["RecommendedItems",new n.KillSwitch("c9dc4780-e883-4dd7-bbf5-7230e6473649")],["SavedForLaterWebPart",new n.KillSwitch("78e3dc6a-a821-44fa-8215-ea2ff42c5442")],["SitesWebPart",new n.KillSwitch("c1702a8e-b2ca-408a-a75e-1bf24740a795")],["TitleRegionWebPart",new n.KillSwitch("7e3ee066-0e56-4b8a-9b1e-94e15d634e90")],["Toolbox",new n.KillSwitch("b7369ea0-90b4-4183-8f1a-d7e1361154eb")],["WeatherWebPart",new n.KillSwitch("7437672a-92b8-4e74-80f3-4aaaf1513845")],["WorldClockWebPart",new n.KillSwitch("3a445c98-91ff-4e3e-8f97-323164409dbb")],["WebPartChrome",new n.KillSwitch("e3df5196-b5db-42de-bccb-9b898a3cee62")]]);function o(e){var t=i.get(e);return a._SPFlight.isEnabled(1248)&&t&&!t.isActivated()}},faye:function(e,t){e.exports=u},"hiL/":function(e,t){e.exports=p},j3t2:function(e){e.exports=JSON.parse('{"b":"We need you to sign in again. Once you do, we\\u0027ll bring you back here.","a":"Continue"}')},jOlS:function(e,t){e.exports=f},mwqp:function(e,t,r){"use strict";r.r(t),r.d(t,"BaseCollection",function(){return L}),r.d(t,"BaseCollectionWebPart",function(){return z}),r.d(t,"RefreshType",function(){return B}),r.d(t,"CaptionElement",function(){return u.c}),r.d(t,"CaptionElementAlignPosition",function(){return u.a}),r.d(t,"CaptionElementType",function(){return u.b}),r.d(t,"WebPartDataProvider",function(){return q}),r.d(t,"BaseDataWebPart",function(){return K}),r.d(t,"DateBox",function(){return Y}),r.d(t,"DateBoxSize",function(){return Q}),r.d(t,"getRelativeDateTimeStringForLists",function(){return te}),r.d(t,"isSameDay",function(){return G}),r.d(t,"CalculatedField",function(){return ae}),r.d(t,"DisplayFieldMap",function(){return ie}),r.d(t,"MappedField",function(){return re}),r.d(t,"LINK_FIELDNAME_SUFFIX",function(){return ne}),r.d(t,"BaseEmphasisComponentStyles",function(){return oe}),r.d(t,"isFluentEnabledFor",function(){return J.a}),r.d(t,"handleItemNavigation",function(){return se}),r.d(t,"getUrlTarget",function(){return ce}),r.d(t,"isExternalUrl",function(){return le}),r.d(t,"webPartPreviewThumbnail",function(){return he}),r.d(t,"DoughboyDetector",function(){return _e}),r.d(t,"LessText",function(){return me}),r.d(t,"truncateText",function(){return ge}),r.d(t,"MySiteWebPartCacheManager",function(){return k}),r.d(t,"MySiteWebPartCacheHelper",function(){return N}),r.d(t,"OAuthErrorRenderer",function(){return Se}),r.d(t,"PageType",function(){return p}),r.d(t,"Pagination",function(){return y}),r.d(t,"Parallax",function(){return Ee}),r.d(t,"Placeholder",function(){return Ce}),r.d(t,"clampText",function(){return ye}),r.d(t,"TextClamp",function(){return Pe}),r.d(t,"clampElement",function(){return ve}),r.d(t,"WebPartChrome",function(){return S}),r.d(t,"WebPartTitle",function(){return De}),r.d(t,"WebViewUtility",function(){return Re}),r.d(t,"LivePersonaCard",function(){return je}),r.d(t,"EditModeUtilitiesLoader",function(){return ke}),r.d(t,"getEmbedOverlay",function(){return Be});var a=r("17wl"),n=r("cDcd"),i=r("faye"),o=r("UWqr"),s=r("ut3N"),c=r("KL1q"),l=r("hiL/"),d=r("2q6Q"),h=r("Pk8u"),u=r("Ar4x"),p={Default:0,Prev:1,Next:2},f=r("y88i");function _(){return o._SPKillSwitch.isActivated("d7d1d346-9374-4861-9f01-76c59d21a92e")}var m=r("WTsn"),g=r("jOlS");g.loadStyles('.z_f_658c9e0a{width:100%;min-width:240px;text-align:center;margin:0;padding:2px 0;border:1px solid transparent;position:relative}.z_f_658c9e0a .ms-Icon{line-height:inherit}[dir=ltr] .z_f_658c9e0a [data-icon-name=ChevronLeft]{margin-left:0}[dir=ltr] .z_f_658c9e0a [data-icon-name=ChevronRight],[dir=rtl] .z_f_658c9e0a [data-icon-name=ChevronLeft]{margin-right:0}[dir=rtl] .z_f_658c9e0a [data-icon-name=ChevronRight]{margin-left:0}.z_f_658c9e0a button{font-size:14px;font-weight:400;padding:8px 4px;margin:0 8px;cursor:pointer;cursor:hand;position:relative;height:32px!important;display:none;outline:none}.z_f_658c9e0a:not(.aa_f_658c9e0a) button:active{background:"[theme:white, default: #ffffff]"}.z_f_658c9e0a .ab_f_658c9e0a,.z_f_658c9e0a .ac_f_658c9e0a{margin:0;display:inline-block;border:none}.z_f_658c9e0a .ab_f_658c9e0a i,.z_f_658c9e0a .ac_f_658c9e0a i{margin:0 10px;position:relative;top:2px}.z_f_658c9e0a .ae_f_658c9e0a{border-bottom:2px solid!important;cursor:default;position:relative;top:-2px;height:20px;color:"[theme:black, default: #000000]"}.z_f_658c9e0a .ae_f_658c9e0a.af_f_658c9e0a{border:1px dotted!important;border-bottom:3px solid!important}[dir=ltr] .ag_f_658c9e0a{text-align:left}[dir=rtl] .ag_f_658c9e0a{text-align:right}[dir=ltr] .ag_f_658c9e0a .ab_f_658c9e0a{float:right}[dir=rtl] .ag_f_658c9e0a .ab_f_658c9e0a{float:left}@media only screen and (min-width:640px){.z_f_658c9e0a button{display:inline-block}}',!0);var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(){t.props.onClick(t.props.pageNumber,t.props.pageType)},t._handleKeyDown=function(e){t.props.onKeyDown(e,t.props.pageNumber,t.props.pageType)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props.pageType===p.Prev,r=this.props.pageType===p.Next,i=Object(c.css)(((e={}).ae_f_658c9e0a=this.props.selected,e.ac_f_658c9e0a=t,e.ab_f_658c9e0a=r,e),this.props.className);return n.createElement(c.ActionButton,Object(a.__assign)({className:i,ariaLabel:this._pageAriaLabel,disabled:this.props.disabled,onClick:this._handleClick},!_()&&this.props.onKeyDown?{onKeyDown:this._handleKeyDown}:{}),t&&n.createElement(c.Icon,{iconName:f.Locale.isRightToLeft?"ChevronRight":"ChevronLeft","aria-hidden":"true"}),this.props.text,r&&n.createElement(c.Icon,{iconName:f.Locale.isRightToLeft?"ChevronLeft":"ChevronRight","aria-hidden":"true"}))},Object.defineProperty(t.prototype,"_pageAriaLabel",{get:function(){return this.props.pageNumber?this.props.pageType===p.Default?f.StringHelper.format(m.a,this.props.pageNumber):f.StringHelper.format(m.d,this.props.text,this.props.pageNumber):f.StringHelper.format(m.e,this.props.text)},enumerable:!1,configurable:!0}),t}(n.PureComponent),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(e,r){t.props.onPageChange(e,r)},t._handleKeyDown=function(e,r,a){t.props.onPageChangeWithKeyDown(e,r,a)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=Object(c.css)("z_f_658c9e0a",((e={}).ag_f_658c9e0a=!this.props.showPageNum,e.aa_f_658c9e0a=!0,e),this.props.className);return 0===this.props.itemsCount?void 0:n.createElement("div",{className:t},this.pages)},Object.defineProperty(t.prototype,"pages",{get:function(){var e=[],t=Math.ceil(this.props.itemsCount/this.props.itemsPerPage),r=this.props.pageLength,i=this.props.currentPage;i<1&&(i=1),i>t&&(i=t);var o=Math.max(1,i-Math.floor(r/2)),s=Math.min(t,i+Math.floor(r/2));s-o+1<r&&(i<t/2?s=Math.min(t,r+o):o=Math.max(1,s-r)),s-o+1>r&&(i>t/2?o++:s--);var c=i-1>0?i-1:i,l=i===s?s:i+1;if(e.push(n.createElement(b,Object(a.__assign)({className:this.props.pageClassName,key:m.c+c,text:m.c,pageType:p.Prev,pageNumber:this.props.showPageNum?c:void 0,selected:!1,disabled:this.props.showPageNum?1===i:!this.props.hasPrevPage,onClick:this._handleClick},!_()&&this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),this.props.showPageNum)for(var d=o;d<=s;d++){var h=""+d;e.push(n.createElement(b,Object(a.__assign)({key:h+d,text:h,pageType:p.Default,pageNumber:d,selected:i===d,disabled:!1,onClick:this._handleClick},!_()&&this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{})))}return e.push(n.createElement(b,Object(a.__assign)({key:m.b+l,text:m.b,pageType:p.Next,pageNumber:this.props.showPageNum?l:void 0,selected:!1,disabled:this.props.showPageNum?i===s:!this.props.hasNextPage,onClick:this._handleClick},!_()&&this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),e},enumerable:!1,configurable:!0}),t}(n.PureComponent),v=function(){function e(){}return e.getStyles=function(e){var t=e.theme,r=t.semanticColors;return{title:[{selectors:{"& span":{color:r.bodyText},"& textarea":{color:t.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:t.semanticColors.bodySubtext+" !important"}}}],add:[{color:r.bodyText,selectors:{"& .ms-Button-icon":{color:r.link},"&:hover .ms-Button-icon, &:active .ms-Button-icon, &:focus .ms-Button-icon":{color:r.linkHovered+" !important"},"& .ms-Button-label":{color:r.actionLink},"&:hover .ms-Button-label, &:active .ms-Button-label, &:focus .ms-Button-label":{color:r.actionLinkHovered+" !important"},"& .ms-Button-menuIcon":{color:r.bodySubtext},"&:hover .ms-Button-menuIcon, &:active .ms-Button-menuIcon, &:focus .ms-Button-menuIcon":{color:r.bodySubtext+" !important"}}}],seeAll:[{color:r.link,selectors:{"&:hover, &:active":{color:r.linkHovered},"&:focus":{color:r.link}}}]}},e.getClassNames=Object(c.classNamesFunction)(),e}(),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return r.e(3).then(r.bind(null,"mbAJ")).then(function(e){return e.TeachingBubble})},t}(r("qjmy")._DeferredComponent),C=r("pDlU"),w=r("xTKt");g.loadStyles('.ai_h_658c9e0a{display:flex;align-items:stretch;flex-direction:column}.aj_h_658c9e0a{display:flex;align-items:baseline}.ak_h_658c9e0a{order:2;width:100%}.al_h_658c9e0a{flex-grow:1}[dir=ltr] .al_h_658c9e0a{margin-right:32px}[dir=rtl] .al_h_658c9e0a{margin-left:32px}.ms-Button.am_h_658c9e0a{height:auto;margin-bottom:23px;border:0}[dir=ltr] .ms-Button.am_h_658c9e0a{padding-left:0}[dir=rtl] .ms-Button.am_h_658c9e0a{padding-right:0}[dir=ltr] .ms-Button.am_h_658c9e0a .ms-Icon{margin-left:0}[dir=rtl] .ms-Button.am_h_658c9e0a .ms-Icon{margin-right:0}.ms-Button.an_h_658c9e0a{background-color:transparent;height:35px;margin-bottom:5px;margin-top:-9px}.ms-Button.ao_h_658c9e0a .ms-Button-icon,.ms-Button.ao_h_658c9e0a:hover .ms-Button-label{color:"[theme:themePrimary, default: #0078d4]"}.ap_h_658c9e0a{white-space:nowrap}[dir=ltr] .ap_h_658c9e0a{margin-left:auto}[dir=rtl] .ap_h_658c9e0a{margin-right:auto}.CanvasSection--edit .al_h_658c9e0a{flex-shrink:0}.aq_h_658c9e0a{margin-bottom:18px}.ar_h_658c9e0a{margin-bottom:11px}.as_h_658c9e0a{margin-bottom:0}.at_h_658c9e0a{background-color:#fff}',!0);var S=function(e){function t(t){var r=e.call(this,t)||this;return r._handleClick=function(e){var t=r.props,a=t.seeAllLink,n=t.webPartAlias;a.teachingBubble&&!r.state.isTeachingBubbleDismissed&&r._onDismissTeachingBubble(),l.ScreenReaderAlert.read(o.Text.format(w.f,n||""),l.ReadingMode.ReadImmediately),a.onClick(e)},r._onDismissTeachingBubble=function(){var e=r.props.seeAllLink;r._isMounted&&r.setState({isTeachingBubbleDismissed:!0}),e&&e.teachingBubble.onDismiss()},r._handleSeeAllLinkKeyDown=function(e){e.keyCode===c.KeyCodes.enter&&l.ScreenReaderAlert.read(o.Text.format(w.f,r.props.webPartAlias||""),l.ReadingMode.ReadImmediately)},r.state={isTeachingBubbleDismissed:!1},r}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return Boolean(e)&&v.getClassNames(v.getStyles,{root:"webPartChrome",theme:e})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.render=function(){var e,t=this.props,r=t.dataAutomationId,a=t.forceContrastBackground,i=t.seeAllLink,o=t.showTitle,s=i&&i.show||o,l=n.createElement("div",{"data-automation-id":r,className:Object(c.css)("ai_h_658c9e0a",(e={},e.at_h_658c9e0a=a,e))},n.createElement("div",{className:s?"aj_h_658c9e0a":"","data-automation-id":s?"webPartHeader":""},this._renderTitle(),this._renderSeeAllLink()),this._renderContent(),this._renderTeachingBubble());return this.props.theme?n.createElement(c.Customizer,{settings:{theme:this.props.theme}},l):l},t.prototype.focusOnTitle=function(){this._captionElement&&this._captionElement.focusOnCaptionElement()},t.prototype._renderTitle=function(){var e=this.props,t=e.customTitle,r=e.isEditMode,a=e.onTitleChange,i=e.placeholder,o=e.showTitle,s=e.title,l=e.titleAlignment,d=e.isTitleEditable;return o?t||n.createElement(u.c,{className:Object(c.css)(this._classNames&&this._classNames.title,"al_h_658c9e0a"),ref:this._resolveRef("_captionElement"),type:u.b.Title,isEditMode:r,text:s,onChange:a||h.noop,placeholder:i,alignPosition:l||u.a.PageDirection,headingLevel:2,marginBottomSize:this._titleMarginBottomSize,isTitleEditable:C.a.topicPageTitleNotEditableEditMode.isActivated()?void 0:d}):n.createElement("div",{className:"al_h_658c9e0a"})},t.prototype._renderContent=function(){var e=this.props,t=e.contentElement,r=e.pagination,i=e.panelElement;return n.createElement("div",{className:"ak_h_658c9e0a"},this._renderAddButton(),t,i,r&&n.createElement(y,Object(a.__assign)({},r)))},Object.defineProperty(t.prototype,"_titleMarginBottomSize",{get:function(){var e=this.props,t=e.addButton,r=e.seeAllLink,a=e.showTitle,n=e.titleMarginBottomSize;return void 0!==n?n:r&&r.show||a?t.show?"Middle":"Large":"None"},enumerable:!1,configurable:!0}),t.prototype._renderSeeAllLink=function(){var e,t=this.props.seeAllLink;switch(this._titleMarginBottomSize){case"Large":e="aq_h_658c9e0a";break;case"Middle":e="ar_h_658c9e0a";break;case"None":e="as_h_658c9e0a"}return t&&t.show&&t.href&&n.createElement("span",{className:e,ref:this._resolveRef("_teachingBubbleTargetElement")},n.createElement(c.Link,Object(a.__assign)({"aria-label":t.ariaLabel||w.e,className:Object(c.css)(!t.disabled&&this._classNames&&this._classNames.seeAll,"ap_h_658c9e0a"),disabled:t.disabled,onClick:this._handleClick,onKeyDown:this._handleSeeAllLinkKeyDown,"data-interception":"propagate","data-automation-id":t.automationId,id:t.id,"data-sp-action":t.action},{href:t.href}),t.label||w.d))},t.prototype._renderTeachingBubble=function(){var e=this.props.seeAllLink.teachingBubble;return this._showTeachingBubble&&!this.state.isTeachingBubbleDismissed?n.createElement(P,{deferredProps:{headline:e.headline,targetElement:this._teachingBubbleTargetElement,onDismiss:this._onDismissTeachingBubble,hasCloseIcon:!0,calloutProps:{doNotLayer:!1,gapSpace:2,isBeakVisible:!0,directionalHint:c.DirectionalHint.topAutoEdge},primaryButtonProps:e.primaryButtonProps,closeButtonAriaLabel:w.c}},e.text):void 0},Object.defineProperty(t.prototype,"_showTeachingBubble",{get:function(){var e=this.props.seeAllLink;return Boolean(e&&e.teachingBubble&&e.teachingBubble.show)},enumerable:!1,configurable:!0}),t.prototype._renderAddButton=function(){var e=this.props.addButton;if(e&&e.show){var t={ariaLabel:e.ariaLabel||w.a,ariaDescription:e.ariaDescription,disabled:e.disabled,iconProps:{iconName:"CalculatorAddition"},label:e.label||w.b,"data-automation-id":e.automationId,"data-interception":"propagate"};return e.menuProps?n.createElement(c.DefaultButton,Object(a.__assign)({},t,{className:Object(c.css)(!e.disabled&&this._classNames&&this._classNames.add,"am_h_658c9e0a","an_h_658c9e0a",!this._classNames&&"ao_h_658c9e0a"),menuProps:e.menuProps,styles:{label:{fontWeight:400}}}),t.label):n.createElement(c.ActionButton,Object(a.__assign)({},t,{className:Object(c.css)(!e.disabled&&this._classNames&&this._classNames.add,"am_h_658c9e0a"),href:e.href,onClick:e.onClick}),t.label)}},t.defaultProps={isEditMode:!1,seeAllLink:{show:!1},addButton:{show:!1},contentElement:n.createElement("div",null)},t}(c.BaseComponent),x=r("IBxL");g.loadStyles('.au_i_658c9e0a{color:"[theme:neutralPrimary, default: #323130]"}.av_i_658c9e0a{margin-bottom:5px}.aw_i_658c9e0a a::-moz-focus-inner,.aw_i_658c9e0a button::-moz-focus-inner{border:0}.aw_i_658c9e0a a,.aw_i_658c9e0a button{outline:transparent;position:relative}.aw_i_658c9e0a.ms-Fabric.is-focusVisible a:focus:after,.aw_i_658c9e0a.ms-Fabric.is-focusVisible button:focus:after,.ms-Fabric.is-focusVisible .aw_i_658c9e0a a:focus:after,.ms-Fabric.is-focusVisible .aw_i_658c9e0a button:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}',!0);var E=function(){function e(){}return e.isMySiteCacheSmartRaceRefactorEnabled=function(){return o._SPFlight.isEnabled(1549)},e.isTieredCachingEnabled=function(){return e._isTieredCachingEnabled()&&(e._isMySiteCacheTieredModelEnabled()||e._isIDBTieredModelEnabled())},e.isHideEmptyWebPartsEnabled=function(){return o._SPFlight.isEnabled(60225)},e._isTieredCachingEnabled=function(){return o._SPFlight.isEnabled(1703)},e._isMySiteCacheTieredModelEnabled=function(){return 1===d._SPPerfExperiment.getVariantAndTrackExperiment(d._PerformanceExperiment.WEXMySiteCacheTieredCachingExp)||o._SPFlight.isEnabled(1705)},e._isIDBTieredModelEnabled=function(){return 1===d._SPPerfExperiment.getVariantAndTrackExperiment(d._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)||o._SPFlight.isEnabled(1693)},e}(),L=function(e){function t(t){var r=e.call(this,t)||this;return r._webPartChromeRef=n.createRef(),r._handleTitleChange=function(e){r.props.onTitleChange(e)},r._layoutContainerRef=n.createRef(),r}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.onComponentMounted;!this._isDynamicLayout&&e&&e()},t.prototype.componentWillUnmount=function(){this._layoutContainerRef.current&&(i.unmountComponentAtNode(this._layoutContainerRef.current),this._layoutContainerRef=void 0)},t.prototype.render=function(){var e,t=this.props,r=t.addButton,a=t.defaultTitle,i=t.displayMode,l=t.emphasisTheme,d=t.errorCallback,h=t.hideWebPartWhenEmpty,u=t.isInTeamsContext,p=t.isRenderedFromCacheData,f=t.paginationProps,_=t.panelElement,m=t.qosPrefix,g=t.seeAllLink,b=t.isTitleEditable,y=t.changeVisibility,v=new s._QosMonitor(m+"ComponentRender"),P=this._renderEmptyResult(v),w=p?"BaseCollection-Cache":"BaseCollection-FreshData";P||this._renderLayout();try{!(E.isHideEmptyWebPartsEnabled()&&h&&P)||g&&g.show||i!==o.DisplayMode.Read?(e=n.createElement(c.Fabric,null,n.createElement(S,{addButton:r,contentElement:this._renderWebPartDisplay(P),dataAutomationId:w,forceContrastBackground:u,isEditMode:i===o.DisplayMode.Edit,onTitleChange:this._handleTitleChange,pagination:f,panelElement:_,placeholder:a,ref:this._webPartChromeRef,seeAllLink:g,showTitle:this._shouldShowTitle,theme:l,title:this._title,isTitleEditable:C.a.topicPageTitleNotEditableEditMode.isActivated()?void 0:b}),this._dialogRef?n.createElement("div",{ref:this._dialogRef}):void 0),E.isHideEmptyWebPartsEnabled()&&(null==y||y(!0))):(e=!1,null==y||y(!1))}catch(e){d(e),v.writeUnexpectedFailure("FailedToRender",e)}return v.writeSuccess(),e},t.prototype.focusOnTitle=function(){var e=this._webPartChromeRef.current;e&&e.focusOnTitle()},Object.defineProperty(t.prototype,"_hasEmptyResponse",{get:function(){var e=this.props.items;return!!e&&e.length<1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_emptyResponseText",{get:function(){var e=this.props,t=e.displayMode,r=e.hasInitialLoadingState,a=e.hideWebPartWhenEmpty,n=e.emptyResponseText;if(this._hasEmptyResponse&&!r){if(a&&t===o.DisplayMode.Read)return;return n||x.h}},enumerable:!1,configurable:!0}),t.prototype._renderEmptyResult=function(e){var t=this.props,r=t.errorCallback,a=t.hasInitialLoadingState,i=t.layoutInfo;if(this._hasEmptyResponse&&!a)try{var o=i&&i.id||"",s=Object(C.c)()&&this.props.emphasisTheme?"":"au_i_658c9e0a",c=Object(C.c)()?{color:this.props.emphasisTheme.palette.neutralPrimary}:{};return n.createElement("span",{className:s,"data-automation-id":o+"-no-results",style:c},this._emptyResponseText)}catch(t){r(t),e.writeUnexpectedFailure("FailedToRenderEmptyResult")}},t.prototype._renderLayout=function(){var e=this,t=this.props,r=t.emphasisTheme,o=t.errorCallback,l=t.layoutInfo,h=t.onComponentMounted,u=t.qosPrefix;C.a.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||d._PerformanceLogger.saveTempData(this.props.webPartTag+".loadLayoutStart",d._PerformanceLogger.now());var p=new s._QosMonitor(u+"ComponentRenderLayout");this._isDynamicLayout=!0,l.loadLayout().then(function(t){C.a.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||d._PerformanceLogger.saveTempData(e.props.webPartTag+".loadLayoutEnd",d._PerformanceLogger.now());var o=n.createElement(t,e.props);if(r){var s={settings:{theme:r}};o=n.createElement(c.Customizer,Object(a.__assign)({},s),o)}var l=function(){p.writeSuccess(),h&&h()};e._layoutContainerRef.current?i.render(o,e._layoutContainerRef.current,l):l(),C.a.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||d._PerformanceLogger.saveTempData(e.props.webPartTag+".syncLayoutRenderComplete",d._PerformanceLogger.now())}).catch(function(e){o(e),p.writeUnexpectedFailure("FailedToRenderLayout",e)})},Object.defineProperty(t.prototype,"_title",{get:function(){var e=this.props,t=e.defaultTitle,r=e.displayMode,a=e.displayPlaceholderTitleInReadMode,n=e.title;return r===o.DisplayMode.Read&&a&&!n?t:n||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowTitle",{get:function(){var e=this.props,t=e.displayMode,r=e.hasInitialLoadingState,a=e.showTitle,n=r||!this._hasEmptyResponse||Boolean(this._emptyResponseText);return a&&t===o.DisplayMode.Edit||n&&a&&!!this._title},enumerable:!1,configurable:!0}),t.prototype._renderWebPartDisplay=function(e){var t=this.props,r=t.addToPageScreenReaderLabel,a=t.displayMode,i=t.messageView,s=t.renderedOnce;return n.createElement("div",null,a===o.DisplayMode.Edit&&!s&&r&&n.createElement(l.ScreenReaderAlert,{readingMode:l.ReadingMode.ReadImmediately,message:r}),i&&n.createElement(c.MessageBar,{className:"av_i_658c9e0a",ariaLabel:i.ariaLabel,messageBarType:i.messageBarType},i.message),e||n.createElement("div",{ref:this._layoutContainerRef}))},t}(c.BaseComponent),T=r("7Awa"),I=r("br4S"),D=r("X+PM"),R=r("vlQI");function O(){return o._SPFlight.isEnabled(1671)}var N=function(){function e(){}return e.getRemoteSubfolderCreateUrl=function(e,t,r,a){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl"),o.Validate.isNonemptyString(t,"remoteWebAbsoluteUrl"),o.Validate.isNonemptyString(r,"remoteParentFolderRelativeUrl"),o.Validate.isNonemptyString(a,"remoteFolderName");var n=f.UriEncoding.encodeRestUriStringToken(t),i=f.UriEncoding.encodeRestUriStringToken(r),s=f.UriEncoding.encodeRestUriStringToken(a);return f.Uri.concatenate(f.Uri.concatenate(f.Uri.concatenate(e,"/_api/SP.RemoteWeb(@remoteWeb)"),"/Web/GetFolderByServerRelativePath(DecodedUrl=@parentFolderRelativeUrl)"),"/AddSubFolder(@subfolderTitle)")+"?@remoteWeb='"+n+"'&@parentFolderRelativeUrl='"+i+"'&@subfolderTitle='"+s+"'"},e.getUrlLastSegment=function(e){return o.Validate.isNonemptyString(e,"url"),new f.Uri(e).getLastPathSegment()},e.getUrlWithoutLastSegment=function(e){o.Validate.isNonemptyString(e,"url");var t=e.lastIndexOf("/");return t>-1?e.substring(0,t):e},e.getPersonalCacheItemCreateUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=O()?"/ReadCacheOrCreate2":"/ReadCacheOrCreate";return f.Uri.concatenate(f.Uri.concatenate(e,"/_api/SP.UserProfiles.PersonalCache"),t)},e.getPersonalCacheItemUpdateUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=O()?"/WriteCache2":"/WriteCache";return f.Uri.concatenate(f.Uri.concatenate(e,"/_api/SP.UserProfiles.PersonalCache"),t)},e.getPersonalCacheItemDeleteUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=O()?"/DeleteCacheItemsAsync2":"/DeleteCacheItemsAsync";return f.Uri.concatenate(f.Uri.concatenate(e,"/_api/SP.UserProfiles.PersonalCache"),t)},e.dateTimeStringToJsDate=function(e){o.Validate.isNonemptyString(e,"dateTime");var t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))},e.checkStatus=function(e){return o.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.checkFolderStatus=function(e){return o.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300||500===e.status?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.getCreatePersonalCacheItemBody=function(e,t,r){o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"items");var a="";t.forEach(function(e){""!==a&&(a+=", "),a+=e.CacheKey});var n={folderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:""+e},requiredCacheKeys:[""+a],createIfMissing:!0};return r&&O()&&(n.mySiteUrl=r),n},e.getReadPersonalCacheItemBody=function(e,t,r){o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"instanceIds");var a={folderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:""+e},requiredCacheKeys:t,createIfMissing:!1};return r&&O()&&(a.mySiteUrl=r),a},e.getUpdatePersonalCacheItemsBody=function(e,t,r){o.Validate.isNotNullOrUndefined(e,"items");var a={cacheItems:[]};return e.forEach(function(e){r&&(e.CacheValue=""),a.cacheItems.push(e)}),t&&O()&&(a.mySiteUrl=t),a},e.post=function(e,t,r,a){return o.Validate.isNotNullOrUndefined(e,"spHttpClient"),o.Validate.isNonemptyString(t,"url"),o.Validate.isNotNullOrUndefined(r,"body"),e.post(t,R.SPHttpClient.configurations.v1,{body:JSON.stringify(r),headers:{"OData-Version":"3.0"}}).then(a)},e.generateHash=function(e){return Object(l.Md5Hash)(e)},e.getDateNowAsUTC=function(){var e=new Date;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()))},e.addSecondsToDate=function(e,t){o.Validate.isNotNullOrUndefined(e,"date"),o.Validate.isNotNullOrUndefined(t,"seconds");var r=new Date(e.toString());return r.setTime(r.getTime()+1e3*t),r},e.isExpired=function(t,r,a){return t&&r&&a&&a>0&&t>e.addSecondsToDate(r,a)},e}(),U="MySiteWebPartCacheDataProvider.",A="MySiteWebPartCacheDataProvider",F=new l.KillSwitch("4edae48c-3b13-49f4-9d36-ae20f68406f4"),M=new l.KillSwitch("119E9B3E-9B4E-4575-B09A-972FE0E35921"),W=function(){function e(t){var r=this;this._cacheItemsMap=new Map,this._cacheItemVersionMap=new Map,this._hasFlushCompleted=!1,this._hasInitializedSynchronously=!1,this._updateRemoteCacheItemsAPI=function(e,t){o.Validate.isNotNullOrUndefined(e,"absoluteUrl"),o.Validate.isNotNullOrUndefined(t,"items");var a=new s._QosMonitor(U+"_writeCache");d._PerformanceLogger.startMarkForComponent("_writeCache"),r._updateLocalItems(t);var n,i=N.getPersonalCacheItemUpdateUrl(e),c=N.getUpdatePersonalCacheItemsBody(t,r._mySiteAbsoluteUrl);return n=F.isActivated()?{count:t.length}:{count:t.length,dataSizeInKB:JSON.stringify(t).length/1024},N.post(r._spHttpClient,i,c,N.checkStatus).then(function(e){return a.writeSuccess(n),d._PerformanceLogger.endMarkForComponent("_writeCache"),e}).catch(function(e){return a.writeUnexpectedFailure("WriteCacheError",e,n),d._PerformanceLogger.endMarkForComponent("_writeCache"),Promise.reject(e)})},this._updateRemotePersonalCacheItems=function(){e._itemsToDeferUpdate.size>0&&(e._itemsToDeferUpdate.forEach(function(t,a){r._updateRemoteCacheItemsAPI(a,t).catch(function(t){return s._TraceLogger.logError(e._logSource,t,"UpdateRemoteCacheItems")})}),e._itemsToDeferUpdate.clear())},this._remoteUpdater=function(e){r._updateRemotePersonalCacheItems(),e||(r._writeCacheTimer=r._async.setTimeout(r._remoteUpdater,1e4))},this._hookUnloadEvent=function(){window.addEventListener("beforeunload",r._emergencyUpload)},this._unhookUnloadEvent=function(){window.removeEventListener("beforeunload",r._emergencyUpload)},this._emergencyUpload=function(){r._remoteUpdater(!0),r._unhookUnloadEvent(),r._writeCacheTimer&&r._async.clearTimeout(r._writeCacheTimer)},d._PerformanceLogger.startMarkForComponent(A),this._async=new c.Async(this);var a=function(){var e=new s._QosMonitor(U+"_tryInitializeFromLateFlush");try{r._tryInitializeFromPage(),r._hasFlushCompleted?e.writeSuccess():e.writeUnexpectedFailure("NoCacheMetadata")}catch(t){e.writeUnexpectedFailure("CatchAll",t)}},n=e._increaseLateFlushKS()?12e4:24e4,i=0;this._initializeFromLateFlush=new Promise(function(e,t){var o=new s._QosMonitor(U+"_initializeFromLateFlush");window._spWebPartDataLoaded||(window._spWebPartDataLoaded=a);var l=new c.Async;l.setInterval(function(){return!r._hasFlushCompleted&&window._spWebPartData&&a(),r._hasFlushCompleted&&window._spWebPartData?(d._PerformanceLogger.markComponent(A,r._hasInitializedSynchronously?"SyncFlushCompleted":"LateFlushCompleted"),o.writeSuccess({initializedAsync:!r._hasInitializedSynchronously}),l.dispose(),e()):i>=n?(d._PerformanceLogger.endMarkForComponent(A),o.writeUnexpectedFailure("TimedOut"),l.dispose(),t()):void(i+=50)},50)}),t.whenFinished(function(){r._pageContext=t.consume(D.PageContext.serviceKey),r._spHttpClient=t.consume(R.SPHttpClient.serviceKey),r._tryInitializeSynchronously(),r._remoteUpdater(),r._hookUnloadEvent(),s._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.Constructor")})}return e._increaseLateFlushKS=function(){return o._SPKillSwitch.isActivated("ab30cf50-82cc-4361-9270-edce465b67d7")},Object.defineProperty(e.prototype,"currentListRelativeFolderPath",{get:function(){return this._currentListRelativeFolderPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentWebAbsoluteUrl",{get:function(){return this._currentWebAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mySiteAbsoluteUrl",{get:function(){return this._mySiteAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFlushCompleted",{get:function(){return this._hasFlushCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initializeFromLateFlush",{get:function(){return this._initializeFromLateFlush},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPageCacheFolderKey",{set:function(e){this._currentPageCacheFolderKey=e,this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},enumerable:!1,configurable:!0}),e.prototype.getCacheItemVersion=function(e){return this._cacheItemVersionMap.get(e)},e.prototype.getWebPartIdLogObject=function(e,t,r,a){return{alias:e,instanceId:t,isSmartRaceEnabled:this._isMySiteCacheSmartRaceRefactorEnabled(),cacheStatus:r,serverStatus:a}},e.prototype._internalAdvancedGetCachedData=function(e,t){var r=this._getCachedItem(e);if(r&&r.hash===t)return JSON.parse(r.result)},e.prototype._internalAdvancedSetCacheData=function(e,t,r){this._tryUpdateCache(e.instanceId,e.manifest.alias,r,t)},e.prototype.getWebPartData=function(t,r,a,n,i,c,l,d){var h=this;void 0===c&&(c=!0),void 0===l&&(l=-1),o.Validate.isNotNullOrUndefined(t,"requestData"),o.Validate.isNotNullOrUndefined(r,"dataUpdated"),o.Validate.isNotNullOrUndefined(a,"config"),o.Validate.isNonemptyString(n,"webPartInstanceId"),o.Validate.isNonemptyString(i,"webPartAlias");var u=new s._QosMonitor(U+"getWebPartData"),p="",f=void 0,_=this._getCachedItem(n),m=N.generateHash(JSON.stringify(a));d=d||"WebPart."+i+".internal."+n,this._isThrottlingEnabled()&&!this._hasFlushCompleted&&(t=this._getThrottledServerCall(t)),this._logCacheStart(n,d,"MySiteWebPartCacheDataProvider.GetWebPartData"),this._captureCacheKeyUsageTelemetry(i,m);var g=!!_&&m!==_.hash;if(!_||g){this._logCacheMiss(d),this._logConfigMismatch(d,_,!g);var b=t(),y=b.then(function(t){s._TraceLogger.logVerbose(e._logSource,"CacheMiss: Requested cached item for "+d+" doesn't exist. Creating."),f=t,p=JSON.stringify(f),h._tryUpdateCache(n,i,p,m,_?_.id:void 0),u.writeSuccess(h.getWebPartIdLogObject(i,n))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing non-cached item for "+d+"."),u.writeUnexpectedFailure("NewItemRequestSaveRenderError",t,h.getWebPartIdLogObject(i,n))}).then(function(){return f});if(this._hasFlushCompleted)return y;this._logLateFlush(d);var v=this._initializeFromLateFlush.then(function(){return h._getCachedItem(n)}).then(function(t){return h._canUseCachedData_deprecated(t,a,l)?h._returnCachedDataWithRefresh(t,function(){return b},r,a,n,i,u,m,c,l):(s._TraceLogger.logVerbose(e._logSource,"Late flush resulted in a miss "+i+"."+n),y)});return Promise.race([v,y])}if(N.isExpired(this._utcTimeStamp,_.modified,l))return this._logCacheExpired(d),t().then(function(e){f=e,p=JSON.stringify(f),h._tryUpdateCache(n,i,p,m,_.id),u.writeSuccess(h.getWebPartIdLogObject(i,n))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cached WebPart item "+n+"."),u.writeUnexpectedFailure("ExpiredCacheUpdateError",t,h.getWebPartIdLogObject(i,n))}).then(function(){return f});try{if(m===_.hash)return this._returnCachedDataWithRefresh(_,t,r,a,n,i,u,m,c,l)}catch(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cache item request for "+d+"."),u.writeUnexpectedFailure("CachedItemUpdateError",t,this.getWebPartIdLogObject(i,n))}finally{return this._logCacheHit(d),Promise.resolve(JSON.parse(_.result))}},e.prototype.getCacheData=function(e){var t=this,r=e.dataUpdated,a=e.serializedConfiguration,n=e.webPartAlias,i=e.webPartInstanceId,s=e.secondsToInvalidate,c=e.requestData;o.Validate.isNotNullOrUndefined(c,"requestData"),o.Validate.isNotNullOrUndefined(r,"dataUpdated"),o.Validate.isNotNullOrUndefined(a,"serializedConfiguration"),o.Validate.isNonemptyString(n,"webPartAlias"),o.Validate.isNonemptyString(i,"webPartInstanceId");var d=this._getCachedItem(i),h=N.generateHash(a),u="WebPart."+n+".internal."+i;this._logCacheStart(i,u,"MySiteWebPartCacheDataProvider.GetCacheData");var p={cacheResponseType:l.CacheResponseType.ServerData,serverResponseAsync:Promise.reject().catch(function(e){return e})},f=function(e){return t._shouldRequestServerDataWhenThrottling(e)?t._tryUpdateCacheAsync(c,r,n,i,h):p.serverResponseAsync};if(this._isThrottlingEnabled()?this._hasFlushCompleted||(c=this._getThrottledServerCall(c)):p.serverResponseAsync=this._tryUpdateCacheAsync(c,r,n,i,h),this._canUseCachedData(d,h,s,u))return p.cacheResponseType=l.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(d.result)),this._isThrottlingEnabled()&&(p.serverResponseAsync=f(d.modified)),Promise.resolve(p);if(this._logCacheMiss(u),!this._hasFlushCompleted){this._logLateFlush(u);var _=this._initializeFromLateFlush.then(function(){return t._getCachedItem(i)}).then(function(e){return t._canUseCachedData(e,h,s,u)&&(p.cacheResponseType=l.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(e.result)),t._isThrottlingEnabled()&&(p.serverResponseAsync=f(d.modified))),Promise.resolve(p)});this._isThrottlingEnabled()&&(p.serverResponseAsync=_.then(function(e){return e.serverResponseAsync}));var m=o.Guid.parse("f45cfbcb-6bff-4e57-93d9-5427a620ab01"),g=o.Guid.parse("4bba5b4c-4f1a-4639-9512-3abc0226331a"),b=[{raceablePromise:_.then(function(e){return e.cacheResponseAsync||e.serverResponseAsync}),raceId:m},{raceablePromise:p.serverResponseAsync,raceId:g}];return l.SmartRace.race(b).then(function(e){return{cacheResponseType:e.raceId===m?l.CacheResponseType.CachedData:l.CacheResponseType.ServerData,cacheResponseAsync:e.raceId===m?e.raceablePromise:void 0,serverResponseAsync:p.serverResponseAsync}}).catch(function(e){throw t._logSmartRaceError(e),e})}return p.cacheResponseType=l.CacheResponseType.ServerData,this._isThrottlingEnabled()&&(p.serverResponseAsync=this._tryUpdateCacheAsync(c,r,n,i,h)),Promise.resolve(p)},e.prototype._tryUpdateCacheAsync=function(e,t,r,a,n){var i=this;return e().then(function(e){t&&t(e);var o=JSON.stringify(e);return i._tryUpdateCache(a,r,o,n),e})},e.prototype._canUseCachedData=function(e,t,r,a){var n=!!e&&(e.hash===t||"2.0"===e.cacheVersion);if(this._logConfigMismatch(a,e,n),e){var i=N.isExpired(this._utcTimeStamp,e.modified,r);if(i&&this._logCacheExpired(a),n&&!i)return this._logCacheHit(a),!0}return!1},e.prototype._canUseCachedData_deprecated=function(e,t,r){return void 0===r&&(r=-1),!(!e||e.hash!==N.generateHash(JSON.stringify(t))&&"2.0"!==e.cacheVersion||N.isExpired(this._utcTimeStamp,e.modified,r))},e.prototype._returnCachedDataWithRefresh=function(t,r,a,n,i,o,c,l,d,h){var u=this;void 0===d&&(d=!0),void 0===h&&(h=-1);var p="",f=void 0;return s._TraceLogger.logVerbose(e._logSource,"Found cached item "+i+" with matching config."),this._shouldRequestServerDataWhenThrottling(t.modified)&&r().then(function(r){f=r,p=JSON.stringify(f),t.result!==p?(s._TraceLogger.logVerbose(e._logSource,"Requested item "+i+" has newer results; updating."),u._saveRenderAndUpdateItem(a,d,f,i,o,p,l,t.id),c.writeSuccess(u.getWebPartIdLogObject(o,i)),u._logCacheMatchApiResult(o,!1)):(s._TraceLogger.logVerbose(e._logSource,"Requested cached item "+i+" has matching result; No write back."),c.writeSuccess(u.getWebPartIdLogObject(o,i)),u._logCacheMatchApiResult(o,!0))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cached WebPart item "+i+"."),c.writeUnexpectedFailure("CachedItemUpdatedResultError",t,u.getWebPartIdLogObject(o,i))}),Promise.resolve(JSON.parse(t.result))},e.prototype._logCacheMatchApiResult=function(e,t){s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("MySiteWebPartValidCache_deprecated",e,s._LogType.Event,{CacheMatchApiResult:t?"Match":"Not match"}))},e.prototype._saveRenderAndUpdateItem=function(e,t,r,a,n,i,s,c){o.Validate.isNotNullOrUndefined(e,"dataUpdated"),o.Validate.isNotNullOrUndefined(t,"rerender"),o.Validate.isNotNullOrUndefined(r,"response"),o.Validate.isNonemptyString(a,"webPartInstanceId"),o.Validate.isNonemptyString(n,"webPartAlias"),o.Validate.isNonemptyString(i,"rawResponseString"),o.Validate.isNonemptyString(s,"webPartHash"),o.Validate.isNotNullOrUndefined(c,"cacheItemId"),t&&e(r),this._updateCache(a,n,i,s,c)},e.prototype._tryInitializeSynchronously=function(){var t=new s._QosMonitor(U+"_initialize"),r="Page "+this._currentPageCacheFolderKey+" is missing _spPageContextInfo.",a="Page "+this._currentPageCacheFolderKey+" has not yet gotten the LKG flush.";this._pageContext?(this._getPrefetchedPageContextProperties(this._pageContext.legacyPageContext),this._tryInitializeFromPage()?(this._hasInitializedSynchronously=!0,d._PerformanceLogger.markComponent(A,"SyncFlushCompleted"),t.writeSuccess()):(d._PerformanceLogger.markComponent(A,"DelayedFlush"),s._TraceLogger.logError(e._logSource,new Error,a),t.writeExpectedFailure("DelayedFlush",new Error))):(d._PerformanceLogger.markComponent(A,"SyncMissingContextInfo"),s._TraceLogger.logError(e._logSource,new Error,r),t.writeUnexpectedFailure("SPPageContextInfoError",new Error))},e.prototype._tryInitializeFromPage=function(){return!!this._hasFlushCompleted||(window._spWebPartData&&(this._getPrefetchedWebPartDataProperties(window._spWebPartData.Properties),this._getPrefetchedWebPartDataItems(window._spWebPartData.Items),this._hasFlushCompleted=!0),this._hasFlushCompleted)},e.prototype._getCachedItem=function(e){return this._cacheItemsMap.get(e)},e.prototype._getPrefetchedWebPartDataProperties=function(e){o.Validate.isNotNullOrUndefined(e,"data"),this._mySiteAbsoluteUrl=e.MySiteUrl,this._currentPageCacheFolderKey=e.PageCacheFolderKey,this._webPartCachePath=e.WebPartCachePath,e.UtcTimeStamp&&(this._utcTimeStamp=N.dateTimeStringToJsDate(e.UtcTimeStamp)),this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},e.prototype._getPrefetchedPageContextProperties=function(e){o.Validate.isNotNullOrUndefined(e,"data"),o.Validate.isNonemptyString(e.webAbsoluteUrl,"data.webAbsoluteUrl"),this._currentWebAbsoluteUrl=e.webAbsoluteUrl},e.prototype._getPrefetchedWebPartDataItems=function(e){var t=this;o.Validate.isNotNullOrUndefined(e,"data"),Object.keys(e).forEach(function(r){var a={webPartInstanceId:r,result:e[r].Value,hash:e[r].HashCode,id:Number(e[r].ID),uniqueId:o.Guid.parse(e[r].UniqueId),modified:N.dateTimeStringToJsDate(e[r].Modified),cacheVersion:e[r].CacheVersion};if("1.5"===a.cacheVersion||"2.0"===a.cacheVersion){var n="";try{n=JSON.parse(e[r].AltTitle).id}catch(t){n=e[r].AltTitle}a.webPartInstanceId=n,t._cacheItemVersionMap.set(n,a.cacheVersion),t._cacheItemsMap.set(n,a)}else t._cacheItemVersionMap.set(r,a.cacheVersion),t._cacheItemsMap.set(r,a)}),this._logCacheItemSize()},e.prototype._ensureFlush=function(){return this._hasFlushCompleted?Promise.resolve():this._initializeFromLateFlush},e.prototype._createRemoteCacheItem=function(e,t,r){var a=this;o.Validate.isNonemptyString(e,"title"),o.Validate.isNonemptyString(t,"value"),o.Validate.isNonemptyString(r,"hash");var n=[],i={AltTitle:void 0,CacheValue:t,CacheValueHash:r,ListItemId:void 0,ListItemUniqueId:void 0,CacheVersion:void 0,CacheKey:e,ModifiedTimeUtc:void 0};return n.push(i),this._ensureFlush().then(function(){return a._createPersonalCacheItemsAPI(a._currentListRelativeFolderPath,n)}).then(function(e){if(e)return a._createLocalCacheItemFromServerResponse(e)})},e.prototype._createPersonalCacheItemsAPI=function(e,t){var r=this;o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"items");var a=N.getPersonalCacheItemCreateUrl(this._currentWebAbsoluteUrl),n=N.getCreatePersonalCacheItemBody(e,t,this._mySiteAbsoluteUrl);return N.post(this._spHttpClient,a,n,N.checkStatus).then(function(e){return e.json()}).then(function(e){o.Validate.isNotNullOrUndefined(e,"data");var a=t[0],n=[],i={AltTitle:void 0,CacheValue:a.CacheValue,CacheValueHash:a.CacheValueHash,ListItemId:e.value[0].ListItemId,ListItemUniqueId:e.value[0].ListItemUniqueId,CacheVersion:"1.0",CacheKey:a.CacheKey,ModifiedTimeUtc:e.value[0].ModifiedTimeUtc};n.push(i),r._createLocalItems(n),r._addItemToBeUpdated(r._currentWebAbsoluteUrl,i)})},e.prototype._updateRemoteCacheItem=function(e,t,r,a){o.Validate.isNonemptyString(e,"cacheKey"),o.Validate.isNonemptyString(r,"hash"),o.Validate.isNotNullOrUndefined(a,"itemID"),t||(t="");var n={AltTitle:void 0,CacheValue:t,CacheValueHash:r,ListItemId:a,ListItemUniqueId:void 0,CacheVersion:"1.0",CacheKey:M.isActivated()?void 0:e,ModifiedTimeUtc:void 0};return"2.0"===this._cacheItemVersionMap.get(e)&&(n.AltTitle=JSON.stringify({id:e}),n.CacheVersion="1.5"),[].push(n),this._addItemToBeUpdated(this._currentWebAbsoluteUrl,n),Promise.resolve()},e.prototype._addItemToBeUpdated=function(t,r){if(e._itemsToDeferUpdate.has(t)){var a=e._itemsToDeferUpdate.get(t),n=Object(h.findIndex)(a,function(e){return r.CacheKey===e.CacheKey});n>=0?a[n]=r:a.push(r)}else e._itemsToDeferUpdate.set(t,[r])},e.prototype._updateCache=function(t,r,a,n,i){var c=this;o.Validate.isNonemptyString(t,"webPartInstanceId");var l=t,d=new s._QosMonitor(U+"_updateCache"),h="UnknownError",u=this._getCachedItem(l);if(u&&u.hash===n&&u.result===a)return h="NoOp",void d.writeExpectedFailure(h,void 0,this.getWebPartIdLogObject(r,t));try{var p=void 0;this._cacheItemsMap.has(l)?(s._TraceLogger.logVerbose(e._logSource,"Updating Cache Item "+l+"."),h="UpdateCacheItemError",void 0===i&&(i=this._getCachedItem(l).id),p=this._updateRemoteCacheItem(l,a,n,i)):(s._TraceLogger.logVerbose(e._logSource,"Creating Cache Item "+l+"."),h="CreateCacheItemError",p=this._createRemoteCacheItem(l,a,n)),p.then(function(){d.writeSuccess(c.getWebPartIdLogObject(r,t))}).catch(function(a){s._TraceLogger.logError(e._logSource,a,"_updateCache: "+h+" WebPart: "+t+" Page: "+c._currentPageCacheFolderKey),d.writeUnexpectedFailure(h,a,c.getWebPartIdLogObject(r,t))})}catch(e){d.writeUnexpectedFailure(h,e,this.getWebPartIdLogObject(r,t))}},e.prototype._tryUpdateCache=function(t,r,a,n,i){try{this._updateCache(t,r,a,n,i)}catch(r){s._TraceLogger.logError(e._logSource,r,"getWebPartData: error while processing item "+t+".")}},e.prototype._createLocalCacheItemFromServerResponse=function(t){var r=this;o.Validate.isNotNullOrUndefined(t,"response");var a,n=new s._QosMonitor(U+"_createCacheItemInMap"),i="UnknownError";return t.json().then(function(e){var s,c,l,d,h,u,p;o.Validate.isNotNullOrUndefined(e,"data"),o.Validate.isNotNullOrUndefined(e.value,"data.value");var f=N.getDateNowAsUTC();if(i="ResponseParseError",Object.keys(e.value).forEach(function(t){switch(u=e.value[t].FieldName,p=e.value[t].FieldValue,u){case"Id":c=+p;break;case"Title":a=p;break;case"AltTitle":s=p;break;case"HashCode":l=p;break;case"CacheVersion":d=p;break;case"Value":h=p}}),i="CreateCacheItemMapError",!r._cacheItemsMap.has(a)){var _={webPartInstanceId:a,result:h,hash:l,id:c,modified:f,cacheVersion:d};"1.5"===_.cacheVersion||"2.0"===_.cacheVersion?(_.webPartInstanceId=s,r._cacheItemVersionMap.set(s,_.cacheVersion),r._cacheItemsMap.set(s,_)):(r._cacheItemVersionMap.set(a,_.cacheVersion),r._cacheItemsMap.set(a,_))}return r._logCacheItemSize(),n.writeSuccess(),t}).catch(function(t){return s._TraceLogger.logError(e._logSource,t,"_createCacheItemInMap: error client caching response for WebPart: "+a),n.writeUnexpectedFailure(i,t),Promise.resolve(void 0)})},e.prototype._getListRelativeFolderPath=function(){o.Validate.isNonemptyString(this._webPartCachePath,"this._webPartCachePath"),o.Validate.isNonemptyString(this._currentPageCacheFolderKey,"this._currentPageCacheFolderKey");var e=N.getUrlLastSegment(this._webPartCachePath);return f.Uri.concatenate(e,this._currentPageCacheFolderKey)},e.prototype._createLocalItems=function(e){var t=this;e.forEach(function(e){if(!t._cacheItemsMap.has(e.CacheKey)){var r={webPartInstanceId:e.CacheKey,result:e.CacheValue,hash:e.CacheValueHash,id:e.ListItemId,modified:e.ModifiedTimeUtc,cacheVersion:e.CacheVersion};t._cacheItemsMap.set(e.CacheKey,r)}}),this._logCacheItemSize()},e.prototype._updateLocalItems=function(e){var t=this;e.forEach(function(e){if(t._cacheItemsMap.has(e.CacheKey)){var r=t._getCachedItem(e.CacheKey);r.result=e.CacheValue,r.hash=e.CacheValueHash,r.cacheVersion=e.CacheVersion}}),this._logCacheItemSize()},e.prototype._logCacheItemSize=function(){s._TraceLogger.logVerbose(e._logSource,"_cacheItemsMap Size: "+this._cacheItemsMap.size+".")},e.prototype._captureCacheKeyUsageTelemetry=function(e,t){new s._QosMonitor("MySiteWebPartCacheConfigHash").writeSuccess({alias:e,id:this._currentPageCacheFolderKey,instanceId:t})},e.prototype._logCacheStart=function(t,r,a){s._TraceLogger.logVerbose(e._logSource,"WebPart: "+t+", Page: "+this._currentPageCacheFolderKey+", Environment: "+o.Environment.type+"."),s._EngagementLogger.logEvent(a),d._PerformanceLogger.markComponent(r,"CacheStart")},e.prototype._logConfigMismatch=function(t,r,a){r?a||(s._TraceLogger.logVerbose(e._logSource,"Cache config mismatch for "+t),d._PerformanceLogger.markComponent(t,"CacheMissConfigMismatch")):(s._TraceLogger.logVerbose(e._logSource,"Cached data not found for "+t),d._PerformanceLogger.markComponent(t,"CachedWebPartNotFound"))},e.prototype._logCacheHit=function(t){this._setLKGOnTimeState(!0,"true"),s._TraceLogger.logVerbose(e._logSource,"CacheHit: Returning cached item for "+t+"."),d._PerformanceLogger.markComponent(t,"CacheHit")},e.prototype._logCacheExpired=function(t){this._setLKGOnTimeState(!0,"stale"),s._TraceLogger.logVerbose(e._logSource,"Requested cached item for "+t+" exists but is expired."),d._PerformanceLogger.markComponent(t,"CacheExpired"),this._logCacheMiss(t)},e.prototype._logCacheMiss=function(t){this._setLKGOnTimeState(!1,"false"),s._TraceLogger.logVerbose(e._logSource,"Cache Miss for "+t),s._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.CacheMiss"),d._PerformanceLogger.markComponent(t,"CacheMiss")},e.prototype._logLateFlush=function(t){this._setLKGOnTimeState(!1,"false"),s._TraceLogger.logVerbose(e._logSource,"Racing between late flush and data fetch for "+t),d._PerformanceLogger.markComponent(t,"LateFlush")},e.prototype._setLKGOnTimeState=function(e,t){void 0===this._cacheOnTime&&(this._cacheOnTime=e,d._PerformanceLogger.setPerformanceProperty("lkgOnTime",t))},e.prototype._logSmartRaceError=function(t){s._TraceLogger.logError(e._logSource,t)},e.prototype._isMySiteCacheSmartRaceRefactorEnabled=function(){return o._SPFlight.isEnabled(1549)},e.prototype._isThrottlingEnabled=function(){return o._SPFlight.isEnabled(1917)},e.prototype._shouldRequestServerDataWhenThrottling=function(e){var t=this._isThrottlingEnabled();return!!(!t||t&&N.isExpired(this._utcTimeStamp,e,86400))},e.prototype._getThrottledServerCall=function(e){var t=this,r=e;return function(){return new Promise(function(e,a){t._async.setTimeout(function(){r().then(function(t){return e(t)}).catch(function(e){return a(e)})},750)})}},e._itemsToDeferUpdate=new Map,e._logSource=s._LogSource.create("MySiteWebPartCacheDataProvider"),e}(),j=new l.KillSwitch("02ee5e09-105f-4ae4-b419-43a170c73e73"),k=function(){function e(e){var t=this;this._isDisposed=!1,this._mySiteWebPartCacheDataProvider=new W(e),this._logSource=s._LogSource.create("MySiteWebPartCacheManager"),this._serviceScope=e,e.whenFinished(function(){t._spHttpClient=e.consume(R.SPHttpClient.serviceKey)}),o._SPEventManager.instance.registerEvent("pageDeserializationFinished_legacyMySite",this,this.deleteUnmatchedCacheEntries),o._SPEventManager.instance.registerEvent("resetLegacyCacheManager",this,this.initializeCacheProvider)}return e._calculateHash=function(e){return N.generateHash(JSON.stringify(e))},Object.defineProperty(e.prototype,"instanceId",{get:function(){return this._instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentId",{get:function(){return"96f08fe4-4e36-4fc2-8d13-f19ac082aedd"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0)},e.prototype.getCacheItemVersion=function(e){return this._mySiteWebPartCacheDataProvider.getCacheItemVersion(e)},e.prototype.initializeCacheProvider=function(e){var t,r;e!==(null===(r=null===(t=window._spWebPartData)||void 0===t?void 0:t.Properties)||void 0===r?void 0:r.PageCacheFolderKey)&&(window._spWebPartData=void 0,window._spWebPartDataLoaded=void 0),this._mySiteWebPartCacheDataProvider=new W(this._serviceScope),s._EngagementLogger.logEvent("MySiteWebPartCacheDataManager.InPageNavTriggered")},e.prototype.requestWebPartCacheData_deprecated=function(e){return this._mySiteWebPartCacheDataProvider.getWebPartData(e.requestData,e.dataUpdated,e.config,e.webPartInstanceId,e.webPartAlias,e.rerender,e.secondsToInvalidate,e.webPartTag)},e.prototype.requestWebPartCacheData=function(e){var t=this,r=new s._QosMonitor("MySiteWebPartCacheDataManager.requestWebPartCacheData");return this._mySiteWebPartCacheDataProvider.getCacheData(e).then(function(a){var n=a.cacheResponseType===l.CacheResponseType.CachedData?"Completed":"Miss",i=a.cacheResponseType===l.CacheResponseType.CachedData?"Waiting":"Completed";return r.writeSuccess(t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,n,i)),a}).catch(function(a){return a.serverResponseAsync.catch(function(a){r.writeUnexpectedFailure("FailedToRetrieveCacheAndServerData",a,t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,"Failed","Failed"))}),a})},e.prototype.getCachedData=function(t,r){return o.Validate.isNotNullOrUndefined(t,"context"),o.Validate.isNotNullOrUndefined(r,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedGetCachedData(t.instanceId,e._calculateHash(r))},e.prototype.setCachedData=function(t,r,a){o.Validate.isNotNullOrUndefined(t,"context"),o.Validate.isNotNullOrUndefined(r,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedSetCacheData(t,e._calculateHash(r),a&&JSON.stringify(a))},e.prototype.deleteUnmatchedCacheEntries=function(e){var t=this;this._mySiteWebPartCacheDataProvider.hasFlushCompleted?this._deleteEntries(e):this._mySiteWebPartCacheDataProvider.initializeFromLateFlush.then(function(){t._deleteEntries(e)}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"DeleteEntries")})},e.prototype._deleteEntries=function(e){var t,r=this,a="deleteExtraCacheEntries";d._PerformanceLogger.startMarkForComponent(a);var n=new s._QosMonitor("MySiteWebPartCacheDataManager."+a),i=Object.keys((null===(t=window._spWebPartData)||void 0===t?void 0:t.Items)||[]).filter(function(t){return e.indexOf(t)<0});if(0===i.length)return n.writeSuccess(this._getLogObject(0)),void s._TraceLogger.logVerbose(this._logSource,"No extra cache entries to clear");var o=N.getPersonalCacheItemCreateUrl(this._mySiteWebPartCacheDataProvider.currentWebAbsoluteUrl),c=N.getReadPersonalCacheItemBody(this._mySiteWebPartCacheDataProvider.currentListRelativeFolderPath,i,this._mySiteWebPartCacheDataProvider.mySiteAbsoluteUrl);N.post(this._spHttpClient,o,c,N.checkStatus).then(function(e){return e.json()}).then(function(e){var t=e.value,a=N.getPersonalCacheItemDeleteUrl(r._mySiteWebPartCacheDataProvider.currentWebAbsoluteUrl);if(j.isActivated())t=t.filter(function(e){return void 0===e.AltTitle});else if(0===(t=t.filter(function(e){return!e.AltTitle})).length)return s._TraceLogger.logVerbose(r._logSource,"No extra cache entries to clear"),Promise.resolve(t);var n=N.getUpdatePersonalCacheItemsBody(t,r._mySiteWebPartCacheDataProvider.mySiteAbsoluteUrl,!0);return j.isActivated()?N.post(r._spHttpClient,a,n,N.checkStatus):N.post(r._spHttpClient,a,n,N.checkStatus).then(function(e){return e.json()}).then(function(e){return s._TraceLogger.logVerbose(r._logSource,"Cleared "+e.length+" entries"),e})}).then(function(e){return j.isActivated()?e.json():e}).then(function(e){if(j.isActivated())n.writeSuccess(r._getLogObject(i.length)),d._PerformanceLogger.endMarkForComponent(a),s._TraceLogger.logVerbose(r._logSource,"Cleared "+e.length+" entries");else{var t=e&&e.length||0;n.writeSuccess(r._getLogObject(t)),d._PerformanceLogger.endMarkForComponent(a)}}).catch(function(e){n.writeUnexpectedFailure("DeleteExtraCacheError",e),d._PerformanceLogger.endMarkForComponent(a)})},e.prototype._getLogObject=function(e){return{extraItemCount:e}},e.serviceKey=o.ServiceKey.create("sp-component-utilities:MySiteWebPartCacheManager",e),e}(),B={Append:0,Replace:1,Compare:2},V=new l.KillSwitch("4edae48c-3b13-49f4-9d36-ae20f68406f4"),z=function(e){function t(){var t=e.call(this)||this;return t.rendersRequested=0,t.rendersCompleted=0,t.failedRendersCompleted=0,t._handleThemeChangedEvent=function(e){t._emphasisTheme=e.theme,t.render()},t._disableDataRequest=!1,t._isSelectedLayoutLogged=!1,t}return Object(a.__extends)(t,e),t._isOAuthUtilityError=function(e){var t=Object.getPrototypeOf(e);return t.constructor&&"OAuthUtilityError"===t.constructor.name},t._getContextLogSource=function(e){var t=e&&e.webPartTag;return s._LogSource.create(t||"BaseCollectionWebPart")},Object.defineProperty(t.prototype,"component",{get:function(){return this._component},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeLayoutInfo",{get:function(){return this._activeLayoutInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeDataProviderInfo",{get:function(){return this._activeDataProviderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isContributor",{get:function(){var e=this.context.pageContext.web.permissions;return!!e&&e.hasPermission(D.SPPermission.addListItems)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sectionBackgroundTheme",{get:function(){return this._emphasisTheme},enumerable:!1,configurable:!0}),t.prototype.updateActiveLayoutProp=function(e,t){this._activeLayoutInfo.properties[e]=t},t.prototype.onInit=function(){var e=this;this._response=[],this._options=this.options;var r=new d._QosMonitor(this._options.qosPrefix+"Mount");return this._shouldUseLegacyMySiteWebPartCache()||Object(C.b)()||(d._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,d._PerformanceFlight.WEXTieredCaching),d._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,d._PerformanceFlight.WEXMySiteCacheMangementTieredCaching),d._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,d._PerformanceFlight.WEXUseIndexedDBTieredCaching),d._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,d._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp),d._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,d._PerformanceExperiment.WEXMySiteCacheTieredCachingExp),d._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,d._PerformanceExperiment.WEXTieredCachingLateFlushExp),d._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,d._PerformanceExperiment.WEXTieredCachingCacheAndNetwork)),this._onComponentMounted=this._onComponentMounted.bind(this),this.setDefaultProperties(this.properties),this._layoutInfos=this.layouts,this._setSelectedLayout(),this._setSelectedDataProvider(),this._getDisplayFieldMaps(),this._activeLayoutInfo.hasInitialLoadingState&&this.render(),new Promise(function(a,n){var i=e.context.serviceScope;i.whenFinished(function(){e.pageContext=i.consume(D.PageContext.serviceKey),e._shouldUseLegacyMySiteWebPartCache()&&(e._mySiteCacheWebPartManager=i.consume(k.serviceKey)),e._setPageContextVariables(),e._async=new c.Async(e);var n,o=void 0===e._options.delayBeforeNoResultsMessage?500:e._options.delayBeforeNoResultsMessage;e.delayedGetDataAndRender=e._async.debounce(e.refreshData,o);var h,u=e.getPrefetchedData(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),p=e.context,f=p.instanceId,_=p.manifest,m=p.webPartTag;if(void 0!==u)h="bcwpPrefetchedData",n=new Promise(function(e){return d._PerformanceLogger.markComponent(m,"prefetchedData"),d._PerformanceLogger.markComponent(m,"CacheHit"),e(u)});else if(e._shouldUseLegacyMySiteWebPartCache()){h="bcwpCachedDataRequest";var g=e.dataCacheConfiguration,b={requestData:e.requestData.bind(e),dataUpdated:e.setResponseAndRender.bind(e),webPartInstanceId:f,webPartAlias:_.alias,secondsToInvalidate:void 0};if(E.isMySiteCacheSmartRaceRefactorEnabled()){var y="BaseCollection_"+m;d._PerformanceLogger.markComponent(y,"LKGRequest");var v=b;v.serializedConfiguration=JSON.stringify(g),n=e._mySiteCacheWebPartManager.requestWebPartCacheData(v).then(function(t){return e._isResponseFromCache=t.cacheResponseType===l.CacheResponseType.CachedData,V.isActivated()?t.cacheResponseAsync||t.serverResponseAsync:(t.cacheResponseAsync||t.serverResponseAsync).then(function(t){var r=new s._LogEntry("MySiteCacheDataMetrics","CacheDataSize",s._LogType.Event,{dataSizeInKB:t?""+JSON.stringify(t).length/1024:"0",dataProvider:e._activeDataProviderInfo.id,isCacheHit:""+e._isResponseFromCache,numberOfItems:t?""+t.length:"0"});return s._EngagementLogger.logEventWithLogEntry(r),t})}).then(function(e){return d._PerformanceLogger.markComponent(y,"DataReturned"),e})}else{var P=b;P.config=g,P.webPartTag=m,n=e._mySiteCacheWebPartManager.requestWebPartCacheData_deprecated(P)}}else h="bcwpRacePrefetchedDataAsync",e._shouldUseLegacyMySiteWebPartCache()&&(d._PerformanceLogger.markComponent(m,"CacheMiss"),d._PerformanceLogger.markComponent(m,"LateFlush")),n=Promise.race([e._getPrefetchedDataAsync(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),e.requestData()]);var C=t._getContextLogSource(e.context);h&&s._TraceLogger.logVerbose(C,h+".start"),n.then(function(t){e._shouldUseLegacyMySiteWebPartCache()&&"2.0"===e._mySiteCacheWebPartManager.getCacheItemVersion(e.context.instanceId)&&(t=e.postProcessTieredCachedData(t)),e._response=t,h&&s._TraceLogger.logVerbose(C,h+".end"),e.renderedOnce||r.writeSuccess(),a()}).catch(function(t){e._handleRequestDataError(t),h&&s._TraceLogger.logError(C,t,h+".end"),r.writeUnexpectedFailure("FailedInitialDataRequest",t),a()})})}).then(function(){return e._getEmphasisTheme()})},t.prototype.postProcessTieredCachedData=function(e){return e},t.prototype.setLayoutById=function(e){this.properties.layoutId=e,this._setSelectedLayout()},t.prototype.setLayoutByKey=function(e){for(var t=0,r=this._layoutInfos;t<r.length;t++){var a=r[t];if(a.option&&a.option.key===e){this.setLayoutById(a.id);break}}},t.prototype.getPrefetchedData=function(e,t){},t.prototype.getPrefetchedDataAsync=function(e,t){return new Promise(function(e,t){})},Object.defineProperty(t.prototype,"dataProvider",{get:function(){var e=this;return new Promise(function(t,r){e._activeDataProviderInfo.dataProvider?t(e._activeDataProviderInfo.dataProvider):e._activeDataProviderInfo.loadDataProvider(e._activeDataProviderInfo.options||{serviceScope:e.context.serviceScope,qosPrefix:e._options.qosPrefix}).then(function(r){e._activeDataProviderInfo.dataProvider=r,t(r)},function(e){r(e)})})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usingEmptyStateRows",{get:function(){return this._usingEmptyStateRows},enumerable:!1,configurable:!0}),t.prototype.onAfterPropertiesUpdatedExternally=function(e){var t=this,r=e.title,n=e.layoutId,i=e.hideWebPartWhenEmpty,o=e.addToPageScreenReaderLabel,s=Object(a.__rest)(e,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]),c=this.properties,l=c.title,u=c.layoutId,p=c.hideWebPartWhenEmpty,f=c.addToPageScreenReaderLabel,_=Object(a.__rest)(c,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]);if(!h.isEqual(s,_)||r===l&&n===u&&i===p&&o===f){if(e.dataProviderId!==this.properties.dataProviderId&&this.setDataProviderById(this.properties.dataProviderId),!h.isEqual(s,_)){var m=new d._QosMonitor("BaseCollectionWebPart.onAfterPropertiesUpdatedExternally");this.refreshData().then(function(e){var r={alias:""+t.context.manifest.alias};e?m.writeSuccess(r):m.writeUnexpectedFailure("Failed to refreshData",void 0,r)})}}else this.render()},t.prototype.setDataProviderById=function(e){this.properties.dataProviderId=e,this._setSelectedDataProvider()},t.prototype.setDataProviderByKey=function(e){for(var t=0,r=this.dataProviders;t<r.length;t++){var a=r[t];if(a.option&&a.option.key===e){this.setDataProviderById(a.id);break}}},t.prototype.getDisplayFieldMap=function(e,t){},Object.defineProperty(t.prototype,"propertyPaneLayoutOptions",{get:function(){return this._layoutInfos.map(function(e){var t=e.option;return{ariaLabel:t.ariaLabel,imageSize:{width:32,height:32},imageSrc:t.imageSrc,key:t.key,text:t.title,themableSvg:t.themableSvg,iconProps:t.iconProps}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCacheConfiguration",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.refreshData=function(e,t,r){var a=this;return void 0===t&&(t=B.Replace),void 0===r&&(r=!0),this.requestData(e).then(function(e){var n;switch(t){case B.Append:n=a._response=a._response.concat(e);break;case B.Compare:n=e;break;case B.Replace:default:n=a._response=e}return r&&a.render(),Promise.resolve(n)}).catch(function(e){return a._handleRequestDataError(e),Promise.resolve(void 0)})},t.prototype.transposeRow=function(e,t,r){return r},t.prototype.transposeItems=function(e,t,r){return r},t.prototype.render=function(){var e=this,t=new d._QosMonitor(this._options.qosPrefix+"Render"),r={alias:this._options.qosPrefix};if(!this._activeLayoutInfo){var s=new Error(x.g);return this._handleRenderLayoutError(s),t.writeUnexpectedFailure("FailedNoLayout",s,r),void this.renderCompleted()}r.layout=this._activeLayoutInfo.id,this.rendersRequested++,this.onPreRender(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,this._response).then(function(s){var l;s&&(e._options=Object(a.__assign)(Object(a.__assign)({},e._options),s));var h=e.context.webPartTag;d._PerformanceLogger.markComponent(h,""+d._PerformanceDataDimensions.Layout+e.activeLayoutInfo.id);var u=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e._options),e.properties),(null===(l=e._activeLayoutInfo)||void 0===l?void 0:l.properties)||{});if(u.webPartTag=h,u.emphasisTheme=e._emphasisTheme,u.emphasisTheme||(u.emphasisTheme=Object(c.getTheme)()),E.isMySiteCacheSmartRaceRefactorEnabled()&&(u.isRenderedFromCacheData=e._isResponseFromCache),u.isInTeamsContext=!!e.context.microsoftTeams,u.hasInitialLoadingState=e._activeLayoutInfo.hasInitialLoadingState,u.displayMode=e.displayMode,u.errorCallback=e._handleRenderLayoutError.bind(e),u.renderedOnce=e.renderedOnce,u.defaultTitle=e.defaultTitle,u.layoutInfo=e._activeLayoutInfo,u.width=e.width,u.registerEvent=function(t,r){return o._SPEventManager.instance.registerEvent(t,e,r)},u.unregisterEvent=function(t,r){return o._SPEventManager.instance.unregisterEvent(t,e,r)},e._activeLayoutInfo.displayFieldMaps&&(u.displayFieldMap=e._activeLayoutInfo.displayFieldMaps[e._activeDataProviderInfo.id]),u.items=void 0,u.onComponentMounted=e._onComponentMounted,u.onTitleChange=function(t){return e.properties.title=t},E.isHideEmptyWebPartsEnabled()&&(u.changeVisibility=function(t){return e.isVisible=t}),e._activeLayoutInfo.displayFieldMaps&&e._activeDataProviderInfo){var p=e._activeLayoutInfo.displayFieldMaps[e._activeDataProviderInfo.id];p&&(u.displayFieldMap=p,e._response?u.items=p.transpose(e._response,function(t){return e.transposeRow(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,t)}):u.items=[])}u.items||(e._response?u.items=e._response.map(function(t){return e.transposeRow(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,t)}):u.items=[]),u.items=e.transposeItems(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,u.items);try{var f=n.createElement(L,u);e._component=i.render(f,e.domElement),e.renderedOnce||!e._component||e.renderedFromPersistedData||e._component.focusOnTitle(),e.onPostRender(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,e._response).then(function(){t.writeSuccess(r)}).catch(function(e){t.writeUnexpectedFailure("FailedPostRender",e,r)})}catch(a){r.stack=a.stack,t.writeUnexpectedFailure("FailedRender",a,r),e.failedRendersCompleted++}e.rendersCompleted++,C.a.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||d._PerformanceLogger.saveTempData(h+".postRenderComplete",d._PerformanceLogger.now())}).catch(function(a){e._handleRenderLayoutError(a),t.writeUnexpectedFailure("FailedPreRender",a,r),e.renderCompleted()})},t.prototype.onPreRender=function(e,t,r){return Promise.resolve(void 0)},t.prototype.onPostRender=function(e,t,r){return Promise.resolve(void 0)},t.prototype.onBeforeSerialize=function(){this.properties.title&&(this.properties.title=this.properties.title.trim())},t.prototype.onDispose=function(){i.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(T.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),e.prototype.onDispose.call(this)},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},baseUrl:{isLink:!0},layoutComponentId:{isComponentDependency:!0}}},enumerable:!1,configurable:!0}),t.prototype.onDiscard=function(){var e=this;this.refreshData().catch(function(r){return s._TraceLogger.logError(t._getContextLogSource(e.context),r,"RefreshData")})},t.prototype.setDefaultProperties=function(e){},Object.defineProperty(t.prototype,"defaultTitle",{get:function(){return x.i},enumerable:!1,configurable:!0}),t.prototype.getEmptyStateRows=function(e,t){},t.prototype.setResponse=function(e){this._response=e},t.prototype.setResponseAndRender=function(e){E.isMySiteCacheSmartRaceRefactorEnabled()&&(this._isResponseFromCache=!1),this._response=e,this.render()},t.prototype.requestData=function(e){var r=this,a=this.context.webPartTag,n=t._getContextLogSource(this.context);return this._disableDataRequest||s._TraceLogger.logVerbose(n,"bcwpRequestData.start"),new Promise(function(i,o){if(r._disableDataRequest)return s._TraceLogger.logVerbose(n,"bcwpRequestData.end"),void i([]);if(r._activeDataProviderInfo){var c=new d._QosMonitor(r._options.qosPrefix+"RequestData");s._TraceLogger.logVerbose(n,"bcwpDataProvider.start"),r.dataProvider.then(function(l){d._PerformanceLogger.markComponent(a,""+d._PerformanceDataDimensions.DataProvider+l.id),s._TraceLogger.logVerbose(n,"bcwpDataProvider.end"),e=e||r.getRequest(r._activeDataProviderInfo.id,r._activeLayoutInfo.id),l.requestData(e).then(function(e){if(r._usingEmptyStateRows=!1,!e||0===e.length){r._usingEmptyStateRows=!0;var t=r.getEmptyStateRows(r._activeLayoutInfo.id,l.id);t&&(e=t)}i(e),s._TraceLogger.logVerbose(n,"bcwpRequestData.end"),c.writeSuccess()},function(e){r.context.statusRenderer.clearLoadingIndicator(r.domElement),s._TraceLogger.logVerbose(n,"bcwpRequestData.end"),c.writeUnexpectedFailure("FailedDataRequest",e),t._isOAuthUtilityError(e)&&r.canHandleOAuthError(e)?(r.render(),i(void 0)):o(e)})},function(e){d._PerformanceLogger.markComponent(a,"bcwpDataProvider.end"),c.writeUnexpectedFailure("FailedToLoadDataProvider",e),o(e)})}else s._TraceLogger.logVerbose(n,"bcwpRequestData.end"),o(new Error(x.f))})},t.prototype.disableDataRequest=function(){this._disableDataRequest=!0},t.prototype.enableDataRequest=function(){this._disableDataRequest=!1},t.prototype.canHandleOAuthError=function(e){return!1},t.prototype.canHandleWebpartError=function(e){return!1},t.prototype.onPropertyPaneConfigurationComplete=function(){e.prototype.onPropertyPaneConfigurationComplete.call(this),this.properties.layoutId&&this._addBCWPSelectedLayoutEngagementLog(this.properties.layoutId)},t.prototype._handleRenderLayoutError=function(t){this.canHandleWebpartError(t)||e.prototype.renderError.call(this,t)},t.prototype._handleRequestDataError=function(e){t._isOAuthUtilityError(e)&&this.canHandleOAuthError(e)?this.render():this.renderError(e)},t.prototype._setPageContextVariables=function(){if(this._options.requirePageContextVariables){if(!this.pageContext)throw new Error(x.a);if(!this.pageContext.web)throw new Error(x.d);if(this.pageContext.web.absoluteUrl){if(!this.pageContext.web.id)throw new Error(x.e);if(this.properties.webId=this.pageContext.web.id.toString(),!this.pageContext.site)throw new Error(x.b);if(!this.pageContext.site.id)throw new Error(x.c);this.properties.siteId=this.pageContext.site.id.toString(),this.properties.baseUrl=this.pageContext.web.absoluteUrl}else this.properties.webId="a50ff2b3-f789-4251-aad1-5909f23aed4f",this.properties.baseUrl="https://msft.spoppe.com/sites/wex"}},t.prototype._setSelectedLayout=function(){!this.properties.layoutId&&this._layoutInfos.length>0&&(this.properties.layoutId=this._layoutInfos[0].id,this.properties.layoutComponentId=this._layoutInfos[0].componentId);var e=this.properties.layoutId;if(e)for(var t=0,r=this._layoutInfos;t<r.length;t++){var a=r[t];if(a.id===e){this._activeLayoutInfo=a,this.properties.layoutComponentId=this._activeLayoutInfo.componentId;break}}},t.prototype._addBCWPSelectedLayoutEngagementLog=function(e){if(!this._isSelectedLayoutLogged){var t={component:"BaseWPSelectedLayout",extraData:{layoutId:e},feature:"WebPart",name:this.context.manifest.alias+".BCWPSelectedLayout"};s._EngagementLogger.log(t),this._isSelectedLayoutLogged=!0}},t.prototype._setSelectedDataProvider=function(){if(!this.properties.dataProviderId&&this.dataProviders.length>0&&(this.properties.dataProviderId=this.dataProviders[0].id,this.properties.dataProviderComponentId=this.dataProviders[0].componentId),this.properties.dataProviderId)for(var e=0,t=this.dataProviders;e<t.length;e++){var r=t[e];if(r&&r.id===this.properties.dataProviderId){this._activeDataProviderInfo=r;break}}},t.prototype._getDisplayFieldMaps=function(){var e=this;this._layoutInfos.map(function(t){t.displayFieldMaps||(t.displayFieldMaps={}),e.dataProviders.map(function(r){r&&(t.displayFieldMaps[r.id]=e.getDisplayFieldMap(t.id,r.id))})})},t.prototype._getEmphasisTheme=function(){var e=this.context.serviceScope.consume(T.ThemeProvider.serviceKey);this._emphasisTheme=e.tryGetTheme(),e.themeChangedEvent.add(this,this._handleThemeChangedEvent)},t.prototype._onComponentMounted=function(){this.options.isRenderAsync||this.renderCompleted()},t.prototype._getPrefetchedDataAsync=function(e,r){var a=this,n="bcwpGetPrefetchedDataAsync",i=t._getContextLogSource(this.context);return s._TraceLogger.logVerbose(i,n+".start"),this.getPrefetchedDataAsync(e,r).then(function(e){return s._TraceLogger.logVerbose(i,n+".end"),d._PerformanceLogger.markComponent(a.context.webPartTag,"prefetchedData"),Promise.resolve(e)}).catch(function(e){return s._TraceLogger.logVerbose(i,n+".end"),Promise.reject(e)})},t.prototype._shouldUseLegacyMySiteWebPartCache=function(){return this._options.deprecated_canCacheResults&&!(this._options.temporary_isTieredCacheImplementedInDataProvider&&E.isTieredCachingEnabled())},t}(I.BaseClientSideWebPart),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(function(e){function t(t){var r=e.call(this,t)||this;return r._cacheManager=t.serviceScope.consume(k.serviceKey),r}return Object(a.__extends)(t,e),t.prototype.requestData=function(e){return o.Validate.isNotNullOrUndefined(e,"request"),o.Validate.isNotNullOrUndefined(e.fetchData,"request.fetchData"),o.Validate.isNotNullOrUndefined(e.dataReceived,"request.dataReceived"),o.Validate.isNonemptyString(e.cacheKey,"request.cacheKey"),o.Validate.isNonemptyString(e.alias,"request.alias"),this._cacheManager.requestWebPartCacheData_deprecated({requestData:e.fetchData,dataUpdated:e.dataReceived,config:e.cacheParameters,webPartInstanceId:e.cacheKey,webPartAlias:e.alias,webPartTag:e.alias})},t}(function(e){o.Validate.isNotNullOrUndefined(e,"configuration"),o.Validate.isNotNullOrUndefined(e.serviceScope,"configuration.serviceScope"),this.configuration=e})),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._internalDataReceived=function(e){t.dataReceived({data:e,metadata:{}})},t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"dataProviderConfiguration",{get:function(){return{serviceScope:this.context.serviceScope}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataProvider",{get:function(){return this._dataProvider||(this._dataProvider=new q(this.dataProviderConfiguration)),this._dataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheKey",{get:function(){return this.context.instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alias",{get:function(){return this.context.manifest.alias},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheParameters",{get:function(){return this.properties},enumerable:!1,configurable:!0}),t.prototype._internalGetData=function(){var e={fetchData:this.fetchData,dataReceived:this._internalDataReceived,cacheKey:this.cacheKey,alias:this.alias,cacheParameters:this.cacheParameters,webPartTag:this.context&&this.context.webPartTag};return this.dataProvider.requestData(e).then(function(t){e.dataReceived({data:t,metadata:{}})})},t}(I.BaseClientSideWebPart),H=r("Ycni");function G(e,t){return!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}var J=r("edZz");g.loadStyles('.o_c_658c9e0a{font-weight:400;border:1px solid;color:"[theme:neutralPrimary, default: #323130]";display:flex;flex-direction:column;align-items:center;text-align:center}.o_c_658c9e0a.p_c_658c9e0a{height:62px;width:62px}.o_c_658c9e0a.q_c_658c9e0a{height:80px;width:80px}.o_c_658c9e0a.r_c_658c9e0a{height:104px;width:104px}.o_c_658c9e0a.s_c_658c9e0a{justify-content:center}.o_c_658c9e0a.t_c_658c9e0a{justify-content:space-between}.p_c_658c9e0a .u_c_658c9e0a:not(.f_c_658c9e0a){font-size:12px;font-weight:400}.q_c_658c9e0a .u_c_658c9e0a:not(.f_c_658c9e0a){font-size:15px;font-weight:400}.r_c_658c9e0a .u_c_658c9e0a:not(.f_c_658c9e0a){font-size:21px;font-weight:100}.p_c_658c9e0a .u_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.q_c_658c9e0a .u_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.r_c_658c9e0a .u_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]";font-weight:600}.v_c_658c9e0a{font-weight:600}.p_c_658c9e0a .v_c_658c9e0a:not(.f_c_658c9e0a){font-size:21px}.r_c_658c9e0a .v_c_658c9e0a:not(.f_c_658c9e0a),.q_c_658c9e0a .v_c_658c9e0a:not(.f_c_658c9e0a){font-size:28px}.p_c_658c9e0a .v_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.r_c_658c9e0a .v_c_658c9e0a.f_c_658c9e0a,.q_c_658c9e0a .v_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]"}.w_c_658c9e0a{flex-grow:1;display:flex;flex-direction:column;justify-content:center}.p_c_658c9e0a .w_c_658c9e0a:not(.f_c_658c9e0a){font-size:10px;font-weight:600}.q_c_658c9e0a .w_c_658c9e0a:not(.f_c_658c9e0a){font-size:12px;font-weight:400}.r_c_658c9e0a .w_c_658c9e0a:not(.f_c_658c9e0a){font-size:15px;font-weight:400}.p_c_658c9e0a .w_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:xSmallFontSize, default: 10px]";font-weight:"[theme:xSmallFontWeight, default: 400]";font-weight:600}.q_c_658c9e0a .w_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.r_c_658c9e0a .w_c_658c9e0a.f_c_658c9e0a{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.x_c_658c9e0a{margin:0;border:0;border-bottom:1px solid}.p_c_658c9e0a .x_c_658c9e0a{width:31px}.q_c_658c9e0a .x_c_658c9e0a{width:40px}.r_c_658c9e0a .x_c_658c9e0a{width:52px}',!0);var Z=r("EpOV"),Q={Small:0,Medium:1,Large:2},X={0:"p_c_658c9e0a",1:"q_c_658c9e0a",2:"r_c_658c9e0a"},Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.startDate,r=e.endDate;return this._sizeClassName=h.get(X,this.props.size),t&&r&&!G(t,r)?this._multipleDaysDateBoxElement:this._singleDayDateBoxElement},Object.defineProperty(t.prototype,"_singleDayDateBoxElement",{get:function(){var e=this.props,t=e.startDate,r=e.endDate,a=e.formatMonth,i=e.formatDay,o=t||r,s=o?a(o):Z.a,l=o?i(o):"01",d=Object(J.a)("EventsWebPart");return n.createElement("div",{className:Object(c.css)("o_c_658c9e0a","s_c_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"singleDayBox"},n.createElement("div",{className:Object(c.css)("u_c_658c9e0a",d&&"f_c_658c9e0a"),"data-automation-id":"singleDayMonthContainer"},s),n.createElement("div",{className:Object(c.css)("v_c_658c9e0a",d&&"f_c_658c9e0a"),"data-automation-id":"singleDayDayContainer"},l))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_multipleDaysDateBoxElement",{get:function(){var e=this.props,t=e.startDate,r=e.endDate,a=e.formatDate,i=Object(J.a)("EventsWebPart");return n.createElement("div",{className:Object(c.css)("o_c_658c9e0a","t_c_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"multipleDayBox"},n.createElement("div",{className:Object(c.css)("w_c_658c9e0a",i&&"f_c_658c9e0a"),"data-automation-id":"multipleDayStartDateContainer"},a(t)),n.createElement("hr",{className:"x_c_658c9e0a"}),n.createElement("div",{className:Object(c.css)("w_c_658c9e0a",i&&"f_c_658c9e0a"),"data-automation-id":"multipleDayEndDateContainer"},a(r)))},enumerable:!1,configurable:!0}),t.defaultProps={formatDate:function(e){return H.LocaleFormat.formatDate(e,{skeleton:"MMMd"}).toUpperCase()},formatMonth:function(e){return H.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase()},formatDay:function(e){return H.LocaleFormat.formatDate(e,{skeleton:"d"})}},t}(n.PureComponent),$=r("GrTz");function ee(e,t){return t||(e=-e),new Date(Date.now()+e)}function te(e){var t=e.split("|");if("0"===t[0])return t[1];var r="1"===t[1],a=t[2],n=t.length>=4?t[3]:void 0,i=Number(n),s=t.length>=5?t[4]:void 0;switch(a){case"1":return H.LocaleFormat.formatRelativeTimeApproximate(ee(1e3,r));case"2":return H.LocaleFormat.formatRelativeTimeApproximate(ee(6e4,r));case"3":return H.LocaleFormat.formatRelativeTime(r?i:-i,"minute");case"4":return H.LocaleFormat.formatRelativeTimeApproximate(ee(36e5,r));case"5":var c=H.LocaleFormat.formatRelativeTime(r?1:-1,"day");return n?o.Text.format($.a,c,n):c;case"6":return H.LocaleFormat.formatRelativeTimeApproximate(ee(36e5*i,r));case"7":return s?o.Text.format($.a,n,s):n;case"8":return H.LocaleFormat.formatRelativeTime(r?i:-i,"day");case"9":return H.LocaleFormat.formatRelativeTime(0,"day")}}var re=function(){function e(e,t,r){this._target=e,this._displayField=t,this._onRenderCell=r}return Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sources",{get:function(){return this._displayField.sources||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkUrls",{get:function(){return this._displayField.linkUrls||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heading",{get:function(){return this._displayField.heading||""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return void 0===this._displayField.width||null===this._displayField.width?100:this._displayField.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRenderCell",{get:function(){return this._onRenderCell},enumerable:!1,configurable:!0}),e}(),ae=function(e){function t(t,r,a,n){var i=e.call(this,t,r,n)||this;return i._formatter=a,i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"formatter",{get:function(){return this._formatter},enumerable:!1,configurable:!0}),t}(re),ne="_linkUrl",ie=function(){function e(e){this._map=e}return e.prototype.fieldValue=function(e,t){return e instanceof ae?e.formatter(t):this._firstIdentifiedValue(t,e.sources)},e.prototype.fieldLinkUrl=function(e,t){return this._firstIdentifiedValue(t,e.linkUrls)},e.prototype.transposeRow=function(e,t){if(!e)return e;var r=t?t(e):e,a={};if(this._map)for(var n=0;n<this._map.length;n++){var i=this._map[n];a[i.target]=this.fieldValue(i,r),i.linkUrls&&(a[i.target+ne]=this.fieldLinkUrl(i,r))}return a},e.prototype.transpose=function(e,t){for(var r=[],a=0;a<e.length;a++)r[a]=this.transposeRow(e[a],t);return r},Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0}),e.prototype._firstIdentifiedValue=function(e,t){for(var r=0;r<t.length;r++){var a=t[r],n=e[a];if(null!=n&&""!==n)return e[a]}},e}(),oe=function(){function e(){}return e.prototype.getClassNames=function(e,t){return void 0===t&&(t=!0),!t&&this._cachedClassNames||(this._cachedClassNames=Object(c.classNamesFunction)()(this.getStyles,e)),this._cachedClassNames},e}();function se(e){"aspx"===(l.ExtensionHelper.getExtension(new f.Uri(e))||"")||o._SPFlight.isEnabled(1374)&&o._BrowserUtilities.isTeamsHosted()?postMessage("router://"+e,location.origin):window.open(e,ce(e))}function ce(e){return le(e)?"_blank":"_self"}function le(e){if(!e)return!1;var t=new f.Uri(e).getHost();return Boolean(t)&&t.toLocaleLowerCase()!==window.location.host.toLowerCase()}var de=r("8dK2");function he(e){var t=e.pageContext,r=e.url,a=e.siteId,n=e.webId,i=e.uniqueId,s=e.callerId,c=e.originalWidth,d=e.originalHeight;if(r&&0!==r.indexOf("/_LAYOUTS/IMAGES/")){var h=l.ExtensionHelper.getExtension(new l.SPResourcePath(r))||"";if(l.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(h,void 0)||"gif"===h){var u;switch(de._ThumbnailUrlGenerator.getThumbnailProvider(r)){case de._ThumbnailProviderType.SPOLayoutsImage:u=r;break;case de._ThumbnailProviderType.PrivateCDN:case de._ThumbnailProviderType.AFDPrivateCDN:case de._ThumbnailProviderType.MeTA:case de._ThumbnailProviderType.Stock:case de._ThumbnailProviderType.VROOMMeTACache:return;case de._ThumbnailProviderType.HubbleStockThumbnail:u=r;break;case de._ThumbnailProviderType.HubbleStock:u=de._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:r,spResource:r,width:400,callerId:s});break;case de._ThumbnailProviderType.PublicCDN:case de._ThumbnailProviderType.MediaCDNHubble:u=de._ThumbnailUrlGenerator.updateThumbnailWidth(r,400)}if((null==u?void 0:u.length)<=255)return u;var p,_=t&&t.web.absoluteUrl||window.location.href,m=new f.Uri(_),g=m.getLeftPart(1),b=!!(a&&n&&i),y=!(t&&t.web&&t.web.serverRelativeUrl&&r)||-1===r.toUpperCase().indexOf(t.web.serverRelativeUrl.toUpperCase());if((o._SPFlight.isEnabled(60134)||!b)&&r&&!y){var v=ue(r,g,y,t),P=new f.Uri(v);P.getHost().toUpperCase()===m.getHost().toUpperCase()&&(b=!!(p=P.getPath()))}return b&&(u=l.PreviewHelper.getPreviewImageUrl(h,void 0,g,p,a,n,i,void 0,!0,s,c,d))&&u.length<=255||(u=ue(r,g,y,t)).length<=255?u:void 0}}}function ue(e,t,r,a){var n=a&&a.web.absoluteUrl,i=""!==new f.Uri(e).getHost(),o=r?t:n,s=r?e:e.substr(a.web.serverRelativeUrl.length);return i?e:f.Uri.concatenate(o,s)}var pe=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad"]),fe="DoughboyDetector",_e=function(e){function t(r){var a=e.call(this,r)||this;a._unmounted=!1,a._completeDetection=function(){a.props.onDetectCompleted&&a.props.onDetectCompleted()},a.revokeBlobUrl=function(){a._blobUrl&&(URL.revokeObjectURL(a._blobUrl),a._blobUrl=void 0)},a._logSource=s._LogSource.create("DoughboyDetector");var n=t._imageDataCache.get(r.imageUrl);return a.state={imageData:n},a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(function(){e._resolveImage(e.props.imageUrl).then(e._completeDetection,e._completeDetection)},7e3)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var r=this;if(this.props.imageUrl!==e.imageUrl){var a=t._imageDataCache.get(e.imageUrl);a?this.setState({imageData:a}):this._resolveImage(e.imageUrl).catch(function(e){return s._TraceLogger.logError(r._logSource,e,"ResolveImage")})}},t.prototype.componentWillUnmount=function(){this._unmounted=!0,this.revokeBlobUrl()},t.prototype.render=function(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)},t.prototype._resolveImage=function(e){var r=this;return new Promise(function(a,n){var i=document.createElement("img");i.onload=function(){var o=r._getImageBase64(i),c=Object(l.Md5Hash)(o);if(pe.has(c))s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("DoughboyDetector","IsDoughboyImage",s._LogType.Event,{fingerprint:c})),n(new l.ExpectedFailure("DoughboyImageDetected"));else if(r._unmounted)n(new l.ExpectedFailure("ElementUnmounted"));else{var d="data:image/png;base64,"+o;r.setState({imageData:d}),t._imageDataCache.set(e,d),a()}},i.onerror=function(e){n(new l.ExpectedFailure("DownloadImageFailed",e.error))},o._SPKillSwitch.isActivated("a2a16402-2f33-4194-9f64-0401227d07bd")?i.src=e:r._downloadImageBlob(e).then(function(e){r.revokeBlobUrl(),r._blobUrl=URL.createObjectURL(e),i.src=r._blobUrl}).catch(function(){return i.src=e}),i.crossOrigin="anonymous"})},t.prototype._downloadImageBlob=function(e){var t=this;return new Promise(function(r,a){var n,i=o._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f"),c=o._SPKillSwitch.isActivated("c35327da-fc63-4bfa-b0b5-f821d8d61a6d"),d=new XMLHttpRequest;d.open("GET",e),d.responseType="blob";var h="";if(!i){var u=e.toLowerCase();h=u.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":u.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?"AFDCDNUserPhoto":u.indexOf("https://privatecdn")>-1&&u.indexOf("/_userprofile/userphoto.jpg")>-1?"CDNUserPhoto":"Unknown",n=new s._QosMonitor("UserPhotoRenderService."+h)}d.onload=function(){if(d.status>=200&&d.status<300&&d.response){if(!i){var o="CDNUserPhoto"===h||"AFDCDNUserPhoto"===h?d.getResponseHeader("x-cache"):"",s="AFDCDNUserPhoto"===h?d.getResponseHeader("x-ccc"):"",u=d.getResponseHeader("x-cache-origin");n.writeSuccess({service:h,alias:fe,statusCode:d.status,CDNCache:null==o?void 0:o.split(" ")[0],OriginCache:u,cacheCountryCode:s,size:d.response.size,source:d.response.type})}return r(d.response)}var p=d.getResponseHeader("location");if(p&&d.status>=300&&d.status<400)t._downloadImageBlob(p).then(r).catch(a);else{if(!i){var f=new Error("<url>"+Object(l.scrubUrl)(void 0,e)+"</url> <errorCode>"+d.status+"</errorCode>");c||404!==d.status?n.writeUnexpectedFailure(h+" failed",f,{alias:fe,statusCode:d.status}):n.writeExpectedFailure(h+" failed",f,{alias:fe,statusCode:d.status})}a("")}return r(d.response)},d.onerror=function(){if(!i){var t=new Error("<url>"+Object(l.scrubUrl)(void 0,e)+"</url> <errorCode>"+d.status+"</errorCode>");n.writeUnexpectedFailure(h+" failed",t,{alias:fe,headers:d.getAllResponseHeaders()})}a("")},d.send()})},t.prototype._getImageBase64=function(e){var t,r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0);try{t=r.toDataURL("image/png"),this.revokeBlobUrl()}catch(e){return""}return t.replace(/^data:image\/png;base64,/,"")},Object.defineProperty(t.prototype,"_extraProps",{get:function(){var e=this.props;return e.imageUrl,e.imageProps,e.renderImage,e.onDetectCompleted,Object(a.__rest)(e,["imageUrl","imageProps","renderImage","onDetectCompleted"])},enumerable:!1,configurable:!0}),t._imageDataCache=new Map,Object(a.__decorate)([Object(l.monitor)("DoughboyDetector.ResolveImage")],t.prototype,"_resolveImage",null),t}(n.Component);g.loadStyles(".y_e_658c9e0a{word-wrap:break-word!important}",!0);var me=function(e){function t(t){var r=e.call(this,t)||this;return r.update=function(){r._textContainerElementRef.current&&r._async.requestAnimationFrame(r._truncateLines)},r._truncateLines=function(){if(r._textContainerElementRef.current){var e=r.props.text||"";r._textContainerElementRef.current.textContent=e;var t=Math.round(r.props.lines),a=window.getComputedStyle(r._textContainerElementRef.current,void 0).getPropertyValue("line-height"),n=t*parseFloat(a),i=r._contentHeight;r._textArray=e.split("");var o=i>n&&t>0;if(o){var s=r._trimAndCalculateLength(i,n);r._applyTextNumber(s)}o&&r.props.autoShowTitle?r._textContainerElementRef.current.title=e:r._textContainerElementRef.current.removeAttribute("title"),r.props.onAfterTruncate&&r.props.onAfterTruncate(o)}},r._async=new c.Async(r),r._eventGroup=new c.EventGroup(r),r._handleWindowResize=r._async.debounce(r._handleWindowResizeCore,1010),r._textContainerElementRef=n.createRef(),r}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._async.setTimeout(this.update,0),this._eventGroup.on(window,"resize",this._handleWindowResize)},t.prototype.componentDidUpdate=function(){this.update()},t.prototype.componentWillUnmount=function(){this._eventGroup.off(window,"resize",this._handleWindowResize),this._eventGroup.dispose(),this._async.dispose()},t.prototype.render=function(){return n.createElement("div",Object(a.__assign)({},Object(c.getNativeProps)(this.props,c.divProperties),{"data-automation-id":"less-text",ref:this._textContainerElementRef,className:Object(c.css)("y_e_658c9e0a",this.props.className)}),this.props.text)},Object.defineProperty(t.prototype,"_omission",{get:function(){return this.props.omission||"â€¦"},enumerable:!1,configurable:!0}),t.prototype._handleWindowResizeCore=function(){this.update()},Object.defineProperty(t.prototype,"_contentHeight",{get:function(){if(this._textContainerElementRef.current){var e=window.getComputedStyle(this._textContainerElementRef.current),t=0;return e&&e.paddingTop&&e.paddingBottom&&(t=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),this._textContainerElementRef.current.offsetHeight-t}return 0},enumerable:!1,configurable:!0}),t.prototype._trimAndCalculateLength=function(e,t){var r=this._textArray.length;if(!this._textContainerElementRef.current)return r;var a=1,n=r;do{var i=Math.floor((a+n+1)/2);this._applyTextNumber(i),this._contentHeight>t?n=i-1:a=i}while(a<n);return a},t.prototype._applyTextNumber=function(e){var t=this._textArray.slice(0,e).join("");this._textContainerElementRef.current&&(this._textContainerElementRef.current.textContent=this._textContainerElementRef.current.textContent===t?t:t+this._omission)},t}(n.PureComponent);function ge(e,t){void 0===t&&(t=1.35);var r=void 0;if("number"==typeof t)r=e*t+"em";else try{var a=e*Number(t.substr(0,t.length-2));if(isNaN(a))throw"Invalid line height input";r=a+"px"}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:r,textOverflow:1===e?"ellipsis":void 0}}var be=function(){function e(){this._x=0,this._y=0,this._line=1,this._whitespace=/(?!\xA0)\s/,this._hyphen=/\u2010|\u002d|\u00ad/,this._metrics={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!1,configurable:!0}),e.prototype.clampText=function(e){return this._resetCursor(),this._clampText(e)},e.prototype.clampElement=function(e,t,r,a){if(!e)return{text:"",lines:0};var n=e.getBoundingClientRect(),i=Math.round(n.width),o=Math.round(n.height),s=this._getComputedStyle(e);"border-box"===s.boxSizing&&(i-=this._parseInt(s.borderRightWidth)+this._parseInt(s.borderLeftWidth)+this._parseInt(s.paddingRight)+this._parseInt(s.paddingLeft),o-=this._parseInt(s.borderTopWidth)+this._parseInt(s.borderBottomWidth)+this._parseInt(s.paddingTop)+this._parseInt(s.paddingBottom)),window.MSInputMethodContext&&document.documentMode&&--i;var c=parseFloat(s.fontSize),l=1.1*c,d=Math.floor("normal"===s.lineHeight?l:parseFloat(s.lineHeight));if(this._resetCursor(),e.childElementCount&&!r)return this._clampComplexElement(e,i,o,d,t,a);var h=this._clampText({text:r||e.textContent,maxLines:t,ellipsis:a,width:i,height:o,lineHeight:d,style:s.fontStyle||"",variant:s.fontVariant||"",weight:s.fontWeight||"",size:c,family:s.fontFamily||""});return e.textContent=h.text,h},e.prototype._getComputedStyle=function(e){var t="__computedStyle";return e[t]||(e[t]=getComputedStyle(e))},e.prototype._parseInt=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},e.prototype._createCanvas=function(){var e=document.createElement("canvas");return e.width=1,e.height=1,e.getContext("2d")},e.prototype._resetCursor=function(){this._x=0,this._y=0,this._line=1},e.prototype._getFontStyle=function(e,t){return(e.style||"normal")+" "+(e.variant||"normal")+" "+(t||e.weight||"normal")+" "+e.size+"px "+(e.family||"sans-serif")},e.prototype._setFont=function(e){this._context||(this._context=this._createCanvas()),this._font=this._getFontStyle(e),this._numericWeight=parseInt(e.weight,10),(this._isExtendedWeight=!isNaN(this._numericWeight)&&400!==this._numericWeight&&700!==this._numericWeight)?(this._context2||(this._context2=this._createCanvas()),this._context.font=this._getFontStyle(e,"normal"),this._context2.font=this._getFontStyle(e,"bold")):this._context.font=this._font},e.prototype._measureChar=function(e){var t=this._metrics[this._font]||(this._metrics[this._font]={}),r=t[e];if(r)return r;if(r=this._context.measureText(e).width,this._isExtendedWeight){var a=(this._context2.measureText(e).width-r)/3;r-=(400-this._numericWeight)/100*a}return t[e]=r,r},e.prototype._clampText=function(e){var t,r,a=e.text,n=e.width,i=e.height,o=e.lineHeight,s=e.maxLines,c=e.ellipsis,l=void 0===c?"â€¦":c;if(!a||!a.length||!n||!i||i<o||!s)return{text:"",lines:0};this._setFont(e);var d=s===this._line;d&&(this._x+=this._measureChar(l));for(var h=a.length,u=0;u<h;){var p=a[u],f=this._whitespace.test(p);if(r&&f)++u;else{var _=this._measureChar(p);if(this._x+_>n){if(d)return{text:a.substring(0,r?u-1:u)+l,didClamp:!0,lines:this._line};t&&!f?u=t:f&&++u,this._y+=o,d=++this._line===s||this._y+2*o>i,this._x=d?this._measureChar(l):0,t=0}else(f||this._hyphen.test(p))&&(t=u),this._x+=_,++u;r=f}}return{text:a,lines:this._line}},e.prototype._clampComplexElement=function(e,t,r,a,n,i){for(var o,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);o=s.nextNode();){var c=this._getComputedStyle(o.parentElement||o.parentNode),l=this._clampText({text:o.nodeValue,maxLines:n,ellipsis:i,width:t,height:r,lineHeight:a,style:c.fontStyle||"",variant:c.fontVariant||"",weight:c.fontWeight||"",size:parseFloat(c.fontSize),family:c.fontFamily||""});if(l.didClamp){for(o.nodeValue=l.text;o=s.nextNode();)o.parentNode.removeChild(o);return l}}},e}();function ye(e){return be.instance.clampText(e)}function ve(e,t,r,a){return be.instance.clampElement(e,t,r,a)}var Pe=function(e){return ye(e).text};g.loadStyles('.Placeholder{display:flex}.Placeholder.Placeholder--autoHeight .Placeholder-container{height:auto;padding:80px 0}.Placeholder .Placeholder-container{box-sizing:border-box;zoom:1;align-items:center;color:"[theme:neutralSecondary, default: #605e5c]";background-color:"[theme:neutralLighter, default: #f3f2f1]";width:100%;height:326px;padding:80px 0 0}.Placeholder .Placeholder-container:after,.Placeholder .Placeholder-container:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head{margin:0 -8px;box-sizing:border-box;zoom:1;color:"[theme:neutralPrimary, default: #323130]"}.Placeholder .Placeholder-container .Placeholder-head:after,.Placeholder .Placeholder-container .Placeholder-head:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container .Placeholder-head:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-headContainer{height:100%;white-space:nowrap;text-align:center}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-icon{display:inline-block;vertical-align:middle;white-space:normal;font-size:42px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{display:inline-block;vertical-align:middle;white-space:normal;line-height:normal}[dir=ltr] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-left:16px}[dir=rtl] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-right:16px}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.Placeholder-text-fluent){font-size:28px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text.Placeholder-text-fluent{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.ellipsisKillSwitch){max-width:70%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.Placeholder .Placeholder-container .Placeholder-description{box-sizing:border-box;zoom:1;width:65%;vertical-align:middle;margin:0 auto;text-align:center}.Placeholder .Placeholder-container .Placeholder-description:after,.Placeholder .Placeholder-container .Placeholder-description:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container .Placeholder-description:after{clear:both}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText{color:"[theme:neutralSecondary, default: #605e5c]";margin:20px 0 28px;line-height:23px}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-fluent){font-size:17px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-fluent{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-truncate){display:inline-block}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-truncate{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;box-sizing:content-box;max-height:69px;overflow:hidden}.Placeholder .Placeholder-container button{margin:2px 4px}.Placeholder-overlay{position:relative;height:100%;z-index:1}.Placeholder-overlay .Placeholder-spinnerContainer{position:relative;width:100%;margin:164px 0}',!0);var Ce=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._handleWindowResize=function(){t.shouldUseCssClamp||r._processLines()},r}return Object(a.__extends)(t,e),Object.defineProperty(t,"shouldUseCssClamp",{get:function(){return void 0===this._shouldUseCssClamp&&(this._shouldUseCssClamp=o._BrowserDetection.getBrowserInformation().browser!==o._Browser.IE),this._shouldUseCssClamp},enumerable:!1,configurable:!0}),t._isEllipsisOverflowKillSwitchActivated=function(){return o._SPKillSwitch.isActivated(o.Guid.parse("e984b51f-12c9-45ea-abba-2dc3869cdc79"),"2018/3/27","ReplaceOverflowingTitleTextWithEllipsis")},t.prototype.UNSAFE_componentWillMount=function(){this._processLines=this._async.throttle(this._processLines,500)},t.prototype.componentDidMount=function(){this._processLines(),window.addEventListener("resize",this._handleWindowResize)},t.prototype.componentDidUpdate=function(e){this.props.description&&this.props.webpartWidth!==e.webpartWidth&&this._processLines()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},t.prototype.render=function(){var e=this.props,r=e.children,a=e.contentClassName,i=e.description,o=e.icon,s=e.iconText;this._descriptionId="description-"+Math.random().toString();var l=Object(J.a)("Placeholder"),d=Object(c.css)("Placeholder-descriptionText",{"Placeholder-text-fluent":l,"Placeholder-text-truncate":t.shouldUseCssClamp});return n.createElement("div",{className:Object(c.css)("Placeholder",a,{"Placeholder--autoHeight":!!r})},n.createElement("div",{className:"Placeholder-container"},n.createElement("div",{className:"Placeholder-head"},n.createElement("div",{className:"Placeholder-headContainer"},o&&n.createElement(c.Icon,{className:"Placeholder-icon",iconName:o}),n.createElement("span",{className:Object(c.css)("Placeholder-text",{ellipsisKillSwitch:t._isEllipsisOverflowKillSwitchActivated()},{"Placeholder-text-fluent":l})},s))),n.createElement("div",{className:"Placeholder-description"},n.createElement("span",{className:d,id:this._descriptionId,ref:this._resolveRef("_placeholderDescription")},i)),r,n.createElement("div",{className:"Placeholder-description"},this.buttonElement,this._extraButtonElements)))},Object.defineProperty(t.prototype,"buttonElement",{get:function(){return this.props.buttonLabel&&this._renderButtonElement({description:this.props.description,label:this.props.buttonLabel,onClick:this.props.onAdd},!0)},enumerable:!1,configurable:!0}),t.prototype.focusOnPlaceHolderButton=function(){this._placeholderButton&&this._placeholderButton.focus()},Object.defineProperty(t.prototype,"_extraButtonElements",{get:function(){var e=this;return this.props.extraButtons&&this.props.extraButtons.map(function(t,r){return e._renderButtonElement(t,!1)})},enumerable:!1,configurable:!0}),t.prototype._processLines=function(){this._placeholderDescription&&!o._BrowserUtilities.isWebViewHosted()&&ve(this._placeholderDescription,3,this.props.description)},t.prototype._renderButtonElement=function(e,t){return n.createElement(c.PrimaryButton,{componentRef:t&&this._resolveRef("_placeholderButton"),"data-automation-id":"placeholderButton",onClick:e.onClick,ariaDescription:e.description},e.label)},t}(c.BaseComponent),we=r("j3t2"),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onLogin=function(){t._logAction("Click"),window.location.href=t.props.error.redirectUrl},t._logAction=function(e){var r=new s._LogEntry("OAuthErrorRenderer","MultiFactorAuthentication."+e,s._LogType.Event,{webpartAlias:t.props.webpartAlias});s._EngagementLogger.logEventWithLogEntry(r)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=!!this.props.error.redirectUrl,t=e?we.b:this.props.customErrorMessage||this.props.error.message;return n.createElement("div",{className:this.props.contentClassName},n.createElement(Ce,{icon:this.props.webpartIcon||"Permissions",iconText:this.props.webpartName,buttonLabel:e&&we.a,description:t,onAdd:e&&this._onLogin}))},t.prototype.componentDidMount=function(){this.props.error.redirectUrl&&this._logAction("Render")},t}(n.Component),xe=function(){function e(){var t=this;this.register=function(e,r,a){t._scrollableParents&&t._scrollableParents.length||(t._scrollableParents=a?[a]:t._findScrollableParents(e)),t._scrollableParents.forEach(function(e,r,a){1===t._updateRegisteredChildren(e,1)&&t._listenEvents(e)}),t._listenEvents(window),t._eventListeners.add(r)},this._findScrollableParents=function(t){for(var r=[],a=t;a;)(a=e._findScrollableParent(a))&&(r.push(a),a=a.parentElement);return r.length?r:[document.body]},this._unlistenEvents=function(e){if(e){var r=e===window;(!r||r&&t._isListeningWindow)&&(t._removeEventListener(e),r&&(t._isListeningWindow=!1))}},this._updateRegisteredChildren=function(t,r){var a=r+Number(t.getAttribute(e._eventTrackerAttribute));return a>0?t.setAttribute(e._eventTrackerAttribute,a.toString()):t.removeAttribute(e._eventTrackerAttribute),a},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=h.throttle(this._scrollEventHandler,10).bind(this)}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.unregister=function(e,t){var r=this;o.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach(function(e,t,a){r._updateRegisteredChildren(e,-1)<=0&&r._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))},e.prototype._scrollEventHandler=function(e){var t=this;this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(function(r){r(e,t._cachedClientRect)})},e.prototype._listenEvents=function(e){if(e){var t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}},e.prototype._addEventListener=function(t){t.addEventListener(e.SCROLL,this._lazyHandler,!1),t.addEventListener(e.RESIZE,this._lazyHandler,!1)},e.prototype._removeEventListener=function(t){t.removeEventListener(e.SCROLL,this._lazyHandler),t.removeEventListener(e.RESIZE,this._lazyHandler)},Object.defineProperty(e.prototype,"_cacheExpired",{get:function(){return Date.now()-this._cachedClientRectAge>=e.CACHE_EXPIRED},enumerable:!1,configurable:!0}),e._eventTrackerAttribute="data-sp-scroll-event-listener",e.SCROLL="scroll",e.RESIZE="resize",e.CACHE_EXPIRED=100,e._findScrollableParent=function(t){for(var r=t,a=document.body;r&&r!==a;){if("true"===r.getAttribute("data-is-scrollable"))return r;r=r.parentElement}for(r=t;r&&r!==a;){var n=getComputedStyle(r);if(n){var i=n.getPropertyValue("overflow-y");if(i&&(i===e.SCROLL||"auto"===i))return r}r=r.parentElement}return r&&r!==a||(r=void 0),r},e}(),Ee=function(){function e(){var e=this;this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=function(t,r){window.requestAnimationFrame(e._updateParallax.bind(e,r))},this._updateParallax=function(t){var r=t.top;e._parallaxElements.forEach(function(t){if(t.parentElement){var a=t.parentElement.getBoundingClientRect(),n=a.top,i=a.bottom;if(n<r&&i>r){var o=Math.round((r-n)/e._parallaxFactor);e._setTranslate(t,o)}else n>=r&&e._setTranslate(t,0)}})}}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isParallaxEnabled",{get:function(){var e=o._BrowserDetection.getBrowserInformation();return e.browser!==o._Browser.Edge&&e.browser!==o._Browser.IE&&!o._BrowserUtilities.isWebViewHosted()},enumerable:!1,configurable:!0}),e.prototype.tryAddParallax=function(e){var t=this.isParallaxEnabled;if(t){o.Validate.isNotNullOrUndefined(e,"targetElement");var r=Object(c.findScrollableParent)(e),a=r===window?document.body:r;xe.instance.register(e,this._onScroll,a),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t},e.prototype.removeParallax=function(e){o.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),xe.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))},e.prototype._setTranslate=function(e,t){var r="translate3d(0px,"+t+"px, 0px)";e.style.transform=r},e}(),Le=Object(c.classNamesFunction)(),Te=function(e){return e.variantTheme?{captionElement:[{selectors:{"& span":{color:e.variantTheme.semanticColors.bodyText},"& textarea":{color:e.variantTheme.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:e.variantTheme.semanticColors.bodySubtext+" !important"}}}]}:{captionElement:void 0}},Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getStyles=function(e){return Te(e)},t}(oe),De=function(e){function t(t){var r=e.call(this,t)||this;return r._captionElementRef=n.createRef(),r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.alignPosition,r=e.className,i=e.edit,s=e.marginBottomSize,l=e.onTitleChange,d=e.placeholder,h=e.title,p=e.theme,f=o._SPFlight.isEnabled(276)?Le(Te,{variantTheme:p}).captionElement:(new Ie).getClassNames({variantTheme:p}).captionElement,_=Object(c.css)(r,f),m={type:u.b.Title,isEditMode:i,text:h,onChange:l,placeholder:d,alignPosition:t,className:_,headingLevel:2,marginBottomSize:s};return!(!i&&!h)&&n.createElement(u.c,Object(a.__assign)({ref:this._captionElementRef},m))},t.prototype.value=function(){return this._captionElementRef.current.value()},t.prototype.focusOnWebPartTitle=function(){this._captionElementRef.current.focusOnCaptionElement()},t.defaultProps={edit:!1,title:void 0,onTitleChange:h.noop,placeholder:void 0,className:void 0,alignPosition:u.a.PageDirection,marginBottomSize:"None"},t}(n.Component),Re=function(){function e(){}return e.getOpenDocumentAction=function(t){if(t&&o._BrowserUtilities.isWebViewHosted())return JSON.stringify({key:e.documentKey,args:{command:e.documentCommand,url:t,version:"1.0"}})},Object.defineProperty(e,"webViewActionRole",{get:function(){return o._SPFlight.isEnabled(1374)?o._BrowserUtilities.isWebViewHosted()&&!o._BrowserUtilities.isTeamsWebViewHosted()?"button":void 0:o._BrowserUtilities.isWebViewHosted()?"button":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentKey",{get:function(){return"openDocument"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentCommand",{get:function(){return"sitePageUserAction"},enumerable:!1,configurable:!0}),e}();function Oe(e){return e instanceof Error?e:new Error(e)}var Ne=function(){function e(e,t,r){this._tagNameSuffix=e,this._innerError=Oe(t),this._extraData=r}return Object.defineProperty(e.prototype,"tagNameSuffix",{get:function(){return this._tagNameSuffix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},enumerable:!1,configurable:!0}),e}(),Ue=function(){function e(e,t,r){this._tagNameSuffix=e,this._innerError=Oe(t),this._extraData=r}return Object.defineProperty(e.prototype,"tagNameSuffix",{get:function(){return this._tagNameSuffix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},enumerable:!1,configurable:!0}),e}();function Ae(){return o._SPFlight.isEnabled(1697)}function Fe(){return o._SPKillSwitch.isActivated("902fc107-961a-4ede-ab07-9824c4648958")}g.loadStyles(".ah_g_658c9e0a{cursor:pointer}.ah_g_658c9e0a:hover{outline:none}",!0);var Me=r("0l0e"),We=new(function(){function e(){}return e.prototype.getLPCLoader=function(){return Promise.all([r.e(5),r.e(0)]).then(r.bind(null,"oCe/")).then(function(e){return e.default})},Object(a.__decorate)([function(e,t,r){if(r.value){var a=r.value;r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new d._QosMonitor("LivePersonaCard.Load"),n=a.apply(this,e);return n.then(function(e){return r.writeSuccess(),e},function(e){throw e instanceof Ue?(r.writeExpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):e instanceof Ne?(r.writeUnexpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):(r.writeUnexpectedFailure("UnexpectedFailure",e),e)})}}}],e.prototype,"getLPCLoader",null),e}()),je=function(e){function t(r){var a=e.call(this,r)||this;return a._isUnMounted=!1,a._bootstrapLivePersonaCard=function(e,r){return!t._isLivePersonaCardFlightEnabled()||o._BrowserUtilities.isMobileWebView()?Promise.resolve():t.LivePersonaCardHoverTarget?(a._updateBundleMountedState(null==e?void 0:e.nativeEvent),Promise.resolve()):Ae()?(a._loadPromise||(a._loadPromise=a._bootstrapCore(null==e?void 0:e.nativeEvent)),a._loadPromise):(!a._loadPromise&&r&&(a._loadPromise=a._bootstrapCore(null==e?void 0:e.nativeEvent)),a._loadPromise||Promise.resolve())},a._bootstrapCore=function(e){return s._TraceLogger.logVerbose(a._logSource,"LivePersonaCard._bootstrapCore"),We.getLPCLoader().then(function(e){return e.bootstrap(a.props.serviceScope,a._clientType)}).then(function(){a._isUnMounted||a._updateBundleMountedState(e)}).catch(function(e){s._TraceLogger.logError(a._logSource,e,"BootstrapLivePersonaCard")})},a._manuallyDispatchEventToTriggerCallout=function(e){var t,r;Ae()&&"keydown"===(null==e?void 0:e.type)&&a._ref.current&&(null===(t=Object(c.getFirstTabbable)(a._ref.current,a._ref.current,!0))||void 0===t||t.focus(),null===(r=a._ref.current.firstElementChild)||void 0===r||r.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}()))},a._logTriggerAction=function(e,t){Ae()&&"Keyboard"===t&&e.keyCode!==c.KeyCodes.enter||a._triggerBootstrap(e,t)},a._triggerBootstrap=function(e,t){s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("LivePersonaCard",a._logScenario+".Trigger",s._LogType.Event,{hasUPN:Boolean(a.props.upn).toString(),source:t,isBundleLoaded:a.state.isBundleLoaded.toString()})),Ae()&&a._isLPCBundleLoaded()||a._bootstrapLivePersonaCard(e,!0).catch(a._traceBootstrapFailure)},a._triggerBootstrapByKeyboard=function(e){Ae()&&"Enter"!==e.key||(a._triggerBootstrap(e,"Keyboard"),!Ae()||Fe()||a._isLPCBundleLoaded()||l.ScreenReaderAlert.read(Me.b))},a._handleCardOpen=function(){s._EngagementLogger.logEvent("LivePersonaCard."+a._logScenario,"Open");var e=a.props.onCardOpen;e&&e()},a._traceBootstrapFailure=function(e){s._TraceLogger.logError(a._logSource,e,"LivePersonaCard.bootstrap")},a._logSource=s._LogSource.create("LivePersonaCard"),a._ref=n.createRef(),a.state={isBundleLoaded:!1},a}return Object(a.__extends)(t,e),t._isLivePersonaCardFlightEnabled=function(){return o._SPFlight.isEnabled(809)},Object.defineProperty(t,"LivePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){Ae()||this.props.disabled||this._bootstrapLivePersonaCard().catch(this._traceBootstrapFailure)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){Ae()||!this.props.disabled||e.disabled||this._bootstrapLivePersonaCard().catch(this._traceBootstrapFailure)},t.prototype.componentWillUnmount=function(){this._isUnMounted=!0,this._loadTimeout&&window.clearTimeout(this._loadTimeout)},t.prototype.render=function(){var e=this;if(this.props.disabled)return n.Children.only(this.props.children);if(o._BrowserUtilities.isMobileWebView())return n.cloneElement(n.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:{upn:this.props.upn}}),onClick:function(){}});var t=function(t){return Fe()?e._logTriggerAction(t,"Mouse"):e._triggerBootstrap(t,"Mouse")},r=this.props.useSpan?"span":"div";return n.createElement(r,{className:Object(c.css)(this.props.className,"ah_g_658c9e0a"),onClickCapture:t,onKeyDownCapture:function(t){return Fe()?e._logTriggerAction(t,"Keyboard"):e._triggerBootstrapByKeyboard(t)},onMouseOver:t,ref:Ae()?this._ref:void 0},this._renderContent())},t.prototype._renderContent=function(){var e={cardParameters:{personaInfo:{identifiers:Object(a.__assign)({PersonaType:this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User",Upn:this.props.upn,Smtp:this.props.upn},this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),displayName:this.props.displayName,personaCoinColor:Object(c.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex};return this.props.upn&&this._isLPCBundleLoaded()?n.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},e,{onCardOpen:this._handleCardOpen}),n.Children.only(this.props.children)):Ae()&&this.props.upn&&!this._isLPCBundleLoaded()?n.cloneElement(n.Children.only(this.props.children),Object(a.__assign)({tabIndex:0,"data-is-focusable":!0},!Fe()&&{role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?o.Text.format(Me.c,this.props.displayName):Me.a),"aria-haspopup":"dialog"})):n.Children.only(this.props.children)},t.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!t.LivePersonaCardHoverTarget},Object.defineProperty(t.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!1,configurable:!0}),t.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(t.prototype,"_clientType",{get:function(){return this.props.clientType||"SPPeopleWebPart"},enumerable:!1,configurable:!0}),t}(n.PureComponent),ke=function(){function e(){}return e.GetUtilities=function(){return e._promise||(e._promise=r.e(2).then(r.bind(null,"aABU"))),e._promise},e}();function Be(e){return n.createElement("div",{className:"a_a_658c9e0a"},n.createElement(c.Icon,{className:"b_a_658c9e0a",iconName:e}))}g.loadStyles('.a_a_658c9e0a{z-index:2;position:absolute;width:100%;height:100%;background-color:"[theme:black, default: #000000]";opacity:.5;text-align:center;top:0;cursor:pointer}.b_a_658c9e0a{color:"[theme:white, default: #ffffff]";position:absolute;transform:translate(-50%,-50%);font-size:68px;top:50%}[dir=ltr] .b_a_658c9e0a{left:50%}[dir=rtl] .b_a_658c9e0a{right:50%}',!0)},pDlU:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"c",function(){return s});var a=r("hiL/"),n=r("UWqr"),i=function(){function e(){}return e.exclusiveRenderTimeForBaseCollectionWebPart=new a.KillSwitch("d84e2f1c-760e-4fb3-9589-95de35f2ddc1"),e.topicPageTitleNotEditableEditMode=new a.KillSwitch("5725af9c-dbe0-43f3-b157-b24ec7350f2b"),e}();function o(){return n._SPKillSwitch.isActivated("f186df9f-68c1-472c-94fe-d68b47deaa27")}function s(){return!n._SPKillSwitch.isActivated("9da07b7d-b53a-4c3d-bced-36f541fd231f")}t.a=i},qjmy:function(e,t){e.exports=_},ut3N:function(e,t){e.exports=m},vlQI:function(e,t){e.exports=g},vpvl:function(e,t,r){"use strict";r("jOlS").loadStyles('.c_b_658c9e0a{font-size:14px;font-weight:400;font-weight:300;line-height:1.6em;overflow-x:hidden;text-overflow:ellipsis}.e_b_658c9e0a{color:"[theme:neutralPrimary, default: #323130]";overflow-x:hidden;text-overflow:ellipsis}@media screen and (min-width:320px){.e_b_658c9e0a:not(.f_b_658c9e0a){font-weight:300;font-size:21px;font-weight:100}}@media screen and (min-width:480px){.e_b_658c9e0a:not(.f_b_658c9e0a){font-size:24px}}[dir=ltr] .g_b_658c9e0a{text-align:left}[dir=rtl] .g_b_658c9e0a{text-align:right}.h_b_658c9e0a{text-align:center}[dir=ltr] .i_b_658c9e0a{text-align:right}[dir=rtl] .i_b_658c9e0a{text-align:left}.j_b_658c9e0a{margin-bottom:18px}.k_b_658c9e0a{margin-bottom:11px}.l_b_658c9e0a{margin-bottom:0}.m_b_658c9e0a{white-space:pre-wrap}.n_b_658c9e0a{background-color:transparent;border:none;box-sizing:border-box;display:block;margin:0;outline:0;overflow:hidden;resize:none;width:100%;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;text-align:inherit}.n_b_658c9e0a:-ms-input-placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}.n_b_658c9e0a::placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}',!0),t.a={captionElement__caption:"c_b_658c9e0a",captionElement__title:"e_b_658c9e0a",fluent:"f_b_658c9e0a",captionElement__leftAlign:"g_b_658c9e0a",captionElement__centerAlign:"h_b_658c9e0a",captionElement__rightAlign:"i_b_658c9e0a",captionElement__LargeMargin:"j_b_658c9e0a",captionElement__MiddleMargin:"k_b_658c9e0a",captionElement__NoMargin:"l_b_658c9e0a",titleBreakInLines:"m_b_658c9e0a",textarea:"n_b_658c9e0a"}},xTKt:function(e){e.exports=JSON.parse('{"d":"See all","e":"See all. Press enter to browse all items.","b":"Add","a":"Add an item","c":"Close teaching bubble","f":"The See All page for the {0} web part is opening."}')},y88i:function(e,t){e.exports=b}})});