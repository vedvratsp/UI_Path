define("eb95c819-ab8f-4689-bd03-0c2d65d47b1f_0.1.0",["tslib","@ms/sp-telemetry","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-dataproviders","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/i18n-utilities","@microsoft/sp-webpart-base","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,i,n,r,a,o,s,c,l,d,u,p,m,h,g,_){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-siteactivity-webpart_en-us_7ec3c1bd142d6361b9a8\.js/i;if(t&&t.length)for(var r=0;r<t.length;r++)if(t[r]){var a=t[r].getAttribute("src");if(a&&a.match(n)){e=a.substring(0,a.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="NDhO")}({"0EJq":function(e,t){var i={closeButtonAriaLabel:"Close"};i.default=i,e.exports=i},"17wl":function(t,i){t.exports=e},"2q6Q":function(e,i){e.exports=t},"8sWK":function(e){e.exports=JSON.parse('{"C":"Sent {0}","M":"Viewed {0}","c":"Added {0}","h":"Added files {0}","i":"Added items {0}","m":"Attachment(s)","q":"Edited {0}","s":"Edited this plan","E":"You have task(s) due","l":"Assigned you task(s)","D":"Tagged {0}","d":"Created list {0}","k":"Created site {0}","r":"Edited the list {0}","g":"Get organized","L":"View and share files","N":"Activity","e":"Use lists to keep team activities organized.","J":"Collaborate on content with your team.","K":"Upload a document","f":"Add a list","w":"List of activities, Press enter to access, use right and left arrow keys to navigate, arrow down to access details.","H":"{0}, {1}, {2}","n":"Email subject {0},  preview {1}, {2}, {3}, {4}","v":"has attachment","a":"{0}, {1}, {2}, {3}","b":"{0} plus {1} others","u":"You don\\u0027t have any recent activity","t":"Start using your team site, and we\\u0027ll show you all your recent work here so you can easily get back to where you left off.","x":"+{0} more","j":"{0} files were added","I":"Popular","B":"See all","A":"See all activities","z":"Configure how you want to display the site activities.","y":"Show up to this many items at a time","G":"Please enter a positive number.","o":"Due today","p":"Due tomorrow","F":"{0} tasks assigned"}')},ASFM:function(e,t,i){e.exports=i.p+"icon_task-list-2x_72963658.png"},CWvN:function(e,t,i){var n=i("fglE");e.exports=n._Utilities},FI2v:function(e,t,i){e.exports=i.p+"icon_chart_a3a053c1.png"},GEk3:function(e,t,i){e.exports=i.p+"icon_calendar-2x_4961592f.png"},HDFi:function(e,t,i){e.exports=i.p+"icon_empty-state-activity-2x_150d9ae3.png"},HPkc:function(e,t,i){(e.exports=i("q1Tm")(!1)).push([e.i,"@media (min-width:320px){.a_a_7cc3b315{font-size:21px}}@media (min-width:480px){.a_a_7cc3b315{font-size:24px}}.b_a_7cc3b315{position:relative}.b_a_7cc3b315 .ms-DocumentCardActivity-details{height:30px}.b_a_7cc3b315 .ms-DocumentCardActivity-details .ms-DocumentCardActivity-activity,.b_a_7cc3b315 .ms-DocumentCardActivity-details .ms-DocumentCardActivity-name{line-height:15px;height:15px}.b_a_7cc3b315 .ms-DocumentCardPreview .ms-Image-image--center{max-width:64px}.b_a_7cc3b315 .ms-TipTile .ms-DocumentCardPreview-iconContainer{font-size:42px;font-weight:100;color:#fff}.a_a_7cc3b315{font-weight:300;margin:0 0 20px}.c_a_7cc3b315{display:relative;text-align:center}.e_a_7cc3b315{margin:40px auto auto}.f_a_7cc3b315{padding:30px 16px 0;font-size:21px;font-weight:100}.f_a_7cc3b315,.g_a_7cc3b315{max-width:400px;color:#605e5c;margin:0 auto}.g_a_7cc3b315{line-height:20px;font-size:14px;font-weight:400}.g_a_7cc3b315,[dir=rtl] .g_a_7cc3b315{padding:6px 16px 0}.h_a_7cc3b315{display:inline-block;position:absolute;top:8px}[dir=ltr] .h_a_7cc3b315{right:0}[dir=rtl] .h_a_7cc3b315{left:0}[dir=ltr] .h_a_7cc3b315{text-align:right}[dir=rtl] .h_a_7cc3b315{text-align:left}.i_a_7cc3b315,.i_a_7cc3b315:active{color:#0078d4;font-size:14px;font-weight:400;text-decoration:none}.i_a_7cc3b315:active{color:#004578}",""])},JvOe:function(e,t,i){e.exports=i.p+"icon_spo_a1ad9af5.png"},K9kD:function(e,t){e.exports=i},KL1q:function(e,t){e.exports=n},NDhO:function(e,t,i){"use strict";i.r(t);var n,r=i("17wl"),a=i("cDcd"),o=i("faye"),s=i("2q6Q"),c=i("UWqr"),l=i("br4S"),d=i("y88i"),u=i("KL1q"),p=i("U4ag"),m=i("QZHX"),h=i("epUW"),g=i("K9kD");!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(n||(n={}));var _,f,v,y,b,C,T=Object(u.classNamesFunction)(),x=function(e){function t(t){var i=e.call(this,t)||this;return i._rootElement=a.createRef(),i._onClick=function(e){i._onAction(e)},i._onKeyDown=function(e){e.which!==u.KeyCodes.enter&&e.which!==u.KeyCodes.space||i._onAction(e)},i._onAction=function(e){var t=i.props,n=t.onClick,r=t.onClickHref,a=t.onClickTarget;n?n(e):!n&&r&&(a?window.open(r,a,"noreferrer noopener nofollow"):window.location.href=r,e.preventDefault(),e.stopPropagation())},Object(u.initializeComponentRef)(i),Object(u.warnDeprecations)("DocumentCard",t,{accentColor:void 0}),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,i=t.onClick,o=t.onClickHref,s=t.children,c=t.type,l=t.accentColor,d=t.styles,p=t.theme,m=t.className,h=Object(u.getNativeProps)(this.props,u.divProperties,["className","onClick","type","role"]),g=!(!i&&!o);this._classNames=T(d,{theme:p,className:m,actionable:g,compact:c===n.compact}),c===n.compact&&l&&(e={borderBottomColor:l});var _=this.props.role||(g?i?"button":"link":void 0),f=g?0:void 0;return a.createElement("div",Object(r.__assign)({ref:this._rootElement,tabIndex:f,"data-is-focusable":g,role:_,className:this._classNames.root,onKeyDown:g?this._onKeyDown:void 0,onClick:g?this._onClick:void 0,style:e},h),s)},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:n.normal},t}(a.Component),w={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},S={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},D={root:"ms-DocumentCardTitle"},I={root:"ms-DocumentCardLocation"},P={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},A=Object(u.styled)(x,function(e){var t,i,n=e.className,r=e.theme,a=e.actionable,o=e.compact,s=r.palette,c=r.fonts,l=r.effects,d=Object(u.getGlobalClassNames)(P,r);return{root:[d.root,{WebkitFontSmoothing:"antialiased",backgroundColor:s.white,border:"1px solid "+s.neutralLight,maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t["."+u.IsFocusVisibleClassName+" &:focus"]=Object(u.getInputFocusStyle)(s.neutralSecondary,l.roundedCorner2),t["."+I.root+" + ."+D.root]={paddingTop:"4px"},t)},a&&[d.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:s.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid "+s.neutralTertiaryAlt,pointerEvents:"none"}}}],o&&[d.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(i={},i["."+w.root]={borderRight:"1px solid "+s.neutralLight,borderBottom:0,maxHeight:"106px",maxWidth:"144px"},i["."+w.icon]={maxHeight:"32px",maxWidth:"32px"},i["."+S.root]={paddingBottom:"12px"},i["."+D.root]={paddingBottom:"12px 16px 8px 16px",fontSize:c.mediumPlus.fontSize,lineHeight:"16px"},i)}],n]}},void 0,{scope:"DocumentCard"}),k=i("QmvJ"),L=Object(u.classNamesFunction)(),O=function(e){function t(t){var i=e.call(this,t)||this;return i._renderPreviewList=function(e){var t=i.props.getOverflowDocumentCountText,n=e.length-3,o=n?t?t(n):"+"+n:null,s=e.slice(0,3).map(function(e,t){return a.createElement("li",{key:t},a.createElement(u.Image,{className:i._classNames.fileListIcon,src:e.iconSrc,role:"presentation",alt:"",width:"16px",height:"16px"}),a.createElement(u.Link,Object(r.__assign)({className:i._classNames.fileListLink},(e.linkProps,{href:e.linkProps&&e.linkProps.href||e.url})),e.name))});return a.createElement("div",null,a.createElement("ul",{className:i._classNames.fileList},s),o&&a.createElement("span",{className:i._classNames.fileListOverflowText},o))},Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t,i=this.props,n=i.previewImages,r=i.styles,o=i.theme,s=i.className,c=n.length>1;return this._classNames=L(r,{theme:o,className:s,isFileList:c}),n.length>1?t=this._renderPreviewList(n):1===n.length&&(t=this._renderPreviewImage(n[0]),n[0].accentColor&&(e={borderBottomColor:n[0].accentColor})),a.createElement("div",{className:this._classNames.root,style:e},t)},t.prototype._renderPreviewImage=function(e){var t=e.width,i=e.height,n=e.imageFit,o=e.previewIconProps,s=e.previewIconContainerClass;if(o)return a.createElement("div",{className:Object(u.css)(this._classNames.previewIcon,s),style:{width:t,height:i}},a.createElement(k.Icon,Object(r.__assign)({},o)));var c,l=a.createElement(u.Image,{width:t,height:i,imageFit:n,src:e.previewImageSrc,role:"presentation",alt:""});return e.iconSrc&&(c=a.createElement(u.Image,{className:this._classNames.icon,src:e.iconSrc,role:"presentation",alt:""})),a.createElement("div",null,l,c)},t}(a.Component),E=Object(u.styled)(O,function(e){var t,i,n=e.theme,r=e.className,a=e.isFileList,o=n.palette,s=n.fonts,c=Object(u.getGlobalClassNames)(w,n);return{root:[c.root,s.small,{backgroundColor:a?o.white:o.neutralLighterAlt,borderBottom:"1px solid "+o.neutralLight,overflow:"hidden",position:"relative"},r],previewIcon:[c.iconContainer,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}],icon:[c.icon,{left:"10px",bottom:"10px",position:"absolute"}],fileList:{padding:"16px 16px 0 16px",listStyleType:"none",margin:0,selectors:{li:{height:"16px",lineHeight:"16px",marginBottom:"8px",overflow:"hidden"}}},fileListIcon:{display:"inline-block",marginRight:"8px"},fileListLink:[Object(u.getFocusStyle)(n,{highContrastStyle:{border:"1px solid WindowText",outline:"none"}}),{boxSizing:"border-box",color:o.neutralDark,overflow:"hidden",display:"inline-block",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"calc(100% - 24px)",selectors:(t={":hover":{color:o.themePrimary}},t["."+u.IsFocusVisibleClassName+" &:focus"]={selectors:(i={},i[u.HighContrastSelector]={outline:"none"},i)},t)}],fileListOverflowText:{padding:"0px 16px 8px 16px",display:"block"}}},void 0,{scope:"DocumentCardPreview"}),N=Object(u.classNamesFunction)(),j=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,i=e.styles,n=e.theme,r=e.className;return this._classNames=N(i,{theme:n,className:r}),a.createElement("div",{className:this._classNames.root},t)},t}(a.Component),R={root:"ms-DocumentCardDetails"},z=Object(u.styled)(j,function(e){var t=e.className,i=e.theme;return{root:[Object(u.getGlobalClassNames)(R,i).root,{display:"flex",flexDirection:"column",flex:1,justifyContent:"space-between",overflow:"hidden"},t]}},void 0,{scope:"DocumentCardDetails"}),F=i("CWvN"),U=Object(u.classNamesFunction)(),B=function(e){function t(t){var i=e.call(this,t)||this;return i._titleElement=a.createRef(),i._measureTitleElement=a.createRef(),i._truncateTitle=function(){i.state.needMeasurement&&i._async.requestAnimationFrame(i._truncateWhenInAnimation)},i._truncateWhenInAnimation=function(){var e=i.props.title,t=i._measureTitleElement.current;if(t){var n=getComputedStyle(t);if(n.width&&n.lineHeight&&n.height){var r=t.clientWidth,a=t.scrollWidth,o=Math.floor((parseInt(n.height,10)+5)/parseInt(n.lineHeight,10)),s=a/(parseInt(n.width,10)*o);if(s>1){var c=e.length/s-3;return i.setState({truncatedTitleFirstPiece:e.slice(0,c/2),truncatedTitleSecondPiece:e.slice(e.length-c/2),clientWidth:r,needMeasurement:!1})}}}return i.setState({needMeasurement:!1})},i._shrinkTitle=function(){var e=i.state,t=e.truncatedTitleFirstPiece,n=e.truncatedTitleSecondPiece;if(t&&n){var r=i._titleElement.current;if(!r)return;(r.scrollHeight>r.clientHeight+5||r.scrollWidth>r.clientWidth)&&i.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:n.slice(1)})}},Object(F.initializeComponentRef)(i),i._async=new u.Async(i),i._events=new u.EventGroup(i),i.state={truncatedTitleFirstPiece:"",truncatedTitleSecondPiece:"",previousTitle:t.title,needMeasurement:!!t.shouldTruncate},i}return Object(r.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.title!==this.state.previousTitle&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0,clientWidth:void 0,previousTitle:this.props.title,needMeasurement:!!this.props.shouldTruncate}),this._events.off(window,"resize",this._updateTruncation),this.props.shouldTruncate&&(this._truncateTitle(),requestAnimationFrame(this._shrinkTitle),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentDidMount=function(){this.props.shouldTruncate&&(this._truncateTitle(),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.title,i=e.shouldTruncate,n=e.showAsSecondaryTitle,r=e.styles,o=e.theme,s=e.className,c=this.state,l=c.truncatedTitleFirstPiece,d=c.truncatedTitleSecondPiece,u=c.needMeasurement;return this._classNames=U(r,{theme:o,className:s,showAsSecondaryTitle:n}),u?a.createElement("div",{className:this._classNames.root,ref:this._measureTitleElement,title:t,style:{whiteSpace:"nowrap"}},t):i&&l&&d?a.createElement("div",{className:this._classNames.root,ref:this._titleElement,title:t},l,"â€¦",d):a.createElement("div",{className:this._classNames.root,ref:this._titleElement,title:t},t)},t.prototype._updateTruncation=function(){var e=this;this._async.requestAnimationFrame(function(){if(e._titleElement.current){var t=e._titleElement.current.clientWidth;clearTimeout(e._titleTruncationTimer),e.state.clientWidth!==t&&(e._titleTruncationTimer=e._async.setTimeout(function(){return e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0,needMeasurement:!0})},250))}})},t}(a.Component),q=Object(u.styled)(B,function(e){var t=e.theme,i=e.className,n=e.showAsSecondaryTitle,r=t.palette,a=t.fonts;return{root:[Object(u.getGlobalClassNames)(D,t).root,n?a.medium:a.large,{padding:"8px 16px",display:"block",overflow:"hidden",wordWrap:"break-word",height:n?"45px":"38px",lineHeight:n?"18px":"21px",color:n?r.neutralSecondary:r.neutralPrimary},i]}},void 0,{scope:"DocumentCardTitle"});!function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(_||(_={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(f||(f={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(v||(v={})),function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(b||(b={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(C||(C={}));var H=function(e){return{isSize8:e===_.size8,isSize10:e===_.size10||e===_.tiny,isSize16:e===_.size16,isSize24:e===_.size24||e===_.extraExtraSmall,isSize28:e===_.size28||e===_.extraSmall,isSize32:e===_.size32,isSize40:e===_.size40||e===_.small,isSize48:e===_.size48||e===_.regular,isSize56:e===_.size56,isSize72:e===_.size72||e===_.large,isSize100:e===_.size100||e===_.extraLarge,isSize120:e===_.size120}},M=((y={})[_.tiny]=10,y[_.extraExtraSmall]=24,y[_.extraSmall]=28,y[_.small]=40,y[_.regular]=48,y[_.large]=72,y[_.extraLarge]=100,y[_.size8]=8,y[_.size10]=10,y[_.size16]=16,y[_.size24]=24,y[_.size28]=28,y[_.size32]=32,y[_.size40]=40,y[_.size48]=48,y[_.size56]=56,y[_.size72]=72,y[_.size100]=100,y[_.size120]=120,y),K=Object(u.classNamesFunction)({cacheSize:100}),W=function(e){function t(t){var i=e.call(this,t)||this;return i._onRenderIcon=function(e,t){return a.createElement(k.Icon,{className:e,iconName:G(i.props.presence,i.props.isOutOfOffice),style:t})},i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.coinSize,i=e.isOutOfOffice,n=e.styles,r=e.presence,o=e.theme,s=e.presenceTitle,c=e.presenceColors,l=H(this.props.size),d=!(l.isSize8||l.isSize10||l.isSize16||l.isSize24||l.isSize28||l.isSize32)&&(!t||t>32),u=t?t/3<40?t/3+"px":"40px":"",p=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:u}:void 0,m=t?{width:u,height:u}:void 0,h=K(n,{theme:o,presence:r,size:this.props.size,isOutOfOffice:i,presenceColors:c});return r===f.none?null:a.createElement("div",{role:"presentation",className:h.presence,style:m,title:s},d&&this._onRenderIcon(h.presenceIcon,p))},t}(a.Component);function G(e,t){if(e){switch(f[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}var V={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function Z(e){return{color:e,borderColor:e}}function Q(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function Y(e){return{height:e,width:e}}function J(e){return{backgroundColor:e}}var X=Object(u.styled)(W,function(e){var t,i,n,a,o,s,c=e.theme,l=e.presenceColors,d=c.semanticColors,p=c.fonts,m=Object(u.getGlobalClassNames)(V,c),h=H(e.size),g=function(e){return{isAvailable:e===f.online,isAway:e===f.away,isBlocked:e===f.blocked,isBusy:e===f.busy,isDoNotDisturb:e===f.dnd,isOffline:e===f.offline}}(e.presence),_=l&&l.available||"#6BB700",v=l&&l.away||"#FFAA44",y=l&&l.busy||"#C43148",b=l&&l.dnd||"#C50F1F",T=l&&l.offline||"#8A8886",x=l&&l.oof||"#B4009E",w=l&&l.background||d.bodyBackground,S=g.isOffline||e.isOutOfOffice&&(g.isAvailable||g.isBusy||g.isAway||g.isDoNotDisturb),D=h.isSize72||h.isSize100?"2px":"1px";return{presence:[m.presence,Object(r.__assign)(Object(r.__assign)({position:"absolute",height:C.size12,width:C.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+w,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box"},Object(u.getHighContrastNoAdjustStyle)()),{selectors:(t={},t[u.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(h.isSize8||h.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(i={},i[u.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},i)},(h.isSize8||h.isSize10||h.isSize24||h.isSize28||h.isSize32)&&Y(C.size8),(h.isSize40||h.isSize48)&&Y(C.size12),h.isSize16&&{height:C.size6,width:C.size6,borderWidth:"1.5px"},h.isSize56&&Y(C.size16),h.isSize72&&Y(C.size20),h.isSize100&&Y(C.size28),h.isSize120&&Y(C.size32),g.isAvailable&&{backgroundColor:_,selectors:(n={},n[u.HighContrastSelector]=J("Highlight"),n)},g.isAway&&J(v),g.isBlocked&&[{selectors:(a={":after":h.isSize40||h.isSize48||h.isSize72||h.isSize100?{content:'""',width:"100%",height:D,backgroundColor:y,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},a[u.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},a)}],g.isBusy&&J(y),g.isDoNotDisturb&&J(b),g.isOffline&&J(T),(S||g.isBlocked)&&[{backgroundColor:w,selectors:(o={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:D+" solid "+y,borderRadius:"50%",boxSizing:"border-box"}},o[u.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},o)}],S&&g.isAvailable&&Q(D,_),S&&g.isBusy&&Q(D,y),S&&g.isAway&&Q(D,x),S&&g.isDoNotDisturb&&Q(D,b),S&&g.isOffline&&Q(D,T),S&&g.isOffline&&e.isOutOfOffice&&Q(D,x)],presenceIcon:[m.presenceIcon,{color:w,fontSize:"6px",lineHeight:C.size12,verticalAlign:"top",selectors:(s={},s[u.HighContrastSelector]={color:"Window"},s)},h.isSize56&&{fontSize:"8px",lineHeight:C.size16},h.isSize72&&{fontSize:p.small.fontSize,lineHeight:C.size20},h.isSize100&&{fontSize:p.medium.fontSize,lineHeight:C.size28},h.isSize120&&{fontSize:p.medium.fontSize,lineHeight:C.size32},g.isAway&&{position:"relative",left:S?void 0:"1px"},S&&g.isAvailable&&Z(_),S&&g.isBusy&&Z(y),S&&g.isAway&&Z(x),S&&g.isDoNotDisturb&&Z(b),S&&g.isOffline&&Z(T),S&&g.isOffline&&e.isOutOfOffice&&Z(x)]}},void 0,{scope:"PersonaPresence"}),$=[v.lightBlue,v.blue,v.darkBlue,v.teal,v.green,v.darkGreen,v.lightPink,v.pink,v.magenta,v.purple,v.orange,v.lightRed,v.darkRed,v.violet,v.gold,v.burgundy,v.warmGray,v.cyan,v.rust,v.coolGray],ee=$.length;function te(e){var t=e.primaryText,i=e.text,n=e.initialsColor;return"string"==typeof n?n:function(e){switch(e){case v.lightBlue:return"#4F6BED";case v.blue:return"#0078D4";case v.darkBlue:return"#004E8C";case v.teal:return"#038387";case v.lightGreen:case v.green:return"#498205";case v.darkGreen:return"#0B6A0B";case v.lightPink:return"#C239B3";case v.pink:return"#E3008C";case v.magenta:return"#881798";case v.purple:return"#5C2E91";case v.orange:return"#CA5010";case v.red:return"#EE1111";case v.lightRed:return"#D13438";case v.darkRed:return"#A4262C";case v.transparent:return"transparent";case v.violet:return"#8764B8";case v.gold:return"#986F0B";case v.burgundy:return"#750B1C";case v.warmGray:return"#7A7574";case v.cyan:return"#005B70";case v.rust:return"#8E562E";case v.coolGray:return"#69797E";case v.black:return"#1D1D1D";case v.gray:return"#393939"}}(n=void 0!==n?n:function(e){var t=v.blue;if(!e)return t;for(var i=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;i^=(r<<a)+(r>>8-a)}return $[i%ee]}(i||t))}var ie=Object(u.classNamesFunction)({cacheSize:100}),ne=Object(u.memoizeFunction)(function(e,t,i,n,r,a){return Object(u.mergeStyles)(e,!a&&{backgroundColor:te({text:n,initialsColor:t,primaryText:r}),color:i})}),re=function(e){function t(t){var i=e.call(this,t)||this;return i._onRenderCoin=function(e){var t=i.props,n=t.coinSize,r=t.styles,o=t.imageUrl,s=t.imageAlt,c=t.imageShouldFadeIn,l=t.imageShouldStartVisible,d=t.theme,p=t.showUnknownPersonaCoin;if(!o)return null;var m=i.props.size,h=ie(r,{theme:d,size:m,showUnknownPersonaCoin:p}),g=n||M[m];return a.createElement(u.Image,{className:h.image,imageFit:u.ImageFit.cover,src:o,width:g,height:g,alt:s,shouldFadeIn:c,shouldStartVisible:l,onLoadingStateChange:i._onPhotoLoadingStateChange})},i._onRenderInitials=function(e){var t=e.imageInitials,n=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return a.createElement(k.Icon,{iconName:"Help"});var r=Object(u.getRTL)(i.props.theme);return""!==(t=t||Object(u.getInitials)(i._getText(),r,n))?a.createElement("span",null,t):a.createElement(k.Icon,{iconName:"Contact"})},i._onPhotoLoadingStateChange=function(e){i.setState({isImageLoaded:e===u.ImageLoadState.loaded,isImageError:e===u.ImageLoadState.error}),i.props.onPhotoLoadingStateChange&&i.props.onPhotoLoadingStateChange(e)},i.state={isImageLoaded:!1,isImageError:!1},i}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})},t.prototype.render=function(){var e=this.props,t=e.className,i=e.coinProps,n=e.showUnknownPersonaCoin,o=e.coinSize,s=e.styles,c=e.imageUrl,l=e.initialsColor,d=e.initialsTextColor,p=e.isOutOfOffice,m=e.onRenderCoin,h=void 0===m?this._onRenderCoin:m,g=e.onRenderPersonaCoin,f=void 0===g?h:g,v=e.onRenderInitials,y=void 0===v?this._onRenderInitials:v,b=e.presence,C=e.presenceTitle,T=e.presenceColors,x=e.primaryText,w=e.showInitialsUntilImageLoads,S=e.text,D=e.theme,I=this.props.size,P=Object(u.getNativeProps)(this.props,u.divProperties),A=Object(u.getNativeProps)(i||{},u.divProperties),L=o?{width:o,height:o}:void 0,O=n,E={coinSize:o,isOutOfOffice:p,presence:b,presenceTitle:C,presenceColors:T,size:I,theme:D},N=ie(s,{theme:D,className:i&&i.className?i.className:t,size:I,coinSize:o,showUnknownPersonaCoin:n}),j=Boolean(!this.state.isImageLoaded&&(w&&c||!c||this.state.isImageError||O));return a.createElement("div",Object(r.__assign)({role:"presentation"},P,{className:N.coin}),I!==_.size8&&I!==_.size10&&I!==_.tiny?a.createElement("div",Object(r.__assign)({role:"presentation"},A,{className:N.imageArea,style:L}),j&&a.createElement("div",{className:ne(N.initials,l,d,S,x,n),style:L,"aria-hidden":"true"},y(this.props,this._onRenderInitials)),!O&&f(this.props,this._onRenderCoin),a.createElement(X,Object(r.__assign)({},E))):this.props.presence?a.createElement(X,Object(r.__assign)({},E)):a.createElement(k.Icon,{iconName:"Contact",className:N.size10WithoutPresenceIcon}),this.props.children)},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.defaultProps={size:_.size48,presence:f.none,imageAlt:""},t}(a.Component),ae={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},oe=Object(u.styled)(re,function(e){var t,i=e.className,n=e.theme,a=e.coinSize,o=n.palette,s=n.fonts,c=H(e.size),l=Object(u.getGlobalClassNames)(ae,n),d=a||e.size&&M[e.size]||48;return{coin:[l.coin,s.medium,c.isSize8&&l.size8,c.isSize10&&l.size10,c.isSize16&&l.size16,c.isSize24&&l.size24,c.isSize28&&l.size28,c.isSize32&&l.size32,c.isSize40&&l.size40,c.isSize48&&l.size48,c.isSize56&&l.size56,c.isSize72&&l.size72,c.isSize100&&l.size100,c.isSize120&&l.size120,i],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[l.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:d,width:d},d<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[l.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},d<=10&&{overflow:"visible",background:"transparent",height:0,width:0},d>10&&{height:d,width:d}],initials:[l.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":o.white,fontSize:s.large.fontSize,fontWeight:u.FontWeights.semibold,lineHeight:48===d?46:d,height:d,selectors:(t={},t[u.HighContrastSelector]=Object(r.__assign)(Object(r.__assign)({border:"1px solid WindowText"},Object(u.getHighContrastNoAdjustStyle)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:u.FontWeights.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},d<32&&{fontSize:s.xSmall.fontSize},d>=32&&d<40&&{fontSize:s.medium.fontSize},d>=40&&d<56&&{fontSize:s.mediumPlus.fontSize},d>=56&&d<72&&{fontSize:s.xLarge.fontSize},d>=72&&d<100&&{fontSize:s.xxLarge.fontSize},d>=100&&{fontSize:s.superLarge.fontSize}]}},void 0,{scope:"PersonaCoin"}),se=Object(u.classNamesFunction)(),ce=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.activity,i=e.people,n=e.styles,r=e.theme,o=e.className;return this._classNames=se(n,{theme:r,className:o,multiplePeople:i.length>1}),i&&0!==i.length?a.createElement("div",{className:this._classNames.root},this._renderAvatars(i),a.createElement("div",{className:this._classNames.details},a.createElement("span",{className:this._classNames.name},this._getNameString(i)),a.createElement("span",{className:this._classNames.activity},t))):null},t.prototype._renderAvatars=function(e){return a.createElement("div",{className:this._classNames.avatars},e.length>1?this._renderAvatar(e[1]):null,this._renderAvatar(e[0]))},t.prototype._renderAvatar=function(e){return a.createElement("div",{className:this._classNames.avatar},a.createElement(oe,{imageInitials:e.initials,text:e.name,imageUrl:e.profileImageSrc,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,role:"presentation",size:u.PersonaSize.size32}))},t.prototype._getNameString=function(e){var t=e[0].name;return e.length>=2&&(t+=" +"+(e.length-1)),t},t}(a.Component),le=Object(u.styled)(ce,function(e){var t=e.theme,i=e.className,n=e.multiplePeople,r=t.palette,a=t.fonts,o=Object(u.getGlobalClassNames)(S,t);return{root:[o.root,n&&o.multiplePeople,{padding:"8px 16px",position:"relative"},i],avatars:[o.avatars,{marginLeft:"-2px",height:"32px"}],avatar:[o.avatar,{display:"inline-block",verticalAlign:"top",position:"relative",textAlign:"center",width:32,height:32,selectors:{"&:after":{content:'" "',position:"absolute",left:"-1px",top:"-1px",right:"-1px",bottom:"-1px",border:"2px solid "+r.white,borderRadius:"50%"},":nth-of-type(2)":n&&{marginLeft:"-16px"}}}],details:[o.details,{left:n?"72px":"56px",height:32,position:"absolute",top:8,width:"calc(100% - 72px)"}],name:[o.name,{display:"block",fontSize:a.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:r.neutralPrimary,fontWeight:u.FontWeights.semibold}],activity:[o.activity,{display:"block",fontSize:a.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:r.neutralSecondary}]}},void 0,{scope:"DocumentCardActivity"}),de=Object(u.classNamesFunction)(),ue=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,i=t.actions,n=t.views,o=t.styles,s=t.theme,c=t.className;return this._classNames=de(o,{theme:s,className:c}),a.createElement("div",{className:this._classNames.root},i&&i.map(function(t,i){return a.createElement("div",{className:e._classNames.action,key:i},a.createElement(u.IconButton,Object(r.__assign)({},t)))}),n>0&&a.createElement("div",{className:this._classNames.views},a.createElement(k.Icon,{iconName:"View",className:this._classNames.viewsIcon}),n))},t}(a.Component),pe={root:"ms-DocumentCardActions",action:"ms-DocumentCardActions-action",views:"ms-DocumentCardActions-views"},me=Object(u.styled)(ue,function(e){var t=e.className,i=e.theme,n=i.palette,r=i.fonts,a=Object(u.getGlobalClassNames)(pe,i);return{root:[a.root,{height:"34px",padding:"4px 12px",position:"relative"},t],action:[a.action,{float:"left",marginRight:"4px",color:n.neutralSecondary,cursor:"pointer",selectors:{".ms-Button":{fontSize:r.mediumPlus.fontSize,height:34,width:34},".ms-Button:hover .ms-Button-icon":{color:i.semanticColors.buttonText,cursor:"pointer"}}}],views:[a.views,{textAlign:"right",lineHeight:34}],viewsIcon:{marginRight:"8px",fontSize:r.medium.fontSize,verticalAlign:"top"}}},void 0,{scope:"DocumentCardActions"}),he=Object(u.classNamesFunction)(),ge=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.location,i=e.locationHref,n=e.ariaLabel,r=e.onClick,o=e.styles,s=e.theme,c=e.className;return this._classNames=he(o,{theme:s,className:c}),a.createElement("a",{className:this._classNames.root,href:i,onClick:r,"aria-label":n},t)},t}(a.Component),_e=Object(u.styled)(ge,function(e){var t=e.theme,i=e.className,n=t.palette,r=t.fonts;return{root:[Object(u.getGlobalClassNames)(I,t).root,r.small,{color:n.themePrimary,display:"block",fontWeight:u.FontWeights.semibold,overflow:"hidden",padding:"8px 16px",position:"relative",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",selectors:{":hover":{color:n.themePrimary,cursor:"pointer"}}},i]}},void 0,{scope:"DocumentCardLocation"}),fe=i("jOlS");Object(fe.loadStyles)([{rawString:".ms-DocumentCardTile{height:100%;outline:transparent;position:relative}.ms-DocumentCardTile::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .ms-DocumentCardTile:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .ms-DocumentCardTile:focus:after{border-color:ActiveBorder}}.ms-DocumentCardTile .ms-DocumentCardTile-customIcon{position:relative;top:50%;line-height:normal;width:64px;height:64px;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:center;align-self:center;-webkit-transition:all 0.5s ease;transition:all 0.5s ease;font-size:"},{theme:"xxLargeFontSize",defaultValue:"28px"},{rawString:";font-weight:100;color:#fff}[dir='ltr'] .ms-DocumentCardTile .ms-DocumentCardTile-customIcon{left:50%}[dir='rtl'] .ms-DocumentCardTile .ms-DocumentCardTile-customIcon{right:50%}html[dir='ltr'] .ms-DocumentCardTile .ms-DocumentCardTile-customIcon{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}html[dir='rtl'] .ms-DocumentCardTile .ms-DocumentCardTile-customIcon{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardPreview{width:144px}.ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-bottom:none}[dir='ltr'] .ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='rtl'] .ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTitle{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font-weight:600}.ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCard-compact-image-overlap-text{position:absolute;bottom:8px;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";opacity:55%;border-radius:2px}[dir='ltr'] .ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCard-compact-image-overlap-text{left:106px}[dir='rtl'] .ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCard-compact-image-overlap-text{right:106px}.ms-DocumentCardTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCard-compact-image-overlap-text .ms-DocumentCard-image-overlap-text-section{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:1px 3px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ms-DocumentCardTile .ms-DocumentCardPreview-icon{bottom:8px}.ms-DocumentCardTile .ms-DocumentCardPreview-icon img{width:32px;height:32px}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardPreview{height:calc(100% - 140px)}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardTile-customIconPreview{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardLocation{padding:10px 12px 8px 12px;overflow:hidden;text-overflow:ellipsis}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardTitle{margin-top:4px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font-weight:600}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCard-image-overlap-text{position:absolute;top:calc(100% - 165px);right:8px;opacity:55%;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";border-radius:2px;padding-bottom:1px}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCard-image-overlap-text .ms-DocumentCard-image-overlap-text-section{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";padding:0px 3px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .has-location .ms-DocumentCardTitle{margin-top:0px;padding:0px 12px 12px 12px}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardActivity{padding:12px 12px 12px 12px}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardTile-titleArea{height:80px}.ms-DocumentCardTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardTile-titleArea .ms-DocumentCardLocation{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}\n"}]);var ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeyDown=function(e){if(e.which===u.KeyCodes.enter){var i=t.props.item,n=i.onClick,r=i.onClickHref;n?n(e):r&&(window.location.href=r)}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,i=e.ariaDescribedByElementId,n=e.useCompactDocumentCard;return a.createElement("div",{className:"ms-DocumentCardTile","data-is-focusable":!0,onKeyDown:this._onKeyDown,role:"listitem","aria-label":t,"aria-describedby":i},a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},n?this._renderCompactDocumentCard():this._renderNormalDocumentCard()))},t.prototype._renderCompactDocumentCard=function(){var e=this.props.item,t=e.people,i=e.activity,o=e.previewImages,s=e.getOverflowDocumentCountText,c=e.title,l=e.onClick,d=e.onClickHref,u=e.actions,p=e.customIconAcronym,m=e.customIconBgColor,h=e.className,g=!p||!m;return a.createElement(A,{onClick:l,onClickHref:d,type:n.compact,className:h,role:this.props.role,styles:ye},g&&a.createElement(E,{previewImages:o,getOverflowDocumentCountText:s}),this.props.item.imageOverlapText&&a.createElement("div",{className:"ms-DocumentCard-compact-image-overlap-text"},a.createElement("span",{className:"ms-DocumentCard-image-overlap-text-section"},this.props.item.imageOverlapText)),!g&&this._renderCustomIconPreview(m,p),a.createElement(z,null,a.createElement(q,{title:c,shouldTruncate:!0}),t&&t.length>0&&a.createElement(le,{activity:i,people:t})),u&&a.createElement(me,Object(r.__assign)({},u)))},t.prototype._renderNormalDocumentCard=function(){var e=this.props.item,t=e.people,i=e.activity,n=e.previewImages,o=e.getOverflowDocumentCountText,s=e.title,c=e.location,l=e.locationHref,d=e.hideLocation,p=e.locationOnClick,m=e.onClick,h=e.onClickHref,g=e.customIconAcronym,_=e.customIconBgColor,f=e.className,v=e.actions,y=!g||!_;if(n)for(var b=0,C=n;b<C.length;b++)C[b].accentColor=void 0;return a.createElement(A,{onClick:m,onClickHref:h,className:f,role:this.props.role,styles:ye},y&&a.createElement(E,{previewImages:n,getOverflowDocumentCountText:o}),this.props.item.imageOverlapText&&a.createElement("div",{className:"ms-DocumentCard-image-overlap-text"},a.createElement("span",{className:"ms-DocumentCard-image-overlap-text-section"},this.props.item.imageOverlapText)),!y&&this._renderCustomIconPreview(_,g),a.createElement("div",{className:Object(u.css)({"has-location":!!c&&!d},"ms-DocumentCardTile-titleArea")},c&&!d&&a.createElement(_e,{location:c,onClick:p,locationHref:l}),s?a.createElement(q,{title:s,shouldTruncate:!0}):a.createElement(q,{title:s,shouldTruncate:!1})),t&&t.length>0&&a.createElement(le,{activity:i,people:t}),v&&a.createElement(me,Object(r.__assign)({},v)))},t.prototype._renderCustomIconPreview=function(e,t){return a.createElement("div",{className:"ms-DocumentCardPreview ms-DocumentCardTile-customIconPreview"},a.createElement("div",{role:"presentation","aria-hidden":"true",className:"ms-DocumentCardTile-customIcon",style:{backgroundColor:e}},t))},t}(a.Component),ye={root:{boxShadow:Object(u.getTheme)().effects.elevation4,borderRadius:Object(u.getTheme)().effects.roundedCorner2,height:"calc(100% - 4px)",overflow:"hidden",selectors:{"&:hover:after":{border:0},"&:hover":{boxShadow:Object(u.getTheme)().effects.elevation8}}}},be=Object(u.classNamesFunction)(),Ce=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.logoIcon,i=e.styles,n=e.theme,r=e.className;return this._classNames=be(i,{theme:n,className:r}),a.createElement("div",{className:this._classNames.root},a.createElement(k.Icon,{iconName:t}))},t}(a.Component),Te={root:"ms-DocumentCardLogo"},xe=Object(u.styled)(Ce,function(e){var t=e.theme,i=e.className,n=t.palette,r=t.fonts;return{root:[Object(u.getGlobalClassNames)(Te,t).root,{fontSize:r.xxLargePlus.fontSize,color:n.themePrimary,display:"block",padding:"16px 16px 0 16px"},i]}},void 0,{scope:"DocumentCardLogo"}),we=Object(u.classNamesFunction)(),Se=function(e){function t(t){var i=e.call(this,t)||this;return Object(u.initializeComponentRef)(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.statusIcon,i=e.status,n=e.styles,o=e.theme,s=e.className,c={iconName:t,styles:{root:{padding:"8px"}}};return this._classNames=we(n,{theme:o,className:s}),a.createElement("div",{className:this._classNames.root},t&&a.createElement(k.Icon,Object(r.__assign)({},c)),i)},t}(a.Component),De={root:"ms-DocumentCardStatus"},Ie=Object(u.styled)(Se,function(e){var t=e.className,i=e.theme,n=i.palette,r=i.fonts;return{root:[Object(u.getGlobalClassNames)(De,i).root,r.medium,{margin:"8px 16px",color:n.neutralPrimary,backgroundColor:n.neutralLighter,height:"32px"},t]}},void 0,{scope:"DocumentCardStatus"});Object(fe.loadStyles)([{rawString:".ms-ConversationTile{height:100%;outline:transparent;position:relative}.ms-ConversationTile::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .ms-ConversationTile:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .ms-ConversationTile:focus:after{border-color:ActiveBorder}}.ms-ConversationTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardPreview{width:144px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.ms-ConversationTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-bottom:none}[dir='ltr'] .ms-ConversationTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='rtl'] .ms-ConversationTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardTile-customIconPreview{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-ConversationTile .ms-DocumentCard.ms-DocumentCard--compact .ms-ConversationTilePreview-iconContainer{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.ms-ConversationTile .ms-DocumentCardPreview-icon{bottom:8px}.ms-ConversationTile .ms-DocumentCardPreview-icon img{width:32px;height:32px}.ms-ConversationTile .ms-DocumentCardActivity{padding-bottom:16px}.ms-ConversationTile .ms-ConversationTile-TitlePreviewArea{height:calc(100% - 115px)}.ms-ConversationTile .ms-DocumentCardLogo i{color:#0072c6}\n"}]);var Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeyDown=function(e){if(e.which===u.KeyCodes.enter){var i=t.props.item,n=i.onClick,r=i.onClickHref;n?n(e):r&&(window.location.href=r)}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,i=e.ariaDescribedByElementId,n=e.useCompactDocumentCard;return a.createElement("div",{className:"ms-ConversationTile","data-is-focusable":!0,onKeyDown:this._onKeyDown,role:"listitem","aria-label":t,"aria-describedby":i},a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},n?this._renderCompactConversationTile():this._renderNormalConversationTile()))},t.prototype._renderCompactConversationTile=function(){var e=this.props.item,t=e.logoProps,i=e.people,o=e.activity,s=e.title,c=e.onClick,l=e.onClickHref,d=e.className,p=e.actions,m=t?t.logoIcon:"OutlookLogo",h={previewImages:[{imageFit:u.ImageFit.center,previewIconProps:{iconName:m,styles:{root:{fontSize:42,color:"#0072C6"}}}}]};return a.createElement(A,{onClick:c,onClickHref:l,type:n.compact,className:d,role:this.props.role,styles:ye},a.createElement(E,Object(r.__assign)({},h)),a.createElement(z,null,a.createElement(q,{title:s,shouldTruncate:!0}),i&&i.length>0&&a.createElement(le,{activity:o,people:i})),p&&a.createElement(me,Object(r.__assign)({},p)))},t.prototype._renderNormalConversationTile=function(){var e=this.props.item,t=e.logoProps,i=e.title,n=e.previewImages,o=e.emailPreview,s=e.statusProps,c=e.people,l=e.activity,d=e.onClick,u=e.onClickHref,p=e.className,m=e.actions;if(n)for(var h=0,g=n;h<g.length;h++)g[h].accentColor=void 0;return a.createElement(A,{onClick:d,onClickHref:u,className:p,role:this.props.role,styles:ye},a.createElement(xe,Object(r.__assign)({},t)),a.createElement("div",{className:"ms-ConversationTile-TitlePreviewArea"},i?a.createElement(q,{title:i,shouldTruncate:!0}):a.createElement(q,{title:i,shouldTruncate:!1}),o&&a.createElement(q,{title:o,shouldTruncate:!1,showAsSecondaryTitle:!0}),s&&a.createElement(Ie,Object(r.__assign)({},s))),c&&c.length>0&&a.createElement(le,{activity:l,people:c}),m&&a.createElement(me,Object(r.__assign)({},m)))},t}(a.Component);Object(fe.loadStyles)([{rawString:".ms-PlannerTile{height:100%;outline:transparent;position:relative}.ms-PlannerTile::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .ms-PlannerTile:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .ms-PlannerTile:focus:after{border-color:ActiveBorder}}.ms-PlannerTile .ms-DocumentCard.ms-DocumentCard--compact .ms-DocumentCardPreview{width:144px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.ms-PlannerTile .ms-DocumentCard.ms-DocumentCard--compact .ms-PlannerTile-customIconPreview{border-bottom:none}[dir='ltr'] .ms-PlannerTile .ms-DocumentCard.ms-DocumentCard--compact .ms-PlannerTile-customIconPreview{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='rtl'] .ms-PlannerTile .ms-DocumentCard.ms-DocumentCard--compact .ms-PlannerTile-customIconPreview{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PlannerTile .ms-DocumentCard.ms-DocumentCard--compact .ms-PlannerTile-iconContainer{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.ms-PlannerTile .ms-DocumentCardPreview-icon{bottom:8px}.ms-PlannerTile .ms-DocumentCardPreview-icon img{width:32px;height:32px}.ms-PlannerTile .ms-PlannerTasksHeader{min-height:24px;font-weight:600;font-size:16px;overflow:hidden;text-overflow:ellipsis;position:relative}[dir='ltr'] .ms-PlannerTile .ms-PlannerTasksHeader{padding-left:16px}[dir='rtl'] .ms-PlannerTile .ms-PlannerTasksHeader{padding-right:16px}.ms-PlannerTile .ms-PlannderTasksCount{width:40%}.ms-PlannerTile .ms-PlannerTasksLabel{width:60%}[dir='ltr'] .ms-PlannerTile .ms-PlannerTasksLabel{padding-left:10px}[dir='rtl'] .ms-PlannerTile .ms-PlannerTasksLabel{padding-right:10px}.ms-PlannerTile .ms-PlannerTasks-area{height:calc(100% - 145px)}.ms-PlannerTile .ms-PlannerTasksList{height:calc(100% - 42px);padding:0px 16px;font-weight:600}.ms-PlannerTile .ms-PlannerTask{margin-bottom:4px;overflow:hidden;text-overflow:ellipsis}.ms-PlannerTile .ms-PlannerTask-Icon{-webkit-box-flex:0;-ms-flex:none;flex:none;fill:#767676;color:#767676;width:24px;height:24px;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";line-height:24px;vertical-align:top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[dir='ltr'] .ms-PlannerTile .ms-PlannerTask-Icon{margin-left:8px}[dir='rtl'] .ms-PlannerTile .ms-PlannerTask-Icon{margin-right:8px}.ms-PlannerTile .ms-PlannerTask-TaskName{display:inline-block;background:none;background-color:transparent;vertical-align:bottom;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:80%;font-size:14px}[dir='ltr'] .ms-PlannerTile .ms-PlannerTask-TaskName{margin-left:10px}[dir='rtl'] .ms-PlannerTile .ms-PlannerTask-TaskName{margin-right:10px}.ms-PlannerTile .ms-PlannerTask-Status{font-weight:600;font-size:12px}.ms-PlannerTile .ms-DocumentCardActivity{padding-bottom:16px}[dir='ltr'] .ms-PlannerTile .ms-DocumentCardActivity{left:0}[dir='rtl'] .ms-PlannerTile .ms-DocumentCardActivity{right:0}.ms-PlannerTile .ms-DocumentCardLogo i{color:#26764a}\n"}]);var Ae=i("YYjE"),ke=i.n(Ae),Le=i("ynV5"),Oe=function(e){function t(t){var i=e.call(this,t)||this;i._onKeyDown=function(e){if(e.which===u.KeyCodes.enter){var t=i.props.item,n=t.onClick,r=t.onClickHref;n?n(e):r&&(window.location.href=r)}};var n=i.props.item.tasks;return i._tasks=n&&n.filter(function(e){return e.index<3}).map(function(e){return e}),i.state={canSelect:"all"},i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,i=e.ariaDescribedByElementId,n=e.useCompactDocumentCard;return a.createElement("div",{className:"ms-PlannerTile","data-is-focusable":!0,onKeyDown:this._onKeyDown,role:"listitem","aria-label":t,"aria-describedby":i},a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},n?this._renderCompactPlannerTile():this._renderNormalPlannerTile()))},t.prototype._renderCompactPlannerTile=function(){var e=this.props.item,t=e.logoProps,i=e.people,o=e.activity,s=e.title,c=e.onClick,l=e.onClickHref,d=e.className,p=t?t.logoIcon:"Planner",m={previewImages:[{imageFit:u.ImageFit.center,previewIconProps:{iconName:p,styles:{root:{fontSize:42,color:"#26764a"}}}}]};return a.createElement(A,{onClick:c,onClickHref:l,type:n.compact,className:d,role:this.props.role,styles:ye},a.createElement(E,Object(r.__assign)({},m)),a.createElement(z,null,a.createElement(q,{title:s,shouldTruncate:!0}),i&&i.length>0&&a.createElement(le,{activity:o,people:i})))},t.prototype._renderNormalPlannerTile=function(){var e=this.props.item,t=e.logoProps,i=e.title,n=e.people,o=e.activity,s=e.onClick,c=e.onClickHref,l=e.planCardType,d=e.className,u=3===l;return a.createElement(A,{onClick:s,onClickHref:c,className:d,role:this.props.role,styles:ye},a.createElement(xe,Object(r.__assign)({},t)),a.createElement(_e,{location:i,onClick:s,locationHref:c}),a.createElement("div",{className:"ms-PlannerTasks-area"},u?this._renderTasksHeader():this._renderTasksList()),n&&n.length>0&&a.createElement(le,{activity:o,people:n}))},t.prototype._renderTasksHeader=function(){var e=this.props.item,t=e.count,i=3===e.planCardType?ke.a.EditsTasksHeader:ke.a.AssignedTasksHeader;return a.createElement("div",{className:"ms-PlannerTasksHeader"},a.createElement("span",{className:"ms-PlannderTasksCount"},t),a.createElement("span",{className:"ms-PlannerTasksLabel"},Le.format(i)))},t.prototype._renderTasksList=function(){var e=this.props.item,t=e.count,i=e.statusProps;return a.createElement(a.Fragment,null,a.createElement("div",{className:"ms-PlannerTasksList",role:"group","aaria-label":ke.a.tasksListAriaLabel},t>0&&this._tasks.map(function(e){return a.createElement("div",{className:"ms-PlannerTask",key:e.id},a.createElement(k.Icon,{className:"ms-PlannerTask-icon",iconName:"RadioBullet"}),a.createElement("span",{className:"ms-PlannerTask-TaskName"},e.title))})),i&&a.createElement("div",{className:"ms-PlannerTask-Status"},a.createElement(Ie,Object(r.__assign)({},i))))},t}(a.Component);Object(fe.loadStyles)([{rawString:".ms-TipTile{height:100%;outline:transparent;position:relative}.ms-TipTile::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .ms-TipTile:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .ms-TipTile:focus:after{border-color:ActiveBorder}}.ms-TipTile .ms-DocumentCard:not(.ms-DocumentCard--compact) .ms-DocumentCardPreview{height:calc(100% - 140px)}.ms-TipTile .ms-Button.ms-Button--command{font-size:14px;overflow:hidden}.ms-TipTile .ms-Button.ms-Button--command:hover .ms-Button-label,.ms-TipTile .ms-Button.ms-Button--command:focus .ms-Button-label,.ms-TipTile .ms-Button.ms-Button--command:active .ms-Button-label{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-TipTile .ms-Button.ms-Button--command .ms-Button-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-TipTile .ms-TipTile-titleArea{height:94px}.ms-TipTile .ms-TipTile-title{display:block;padding:12px 16px 12px 16px;position:relative;text-decoration:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font-weight:600}.ms-TipTile .ms-TipTile-detail{display:block;font-weight:400;font-size:14px;padding:0px 16px 8px 16px;line-height:18px}.ms-TipTile .ms-TipTile-action{padding:0 12px}.ms-TipTile .ms-DocumentCard--compact .ms-Button.ms-Button--command{padding:0px 16px}\n"}]);var Ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeyDown=function(e){if(e.which===u.KeyCodes.enter){var i=t.props.item,n=i.onClick,r=i.onClickHref;n?n(e):r&&(window.location.href=r)}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,i=e.ariaDescribedByElementId,n=e.useCompactDocumentCard;return a.createElement("div",{className:"ms-TipTile","data-is-focusable":!0,onKeyDown:this._onKeyDown,role:"listitem","aria-label":t,"aria-describedby":i},a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},n?this._renderCompactTipTile():this._renderNormalTipTile()))},t.prototype._renderCompactTipTile=function(){var e=this.props.item,t=e.tipDetailContent,i=e.tipActionButtonIcon,o=e.tipActionLabel,s=e.onClick,c=e.onClickHref,l=e.previewImages,d=e.className,p=e.actions;return a.createElement(A,{onClick:s,onClickHref:c,type:n.compact,className:d,role:this.props.role,styles:ye},a.createElement(E,{previewImages:l}),a.createElement(z,null,a.createElement(q,{title:t,shouldTruncate:!0}),a.createElement(u.CommandButton,{iconProps:{iconName:i},text:o})),p&&a.createElement(me,Object(r.__assign)({},p)))},t.prototype._renderNormalTipTile=function(){var e=this.props.item,t=e.title,i=e.tipDetailContent,n=e.tipActionButtonIcon,o=e.tipActionLabel,s=e.onClick,c=e.onClickHref,l=e.previewImages,d=e.className,p=e.actions;return a.createElement(A,{onClick:s,onClickHref:c,className:d,role:this.props.role,styles:ye},a.createElement(E,{previewImages:l}),a.createElement("div",{className:"ms-TipTile-titleArea"},a.createElement("div",{className:"ms-TipTile-title"},t),a.createElement("div",{className:"ms-TipTile-detail"},i)),a.createElement(u.CommandButton,{className:"ms-TipTile-action",iconProps:{iconName:n},text:o}),p&&a.createElement(me,Object(r.__assign)({},p)))},t}(a.Component);Object(fe.loadStyles)([{rawString:".ms-CardList .hiddenSpan{display:none}.ms-CardList .ms-List-cell{vertical-align:top;display:inline-block;margin-bottom:20px}.ms-CardList .ms-List-cell .ms-FocusZone{height:100%}.ms-CardList .ms-DocumentCard:not(.ms-DocumentCard--compact){position:relative;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;min-width:212px;max-width:286px}.ms-CardList .ms-DocumentCard:not(.ms-DocumentCard--compact).ms-DocumentCard--actionable:hover{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ms-CardList .ms-CardList-title{font-size:"},{theme:"xxLargeFontSize",defaultValue:"28px"},{rawString:";font-weight:100;margin:0 0 20px}.ms-CardList-lgDown .ms-CardList-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:"}@media (max-width: 479.99999px){.ms-CardList .ms-List-cell{margin-bottom:8px}[dir='ltr'] .ms-CardList .ms-List-cell{margin-right:0}[dir='rtl'] .ms-CardList .ms-List-cell{margin-left:0}}\n"}]);var Ne,je,Re,ze,Fe=function(e){function t(t){var i=e.call(this,t)||this;return i._onRenderCell=function(e,t){var n=i.props,r=n.getAriaLabel,o=n.ariaDescription,s=n.onRenderMissingItem,c=n.getAriaRole,l=n.cardMargin;if(!e)return s?s(t):null;var d=r?r(e,t):null,p=c?c(e,t):null,m=o&&!d?"CardListDesc_ea223a47-285b-4aad-af20-eb67d5257904":null;if(e.previewImages&&e.previewImages.length>0)for(var h=0,g=e.previewImages;h<g.length;h++){var _=g[h];_.imageFit===u.ImageFit.center?(_.width=i._tileWidth,_.height=i._previewImageHeight,i._useCompactDocumentCard&&(_.width=144,_.height=106)):(_.width=i._tileWidth,i._useCompactDocumentCard&&(_.width=144))}var f=(t+1)%i._itemCountPerRow==0?0:void 0!==l?l:20,v=i._isRTL?{width:i._tileWidth,height:i._tileHeight,marginLeft:f}:{width:i._tileWidth,height:i._tileHeight,marginRight:f},y=e.linkInterceptionData&&i._platform.isMobile;return a.createElement("div",{role:y?"button":void 0,"data-sp-action":y?JSON.stringify({key:e.linkInterceptionData.key,args:{command:e.linkInterceptionData.command,url:e.linkInterceptionData.url||e.onClickHref,version:"1.0"}}):void 0,style:v},1===e.cardType?a.createElement(Ee,{item:e,ariaLabel:d,role:p,ariaDescribedByElementId:m,useCompactDocumentCard:i._useCompactDocumentCard}):2===e.cardType?a.createElement(Pe,{item:e,ariaLabel:d,role:p,ariaDescribedByElementId:m,useCompactDocumentCard:i._useCompactDocumentCard}):3===e.cardType?a.createElement(Oe,{item:e,ariaLabel:d,role:p,ariaDescribedByElementId:m,useCompactDocumentCard:i._useCompactDocumentCard}):a.createElement(ve,{item:e,ariaLabel:d,role:p,ariaDescribedByElementId:m,useCompactDocumentCard:i._useCompactDocumentCard}))},i._getItemCountForPage=function(e,t){var n=t?t.width:0,r=void 0!==i.props.cardMargin?i.props.cardMargin:20,a=10;return i._useCompactDocumentCard?(i._tileHeight=109,i._tileWidth=n,1):(n&&(i._itemCountPerRow=Math.floor((n+r)/(212+r))||1,i._itemCountPerRow=Math.min(4,i._itemCountPerRow),a=Math.ceil(a/i._itemCountPerRow)*i._itemCountPerRow,i._tileWidth=Math.min((n-(i._itemCountPerRow-1)*r)/i._itemCountPerRow,286),i._previewImageHeight=Math.floor(9*i._tileWidth/16),i._tileHeight=i._previewImageHeight+140),a)},i._itemCountPerRow=1,i._platform=new g.PlatformDetection,i}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.items,i=e.title,n=e.ariaDescription,r=e.ariaLabelForGrid,o=e.useCompactLayout;return this._useCompactDocumentCard=o||this.props.responsiveMode===h.ResponsiveMode.small,this._isRTL=Object(u.getRTL)(),a.createElement("div",{className:Object(u.css)("ms-CardList",{"ms-CardList-lgDown":this.props.responsiveMode<=h.ResponsiveMode.large}),role:"group","aria-label":r},i&&a.createElement("h2",{className:"ms-CardList-title"},i),n&&a.createElement("span",{className:"hiddenSpan",id:"CardListDesc_ea223a47-285b-4aad-af20-eb67d5257904",role:"presentation"}," ",n),a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.horizontal,isCircularNavigation:!0,isInnerZoneKeystroke:function(e){return e.which===u.KeyCodes.down}},a.createElement(u.Fabric,null,a.createElement(u.List,{componentRef:this._resolveRef("_list"),items:t,role:"list",onRenderCell:this._onRenderCell,getItemCountForPage:this._getItemCountForPage,ignoreScrollingState:!g.Killswitch.isActivated("dae417bb-55ce-4b73-bcbc-44eaf833051b","05/22/2020","Stop scrolling setState of Fabric List")}))))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this._list&&this._list.forceUpdate()},Object(r.__decorate)([h.withResponsiveMode],t)}(u.BaseComponent),Ue=i("hiL/");!function(e){e[e.NoChange=0]="NoChange",e[e.Add=1]="Add",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e[e.Rename=4]="Rename",e[e.MoveAway=5]="MoveAway",e[e.MoveInto=6]="MoveInto",e[e.Restore=7]="Restore",e[e.RoleAdd=8]="RoleAdd",e[e.RoleDelete=9]="RoleDelete",e[e.RoleUpdate=10]="RoleUpdate",e[e.AssignmentAdd=11]="AssignmentAdd",e[e.AssignmentDelete=12]="AssignmentDelete",e[e.MemberAdd=13]="MemberAdd",e[e.MemberDelete=14]="MemberDelete",e[e.SystemUpdate=15]="SystemUpdate",e[e.Navigation=16]="Navigation",e[e.ScopeAdd=17]="ScopeAdd",e[e.ScopeDelete=18]="ScopeDelete",e[e.ListContentTypeAdd=19]="ListContentTypeAdd",e[e.ListContentTypeDelete=20]="ListContentTypeDelete",e[e.Dirty=21]="Dirty",e[e.Activity=22]="Activity",e[e.YouViewed=23]="YouViewed",e[e.Trending=24]="Trending",e[e.Sent=25]="Sent",e[e.TaskDue=26]="TaskDue"}(Ne||(Ne={})),function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Page=2]="Page",e[e.List=3]="List",e[e.Tip=4]="Tip",e[e.OneNote=5]="OneNote",e[e.Web=6]="Web",e[e.Email=7]="Email",e[e.Planner=8]="Planner",e[e.Other=9]="Other"}(je||(je={})),function(e){e[e.HomePage=0]="HomePage",e[e.ActivityL2Page=1]="ActivityL2Page",e[e.OtherPage=2]="OtherPage"}(Re||(Re={})),function(e){e[e.GetChanges=0]="GetChanges",e[e.GetChangesWithExtendedProperties=1]="GetChangesWithExtendedProperties",e[e.BetaActivities=2]="BetaActivities"}(ze||(ze={}));var Be=function(){function e(){}return e.getIconUrl=function(t){var i=e.assetIconsMap[t];return i[window.devicePixelRatio>=2&&i.length>=2?1:0]},e.assetIconsMap={calendar:[i("oJ/X"),i("GEk3")],"custom-list":[i("zjh1"),i("uS+E")],"doc-library":[i("gKNL"),i("jO1W")],"sp-page":[i("ZXnB"),i("JvOe")],"task-list":[i("hSLw"),i("ASFM")],"task-list-tipcard":[i("qrvM"),i("ujmI")],"upload-doc-tipcard":[i("p9NL"),i("OUAI")],person:[i("NNsw")],preview:[i("ux2w")],"empty-state":[i("WEGg"),i("HDFi")]},e}(),qe=i("Ycni"),He=[Ne.Add,Ne.Update,Ne.Rename,Ne.Delete,Ne.Activity],Me=function(){function e(){}return e.aggregate=function(t){for(var i=[],n={},r={},a={},o={},s={},c={},l={},d=0,u=t;d<u.length;d++){var p=u[d];if(0===p.changeObjectType){var m=p.listId+p.itemId;if(He.indexOf(p.changeType)<0)continue;if(p.changeType===Ne.Delete)c[m]=p;else{var h=!1;if(c[m])h=!0;else for(var g in c)if(0===p.serverRelativeUrl.indexOf(c[g].serverRelativeUrl)){h=!0;break}if(h)continue;if(s[m]){var _=s[m];p.previewImageUrl=_.previewImageUrl,p.url=_.url,p.latestName=_.latestName}else p.changeType===Ne.Rename&&(s[m]=p);var f=o[e.getEditActivityKey(p)],v=r[m],y=!1;if(p.activityObjectType===je.OneNote)p.latestName=p.parentFolderName,p.url=p.parentFolderUrl+"?web=1",p.parentFolderUrl=e._getParentFolderUrl(p.parentFolderUrl),p.changeType=Ne.Update;else if(l[p.url]){var b=l[p.url];p.iconUrl=b.activities[0].iconUrl,p.accentColor=b.activities[0].accentColor;continue}if(p.activityObjectType===je.Item&&(p.latestName=p.parentFolderName,p.url=p.parentFolderUrl,p.parentFolderUrl=e._getParentFolderUrl(p.parentFolderUrl),p.changeType=Ne.Update,p.activityObjectType=je.List),v&&p.changeType===Ne.Add&&f&&e.getMinutesDiff(p.date,f.date)<=30&&(e.removeActivity(f,v,i),p.date=f.date,y=!0),f&&!y){p.changeType!==Ne.Activity||1!==p.changeActivityType||f.changeActivityType||(f.changeActivityType=1);continue}e.processActivity(p,i,n,r,l,a,o,y)}}else 1===p.changeObjectType&&(p.changeType!==Ne.Update&&p.changeType!==Ne.Add||(a[p.listId]?(p.changeType=Ne.Update,e.updateExistingAggregate(p,a[p.listId],!1)):i.push(e.createAggregate(p))))}return i.sort(function(e,t){return e.date>t.date?-1:1})},e.createAggregate=function(e){return{activities:[e],editors:e.editor?[e.editor]:[],changeType:e.changeType,aggregateType:0,date:e.date}},e.processActivity=function(t,i,n,r,a,o,s,c){if(!(0!==t.changeObjectType&&1!==t.changeObjectType||t.changeType!==Ne.Add&&t.changeType!==Ne.Update&&t.changeType!==Ne.Rename)){t.changeType===Ne.Rename&&(t.changeType=Ne.Update);var l=e.getAggregateKey(t),d=t.changeType===Ne.Add?n:r,u=d[l];if(t.activityObjectType===je.OneNote?u=a[t.url]:t.activityObjectType===je.List&&(u=o[t.listId]),u)e.updateExistingAggregate(t,u,c);else{var p=e.createAggregate(t);i.push(p),d[l]=p,t.activityObjectType===je.OneNote?a[t.url]=p:t.activityObjectType===je.List&&(o[t.listId]=p)}t.changeType===Ne.Update&&(s[e.getEditActivityKey(t)]=t)}},e.removeActivity=function(t,i,n){var r=i.activities.indexOf(t);r>=0&&i.activities.splice(r,1),i.activities.length>0?(e.updateEditors(i),i.date=i.activities[0].date,1===i.activities.length&&(i.aggregateType=0)):n.indexOf(i)>=0&&n.splice(n.indexOf(i),1)},e.updateExistingAggregate=function(t,i,n){var r=i.activities.indexOf(t);r>=0?i.activities[r]=t:i.activities.push(t),n&&i.activities.sort(function(e,t){return e.date>t.date?-1:1}),e.updateEditors(i),i.date=i.activities[0].date,i.activities.length>1&&(i.aggregateType=t.changeType===Ne.Add?1:2)},e.updateEditors=function(e){for(var t={},i=[],n=0,r=e.activities;n<r.length;n++){var a=r[n],o=a.editor.name+a.editor.email;t[o]||(i.push(a.editor),t[o]=a.editor)}e.editors=i},e.getAggregateKey=function(t){var i;return t.changeType===Ne.Add?i=t.editor.name+t.listId+e.getDateString(t):t.changeType===Ne.Update&&(i=t.listId+t.itemId),i},e.getMinutesDiff=function(e,t){var i=t.getTime()-e.getTime();return Math.ceil(Math.abs(i)/6e4)},e.getDateString=function(e){if(!e.relativeTimeFromServer){var t=e.date;return t.getUTCFullYear()+"_"+(t.getUTCMonth()+1)+"_"+t.getUTCDate()}var i=e.relativeTimeFromServer.split("|");if("0"===i[0])return e.relativeTimeFromServer.substring(2);var n=i[2],r=i.length>=4?i[3]:void 0;switch(n){case"1":case"2":case"3":case"4":case"6":case"9":return"today";case"5":return"yesterday";case"7":case"8":return r}},e.getLocalizedRelativeTime=function(e){return e.date?qe.LocaleFormat.formatRelativeTimeApproximate(new Date(e.date.toString())):""},e.getEditActivityKey=function(e){return e.editor.name+e.listId+e.itemId},e.deduplicateActivities=function(t){for(var i,n=[],r={},a=[0,1,5,4],o=0;o<t.length;o++){var s=t[o];s.activityObjectType===je.Item&&s.changeType!==Ne.Delete&&(s.activityObjectType=je.List,s.changeObjectType=1,s.changeType=Ne.Update,s.itemId=void 0,s.latestName=s.parentFolderName,s.url=s.parentFolderUrl),a.indexOf(s.changeObjectType)>=0&&(r[i=e._getDeduplicationLookupStr(s)]||s.changeType!==Ne.Delete&&(r[i]=!0,n.push(s)))}return n},e._getDeduplicationLookupStr=function(e){return e.itemId?(e.itemId+","+e.listId+","+e.webId+","+e.siteId).toLowerCase():(e.listId+","+e.webId+","+e.siteId).toLowerCase()},e._getParentFolderUrl=function(e){var t,i=e.lastIndexOf("/");return i>0&&(t=e.substr(0,i)),t},e}(),Ke=i("8sWK");i("x4he");var We,Ge,Ve,Ze,Qe,Ye,Je,Xe,$e,et,tt,it,nt=Be.getIconUrl("empty-state"),rt=Ue.Icons.getIconUrl("",16),at=function(e){function t(t){var i=e.call(this,t)||this;return i._convertToCardItems=i._convertToCardItems.bind(i),i._getDetail=i._getDetail.bind(i),i._generalClickTagName=Re[i.props.hostPageLoggingType]+".Activity.Click",i.state={items:t.items},i._setupLogoForCreateSiteActivity(),i._async=new u.Async(i),i}var i;return Object(r.__extends)(t,e),i=t,t.prototype.render=function(){var e=this.props.seeAllLink,t=this._convertToCardItems(this.props.items),i=!t||!t.length,n=a.createElement("div",{className:"c_a_7cc3b315"},a.createElement(u.Image,Object(r.__assign)({},{src:nt,width:"168px"},{className:"e_a_7cc3b315",role:"presentation"})),a.createElement("div",{className:"f_a_7cc3b315"},Ke.u," "),a.createElement("div",{className:"g_a_7cc3b315"},Ke.t," ")),o=a.createElement("div",{className:Object(u.css)("b_a_7cc3b315"),"data-automation-id":"siteActivity"},i?n:a.createElement(Fe,{items:t,ariaLabelForGrid:Ke.w,ariaDescription:Ke.w,useCompactLayout:this.props.useCompactLayout,getAriaRole:this._getAriaRole,getAriaLabel:this._getAriaLabel}));return a.createElement(p.WebPartChrome,{seeAllLink:e,showTitle:!0,title:Ke.N,isEditMode:!1,contentElement:o})},t.prototype.componentDidMount=function(){this._renderComplete()},t.prototype.componentDidUpdate=function(){this._renderComplete()},t.prototype._renderComplete=function(){var e=this.props,t=e.items,i=e.renderCompleted;t&&i&&this._async.setTimeout(function(){i()},0)},t.prototype._setupLogoForCreateSiteActivity=function(){var e,t=this,i=this.state.items,n=i.length;if(n>=3){var r=i[n-3].activities[0];r&&r.activityObjectType===je.Web&&r.changeType===Ne.Add&&(e=r)}e&&!e.iconUrl&&this.props.provider.getAcronymData().then(function(n){e.customIconAcronym=n.acronym,e.customIconBgColor=n.color,t.setState({items:i})})},t.prototype._getAriaLabel=function(e){var t="";if(1===e.cardType)t=d.StringHelper.format(Ke.H,e.title,e.tipDetailContent,e.tipActionLabel);else{var i=e.people&&e.people.length>0?e.people[0].name:"";e.people.length>=2&&(i=d.StringHelper.format(Ke.b,i,e.people.length-1)),t=2===e.cardType?d.StringHelper.format(Ke.n,e.title,e.emailPreview,i,e.activity,e.hasAttachment?Ke.v:""):d.StringHelper.format(Ke.a,e.location,e.title,i,e.activity)}return t},t.prototype._getAriaRole=function(e){return"link"},t.prototype._getDetail=function(e){var t=e.activities[0],i=Me.getLocalizedRelativeTime(t),n="";if(1===e.aggregateType)n=t.activityObjectType===je.Item?Ke.i:Ke.h;else if(0===e.aggregateType&&1===t.changeActivityType)n=Ke.D;else if(t.changeType===Ne.Update)switch(t.activityObjectType){case je.List:n=Ke.r;break;case je.Planner:n=Ke.s;break;default:n=Ke.q}else if(t.changeType===Ne.Add)switch(t.activityObjectType){case je.Web:n=Ke.k;break;case je.List:n=Ke.d;break;case je.Planner:n=Ke.l;break;default:n=Ke.c}else if(t.changeType===Ne.YouViewed)n=Ke.M;else{if(t.changeType===Ne.Trending)return"";t.changeType===Ne.Sent?n=Ke.C:t.changeType===Ne.TaskDue&&(n=Ke.E)}return n&&(n=d.StringHelper.format(n,i)),n},t.prototype._convertToCardItems=function(e){var t=this,i=this.props.hostPageLoggingType;return e.map(function(e){var n=e.activities[0],r=n.activityObjectType===je.Tip,a=n.activityObjectType===je.Email,o=n.activityObjectType===je.Planner,c={};if(n.url&&(c.linkInterceptionData={command:p.WebViewUtility.documentCommand,key:p.WebViewUtility.documentKey}),r){c.cardType=1,c.title=n.latestName,c.tipDetailContent=n.tipDetail,c.tipActionButtonIcon=n.tipActionIcon,c.tipActionLabel=n.tipActionLabel,c.previewImages=[t._getPreviewImageFromActivity(n)],c.onClick=function(e){var r={name:t._generalClickTagName,extraData:n.rankDetails};s._EngagementLogger.log(r);var a="Tile.Tip.Click";void 0!==i&&(a=Re[i]+a),s._EngagementLogger.logEvent(a,e.type),n.onClick?n.onClick(e):n.tipActionUrl&&Object(p.handleItemNavigation)(n.tipActionUrl)};var l="Tile.Tip.Render";void 0!==i&&(l=Re[i]+l);var u={name:l,extraData:n.rankDetails};s._EngagementLogger.log(u)}else{if((a||o)&&(c.onClickHref=n.url,c.title=n.latestName,c.activity=t._getDetail(e),c.people=e.editors,c.previewImages=[t._getPreviewImageFromActivity(n)]),a)c.cardType=2,c.emailPreview=n.emailPreview,c.hasAttachment=n.hasAttachments,c.hideLocation=!0,c.logoProps={logoIcon:"OutlookLogo"},c.hasAttachment&&(c.statusProps={statusIcon:"attach",status:Ke.m});else if(o){if(c.cardType=3,c.logoProps={logoIcon:"PlannerLogo"},c.tasks=n.tasks,c.tasks=t._addIndexToTasks(c.tasks),c.id=n.planId,c.planCardType=n.planCardType,c.count=n.count,1===c.planCardType)c.statusProps={statusIcon:"calendar",status:Ke.o};else if(4===c.planCardType)c.statusProps={statusIcon:"calendar",status:Ke.p};else if(2===c.planCardType){var m=d.StringHelper.format(Ke.F,c.count);c.statusProps={statusIcon:"clipboardList",status:m}}}else{c.cardType=0,c.customIconAcronym=n.customIconAcronym,c.customIconBgColor=n.customIconBgColor,c.location=n.listTitle||n.parentFolderName,c.locationHref=n.parentFolderUrl,n.activityObjectType===je.List&&(c.hideLocation=!0);var h=[];if(1===e.aggregateType){c.title=d.StringHelper.format(Ke.j,e.activities.length),c.onClickHref=n.parentFolderUrl;for(var g=e.activities&&e.activities.length>1,_=0,f=e.activities;_<f.length;_++){var v=f[_];h.push(t._getPreviewImageFromActivity(v,g))}c.getOverflowDocumentCountText=t._getOverflowDocumentCountText}else c.title=t._removeExtension(n.latestName,".aspx"),c.onClickHref=n.url,h=[t._getPreviewImageFromActivity(n)];c.previewImages=h,c.activity=t._getDetail(e),c.people=e.editors,c.locationOnClick=function(e){var r={name:t._generalClickTagName,extraData:n.rankDetails};s._EngagementLogger.log(r);var a="Location.{0}Activity.Click";void 0!==i&&(a=Re[i]+a);var o=d.StringHelper.format(a,je[n.activityObjectType]);s._EngagementLogger.logEvent(o,e.type),o=d.StringHelper.format(a,Ne[n.changeType]),s._EngagementLogger.logEvent(o,e.type),Object(p.handleItemNavigation)(c.locationHref),e.stopPropagation(),e.preventDefault()}}var y="EditPlan";o&&(n.changeType===Ne.Add?y="TaskAssignment":n.changeType===Ne.TaskDue&&(y="TaskDue")),c.onClick=function(e){var r={name:t._generalClickTagName,extraData:n.rankDetails};s._EngagementLogger.log(r);var a="Tile.{0}Activity.Click";o&&(a="Tile.{0}"+y+"Activity.Click"),void 0!==i&&(a=Re[i]+a);var l=d.StringHelper.format(a,je[n.activityObjectType]);s._EngagementLogger.logEvent(l,e.type),l=d.StringHelper.format(a,Ne[n.changeType]),s._EngagementLogger.logEvent(l,e.type);var u=c.onClickHref,m=e.target;"a"===m.tagName.toLowerCase()&&(u=m.href),Object(p.handleItemNavigation)(u),e.stopPropagation(),e.preventDefault()};var b="Tile.{0}Activity.Render";o&&(b="Tile.{0}"+y+"Activity.Render"),l=d.StringHelper.format(b,je[n.activityObjectType]),void 0!==i&&(l=Re[i]+l),u={name:l,extraData:n.rankDetails},s._EngagementLogger.log(u)}return c})},t.prototype._addIndexToTasks=function(e){if(!e)return null;for(var t=0;t<e.length;t++)e[t].index=t;return e},t.prototype._getOverflowDocumentCountText=function(e){var t;return e>0&&(t=d.StringHelper.format(Ke.x,e)),t},t.prototype._getPreviewImageFromActivity=function(e,t){var n=e.previewImageUrl?{previewImageSrc:e.previewImageUrl,iconSrc:t?e.smallIconUrl:e.iconUrl,accentColor:e.accentColor,name:e.latestName,url:e.url}:{previewImageSrc:e.iconUrl,imageFit:u.ImageFit.center,accentColor:e.accentColor?e.accentColor:i._defaultAccentColor,name:e.latestName,url:e.url,previewIconProps:e.previewIconProps};return t&&!n.iconSrc&&(n.iconSrc=rt),n},t.prototype._removeExtension=function(e,t){var i=e;if(e){var n=e.lastIndexOf(".");(n>=0?e.substring(n).toLowerCase():"")===t&&(i=e.substring(0,n))}return i},t._defaultAccentColor=Ue.Icons.getIconColorFromExtension(""),i=Object(r.__decorate)([h.withResponsiveMode],t)}(a.Component),ot=i("vlQI");!function(e){e[e.HEADER=0]="HEADER",e[e.NAV=1]="NAV",e[e.FOOTER=2]="FOOTER",e[e.SEARCHBOX=3]="SEARCHBOX"}(We||(We={})),function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL"}(Ge||(Ge={})),function(e){e[e.FULLBLEED=0]="FULLBLEED",e[e.WITHLEFTNAV=1]="WITHLEFTNAV"}(Ve||(Ve={})),function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(Ze||(Ze={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(Qe||(Qe={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.EXTENDED=1]="EXTENDED",e[e.STACKED=2]="STACKED"}(Ye||(Ye={})),function(e){e[e.Strong=0]="Strong",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.None=3]="None"}(Je||(Je={})),function(e){e[e.NoWarning=0]="NoWarning",e[e.Warning=1]="Warning",e[e.OverQuota=2]="OverQuota"}(Xe||(Xe={})),function(e){e[e.Default=0]="Default",e[e.AllPages=1]="AllPages",e[e.ModernOnly=2]="ModernOnly",e[e.Hidden=3]="Hidden"}($e||($e={})),function(e){e[e.None=0]="None",e[e.PrivateChannel=1]="PrivateChannel",e[e.SharedChannel=2]="SharedChannel",e[e.StandardChannel=3]="StandardChannel"}(et||(et={})),function(e){e[e.Default=0]="Default",e[e.Tenant=1]="Tenant",e[e.Hub=2]="Hub",e[e.Site=3]="Site"}(tt||(tt={})),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader"}(it||(it={}));var st=function(){function e(e,t){var i=this._pageContext=t.pageContext,n=t.tokenProvider,a=t.dataRequestorType,o=void 0===a?function(e){function t(t){return e.call(this,t,{pageContext:i,tokenProvider:n})||this}return Object(r.__extends)(t,e),t}(g.DataRequestor):a,s=e.dataSourceName,c=void 0===s?"DataSource":s;this.dataRequestor=new o({qosName:c})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,i,n,r,a,o,s,c,l,d,u,p){void 0===r&&(r="POST");var m=e(),h=n&&n(),g=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:i,additionalPostData:h,method:r,additionalHeaders:a,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:l,telemetryHandler:d,qosExtraData:u,needsRequestDigest:g,authToken:p})},e}();function ct(e){for(var t="";t.length<e;){var i=16*Math.random();t+=(i|=0).toString(16)}return t}function lt(){var e=[];e.push(ct(8)),e.push(ct(4));var t="4"+ct(3);e.push(t);var i=ct(4),n=parseInt(i[0],16);return n&=3,i=(n|=8).toString(16)+i.substr(1),e.push(i),e.push(ct(12)),e.join("-")}var dt,ut="undefined"==typeof window?self:window;!function(e){e.success="success",e.error="error"}(dt||(dt={}));var pt=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var i,n=e,a=e.toLowerCase(),o=function(e){var t;function i(i){return t=RegExp(i+"(\\d+)([\\d.]*)").exec(e)}e=e.toLowerCase();var n=i("msie ")||i("trident.*rv:"),r=t&&"9"===t[1],a=!t&&i("edge/"),o=!t&&i("edg/"),s=!t&&i("fxios|firefox/"),c=!t&&i("(?:chrome|crios)/"),l=!t&&/safari\/(\d+)/.test(e);return l&&i("version/"),{browserName:n?"IE":a?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":l?"Safari":"NA",isChrome:!!c,isEdge:!!a,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!n,isIE9:!!r,isSafari:!!l,matchedBrowser:t}}(a),s={browserMajor:(i=o.matchedBrowser)&&parseInt(i[1],10)||0,browserMinor:i&&i[2]&&i[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),i=t||/ipad|iphone|ipod|android/.exec(e),n=i&&i[0],r="android"===n,a="ipad"===n,o=!!n&&!r,s=!i&&e.indexOf("macintosh")>-1,c=!i&&e.indexOf("windows nt")>-1;return{isAndroid:r,isIOS:o,isIPad:a,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!i,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":r?"Android":"NA"}}(a),l=c.isMobile,d=/electron\/\\d+[\\d.]*/.test(a),u=a.indexOf("winappwipenabled")>-1,p=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),m=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(a),h=!1,g=!1,_=!1,f=!1;if(t&&t.document){var v=document.createElement("style");v.type="text/css",h=!v.styleSheet,g="addBehavior"in HTMLDivElement.prototype;var y=document.createElement("input");y.type="file";var b=t.File,C=b&&b.prototype;f=!(!C||!(C.slice||C.mozSlice||C.webkitSlice)),_="webkitdirectory"in y&&!d}return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),s),c),{isElectron:d,osVersion:m?m[2]:"NA",isWindows81:!l&&/windows (?:8\.1|nt 6\.3)/.test(a),isWindows10:!l&&a.indexOf("windows nt 10")>-1,isWindows7:!l&&a.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:p,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:_,isHtml5FileUploadSupported:f,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:h,isWebDavSupported:g,userAgent:n})}).isFirefox,mt=function(){function e(t){if(!("indexedDB"in ut)||!ut.indexedDB)throw new Error("indexedDB is not supported");this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,o,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return n=a._db=o,[2,new Promise(function(e,r){var a=n.transaction(["ODSP_DB_TABLE"],"readwrite").objectStore("ODSP_DB_TABLE").index("app_lastRead").openCursor();a.onsuccess=function(n){var r=a.result;r?(r.value.app===t&&i>0&&(i-=r.value.size,r.delete()),i>0?r.continue():e()):e()},a.onerror=function(e){s._errorHandling(e,r)}})]}})})},e.prototype.read=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._readInternal("ODSP_DB_TABLE",function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,n,a,o,s,c,l,d,u,p,m,h,g,_=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i={},a=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return n=a._db=o,s=n.transaction(["ODSP_DB_TABLE"],"readonly"),c=s.objectStore("ODSP_DB_TABLE"),l=[],d=t.index,u=t.range,p=t.direction,m=t.count,h=c.index(d),(g=h.openKeyCursor(u,p)).onerror=function(e){_._errorHandling(e,i.reject)},g.onsuccess=function(e){var t=e.target.result;t?(l.push(t.primaryKey),l.length>=m?i.resolve(l):t.continue()):i.resolve(l)},[2,new Promise(function(e,t){i.resolve=e,i.reject=t})]}})})},e.prototype.write=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=i.sent(),this._dbMetaData=e,i.label=2;case 2:return[4,this._iterate("ODSP_DB_TABLE",function(e){return e.size})];case 3:return t=i.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(i,n){if(e._db)i(e._db);else{var r=pt?indexedDB.open("ODSP_DB",{version:4,storage:"temporary"}):indexedDB.open("ODSP_DB",4);r.onerror=function(e){t._errorHandling(e,n)},r.onsuccess=function(t){var n=e._db=r.result;i(n)},r.onupgradeneeded=function(e){var i=e.target.result;i.onerror=function(e){t._errorHandling(e,n)};var a=e.oldVersion;t._handleDBUpgrade(r,i,a)}}})},e.prototype._handleDBUpgrade=function(e,t,i){var n;i<1&&((n=t.createObjectStore("ODSP_DB_TABLE",{keyPath:"key"})).createIndex("lastModified","lastModified",{unique:!1}),n.createIndex("reads","reads",{unique:!1}),t.createObjectStore("ODSP_DB_METADATA_TABLE",{keyPath:"key"})),i<2&&((n=n||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app","app",{unique:!1}),n.createIndex("lastRead","lastRead",{unique:!1}),n.createIndex("app_lastRead",["app","lastRead"],{unique:!1})),i<3&&((n=n||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app_lastModified",["app","lastModified"],{unique:!1}),n.createIndex("app_reads",["app","reads"],{unique:!1})),i<4&&((n=n||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("parentKey","parentKey",{unique:!1}),n.createIndex("parentKey_app",["parentKey","app"],{unique:!1}),n.createIndex("parentKey_app_lastModified",["parentKey","app","lastModified"],{unique:!1}),n.createIndex("parentKey_app_lastRead",["parentKey","app","lastRead"],{unique:!1}),n.createIndex("parentKey_app_reads",["parentKey","app","reads"],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal("ODSP_DB_METADATA_TABLE",function(e){return e.get("database_metadata")}).then(function(t){if(t)return t.data;var i={id:lt(),created:Date.now(),cacheType:1};return e._writeInternal({tableName:"ODSP_DB_METADATA_TABLE",key:"database_metadata",row:{key:"database_metadata",data:i}}).then(function(){return i})})},e.prototype._readInternal=function(t,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,o,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return n=a._db=o,[2,new Promise(function(e,r){var a=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=n.transaction([t],"readonly").objectStore(t),l=i(c);l.onsuccess=function(t){a({resultType:g.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-o)}}),e(l.result)},l.onerror=function(e){a({resultType:g.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,r)}})]}})})},e.prototype._iterate=function(t,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,o,s,c=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return n=a._db=o,s=[],[2,new Promise(function(e,r){var a=n.transaction([t],"readonly").objectStore(t).openCursor();a.onsuccess=function(t){var n=a.result;n?(s.push(i(n.value)),n.continue()):e(s)},a.onerror=function(e){c._errorHandling(e,r)}})]}})})},e.prototype._writeInternal=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,n,a,o,s,c,l=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=t.tableName,n=t.key,a=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([i],"readwrite"),s=r.objectStore(i);r.oncomplete=function(){},r.onerror=function(e){l._errorHandling(e,t)};var c=a?s.put(a):s.delete(n);c.onsuccess=function(t){e()},c.onerror=function(e){l._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,i=this;return Object(r.__generator)(this,function(n){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:"parentKey",range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return i._writeInternal({tableName:"ODSP_DB_TABLE",key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===dt.error){var i=e.target.error;t({name:i.name,message:i.message,code:i.code})}},e}(),ht=function(){function e(){try{if("localStorage"in ut&&ut.localStorage&&(this._localStorage=ut.localStorage,!this._localStorage.getItem("PersistentCache_metadata"))){var e={id:lt(),created:Date.now(),cacheType:0};this._localStorage.setItem("PersistentCache_metadata",JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var i=Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(i))}else this._localStorage.removeItem(t)},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf("PersistentCache")){var i=this._localStorage.getItem(t);e.push(i?i.length:0)}return{metaData:JSON.parse(this._localStorage.getItem("PersistentCache_metadata")),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"PersistentCache_"+e},e}(),gt=0,_t=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var i=this._queue[e]=this._queue[e]||[],n=!0,r=[];i.length>0&&(i[0].schedule?(r=i.slice(1),this._queue[e]=[i[0]],n=!1):(r=this._queue[e],this._queue[e]=[]));var a=this._createUpateTask(e,t);return r.length>0&&(a.signal=r[0].signal),this._queue[e].push(a),n&&this._scheduleTask(e),a},e.prototype._createUpateTask=function(e,t){var i=this,n={};n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t});var a={execute:function(){return Object(r.__awaiter)(i,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),[4,t()];case 1:return i.sent(),[3,4];case 2:return e=i.sent(),a.error=e,[3,4];case 3:return this._completeTask(a),[7];case 4:return[2]}})})},schedule:0,id:gt++,key:e,signal:n};return a},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var i=t[0];i.schedule=ut.setTimeout(i.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,i=e.key,n=this._queue[i],r=n[0],a=n.slice(1);if(r.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[i]=a,this._scheduleTask(i),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function ft(){return ut.performance&&performance.now?Math.round(performance.now()):Date.now()}var vt,yt=function(){function e(e){var t=e.cacheType,i=void 0===t?1:t,n=Object(r.__rest)(e,["cacheType"]);if(this._config=Object(r.__assign)(Object(r.__assign)({},n),{cacheType:i}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new _t,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype.read=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,n,a,o,s,c,l,d,u,p,m,h,_,f,v,y,b,C,T,x;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=this._logQos({name:"PersistentCache.read"}),s=ft(),c=Date.now(),r.label=1;case 1:return r.trys.push([1,12,,13]),d=this._getCacheKey(t),u=!1,p={lastModified:NaN,lastRead:c,reads:1},m=void 0,d?(h=ft(),[4,this._storage.read(d)]):[3,11];case 2:return l=r.sent(),o=Math.round(ft()-h),l?(_=l.data,p={lastModified:l.lastModified,lastRead:c,reads:l.reads+1},(n=e._buffer[d])&&n.cacheStats.lastModified===l.lastModified?(n.app=l.app||this._app,n.key={original:t,encoded:l.key||d},n.cacheStats.lastRead=c,n.cacheStats.reads++,n.performance={total:Math.round(ft()-s)},[3,11]):[3,3]):[3,11];case 3:if(n=void 0,void 0===_)return[3,11];if(!this._dataIsEncrypted)return[3,10];f=_,v=this._cacheSecret,y=v.CurrentKey.Key,b=v.PreviousKey.Key,C=ft(),r.label=4;case 4:return r.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:f,encryptionSecret:y})];case 5:return m=r.sent(),[3,9];case 6:return(T=r.sent())&&T.message&&T.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:f,encryptionSecret:b})]:[3,8];case 7:m=r.sent(),u=void 0!==m,i({resultType:g.ResultTypeEnum.ExpectedFailure,error:T.message,extraData:{cacheResult:"hit"}}),r.label=8;case 8:return[3,9];case 9:return a=Math.round(ft()-C),[3,11];case 10:m=_,r.label=11;case 11:return n=n||{key:{original:t,encoded:l&&l.key||d},app:l&&l.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:a,io:o,total:Math.round(ft()-s)}},e._buffer[d]=n,u&&this.update(t,m),[3,13];case 12:throw x=r.sent(),i({resultType:g.ResultTypeEnum.Failure,error:x.message?x.message:x.toString(),extraData:{cacheResult:"miss"}}),x;case 13:return i({resultType:g.ResultTypeEnum.Success,extraData:{cacheResult:void 0!==n.data?"hit":"miss"}}),[2,Promise.resolve(n)]}})})},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,i,n,a,o,s,c,l=this;return Object(r.__generator)(this,function(r){if(1!==this._cacheType)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),i=0,n=ft(),a=Date.now(),s={lastModified:NaN,lastRead:a,reads:1};try{c=ft(),o=this._storage.rangeQuery(e).then(function(e){return i=Math.round(ft()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:l._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:l._cacheType,performance:{io:i,total:Math.round(ft()-n)}}})}catch(e){throw t({resultType:g.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:g.ResultTypeEnum.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:i,total:Math.round(ft()-n)}})]})})},e.prototype.update=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,n=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(i,function(){return n._doCacheUpdate(e,t)}).signal.promise];case 1:return r.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(i){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,n,a,o,s,c,l=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=ft(),n=Date.now(),a=this._logQos({name:"PersistentCache.readAndUpdate"}),o=t().then(function(t){var r={app:l._app,key:{original:e,encoded:l._getCacheKey(e)},data:t,cacheType:2,cacheStats:{lastModified:void 0,lastRead:n,reads:1},performance:{total:Math.round(ft()-i)}};return l.update(e,t),r}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!s||2!==s.cacheType&&void 0===s.data?[4,o]:[3,7];case 6:s=r.sent(),r.label=7;case 7:return[3,9];case 8:throw c=r.sent(),a({resultType:g.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return a({resultType:g.ResultTypeEnum.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){switch(e){case 0:this._storage=new ht;break;case 1:default:try{this._storage=new mt(this._logQos.bind(this))}catch(e){"indexedDB is not supported"===e.message&&(this._storage=new ht,this._cacheType=0)}}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent(e.key+(e.user?"_____"+e.user:""));return"_odspcache_"+(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace("_odspcache_",""),i=this._dataIsEncrypted?atob(t):t,n=decodeURIComponent(i);if(n.indexOf("_____")>=0){var r=n.split("_____");return{key:r[0],user:r[1]}}return{key:n}},e.prototype._doCacheUpdate=function(t,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,o,s,c,l,d;return Object(r.__generator)(this,function(u){switch(u.label){case 0:n=this._logQos({name:"PersistentCache.update"}),u.label=1;case 1:return u.trys.push([1,9,,10]),a=this._getCacheKey(t),void 0===i?[3,6]:((o=e._buffer[a]=Object(r.__assign)(Object(r.__assign)({},e._buffer[a]),{data:i,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:ft(),reads:1}),s=i,c=NaN,this._dataIsEncrypted?(l=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:l,data:i,doSerialize:0===this._cacheType})]):[3,3]);case 2:return s=u.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof i?i.length:JSON.stringify(i).length}catch(e){}u.label=4;case 4:return[4,this._storage.write({app:this._app,key:a,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return u.sent(),[3,8];case 6:return delete e._buffer[a],[4,this._storage.write({key:a,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:throw d=u.sent(),n({resultType:g.ResultTypeEnum.Failure,error:d.message?d.message:d.toString()}),d;case 10:return n({resultType:g.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var i=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,i.end(e)}}return function(e){}},e._buffer={},e}();!function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground",e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired",e[e.onlyCache=2]="onlyCache",e[e.bypassCache=3]="bypassCache"}(vt||(vt={}));var bt=function(){function e(e,t){this._getDataPromises={};var i=e.id,n=e.dataSourceName,a=e.cacheType,o=void 0===a?1:a,s=(t.pageContext||{}).aadUserId;this._id=i,this._userId=s;var c=n||i,l=g.Qos.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?Object(r.__assign)(Object(r.__assign)({},e),{name:c+"."+e.name}):e});this._cache=new yt({cacheType:o,telemetry:{qos:l}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,i=e,n=i.cacheRequestKey,r=i.cachingStrategy,a=void 0===r?0:r,o=i.cacheTimeoutTime,s=void 0===o?864e5:o,c=i.getData,l=i.returnStatistics,d=void 0!==l&&l,u={key:n,user:this._userId},p=function(){return Ct()||t._getDataPromises[n]||(t._getDataPromises[n]=c().then(function(e){return delete t._getDataPromises[n],e})),(Ct()?c():t._getDataPromises[n]).then(function(e){return t._cache.update(u,e),d?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return g.Killswitch.isActivated("19cec8a5-4f79-4d4c-ae7e-f272ba265abb")||2!==a?g.Promise.resolve(this._cache.read(u)).then(function(e){var i=e.data,n=e.cacheStats;if(null==i)return p();var r=d?{data:i,cacheStats:n}:i,o=t._isCacheExpired(n.lastModified,s);switch(a){case 2:return r;case 0:return o&&p(),r;case 1:return o?p():r;case 3:default:return p()}}).catch(function(){return p()}):g.Promise.resolve(this._cache.read(u)).then(function(e){var t=e.data,i=e.cacheStats;return null==t?null:d?{data:t,cacheStats:i}:t}).catch(function(){return null})},e.prototype.getRequestKey=function(e,t,i){var n=[];return n.push(e),n.push(t),i&&n.push(i.toString()),n.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e],this._cache.remove(t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}();function Ct(){return g.Killswitch.isActivated("0b1fbce0-bb51-41da-a09b-8d1686398bb7")}var Tt,xt=function(){function e(e,t){var i=e.id,n=e.cacheType,r=void 0===n?g.DataStoreCachingType.session:n,a=t.cacheIdPrefix,o=void 0===a?"odsp-ds-":a,s=t.pageContext;this._id=i,this._version=s?s.siteClientTag+"_"+s.userDisplayName:"",this._store=new g.DataStore(o,r),this._storeDefaultCacheType=r,this._initCache()}return e.prototype.getDataUtilizingCache=function(e){var t=this,i=e,n=i.cacheRequestKey,r=i.useStale,a=void 0!==r&&r,o=i.bypassCache,s=void 0!==o&&o,c=i.onlyCache,l=void 0!==c&&c,d=i.checkForInvalidation,u=i.setInvalidated,p=i.getData,m=i.cacheTimeoutTime,h=void 0===m?3e5:m,_=i.returnStatistics,f=void 0!==_&&_,v=this._cache,y=v[n],b=function(){return f?{data:y._value,cacheStats:{lastModified:NaN,lastRead:y._fetched,reads:NaN}}:y._value};if(l)return y?g.Promise.resolve(b()):g.Promise.resolve(void 0);d=d&&!s&&this._storeDefaultCacheType!==g.DataStoreCachingType.local;var C=y&&this._isCacheExpired(y,n,d,h);return s||!y||C&&!a?p().then(function(e){var i=(new Date).valueOf();return v[n]={_fetched:i,_value:e},u&&t._store.setValue(n,i-1,g.DataStoreCachingType.local),t._updateCache(),f?{data:e,cacheStats:{lastModified:NaN,lastRead:i,reads:NaN}}:e}):g.Promise.resolve(b())},e.prototype.getRequestKey=function(e,t,i){var n=[];return n.push(e),n.push(t),i&&n.push(i.toString()),n.join(",")},e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){e?(delete this._cache[e],this._updateCache()):this._clearCache()},e.prototype._initCache=function(){this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)?(this._clearCache(),this._store.setValue(this.cacheVersionId,this._version,void 0,!1)):this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}},e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)},e.prototype._clearCache=function(){this._cache={},this._updateCache()},e.prototype._isCacheExpired=function(e,t,i,n){if(i&&this._isCachedDataInvalidated(e,t))return!0;var r=(new Date).valueOf()-n;return e._fetched<=r},e.prototype._isCachedDataInvalidated=function(e,t){var i=Number(this._store.getValue(t,g.DataStoreCachingType.local));return!!(e&&i&&e._fetched<i)},e}(),wt=function(e){function t(t,i){var n=e.call(this,t,i)||this,a=i.pageContext;n._legacyRequestCache=new xt(t,{pageContext:a}),t.cacheType;var o=Object(r.__rest)(t,["cacheType"]);return n._persistentRequestCache=new bt(o,{pageContext:a}),n}return Object(r.__extends)(t,e),t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,i=e,n=i.getUrl,a=i.getAdditionalPostData,o=i.cacheRequestKey,s=i.cacheTimeoutTime,c=Object(r.__rest)(i,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(c=Object(r.__assign)({url:n&&n(),additionalPostData:a&&a(),method:"POST"},c)).url=c.url||n&&n(),"needsRequestDigest"in c||(c.needsRequestDigest=this.needsRequestDigest(c.url)),c.additionalPostData=c.additionalPostData||a&&a(),o=o||this.getRequestKey(c.url,c.method,c.additionalPostData);var l=e.useStale,d=void 0!==l&&l,u=e.bypassCache,p=void 0!==u&&u,m=e.onlyCache,h=void 0!==m&&m,g=e.checkForInvalidation,_=void 0!==g&&g,f=e.setInvalidated,v=void 0!==f&&f;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:d,bypassCache:p,onlyCache:h,checkForInvalidation:_,setInvalidated:v,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(c)}})},t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,i=e,n=i.getUrl,a=i.getAdditionalPostData,o=i.cacheRequestKey,s=i.cacheTimeoutTime,c=i.returnStatistics,l=Object(r.__rest)(i,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(l=Object(r.__assign)({url:n&&n(),additionalPostData:a&&a(),method:"POST"},l)).url=l.url||n&&n(),"needsRequestDigest"in l||(l.needsRequestDigest=this.needsRequestDigest(l.url)),l.additionalPostData=l.additionalPostData||a&&a(),o=o||this.getRequestKey(l.url,l.method,l.additionalPostData);var d=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:d,cacheRequestKey:o,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(l)},returnStatistics:c})},t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)},t.prototype.getRequestKey=function(e,t,i){return this._legacyRequestCache.getRequestKey(e,t,i)},Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!0,configurable:!0}),t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e),this._persistentRequestCache.flushCache(e)},t}(st);!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(Tt||(Tt={}));var St,Dt=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],It=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(r.__extends)(t,e),t.decodeAcronymColor=function(e){return Dt.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})},t.prototype.getAcronyms=function(e,t){var i=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var n=t.qosName,r=void 0===n?"GetSiteHeaderLogoAcronym":n;return this.getDataUtilizingPersistentCache({getUrl:function(){var t,n=e.map(function(e){return"{Text: "+d.UriEncoding.encodeURIComponent('"'+e+'"')+"}"}).join(",");return("/"===(t=i._pageContext).webServerRelativeUrl?"":t.webServerRelativeUrl)+"/_api/sphome/GetAcronymsAndColors?labels=["+n+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:r})}return g.Promise.reject(new Error("No web URL specified for request."))},t}(wt),Pt=i("bdhH"),At=function(){function e(){}return e.getNameFromClaim=function(e){var t=e;if(e){var i=e.lastIndexOf("|");i>=0&&(t=e.substr(i+1))}return t},e.getInitials=function(e){var t;if(e){var i=e.split(" ");switch(i.length){case 1:t=i[0].substring(0,2);break;default:t=i[0].charAt(0)+i[i.length-1].charAt(0)}t=t.toUpperCase()}return t},e.getPerson=function(t,i,n){var r,a=e.getNameFromClaim(t);return r={name:a},n&&(r.profileImageSrc=Ue.SPUtility.getUserPhotoUrl(e.getNameFromClaim(n))),i?(r.email=i,r.profileImageSrc||(r.profileImageSrc=Ue.SPUtility.getUserPhotoUrl(i))):a?(r.initials=e.getInitials(a),e._initialsColorHash[r.initials]?r.initialsColor=e._initialsColorHash[r.initials]:(r.initialsColor=Math.floor(Math.random()*u.PersonaInitialsColor.darkRed),e._initialsColorHash[r.initials]=r.initialsColor)):r.profileImageSrc||(r.profileImageSrc=Ue.SPUtility.getUserPhotoUrl()),r},e._initialsColorHash={},e}(),kt=function(){function e(){}return e.ensureAbsoluteUrl=function(t,i){return t&&t.length&&"/"===t[0]?e.getAbsoluteUrl(t,i):t},e.getAbsoluteUrl=function(t,i,n){t&&t.length>0&&"/"===t[0]&&(t=t.substr(1));var r=new d.Uri(i),a=r.getScheme()+"://"+r.getHost(),o=d.Uri.concatenate(a,t);return n||(o=e.canonicalizeDecodedUrl(o)),o},e.canonicalizeDecodedUrl=function(e){return e&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e},e.getModernEventsPageUrl=function(e,t){var i;if(e&&t){var n="_layouts/15/Events.aspx?ListGuid="+e;i=d.Uri.concatenate(t,n)}return i},e}(),Lt=[".one",".onepkg",".ms-one-stub",".onetoc",".onetoc2"],Ot={"SP.ChangeItem":0,"SP.ChangeList":1,"SP.ChangeWeb":2,"SP.ChangeSite":3,"SP.ChangeFile":4,"SP.ChangeFolder":5,"SP.ChangeAlert":6,"SP.ChangeUser":7,"SP.ChangeGroup":8,"SP.ChangeContentType":9,"SP.ChangeField":10,"SP.ChangeSecurityPolicy":11,"SP.ChangeView":12,"SP.ChangeFileFragment":13,"SP.ChangeSecurityPolicyInternal":14,"SP.ChangeAll":17},Et=["siteassets","microfeed","sitepages","documents","hashtaginfo_02f0b776_8b0a_4ac0_8621_bd631931cc3d","spnewsdecredzrcdtbvsweqbrbfvcyyrbtwctr"],Nt=["spnewsdecredzrcdtbvsweqbrbfvcyyrbtwctr"],jt=[".onetmp",".url"],Rt=function(){function e(e,t){this._context=e,this._httpClient=t,this._ignoreCreateListUrls=[];for(var i=this._context.web.serverRelativeUrl.toLowerCase(),n=0,r=Et;n<r.length;n++){var a=r[n];this._ignoreCreateListUrls.push(i+"/"+a)}d.Locale.language||(d.Locale.language="en-us")}return e.prototype.getActivities=function(e,t){var i=this;void 0===t&&(t=ze.GetChanges);var n=new s._QosMonitor("SiteActivityDataSource.GetActivities");return this._httpClient.post(this._getActivitiesUrl(!1),ot.SPHttpClient.configurations.v1,{headers:{"OData-Version":"3.0"},body:this._constructPostBody(e)}).then(function(e){return i._checkResponseStatus(e,n)},function(e){throw n.writeUnexpectedFailure("Unexpected",e),e}).then(function(e){return i._handleServerData(e.value)})},e.prototype.getAcronymData=function(){var e=this;return this._acronymDatasource||(this._acronymDatasource=new It(this._context.legacyPageContext)),this._acronymDatasource.getAcronymData(this._context.web.title).then(function(t){return e._context.legacyPageContext.groupColor&&(t.color=e._context.legacyPageContext.groupColor),t})},e.prototype.getCreateWebActivity=function(){var e=this;return this._httpClient.get(this._getWebInformationUrl(),ot.SPHttpClient.configurations.v1).then(function(e){return e.json()}).then(function(t){if(!t.Author)return[];var i=e._dateTimeStringToJsDate(t.Created),n=qe.LocaleFormat.formatRelativeTimeApproximate(i),r=At.getPerson(t.Author.Title,t.Author.Email,t.Author.UserPrincipalName),a=e._context.web.serverRelativeUrl+"/_layouts/15/viewlsts.aspx",o={changeType:Ne.Add,activityObjectType:je.Web,date:i,relativeTime:n,editor:r,changeObjectType:2,serverRelativeUrl:a,latestName:t.Title,url:kt.getAbsoluteUrl(a,e._context.web.absoluteUrl)},s=e._context.web.logoUrl;return s&&-1===s.indexOf("_layouts/15/images/siteicon.png")&&(o.iconUrl=s),[o]})},e.prototype.getDefaultDocumentLibraryUrl=function(){var e=this;return this._httpClient.post(this._getDefaultDocumentLibraryUrl(),ot.SPHttpClient.configurations.v1,{}).then(function(e){return e.json()}).then(function(t){return kt.getAbsoluteUrl(t.DefaultViewUrl,e._context.web.absoluteUrl)})},e.prototype._handleServerData=function(t){for(var i=[],n=0,r=t;n<r.length;n++){var a=r[n],o=At.getPerson(a.Editor,a.EditorEmailHint,a.EditorLoginName),s=Ot[a["odata.type"]],c=a.ChangeType;if(!this._shouldIgnoreChange(c,s,o,a)){var l,u=0===s?this._getItemInformation(a.ServerRelativeUrl):void 0,m=d.iso8601DateTimeToJsDate(a.Time);l=a.RelativeTime?Object(p.getRelativeDateTimeStringForLists)(a.RelativeTime):qe.LocaleFormat.formatRelativeTimeApproximate(m);var h={changeToken:a.ChangeToken.StringValue,changeType:c,changeActivityType:a.ActivityType,activityObjectType:je.File,date:m,relativeTimeFromServer:a.RelativeTime,relativeTime:l,editor:o,itemId:a.ItemId,listId:a.ListId,webId:a.WebId,siteId:a.SiteId,changeObjectType:s,serverRelativeUrl:a.ServerRelativeUrl,latestName:u?u.name:"",url:u?u.url:"",parentFolderName:u?u.parentFolderName:"",listTitle:a.ListTitle?a.ListTitle:"",parentFolderUrl:u?u.parentFolderUrl:""};if(h.serverRelativeUrl=h.serverRelativeUrl&&h.serverRelativeUrl.indexOf("?")<0?Pt.canonicalizeDecodedUrl(h.serverRelativeUrl):h.serverRelativeUrl,h.url=h.url&&h.url.indexOf("?")<0?Pt.canonicalizeDecodedUrl(h.url):h.url,u&&u.extension){if(jt.indexOf(u.extension)>-1)continue;var g=u.extension.substr(1);if(Ue.ThumbnailUrlGenerator.isFileTypeSupported(g)){var _={absoluteUrl:this._context.web.absoluteUrl,spResource:h.serverRelativeUrl,fileType:g,width:300,callerId:"siteActivityDataSource"};h.previewImageUrl=Ue.ThumbnailUrlGenerator.getThumbnailUrl(_)}if(h.activityObjectType=this._getActivityObjectType(u.extension),h.iconUrl=Ue.Icons.getIconUrl(g,h.previewImageUrl?32:64),h.smallIconUrl=Ue.Icons.getIconUrl(g,16),h.accentColor=Ue.Icons.getIconColorFromExtension(g),h.activityObjectType===je.Item&&a.ListTemplate&&(h.iconUrl=this._getIconUrlFromListTemplate(a.ListTemplate),106===a.ListTemplate)){var f=kt.getModernEventsPageUrl(h.listId,this._context.web.absoluteUrl);h.parentFolderUrl=f||h.parentFolderUrl}}else h.iconUrl=e._defaultIconUrl,h.accentColor=e._defaultAccentColor;1===h.changeObjectType&&(h.iconUrl=this._getIconUrlFromListTemplate(a.BaseTemplate),a.Creator&&a.Creator.Title&&(h.editor=At.getPerson(a.Creator.Title,a.Creator.Email,a.Creator.UserPrincipalName)),h.activityObjectType=je.List,h.latestName=a.Title,h.url=kt.ensureAbsoluteUrl(a.RootFolderUrl,this._context.web.absoluteUrl),h.accentColor=e._defaultAccentColor,106===a.BaseTemplate)&&(f=kt.getModernEventsPageUrl(h.listId,this._context.web.absoluteUrl),h.url=f||h.url),i.push(h)}}return i},e.prototype._shouldIgnoreChange=function(e,t,i,n){var r=n.ServerRelativeUrl&&n.ServerRelativeUrl.toLowerCase(),a=!1;if(n.Hidden)a=!0;else if(n.Creator&&n.Creator.LoginName&&!n.Creator.Email)a=!0;else if(i.name&&"system account"===i.name.toLowerCase()&&!i.email)a=!0;else if(r&&(r.indexOf("/_catalogs/")>-1||r.indexOf("/hashtaginfo_02f0b776_8b0a_4ac0_8621_bd631931cc3d/")>-1||r.indexOf("/onenote_recyclebin/")>-1||r.indexOf(this._context.web.serverRelativeUrl.toLowerCase()+"/siteassets/")>-1||r.indexOf("/home.aspx")>-1))a=!0;else if(0===t&&n.ListTitle){for(var o=n.ListTitle.toLowerCase(),s=0,c=Nt;s<c.length;s++)if(o===c[s]){a=!0;break}}else if(1===t&&e!==Ne.Add&&e!==Ne.Delete)a=!0;else if(1===t)if(n.Title){for(var l=n.RootFolderUrl&&n.RootFolderUrl.toLowerCase(),d=0,u=this._ignoreCreateListUrls;d<u.length;d++)if(u[d]===l){a=!0;break}}else a=!0;return a},e.prototype._getActivitiesUrl=function(e){var t=d.UriEncoding.escapeUrlForCallback(this._context.web.absoluteUrl),i=[];return i.push(t),e?i.push("/_api/web/GetChangesWithExtendedItemProperties?$expand=Creator,RelativeTime,RootFolderUrl,ListTitle,ListTemplate,ActivityType,Hashtag,Hidden"):i.push("/_api/web/GetChanges?$expand=Creator,RelativeTime,RootFolderUrl,ListTitle,ListTemplate,ActivityType,Hashtag,Hidden"),i.join("")},e.prototype._constructPostBody=function(e){var t=e.fetchLimit.toString(),i={query:{Add:e.add,DeleteObject:e.deleteObject,FetchLimit:t,File:e.file,Folder:e.folder,Group:e.group,GroupMembershipAdd:e.groupMembershipAdd,GroupMembershipDelete:e.groupMembershipDelete,Item:e.item,LatestFirst:e.latestFirst,List:e.list,Move:e.move,Rename:e.rename,Restore:e.restore,RoleAssignmentAdd:e.roleAssignmentAdd,RoleDefinitionAdd:e.roleDefinitionAdd,Update:e.update,User:e.user,RequireSecurityTrim:e.requireSecurityTrim,Activity:e.activity}};return JSON.stringify(i)},e.prototype._getItemInformation=function(e){var t,i=e.split("/"),n=i.length-1;if(n>=0){var r=i[n],a=n>0?i[n-1]:"",o=r.lastIndexOf("."),s=o>=0?r.substring(o):"",c=(i=i.slice(0,n)).join("/");t={name:r,extension:s.toLowerCase(),url:kt.getAbsoluteUrl(e,this._context.web.absoluteUrl)+"?web=1",parentFolderUrl:kt.getAbsoluteUrl(c,this._context.web.absoluteUrl),parentFolderName:a}}return t},e.prototype._getActivityObjectType=function(e){var t;if(e&&Lt.indexOf(e)>=0)return je.OneNote;switch(e){case".000":t=je.Item;break;case".aspx":t=je.Page;break;default:t=je.File}return t},e.prototype._getDefaultDocumentLibraryUrl=function(){return d.Uri.concatenate(d.UriEncoding.escapeUrlForCallback(this._context.web.serverRelativeUrl),"/_api/web/DefaultDocumentLibrary?$expand=DefaultViewUrl")},e.prototype._getWebInformationUrl=function(){return d.Uri.concatenate(d.UriEncoding.escapeUrlForCallback(this._context.web.serverRelativeUrl),"/_api/web?$expand=Author")},e.prototype._getIconUrlFromListTemplate=function(t){var i;switch(t){case 100:i=e._listIcon;break;case 119:i=e._pageIcon;break;case 107:case 171:i=e._taskListIcon;break;case 106:i=e._eventListIcon;break;default:i=e._libraryIcon}return i},e.prototype._dateTimeStringToJsDate=function(e){var t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))},e.prototype._checkResponseStatus=function(e,t){return e.status>=200&&e.status<=299?(t.writeSuccess(),e.json()):e.json().then(function(e){var i=e["odata.error"],n=i&&i.message&&i.message.value;return t.writeUnexpectedFailure("Unexpected",i),Promise.reject(new Error(n))})},e._defaultIconUrl=Ue.Icons.getIconUrl("",64),e._defaultAccentColor=Ue.Icons.getIconColorFromExtension(""),e._libraryIcon=Be.getIconUrl("doc-library"),e._listIcon=Be.getIconUrl("custom-list"),e._pageIcon=Ue.Icons.getIconUrl("aspx",32),e._taskListIcon=Be.getIconUrl("task-list"),e._eventListIcon=Be.getIconUrl("calendar"),e}(),zt=i("Pk8u"),Ft=[".one",".onepkg",".ms-one-stub",".onetoc",".onetoc2"],Ut=i("FI2v");!function(e){e[e.PersonCreatedActivity=0]="PersonCreatedActivity",e[e.PersonModifiedActivity=1]="PersonModifiedActivity",e[e.PeopleModifiedActivity=2]="PeopleModifiedActivity",e[e.YouModifiedActivity=3]="YouModifiedActivity",e[e.YouViewedActivity=4]="YouViewedActivity",e[e.TrendingAroundActivity=5]="TrendingAroundActivity",e[e.Other=6]="Other"}(St||(St={}));var Bt,qt,Ht=function(){function e(t,i,n){this._context=t,this._spHttpClient=i,this._sphomeHttpClient=n.consume(m.SPHomeHttpClient.serviceKey),this._isPlannerTaskFlightOn=c._SPFlight.isEnabled(1529),d.Locale.language||(d.Locale.language="en-us"),this._urlEncodeKillSwitchEnabled=c._SPKillSwitch.isActivated(e.ENCODEURL_KILLSWITCH,"05/10/2019","encode ActivityItem.url"),this._servRedirectedCheckKillSwitch=c._SPKillSwitch.isActivated(e.SRVREDIRECTEDURL_KILLSWITCH,"06/28/2019","check serverRedirectedUrl"),this._useFileNameForFileActivityKS=c._SPKillSwitch.isActivated(c.Guid.parse("06f5575e-6b6d-4137-b6fb-695058995816"),"08/21/2018","useFileNameForFileActivityKS"),this._myPlannerExp=void 0}return e.prototype.getActivities=function(e){return this.getAggregateActivities().then(function(e){return[].concat.apply([],e.map(function(e){return e.activities}))})},e.prototype.getAggregateActivities=function(e){var t=this;void 0===e&&(e=8);var i=new s._QosMonitor("SiteActivityDataSource.GetActivities");return this._sphomeHttpClient.get(this._getActivitiesUrl(e)).then(function(e){return i.writeSuccess(),e.json()}).catch(function(e){i.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return t._handleServerData(e.Activities)})},e.prototype.getAcronymData=function(){var e=this;return this._acronymDatasource||(this._acronymDatasource=new It(this._context.legacyPageContext)),this._acronymDatasource.getAcronymData(this._context.web.title).then(function(t){return e._context.legacyPageContext.groupColor&&(t.color=e._context.legacyPageContext.groupColor),t})},e.prototype.getCreateWebActivity=function(){var e=this;return this._spHttpClient.get(this._getWebInformationUrl(),ot.SPHttpClient.configurations.v1).then(function(e){return e.json()}).then(function(t){if(!t.Author)return[];var i=e._dateTimeStringToJsDate(t.Created),n=qe.LocaleFormat.formatRelativeTimeApproximate(i),r=At.getPerson(t.Author.Title,t.Author.Email,t.Author.UserPrincipalName),a=e._context.web.serverRelativeUrl+"/_layouts/15/viewlsts.aspx",o={changeType:Ne.Add,activityObjectType:je.Web,date:i,relativeTime:n,editor:r,changeObjectType:2,serverRelativeUrl:a,latestName:t.Title,url:kt.getAbsoluteUrl(a,e._context.web.absoluteUrl)},s=e._context.web.logoUrl;return s&&-1===s.indexOf("_layouts/15/images/siteicon.png")&&(o.iconUrl=s),[o]})},e.prototype.getDefaultDocumentLibraryUrl=function(){var e=this;return this._spHttpClient.post(this._getDefaultDocumentLibraryUrl(),ot.SPHttpClient.configurations.v1,{}).then(function(e){return e.json()}).then(function(t){return kt.getAbsoluteUrl(t.DefaultViewUrl,e._context.web.absoluteUrl)})},e.prototype._handleServerData=function(t){for(var i=[],n=this._context.user,r=At.getPerson(n.displayName,n.email,n.loginName),a={profileImageSrc:Ut,name:Ke.I},o=0,s=0,c=t;s<c.length;s++){var l=c[s];if(!l.ActivityItem||"Planner"!==l.ActivityItem.Type||this._isPlannerTaskFlightOn){if("Planner"===l.ActivityItem.Type&&(this._myPlannerExp||(d.ABExperiment.Init(this._context.legacyPageContext),this._myPlannerExp=new d.ABExperiment({name:"PlannerSiteActivity",startDate:"07/21/2019",version:2})),!this._myPlannerExp.IsExperimentOn()))continue;var u=[],p=[],m="Email"===l.ActivityItem.Type?15:"Planner"===l.ActivityItem.Type?16:4,h=Ne.Update,g=this._getItemInformation(l.ActivityItem.Url,l.ActivityItem.ServerRedirectedUrl,this._useFileNameForFileActivityKS||4!==m?l.ActivityItem.Title:void 0,l.ActivityItem.TemplateType),_=d.iso8601DateTimeToJsDate(l.Time),f=qe.LocaleFormat.formatRelativeTimeApproximate(_),v={changeType:h,changeActivityType:0,activityObjectType:"EmailActivity"===l.Type?je.Email:"PlannerActivity"===l.Type?je.Planner:je.File,date:_,relativeTime:f,editor:void 0,changeObjectType:m,latestName:g?g.name:"",url:g?g.url:"",parentFolderUrl:g?g.parentFolderUrl:"",parentFolderName:g?g.parentFolderName:"",rankDetails:{Source:l.DocumentSource?l.DocumentSource.toString(2):"0",Rank:o++,RankDetails:JSON.stringify(l.RankDetails)}};if(l.ActivityItem.Url=l.ActivityItem.Url&&Pt.canonicalizeDecodedUrl(l.ActivityItem.Url),g&&g.extension){var y=new d.Uri(l.ActivityItem.Url),b=g.extension.substr(1);if(Ue.ThumbnailUrlGenerator.isFileTypeSupported(b)){var C={absoluteUrl:this._context.web.absoluteUrl,spResource:Pt.canonicalizeDecodedUrl(y.getPath()),fileType:b,width:300,callerId:"siteActivityHomeApi"};v.previewImageUrl=Ue.ThumbnailUrlGenerator.getThumbnailUrl(C)}v.activityObjectType=this._getActivityObjectType(g.extension,l.ActivityItem.Type),v.iconUrl=Ue.Icons.getIconUrl(b,v.previewImageUrl?32:64),v.smallIconUrl=Ue.Icons.getIconUrl(b,16),v.accentColor=Ue.Icons.getIconColorFromExtension(b),v.activityObjectType===je.Item&&l.ActivityItem.TemplateType&&(v.iconUrl=this._getIconUrlFromListTemplate(Number(l.ActivityItem.TemplateType)))}else v.iconUrl=e._defaultIconUrl,v.accentColor=e._defaultAccentColor;if("List"===l.ActivityItem.Type&&(v.iconUrl=this._getIconUrlFromListTemplate(Number(l.ActivityItem.TemplateType)),v.activityObjectType=je.List,v.latestName=l.ActivityItem.Title,v.url=l.ActivityItem.Url,v.accentColor=e._defaultAccentColor),"Email"===l.ActivityItem.Type){v.hasAttachments=l.ActivityItem.HasAttachments,v.emailPreview=l.ActivityItem.StaticTeaser,v.changeType=Ne.Sent,u.push(v);var T=l.ActivityItem.LastModifiedBy,x=T.Title,w=T.AccountName,S=T.WorkEmail;p.push(At.getPerson(x,S,w)),v.editor=p[0];for(var D=0,I=l.ActivityItem.Recipients;D<I.length;D++){var P=I[D],A=At.getPerson(P.Title,P.WorkEmail,P.AccountName);p.push(A)}}else{if("Planner"===l.ActivityItem.Type&&(v.tasks=l.ActivityItem.Tasks?l.ActivityItem.Tasks:[],v.changeType=this._getTaskActivityChangeType(l.ActivityItem.PlanCardType),v.planId=l.ActivityItem.Id,v.planCardType=l.ActivityItem.PlanCardType,v.count=l.ActivityItem.TaskCount,v.url=l.ActivityItem.Url,v.latestName=l.ActivityItem.Title,l.ActivityItem.Users))for(var k=0,L=l.ActivityItem.Users;k<L.length;k++)P=L[k],A=At.getPerson(P.displayName,P.mail,P.userPrincipalName),p.push(A);if(l.User)p.push(At.getPerson(l.User.Title,l.User.WorkEmail,l.User.AccountName)),u.push(v),v.editor=p[0],l.Type===St[St.PersonCreatedActivity]&&(v.changeType=Ne.Add);else if(l.People)for(var O=0,E=l.People;O<E.length;O++){P=E[O],A=At.getPerson(P.Title,P.WorkEmail,P.AccountName);var N=Object(zt.cloneDeep)(v);N.editor=A,u.push(N),p.push(A)}else l.Type===St[St.TrendingAroundActivity]?(p.push(a),u.push(v),v.editor=p[0],v.changeType=Ne.Trending):(p.push(r),u.push(v),v.editor=p[0],l.Type===St[St.YouViewedActivity]&&(v.changeType=Ne.YouViewed))}var j={editors:p,activities:u,changeType:h,date:_,aggregateType:2};i.push(j)}}return i},e.prototype._getTaskActivityChangeType=function(e){var t=Ne.Update;switch(e){case 2:t=Ne.Add;break;case 1:case 4:t=Ne.TaskDue}return t},e.prototype._getActivitiesUrl=function(t){void 0===t&&(t=8);var i,n=new d.Uri("site/activities");Boolean(this._context.site.group)&&Boolean(this._context.site.group.id)&&n.setQueryParameter("GroupId",this._context.site.group.id.toString()),Boolean(this._context.web)&&Boolean(this._context.web.templateName)&&n.setQueryParameter("webTemplateId",this._context.web.templateName);var r=this.getUrlParam("WP");return i=c._SPKillSwitch.isActivated(e.COUNT_KILLSWITCH,"04/24/2018","ChangeQueryActivityCountTo15")||r===m.SeeAllPageLayoutWebparts.SiteActivity.toString()?"100":t.toString(),n.setQueryParameter("SiteId",this._context.site.id.toString()),n.setQueryParameter("WebId",this._context.web.id.toString()),n.setQueryParameter("count",i),c._SPKillSwitch.isActivated(e.URL_KILLSWITCH,"03/28/2019","Use web url instead of site url")?n.setQueryParameter("url",this._context.site.absoluteUrl):n.setQueryParameter("url",this._context.web.absoluteUrl),n.toString()},e.prototype._getItemInformation=function(e,t,i,n){var r,a=e.split("/"),o=a.length-1;if(o>=0){var s=a[o],c=o>0?a[o-1]:"",l=s.lastIndexOf("."),u=l>=0?s.substring(l):"";!this._useFileNameForFileActivityKS&&u&&(s=s.substring(0,l)),a=a.slice(0,o),u&&(".aspx"!==u.toLowerCase()&&"101"===n||!i)||(s=i);var p,m=a.join("/");this._urlEncodeKillSwitchEnabled||(m=Object(d.encodePath)(m),t=Object(d.encodePath)(t),e=Object(d.encodePath)(e)),p=this._servRedirectedCheckKillSwitch?t||e:"undefined"!==t&&t.length>0?t:e,r={name:s,extension:u?u.toLowerCase():"",url:p,parentFolderUrl:m,parentFolderName:c}}return r},e.prototype._getActivityObjectType=function(e,t){var i;if(e&&Ft.indexOf(e)>=0)return je.OneNote;if(t&&"Email"===t)i=je.Email;else if(t&&"Planner"===t)i=je.Planner;else switch(e){case".000":i=je.Item;break;case".aspx":i=je.Page;break;default:i=je.File}return i},e.prototype._getDefaultDocumentLibraryUrl=function(){return d.Uri.concatenate(d.UriEncoding.escapeUrlForCallback(this._context.web.serverRelativeUrl),"/_api/web/DefaultDocumentLibrary?$expand=DefaultViewUrl")},e.prototype._getWebInformationUrl=function(){return d.Uri.concatenate(d.UriEncoding.escapeUrlForCallback(this._context.web.serverRelativeUrl),"/_api/web?$expand=Author")},e.prototype._getIconUrlFromListTemplate=function(t){var i;switch(t){case 100:i=e._listIcon;break;case 119:i=e._pageIcon;break;case 107:case 171:i=e._taskListIcon;break;case 106:i=e._eventListIcon;break;default:i=e._libraryIcon}return i},e.prototype._dateTimeStringToJsDate=function(e){var t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))},e.prototype.getUrlParam=function(e){var t={};return window.location.href.replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,i,n){t[i]=void 0!==n?n:""}),e&&t[e]?decodeURIComponent(t[e]):void 0},e._defaultIconUrl=Ue.Icons.getIconUrl("",64),e._defaultAccentColor=Ue.Icons.getIconColorFromExtension(""),e._libraryIcon=Be.getIconUrl("doc-library"),e._listIcon=Be.getIconUrl("custom-list"),e._pageIcon=Ue.Icons.getIconUrl("aspx",32),e._taskListIcon=Be.getIconUrl("task-list"),e._eventListIcon=Be.getIconUrl("calendar"),e.COUNT_KILLSWITCH=c.Guid.parse("73A12617-77D6-47A7-8C34-60334AEF0CDB"),e.URL_KILLSWITCH=c.Guid.parse("14168a1d-b432-41ce-b9c2-b99ef284116d"),e.ENCODEURL_KILLSWITCH=c.Guid.parse("D7F21850-7088-4F24-B0D8-40914C4A55E6"),e.SRVREDIRECTEDURL_KILLSWITCH=c.Guid.parse("516F5ADD-7ED0-4C8E-BBEF-054265600955"),e}();!function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(Bt||(Bt={})),function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(qt||(qt={}));var Mt=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var i=e;t||(i=this.addParentOverflow(e),this.sequenceMapping[i.keySequences.toString()]=i);var n=this._getUniqueKtp(i);if(t?this.persistedKeytips[n.uniqueID]=n:this.keytips[n.uniqueID]=n,this.inKeytipMode||!this.delayUpdatingKeytipChange){var r=t?qt.PERSISTED_KEYTIP_ADDED:qt.KEYTIP_ADDED;u.EventGroup.raise(this,r,{keytip:i,uniqueID:n.uniqueID})}return n.uniqueID},e.prototype.update=function(e,t){var i=this.addParentOverflow(e),n=this._getUniqueKtp(i,t),r=this.keytips[t];r&&(n.keytip.visible=r.keytip.visible,this.keytips[t]=n,delete this.sequenceMapping[r.keytip.keySequences.toString()],this.sequenceMapping[n.keytip.keySequences.toString()]=n.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||u.EventGroup.raise(this,qt.KEYTIP_UPDATED,{keytip:n.keytip,uniqueID:n.uniqueID}))},e.prototype.unregister=function(e,t,i){void 0===i&&(i=!1),i?delete this.persistedKeytips[t]:delete this.keytips[t],!i&&delete this.sequenceMapping[e.keySequences.toString()];var n=i?qt.PERSISTED_KEYTIP_REMOVED:qt.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||u.EventGroup.raise(this,n,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){u.EventGroup.raise(this,qt.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){u.EventGroup.raise(this,qt.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map(function(t){return e.keytips[t].keytip})},e.prototype.addParentOverflow=function(e){var t=Object(r.__spreadArrays)(e.keySequences);if(t.pop(),0!==t.length){var i=this.sequenceMapping[t.toString()];if(i&&i.overflowSetSequence)return Object(r.__assign)(Object(r.__assign)({},e),{overflowSetSequence:i.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){u.EventGroup.raise(this,qt.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Object(u.getId)()),{keytip:Object(r.__assign)({},e),uniqueID:t}},e._instance=new e,e}();function Kt(e){return e.reduce(function(e,t){return e+"-"+t.split("").join("-")},"ktp")}var Wt=function(e){var t,i=e.children,n=function(e){var t,i,n=a.useRef(),o=e.keytipProps?Object(r.__assign)({disabled:e.disabled},e.keytipProps):void 0,s=(t=Mt.getInstance(),void 0===(i=a.useRef()).current&&(i.current={value:"function"==typeof t?t():t}),i.current.value),c=function(e){var t=Object(a.useRef)();return Object(a.useEffect)(function(){t.current=e}),t.current}(e);a.useLayoutEffect(function(){var t,i;n.current&&o&&((null===(t=c)||void 0===t?void 0:t.keytipProps)!==e.keytipProps||(null===(i=c)||void 0===i?void 0:i.disabled)!==e.disabled)&&s.update(o,n.current)}),a.useLayoutEffect(function(){return o&&(n.current=s.register(o)),function(){o&&s.unregister(o,n.current)}},[]);var l={ariaDescribedBy:void 0,keytipId:void 0};return o&&(l=function(e,t,i){var n=e.addParentOverflow(t),a=Object(u.mergeAriaAttributeValues)(i,function(e){return e.length?" ktp-layer-id "+Kt(e):" ktp-layer-id"}(n.keySequences)),o=Object(r.__spreadArrays)(n.keySequences);return n.overflowSetSequence&&(o=function(e,t){var i=t.length,n=Object(r.__spreadArrays)(t).pop(),a=Object(r.__spreadArrays)(e);return Object(u.addElementAtIndex)(a,i-1,n)}(o,n.overflowSetSequence)),{ariaDescribedBy:a,keytipId:Kt(o)}}(s,o,e.ariaDescribedBy)),l}(Object(r.__rest)(e,["children"])),o=n.keytipId,s=n.ariaDescribedBy;return i(((t={})["data-ktp-target"]=o,t["data-ktp-execute-target"]=o,t["aria-describedby"]=s,t))},Gt=Object(u.classNamesFunction)(),Vt=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._checkBox=a.createRef(),n._renderContent=function(e,t,i){void 0===i&&(i={});var o=n.props,s=o.disabled,c=o.inputProps,l=o.name,d=o.ariaLabel,p=o.ariaLabelledBy,m=o.ariaDescribedBy,h=o.onRenderLabel,g=void 0===h?n._onRenderLabel:h,_=o.checkmarkIconProps,f=o.ariaPositionInSet,v=o.ariaSetSize,y=o.title,b=o.label;return a.createElement("div",{className:n._classNames.root,title:y},a.createElement(u.FocusRects,null),a.createElement("input",Object(r.__assign)({type:"checkbox"},c,{"data-ktp-execute-target":i["data-ktp-execute-target"],checked:e,disabled:s,className:n._classNames.input,ref:n._checkBox,name:l,id:n._id,title:y,onChange:n._onChange,onFocus:n._onFocus,onBlur:n._onBlur,"aria-disabled":s,"aria-label":d||b,"aria-labelledby":p,"aria-describedby":Object(u.mergeAriaAttributeValues)(m,i["aria-describedby"]),"aria-posinset":f,"aria-setsize":v,"aria-checked":t?"mixed":e?"true":"false"})),a.createElement("label",{className:n._classNames.label,htmlFor:n._id},a.createElement("div",{className:n._classNames.checkbox,"data-ktp-target":i["data-ktp-target"]},a.createElement(k.Icon,Object(r.__assign)({iconName:"CheckMark"},_,{className:n._classNames.checkmark}))),g(n.props,n._onRenderLabel)))},n._onFocus=function(e){var t=n.props.inputProps;t&&t.onFocus&&t.onFocus(e)},n._onBlur=function(e){var t=n.props.inputProps;t&&t.onBlur&&t.onBlur(e)},n._onChange=function(e){var t=n.props.onChange,i=n.state,r=i.isChecked;i.isIndeterminate?(t&&t(e,r),void 0===n.props.indeterminate&&n.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===n.props.checked&&n.setState({isChecked:!r}))},n._onRenderLabel=function(e){var t=e.label,i=e.title;return t?a.createElement("span",{"aria-hidden":"true",className:n._classNames.text,title:i},t):null},Object(u.initializeComponentRef)(n),n._id=n.props.id||Object(u.getId)("checkbox-"),n.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},n}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var i={};return void 0!==e.indeterminate&&(i.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(i.isChecked=!!e.checked),Object.keys(i).length?i:null},t.prototype.render=function(){var e=this,t=this.props,i=t.className,n=t.disabled,r=t.boxSide,o=t.theme,s=t.styles,c=t.onRenderLabel,l=void 0===c?this._onRenderLabel:c,d=t.keytipProps,u=this.state,p=u.isChecked,m=u.isIndeterminate;return this._classNames=Gt(s,{theme:o,className:i,disabled:n,indeterminate:m,checked:p,reversed:"start"!==r,isUsingCustomLabelRender:l!==this._onRenderLabel}),d?a.createElement(Wt,{keytipProps:d,disabled:n},function(t){return e._renderContent(p,m,t)}):this._renderContent(p,m)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(a.Component),Zt={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},Qt=Object(u.styled)(Vt,function(e){var t,i,n,a,o,s,c,l,d,p,m,h,g,_,f,v,y,b,C=e.className,T=e.theme,x=e.reversed,w=e.checked,S=e.disabled,D=e.isUsingCustomLabelRender,I=e.indeterminate,P=T.semanticColors,A=T.effects,k=T.palette,L=T.fonts,O=Object(u.getGlobalClassNames)(Zt,T),E=P.inputForegroundChecked,N=k.neutralSecondary,j=k.neutralPrimary,R=P.inputBackgroundChecked,z=P.inputBackgroundChecked,F=P.disabledBodySubtext,U=P.inputBorderHovered,B=P.inputBackgroundCheckedHovered,q=P.inputBackgroundChecked,H=P.inputBackgroundCheckedHovered,M=P.inputBackgroundCheckedHovered,K=P.inputTextHovered,W=P.disabledBodySubtext,G=P.bodyText,V=P.disabledText,Z=[(t={content:'""',borderRadius:A.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:S?F:R,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[u.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[O.root,{position:"relative",display:"flex"},x&&"reversed",w&&"is-checked",!S&&"is-enabled",S&&"is-disabled",!S&&[!w&&(i={},i[":hover ."+O.checkbox]=(n={borderColor:U},n[u.HighContrastSelector]={borderColor:"Highlight"},n),i[":focus ."+O.checkbox]={borderColor:U},i[":hover ."+O.checkmark]=(a={color:N,opacity:"1"},a[u.HighContrastSelector]={color:"Highlight"},a),i),w&&!I&&(o={},o[":hover ."+O.checkbox]={background:H,borderColor:M},o[":focus ."+O.checkbox]={background:H,borderColor:M},o[u.HighContrastSelector]=(s={},s[":hover ."+O.checkbox]={background:"Highlight",borderColor:"Highlight"},s[":focus ."+O.checkbox]={background:"Highlight"},s[":focus:hover ."+O.checkbox]={background:"Highlight"},s[":focus:hover ."+O.checkmark]={color:"Window"},s[":hover ."+O.checkmark]={color:"Window"},s),o),I&&(c={},c[":hover ."+O.checkbox+", :hover ."+O.checkbox+":after"]=(l={borderColor:B},l[u.HighContrastSelector]={borderColor:"WindowText"},l),c[":focus ."+O.checkbox]={borderColor:B},c[":hover ."+O.checkmark]={opacity:"0"},c),(d={},d[":hover ."+O.text+", :focus ."+O.text]=(p={color:K},p[u.HighContrastSelector]={color:S?"GrayText":"WindowText"},p),d)],C],input:(m={position:"absolute",background:"none",opacity:0},m["."+u.IsFocusVisibleClassName+" &:focus + label::before"]=(h={outline:"1px solid "+T.palette.neutralSecondary,outlineOffset:"2px"},h[u.HighContrastSelector]={outline:"1px solid WindowText"},h),m),label:[O.label,T.fonts.medium,{display:"flex",alignItems:D?"center":"flex-start",cursor:S?"default":"pointer",position:"relative",userSelect:"none"},x&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[O.checkbox,(g={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+j,borderRadius:A.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":I?Z:null},g[u.HighContrastSelector]=Object(r.__assign)({borderColor:"WindowText"},Object(u.getHighContrastNoAdjustStyle)()),g),I&&{borderColor:R},x?{marginLeft:4}:{marginRight:4},!S&&!I&&w&&(_={background:q,borderColor:z},_[u.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},_),S&&(f={borderColor:F},f[u.HighContrastSelector]={borderColor:"GrayText"},f),w&&S&&(v={background:W,borderColor:F},v[u.HighContrastSelector]={background:"Window"},v)],checkmark:[O.checkmark,(y={opacity:w?"1":"0",color:E},y[u.HighContrastSelector]=Object(r.__assign)({color:S?"GrayText":"Window"},Object(u.getHighContrastNoAdjustStyle)()),y)],text:[O.text,(b={color:S?V:G,fontSize:L.medium.fontSize,lineHeight:"20px"},b[u.HighContrastSelector]=Object(r.__assign)({color:S?"GrayText":"WindowText"},Object(u.getHighContrastNoAdjustStyle)()),b),x?{marginRight:4}:{marginLeft:4}]}},void 0,{scope:"Checkbox"});Object(fe.loadStyles)([{rawString:".ms-ListCreationPanel{margin-top:50px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-ListCreationPanel-PanelDescription{margin-top:10px;margin-bottom:0px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;font-weight:300}.ms-ListCreationPanel-NameField{margin-top:17px;margin-bottom:7px}.ms-ListCreationPanel-DescriptionField{resize:none;margin-top:17px;margin-bottom:7px}.ms-ListCreationPanel-ErrorMessage{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"errorText",defaultValue:"#a4262c"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;margin-top:20px;margin-bottom:13px}.ms-ListCreationPanel-DescriptionField .ms-TextField-field{display:block}.ms-ChoiceField.ms-ListCreationPanel-Checkbox{margin-top:13px;margin-bottom:13px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}.ms-Checkbox.ms-ListCreationPanel-Checkbox{margin-top:13px;margin-bottom:13px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir='ltr'] .ms-ListCreationPanel-CancelButton.ms-Button{margin-left:8px}[dir='rtl'] .ms-ListCreationPanel-CancelButton.ms-Button{margin-right:8px}.ms-ListCreationPanel-Spinner{margin-top:20px}.ms-ListCreationPanel-Spinner .ms-Spinner-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.ms-ListCreationPanel-CreateButton{border-color:transparent}\n"}]);var Yt,Jt,Xt=function(e){function t(t){var i=e.call(this,t)||this;return i._onCancelClick=function(e){i.props.onCancel.onCancelAction&&(i.props.onCancel.onCancelAction(e),e.stopPropagation(),e.preventDefault())},i._onListTitleChanged=function(e,t){var n=i._listTitleInput&&i._listTitleInput.value?i._listTitleInput.value.trim():"";n&&i.state.listTitle!==n?i.setState({createButtonDisabled:!1,listTitle:n,errorMessage:null}):n&&i.state.listTitle===n?i.setState({createButtonDisabled:!1}):i.setState({createButtonDisabled:!0})},i._onListDescriptionChanged=function(e,t){var n=i._listDescriptionInput&&i._listDescriptionInput.value?i._listDescriptionInput.value:"";i.state.listDescription!==n&&i.setState({listDescription:n})},i._onShowInQuickLaunchChanged=function(){i.setState({showInQuickLaunch:!i.state.showInQuickLaunch})},i.state={showInQuickLaunch:i.props.showInQuickLaunchDefault,createButtonDisabled:!0,showLoadingSpinner:!1},i}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.errorMessage&&this.setState({showLoadingSpinner:!1,createButtonDisabled:!1,errorMessage:e.errorMessage})},t.prototype.render=function(){var e=this.props,t=e.panelDescription,i=e.nameFieldLabel,n=e.nameFieldPlaceHolder,r=e.descriptionFieldLabel,o=e.descriptionFieldPlaceHolder,s=e.showInQuickLaunchString,c=e.spinnerString,l=this.state,d=l.showInQuickLaunch,p=l.listTitle,m=l.listDescription,h=l.createButtonDisabled,g=l.showLoadingSpinner,_=l.errorMessage,f=a.createElement(u.PrimaryButton,{className:"ms-ListCreationPanel-CreateButton",disabled:h,ariaLabel:this.props.onCreate.onCreateString,onClick:this._onCreateClick.bind(this,p,m,d)},this.props.onCreate.onCreateString),v=a.createElement(u.DefaultButton,{className:"ms-ListCreationPanel-CancelButton",ariaLabel:this.props.onCancel.onCancelString,onClick:this._onCancelClick},this.props.onCancel.onCancelString),y=a.createElement(u.TextField,{className:"ms-ListCreationPanel-NameField",label:i,placeholder:n,componentRef:this._resolveRef("_listTitleInput"),onChange:this._onListTitleChanged,required:!0}),b=a.createElement(u.TextField,{className:"ms-ListCreationPanel-DescriptionField",label:r,placeholder:o,componentRef:this._resolveRef("_listDescriptionInput"),multiline:!0,resizable:!1,onChange:this._onListDescriptionChanged}),C=a.createElement(Qt,{className:"ms-ListCreationPanel-Checkbox",label:s,onChange:this._onShowInQuickLaunchChanged,checked:d});return a.createElement("div",{className:"ms-ListCreationPanelContent"},t?a.createElement("div",{className:"ms-ListCreationPanel-PanelDescription"},t):null,y,b,a.createElement("div",{className:"ms-ListCreationPanel-ErrorMessage","aria-live":"polite"},_||null),C,a.createElement("div",{className:"ms-ListCreationPanel-Buttons"},f,v),g?a.createElement(u.Spinner,{className:"ms-ListCreationPanel-Spinner",label:c}):null)},t.prototype._onCreateClick=function(e,t,i,n){this.setState({showLoadingSpinner:!0,createButtonDisabled:!0}),this.props.onCreate.onCreateAction&&(this.props.onCreate.onCreateAction(e,t,i,n),n.stopPropagation(),n.preventDefault())},t.defaultProps={showInQuickLaunchDefault:!0},t}(u.BaseComponent),$t={},ei=Object(u.classNamesFunction)(),ti=function(e){function t(t){var i=e.call(this,t)||this;return i._rootRef=a.createRef(),i._createLayerElement=function(){var e=i.props.hostId,t=Object(u.getDocument)(i._rootRef.current),n=i._getHost();if(t&&n){i._removeLayerElement();var r=t.createElement("div"),a=i._getClassNames();r.className=a.root,Object(u.setPortalAttribute)(r),Object(u.setVirtualParent)(r,i._rootRef.current),i.props.insertFirst?n.insertBefore(r,n.firstChild):n.appendChild(r),i.setState({hostId:e,layerElement:r},function(){var e=i.props,t=e.onLayerDidMount,n=e.onLayerMounted;n&&n(),t&&t()})}},i.state={},i}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.hostId;this._createLayerElement(),e&&function(e,t){$t[e]||($t[e]=[]),$t[e].push(t)}(e,this._createLayerElement)},t.prototype.render=function(){var e=this.state.layerElement,t=this._getClassNames(),i=this.props.eventBubblingEnabled;return a.createElement("span",{className:"ms-layer",ref:this._rootRef},e&&o.createPortal(a.createElement(u.Fabric,Object(r.__assign)({},!i&&(Yt||(Yt={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach(function(e){return Yt[e]=ii})),Yt),{className:t.content}),this.props.children),e))},t.prototype.componentDidUpdate=function(){this.props.hostId!==this.state.hostId&&this._createLayerElement()},t.prototype.componentWillUnmount=function(){var e=this.props.hostId;this._removeLayerElement(),e&&function(e,t){if($t[e]){var i=$t[e].indexOf(t);i>=0&&($t[e].splice(i,1),0===$t[e].length&&delete $t[e])}}(e,this._createLayerElement)},t.prototype._removeLayerElement=function(){var e=this.props.onLayerWillUnmount,t=this.state.layerElement;if(t&&Object(u.setVirtualParent)(t,null),e&&e(),t&&t.parentNode){var i=t.parentNode;i&&i.removeChild(t)}},t.prototype._getClassNames=function(){var e=this.props,t=e.className,i=e.styles,n=e.theme;return ei(i,{theme:n,className:t,isNotHost:!this.props.hostId})},t.prototype._getHost=function(){var e=this.props.hostId,t=Object(u.getDocument)(this._rootRef.current);if(t)return e?t.getElementById(e):t.body},t.defaultProps={onLayerDidMount:function(){},onLayerWillUnmount:function(){}},Object(r.__decorate)([Object(u.customizable)("Layer",["theme","hostId"])],t)}(a.Component),ii=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},ni={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},ri=Object(u.styled)(ti,function(e){var t=e.className,i=e.isNotHost,n=e.theme,r=Object(u.getGlobalClassNames)(ni,n);return{root:[r.root,n.fonts.medium,i&&[r.rootNoHost,{position:"fixed",zIndex:u.ZIndexes.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[r.content,{visibility:"visible"}]}},void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),ai=i("OAkL"),oi=Object(u.classNamesFunction)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(Jt||(Jt={}));var si,ci,li,di,ui,pi,mi,hi=function(e){function t(t){var i=e.call(this,t)||this;i._panel=a.createRef(),i._animationCallback=null,i._hasCustomNavigation=!(!i.props.onRenderNavigation&&!i.props.onRenderNavigationContent),i.dismiss=function(e){i.props.onDismiss&&i.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&i.close()},i._allowScrollOnPanel=function(e){e?i._allowTouchBodyScroll?Object(u.allowOverscrollOnElement)(e,i._events):Object(u.allowScrollOnElement)(e,i._events):i._events.off(i._scrollableContent),i._scrollableContent=e},i._onRenderNavigation=function(e){if(!i.props.onRenderNavigationContent&&!i.props.onRenderNavigation&&!i.props.hasCloseButton)return null;var t=i.props.onRenderNavigationContent,n=void 0===t?i._onRenderNavigationContent:t;return a.createElement("div",{className:i._classNames.navigation},n(e,i._onRenderNavigationContent))},i._onRenderNavigationContent=function(e){var t,n=e.closeButtonAriaLabel,r=e.hasCloseButton,o=e.onRenderHeader,s=void 0===o?i._onRenderHeader:o;if(r){var c=null===(t=i._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return a.createElement(a.Fragment,null,!i._hasCustomNavigation&&s(i.props,i._onRenderHeader,i._headerTextId),a.createElement(u.IconButton,{styles:c,className:i._classNames.closeButton,onClick:i._onPanelClick,ariaLabel:n,title:n,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},i._onRenderHeader=function(e,t,n){var o=e.headerText,s=e.headerTextProps,c=void 0===s?{}:s;return o?a.createElement("div",{className:i._classNames.header},a.createElement("div",Object(r.__assign)({id:n,role:"heading","aria-level":1},c,{className:Object(u.css)(i._classNames.headerText,c.className)}),o)):null},i._onRenderBody=function(e){return a.createElement("div",{className:i._classNames.content},e.children)},i._onRenderFooter=function(e){var t=i.props.onRenderFooterContent,n=void 0===t?null:t;return n?a.createElement("div",{className:i._classNames.footer},a.createElement("div",{className:i._classNames.footerInner},n())):null},i._animateTo=function(e){e===Jt.open&&i.props.onOpen&&i.props.onOpen(),i._animationCallback=i._async.setTimeout(function(){i.setState({visibility:e}),i._onTransitionComplete()},200)},i._clearExistingAnimationTimer=function(){null!==i._animationCallback&&i._async.clearTimeout(i._animationCallback)},i._onPanelClick=function(e){i.dismiss(e)},i._onTransitionComplete=function(){i._updateFooterPosition(),i.state.visibility===Jt.open&&i.props.onOpened&&i.props.onOpened(),i.state.visibility===Jt.closed&&i.props.onDismissed&&i.props.onDismissed()};var n=i.props.allowTouchBodyScroll,o=void 0!==n&&n;return i._allowTouchBodyScroll=o,i._async=new u.Async(i),i._events=new u.EventGroup(i),Object(u.initializeComponentRef)(i),Object(u.warnDeprecations)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),i.state={isFooterSticky:!1,visibility:Jt.closed,id:Object(u.getId)("Panel")},i}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==Jt.closed&&t.visibility!==Jt.animatingClosed?e.isOpen||t.visibility!==Jt.open&&t.visibility!==Jt.animatingOpen?null:{visibility:Jt.animatingClosed}:{visibility:Jt.animatingOpen}},t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:Jt.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var i=this._shouldListenForOuterClick(this.props),n=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===Jt.animatingOpen?this._animateTo(Jt.open):this.state.visibility===Jt.animatingClosed&&this._animateTo(Jt.closed)),i&&!n?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!i&&n&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,i=void 0===t?"":t,n=e.elementToFocusOnDismiss,o=e.firstFocusableSelector,s=e.focusTrapZoneProps,c=e.forceFocusInsideTrap,l=e.hasCloseButton,d=e.headerText,p=e.headerClassName,m=void 0===p?"":p,h=e.ignoreExternalFocusing,g=e.isBlocking,_=e.isFooterAtBottom,f=e.isLightDismiss,v=e.isHiddenOnDismiss,y=e.layerProps,b=e.overlayProps,C=e.popupProps,T=e.type,x=e.styles,w=e.theme,S=e.customWidth,D=e.onLightDismissClick,I=void 0===D?this._onPanelClick:D,P=e.onRenderNavigation,A=void 0===P?this._onRenderNavigation:P,k=e.onRenderHeader,L=void 0===k?this._onRenderHeader:k,O=e.onRenderBody,E=void 0===O?this._onRenderBody:O,N=e.onRenderFooter,j=void 0===N?this._onRenderFooter:N,R=this.state,z=R.isFooterSticky,F=R.visibility,U=R.id,B=T===Bt.smallFixedNear||T===Bt.customNear,q=Object(u.getRTL)(w)?B:!B,H=T===Bt.custom||T===Bt.customNear?{width:S}:{},M=Object(u.getNativeProps)(this.props,u.divProperties),K=this.isActive,W=F===Jt.animatingClosed||F===Jt.animatingOpen;if(this._headerTextId=d&&U+"-headerText",!K&&!W&&!v)return null;this._classNames=oi(x,{theme:w,className:i,focusTrapZoneClassName:s?s.className:void 0,hasCloseButton:l,headerClassName:m,isAnimating:W,isFooterSticky:z,isFooterAtBottom:_,isOnRightSide:q,isOpen:K,isHiddenOnDismiss:v,type:T,hasCustomNavigation:this._hasCustomNavigation});var G,V=this._classNames,Z=this._allowTouchBodyScroll;return g&&K&&(G=a.createElement(u.Overlay,Object(r.__assign)({className:V.overlay,isDarkThemed:!1,onClick:f?I:void 0,allowTouchBodyScroll:Z},b))),a.createElement(ri,Object(r.__assign)({},y),a.createElement(ai.Popup,Object(r.__assign)({role:"dialog","aria-modal":"true",ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:V.hiddenPanel},C),a.createElement("div",Object(r.__assign)({"aria-hidden":!K&&W},M,{ref:this._panel,className:V.root}),G,a.createElement(u.FocusTrapZone,Object(r.__assign)({ignoreExternalFocusing:h,forceFocusInsideTrap:!(!g||v&&!K)&&c,firstFocusableSelector:o,isClickableOutsideFocusTrap:!0},s,{className:V.main,style:H,elementToFocusOnDismiss:n}),a.createElement("div",{className:V.commands,"data-is-visible":!0},A(this.props,this._onRenderNavigation)),a.createElement("div",{className:V.contentInner},(this._hasCustomNavigation||!l)&&L(this.props,this._onRenderHeader,this._headerTextId),a.createElement("div",{ref:this._allowScrollOnPanel,className:V.scrollableContent,"data-is-scrollable":!0},E(this.props,this._onRenderBody)),j(this.props,this._onRenderFooter))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:Jt.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:Jt.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===Jt.open||this.state.visibility===Jt.animatingOpen},enumerable:!0,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,i=e.scrollHeight;this.setState({isFooterSticky:t<i})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(u.elementContains)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:Bt.smallFixedFar},t}(a.Component),gi={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},_i=((si={})["@media (min-width: "+u.ScreenWidthMinMedium+"px)"]={width:340},si),fi=((ci={})["@media (min-width: "+u.ScreenWidthMinLarge+"px)"]={width:592},ci["@media (min-width: "+u.ScreenWidthMinXLarge+"px)"]={width:644},ci),vi=((li={})["@media (min-width: "+u.ScreenWidthMinUhfMobile+"px)"]={left:48,width:"auto"},li["@media (min-width: "+u.ScreenWidthMinXXLarge+"px)"]={left:428},li),yi=((di={})["@media (min-width: "+u.ScreenWidthMinXXLarge+"px)"]={left:"auto",width:940},di),bi=((ui={})["@media (min-width: "+u.ScreenWidthMinXXLarge+"px)"]={left:176},ui),Ci=function(e){var t;switch(e){case Bt.smallFixedFar:t=Object(r.__assign)({},_i);break;case Bt.medium:t=Object(r.__assign)(Object(r.__assign)({},_i),fi);break;case Bt.large:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},_i),fi),vi);break;case Bt.largeFixed:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},_i),fi),vi),yi);break;case Bt.extraLarge:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},_i),fi),vi),bi)}return t},Ti={paddingLeft:"24px",paddingRight:"24px"},xi=Object(u.styled)(hi,function(e){var t,i=e.className,n=e.focusTrapZoneClassName,a=e.hasCloseButton,o=e.headerClassName,s=e.isAnimating,c=e.isFooterSticky,l=e.isFooterAtBottom,d=e.isOnRightSide,p=e.isOpen,m=e.isHiddenOnDismiss,h=e.hasCustomNavigation,g=e.theme,_=e.type,f=void 0===_?Bt.smallFixedFar:_,v=g.effects,y=g.fonts,b=g.semanticColors,C=Object(u.getGlobalClassNames)(gi,g),T=f===Bt.custom||f===Bt.customNear;return{root:[C.root,g.fonts.medium,p&&C.isOpen,a&&C.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},T&&d&&C.custom,T&&!d&&C.customNear,i],overlay:[{pointerEvents:"auto",cursor:"pointer"},p&&s&&u.AnimationClassNames.fadeIn100,!p&&s&&u.AnimationClassNames.fadeOut100],hiddenPanel:[!p&&!s&&m&&{visibility:"hidden"}],main:[C.main,{backgroundColor:b.bodyBackground,boxShadow:v.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:"auto",right:0,width:"100%",selectors:Object(r.__assign)((t={},t[u.HighContrastSelector]={borderLeft:"3px solid "+b.variantBorder,borderRight:"3px solid "+b.variantBorder},t),Ci(f))},f===Bt.smallFluid&&{left:0},f===Bt.smallFixedNear&&{left:0,right:"auto",width:272},f===Bt.customNear&&{right:"auto",left:0},T&&{maxWidth:"100vw"},p&&s&&!d&&u.AnimationClassNames.slideRightIn40,p&&s&&d&&u.AnimationClassNames.slideLeftIn40,!p&&s&&!d&&u.AnimationClassNames.slideLeftOut40,!p&&s&&d&&u.AnimationClassNames.slideRightOut40,n],commands:[C.commands,{marginTop:18},h&&{marginTop:"inherit"}],navigation:[C.navigation,{display:"flex",justifyContent:"flex-end"},h&&{height:"44px"}],contentInner:[C.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[C.header,Ti,{alignSelf:"flex-start"},a&&!h&&{flexGrow:1},h&&{flexShrink:0}],headerText:[C.headerText,y.xLarge,{color:b.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},o],scrollableContent:[C.scrollableContent,{overflowY:"auto"},l&&{flexGrow:1}],content:[C.content,Ti,{paddingBottom:20}],footer:[C.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+u.AnimationVariables.durationValue3+" "+u.AnimationVariables.easeFunction2},c&&{background:b.bodyBackground,borderTopColor:b.variantBorder}],footerInner:[C.footerInner,Ti,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[C.closeButton,{marginRight:14,color:g.palette.neutralSecondary,fontSize:u.IconFontSizes.large},h&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:g.palette.neutralPrimary}}}}},void 0,{scope:"Panel"}),wi=function(e){function t(t){var i=e.call(this,t)||this;return i._onCancelClick=function(e){var t=i.props.listCreationPanelContentProps;t&&t.onCancel&&t.onCancel.onCancelAction&&(t.onCancel.onCancelAction(e),e.stopPropagation(),e.preventDefault())},i}return Object(r.__extends)(t,e),t.prototype.render=function(){return a.createElement(xi,Object(r.__assign)({className:"ms-ListCreationPanel",onDismiss:this._onCancelClick},this.props.panelProps,{firstFocusableSelector:"ms-TextField-field"}),a.createElement(Xt,Object(r.__assign)({},this.props.listCreationPanelContentProps)))},t.defaultProps={panelProps:{type:Bt.smallFixedFar}},t}(a.Component),Si=i("SfSr"),Di=g.Killswitch.isActivated("f5ec737a-1970-45cb-b6c8-8526638856b0","10/28/2020","check for sync/notify new list creation capability"),Ii=function(e){function t(t){return e.call(this,{dataSourceName:"ListCollectionDataSource"},{pageContext:t})||this}return Object(r.__extends)(t,e),t.prototype.createList=function(t){var i=this,n=e.prototype.getData.call(this,function(){return d.UriEncoding.escapeUrlForCallback(i._pageContext.webAbsoluteUrl)+"/_api/web/lists?&$expand=DefaultViewUrl"},function(e){return i._getSPList(e)},"CreateList",function(){return i._constructCreateListBody(t)});return!Di&&n&&this._pageContext&&this._pageContext.dataSyncClient&&this._pageContext.dataSyncClient.then(function(e){return e&&e.notifyNewListCreated()}),n},t.prototype.ensureSiteAssetsLibrary=function(){var t=this;return e.prototype.getData.call(this,function(){return d.UriEncoding.escapeUrlForCallback(t._pageContext.webAbsoluteUrl)+"/_api/web/lists/ensureSiteAssetsLibrary()"},function(e){return t._getSPList(e)},"EnsureSiteAssetsLibrary")},t.prototype._constructCreateListBody=function(e){return JSON.stringify({__metadata:{type:"SP.List"},BaseTemplate:e.templateType,Description:e.description,Title:e.title,OnQuickLaunch:0!==e.quickLaunchOption})},t.prototype._getSPList=function(e){var t=JSON.parse(e);if(t&&t.d){var i=t.d;return{title:i.Title,description:i.Description,defaultViewUrl:i.DefaultViewUrl,baseTemplate:i.BaseTemplate,hidden:i.Hidden,id:i.Id}}},t}(st),Pi=i("0EJq"),Ai=i.n(Pi),ki=function(){function e(e){var t=this;this._onCreateClick=function(e,i,n,r){var a;g.Engagement.logData({name:"listCreationPanel.onCreate.Click"}),a=n?1:0;var o={title:e,description:i,templateType:t._params.listTemplateType,quickLaunchOption:a};t._spListCollectionDataSource.createList(o).then(function(e){var i=e.defaultViewUrl;t._onSuccess(i,r)},function(e){var i=e.message.value;t.setState({errorMessage:i})}),t._params.onCreateClick&&t._params.onCreateClick(r),r.stopPropagation(),r.preventDefault()},this._onCancelClick=function(e){g.Engagement.logData({name:"listCreationPanel.onCancel.Click"}),t.setState({isPanelOpen:!1}),t._params.onCancelClick&&t._params.onCancelClick(e),e.stopPropagation(),e.preventDefault()},this._params=e,this._pageContext=e.pageContext,this._params.listCreationPanelContainer.state={listUrl:void 0,errorMessage:null,isPanelOpen:!0}}return e.prototype.componentDidMount=function(){var e=this._pageContext;this._spListCollectionDataSource=new Ii(e)},e.prototype.getRenderProps=function(){var e=this._params,t=e.listCreationPanelContainer.state,i={type:e.panelType,headerText:e.strings.panelHeaderText,isOpen:t.isPanelOpen,isLightDismiss:!0,closeButtonAriaLabel:Ai.a.closeButtonAriaLabel},n={onCreateString:e.strings.onCreateString,onCreateAction:this._onCreateClick},r={onCancelString:e.strings.onCancelString,onCancelAction:this._onCancelClick};return{panelProps:i,listCreationPanelContentProps:{panelDescription:e.strings.panelDescription,nameFieldLabel:e.strings.nameFieldLabel,nameFieldPlaceHolder:e.strings.nameFieldPlaceHolder,descriptionFieldLabel:e.strings.descriptionFieldLabel,descriptionFieldPlaceHolder:e.strings.descriptionFieldPlaceHolder,errorMessage:t.errorMessage,spinnerString:e.strings.spinnerString,onCreate:n,onCancel:r,showInQuickLaunchDefault:e.showInQuickLaunchDefault,showInQuickLaunchString:e.strings.showInQuickLaunchString}}},e.prototype.setState=function(e){this._params.listCreationPanelContainer.setState(e)},e.prototype._onSuccess=function(e,t){this._params.onSuccess(t,e),t.stopPropagation(),t.preventDefault()},e}(),Li=function(e){function t(t){var i=e.call(this,t)||this;return i._stateManager=new ki({listCreationPanelContainer:i,pageContext:i.props.context,panelType:Bt.smallFixedFar,listTemplateType:i.props.listTemplateType,onSuccess:i._onSuccess.bind(i),showInQuickLaunchDefault:!0,strings:{panelHeaderText:i.props.panelHeaderText,onCreateString:Si.b,onCancelString:Si.a,nameFieldLabel:Si.d,descriptionFieldLabel:Si.c,showInQuickLaunchString:Si.f,spinnerString:Si.g}}),i}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this._stateManager.componentDidMount()},t.prototype.render=function(){var e=this._stateManager.getRenderProps();return a.createElement(wi,Object(r.__assign)({},e))},t.prototype._onSuccess=function(e,t){this._navigate({url:t,target:"_self"},e)},t.prototype._navigate=function(e,t){e.target?window.open(e.url,e.target):window.open(e.url)},t}(a.Component),Oi=function(){function e(){}return e.prototype.renderListCreationPanel=function(e){this._container?this._clearContainer():this._container=document.createElement("div");var t=a.createElement(Li,{context:e.context,panelHeaderText:e.panelHeaderText,listTemplateType:e.listTemplateType});o.render(t,this._container)},e.prototype._clearContainer=function(){for(;this._container&&this._container.firstChild;)this._container.removeChild(this._container.firstChild)},e}();!function(e){e[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList"}(pi||(pi={})),function(e){e[e.invalidType=-1]="invalidType",e[e.GenericList=0]="GenericList",e[e.DocumentLibrary=1]="DocumentLibrary"}(mi||(mi={})),pi.mySiteDocumentLibrary,pi.documentLibrary,pi.pictureLibrary,pi.xmlFormLibrary,pi.webPageLibrary,pi.publishingPageLibrary,pi.publishingAsset;var Ei=Be.getIconUrl("upload-doc-tipcard"),Ni=Be.getIconUrl("task-list-tipcard"),ji=function(){function e(e,t,i,n){this._dataSource=new Rt(t,i),this._homeApiSiteActivityDataSource=new Ht(t,i,n),this._pageContext=t}return e.prototype.getActivities=function(e){return this._dataSource.getActivities(e)},e.prototype.getAcronymData=function(){return this._dataSource.getAcronymData()},e.prototype.getAggregateActivities=function(e,t,i){var n,r=this;void 0===t&&(t=ze.GetChanges),void 0===i&&(i=8),t===ze.BetaActivities?(i=i>e.fetchLimitForBetaApi?i:e.fetchLimitForBetaApi,n=this._homeApiSiteActivityDataSource.getAggregateActivities(i)):n=this._dataSource.getActivities(e,t).then(function(e){return Me.aggregate(e)});var a=this._dataSource.getCreateWebActivity().catch(function(e){return Promise.resolve(void 0)});return Promise.all([n,a]).then(function(e){if(e.length<2)return[];var t=e[0],i=e[1]&&e[1].length>0?e[1][0]:void 0,n=!1;if(i&&t.length<5&&Date.now()-i.date.getTime()<=6048e5&&(n=!0),n){var a={date:new Date,activityObjectType:je.Tip,latestName:Ke.g,tipDetail:Ke.e,iconUrl:Ni,tipActionIcon:"CalculatorAddition",tipActionLabel:Ke.f,onClick:r._onNewListClick.bind(r),previewIconProps:{iconName:"CustomList"}},o={date:new Date,activityObjectType:je.Tip,latestName:Ke.L,tipDetail:Ke.J,iconUrl:Ei,tipActionIcon:"Upload",tipActionLabel:Ke.K,onClick:function(){r._dataSource.getDefaultDocumentLibraryUrl().then(function(e){window.location.href=e})},previewIconProps:{iconName:"OpenFile"}};i&&t.push(Me.createAggregate(i)),t.push(Me.createAggregate(o),Me.createAggregate(a))}return t})},e.prototype._onNewListClick=function(t){var i={context:this._pageContext.legacyPageContext,panelHeaderText:Si.e,listTemplateType:pi.genericList};e._listCreationPanelRenderer.renderListCreationPanel(i)},e._listCreationPanelRenderer=new Oi,e}(),Ri=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){this._renderActivities()},t.prototype.onInit=function(){var e=this;this._dataProvider=new ji(c.Environment.type,this.context.pageContext,this.context.spHttpClient,this.context.serviceScope),this._mySiteCacheWebPartManager=this.context.serviceScope.consume(p.MySiteWebPartCacheManager.serviceKey),this._useCompactLayout=this._shouldUseCompactLayout(this.width);var t=new d.Uri(window.location.href,{queryCaseInsensitive:!0});if(this.context.pageContext.legacyPageContext.isWebWelcomePage){var i=t.getQueryParameter("activity");!i||"true"!==i.toLowerCase()&&"1"!==i?this._hostPageLoggingType=Re.HomePage:this._hostPageLoggingType=Re.ActivityL2Page}else this.properties.isSeeAllPage?this._hostPageLoggingType=Re.ActivityL2Page:this._hostPageLoggingType=Re.OtherPage;this._getDataIfRequired=this._getDataIfRequired.bind(this),this.render=this.render.bind(this),this._getMaxItemsCount=this._getMaxItemsCount.bind(this),this._async=new u.Async(this),this._delayedRender=this._async.debounce(this._renderActivities,500),this.properties&&!this.properties.hasOwnProperty("maxItems")&&(this.properties.maxItems=8),this._maxItemsCount=this._getMaxItemsCount(),this._queryParams={add:!0,deleteObject:!0,fetchLimit:250,file:!0,folder:!0,group:!0,groupMembershipAdd:!0,groupMembershipDelete:!0,item:!0,latestFirst:!0,list:!0,move:!0,rename:!0,restore:!0,roleAssignmentAdd:!0,roleDefinitionAdd:!0,site:!0,update:!0,user:!0,web:!0,requireSecurityTrim:!0,activity:!0,fetchLimitForBetaApi:this._maxItemsCount+5};var n,r=this.context.webPartTag+".dataFetch.start",a=this.context.webPartTag+".dataFetch.end";return s._PerformanceLogger.getMark(r)||(n=s._PerformanceLogger.now(),s._PerformanceLogger.devMark(r)),s._PerformanceLogger.markComponent(this.context.webPartTag,""+s._PerformanceDataDimensions.DataProvider+ze[this.properties.dataSourceType]),this._getDataIfRequired().then(function(){s._PerformanceLogger.getMark(a)||(s._PerformanceLogger.devMark(a),s._PerformanceLogger.addComponentBreakdown(e.context.webPartTag,"dataFetch",s._PerformanceLogger.now()-n))})},t.prototype.getPropertyPaneConfiguration=function(){var e=[];return e.push(Object(l.PropertyPaneTextField)("maxItems",{label:Ke.y,onGetErrorMessage:this._validateMaxItemsPropertyValue})),{pages:[{header:{description:Ke.z},groups:[{groupFields:e}]}]}},t.prototype.onPropertyPaneFieldChanged=function(t,i,n){var r=this;if(this.properties[t]=n,"dataSourceType"===t)this._dataProvider.getAggregateActivities(this._queryParams,ze[n]).then(function(e){r._items=e,r.render()});else if("maxItems"===t){var a=this._maxItemsCount;this._maxItemsCount=this._getMaxItemsCount(),this._queryParams.fetchLimitForBetaApi=this._maxItemsCount+5,a<this._maxItemsCount&&c._SPFlight.isEnabled(266)?this._dataProvider.getAggregateActivities(this._queryParams,ze.BetaActivities).then(function(e){r._items=e,r.render()}):this._delayedRender()}e.prototype.onPropertyPaneFieldChanged.call(this,t,i,n)},t.prototype.onAfterResize=function(e){var t=this._shouldUseCompactLayout(e);this._useCompactLayout!==t&&(this._useCompactLayout=t,this.render())},t.prototype.onDispose=function(){o.unmountComponentAtNode(this.domElement),e.prototype.onDispose.call(this)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype._renderActivities=function(){var e=new s._QosMonitor("SiteActivityWebPart.Render"),t=this._items&&this._items.length>this._maxItemsCount&&this._hostPageLoggingType!==Re.ActivityL2Page,i=[];this._items&&(i=this._hostPageLoggingType===Re.ActivityL2Page?this._items:this._items.slice(0,this._maxItemsCount));var n={show:t,label:Ke.B,ariaLabel:Ke.A,href:t?this._getSeeAllPageUrl():void 0};try{var r=a.createElement(at,{items:i,hostPageLoggingType:this._hostPageLoggingType,provider:this._dataProvider,pageContext:this.context.pageContext,useCompactLayout:this._useCompactLayout,seeAllLink:n,renderCompleted:this.renderCompleted.bind(this)});o.render(r,this.domElement),e.writeSuccess()}catch(t){e.writeUnexpectedFailure("Unexpected",t)}},t.prototype._getDataIfRequired=function(){var t=this;if(this._items||this._getDataPromise)return e.prototype.onInit.call(this);var i=this.properties.dataSourceType?ze[this.properties.dataSourceType]:c._SPFlight.isEnabled(266)?ze.BetaActivities:ze.GetChanges,n={requestData:function(){return t._dataProvider.getAggregateActivities(t._queryParams,i)}.bind(this),dataUpdated:this.setResponseAndRender,webPartInstanceId:this.context.instanceId,webPartAlias:this.context.manifest.alias};if(this.isMySiteCacheSmartRaceRefactorEnabled()){var r=n;r.serializedConfiguration=JSON.stringify(this.properties),this._getDataPromise=this._mySiteCacheWebPartManager.requestWebPartCacheData(r).then(function(e){return e.cacheResponseAsync||e.serverResponseAsync}).then(function(e){t._items=e},function(e){t.renderError(e)})}else{var a=n;a.config=this.properties,a.webPartTag=this.context.webPartTag,this._getDataPromise=this._mySiteCacheWebPartManager.requestWebPartCacheData_deprecated(a).then(function(e){t._items=e},function(e){t.renderError(e)})}return this._getDataPromise},t.prototype._getMaxItemsCount=function(){var e=8,t=this.properties&&this.properties.maxItems;if(t){var i=parseInt(t,10);i&&(e=i)}return e},t.prototype._validateMaxItemsPropertyValue=function(e){var t=Number(e);return isNaN(t)||t<=0?Ke.G:""},t.prototype._shouldUseCompactLayout=function(e){return e<480},t.prototype._getSeeAllPageUrl=function(){var e=new d.Uri(d.Uri.concatenate(this.context.pageContext.web.absoluteUrl,"_layouts/15/SeeAll.aspx"));return e.setQueryParameter("Page",window.location.pathname),e.setQueryParameter("InstanceId",this.context.instanceId),e.setQueryParameter("WP",m.SeeAllPageLayoutWebparts.SiteActivity.toString()),e.toString()},t.prototype.isMySiteCacheSmartRaceRefactorEnabled=function(){return c._SPFlight.isEnabled(1549)},t.prototype.setResponseAndRender=function(e){this._items=e,this.render()},Object(r.__decorate)([u.autobind],t.prototype,"setResponseAndRender",null),t}(l.BaseClientSideWebPart);t.default=Ri},NNsw:function(e,t,i){e.exports=i.p+"icon_person_576ede56.png"},OAkL:function(e,t,i){var n=i("KL1q");e.exports=n.workaround_Popup},OUAI:function(e,t,i){e.exports=i.p+"icon_upload-doc-tipcard-2x_dad8ee67.png"},Pk8u:function(e,t){e.exports=r},QZHX:function(e,t){e.exports=a},QmvJ:function(e,t,i){var n=i("KL1q");e.exports=n.workaround_Icon},SfSr:function(e){e.exports=JSON.parse('{"e":"Create list","b":"Create","a":"Cancel","d":"Name","c":"Description","f":"Show in site navigation","g":"Creating..."}')},U4ag:function(e,t){e.exports=o},UWqr:function(e,t){e.exports=s},WEGg:function(e,t,i){e.exports=i.p+"icon_empty-state-activity_e646fba1.png"},YYjE:function(e,t){var i={AssignedTasksHeader:"Tasks assigned",EditsTasksHeader:"Recent Tasks",tasksListAriaLabel:"Tasks list for a give plan",seeMore:"See {0} more",seeMoreAriaLabel:"See {0} more"};i.default=i,e.exports=i},Ycni:function(e,t){e.exports=c},ZXnB:function(e,t,i){e.exports=i.p+"icon_spo_99612483.png"},bdhH:function(e,t,i){"use strict";function n(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}i.d(t,"canonicalizeDecodedUrl",function(){return n}),i("y88i")},br4S:function(e,t){e.exports=l},cDcd:function(e,t){e.exports=d},epUW:function(e,t,i){var n=i("KL1q");e.exports=n.workaround_withResponsiveMode},faye:function(e,t){e.exports=u},fglE:function(e,t){e.exports=p},gKNL:function(e,t,i){e.exports=i.p+"icon_doc-library_04a9a5ce.png"},hSLw:function(e,t,i){e.exports=i.p+"icon_task-list_58427cb0.png"},"hiL/":function(e,t){e.exports=m},jO1W:function(e,t,i){e.exports=i.p+"icon_doc-library-2x_4b08457b.png"},jOlS:function(e,t){e.exports=h},"oJ/X":function(e,t,i){e.exports=i.p+"icon_calendar_d91d6c92.png"},p9NL:function(e,t,i){e.exports=i.p+"icon_upload-doc-tipcard_0343ff37.png"},q1Tm:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=function(e,t){var i,n,r,a=e[1]||"",o=e[3];if(!o)return a;if(t&&"function"==typeof btoa){var s=(i=o,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(r," */")),c=o.sources.map(function(e){return"/*# sourceURL=".concat(o.sourceRoot).concat(e," */")});return[a].concat(c).concat([s]).join("\n")}return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(i,"}"):i}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var a=this[r][0];null!=a&&(n[a]=!0)}for(var o=0;o<e.length;o++){var s=e[o];null!=s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="(".concat(s[2],") and (").concat(i,")")),t.push(s))}},t}},qrvM:function(e,t,i){e.exports=i.p+"icon_task-list-tipcard_39ba5173.png"},"uS+E":function(e,t,i){e.exports=i.p+"icon_custom-list-2x_9688a661.png"},ujmI:function(e,t,i){e.exports=i.p+"icon_task-list-tipcard-2x_8682642f.png"},ux2w:function(e,t,i){e.exports=i.p+"icon_preview_e029c8d6.png"},vlQI:function(e,t){e.exports=g},x4he:function(e,t,i){var n=i("HPkc"),r=i("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!0);n.locals&&(e.exports=n.locals)},y88i:function(e,t){e.exports=_},ynV5:function(e,t,i){var n=i("K9kD");e.exports=n.StringHelper},zjh1:function(e,t,i){e.exports=i.p+"icon_custom-list_f170ed14.png"}})});