(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["560"],{"4489":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(54),s=n(74),o=n(31),u=n(71),a=n(253),f=n(30),l=n(1734),c=n(297),h=n(63),p=n(978),d=n(6),v=n(7),m=n(134),g=n(158),y=n(128),b=n(80),w=n(1340),E=n(8),S=(function(){function e(e,t){this.name="Navigation";var n=e.url,r=e.viewParams,i=e.target,s=void 0===i?"_top":i,o=e.forceNavigation,u=void 0!==o&&o,a=e.ignoreHistory,f=e.beforeNavigation,l=e.afterNavigation,c=e.postProcessUrl,h=e.undoInPlaceNav,p=void 0!==h&&h;this._navigation=t.navigation;this._viewParams=t.viewParams;this._url=n;this._inputViewParams=r;this._target=s;this._forceNavigation=u;this._ignoreHistory=a;this._beforeNavigation=f;this._afterNavigation=l;this._postProcessUrl=c;this._undoInPlaceNav=!E.e.isActivated("14C524CE-B651-4226-A833-2DDA94071888","7/30/2020","Undo inplace nav for one page fallback")&&p}e.prototype.execute=function(e){var t=this._url,n=this._inputViewParams,r=this._beforeNavigation;r&&r(this._navigation);var s=this._postProcessUrl?this._postProcessUrl(t):t;if(this._forceNavigation||t){var u={url:s,viewParams:n,frameId:this._target,ignoreHistory:this._ignoreHistory};this._undoInPlaceNav&&this._navigation.undoInPlaceAndNavigateTo?this._navigation.undoInPlaceAndNavigateTo(u):this._navigation.navigateTo(u)}this._afterNavigation&&this._afterNavigation(this._navigation);return i.n.resolve({resultType:o.e.Success})};e.prototype.isAvailable=function(){var e=this._url;if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams,n=this._viewParams,r="#"+c.t(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=c.e(s);return!w.e(n,o)}return e!==r};e.prototype.dispose=function(){};e.dependencies={navigation:b.e,viewParams:g.O};return e})(),x=Object(v.o)("NavigationAction",S),T=n(233),N=n(413),C=n(123),k=n(361),L=n(827),A=n(5),O=n(9),M=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemCacheStore=n.itemCacheStore;r._itemsScopeKeyConverter=n.itemsScopeKeyConverter;return r}t.prototype.prefetchListDataForOnePage=function(e){var t,n,r=this;e.startsWith("#")&&(e=e.substring(1));var i=Object(c.e)(e),s=this._itemCacheStore.dispatch,o=s(Object(C.e)(function(e){return r._itemsScopeKeyConverter.viewParamsToItemKeyControlHandler(e,{viewParams:i,isNavigation:!0}).itemKey}));s(Object(L.t)({items:(t={},t[o]={demands:(n={},n[A.l.id]=!0,n[O.e.id]=!0,n)},t),flushOperationQueue:!0}));return Promise.resolve()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},N.e.dependencies),{itemCacheStore:T.e,itemsScopeKeyConverter:k.e});return t})(N.e),_=Object(v.s)("PrefetchListDataForOnePage",M),D=n(161);n.d(t,"typeResourceKey",function(){return H});var P=(function(){function e(e,t){var n=t.urlDataSourceLite,r=t.powerAppStore,i=t.pageContext,s=t.onePageContext,o=t.resources,u=t.rumone;this._resources=o;this.name="OpenNavLink";this._rumone=u;var a=e.link,f=e.addStateForLandingPage,l=e.ignoreHistory,c=void 0!==l&&l;this._link=a;this._urlDataSourceLite=n;this._powerAppsStore=r;this._pageContext=i;this._onePageContext=s;this._viewParams=t.viewParams;this._listDataPrefetcher=t.listDataPrefetcher;this._navViewParams=this._getNavUrl(this._link);this._async=new D.e;this._fallbackStarted=!1;this._navigationAction=new t.navigationActionType({url:this._link.url,viewParams:this._navViewParams,ignoreHistory:c,beforeNavigation:this._addStateForLandingPage.bind(this,f),resources:this._resources});this._fallBackNavigationAction=new t.navigationActionType({url:this._getNavUrl(this._link,!0),resources:this._resources,undoInPlaceNav:!0})}e.prototype.isAvailable=function(){return this._navigationAction.isAvailable()};e.prototype.execute=function(e){var t=this,n=this._resources,r=n.consume(f.i);r.peek()&&r.peek().length>0&&r("");this._powerAppsStore&&this._powerAppsStore.loadPowerApp(!1);n.consume(y.e.columnCustomizationPane.isColumnCustomizationPaneExpanded)(!1);this._rumone.logOnePageNavigationStart();this._previousListUrl=this._pageContext.listUrl||"";u.e.isActivated("f16521d4-c64b-4d9b-b82c-852401fed6ae","1/27/2021","Use INavLink targetLink to identify doclib")||(this._onePageContext.targetLink=this._link);var a=new h.t(this._link.url);this._onePageContext.newTargetListViewUrl=-1===this._link.url.indexOf("?")?this._link.url:this._link.url.substring(0,this._link.url.indexOf("?"));this._onePageContext.newTargetListViewId=c.e(a.getQuery()).viewid;this._onePageContext.handleOnePageNavigationFallback=function(n){if(!t._fallbackStarted){t._fallbackStarted=!0;var r=new s.e({name:"OnePageNavigation.FallbackToNormalNavigation"}),i={resultType:o.e.ExpectedFailure,extraData:{reason:n}};r.end(i);p.t(i);t._fallBackNavigationAction.execute(e)}};p.i();return this._listDataPrefetcher.prefetchListDataForOnePage(this._navViewParams).then(function(){return new i.n(function(n){t._async.setTimeout(function(){t._navigationAction.execute(e).then(function(){return i.n.wrap({resultType:o.e.Success,extraData:{name:"nav link clicked"}})}).then(function(e){n(e)})},0)})})};e.prototype.dispose=function(){};e.prototype._getNavUrl=function(e,t){return t?e&&e.url||"":e&&this._urlDataSourceLite.getNavLinkClickUrl(e)||e.url||""};e.prototype._addStateForLandingPage=function(e,t){var n;if(t&&e){var i=Object(r.__assign)(Object(r.__assign)({},this._viewParams),((n={}).id=this._previousListUrl,n.newTargetListUrl=this._previousListUrl,n));t.navigateTo({url:location.href,viewParams:"#"+c.t(i),ignoreHistory:!0})}};e.dependencies={resources:d.o,urlDataSourceLite:a.t,powerAppStore:l.resourceKey,pageContext:f.h,onePageContext:f.c,viewParams:g.O,navigationActionType:x,rumone:m.e,listDataPrefetcher:_};return e})(),H=(t.default=P,Object(v.o)("OpenNavLinkAction",P))}}]);