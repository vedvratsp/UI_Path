(window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0=window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0||[]).push([[11],{"84Rh":function(e,t,r){"use strict";r.r(t),r.d(t,"uploadListItem",function(){return K}),r.d(t,"mapConflictResolutionToNameConflictBehavior",function(){return V});var a,i=r("17wl"),n=r("K9kD"),s=r("oCyF"),o=r("dS01"),c=r("vyKV"),l=r("y88i"),u=r("OagR"),d=r("mCCr"),h=r("sylB"),p=r("O/6m"),m=r("q3PD"),_=r("CUTS"),f=r("f55A"),g=function(e){function t(r){var a=e.call(this,r)||this;return a.name="FileHasherError",a.__proto__=t.prototype,a}return Object(i.__extends)(t,e),t}(Error);!function(e){e[e.singleChunk=0]="singleChunk",e[e.start=1]="start",e[e.continue=2]="continue",e[e.finish=3]="finish",e[e.status=4]="status",e[e.cancel=5]="cancel"}(a||(a={}));var v=function(e){function t(t){var r=e.call(this,Object(i.__assign)(Object(i.__assign)({},t),{extraData:Object(i.__assign)(Object(i.__assign)({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;r.errorType=t.errorType,r.displayString=t.displayString;try{r.serverError=JSON.stringify(t.serverError)}catch(e){r.serverError=""}return r}return Object(i.__extends)(t,e),t}(p.a);function b(e){return e&&e.code?e.code.split(",")[0]||e.code:e&&e.number?""+e.number:"UNKNOWN_UPLOAD_ERROR"}function y(e,t){if(!e)return new v({errorType:h.a.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var r,i,n=!1,s=b(e);if(e instanceof _.a&&(e=e.errorData),"string"==typeof e)r=e;else{var o=e.message;"string"==typeof o?r=o:o&&o.value&&(r=o.value,n=!0)}return i=s===f.c?h.a.disconnected:"-2130575257"===s?h.a.conflict:"-2130245249"===s?h.a.similarNameExists:"UPLOAD_TIMEOUT_ERROR"===s?h.a.general:"-2147024891"===s?h.a.accessDenied:404!==e.status||t!==a.start&&t!==a.singleChunk?n?h.a.other:h.a.general:h.a.targetFolderMissing,new v({errorType:i,code:s,statusCode:e.status,displayString:n?r:"",message:r||"Unhandled client error",correlationId:e.correlationId,serverError:e})}var U="ServerRelativeUrl,UniqueId,Name,VroomItemID,VroomDriveID,ServerRedirectedUrl",O=!n.Killswitch.isActivated("B1726BAE-6860-4FE3-937B-2A8768F26044","01/08/2021","Include the full server response for errors without status codes"),F=!n.Killswitch.isActivated("54761027-a6a8-42c2-a8c3-a4821f4955c4","02/19/2021","Large file uploads call new StartUploadFile API to start stream instead of StartUpload"),S=function(){function e(e){var t=e.hasher,r=e.throttler,a=e.dataRequestor,i=e.appName,s=e.webApiUrl,o=e.authToken,c=e.canStream,l=e.fileUpload,u=e.itemExpansion,d=e.destinationUrl,h=e.qosEvent,p=void 0===h?n.Qos:h,m=e.nameConflictBehavior,_=void 0===m?0:m,f=e.onStart,g=e.onAbort,v=e.onProgress;this._hasher=t,this._dataRequestor=a,this._throttler=r,this._chunkNumber=0,this._uploadedBytes=0,this._qosEvent=p,this._id=n.Guid.generate(),this._authToken=o,this._canStream=c,this._webApiUrl=s,this._fileUpload=l,this._async=new n.Async(this),this._itemExpansion=u,this._destinationUrl=d,this._nameConflictBehavior=_,this._chunkSize=Math.min(l.size,262144e3),this._trackingHeaders={Application:i,Scenario:"UploadFile",ScenarioType:"AUO"},this._onStart=f,this._onAbort=g,this._onProgress=v}return e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,r=e._fileUpload.size,a=e._canStream&&r>25165824,s={fileUploadId:t,size:r},o=new e._qosEvent({name:"Upload.h5",extraData:s}),c=a?"SharePointUploader.stream":"SharePointUploader.create",l=new e._qosEvent({name:c,extraData:s}),p=new n.CustomerPromise({scenario:"SharePointUpload",extraData:s});return e._fileName=e._fileUpload.name,e._onStart&&e._onStart(),e.start(a).then(function(e){return o.end({resultType:n.ResultTypeEnum.Success}),l.end({resultType:n.ResultTypeEnum.Success}),p.end({resultType:n.ResultTypeEnum.Success}),e},function(t){if(n.Promise.isCanceled(t))return o.end({resultType:n.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"}),l.end({resultType:n.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"}),p.end({resultType:n.ResultTypeEnum.ExpectedFailure,errorCode:"Aborted"}),e._onAbort&&e._onAbort(),n.Promise.reject(t);var r=function(e){return e instanceof v?e:new v(e instanceof g?{errorType:h.a.other,code:"FileHasher",statusCode:0,innerError:e}:{errorType:h.a.general,code:"Unknown",statusCode:0,innerError:e})}(t),a=function(e){return new m.a({message:e.displayString,errorType:e.errorType,innerError:e,supportsVersioning:!0})}(r),s=function(e){switch(e.errorType){case h.a.disconnected:case h.a.conflict:case h.a.similarNameExists:case h.a.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case f.c:case f.b:case f.d:case"UPLOAD_TIMEOUT_ERROR":case"-2130245249":return!0}return!1}(r)?n.ResultTypeEnum.ExpectedFailure:n.ResultTypeEnum.Failure;o.end(Object(u.a)(Object(d.a)(a),{resultType:s,resultCode:h.a[a.errorType]}));var c=O&&!r.extraData.status&&r.serverError,_=Object(u.a)(Object(d.a)(r),{resultType:s,extraData:Object(i.__assign)(Object(i.__assign)({},c?{serverError:c}:{}),{uploadedBytes:e._uploadedBytes})});l.end(_);var b=_.extraData,y=_.resultCode;return p.end({resultType:s,extraData:b,errorCode:y}),n.Promise.reject(a)})});return this._uploadPromise=t,t},e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0,this._hasCompleted||t&&(t.cancel(),t.then(function(){},function(){}).done(function(){return e._hasher&&e._hasher.dispose(),e.cancelUpload()}))},e.prototype.restart=function(e){var t=e.nameConflictBehavior,r=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=r;var a=this._uploadPromise;return this._uploadPromise=void 0,a&&a.cancel(),this._hasher&&this._hasher.reset(),this.upload()},e.prototype.dispose=function(){this._async.dispose(),this._hasher&&this._hasher.dispose()},e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var r=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){return t.updateProgress(r),e})},e.prototype.updateProgress=function(e){this._uploadedBytes!==e&&(this._uploadedBytes=e,this._onProgress&&this._onProgress(e))},e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var r={};return r.DecodedUrl=this._fileName,1===this._nameConflictBehavior||3===this._nameConflictBehavior?r.overwrite=!0:2===this._nameConflictBehavior&&(r.EnsureUniqueFileName=!0),r.AutoCheckoutOnInvalidData=!0,e&&(r.XorHash=e),t=t.methodWithAliases("AddUsingPath",r).oDataParameter("$Select",U),this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion)),t.toString()},e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var r=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(r,0,r.size):n.Promise.resolve()).then(function(){var i=t._hasher?t._hasher.getFullHash(r.size):void 0,s=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(i),qosName:s,data:r,offset:0,length:r.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(r){if(n.Promise.isCanceled(r))return n.Promise.wrapError(r);if(r&&r.retryAfter&&e>0){var i=1e3*r.retryAfter;return t._throttler.addThrottleTimer(i).then(function(){return t._uploadedBytes=0,t.uploadFile(e-1)})}return n.Promise.wrapError(y(r,a.singleChunk))})})},e.prototype.getStreamingUrl=function(e,t,r,n){var s,o=this._webApiUrl,c=this._fileName,l={uploadId:{guid:this._requestId}};return r===a.start?(s=F?"StartUploadFile":"StartUpload",o=(o=o.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files"),o=1===this._nameConflictBehavior||3===this._nameConflictBehavior?o.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:c}):2===this._nameConflictBehavior?o.methodWithAliases("AddStubUsingPath",Object(i.__assign)({DecodedUrl:c},F?{EnsureUniqueFileName:!0}:{})):o.methodWithAliases("AddStubUsingPath",{DecodedUrl:c})):(r===a.finish?(s=this._hasher?"FinishUploadWithChecksum":"FinishUpload",o=o.oDataParameter("$Select",U),this._itemExpansion&&(o=o.oDataParameter("$Expand",this._itemExpansion))):s="ContinueUpload",o=o.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+c}),l.fileOffset=e,n&&r===a.finish&&(l.checksum=n)),(o=o.methodWithAliases(s,l)).toString()},e.prototype.streamFile=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3),this._requestId||(this._requestId=n.Guid.generate());var i=this._fileUpload.size,s=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,o=this._fileUpload.slice(e,s),c=0===this._chunkNumber?a.start:i<=s?a.finish:a.continue,u=c===a.start,d=c===a.finish,h="SendFileRequest"+(u?".Start":d?this._hasher?".FinishWithChecksum":".Finish":".Continue"),p=this._hasher&&c!==a.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(o,e,s):n.Promise.resolve();return(d?p:n.Promise.resolve()).then(function(){var u=void 0;return r._hasher&&d&&(u=r._hasher.getFullHash(i)),r.uploadChunk({trackSpeed:!0,url:r.getStreamingUrl(e,s,c,u),qosName:h,data:o,offset:e,length:o.size}).then(function(e){r.updateProgress(s);var n=r.parseItemResponse(e);return c===a.start&&2==r._nameConflictBehavior&&n.Name&&(r._fileName=n.Name),s<i?(r._chunkNumber++,p.then(function(){return r.streamFile(s,t)})):n},function(i){if(n.Promise.isCanceled(i))return c!==a.start&&r.cancelUpload(),n.Promise.reject(i);if("UPLOAD_TOO_SLOW_ERROR"===(o=b(s=i))||"UPLOAD_TIMEOUT_ERROR"===o||s&&0===s.status)return r._chunkSize<=1048576?(r.cancelUpload(),n.Promise.reject(y(i,c))):(r._chunkSize=Math.floor(r._chunkSize/2),r.streamFile(e,t));var s,o;if(t>0&&function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===a.start||t===a.singleChunk))return!1;switch(b(e)){case f.d:case"-1":case"-2130575257":case"-2130245249":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":case"-2147024891":return!1;default:return!0}}(i,c)){var u,d=new l.Signal(function(){u&&r._async.clearTimeout(u)});return u=r._async.setTimeout(function(){return d.complete()},1e3),d.getPromise().then(function(){return r.getUploadStatus().then(function(e){return r.streamFile(e,t-1)},function(){return r.streamFile(e,t-1)})})}return c!==a.start&&r.cancelUpload(),n.Promise.reject(y(i,c))})},function(e){return c!==a.start&&r.cancelUpload(),n.Promise.reject(e)})},e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,r=e.response;if(t.resultType===n.ResultTypeEnum.Success){if(!r||!r.d||!r.d.ExpectedContentRange)return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NoContentRange",resultType:n.ResultTypeEnum.Failure})};var a=parseInt(r.d.ExpectedContentRange.split("-")[0],10);if(isNaN(a))return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NaNContentRange",resultType:n.ResultTypeEnum.Failure,error:r.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?n.Promise.reject(""):t}return n.Promise.reject("")})},e.prototype.cancelUpload=function(){if(!this._requestId)return n.Promise.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();return this._requestId="",this._chunkNumber=0,this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})},e.prototype.uploadChunk=function(e){var t,r,a,i,n=this,s=e.url,o=e.qosName,c=e.data,u=e.offset,d=e.length,h=!1,p=new l.Signal(function(){h=!0,t.cancel()}),m=function(e){var t=n._chunkNumber>0&&u+d>=n._fileUpload.size?3e5:1e4,a=Math.min(Math.max(.08*e,t),2147483647);r&&n._async.clearTimeout(r),e&&(r=n._async.setTimeout(function(){p.error({code:"UPLOAD_TIMEOUT_ERROR",message:""})},a))},_=Date.now(),f=Date.now(),g=0,v=0,b=0,y=this._async.debounce(function(e){e>n._uploadedBytes&&n.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:s,qosName:o,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:c,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();v+=(e.loaded-g)/(t-f),b++,a=e.loaded/(t-_),f=t,g=e.loaded,n._onProgress&&y(u+e.loaded),m(d-e.loaded)}}}),m(d),e.trackSpeed&&(i=this._async.setInterval(function(){b&&Date.now()-_+(d-g)/((v+a)/(b+1))>15e4&&g<d&&p.error({code:"UPLOAD_TOO_SLOW_ERROR",message:""})},1e4));var U=function(){r&&n._async.clearTimeout(r),i&&n._async.clearInterval(i)},O=p.getPromise();return t.done(function(e){p.complete(e)},function(e){h||p.error(e)}),O.done(function(){return U()},function(){h||t.cancel(),U()}),O},e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}},e}(),k=r("9G2s"),T={enqueue:function(e){return e()}},w=function(){function e(e){void 0===e&&(e={}),this.async=new n.Async,this.uploaderCount=0,this.throttledSignals=[];var t=e.maxParallelUploads,r=void 0===t?3:t,a=e.maxUploadsPerSecond,i=void 0===a?8:a;this.uploadQueue=r===1/0?T:new k.a(r),this.maxUploads=i}return e.prototype.throttle=function(e){var t=this;return this.uploadQueue.enqueue(function(){return!t.isReady&&t.uploaderCount>=1e3&&(t.uploaderCount=0,t.isReady=!0),t.batchStartTime&&t.uploaderCount>=t.maxUploads?t.throttleUploader(e):(t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now()),t.startUploader(e))})},e.prototype.addThrottleTimer=function(e){return this.isReady=!0,this.setTimeout(e),this.addUploaderCallback(function(){return n.Promise.resolve()})},e.prototype.startUploader=function(e){return this.uploaderCount+=1,e()},e.prototype.addUploaderCallback=function(e){var t=this,r=new l.Signal;return this.throttledSignals.push(r),r.getPromise().then(function(){return t.startUploader(e)})},e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);return t>0?(this.setTimeout(t),this.addUploaderCallback(e)):(this.uploaderCount=0,this.batchStartTime=Date.now(),this.startUploader(e))},e.prototype.setTimeout=function(e){var t=this;this.timeout&&(this.async.clearTimeout(this.timeout),this.timeout=void 0),this.timeout=this.async.setTimeout(function(){t.timeout=void 0,t.uploaderCount=0,t.batchStartTime=Date.now();for(var e=0,r=t.throttledSignals;e<r.length;e++)r[e].complete();t.throttledSignals=[]},e)},e}(),E=r("NX6U"),j=r("oveG"),C=r("LNaD"),D=r("9HFz"),R=r("GQoE"),P=r("vLsd"),N=r("Rr4e"),A=r("vHN8"),I=r("H8DK"),x=r("6Pju"),q=r("Ql3v"),B=r("xl7e"),z=r("F0Gs"),L=r("9kMg"),M=r("2YyJ"),H=r("9Zk4"),W=r("MQWL"),G=Object(B.a)(function(){return new w({maxParallelUploads:1/0})}),Q=function(e){return function(t){var r=Object(W.a)(t,e);if(r&&Object(n.getKillSwitch)(r).isActivated("3E300045-4874-4525-A1A3-29E5A7BF6BC7","10/21/2020","No longer disable streaming when download is disabled.")&&r.blockDownloadsExperienceEnabled)return!1;var a=t.demandItemFacet(j.fc,e);return!(a&&!c.b.hasItemPermission({permissions:a},c.b.editListItems))}};function K(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,c=s.a.deserialize(r),l=c.webAbsoluteUrl,u=c.listFullUrl,d=Object.keys(a)[0],h=a[d],p=h.progressItemKey,m=h.conflictResolution;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,a,h,_,f,g,v,b,y,U,O,F,k,T,w,B,K,J,$,Y,X,Z,ee,te,re,ae,ie,ne,se,oe,ce;return Object(i.__generator)(this,function(le){switch(le.label){case 0:return t=e(Object(E.c)({webAbsoluteUrl:l,listFullUrl:u})),a=t.dataRequestor,h=t.hasDigest,t.hasTokenProvider?(f=void 0,[3,3]):[3,1];case 1:return[4,e(Object(E.a)({url:l||u,disallowCookies:!h}))];case 2:f=le.sent(),le.label=3;case 3:if(_=f,!(g=e(Object(R.a)({sourceFile:P.b},d)).sourceFile))throw new Error("No source file for upload.");if(v=e(Object(R.a)({folderPath:j.hb},r)).folderPath,!(b=void 0===v?c.rootFolder:v))throw new Error("No path information for target folder.");y=e(Object(q.a)(function(e,t){return function(t){var r=Object(W.a)(t,e);return 1024*(r&&r.maximumFileSize||Number.POSITIVE_INFINITY)*1024}}(r))),g.size>y&&Object(H.c)(y),U=Object(x.d)({webAbsoluteUrl:l,listOrItemFullUrl:u}),O=new C.Async(void 0),F=O.debounce(function(t){var r;p&&e(Object(N.a)({items:(r={},r[p]=Object(A.c)({progressSize:I.q},{progressSize:{current:t}}),r)}))},300,{leading:!1}),k=o.a.serialize({webAbsoluteUrl:l,listFullUrl:u}),T=e(Object(q.a)(function(e){return e.demandItemFacet(j.Ib,k)})),w=!(!T||!T.contentTypesEnabled||T.templateType===L.a.mySiteDocumentLibrary),B=V(m),K=e(Object(M.a)({clientName:D.b})).clientName,J=new S({authToken:_,onProgress:F,dataRequestor:a,nameConflictBehavior:B,webApiUrl:U,fileUpload:g,destinationUrl:b,appName:K||"Unknown",throttler:e(G),canStream:e(Object(q.a)(Q(r))),itemExpansion:w?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"}),p&&e(Object(N.a)({items:(se={},se[p]=Object(i.__assign)({},I.q.pack({total:g.size,current:0})),se)})),$=J.upload(),Y=e(Object(q.a)(function(e){return e.demandItemFacet(I.e,p)})),X=Y?Y.token.subscribe(function(){J.abort()}):void 0,le.label=4;case 4:return le.trys.push([4,6,7,8]),[4,$];case 5:return Z=le.sent(),[3,8];case 6:throw ee=le.sent(),J.abort(),e(Object(H.b)(ee));case 7:return X&&X(),J.dispose(),[7];case 8:return te=Z.ServerRelativeUrl,re=Z.ListItemAllFields&&Z.ListItemAllFields.Id?String(Z.ListItemAllFields.Id):Z.ServerRelativeUrl,ae=s.a.serialize({webAbsoluteUrl:l,listFullUrl:u,itemId:re}),ie=Z.UniqueId?n.Guid.normalizeLower(Z.UniqueId):"",ne=Z.Name,p&&e(Object(N.a)({items:(oe={},oe[p]=Object(i.__assign)({},z.h.pack(ne)),oe)})),e(Object(N.a)({items:(ce={},ce[ae]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},z.h.pack(ne)),ie?j.kd.pack(ie):{}),te?j.hb.pack(te):{}),z.A.pack({itemKey:r})),ce)})),[2,{itemKey:ae}]}})})}}function V(e){switch(e){case"replace":return 1;case"rename":return 2;default:return 0}}},"9G2s":function(e,t,r){"use strict";var a=r("K9kD"),i=r("y88i"),n=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new i.Signal(function(){r.canceled=!0,a.Promise.is(r.result)&&r.result.cancel()}),this._queue.push(r),t=r.signal.getPromise()}return a.Promise.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(r){t.signal.complete(r),e._promiseComplete()},function(r){t.signal.error(r),e._promiseComplete()}))}},e}();t.a=n},"9Zk4":function(e,t,r){"use strict";r.d(t,"c",function(){return h}),r.d(t,"b",function(){return p}),r.d(t,"a",function(){return m});var a=r("17wl"),i=r("K9kD"),n=r("c5SI"),s=r("sylB"),o=r("EFk2"),c=r("q3PD"),l=r("+1qS"),u=r("oveG"),d=r("2YyJ");function h(e){throw new l.a({facets:Object(a.__assign)({},n.i.pack({maxFileSize:e}))})}function p(e){return function(t){return i.Promise.isCanceled(e)?new o.a:e instanceof c.a?new l.a({facets:t((d=e,function(e){if(d.errorType===s.a.conflict||d.errorType===s.a.similarNameExists){if(!e(m()))return d.errorType===s.a.conflict?Object(a.__assign)({},n.e.pack({supportsRename:!1})):void 0;switch(d.errorType){case s.a.conflict:return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n.o.pack({})),n.b.pack(!0)),n.c.pack(!0));case s.a.similarNameExists:return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n.s.pack({})),n.b.pack(!0)),n.c.pack(!1))}}switch(d.errorType){case s.a.accessDenied:return Object(a.__assign)({},n.a.pack({}));case s.a.disconnected:return Object(a.__assign)({},n.p.pack({}));case s.a.emptyFileOrFolder:case s.a.emptyFileOrFolderForDocLib:return Object(a.__assign)({},n.f.pack({}));case s.a.folderUploadNotSupported:return Object(a.__assign)({},n.j.pack({}));case s.a.invalidName:return Object(a.__assign)({},n.k.pack({}));case s.a.lockMismatch:return Object(a.__assign)({},n.m.pack({}));case s.a.malwareDetected:return Object(a.__assign)({},n.n.pack({}));case s.a.overQuota:return Object(a.__assign)({},n.q.pack({}));case s.a.targetFolderMissing:return Object(a.__assign)({},n.t.pack({}));case s.a.throttled:return Object(a.__assign)({},n.u.pack({}));case s.a.versionMismatch:return Object(a.__assign)({},n.v.pack({}))}return Object(a.__assign)({},n.r.pack({}))})),innerError:e}):function(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}(e)?new l.a({facets:Object(a.__assign)(Object(a.__assign)({},"-2130575257"===e.code?Object(a.__assign)({},n.e.pack({supportsRename:t(m())})):Object(a.__assign)({},n.r.pack({}))),u.Gc.pack(e)),message:(r=e,r&&r.message&&("object"==typeof r.message?r.message.value:r.message.toString())||"")}):e;var r,d}}function m(){return function(e){var t=e(Object(d.a)({uploadNameCollisionExperiment:u.ld})).uploadNameCollisionExperiment;return!!t&&t.getVariantAndLogExposure()}}},f55A:function(e,t,r){"use strict";r.d(t,"d",function(){return a}),r.d(t,"b",function(){return i}),r.d(t,"c",function(){return n}),r.d(t,"a",function(){return s});var a="RequestAborted",i="NoConnection",n="Offline",s="MissingWebForDigestAuth"},q3PD:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var a=r("17wl"),i=r("sylB"),n=function(e){function t(t){var r=e.call(this,Object(a.__assign)(Object(a.__assign)({},t),{isExpected:s(t.errorType)}))||this;return r.message=t.message,r.errorType=t.errorType||i.a.other,r.maxSizeInBytes=t.maxSizeInBytes,r.allowRename=t.allowRename||!1,r.allowMerge=t.allowMerge||!1,r.supportsVersioning=t.supportsVersioning||!1,r.extraData=t.extraData,r.libraryName=t.libraryName,r.isFolder=t.isFolder,r.fixItUrl=t.fixItUrl,r}return Object(a.__extends)(t,e),t}(r("O/6m").a);function s(e){switch(e){case i.a.conflict:case i.a.similarNameExists:case i.a.emptyFileOrFolder:case i.a.emptyFileOrFolderForDocLib:case i.a.fileSize:case i.a.folderUploadNotSupported:case i.a.insufficientVaultQuota:case i.a.invalidName:case i.a.lockMismatch:case i.a.malwareDetected:case i.a.overQuota:case i.a.overQuotaSharedFolder:case i.a.pathTooLong:case i.a.targetFolderMissing:case i.a.throttled:case i.a.unlockRequired:case i.a.versionMismatch:return!0;case i.a.accessDenied:case i.a.itemNotFound:case i.a.disconnected:case i.a.authFailure:case i.a.general:return!1;case i.a.none:case i.a.other:return}}},sylB:function(e,t,r){"use strict";var a,i;r.d(t,"a",function(){return i}),function(e){e[e.queued=0]="queued",e[e.started=1]="started",e[e.completed=2]="completed",e[e.aborted=3]="aborted",e[e.failed=4]="failed",e[e.none=5]="none"}(a||(a={})),function(e){e[e.none=0]="none",e[e.other=1]="other",e[e.general=2]="general",e[e.conflict=3]="conflict",e[e.similarNameExists=4]="similarNameExists",e[e.invalidName=5]="invalidName",e[e.fileSize=6]="fileSize",e[e.emptyFileOrFolder=7]="emptyFileOrFolder",e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib",e[e.overQuota=9]="overQuota",e[e.accessDenied=10]="accessDenied",e[e.lockMismatch=11]="lockMismatch",e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder",e[e.folderUploadNotSupported=13]="folderUploadNotSupported",e[e.versionMismatch=14]="versionMismatch",e[e.authFailure=15]="authFailure",e[e.targetFolderMissing=16]="targetFolderMissing",e[e.itemNotFound=17]="itemNotFound",e[e.malwareDetected=18]="malwareDetected",e[e.throttled=19]="throttled",e[e.pathTooLong=20]="pathTooLong",e[e.disconnected=21]="disconnected",e[e.unlockRequired=22]="unlockRequired",e[e.insufficientVaultQuota=23]="insufficientVaultQuota"}(i||(i={}))},vLsd:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return n});var a=r("vHN8"),i=new a.a("entryBatch"),n=new a.a("sourceFile")}}]);