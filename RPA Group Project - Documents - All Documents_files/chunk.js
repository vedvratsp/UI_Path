(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0||[]).push([[7],{"52lI":function(e,t,r){"use strict";r.d(t,"a",function(){return Me});var n,o,i,a,s,c=r("17wl"),u=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),l=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(n||(n={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(o||(o={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(a||(a={})),function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(s||(s={}));var h,p=[s.SID,s.LOGIN_HINT],d={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},g=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return c.__extends(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t.createNoWindowObjectError=function(e){return new t("no_window_object","No window object available. Details: "+e)},t}(Error),f=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}(),m="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",y=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return c.__extends(t,e),t.createEndpointResolutionError=function(e){var r="Error: could not resolve endpoints. Please check network and try again.";return e&&!f.isEmpty(e)&&(r+=" Details: "+e),new t("endpoints_resolution_error",r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t("multiple_matching_tokens","Cache error for scope "+e+": The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority..")},t.createMultipleAuthoritiesInCacheError=function(e){return new t("multiple_authorities","Cache error for scope "+e+": Multiple authorities found in the cache. Pass authority in the API overload..")},t.createPopupWindowError=function(e){var r=m;return e&&!f.isEmpty(e)&&(r+=" Details: "+e),new t("popup_window_error",r)},t.createTokenRenewalTimeoutError=function(){return new t("token_renewal_error","Token renewal operation failed due to timeout.")},t.createInvalidIdTokenError=function(e){return new t("invalid_id_token","Invalid ID token format. Given token: "+e)},t.createInvalidStateError=function(e,r){return new t("invalid_state_error","Invalid state. "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t("nonce_mismatch_error","Nonce is not matching, Nonce received:  "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t("login_progress_error","Login_In_Progress: Error during login call - login is already in progress.")},t.createAcquireTokenInProgressError=function(){return new t("acquiretoken_progress_error","AcquireToken_In_Progress: Error during login call - login is already in progress.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createErrorInCallbackFunction=function(e){return new t("callback_error","Error occurred in token received callback function. "+e+".")},t.createUserLoginRequiredError=function(){return new t("user_login_error","User login is required. For silent calls, request must contain either sid or login_hint")},t.createUserDoesNotExistError=function(){return new t("user_non_existent","User object does not exist. Please call a login API.")},t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t("client_info_not_populated_error","The service did not populate client_info in the response, Please verify with the service team Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t("null_or_empty_id_token","The idToken is null or empty. Please review the trace to determine the root cause. Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t("id_token_parsing_error","ID token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t("token_encoding_error","The token to be decoded is not encoded correctly. Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t("invalid_interaction_type","The interaction type passed to the handler was incorrect or unknown")},t.createCacheParseError=function(e){return new t("cannot_parse_cache","invalid key: "+e+", The cached token key is not a valid JSON and cannot be parsed")},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t("block_token_requests","Token calls are blocked in hidden iframes")},t}(g),v={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},b={code:"authority_uri_insecure",desc:"Authority URIs must use https."},I={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},w="empty_request_error",T="Request object is required.",E="telemetry_config_error",S="Telemetry config is not configured with required values",C=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return c.__extends(t,e),t.createNoSetConfigurationError=function(){return new t("no_config_set","Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","The value for the cacheLocation is not supported. Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createInvalidCallbackObjectError=function(e){return new t("invalid_callback_object","The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics. Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t("empty_input_scopes_error","Scopes cannot be passed as empty array. Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t("nonarray_input_scopes_error","Scopes cannot be passed as non-array. Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t("scopes_required","Scopes are required to obtain an access token. Given value: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none' Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createEmptyRequestError=function(){return new t(w,T)},t.createInvalidCorrelationIdError=function(){return new t("invalid_guid_sent_as_correlationId","Please set the correlationId as a valid guid")},t.createKnownAuthoritiesNotSetError=function(){return new t("b2c_known_authorities_not_set","Must set known authorities when validateAuthority is set to True and using B2C")},t.createInvalidAuthorityTypeError=function(){return new t(v.code,v.desc)},t.createUntrustedAuthorityError=function(e){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false. Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(E,S+" mising values: "+Object.keys(r).reduce(function(t,n){return e[n]?t:t.concat([n+" ("+r[n]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t("sso_silent_error","request must contain either sid or login_hint")},t.createInvalidAuthorityMetadataError=function(){return new t("authority_metadata_error","Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.")},t}(y),k=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return r.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==r})},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw C.createScopesNonArrayError(e);if(e.length<1&&t)throw C.createEmptyScopesArrayError(e.toString())}else if(t)throw C.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(l.openidScope)>-1&&(r+=1),e.indexOf(l.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(l.openidScope)>-1,r=e.indexOf(l.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(l.openidScope)&&t.push(l.openidScope),-1===t.indexOf(l.profileScope)&&t.push(l.profileScope),t},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?l.oidcScopes:e},e}(),A=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=k.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(k.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),n=this.GetUrlComponents(r),o=n.PathSegments;return!t||0===o.length||o[0]!==l.common&&o[0]!==s.ORGANIZATIONS||(o[0]=t),this.constructAuthorityUriFromObject(n,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===l.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===s.ORGANIZATIONS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(f.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.ERROR_DESCRIPTION)||r.hasOwnProperty(n.ERROR)||r.hasOwnProperty(n.ACCESS_TOKEN)||r.hasOwnProperty(n.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return u.deserialize(r)},e.getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},e}(),_=function(e,t,r,n,o){this.authority=A.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=u.base64Encode(n)+"."+u.base64Encode(o)},R=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},O=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=u.createNewGuid(),this.scopes=o?o.slice():l.oidcScopes,this.scopes=k.trimScopes(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.4.0",this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var o=e.account;o.sid?(r=s.SID,n=o.sid):o.userName&&(r=s.LOGIN_HINT,n=o.userName)}else e.sid?(r=s.SID,n=e.sid):e.loginHint&&(r=s.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(l.upn)&&(r=s.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},e.prototype.addHintParameters=function(e,t){return e&&!t[s.SID]&&(!t[s.LOGIN_HINT]&&e.sid&&this.promptValue===d.NONE?t=this.addSSOParameter(s.SID,e.sid,t):!t[s.LOGIN_HINT]&&e.userName&&!f.isEmpty(e.userName)&&(t=this.addSSOParameter(s.LOGIN_HINT,e.userName,t))),t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case s.SID:r[s.SID]=t;break;case s.ID_TOKEN:case s.LOGIN_HINT:r[s.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach(function(n){n===l.domain_hint&&(t||e[s.SID])||(null==r?r=n+"="+encodeURIComponent(e[n]):r+="&"+n+"="+encodeURIComponent(e[n]))}),r},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e.determineResponseType=function(e,t){return k.onlyContainsOidcScopes(t)?"id_token":e?this.responseTypeForMatchingAccounts(t):"id_token token"},e.responseTypeForMatchingAccounts=function(e){return k.containsAnyOidcScopes(e)?"id_token token":"token"},e}(),P=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}var a={statusCode:i.status,body:t};r(a)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),N=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,r){return c.__awaiter(this,void 0,void 0,function(){var n,o,i;return c.__generator(this,function(a){return n=new P,o="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",i=t.createAndStartHttpEvent(r,"GET",o,"getAliases"),[2,n.sendRequestAsync(o,"GET",!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),e.body.metadata}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,r,n){return c.__awaiter(this,void 0,void 0,function(){var o;return c.__generator(this,function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,n)];case 1:return i.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),o=A.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(o)&&e.TrustedHostList.push(o.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(h||(h={}));var L,U=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=A.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===l.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?h.Adfs:h.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=A.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=A.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===h.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw v}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw b;if(!e.PathSegments||e.PathSegments.length<1)throw I},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new P,o=t.createAndStartHttpEvent(r,"GET",e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,"GET",!0).then(function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw o.serverErrorCode=e,t.stopEvent(o),e})},e.prototype.resolveEndpointsAsync=function(e,t){return c.__awaiter(this,void 0,void 0,function(){var r,n,o;return c.__generator(this,function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==N.getTrustedHostList().length?[3,2]:[4,N.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!N.IsInTrustedHostList(r))throw C.createUntrustedAuthorityError(r);i.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return o.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),q=function(){function e(t,r){if(!t||f.isEmpty(t))return this.uid="",void(this.utid="");try{var n=u.base64Decode(t),o=JSON.parse(n);o&&(o.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(o.uid,r):o.uid),o.hasOwnProperty("utid")&&(this.utid=o.utid))}catch(e){throw y.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var n={uid:t.subject,utid:""};return new e(u.base64Encode(JSON.stringify(n)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),o="";return f.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return u.base64Encode(e)},e}(),x=function(){function e(){}return e.decodeJwt=function(e){if(f.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=u.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},e}(),M=function(e){if(f.isEmpty(e))throw y.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=x.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw y.createIdTokenParsingError(e)}},H=function(e,t){this.key=e,this.value=t},D=function(){function e(e){if(!window)throw g.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null==window[e])throw C.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),j=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),F=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw C.createEmptyRequestError();var o,i;e&&(o=t?k.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,k.validateInputScope(o,!t,r),o=k.translateClientIdIfSingleScope(o,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return c.__assign({},e,{extraQueryParameters:i,scopes:o,state:a,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[d.LOGIN,d.SELECT_ACCOUNT,d.CONSENT,d.NONE].indexOf(e)<0)throw C.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=c.__assign({},e);return r?(t&&delete r[l.claims],p.forEach(function(e){r[e]&&delete r[e]}),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw C.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return f.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+l.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:u.createNewGuid(),ts:j.now(),method:e},r=JSON.stringify(t);return u.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(l.resourceDelimiter)[0];if(u.isGuid(t))return{id:t,ts:j.now(),method:l.interactionTypeRedirect};try{var r=u.base64Decode(t);return JSON.parse(r)}catch(t){throw y.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!u.isGuid(e))throw C.createInvalidCorrelationIdError();return u.isGuid(e)?e:u.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+l.resourceDelimiter+e.authority},e}(),K=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return c.__extends(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=l.cachePrefix+"."+i.IDTOKEN,o=l.cachePrefix+"."+i.CLIENT_INFO,s=l.cachePrefix+"."+a.ERROR,c=l.cachePrefix+"."+a.ERROR_DESC,u=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,c)];[i.IDTOKEN,i.CLIENT_INFO,a.ERROR,a.ERROR_DESC].forEach(function(e,n){return r.duplicateCacheEntry(e,u[n],t)})},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+l.cachePrefix)||0===e.indexOf(l.adalIdToken)?e:t?l.cachePrefix+"."+this.clientId+"."+e:l.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(l.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&F.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),a=window[this.cacheLocation];n&&!i&&Object.keys(a).forEach(function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))}),this.removeItem(o.INTERACTION_STATUS),this.removeItem(o.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,o){if(o.match(e)&&o.match(t)&&o.match(l.scopes)){var i=r.getItem(o);if(i)try{var a=JSON.parse(o),s=new H(a,JSON.parse(i));return n.concat([s])}catch(e){throw y.createCacheParseError(o)}}return n},[])},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(o.RENEW_STATUS,e));return!(!r||r!==l.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(o.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach(function(t){var r=t.trim().split("=")[0];r.indexOf(l.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)})},t.generateAcquireTokenAccountKey=function(e,t){var r=F.parseLibraryState(t).id;return""+o.ACQUIRE_TOKEN_ACCOUNT+l.resourceDelimiter+e+l.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(o.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=F.parseLibraryState(t).id;return""+e+l.resourceDelimiter+r},t}(D),G=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return f.isEmpty(i)||(n=f.isEmpty(a)?u.base64Encode(i):u.base64Encode(i)+"."+u.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),W=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+l.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,n,o){return new Promise(function(i,a){var s=j.relativeNowMs()+r;o.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(j.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+n),clearInterval(c),void a(y.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&A.urlContainsHash(e)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,r,n,o){return new Promise(function(i,a){var s=r/e.POLLING_INTERVAL_MS,c=0;o.verbose("monitorWindowForHash polling started");var u=setInterval(function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(u),void a(y.createUserCancelledError());var e;try{e=t.location.href}catch(e){}e&&"about:blank"!==e&&(c++,e&&A.urlContainsHash(e)?(o.verbose("monitorPopupForHash found url in hash"),clearInterval(u),i(t.location.hash)):c>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+n),clearInterval(u),a(y.createTokenRenewalTimeoutError())))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise(function(i,a){setTimeout(function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)},r)})},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(e){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(A.urlContainsHash(window.location.hash)&&e.isInIframe())throw y.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(o.REDIRECT_REQUEST);if(t&&!A.urlContainsHash(window.location.hash)){var r=t.split(l.resourceDelimiter);r.shift();var n=r.length>0?r.join(l.resourceDelimiter):null;e.resetTempCacheItems(n)}},e.POLLING_INTERVAL_MS=50,e}(),Q=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),c.__assign({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}(),J=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return c.__awaiter(this,void 0,void 0,function(){var n;return c.__generator(this,function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw C.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw C.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return f.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new U(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(L||(L={}));var V=function(){function e(e,t){void 0===t&&(t={}),this.level=L.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?L.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=f.isEmpty(this.correlationId)?o+":1.4.0-"+L[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-1.4.0-"+L[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(L.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(L.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(L.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(L.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(L.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(L.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(L.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(L.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),z={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return A.getCurrentUrl()},postLogoutRedirectUri:function(){return A.getCurrentUrl()},navigateToLoginRequestUrl:!0},B={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},X={logger:new V(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},Y={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},Z=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return c.__extends(t,e),t.createServerUnavailableError=function(){return new t("server_unavailable","Server is temporarily unavailable.")},t.createUnknownServerError=function(e){return new t("unknown_server_error",e)},t}(g),$="interaction_required",ee="consent_required",te="login_required",re=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return c.__extends(t,e),t.isInteractionRequiredError=function(e){return e&&[$,ee,te].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(te,e)},t.createInteractionRequiredAuthError=function(e){return new t($,e)},t.createConsentRequiredAuthError=function(e){return new t(ee,e)},t}(Z);function ne(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var oe,ie,ae,se=function(e){var t=A.GetUrlComponents(e);if(U.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},ce=function(e){return u.base64Encode(e)},ue=function(e){return"msal."+(e||"")},le=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},he=function(){function e(e,t,r){var n;this.eventId=u.createNewGuid(),this.label=r,this.event=((n={})[ue("event_name")]=e,n[ue("elapsed_time")]=-1,n["Microsoft.MSAL.correlation_id"]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[ue("elapsed_time")]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,le()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[ue("start_time")]=this.startTimestamp,e=this.perfStartMark,le()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[ue("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return c.__assign({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),pe=function(e){function t(t,r,n,o){var i=e.call(this,ue("default_event"),r,"DefaultEvent")||this;return i.event[ue("client_id")]=n,i.event[ue("sdk_plaform")]=t.sdk,i.event[ue("sdk_version")]=t.sdkVersion,i.event[ue("application_name")]=t.applicationName,i.event[ue("application_version")]=t.applicationVersion,i.event[ue("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event.Microsoft_MSAL_ui_event_count=i.getEventCount(ue("ui_event"),o),i.event.Microsoft_MSAL_http_event_count=i.getEventCount(ue("http_event"),o),i.event.Microsoft_MSAL_cache_event_count=i.getEventCount(ue("cache_event"),o),i}return c.__extends(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(he),de=ue("authority"),ge=ue("authority_type"),fe=ue("ui_behavior"),me=ue("tenant_id"),ye=ue("user_id"),ve=ue("was_successful"),be=ue("api_error_code"),Ie=ue("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(ie||(ie={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(ae||(ae={}));var we=((oe={})[ae.AcquireTokenSilent]=ie.AcquireTokenSilent,oe[ae.AcquireTokenPopup]=ie.AcquireTokenPopup,oe[ae.AcquireTokenRedirect]=ie.AcquireTokenRedirect,oe[ae.LoginPopup]=ie.LoginPopup,oe[ae.LoginRedirect]=ie.LoginRedirect,oe[ae.Logout]=ie.Logout,oe),Te=function(e){function t(t,r,n){var o=e.call(this,ue("api_event"),t,n)||this;return n&&(o.apiCode=we[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return c.__extends(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[de]=se(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[be]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[me]=this.piiEnabled&&e?ce(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[ye]=this.piiEnabled&&e?ce(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[ve]},set:function(e){this.event[ve]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Ie]=this.piiEnabled&&e?ce(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[ge]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[fe]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(he),Ee=ue("http_path"),Se=ue("user_agent"),Ce=ue("query_parameters"),ke=ue("api_version"),Ae=ue("response_code"),_e=ue("oauth_error_code"),Re=ue("http_method"),Oe=ue("request_id_header"),Pe=ue("spe_info"),Ne=ue("server_error_code"),Le=ue("server_sub_error_code"),Ue=ue("url"),qe=function(e){function t(t,r){return e.call(this,ue("http_event"),t,r)||this}return c.__extends(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=se(e);this.event[Ue]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Ee]=se(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Se]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Ce]=O.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[ke]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Ae]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[_e]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Re]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Oe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Pe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Ne]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Le]=e},enumerable:!0,configurable:!0}),t}(he),xe=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=c.__assign({sdk:l.libraryName,sdkVersion:"1.4.0",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new pe(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new Te(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new qe(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r},[])},e}(),Me=function(){function e(e){var t,r,n,o,i,a,s,u;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,o=void 0===(n=t.cache)?{}:n,a=void 0===(i=t.system)?{}:i,u=void 0===(s=t.framework)?{}:s,{auth:c.__assign({},z,r),cache:c.__assign({},B,o),system:c.__assign({},X,a),framework:c.__assign({},Y,u)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),N.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),J.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new K(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var h=window.location.hash,p=A.urlContainsHash(h);W.checkIfBackButtonIsPressed(this.cacheStorage),p&&this.getResponseState(h).method===l.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(h)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=J.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw C.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(l.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(l.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),A.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),e===l.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==l.interactionTypePopup)throw y.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(o.INTERACTION_STATUS),e===l.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==l.interactionTypePopup)throw y.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=F.validateRequest(e,!0,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=F.validateRequest(e,!1,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=F.validateRequest(e,!0,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,ae.LoginPopup);return new Promise(function(e,n){t.acquireTokenInteractive(l.interactionTypePopup,!0,r,e,n)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=F.validateRequest(e,!1,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,ae.AcquireTokenPopup);return new Promise(function(e,n){t.acquireTokenInteractive(l.interactionTypePopup,!1,r,e,n)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,r,n,i){var a=this;this.logger.verbose("AcquireTokenInteractive has been called"),W.blockReloadInHiddenIframes();var s,c=this.cacheStorage.getItem(o.INTERACTION_STATUS);if(e===l.interactionTypeRedirect&&this.cacheStorage.setItem(o.REDIRECT_REQUEST,""+l.inProgress+l.resourceDelimiter+r.state),c===l.inProgress){var u=t?y.createLoginInProgressError():y.createAcquireTokenInProgressError(),h=ne(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,u,h,i)}if(r&&r.account&&!t?(s=r.account,this.logger.verbose("Account set from request")):(s=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s||O.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(s,e,t,r,n,i);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),h=ne(this.getAccountState(r.state)),this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,y.createUserLoginRequiredError(),h,i);if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var p=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(p).then(function(t){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,t,n)},function(o){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+o),a.acquireTokenHelper(null,e,t,r,n,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,i)}},e.prototype.acquireTokenHelper=function(e,t,r,n,i,s){return c.__awaiter(this,void 0,void 0,function(){var u,h,p,d,g,f,v,b,I,w;return c.__generator(this,function(c){switch(c.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),this.cacheStorage.setItem(o.INTERACTION_STATUS,l.inProgress),u=n.scopes?n.scopes.join(" ").toLowerCase():l.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+u),p=n&&n.authority?J.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,c.label=1;case 1:return c.trys.push([1,11,,12]),p.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,J.saveMetadataFromNetwork(p,this.telemetryManager,n.correlationId)]);case 2:return c.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),c.label=4;case 4:if(g=r?"id_token":this.getTokenType(e,n.scopes),f=n.redirectStartPage||window.location.href,h=new O(p,this.clientId,g,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(h,e,r,f),this.logger.verbose("Updating cache entries"),h.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),v=A.createNavigateUrl(h)+l.response_mode_fragment,t===l.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,n.state),h.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+h.state));else{if(t!==l.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),y.createInvalidInteractionTypeError();window.renewStates.push(h.state),window.requestType=r?l.login:l.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+h.state),this.registerCallback(h.state,u,i,s)}if(t!==l.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{d=this.openPopup(v,"msal",l.popUpWidth,l.popUpHeight),W.trackPopup(d)}catch(e){if(this.logger.info("popup_window_error:"+m),this.cacheStorage.setItem(a.ERROR,"popup_window_error"),this.cacheStorage.setItem(a.ERROR_DESC,m),s)return s(y.createPopupWindowError()),[2]}if(!d)return[3,8];c.label=5;case 5:return c.trys.push([5,7,,8]),[4,W.monitorPopupForHash(d,this.config.system.loadFrameTimeout,v,this.logger)];case 6:return b=c.sent(),this.handleAuthenticationResponse(b),this.cacheStorage.removeItem(o.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",b),W.closePopups()),[3,8];case 7:return I=c.sent(),s&&s(I),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",I.errorCode+l.resourceDelimiter+I.errorMessage):(this.cacheStorage.removeItem(o.INTERACTION_STATUS),d.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(v)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(v)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(v)),c.label=10;case 10:return[3,12];case 11:return w=c.sent(),this.logger.error(w),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,y.createEndpointResolutionError(w.toString),ne(n.state),s),d&&d.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw C.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw C.createSsoSilentError();return this.acquireTokenSilent(c.__assign({},e,{scopes:l.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=F.validateRequest(e,!1,this.clientId,l.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,ae.AcquireTokenSilent),o=F.createRequestSignature(r);return new Promise(function(e,n){return c.__awaiter(t,void 0,void 0,function(){var t,i,a,s,u,h,p,d,g,m,v;return c.__generator(this,function(c){switch(c.label){case 0:if(W.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(l.adalIdToken),!i&&!r.sid&&!r.loginHint&&f.isEmpty(a))return this.logger.info("User login is required"),[2,n(y.createUserLoginRequiredError())];if(s=this.getTokenType(i,r.scopes),this.logger.verbose("Response type: "+s),u=new O(J.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,s,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),O.isSSOParam(r)||i?(u.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||f.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(h=x.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),u.populateQueryParams(i,null,h,!0)),!(p=r.claimsRequest||u.claimsValue)&&!r.forceRefresh)try{g=this.getCachedToken(u,i)}catch(e){d=e}return g?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(g.scopes)),e(g),[2,null]):[3,1];case 1:return d?(this.logger.infoPii(d.errorCode+":"+d.errorMessage),n(d),[2,null]):[3,2];case 2:m=p?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No token found in cache lookup",this.logger.verbose(m),u.authorityInstance||(u.authorityInstance=r.authority?J.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+u.authority),c.label=3;case 3:return c.trys.push([3,7,,8]),u.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,J.saveMetadataFromNetwork(u.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return c.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),c.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&k.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,u)):(this.logger.verbose("Renewing access token"),this.renewToken(o,e,n,i,u)),[3,8];case 7:return v=c.sent(),this.logger.error(v),n(y.createEndpointResolutionError(v.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,a=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-r/2+i,l=c/2-n/2+a,h=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+u+", scrollbars=yes");if(!h)throw y.createPopupWindowError();return h.focus&&h.focus(),h}catch(e){throw this.cacheStorage.removeItem(o.INTERACTION_STATUS),y.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return c.__awaiter(this,void 0,void 0,function(){var n,i,a,s,u;return c.__generator(this,function(c){switch(c.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.RENEW_STATUS,n),l.inProgress),this.config.system.navigateFrameWait?[4,W.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=c.sent(),[3,3];case 2:a=W.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=a,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,W.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(s=c.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw u=c.sent(),this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.RENEW_STATUS,n))===l.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,u),this.cacheStorage.removeItem(K.generateTemporaryCacheKey(o.RENEW_STATUS,n))),W.removeHiddenIframe(i),u;case 7:return W.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||f.isEmpty(e))throw this.logger.info("Navigate url is empty"),g.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),g.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return c.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i,a;return c.__generator(this,function(s){switch(s.label){case 0:t=e||u.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,ae.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,J.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=void 0,this.getPostLogoutRedirectUri()?(o="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(o="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+n+o,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+n+o,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),A.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var o,i;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{o=this.saveTokenFromHash(e,t)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(t.state);var a=this.getAccountState(t.state);if(o){if(t.requestType===l.renewToken||o.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+n.ACCESS_TOKEN),o.tokenType=n.ACCESS_TOKEN):t.requestType===l.login&&(this.logger.verbose("Response tokenType set to "+n.ID_TOKEN),o.tokenType=n.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=o)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=ne(a),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),r(o,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),y.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),W.closePopups()},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),window.location.hash="",this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=A.removeHashFromUrl(window.location.href),i=A.removeHashFromUrl(r);if(n!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var a=A.GetUrlComponents(r);a.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=a.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=A.deserializeHash(e);if(!r)throw g.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(n.STATE))throw g.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var i=F.parseLibraryState(r.state);if((t={requestType:l.unknown,state:r.state,timestamp:i.ts,method:i.method,stateMatch:!1}).state===this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=l.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=l.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var a=window.renewStates,s=0;s<a.length;s++)if(a[s]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=null,o=e.scopes,i=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(this.logger.verbose("Getting all cached access tokens"),0===i.length)return this.logger.verbose("No matching tokens found when filtered by clientId and account"),null;var a=[];if(!e.authority||A.isCommonAuthority(e.authority)||A.isOrganizationsAuthority(e.authority)){this.logger.verbose("No authority passed, filtering tokens by scope");for(var s=0;s<i.length;s++){var c=(p=i[s]).key.scopes.split(" ");k.containsScope(c,o)&&a.push(p)}if(1===a.length)this.logger.verbose("One matching token found, setting authorityInstance"),r=a[0],e.authorityInstance=J.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else if(a.length>1){if(!e.authority)throw y.createMultipleMatchingTokensInCacheError(o.toString());var u=A.GetUrlComponents(e.authority).HostNameAndPort,l=a.filter(function(e){return A.GetUrlComponents(e.key.authority).HostNameAndPort===u});if(1!==l.length){if(l.length>1)throw y.createMultipleMatchingTokensInCacheError(o.toString());return this.logger.verbose("No matching tokens found"),null}r=l[0],e.authorityInstance=J.CreateInstance(r.key.authority,this.config.auth.validateAuthority)}else{this.logger.verbose("No matching token found when filtering by scope");var h=this.getUniqueAuthority(i,"authority");if(h.length>1)throw y.createMultipleAuthoritiesInCacheError(o.toString());this.logger.verbose("Single authority used, setting authorityInstance"),e.authorityInstance=J.CreateInstance(h[0],this.config.auth.validateAuthority)}}else{for(this.logger.verbose("Authority passed, filtering by authority and scope"),s=0;s<i.length;s++){var p;c=(p=i[s]).key.scopes.split(" "),k.containsScope(c,o)&&A.CanonicalizeUri(p.key.authority)===e.authority&&a.push(p)}if(0===a.length)return this.logger.verbose("No matching tokens found"),null;if(1!==a.length)throw y.createMultipleMatchingTokensInCacheError(o.toString());this.logger.verbose("Single token found"),r=a[0]}if(null!=r){this.logger.verbose("Evaluating access token found");var d=Number(r.value.expiresIn),f=this.config.system.tokenRenewalOffsetSeconds||300;if(d&&d>j.now()+f){this.logger.verbose("Token expiration is within offset, renewing token");var m=new M(r.value.idToken);if(!t&&!(t=this.getAccount()))throw g.createUnexpectedError("Account should not be null here.");var v=this.getAccountState(e.state),b={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?n.ID_TOKEN:n.ACCESS_TOKEN,idToken:m,idTokenClaims:m.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*d),account:t,accountState:v,fromCache:!0};return Q.setResponseIdToken(b,m),this.logger.verbose("Response generated and token set"),b}return this.logger.verbose("Token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a[0].key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getUniqueAuthority=function(e,t){this.logger.verbose("GetUniqueAuthority has been called");var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(l.adalIdToken);return f.isEmpty(e)?null:x.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=W.generateFrameName("msalRenewFrame",e);W.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=A.urlRemoveQueryStringParameter(A.createNavigateUrl(o),l.prompt)+l.prompt_none+l.response_mode_fragment;window.renewStates.push(o.state),window.requestType=l.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=W.generateFrameName("msalIdTokenFrame",e);W.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=A.urlRemoveQueryStringParameter(A.createNavigateUrl(o),l.prompt)+l.prompt_none+l.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=l.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=l.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},e.prototype.saveAccessToken=function(e,t,r,o,i){var a;this.logger.verbose("SaveAccessToken has been called");var s,u=c.__assign({},e);if(r.hasOwnProperty(n.SCOPE)){this.logger.verbose("Response parameters contains scope");var h=(a=r[n.SCOPE]).split(" "),p=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var d=0;d<p.length;d++){var g=p[d];if(g.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var f=g.key.scopes.split(" ");k.isIntersectingScopes(f,h)&&this.cacheStorage.removeItem(JSON.stringify(g.key))}}var m=j.parseExpiresIn(r[n.EXPIRES_IN]);s=F.parseLibraryState(r[n.STATE]).ts+m;var y=new _(t,this.clientId,a,o.uid,o.utid),v=new R(r[n.ACCESS_TOKEN],i.rawIdToken,s.toString(),o.encodeClientInfo());this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),this.logger.verbose("Saving token to cache"),u.accessToken=r[n.ACCESS_TOKEN],u.scopes=h}else this.logger.verbose("Response parameters does not contain scope, clientId set as scope"),y=new _(t,this.clientId,a,o.uid,o.utid),s=Number(i.expiration),v=new R(r[n.ID_TOKEN],r[n.ID_TOKEN],s.toString(),o.encodeClientInfo()),this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),this.logger.verbose("Saving token to cache"),u.scopes=l.oidcScopes,u.accessToken=r[n.ID_TOKEN];return s?(this.logger.verbose("New expiration set"),u.expiresOn=new Date(1e3*s)):this.logger.error("Could not parse expiresIn parameter"),u},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,s={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},c=A.deserializeHash(e),u="",p="",d=null;if(c.hasOwnProperty(n.ERROR_DESCRIPTION)||c.hasOwnProperty(n.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+c[n.ERROR]+"; Error description: "+c[n.ERROR_DESCRIPTION]),this.cacheStorage.setItem(a.ERROR,c[n.ERROR]),this.cacheStorage.setItem(a.ERROR_DESC,c[n.ERROR_DESCRIPTION]),t.requestType===l.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(a.LOGIN_ERROR,c[n.ERROR_DESCRIPTION]+":"+c[n.ERROR]),u=K.generateAuthorityKey(t.state)),t.requestType===l.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),u=K.generateAuthorityKey(t.state);var m=this.getAccount(),v=void 0;m&&!f.isEmpty(m.homeAccountIdentifier)?(v=m.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(v=l.no_account,this.logger.verbose("AccountId is set as no_account")),p=K.generateAcquireTokenAccountKey(v,t.state)}var b=c[n.ERROR],I=c[n.ERROR_DESCRIPTION];r=re.isInteractionRequiredError(b)||re.isInteractionRequiredError(I)?new re(c[n.ERROR],c[n.ERROR_DESCRIPTION]):new Z(c[n.ERROR],c[n.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),c.hasOwnProperty(n.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.SESSION_STATE,t.state),c[n.SESSION_STATE])),s.accountState=this.getAccountState(t.state);var w=void 0;if(c.hasOwnProperty(n.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),s.accessToken=c[n.ACCESS_TOKEN],c.hasOwnProperty(n.SCOPE)&&(s.scopes=c[n.SCOPE].split(" ")),c.hasOwnProperty(n.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),d=new M(c[n.ID_TOKEN]),s.idToken=d,s.idTokenClaims=d.claims):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),d=new M(this.cacheStorage.getItem(i.IDTOKEN)),s=Q.setResponseIdToken(s,d));var T=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);this.logger.verbose("Got authority from cache"),c.hasOwnProperty(n.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),w=new q(c[n.CLIENT_INFO],T)):this.authorityInstance.AuthorityType===h.Adfs?w=q.createClientInfoFromIdToken(d,T):this.logger.warning("ClientInfo not received in the response from AAD"),s.account=G.createAccount(d,w),this.logger.verbose("Account object created from response");var E=void 0;s.account&&!f.isEmpty(s.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),E=s.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),E=l.no_account),p=K.generateAcquireTokenAccountKey(E,t.state);var S=K.generateAcquireTokenAccountKey(l.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var C=this.cacheStorage.getItem(p),k=void 0;f.isEmpty(C)?f.isEmpty(this.cacheStorage.getItem(S))||(this.logger.verbose("No acquireToken account retrieved from cache"),s=this.saveAccessToken(s,T,c,w,d)):(k=JSON.parse(C),this.logger.verbose("AcquireToken request account retrieved from cache"),s.account&&k&&G.compareAccounts(s.account,k)?(s=this.saveAccessToken(s,T,c,w,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(c.hasOwnProperty(n.ID_TOKEN))if(this.logger.info("Fragment has idToken"),d=new M(c[n.ID_TOKEN]),T=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d),s=Q.setResponseIdToken(s,d),c.hasOwnProperty(n.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),w=new q(c[n.CLIENT_INFO],T)):this.authorityInstance.AuthorityType===h.Adfs?w=q.createClientInfoFromIdToken(d,T):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=G.createAccount(d,w),s.account=this.account,this.logger.verbose("Account object created from response"),d&&d.nonce){this.logger.verbose("IdToken has nonce");var _=this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.NONCE_IDTOKEN,t.state),this.inCookie);d.nonce!==_?(this.account=null,this.cacheStorage.setItem(a.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+_+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+_+", Actual Nonce: "+d.nonce),r=y.createNonceMismatchError(_,d.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(i.IDTOKEN,c[n.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(i.CLIENT_INFO,w.encodeClientInfo(),this.inCookie),this.saveAccessToken(s,T,c,w,d))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),u=t.state,p=t.state,this.logger.error("Invalid id_token received in the response"),r=y.createInvalidIdTokenError(d),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage)}else{this.logger.verbose("State mismatch"),u=t.state,p=t.state;var R=this.cacheStorage.getItem(K.generateTemporaryCacheKey(o.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+R+", Actual State: "+t.state),r=y.createInvalidStateError(t.state,R),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(K.generateTemporaryCacheKey(o.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(u,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!s)throw g.createUnexpectedError("Response is null");return s},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=K.generateAuthorityKey(e),i=r.getItem(o,t);return f.isEmpty(i)?i:A.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(i.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(i.CLIENT_INFO,this.inCookie);if(!f.isEmpty(e)&&!f.isEmpty(t)){var r=new M(e),n=new q(t,"");return this.account=G.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=new M(t[r].value.idToken),o=new q(t[r].value.homeAccountIdentifier,""),i=G.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:J.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e),s=new O(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?A.getHostFromUri(e)===A.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===l.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(o.INTERACTION_STATUS,l.inProgress):this.cacheStorage.removeItem(o.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===l.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw C.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=G.compareAccounts(e,this.getAccount());return O.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):l.no_account,n=K.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=K.generateAuthorityKey(e);this.cacheStorage.setItem(r,A.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(K.generateTemporaryCacheKey(o.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return f.isEmpty(e.homeAccountIdentifier)?l.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:l.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return xe.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw C.createTelemetryConfigError(e);return new xe({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}()}}]);