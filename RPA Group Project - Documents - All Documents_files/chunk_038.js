(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[5],{"7jI3":function(e,t,r){"use strict";function n(){return""}r.d(t,"b",function(){return c}),r.d(t,"a",function(){return a});var o={register:n,unregister:n,dispatch:n},i=["register","unregister","dispatch"];function c(e){if(!e)throw new Error("Dispatcher argument must be a dispatcher instance.");if(!i.every(function(t){return"function"==typeof e[t]}))throw new Error("Dispatcher argument must implement dispatcher interface.");o={register:e.register.bind(e),unregister:e.unregister.bind(e),dispatch:function(t){var r=t.dispatchTime;t.dispatchTime="number"==typeof r?r:function(){try{return Math.round(performance.now())}catch(e){return 0}}(),e.dispatch(t)}}}function a(){return o}},RZul:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("tMv9"),o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e){return new Promise(function(t,r){var i=new XMLHttpRequest;i.requestLogData=o({},e.requestLogData),i.open(e.method,e.url,!0),e.timeoutMs&&(i.timeout=e.timeoutMs),e.withCredentials&&(i.withCredentials=e.withCredentials);var c=e.headers||{};Object.keys(c).map(function(e){i.setRequestHeader(e,c[e])}),i.onload=function(){4===i.readyState&&(Object(n.a)(i.status)?t(i):r(i))},i.onerror=function(){r(i)},i.ontimeout=function(){r(i)};var a=e.body||null;i.send(a)})}},g4n3:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"d",function(){return c}),r.d(t,"c",function(){return a}),r.d(t,"a",function(){return s});var n,o=r("wuCr");function i(e){n&&c("Can not set initial state more than once.")||(e.cache.participants.push(o.a),n=e)}function c(e){throw new Error(e)}var a=u("puid"),s=u("cache");function u(e){return function(){return n&&n[e]||c("Trying to get "+e+" before it is set.")}}},mqVB:function(e,t,r){"use strict";t.__esModule=!0;var n=r("yeHm"),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||n(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||n(!1);for(var t=0;t<e.length;t++){var r=e[t];this._isPending[r]?this._isHandled[r]||n(!1):(this._callbacks[r]||n(!1),this._invokeCallback(r))}},e.prototype.dispatch=function(e){this._isDispatching&&n(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=o},sPtD:function(e,t,r){"use strict";r.r(t),r.d(t,"createAsyncTokenProvider",function(){return n.a}),r.d(t,"fetch",function(){return o.a}),r.d(t,"fetchAcquireToken",function(){return D}),r.d(t,"fetchAndParseSearchConfiguration",function(){return ge}),r.d(t,"fetchCustomVerticals",function(){return fe}),r.d(t,"fetcher",function(){return Z}),r.d(t,"fetchBingConsumer",function(){return be}),r.d(t,"fetchFileShareConnectorSettings",function(){return we}),r.d(t,"fetchHubSites",function(){return xe}),r.d(t,"fetchPersonalData",function(){return je}),r.d(t,"fetchPersonalRankingContext",function(){return ke}),r.d(t,"fetchSearchCenterUrl",function(){return Ae}),r.d(t,"fetchRawSearchCenterUrl",function(){return Ee}),r.d(t,"fetchSearchConfiguration",function(){return le}),r.d(t,"fetchParsedCustomVerticals",function(){return ve}),r.d(t,"fetchSearchConfigurationFromEcs",function(){return _e}),r.d(t,"fetchConfigFromEcsWithCacheAndMonitor",function(){return Me}),r.d(t,"fetchSpHomeNews",function(){return Ge}),r.d(t,"fetchSpHomePrefetch",function(){return Fe}),r.d(t,"fetchSiteNewsSuggestions",function(){return Be}),r.d(t,"fetchSiteActivities",function(){return ze}),r.d(t,"siteActivitiesCacheKeyExtractor",function(){return Ke}),r.d(t,"fetchSharePointDigest",function(){return We}),r.d(t,"fetchSharePointDigestV2",function(){return $e}),r.d(t,"fetchSitesFromSubstrate",function(){return dt}),r.d(t,"generateGuid",function(){return Ze.a}),r.d(t,"cache",function(){return s.a}),r.d(t,"init",function(){return s.b}),r.d(t,"puid",function(){return s.c}),r.d(t,"statusOk",function(){return Ye.a}),r.d(t,"substrateIframeProxy",function(){return st}),r.d(t,"toTokenDetail",function(){return mt}),r.d(t,"warmupMsb",function(){return yt}),r.d(t,"resolveLokiEnvironment",function(){return bt}),r.d(t,"resolveSubstrateUrl",function(){return Ot}),r.d(t,"warmupSubstrateSearch",function(){return wt}),r.d(t,"withBasicMonitor",function(){return x}),r.d(t,"withMonitor",function(){return k}),r.d(t,"withImportMonitor",function(){return It}),r.d(t,"withPeriodicRefresh",function(){return jt}),r.d(t,"withRefresh",function(){return Pt});var n=r("rNmA"),o=r("RZul");function i(e){if(!c(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),r=t.length,n=[],o=0;o<r;o++){var i=t[o],a=e[i];void 0===a||c(a)||"function"==typeof a||n.push(i+":"+a)}return n.join(",")}function c(e){return"object"==typeof e&&null!==e}var a,s=r("g4n3"),u=r("7jI3"),f=!1,p=!1;function l(e,t,r){var n;m(r);var o=h();try{var i=o.getItem(e);if(!i)return null;n=JSON.parse(i)}catch(e){return!f&&Object(u.a)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),f=!0,null}return n?n.cacheVersion!==t?(o.removeItem(e),null):n.puid&&n.puid===r?n:(o.removeItem(e),null):null}var h=function(){return a||(a={getItem:function(e){return sessionStorage.getItem(d(e))},removeItem:function(e){return sessionStorage.removeItem(d(e))},setItem:function(e,t){return sessionStorage.setItem(d(e),t)}})};function d(e){return"mssearchux-cache-"+e}function m(e){!e&&Object(s.d)("Puid not set.")}var v=function(){return(v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g=function(e,t,r){m(r);var n=y(e);return n&&n.puid!==r&&(n=null),n||b(e,{puid:r,cacheItems:O(e,t,r)||{}})},y=function(e){return Object(s.a)().caches[e]},b=function(e,t){return Object(s.a)().caches[e]=t};function O(e,t,r){var n=l(e,t,r);if(!n)return null;var o=n.cacheItems;return Object.keys(o).reduce(function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:o[t].value,status:o[t].status||0}}),expiryTime:o[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e},{})}function S(e,t){return Object(s.a)().caches[e]?Object(s.a)().caches[e].cacheItems[t]=null:null}var w=function(e,t,r){return e[t]=r};function I(e){return function(t){return function(r){var n=t.cacheKeyExtractor(r)||{};return!(t.forceRefresh&&t.forceRefresh())&&function(e,t,r,n){void 0===n&&(n={});var o=i(n),c=g(e,t,r).cacheItems[o];if(c){if(Date.now()<c.expiryTime)return c.value.then(function(e){return v(v({},e),{cacheItemType:c.cacheItemType,cacheItemResolved:c.cacheItemResolved,expiryTime:c.expiryTime})});S(e,o)}return null}(t.cacheId,t.cacheVersion,Object(s.c)(),n)||function(e,t,r,n){var o=e.cacheId,c=e.cacheVersion,a=e.cacheItemLifetime;void 0===n&&(n={}),m(t);var s=i(n),f=g(o,c,t).cacheItems,d=w(f,s,{value:r,expiryTime:Date.now()+a,cacheItemType:"memory",cacheItemResolved:!1});return r.then(function(e){return w(f,s,v(v({},d),{cacheItemResolved:!0})),function(e,t,r,n,o,i,c){m(r);var a=l(e,t,r)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:r,cacheItems:{}};a.cacheItems[n]={value:o,expiryTime:i,status:c};try{h().setItem(e,JSON.stringify(a))}catch(t){!p&&Object(u.a)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),p=!0}}(o,c,t,s,e.xhr.responseText,d.expiryTime,e.xhr.status),v(v({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:d.expiryTime})},function(e){throw S(o,s),e})}(t,Object(s.c)(),e(r),n)}}}function x(e,t){var r=e.monitorType,n=e.monitorName,o=e.monitorOnce,i=e.successPropExtractor,c=e.failurePropExtractor,a=!1;return function(e){if(o&&a)return t(e);a=!0;var s,f=Math.round(performance.now()),p=Object(u.a)();function l(e,t){p.dispatch({eventType:"QOSSTOP",name:r,result:e,nameDetail:n,startTimestamp:f,totalTime:Math.round(performance.now())-f,properties:t})}p.dispatch({eventType:"QOSSTART",name:r,nameDetail:n,timestamp:f});try{s=t(e)}catch(e){return l("FAILURE",{promiseFactoryFailed:!0}),Promise.reject(e)}return s.then(function(e){return l("SUCCESS",P(e,i,{successExtractorFailed:!0})),e},function(e){return l("FAILURE",P(e,c,{failureExtractorFailed:!0})),Promise.reject(e)})}}var P=function(e,t,r){try{return(t||j)(e)}catch(e){return r}},j=function(){return{}},C=function(){return(C=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function k(e,t){var r=e.monitorName,n=e.monitorType,o=void 0===n?"prefetch_request":n,i=e.additionalSuccessPropsExtractor,c=e.additionalFailurePropsExtractor;return x({monitorName:r,monitorType:o,successPropExtractor:function(e){var t=e.xhr,r=e.tokenAttemptCount,n=e.tokenFetchDuration,o=e.cacheItemResolved,c=e.cacheItemType;return C(C(C(C({},T(t)),r?{tokenAttemptCount:r,tokenFetchDuration:Math.round(n)}:{}),{cacheItemResolved:o,cacheItemType:c}),null==i?void 0:i(t))},failurePropExtractor:function(e){var t;return C(C(C({},null==c?void 0:c(e)),T(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},function(e){return void 0===e?Promise.reject("undefined options"):t(e)})}function T(e){if(!e||!e.getAllResponseHeaders)return{};var t=function(e,t){var r={};if(e.getAllResponseHeaders){var n=e.getAllResponseHeaders();["sprequestduration","spclientservicerequestduration","sprequestguid"].forEach(function(t){e.getResponseHeader&&-1!==n.indexOf(t)&&(r[t]=e.getResponseHeader(t)||"")})}return r}(e),r={};return r.sprequestguid=t.sprequestguid,r.sprequestduration=t.sprequestduration||t.spclientservicerequestduration||void 0,r}var E=function(){return(E=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},R=["https://substrate.office.com","https://loki.delve.office.com","https://www.bing.com","https://outlook.office365.com/search"],D=k({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return E({},t&&{resource:A(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t;return(null===(t=null==e?void 0:e.requestLogData)||void 0===t?void 0:t.resource)?{resource:e.requestLogData.resource}:{}}},I(function(e){var t=e.digest,r=e.portalUrl,n=e.resourceUrl,i={resource:n};return e.useSTI&&(i.tokenType="STI"),Object(o.a)(E({url:r+"/_api/SP.OAuth.Token/Acquire",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(i),timeoutMs:7e3},A(n)&&{requestLogData:{resource:n}})).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}})})({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}})),A=function(e){return-1!==R.indexOf(e)};function _(e){var t=window&&window.location&&window.location.search||window.location.hash||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function M(e,t){var r=e,n=Object.keys(t);return n.length&&(r+="?",r+=n.map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")),r}function L(e,t){return t}function N(e,t,r){var n;return t&&t.safeToLog?(n=new Error(e+" "+t.message)).innerError=t:n=new Error(e),n.safeToLog=!0,n.logProperties=r,Object.freeze(n),n}function F(e,t,r){throw N(e,t,r)}var G=function(){return(G=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},H=function(e){var t=e.complianceEnvironment,r=e.clientWorkload,n=e.userId,o=e.tenantId,i=e.ring;return"https://"+function(e){switch(e){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"AG08":return"config.ecs.teams.eaglex.ic.gov";case"AG09":return"config.ecs.teams.microsoft.scloud";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return"ecs.office.com";default:return L(0,"ecs.office.com")}}(t)+"/config/v1/LokiService/1.0.0.0?agents=MicrosoftSearch&ecsserviceinformation=true&ClientWorkload="+r+"&id="+n+"&TenantID="+o+"&ring="+i};function q(e){var t,r={};if(e){var n=JSON.parse(e);if(n.ecsConfigIds&&n.ecsEtag){r.ecsConfigIds=((t=n.ecsConfigIds)?t.filter(function(e){return e.indexOf("31828")>-1}).join()||t.join():void 0)||"",r.ecsEtag=n.ecsEtag.replace(/"/g,"");var o={},i="searchux.".length;n.ecsSettings&&Object.keys(n.ecsSettings).filter(function(e){return"boolean"==typeof n.ecsSettings[e]&&"searchux."===e.substr(0,i)}).forEach(function(e){return o[e.substr(i)]=n.ecsSettings[e]}),r.ecsSettings=JSON.stringify(o)}}return r}function U(e,t,r){return Object.keys(e).filter(function(r){return r.indexOf(t)>-1&&e[r]}).sort(function(t,r){return J(e[t])-J(e[r])}).map(function(t){try{return r(t,e[t])}catch(e){Object(u.a)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}}).filter(function(e){return e})}function V(e){return U(e,"providers.",function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]})}function B(e,t,r){var n=_(t);n&&"true"===n.toLowerCase()&&(r={});var o=decodeURIComponent(_(e));return o?function e(t,r){if(!K(t))return t;var n=G({},t);return K(r)&&Object.keys(r).forEach(function(o){K(r[o])?n[o]=o in t?e(t[o],r[o]):r[o]:n[o]=r[o]}),n}(r,JSON.parse(o)):r}function J(e){return void 0===e.position||null===e.position?Number.MAX_VALUE:e.position}function K(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}var z,W,X=function(){return(X=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Q(e){return!!e&&(401===e.status||0===e.status)}function $(e,t,r,n){if(!r.token&&!r.tokenProvider)return Promise.reject(new Error("Token or token provider must be specified."));var o=-1;return r.token?n(X(X({},r),{token:r.token})).then(function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}}):r.tokenProvider({attempt:e}).then(function(e){return o=performance.now()-t,n(X(X({},r),{token:e}))}).then(function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:o,xhr:t}})}function Z(e,t){return k(t,I((r=e,function(e){var t=performance.now();return $(0,t,e,r).catch(function(n){return Q(n)?$(1,t,e,r).catch(function(e){return function(e,t,r){if(Q(e)){var n=e;throw n.tokenAttemptCount=2,n.tokenFetchDuration=r,n}throw e}(e,0,performance.now()-t)}):Promise.reject(n)})}))(t));var r}function Y(e){switch(e){case"Df":return z.Dogfood;case"Msit":return z.MSIT;case"Blackforest":return z.Blackforest;case"GccModerate":return z.GccModerate;case"GccHigh":return z.GccHigh;case"DoD":return z.DOD;case"Gallatin":return z.Gallatin;case"Prod":return z.TopLevel;case"AG08":return z.AG08;case"AG09":return z.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(z||(z={})),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(W||(W={}));var ee=r("wuCr"),te=function(){return(te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function re(e){return"string"==typeof e?e.replace(/\/+$/,""):e}var ne=function(e){return re(e)+"/api/v1/search/configuration"};function oe(e,t,r){return void 0===t&&(t=""),function(e,t){var r=Y(e);return r===e&&(r=Y("Prod")),t(r)}(e,r)+(t?"/"+t:"")}function ie(e,t){return void 0===t&&(t=""),oe(e,t,ne)}function ce(e,t,r){var n;return te(te(te({},t),((n={"X-MSSearchVersion":ee.a,"X-ClientFeature":"Search"})["X-ClientType"]=e,n)),r?{Authorization:"Bearer "+r}:{})}function ae(e,t){void 0===t&&(t=!1);var r={};return e&&(r.siteCollectionId=e.toUpperCase()),t&&(r.verticalState="all"),_("ecsOverrides")&&(r.ecsOverrides=_("ecsOverrides")),r}function se(){var e;return"true"===_("cacheClear")?((e={})[W.VerticalsCacheClear]="uncached",e):{}}var ue,fe=Z(function(e){var t,r=e.lokiUrl,n=e.token,i=e.clientType,c=e.scope,a=e.previewDisabledVerticals,s=ce(i,se(),n),u=c&&c.siteId?c.siteId:"";return Object(o.a)({url:M((t=r,(re(t)||"")+"/api/v1/search/configuration/verticals"),ae(u,a)),method:"GET",headers:s})},{monitorName:"customVerticals",cacheId:"customVerticals",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.lokiUrl,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(){return{cacheClear:_("cacheClear")}},forceRefresh:function(){return"true"===_("cacheClear")}}),pe=function(){return(pe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},le=Z(function(e){var t=e.token,r=e.clientType,n=e.environment,i=e.culture,c=e.additionalHeaders,a=e.siteId,s=void 0===a?"":a,u=ce(r,pe(pe({},c),se()),t);return Object(o.a)({url:M(ie(n,i),ae(s,!1)),method:"GET",headers:u})},{monitorName:"searchConfiguration",cacheId:"searchConfiguration",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]),r=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return pe(pe({},t),{msSearchScenario:r})},additionalSuccessPropsExtractor:function(e){return pe(pe({},q(e.responseText)),{cacheClear:_("cacheClear")})},forceRefresh:function(){return"true"===_("cacheClear")}}),he=function(){return(he=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function de(){return ue||me(),ue}function me(e){if(!ue||!ue.isPending||ue.isRejected){ue={};var t=new Promise(function(e,t){ue.promiseResolver=function(t){ue.isPending=!1,e(t)},ue.promiseRejector=function(){ue.isRejected=!0,ue.isPending=!1,t()}});ue.promiseObj=t,ue.isRejected=!1,t.catch(function(){})}ue.isPending=!0,e&&(ue.option=e)}function ve(e){var t,r,n,o=ue&&ue.option&&ue.option.siteId||"";if(ue&&(!e.scope&&!o||(null===(r=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===r?void 0:r.toUpperCase())===o.toUpperCase())&&!ue.isRejected){var i=ue.option;return me(i),le(i).then(function(e){var t,r,n=e.xhr;if(n.responseText){var o=JSON.parse(n.responseText).verticalConfig;null===(t=ue.promiseResolver)||void 0===t||t.call(ue,o)}else null===(r=ue.promiseRejector)||void 0===r||r.call(ue)}).catch(function(e){var t;console.error(e),null===(t=ue.promiseRejector)||void 0===t||t.call(ue,e),F("CUSTOM_VERTICAL_FETCH_FAILED")}),ue.promiseObj}var c=e.lokiUrl,a=null===(n=null==ue?void 0:ue.option)||void 0===n?void 0:n.environment;return("Df"===a||"Msit"===a&&-1!==(null==c?void 0:c.toLowerCase().indexOf("df")))&&(c=oe(a,ue.option.culture,function(e){return e})),fe(he(he({},e),{lokiUrl:c})).then(function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]}).catch(function(e){console.error(e),F("CUSTOM_VERTICAL_FETCH_FAILED")})}function ge(e){var t,r;_("sid")&&(e.siteId=_("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var n=null===(r=null===(t=e.additionalHeaders)||void 0===t?void 0:t[W.SearchComponent])||void 0===r?void 0:r.toLowerCase();return"serp"===n&&me(e),le(e).then(function(e){var t=e.xhr,r=JSON.parse(t.responseText),o=null==r?void 0:r.ecsSettings;r.ecsSettings=B("ecsOverrides","wipeEcsConfig",o);var i=de();return"serp"===n&&(r.verticalConfig?(null==i?void 0:i.promiseResolver)&&i.promiseResolver(r.verticalConfig):(null==i?void 0:i.promiseRejector)&&i.promiseRejector()),r}).catch(function(){var e,t=null===(e=de())||void 0===e?void 0:e.promiseRejector;t&&t()})}var ye,be=function(e){return k({monitorName:"bing-consumer-prefetch"},I(function(e){var t=e.url;return Object(o.a)({url:t,method:"GET",withCredentials:!0}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)},Oe=function(){return(Oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Se=["AllVerticalContent","FilesVerticalContent"],we=Z(function(e){var t=e.endpoint,r=e.token;return Object(o.a)({url:t+"/_api/web/AllProperties?$select="+Se.join(","),method:"GET",headers:Oe({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),Ie=function(){return(Ie=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},xe=Z(function(e){var t=e.clientId,r=e.endpoint,n=e.token;return Object(o.a)({url:r+"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='"+t+"'&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:Ie({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{}),timeoutMs:5e3})},{monitorName:"prefetchSpoHubSitesInfo",cacheId:"spohubsitesinfo",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),Pe=function(){return(Pe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},je=Z(function(e){var t=e.url,r=e.token;return Object(o.a)({url:t,method:"GET",headers:Pe({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"fetchPersonalAccountName",cacheId:"personalaccountname",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),Ce=function(){return(Ce=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ke=Z(function(e){var t=e.endpoint,r=e.clientId,n=e.token;return Object(o.a)({url:t+"?querytext='*'&ClientType='"+r+"'&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:Ce({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{}),timeoutMs:7e3})},{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),Te=function(){return(Te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Ee(e){var t=e.siteRoot,r=e.tokenProvider;return De({siteRoot:t,tokenProvider:r}).then(function(e){if(e.cacheItemResolved&&ye)return ye;var t=JSON.parse(e.xhr.responseText),r=t&&t.d&&t.d.searchcenterurl||"";return ye=r,r})}var Re,De=Z(function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then(function(e){return Object(o.a)({url:t+"/_api/search/searchcenterurl",method:"GET",headers:Te({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer "+e}:{}),timeoutMs:5e3})})},{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),Ae=function(e){return Ee({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then(function(e){return(r=(t=e).lastIndexOf("/search/"))<0?"":t.substring(0,r+"/search/".length).replace(/\/$/,"");var t,r})},_e=function(e){if(!e)throw new Error("missing options for ECS call");return Object(o.a)({url:H(e),method:"GET"})},Me=x({monitorName:"searchConfigurationFromEcs",monitorType:"prefetch_request",successPropExtractor:function(e){return q(function(e){var t,r;if(!e)return"";try{var n=JSON.parse(e),o=function(e){if(!e["searchux.useNewEcsSchema"])return e;var t=U(e,"searchBoxPluginConfiguration.",function(e){return{id:"searchux.searchBoxPlugin."+e.split(".")[1]}}),r=function(e){return U(e,"suggestionProviderGroups.",function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:V(t)}})}(e);return G(G(G({},e),{searchBoxPluginConfiguration:{plugins:t}}),{searchBoxSuggestionProviderConfiguration:{groups:r,streamPolicy:e["searchux.suggestionGroupStreamPolicy"]}})}(B("ecsSbOverrides","wipeSbEcsConfig",null==n?void 0:n.MicrosoftSearch)),i=null===(t=null==n?void 0:n.Headers)||void 0===t?void 0:t.ETag,c=[null===(r=null==n?void 0:n.ConfigIDs)||void 0===r?void 0:r.MicrosoftSearch];return JSON.stringify({ecsSettings:o,ecsConfigIds:c,ecsEtag:i})}catch(e){F("Failed to parse ECS config")}}(null==e?void 0:e.xhr.responseText))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},I(function(e){return _e(e).then(function(e){return{xhr:e}})})({cacheId:"searchConfigurationFromEcs",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,[])}})),Le=function(){return(Le=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ne=(Re=function(e){var t=e.clientId,r=e.token,n=e.fetcher,i=(0,e.requestDataProvider)(),c=i.endpoint,a=i.context,s=i.microserviceFlights,u={url:c,method:"GET",headers:Le(Le({Accept:"application/json;odata=verbose","SPHome-ClientType":t,"SPHome-ApiContext":JSON.stringify(a)},r?{Authorization:"Bearer "+r}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")})};return n?n(c,u).then(function(e){return e.json()}).then(function(e){return{responseText:JSON.stringify(e)}}):Object(o.a)(u)},function(e){return Z(Re,{monitorName:e,cacheId:e,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(){return{}}})}),Fe=Ne("sphome-rawsprefetch"),Ge=Ne("sphome-rawnews"),He=function(){return(He=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function qe(e,t,r){return r.sitePath+"/_api/search/query?QueryText='*'"+function(e){var t=e.departmentId;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2 AND "+(e.isHubSite&&t?Ve:Ue)(e)+"'"}(r)+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100&Properties='ClientFunction:News,EnableMultiGeoSearch:"+(e?"true":"false")+"'&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'&ClientType='"+t+"'&EnableQueryRules=false"}function Ue(e){return'Path:"'+e.sitePath+'"'}function Ve(e){var t=e.departmentId;return"(DepartmentId:"+t+" OR DepartmentId:"+t.replace(/[{}]/g,"")+")"}var Be=Z(function(e){var t=e.clientId,r=e.site,n=e.token;return Object(o.a)({url:qe(!0,t,r),method:"GET",headers:He({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{})})},{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),Je=function(){return(Je=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Ke(e){return{scope:e&&e.map(function(e){return e&&e.siteId&&e.siteId.toLowerCase()}).join(",")||""}}var ze=Z(function(e){var t=e.clientId,r=e.token,n=e.requestDataProvider,i=e.sites,c=n(),a=c.endpoint,s=c.microserviceFlights,u={url:a,method:"POST",headers:Je(Je({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":t},r?{Authorization:"Bearer "+r}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")}),body:JSON.stringify(i.slice(0,30).map(function(e){return{IndexId:e.id,SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"}}))};return Object(o.a)(u)},{monitorName:"site-activities-rawsprefetch",cacheId:"site-activities-rawsprefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return Ke(e.sites.slice(0,30))}}),We=function(e){var t=e.endpoint,r=e.forceDigestRefresh;return k({monitorName:"prefetchSharepointDigest"},I(function(e){var t=e.endpoint;return Object(o.a)({url:t+"/_api/contextinfo",method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint+"/_api/contextinfo"}},forceRefresh:r}))({endpoint:t,forceDigestRefresh:r})},Xe=function(){return(Xe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Qe=!1,$e=Z(function(e){var t=e.endpoint,r=e.token,n=e.overrideDigest;return n&&!Qe?(Qe=!0,new Promise(function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:n}}})})})):Object(o.a)({url:t+"/_api/contextinfo",method:"POST",headers:Xe({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},r?{Authorization:"Bearer "+r}:{}),timeoutMs:5e3})},{monitorName:"fetchSharepointDigest",cacheId:"fetchSharepointDigest",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),Ze=r("88VM"),Ye=r("tMv9"),et=function(e,t,r,n){return new Promise(function(o,i){return tt(function c(a){if(a.source===e&&a.origin===t){var s=void 0,u=!1;try{s=r(a)}catch(e){return rt(c),void i(N("Iframe message parser failure.",e))}try{u=n(s,a)}catch(e){return rt(c),void i(N("Iframe message predicate failure.",e))}u&&(rt(c),o(s))}})})},tt=function(e){return addEventListener("message",e,!1)},rt=function(e){return removeEventListener("message",e,!1)};function nt(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://"+e}var ot=function(){return(ot=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},it={},ct={},at={};function st(e){return void 0===e&&(e="https://substrate.office.com"),e=nt(e),void 0===ct[e]&&(ct[e]=ut(e).ready),ct[e].then(function(){return at[e]=!0,function(t){return pt(t,e)}})}function ut(e){return it[e]?it[e]:function(e,t,r){if(e){var n=document.getElementById("ms-searchux-3s-proxy"),o=function(e,t){return e&&e.src===t&&e.ready&&e.postMessage?{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}}:null}(n,t);it[r]=o||ft(!n,t,r)}else it[r]=ft(!1,t,r);return it[r]}((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function ft(e,t,r){var n=function(e,t){var r=document.createElement("iframe");return{iframe:r,initialize:function(){return document.body.contains(r)||(r.src=e,r.style.display="none",document.body.appendChild(r)),r},postMessage:function(n,o,i){var c=function(e,n){return et(r.contentWindow,t,e,n)}(o,i);return r.contentWindow&&r.contentWindow.postMessage(n,e),c}}}(t,r),o=n.initialize(),i=et(o.contentWindow,r,function(e){return e.data},function(e){return"loaded"===e});return e&&(o.id="ms-searchux-3s-proxy",o.postMessage=n.postMessage,o.ready=i),ot(ot({},n),{ready:i})}function pt(e,t){var r=Object(Ze.a)(),n=e.action,o=e.token,i=e.prefix,c=e.cvid,a=e.additionalInfo,s=e.headers;return ut(t).postMessage(JSON.stringify({requestId:r,action:n,token:o,prefix:i,cvid:c,additionalInfo:a,headers:s}),lt,function(e){return e.requestId===r})}function lt(e){try{return JSON.parse(e.data)}catch(e){return F("Failed to parse substrate API JSON response.")}}var ht=function(){return(ht=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},dt=Z(function(e){var t=e.token,r=e.prefix;return st(e.substrateUrl).then(function(e){return e({action:"queryv2",token:t,prefix:r,cvid:Object(Ze.a)()}).then(function(e){if(!Object(Ye.a)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}})})},{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]);return ht({},t)}});function mt(e){var t,r=Number.MAX_VALUE,n=e&&e.split(".");if(n&&3===n.length){var o=JSON.parse(function(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n=0,o=0,i="",c=-1;++c<t;)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(c)),o=n%4?64*o+r:r,n++%4&&(i+=String.fromCharCode(255&o>>(-2*n&6)));return i}(n[1]));o&&o.exp&&(r=1e3*o.exp),o&&o.puid&&(t=o.puid)}return{token:e,expEpoch:r,userPuid:t}}function vt(e){return!(!e||e.expEpoch-Date.now()<12e4)}var gt=function(){return(gt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},yt=Z(function(e){var t=e.msbUrl,r=e.clientType,n=t+"/work/api/v3/user/init",i={Authentication:e.token,clientContext:{clientType:r}};return Object(o.a)({url:n,method:"POST",body:JSON.stringify(i)})},{monitorName:"warmupMsb",cacheId:"warmupMsb",cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token"]);return gt({},t)}});function bt(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return L(0,"Prod")}}function Ot(e){switch(e){case"Blackforest":return"https://substrate.office.de";case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"AG08":return"https://substrate.exo.eaglex.ic.gov";case"AG09":return"https://substrate.exo.microsoft.scloud";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return"https://substrate.office.com";default:return L(0,"https://substrate.office.com")}}var St=function(){return(St=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},wt=Z(function(e){var t=e.token,r=e.queryStringParameters,n=e.headers,o=e.postAction,i=void 0===o?"init":o,c=e.cvid,a=e.makeSubstrateRequest,s=e.substrateUrl,u=r?St({},r):{},f={action:i,token:t,prefix:void 0,cvid:c||Object(Ze.a)(),additionalInfo:St(St({},u),{diagnostics:"1"}),headers:n};return(a?a(f):function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=nt(t),at[t]?pt(e,t):st(t).then(function(t){return t(e)})}(f,s)).then(function(e){if(!Object(Ye.a)(e.statusCode))throw{status:e.statusCode};var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var r=function(e){var t=JSON.parse(e)[0];return t.name,function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(t,["name"])}(e.diagnostics);r&&r.duration&&(t["Substrate-DiagnosticsDuration"]=""+r.duration)}catch(e){}return{status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}}})},{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:function(e){return e.getResponseHeader?{properties:JSON.stringify({requestId:e.getResponseHeader("request-id")||"",serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader("Substrate-DiagnosticsDuration")||""})}:{}},cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token","makeSubstrateRequest","cvid"]);return St({},t)}});function It(e,t){return x({monitorType:"chunk_load",monitorName:e+"_chunk_load",monitorOnce:!0},t)}var xt=function(){return(xt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Pt(e,t){var r,n=null,o=!1,i=function(){return o||(o=!0,r=t({attempt:1}).then(function(e){return n=mt(e),o=!1,e}).catch(function(e){throw o=!1,e})),r};return function(r,o,c){void 0===c&&(c=!0);var a,s,f,p=c?(a=e+"_withRefresh",s=performance.now(),(f=Object(u.a)()).dispatch({name:"generic_qos",nameDetail:a,timestamp:s,eventType:"QOSSTART"}),function(e,t,r){var n=performance.now();f.dispatch({name:"generic_qos",nameDetail:a,startTimestamp:s,totalTime:n-s,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:r})}):function(){};if(!t)return p("FAILURE",xt({cacheItemResolved:!1,tokenProviderNull:!0},o)),Promise.reject("token provider is null");if(!n||!vt(n)||r.attempt>0)return i().then(function(e){return p("SUCCESS",xt({cacheItemResolved:!1,expires:n&&new Date(n.expEpoch),didRefresh:!0},o)),e}).catch(function(e){throw p("FAILURE",xt({cacheItemResolved:!1,tokenProviderNull:!1},o)),e.reason||e});var l,h=!!vt(l=n)&&Date.now()>l.expEpoch-24e4;return h&&i(),p("SUCCESS",xt({cacheItemResolved:!0,expires:n&&new Date(n.expEpoch),backgroundRefresh:h},o)),Promise.resolve(n.token)}}function jt(e,t,r){var n,o,i=0,c=Pt(e,t);return function(e){return i++,o||(o=window.setInterval(function(){i++,c({attempt:0},{invokedByPeriodicRefresh:!0,invocationCounter:i},!1),Date.now()-n>864e5&&(window.clearInterval(o),o=void 0)},r||3e5)),n=Date.now(),c(e,{invokedByPeriodicRefresh:!1,invocationCounter:i},!0)}}},tMv9:function(e,t,r){"use strict";function n(e){return e>=200&&e<=300||0===e}r.d(t,"a",function(){return n})},wuCr:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n="1.20210309.6.0"},yeHm:function(e,t,r){"use strict";e.exports=function(e,t,r,n,o,i,c,a){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,i,c,a],f=0;s=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return u[f++]}))}throw s.framesToPop=1,s}}},zLqp:function(e,t,r){e.exports.Dispatcher=r("mqVB")}}]);