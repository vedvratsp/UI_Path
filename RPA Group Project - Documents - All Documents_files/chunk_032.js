(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[75],{"67N2":function(e,t,r){"use strict";r.d(t,"d",function(){return o}),r.d(t,"c",function(){return i}),r.d(t,"e",function(){return a}),r.d(t,"g",function(){return s}),r.d(t,"a",function(){return c}),r.d(t,"f",function(){return u}),r.d(t,"b",function(){return l});var n=r("UWqr");function o(){return n._SPKillSwitch.isActivated("b08d62b9-3c21-4a8f-b136-e7d7b525e924")}function i(){return n._SPKillSwitch.isActivated("bafad34d-40e9-478d-b565-5c812b80031f")}function a(){return n._SPKillSwitch.isActivated("61be9ad0-f47c-405d-9c28-92f9142430a9")}function s(){return n._SPKillSwitch.isActivated("d9407616-7ba4-4b30-8e26-64e6c81cddcc")}function c(){return n._SPKillSwitch.isActivated("cb5d7cee-5511-4928-bf2e-ed9d5a967e01")}function u(){return n._SPKillSwitch.isActivated("74843650-4b21-403f-a76b-dfe9d4230bd2")}function l(){return n._SPKillSwitch.isActivated("a0cc773e-4b78-4e4f-ba45-deb0cfc86ba1")}},Fn15:function(e,t,r){"use strict";var n=r("hiL/"),o=r("jyrw"),i=function(){function e(){}return e.pageSaved=function(){o.a._dispatchAction("SET_SAVESTATUS",n.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:n.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){o.a._dispatchAction("SET_SAVESTATUS",n.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:n.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){o.a._dispatchAction("SET_SAVESTATUS",n.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:n.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.a=i},IKdF:function(e,t,r){"use strict";r.r(t);var n=r("17wl"),o=r("ut3N"),i=r("2q6Q"),a=r("hiL/"),s=r("y88i"),c=r("0SGS"),u=r("q+wp"),l=function(){function e(){}return e.insert=function(e,t){var r=new i._QosMonitor("PageCacheInsert");try{var n=JSON.stringify(t);window.sessionStorage.setItem(e,n),r.writeSuccess()}catch(e){r.writeUnexpectedFailure("PageCacheInsert",e)}},e.insertPage=function(e,t,r){e=this._normalize(e),this.insert("page-cache://"+e,{route:e,preloadedData:t,version:r})},e.get=function(e){var t=new i._QosMonitor("PageCacheGet");try{var r=window.sessionStorage.getItem(e),n=JSON.parse(r);return t.writeSuccess(),n}catch(e){t.writeUnexpectedFailure("PageCacheGet",e)}},e.getPage=function(e){return e=this._normalize(e),this.get("page-cache://"+e)},e.remove=function(e){var t=new i._QosMonitor("PageCacheDelete");try{window.sessionStorage.removeItem(e),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("PageCacheDelete",e)}},e.removePage=function(e){e=this._normalize(e),this.remove("page-cache://"+e)},e._normalize=function(e){return u.default.relativizeUrl(u.default.removeQueryString(e.toLowerCase()))},e}(),g=r("onFi"),d=r("lmp7"),p=r("7plR"),h=r("ExwJ"),P=r("UF/m"),S=r("xs0R"),f=r("0IsF"),_=r("XdGY"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logSource=o._LogSource.create("SPPageDataProvider"),t}return Object(n.__extends)(t,e),t.prototype.getPageUrlAsync=function(e){var t=this,r=this._restSitePagesEndPointUrl+"("+e+")/FileName";d.b.appCacheHit=!1;var n=new i._QosMonitor("GetPageUrlAPI");return this._fetchJson(r).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return o._TraceLogger.logError(t._logSource,e),404===e.status?n.writeExpectedFailure("FailedResponseNotFound",e):403===e.status?n.writeExpectedFailure("FailedResponseForbidden",e):406===e.status?n.writeExpectedFailure("FailedResponseNotAcceptable",e):n.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.getListItemModerationStatusAsync=function(e){var t=this._webServerRelativeUrl+"/_api/web/lists(guid'"+this._pageContext.list.id+"')/Items("+e+")?$select=OData__ModerationStatus";return this._fetchJson(t).then(function(e){if(void 0===e.OData__ModerationStatus)throw"Invalid Moderation Status";return e.OData__ModerationStatus})},t.prototype.getPageTemplates=function(){var e="PageTemplates_"+this._webServerRelativeUrl,t=l.get(e);if(t)return Promise.resolve(t);var r=this._restSitePagesEndPointUrl+"/templates";return this._fetchJson(r).then(function(t){var r=t.value;return l.insert(e,r),r}).catch(function(e){throw e})},t.prototype.savePageToServerAsync=function(e,t,r,n){if(!Object.keys(t).length){var i=new Error("should not save empty page content");return o._TraceLogger.logError(this._logSource,i,n),Promise.reject(i)}var s=t[h.a.PreviewImageUrl];a.ThumbnailUrlGenerator.isStockImage(s)&&(t[h.a.PreviewImageUrl]=this._defaultSitePageThumbnail);var c=r?"SavePageAsDraft":"SavePage",u=this._restSitePagesEndPointUrl+"("+e+")/"+c,l=new P.b(t);return o._TraceLogger.logVerbose(this._logSource,n+" ("+e+")"),this._savePage(u,l,n,new P.c("POST"))},t.prototype.createBlankPageAsync=function(e,t,r){var n=new i._QosMonitor("CreateBlankPageAPI"),o=S.b.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,a=new P.b({PromotedState:e||void 0,PageLayoutType:t||void 0,ContentTypeId:r||void 0});return this.createOrCopyPage(o,new P.c("POST"),a.toString(),n,"createBlankPageAsync")},t.prototype.createTopicPageAsync=function(){var e=new i._QosMonitor("CreateBlankPageAPI"),t=this._restTopicsEndPointUrl,r=S.b.fields.EntityId,n=new P.b({Title:S.b.fields.Title,EntityId:r!==a.NULL_TOPIC_ENTITY.Id?r:"",EntityType:"Project",EntityRelations:a.EntityRelationsService.getRelationsAsString(p.a.instance.serviceScope),LayoutWebpartsContent:c.a.serializeLayoutWebPartData(S.b.fields.LayoutWebPartsDataMap),CanvasContent1:JSON.stringify(S.b.fields.CanvasContent1),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:f.a.Topic});return this.createOrCopyPage(t,new P.c("POST"),n.toString(),e,"createTopicPageAsync")},t.prototype.copyPage=function(e){var t=new i._QosMonitor("CopyPageAPI"),r="";this._shouldCreateNewsCopy()?(r="CreateNewsCopy",p.a.instance.promoteOnPublish=!1):r="Copy";var n=this._restSitePagesEndPointUrl+"("+e+")/"+r;return this.createOrCopyPage(n,new P.c("POST"),(new P.b).toString(),t,"copyPage")},t.prototype.savePageAsTemplate=function(e){var t="PageTemplates_"+this._webServerRelativeUrl;l.remove(t);var r=new i._QosMonitor("SavePageAsTemplateAPI"),n=this._restSitePagesEndPointUrl+"("+e+")/SavePageAsTemplate";return this.createOrCopyPage(n,new P.c("POST"),(new P.b).toString(),r,"savePageAsTemplate")},t.prototype.getTemplateFolderUrl=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary/GetSpecialFolderUrl",t=new i._QosMonitor("GetTemplateFolderUrl");return this._fetchJson(e,new P.c("POST"),JSON.stringify({type:9,bForceCreate:!1})).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingTemplateFolderUrl",e),Promise.reject(e)})},t.prototype.createOrCopyPage=function(e,r,n,i,a){var s=this;o._TraceLogger.logVerbose(this._logSource,a);var c=window._isInititatedByPageApp?"FromPageApp":"FromRouter";return this._fetchJson(e,r,n).then(function(e){if(!e||!e.Id)throw t._getOdataRestApiError(e)||new g.a;return s._processCreateOrCopyResponse(a,i,e)}).catch(function(e){throw e instanceof g.a?403===e.status?i.writeExpectedFailure("FailedResponseForbidden",e,{pageCreationEntryPoint:c}):i.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}):(i.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}),o._TraceLogger.logError(s._logSource,e,c)),e})},t.prototype.checkOutAndReloadPageAsync=function(e){var t=this,r=this._restSitePagesEndPointUrl+"("+e+")/checkoutpage",n=new i._QosMonitor("CheckOutPageAPI");return o._TraceLogger.logVerbose(this._logSource,"checkOutAndReloadPageAsync"),this._fetchJson(r,new P.c("POST")).then(function(e){if(!e||!e.IsPageCheckedOutToCurrentUser)throw new g.a;var r=c.a.tryLoadFromSitePagesOdata(e);return o._TraceLogger.logVerbose(t._logSource,"checkOutAndReloadPageAsync success"),n.writeSuccess(),r}).catch(function(e){throw e instanceof g.a?(t._handleOdataError(e,e.status,n,"CheckOutPageAPI"),o._TraceLogger.logError(t._logSource,e,"CheckOutPageAPI")):(n.writeUnexpectedFailure("FailedToCheckoutPageError2",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.publishPageAsync=function(e){var t=this,r=this._restSitePagesEndPointUrl+"("+e+")/publish",n=new i._QosMonitor("PublishPageAPI");o._TraceLogger.logVerbose(this._logSource,"publishPageAsync");var a=Object(_.rb)()?void 0:{alias:S.b.fields.PageLayoutType};return this._fetchJson(r,new P.c("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new g.a);n.writeSuccess(a)}).catch(function(e){return e.isUnknown?(n.writeUnexpectedFailure("PublishPageAPI",e,a),o._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,n,"PublishPageAPI",a),Promise.reject(e)})},t.prototype.schedulePageAsync=function(e){var t=this,r=new i._QosMonitor("SchedulePublishAPI"),n=this._restSitePagesEndPointUrl+"("+e+")/schedulepublish";return o._TraceLogger.logVerbose(this._logSource,"schedulePageAsync"),this._fetchJson(n,new P.c("POST"),JSON.stringify({})).then(function(e){return r.writeSuccess(),e.value}).catch(function(e){var n;return"-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException"===(null===(n=e)||void 0===n?void 0:n.code)&&(r.writeExpectedFailure("SchedulePublishAPI",e),o._TraceLogger.logError(t._logSource,e)),e.isUnknown?(r.writeUnexpectedFailure("SchedulePublishAPI",e),o._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,r,"SchedulePublishAPI"),Promise.reject(e)})},t.prototype.discardPageAsync=function(e){var t=this,r=Object(_.pb)()?this._restSitePagesEndPointUrl+"("+e+")/discardPage":this._restSitePagesEndPointUrl+"("+e+")/discardPage?$expand=VersionInfo",n=new i._QosMonitor("DiscardPageAPI");return o._TraceLogger.logVerbose(this._logSource,"discardPageAsync"),this._fetchJson(r,new P.c("POST")).then(function(e){if(!e)throw new g.a;var r=c.a.tryLoadFromSitePagesOdata(e);return o._TraceLogger.logVerbose(t._logSource,"discardPageAsync success"),n.writeSuccess(),r}).catch(function(e){throw e instanceof g.a&&!e.isUnknown?t._handleOdataError(e,e.status,n,"DiscardPageAPI"):(n.writeUnexpectedFailure("FailedToDiscardPageError22",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.promotePageToNewsAsync=function(e){var t=this,r=this._restSitePagesEndPointUrl+"("+e+")/PromoteToNews",n=new i._QosMonitor("PromotePageToNewsAPI");return o._TraceLogger.logVerbose(this._logSource,"promotePageToNewsAsync"),this._fetchJson(r,new P.c("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new g.a);n.writeSuccess()}).catch(function(e){return e.isUnknown?(o._TraceLogger.logError(t._logSource,e,"PromotePageToNewsAPI"),n.writeUnexpectedFailure("PromotePageToNewsAPI",e)):t._handleOdataError(e,e.status,n,"PromotePageToNewsAPI"),Promise.reject(e)})},t.prototype.checkInFileAsync=function(e,t){var r=this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('"+this._pageContext.list.serverRelativeUrl+"/"+t+"')/checkin("+e+")",n=new i._QosMonitor("CheckinFileAPI");return this._fetchJson(r,new P.c("POST"),JSON.stringify({})).then(function(){return n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getFileEtagAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForEtag,this._pageServerRelativeUrl),t=new i._QosMonitor("GetFileEtagAPI");return this._fetchJson(e).then(function(e){if(!e.ETag)throw new g.a;return t.writeSuccess(),e.ETag}).catch(function(e){throw t.writeUnexpectedFailure("FailedGettingFileEtag",e),e})},t.prototype.getFileCheckinCommentsAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForCheckInComments,this._pageServerRelativeUrl),t=new i._QosMonitor("GetFileCheckInComments");return this._fetchJson(e).then(function(e){return t.writeSuccess(),e.CheckInComment}).catch(function(e){return t.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getUserById=function(e){var t=this._webServerRelativeUrl+"/_api/web/GetUserById("+e+")",r=new i._QosMonitor("GetUserById");return this._fetchJson(t).then(function(t){return r.writeSuccess(),{id:e,email:t.Email,name:t.Title}}).catch(function(e){return r.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getPagePublishStartDate=function(e){var t=this._restSitePagesEndPointUrl+"("+e+")?$select=PublishStartDate",r=new i._QosMonitor("GetPublishStartDate");return this._fetchJson(t).then(function(e){return r.writeSuccess(),e.PublishStartDate}).catch(function(e){return r.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getListMetadataAsync=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary?$select=EnableModeration,EnableMinorVersions,Id",t=new i._QosMonitor("GetListMetadataAPI");return this._fetchJson(e,new P.c("POST"),JSON.stringify({})).then(function(e){return t.writeSuccess(),{EnableMinorVersions:e.EnableMinorVersions,EnableModeration:e.EnableModeration,Id:e.Id}}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingModerationStatus",e),Promise.reject(e)})},t.prototype.getIsTemplate=function(e){var t=this._restSitePagesEndPointUrl+"("+e+")?$select=IsTemplate",r=new i._QosMonitor("GetIsTemplate");return this._fetchJson(t).then(function(e){return r.writeSuccess(),e.IsTemplate}).catch(function(e){return r.writeUnexpectedFailure("FailedGettingFileEtag",e),Promise.reject(e)})},t.prototype.setListItemModerationStatus=function(e,t,r,n){var o=this._webServerRelativeUrl+"/_api/SP.APIHubConnector.SetApprovalStatus",a=new i._QosMonitor("SetModerationStatusAPI"),s={action:r,comments:t,etag:n,itemId:e.toString(),listName:this._pageContext.list?this._pageContext.list.id.toString():"Site Pages"};return this._fetchJson(o,new P.c("POST"),JSON.stringify(s)).then(function(){return a.writeSuccess()}).catch(function(e){return a.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getClassicHomepageUrlAsync=function(){var e=this,t=l.get("ClassicHomepageUrl_"+this._webServerRelativeUrl);if(t)return o._TraceLogger.logVerbose(this._logSource,"get classic homepage url from cache"),Promise.resolve(t);var r=s.Uri.concatenate(this._webServerRelativeUrl,"_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"),n=new i._QosMonitor("GetClassicHomepageUrl");return this._fetchJson(r).then(function(t){var r=t.ClassicWelcomePage,i=t.IsRevertHomepageLinkHidden?"":r;return o._TraceLogger.logVerbose(e._logSource,"getClassicHomepageUrlAsync success"),n.writeSuccess(),l.insert("ClassicHomepageUrl_"+e._webServerRelativeUrl,i),i}).catch(function(t){return 403===t.status?(n.writeExpectedFailure("GetClassicHomepageUrl",t),""):(n.writeUnexpectedFailure("GetClassicHomepageUrl",t),o._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.removeClassicHomepageUrl=function(){var e=this,t=this._webServerRelativeUrl+"/_api/Web",r=new i._QosMonitor("RemoveClassicHomepageUrl");return this._fetchJson(t,new P.c("PATCH"),JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})).then(function(){r.writeSuccess(),l.remove("ClassicHomepageUrl_"+e._webServerRelativeUrl)}).catch(function(e){return r.writeUnexpectedFailure("RemoveClassicHomepageUrl",e),Promise.reject(e)})},t.prototype.getHomePageUrlAsync=function(){var e=this,t=l.get("HomePage_"+this._webServerRelativeUrl);if(t)return o._TraceLogger.logVerbose(this._logSource,"get home page url from cache"),Promise.resolve(t);var r=s.Uri.concatenate(this._webServerRelativeUrl,"_api/web/rootfolder?$select=welcomepage"),n=new i._QosMonitor("GetHomePageUrl");return this._fetchJson(r).then(function(t){var r=s.Uri.concatenate(e._webServerRelativeUrl,t.WelcomePage);return o._TraceLogger.logVerbose(e._logSource,"getHomePageUrlAsync success"),n.writeSuccess(),l.insert("HomePage_"+e._webServerRelativeUrl,r),r}).catch(function(t){return 403===t.status?(n.writeExpectedFailure("GetHomePageUrl",t),""):(n.writeUnexpectedFailure("GetHomePageUrl",t),o._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.getPreviousPageVersionInfoAsync=function(e){var t=this,r=this._restSitePagesEndPointUrl+"("+e+")/VersionInfo",n=new i._QosMonitor("VersionInfoPageAPI");return o._TraceLogger.logVerbose(this._logSource,"getPreviousPageVersionInfoAsync"),this._fetchJson(r,new P.c("POST")).then(function(e){if(!e)throw new g.a;return n.writeSuccess(),e}).catch(function(e){throw e instanceof g.a?e.isUnknown?(n.writeUnexpectedFailure("FailedResponseStatus",e),o._TraceLogger.logError(t._logSource,e,"VersionInfoPageAPI")):t._handleOdataError(e,e.status,n,"VersionInfoPageAPI"):(n.writeUnexpectedFailure("FailedToGetPageVersion",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.deletePageAsync=function(){var e=this,t=new i._QosMonitor("DeletePageAPI"),r=s.Uri.concatenate(this._webServerRelativeUrl,"/_api/web/lists(guid'"+this._pageContext.list.id+"')/Items("+(S.b.fields.Id||u.default.spPageContextInfo.pageItemId)+")/recycle");return this._fetchJson(r,new P.c("POST")).then(function(e){var r;if(!(null===(r=e)||void 0===r?void 0:r.value))throw new g.a;t.writeSuccess()}).catch(function(r){throw r instanceof g.a?r.isUnknown?(t.writeUnexpectedFailure("FailedResponseStatus",r),o._TraceLogger.logError(e._logSource,r,"DeletePageAPI")):e._handleOdataError(r,r.status,t,"DeletePageAPI"):(t.writeUnexpectedFailure("FailedToDeletePage",r),o._TraceLogger.logError(e._logSource,r)),r})},t.prototype.addPageToQuickLaunchAsync=function(e,t){var r=this,n=this._webServerRelativeUrl+"/_api/web/navigation/QuickLaunch",a=new i._QosMonitor("AddPageToQuickLaunchAPI"),s=new P.b({__metadata:{type:"SP.NavigationNode"},IsExternal:!0,Title:e,Url:t});return this._fetchJson(n,new P.c("POST"),s.toString()).then(function(e){return a.writeSuccess(),o._TraceLogger.logVerbose(r._logSource,"addPageToQuickLaunchAsync success"),{key:e.Id.toString(),name:e.Title,url:e.Url,target:u.default.isRelativeUrl(e.Url)?"_self":"_blank"}}).catch(function(e){return a.writeUnexpectedFailure("FailedResponseStatus",e),e instanceof g.a?o._TraceLogger.logError(r._logSource,e,"AddPageToQuickLaunchAPI"):o._TraceLogger.logError(r._logSource,e),Promise.reject(e)})},t.prototype.getClassicPubNavProviderTypeAsync=function(e){var t=new i._QosMonitor("GetClassicPublishingNavProviderAPI"),r=this._webServerRelativeUrl+"/_api/navigation/GetPublishingNavigationProviderType?mapProviderName=%27";return r+=e,r+="%27",this._fetchJson(r).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.ensureTitleResourceAsync=function(){var e=this,t=this._restSitePagesEndPointUrl+"/EnsureTitleResource";return this._fetchJson(t,new P.c("POST"),JSON.stringify({})).then(function(){}).catch(function(t){throw o._TraceLogger.logError(e._logSource,t),t})},t.prototype.getVersion=function(e,t){var r=this._restSitePagesEndPointUrl+"("+e+")/getversion("+t+")",n=new i._QosMonitor("GetVersionAPI");return this._fetchJson(r).then(function(e){if(!e)throw new g.a;var t=c.a.tryLoadFromSitePagesOdata(e);return n.writeSuccess(),t}).catch(function(e){throw n.writeUnexpectedFailure("FailedGetVersion",e),e})},t.prototype.getDashboardPage=function(){var e=this._restSitePagesEndPointUrl+"?$filter=PageLayoutType eq '"+f.a.Dashboard+"'&$top=1&$select=FileName",t=new i._QosMonitor("GetDashboardPage");return this._fetchJson(e).then(function(e){return e&&e.value&&e.value.length>0?(t.writeSuccess({exist:!0}),e.value[0].FileName):void t.writeSuccess({exist:!1})}).catch(function(e){t.writeUnexpectedFailure(e)})},t.prototype._savePage=function(e,t,r,n){var a=this,s=new i._QosMonitor(r),c=Object(_.rb)()?void 0:{alias:S.b.fields.PageLayoutType};return this._fetchJson(e,n,t.toString(),this._isSaveSuccessful).then(function(e){return s.writeSuccess(c),o._TraceLogger.logVerbose(a._logSource,r+"success"),e.value}).catch(function(e){return e instanceof g.a?e.isUnknown?(s.writeUnexpectedFailure("FailedResponseStatus",e,c),o._TraceLogger.logError(a._logSource,e,r)):a._handleOdataError(e,e.status,s,r,c):(s.writeUnexpectedFailure("FailedToSavePageError2",e,c),o._TraceLogger.logError(a._logSource,e)),Promise.reject(e)})},t.prototype._processCreateOrCopyResponse=function(e,t,r){o._TraceLogger.logVerbose(this._logSource,e+" ("+r.Id+")");var n=c.a.tryLoadFromSitePagesOdata(r);return u.default.updatePageContextItemId(r.Id),t.writeSuccess(),n},t.prototype._shouldCreateNewsCopy=function(){return p.a.instance.promoteOnPublish},t}(P.a);t.default=v},"UF/m":function(e,t,r){"use strict";r.d(t,"c",function(){return d}),r.d(t,"b",function(){return p}),r.d(t,"a",function(){return h});var n=r("ut3N"),o=r("Pk8u"),i=r("vlQI"),a=r("UWqr"),s=r("y88i"),c=r("EMa1"),u=r("onFi"),l=r("q+wp"),g=r("xs0R"),d=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},p=function(){function e(e){var t;t=g.b.isSpace?"SP.Publishing.SitePage3D":l.default.isNewTopicPage()?"SP.Publishing.TopicSitePage":"SP.Publishing.SitePage",this.__metadata={type:t},e&&Object(o.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),h=function(){function e(t,r){this._pageContext=t,this._spHttpClient=r,this._spHttpClientFetch=this._spHttpClient.fetch.bind(this._spHttpClient),this._spHttpClientGet=this._spHttpClient.get.bind(this._spHttpClient),this._spHttpClientPost=this._spHttpClient.post.bind(this._spHttpClient),this._isResponseSuccessful=l.default.isResponseSuccessful.bind(l.default),this._isSaveSuccessful=e._isSaveResponseSuccessful}return e._getOdataRestApiError=function(e,t,r){void 0===t&&(t=500);var n=e["odata.error"],o=r&&r.message||"unknown";return n&&n.message?new u.a("Inner-Message: "+n.message.value+" Exception-Message: "+o,t,n.code):void 0},e._encodeAndSanitizeURIComponent=function(e){return(e=encodeURIComponent(e).replace(/'/g,"''")).replace(/[~!*()']/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},e._isSaveResponseSuccessful=function(e){return l.default.isResponseSuccessful(e)||413===e},Object.defineProperty(e.prototype,"_webServerRelativeUrl",{get:function(){return a.UrlUtilities.removeEndSlash(this._pageContext.legacyPageContext.webServerRelativeUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_restSitePagesEndPointUrl",{get:function(){return this._webServerRelativeUrl+"/_api/sitepages/pages"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_restSpacesEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/spaces"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForEtag",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=ETag"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForCheckInComments",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=CheckInComment"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_restTopicsEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/topics"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_defaultSitePageThumbnail",{get:function(){return s.Uri.concatenate("/",this._pageContext.legacyPageContext.layoutsUrl,"/images/sitepagethumbnail.png")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_pageServerRelativeUrl",{get:function(){var t="/"+e._encodeAndSanitizeURIComponent(l.default.url(!0).replace(l.default.domainUrl(),""));return l.default.doesUrlHaveFileName?t:l.default.spPageContextInfo.serverRequestPath},enumerable:!0,configurable:!0}),e.prototype._fetch=function(e,t,r,n){var o=this._spHttpClientPost,a={body:r,headers:t};return t?"GET"===t["X-HTTP-Method"]&&(o=this._spHttpClientFetch):(a=void 0,o=this._spHttpClientGet),o(e,i.SPHttpClient.configurations.v1,a).catch(function(e){return Promise.reject({error:new u.a})}).then(function(e){if(!n(e.status)){var t=new u.a(l.default.getStatusMessage(e),e.status);throw t.response=e,{error:t,isResponseSuccessful:!1}}return e})},e.prototype._fetchJson=function(t,r,n,o){var i;return this._fetch(t,r,n||(new p).toString(),o||this._isResponseSuccessful).catch(function(e){if(!1===e.isResponseSuccessful)return i=e.error,e.error.response;throw e.error}).then(function(e){return e.ok&&204===e.status?e:e.json()}).then(function(t){var r=e._getOdataRestApiError(t,i&&i.status,i)||i;if(r)throw r;return t})},e.prototype._handleOdataError=function(e,t,r,o,i){if(e){if(400!==t||e.message!==c.b.exceedStreamLimitationErrorMessage&&e.message!==c.b.requestMessageTooBigErrorMessage)if(409===t){var a=new u.a("File checked out by another user",409);r.writeExpectedFailure("FailedResponsePageConflict",a,i)}else if(404===t){var s=new u.a("Page is not found",404);r.writeExpectedFailure("FailedResponseNotFound",s,i)}else 406===t?r.writeExpectedFailure("FailedResponseNotAcceptable",e,i):r.writeUnexpectedFailure("FailedResponseStatus",e,i);else r.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e,i);throw n._TraceLogger.logError(this._logSource,e,o),e}},e}()},pfXd:function(e,t,r){"use strict";var n=r("ut3N"),o=r("jyrw"),i=r("E7/L");function a(){return r.e(54).then(r.bind(null,"+Mf1")).then(function(e){return e.default})}var s=r("xs0R"),c=r("q+wp"),u=function(){function e(){}return e.setIsTemplate=function(t){o.a._dispatchAction("FIELDS_SET_TEMPLATE_STATUS",t,e._moduleName,"set page template flag")},e.setNumMissingRequiredProps=function(t){o.a._dispatchAction("FIELDS_SET_MISSING_PROPS",t,e._moduleName,"set missing required properties")},e.setCategories=function(t){o.a._dispatchAction("FIELDS_SET_CATEGORIES",t,e._moduleName,"set categories")},e.addFieldsToUpdate=function(t){e._dispatchAction("FIELDS_UPDATE",t,"SPPageFieldStoreSetFields")},e.addFieldToUpdate=function(t,r){if(!t)throw new Error("fieldName is undefined");var n={};n[t]=r,e.addFieldsToUpdate(n)},e.setPromotedState=function(t){e._dispatchAction("FIELDS_SET_PROMOTEDSTATE",t,"SPPageFieldStoreSetFields")},e.setFields=function(t){e._dispatchAction("FIELDS_SET",t,"SPPageFieldStoreSetFields")},e.createNewPage=function(t,r,o,a){return a&&(t.bannerImageUrl=s.b.fields.BannerImageUrl),(t.pageFieldData?Promise.resolve(t.pageFieldData):Object(i.a)().then(function(e){return e.createNewPageStub(t,r,o,a)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&c.default.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){n._TraceLogger.logError(e._logSource,t)})},e.createNewPageDeprecated=function(t,r,o,a,u,l,g,d,p,h,P){return d&&(h=s.b.fields.BannerImageUrl),(o?Promise.resolve(o):Object(i.a)().then(function(e){return e.createNewPageStubDeprecated(t,r,a,u,l,g,d,p,h)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&c.default.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){n._TraceLogger.logError(e._logSource,t)})},e.scheduleNewMajorVersionToServerAsync=function(){return a().then(function(e){return e.scheduleNewMajorVersionToServerAsync()})},e.publishNewMajorVersionToServerAsync=function(){return a().then(function(e){return e.publishNewMajorVersionToServerAsync()})},e.publishNewTopicPageToServerAsync=function(){return a().then(function(e){return e.publishNewTopicPageToServerAsync()})},e.discardPageOnServerAsync=function(){return a().then(function(e){return e.discardPageOnServerAsync()})},e.getPreviousPageVersionInfoAsync=function(){return a().then(function(e){return e.getPreviousPageVersionInfoAsync()})},e.setListItemModerationStatusAsync=function(e,t){return a().then(function(r){return r.setListItemModerationStatusAsync(e,t)})},e.setFileCheckInCommentsAsync=function(){return a().then(function(e){return e.setFileCheckInCommentsAsync()})},e.checkOutFieldsFromServerAsync=function(){return a().then(function(e){return e.checkOutFieldsFromServerAsync()})},e.saveDraftToServerAsync=function(){return a().then(function(e){return e.saveDraftToServerAsync()})},e.saveFieldsToServerAsync=function(e){return void 0===e&&(e=!1),a().then(function(t){return t.saveFieldsToServerAsync(e)})},e.getPageUrlFromServerAsync=function(){return a().then(function(e){return e.getPageUrlFromServerAsync()})},e.checkInFileAsync=function(e,t,r){return a().then(function(n){return n.checkInFileAsync(e,t,r)})},e.ensureValidPageTitleAsync=function(){return a().then(function(e){return e.ensureValidPageTitle()})},e.promotePageToNewsAsync=function(){return a().then(function(e){return e.promotePageToNewsAsync()})},e.cacheClientForm=function(t,r){void 0===r&&(r=!1),e._dispatchAction("FIELDS_CACHE_CLIENTFORM",{clientForm:t,forceCanvasUpdate:r},"SPPageCacheClientForm")},e.ensurePageExistsAsync=function(){return s.b.doesPageExistOnServer?(n._TraceLogger.logVerbose(e._logSource,"Page already Exists"),Promise.resolve()):(n._TraceLogger.logVerbose(e._logSource,"Page does not Exists, calling createNewPageOnServerAsync"),a().then(function(e){return e.createNewPageOnServerAsync()}))},e.commitTitle=function(){e._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")},e.deletePageAsync=function(){return a().then(function(e){return e.deletePageAsync()})},e._dispatchAction=function(t,r,n){return o.a._dispatchAction(t,r,e._moduleName,n,void 0,e._logSource)},e._moduleName="[PageFieldStoreAction]",e._logSource=n._LogSource.create("PageFieldStoreActionCreator"),e}();t.a=u},s2tg:function(e,t,r){"use strict";r.r(t);var n=r("jyrw"),o=function(){function e(){}return e.load=function(t){n.a._dispatchAction("CHROME_CONFIG_LOAD",t,e._moduleName,"SPPageConfigChrome")},e._moduleName="[ChromeConfigurationAction]",e}(),i=r("2q6Q"),a=r("7plR"),s=r("n1SJ"),c=r("LjAQ"),u=function(){function e(){}return e.addQuickLaunchNode=function(t){var r=new i._QosMonitor("SPPageNavigationUpdateQuickLaunch");try{a.a.instance.getPageDataProviderAsync().then(function(e){return e.addPageToQuickLaunchAsync(t.name,t.url)}).then(function(t){n.a._dispatchAction("QUICKLAUNCH_ADDONE",t,e._moduleName,"SPPageNavigationUpdateQuickLaunch",void 0,void 0,r)}).catch(function(e){s.a.showError(c.a,c.b)})}catch(e){throw r.writeUnexpectedFailure("SPPageNavigationUpdateQuickLaunch",e),e}},e._moduleName="[NavigationAction]",e}(),l=r("17wl"),g=r("pfXd"),d=r("ut3N"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.undo=function(){n.a._dispatchAction("FIELDS_UNDO",{},t._undoableModuleName,"Undo",void 0,t.LOG_SOURCE,new d._QosMonitor("Undo"))},t.redo=function(){n.a._dispatchAction("FIELDS_REDO",{},t._undoableModuleName,"Redo",void 0,t.LOG_SOURCE,new d._QosMonitor("Redo"))},t.clearHistory=function(){n.a._dispatchAction("FIELDS_CLEAR_HISTORY",{},t._undoableModuleName,"ClearHistory",void 0,t.LOG_SOURCE,new d._QosMonitor("ClearHistory"))},t.disableUndo=function(){n.a._dispatchAction("FIELDS_DISABLE_UNDO",{},t._undoableModuleName,"DisableUndo")},t.enableUndo=function(){n.a._dispatchAction("FIELDS_ENABLE_UNDO",{},t._undoableModuleName,"EnableUndo")},t.LOG_SOURCE=d._LogSource.create("UndoablePageFieldStoreActionCreator"),t._undoableModuleName="[UndoablePageFieldStoreAction]",t}(g.a),h=function(){function e(){}return e.loadPageLayoutMapping=function(t){n.a._dispatchAction("PAGELAYOUTMAPPING_LOAD",t,e._moduleName,"SPPageLayoutMapping",{Mapping:t.toString()})},e.addPageLayoutMapping=function(t,r){n.a._dispatchAction("PAGELAYOUTMAPPING_ADD",{key:t,pageLayout:r},e._moduleName,"SPPageAddPageLayoutMapping",{key:t})},e._moduleName="[PageFieldStoreAction]",e}(),P=r("Fn15"),S=function(){function e(){}return e.load=function(t){n.a._dispatchAction("PAGE_TEMPLATE_LOAD",t,e._moduleName,"SPPageTemplatesLoad")},e._moduleName="[PageTemplateAction]",e}(),f=function(){function e(){}return e.setListSettings=function(t){n.a._dispatchAction("SET_LIST_SETTINGS",t,e._moduleName,"set list settings")},e._moduleName="[ListActionCreator]",e}(),_=r("hiL/"),v=r("q+wp"),w=r("sSDQ"),m=r("UWqr"),b=r("I6O9"),y=r("EMa1"),A=r("ExwJ"),T=r("0IsF"),U=r("XdGY"),E=r("9sBY"),F=r("M+LP"),C=r("67N2"),I=function(){function e(){}return e.createNewPage=function(t,r){var n=r.canvasContent1?e._extractWebPartIdsFromCanvasContent(r.canvasContent1):[];return(Object(_.isCortexEnabled)(a.a.instance.pageContext)?e._loadComponentManifests(n):Promise.resolve()).then(function(){return a.a.instance.autoSaverPromise.then(function(n){return a.a.instance.getPageDataProviderAsync().then(function(o){var i,c,u,l=Object(C.c)()?Boolean(!r.isPreview&&(null===(c=r.pageFieldData)||void 0===c?void 0:c.EntityType)):(null===(i=r.pageFieldData)||void 0===i?void 0:i.PageLayoutType)===T.a.Topic,g=r.pageLayoutType===T.a.Space||(null===(u=r.pageFieldData)||void 0===u?void 0:u.PageLayoutType)===T.a.Space;return o.getListMetadataAsync().then(function(o){f.setListSettings(o),n.resetAutoSaveAttempts();var i=o.EnableMinorVersions?"0.1":"1.0";return Object(C.a)()?e._dispatchNewPageActionsDeprecated(t,r.source,r.promotedState,r.pageTemplateId,r.pageFieldData,r.canvasContent1,r.serverWebPartsDataMap,o.EnableModeration?_.SPModerationStatusType.Draft:void 0,i,r.templateFolderName,r.pageLayoutType,r.isPreview,r.previewPageFileName,r.bannerImageUrl,r.publishStartDate):e._dispatchNewPageActions(r,t,o.EnableModeration?_.SPModerationStatusType.Draft:void 0,i)}).then(function(){return r.isPreview?Promise.resolve():s.a.setDisplayModeEditAsync().then(function(){!Object(C.c)()&&l?document.title=E.d:document.title=E.c})}).then(function(){var e,t;if(l)if(Object(C.b)())(n=new URL(v.default.url())).searchParams.append("isNewTopicPage","true"),v.default.pushUrl(Object(C.e)()?n.toString():n.href,void 0,!0);else{var n=v.default.url(),o=v.default.appendUrlParam("isNewTopicPage","true",n);n!==o&&v.default.pushUrl(o,void 0,!0)}else if(m._SPFlight.isEnabled(943)&&g){var i=null===(e=r.pageFieldData)||void 0===e?void 0:e.Title,s=null===(t=r.pageFieldData)||void 0===t?void 0:t.Description;i&&(a.a.actions.fieldActions.addFieldToUpdate(A.a.Title,i),a.a.actions.fieldActions.commitTitle()),s&&a.a.actions.fieldActions.addFieldToUpdate(A.a.Description,s)}}).catch(function(e){s.a.showError(e.message)})})})})},e.createNewCrossSitePage=function(e,t){return m.Validate.isNonemptyString(t.crossSiteUrl,"crossSiteUrl"),this.createNewPage(e,t)},e._dispatchNewPageActions=function(e,t,r,n){var o=!!e.templateFolderName;return a.a.instance.autoSaver&&a.a.instance.autoSaver.resetAutoSaveAttempts(),g.a.createNewPage(e,r,n,e.templateFolderName).then(function(){if(s.a.setSaveStatus(_.PageSaveStatus.Draft),g.a.setIsTemplate(o),Object(F.a)(1743)&&g.a.setNumMissingRequiredProps(-1),t){var r=!Object(U.w)()&&e.templateFolderName?"SitePages/"+e.templateFolderName:"SitePages",n=m.UrlUtilities.removeEndSlash(a.a.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/"+r+"/"+(e.isPreview?e.previewPageFileName||y.b.previewPageStubFileName:y.b.newPageStubFileName+"?Mode=Edit")+(e.source?"&source="+encodeURIComponent(e.source):"");t.push(n,{isNewPage:!0})}})},e._dispatchNewPageActionsDeprecated=function(e,t,r,n,o,i,c,u,l,d,p,h,P,S,f){var v=!!d;return a.a.instance.autoSaver&&a.a.instance.autoSaver.resetAutoSaveAttempts(),g.a.createNewPageDeprecated(r,n,o,i,c,u,l,d,p,S,f).then(function(){s.a.setSaveStatus(_.PageSaveStatus.Draft),g.a.setIsTemplate(v),Object(F.a)(1743)&&g.a.setNumMissingRequiredProps(-1);var r=!Object(U.w)()&&d?"SitePages/"+d:"SitePages";if(e){var n=m.UrlUtilities.removeEndSlash(a.a.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/"+r+"/"+(h?P||y.b.previewPageStubFileName:y.b.newPageStubFileName+"?Mode=Edit")+(t?"&source="+encodeURIComponent(t):"");e.push(n,{isNewPage:!0})}})},e._extractWebPartIdsFromCanvasContent=function(e){return("string"==typeof e?JSON.parse(e):e).reduce(function(e,t){return t.controlType===w.CanvasControlType.WebPartZone&&e.push({id:t.webPartId}),e},[])},e._loadComponentManifests=function(e){return e&&e.length?new b._ManifestProvider(a.a.instance.serviceScope,a.a.instance.pageContext.legacyPageContext.webAbsoluteUrl).tryGetManifests(e).then(function(e){b._ManifestStore.instance.registerManifests(e,!1)}).catch(function(t){var r=d._LogSource.create("PageCreationActionCreator");d._TraceLogger.logError(r,new Error("Failed to load one or more manifests ["+e.join()+"]"))}):Promise.resolve()},e}();t.default=function(){this.actions={coreActions:s.a,chromeActions:o,navActions:u,fieldActions:p,layoutMappingActions:h,statusActions:P.a,templateActions:S,listActions:f,pageCreationActions:I}}}}]);