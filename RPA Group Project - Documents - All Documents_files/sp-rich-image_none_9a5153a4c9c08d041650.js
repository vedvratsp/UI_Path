define("4e1d8ea3-d90c-46fc-b4a1-367b9bc0046a_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-core-library","@microsoft/sp-page-context","react","react-dom","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,r,n,i,a,o,u,s,c,l,d){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-rich-image_none_9a5153a4c9c08d041650\.js/i;if(t&&t.length)for(var i=0;i<t.length;i++)if(t[i]){var a=t[i].getAttribute("src");if(a&&a.match(n)){e=a.substring(0,a.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}r.p=e}(),r(r.s="mwqp")}({"17wl":function(t,r){t.exports=e},"2q6Q":function(e,r){e.exports=t},"8dK2":function(e,t){e.exports=r},KL1q:function(e,t){e.exports=n},UWqr:function(e,t){e.exports=i},"X+PM":function(e,t){e.exports=a},cDcd:function(e,t){e.exports=o},faye:function(e,t){e.exports=u},gR8q:function(e,t,r){e.exports=r.p+"image_background_stockImage_9fe1b89a.png"},"hiL/":function(e,t){e.exports=s},mwqp:function(e,t,r){"use strict";r.r(t),r.d(t,"PreloadImageHelper",function(){return A}),r.d(t,"STOCK_IMAGE",function(){return R}),r.d(t,"SPImage",function(){return W}),r.d(t,"SPImg",function(){return q}),r.d(t,"useFallback",function(){return p}),r.d(t,"getDefaultServices",function(){return C}),r.d(t,"ImageWithPreAllocate",function(){return M}),r.d(t,"ImageTagPreAllocator",function(){return g}),r.d(t,"PRE_ALLOCATED_IMAGE_KEY",function(){return m});var n=r("17wl"),i=r("cDcd"),a=r("faye"),o=r("UWqr"),u=r("ut3N"),s=r("8dK2"),c=r("hiL/"),l=r("2q6Q");function d(){return o._SPKillSwitch.isActivated("d90f453c-fa57-47ca-bfa4-236ad93d4b23")}var m="_preAllocatedImageTags",g=function(){function e(){}return e.tryConsumePreAllocatedImageTag=function(e){var t,r=null===(t=window[m])||void 0===t?void 0:t[e];return r&&!r.isConsumed?(r.isConsumed=!0,r):void 0},e}(),f=u._LogSource.create("UseImageFallback"),v={},h=!1;function p(e){var t=i.useState(void 0),r=t[0],a=t[1],o=i.useRef(void 0),l=i.useRef([]),m=i.useRef(e.services),g=function(t){(function(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,c,l,d,m,g,p,b;return Object(n.__generator)(this,function(n){switch(n.label){case 0:if(r=t?t.serviceName:void 0,i=[],e.forEach(function(e,t){r?r===t&&(r=void 0):i.push([t,e])}),(a=window._preloadMetadata)&&!h)for(o in h=!0,a)o&&(a[o].isPreLoaded=!0,v[o]=a[o]);c=0,l=i,n.label=1;case 1:if(!(c<l.length))return[3,6];d=l[c],m=d[0],g=d[1],n.label=2;case 2:return n.trys.push([2,4,,5]),[4,g()];case 3:return p=n.sent(),"cdn"===m&&-1!==(null==p?void 0:p.indexOf("AuthVer"))&&-1===(null==p?void 0:p.indexOf("_eat_"))?[2,{serviceName:m,src:p,httpRequest:void 0,duration:0,loadingError:{error:"Unexpected CDN request without auth token"},isPreLoaded:!1,provider:s._ThumbnailProviderType.PrivateCDN}]:p&&p!==(null==t?void 0:t.src)?[2,P(m,p)]:[3,5];case 4:return b=n.sent(),u._TraceLogger.logError(f,b,"getValidNextState"),[3,5];case 5:return c++,[3,1];case 6:return[2,void 0]}})})})(d()?e.services:m.current,t).then(function(e){a(e),e&&l.current.push(e.serviceName)}).catch(function(){return a(void 0)})};if(i.useEffect(function(){d()||(m.current=e.getServices()),g(void 0),o.current=new u._QosMonitor("ImageElementRender."+e.callerId)},[e.thumbnailWidth&&s._PreviewUtility.normalizeWidth(e.thumbnailWidth),e.imageData.imageUrl,e.imageData.uniqueId,e.imageData.webId,e.imageData.listId,e.imageData.cropData]),!r)return{};var p=r.serviceName,_=r.src,T=r.httpRequest,I=r.isPreLoaded,y=r.provider,R=s._ThumbnailUrlGenerator.getThumbnailWidth(_,y),S=s._ThumbnailProviderType[y],E=new u._QosMonitor("ImageElementRenderService."+S),O=new Date;return{src:_,onLoad:function(t){var n,i=(null==T?void 0:T.status)||b(t);null===(n=e.onImageLoad)||void 0===n||n.call(e,t,p),function(e,t,r,n,i,a,o){var u,s=e.serviceName,c=e.src,l=e.httpRequest,d=e.duration,m={service:s,alias:i,duration:d,statusCode:a,isPreLoaded:e.isPreLoaded,flights:w()};if(o&&(m.width=o),n&&(m.fallbacks=n.length),l){var g=l.getResponseHeader("sprequestguid");if(g&&(m.CorrelationId=g),"cdn"===s){var f=l.getResponseHeader("x-cache");f&&("TCP_MISS"===(f=f.split(" ")[0])&&(f="TCP_MISS"===(f=(null===(u=l.getResponseHeader("x-cache-remote"))||void 0===u?void 0:u.split(" ")[0])||f)?f:f+"_REMOTE"),m.CDNCache=f),c.indexOf("/_vti_bin/afdcache.ashx/")>-1&&(m.cacheCountryCode=l.getResponseHeader("x-ccc"))}if("cdn"===s||"vroom"===s){var v=l.getResponseHeader("x-cache-origin");v&&(m.OriginCache=v)}l.response&&(m.size=l.response.size,m.source=l.response.type);var h=l.getResponseHeader("date");if(h){var p=new Date(h),b=r.getTime()-p.getTime();m.responseStatus=b>=2500||b>-500&&d<=10?d<=1?"memoryCacheHit":"coldCacheHit":"cacheMiss"}}t.writeSuccess(m)}(r,E,O,l.current,e.callerId,i,R);var a={isPreLoaded:I,fallbacks:l.current.length,width:R,service:p,statusCode:i,flights:w()};if((null==T?void 0:T.response)&&(a.size=T.response.size,a.source=T.response.type),o.current)if(1===l.current.length)o.current.writeSuccess(a);else{var u=p+" passed",d=1===l.current.length?new Error("Directly loaded full Url: <url>"+Object(c.scrubUrl)(y,_)+"</url>"):new Error("Fallback order: "+l.current.join("->")),m=_?s._PreviewUtility.getFileExtension(new s._SPResourcePath(_)):void 0;"fullImage"===p&&"gif"!==m?o.current.writeUnexpectedFailure(u,d,a):o.current.writeExpectedFailure(u,d,a)}},onError:function(t){var n;null===(n=e.onImageLoadFailure)||void 0===n||n.call(e,p,t),function(e,t,r,n,i,a,o){var u,s=e.serviceName,l=e.src,d=e.duration,m=e.loadingError,g=(null==m?void 0:m.statusCode)?null==m?void 0:m.statusCode:b(i),f=new Error("<url>"+Object(c.scrubUrl)(a,l)+"</url> <statusCode>"+g+"</statusCode> Error:"+(null==m?void 0:m.error)),v={alias:o,statusCode:g};if(d>0&&(v.duration=d),null==m?void 0:m.httpRequest){var h=m.httpRequest.getResponseHeader("sprequestguid"),p=m.httpRequest.getAllResponseHeaders();h&&(v.CorrelationId=h),p&&(v.headers=p)}!function(e){return void 0===e||!(e<=399)&&(e>=500?503!==e:401!==e&&403!==e&&404!==e&&429!==e)}(g)?t.writeExpectedFailure(s+" failed",f,v):t.writeUnexpectedFailure(s+" failed",f,v),"stockImage"===s&&(null===(u=r.current)||void 0===u||u.writeUnexpectedFailure("stock failed",new Error("services failed: "+n.current.join("->"))))}(r,E,o,l,t,y,e.callerId),g(r)}}}function b(e){if(e){var t=e.currentTarget;return Boolean(t.src&&t.src.indexOf("encodeFailures=1")>=0)&&1===t.naturalWidth&&t.naturalHeight>6e4?t.naturalHeight-6e4:void 0}}function P(e,t){var r,i,a;return Object(n.__awaiter)(this,void 0,void 0,function(){var c,l,d,g,h,p,b,P,w,I,y,R,S,E;return Object(n.__generator)(this,function(n){switch(n.label){case 0:if(d=-1,g=new s._SPResourcePath(t),h=s._ThumbnailUrlGenerator.getThumbnailProvider(t),(null===(r=g.domain)||void 0===r?void 0:r.indexOf("-my.sharepoint"))>-1)return[3,11];p="cdn"===e&&(_(g)||T(g)),b={},d=performance.now(),p&&(t=function(e,t){var r=[],n=new s._SPResourcePath(e);return T(n)&&(r.push("P1"),r.push("P2"),r.push("P3"),r.push("P4")),_(n)&&(r.push("_eat_"),r.push("_oat_")),r.forEach(function(e){var r=n.getQueryParameter(e);if(r){if(n.removeQueryParameter(e),o._SPFlight.isEnabled(60041))switch(e){case"P1":e="X-MSEdge-TluExpiration";break;case"P2":e="X-MSEdge-TluKeyNumber";break;case"P3":e="X-MSEdge-TluAlgorithmId";break;case"P4":e="X-MSEdge-TluSignature"}t[e]=r}}),n.toString()}(t,b)),n.label=1;case 1:return n.trys.push([1,9,,10]),v[t]?[3,3]:(P=function e(t,r){return new Promise(function(n,i){var a=new XMLHttpRequest;for(var o in a.open("GET",t),r)r.hasOwnProperty(o)&&a.setRequestHeader(o,r[o]);a.responseType="blob",a.onload=function(){if(a.status>=200&&a.status<300&&a.response)return n(a);var t=a.getResponseHeader("location");t&&a.status>=300&&a.status<400?e(t).then(n).catch(i):i({httpRequest:a,statusCode:a.status,error:"Request Failed"})},a.onerror=function(){return i({httpRequest:a,statusCode:void 0,error:"Network Failed"})},a.send()})}(t,b),v[t]=P,[4,P]);case 2:return l=n.sent(),w={httpRequest:l,duration:performance.now()-d,isPreLoaded:!1},v[t]=w,p&&(null==l?void 0:l.response)&&(w.blobUrl=URL.createObjectURL(l.response)),[2,{serviceName:e,src:w.blobUrl||t,httpRequest:l,duration:w.duration,loadingError:c,isPreLoaded:w.isPreLoaded,provider:h}];case 3:return v[t]?(I=v[t],Promise.resolve(I)!==I?[3,5]:[4,I]):[3,8];case 4:n.sent(),n.label=5;case 5:return(y=v[t]).httpRequest.readyState<4?(R=y.duration,[4,new Promise(function(e,t){y.httpRequest.onloadend=function(){y.duration=performance.now()-R,y.httpRequest.status&&y.httpRequest.status<400?e(y.httpRequest):t(y.httpRequest)}})]):[3,7];case 6:n.sent(),n.label=7;case 7:return!(S=!!function(e){var t,r,n;return null===(n=null===(r=null===(t=window[m])||void 0===t?void 0:t[e])||void 0===r?void 0:r.imageElement)||void 0===n?void 0:n.src}(t))&&p&&!y.blobUrl&&(null===(i=y.httpRequest)||void 0===i?void 0:i.response)&&(y.blobUrl=URL.createObjectURL(null===(a=y.httpRequest)||void 0===a?void 0:a.response)),[2,{serviceName:e,src:!S&&y.blobUrl||t,httpRequest:y.httpRequest,duration:y.duration,loadingError:c,isPreLoaded:y.isPreLoaded,provider:h}];case 8:return[3,10];case 9:return E=n.sent(),u._TraceLogger.logError(f,E,"_generateStateFromSrc"),c=E,[3,10];case 10:d=performance.now()-d,n.label=11;case 11:return[2,{serviceName:e,src:t,httpRequest:l,duration:d,loadingError:c,isPreLoaded:!1,provider:h}]}})})}function _(e){return o._SPFlight.isEnabled(1994)&&"2"===e.getQueryParameter("AuthVer")}function T(e){return o._SPFlight.isEnabled(60041)&&void 0!==e.getQueryParameter("_oat_")&&void 0!==e.getQueryParameter("P1")&&void 0!==e.getQueryParameter("P4")}function w(){var e;if(!o._SPKillSwitch.isActivated("e83bad45-afe1-427f-a4a5-b000e7d5aea1"))return(e=l._PerformanceExperiment.WEXTitleRegionCroppingExperiment)+"_"+l._PerformanceLogger.getExperimentStatusString(l._SPPerfExperiment.getExperimentStatus(o._SPExperiment.getVariantAndLogExposure(e)))}var I=r("X+PM"),y=r("y88i"),R=r("gR8q"),S=r("vlQI"),E=/(\/thumbnails\/\d\/(.*?))\/content.*$/i,O=new Map;function U(e,t,r){if(!e)return!1;if((r=r||s._ThumbnailUrlGenerator.getThumbnailProvider(e))===s._ThumbnailProviderType.VROOMMeTACache){var n=t.consume(I.PageContext.serviceKey),i=new y.Uri(e),a=new y.Uri(n.web.absoluteUrl);if(!O.has(e)){for(var o=n.legacyPageContext.multiGeoInfo,u=!1,c=0;c<o.length;c++){var l=new y.Uri(o[c].PortalUrl),d=new y.Uri(o[c].MySiteHostUrl);if(i.getHost()===l.getHost()||i.getHost()===d.getHost()){u=!0;break}}O.set(e,u)}return Boolean(O.get(e)&&i.getHost()!==a.getHost())}return!1}function x(e,t){if(!e)return Promise.resolve(void 0);var r=new y.Uri(e).getLeftPart(1),n=new S.AadHttpClient(t,r,{configuration:S._AadTokenProviders.preAuthorizedConfiguration}),i=new Headers;i.append("accept","application/json; odata.metadata=minimal"),i.append("odata-version","4.0");var a=new u._QosMonitor("CrossGeoThumbnail.getCrossGeoThumbnailUrl");return n.get(e.replace(E,"$1"),S.AadHttpClient.configurations.v1,{headers:i}).then(function(e){if(e.status>=200&&e.status<300)return e.json();throw new Error(JSON.stringify(e))}).then(function(e){return a.writeSuccess(),e.url}).catch(function(e){throw a.writeUnexpectedFailure("FailedToGet",e),e})}var L=u._LogSource.create("ImageFallbackHelper");function C(e){var t=this,r=new Map,i=function(e){var t=e.imageData,r=t.cropData,n=t.imageNaturalHeight,i=t.imageNaturalWidth,a=t.imageUrl,o=t.listId,u=t.siteId,c=t.uniqueId,l=t.webId,d=t.cropMode;if(a){var m=s._PreviewUtility.getFileExtension(new s._SPResourcePath(a)),g={absoluteUrl:e.serviceScope&&e.serviceScope.consume(I.PageContext.serviceKey).web.absoluteUrl,callerId:e.callerId,fileType:m,height:e.thumbnailHeight,listId:o,originalHeight:n,originalWidth:i,siteId:u,spResource:a,uniqueId:c,webId:l,width:e.thumbnailWidth,cropMode:d};return r&&function(e){var t=e.cropData;return void 0!==t&&t.x>=0&&t.y>=0&&t.width>0&&t.height>0&&!function(e){var t=e.cropData,r=e.imageNaturalHeight,n=e.imageNaturalWidth;return void 0!==t&&0===t.x&&0===t.y&&t.width>0&&t.height>0&&t.width===n&&t.height===r}(e)}(e.imageData)&&(g.viewportLeft=r.x,g.viewportTop=r.y,g.viewportWidth=r.width,g.viewportHeight=r.height),g}}(e);if(!i)return r;var a=i.spResource?c.DefaultImageHelper.getDefaultImage(new s._SPResourcePath(i.spResource)):void 0,o=s._ThumbnailUrlGenerator.getThumbnailUrl(i,a)||"",l=s._ThumbnailUrlGenerator.getThumbnailProvider(o);return l===s._ThumbnailProviderType.PublicCDN||l===s._ThumbnailProviderType.PrivateCDN||l===s._ThumbnailProviderType.AFDPrivateCDN?(r.set("cdn",function(){return Promise.resolve(o)}),r.set("vroom",function(){return Object(n.__awaiter)(t,void 0,void 0,function(){var t;return Object(n.__generator)(this,function(r){return U(t=s._ThumbnailUrlGenerator.getVROOMThumbnailUrl(i),e.serviceScope,s._ThumbnailProviderType.VROOMMeTACache)?[2,x(t,e.serviceScope)]:[2,t]})})}),r.set("docViz",function(){return Promise.resolve(s._ThumbnailUrlGenerator.getDocVizUrl(i))}),r.set("fullImage",function(){return Promise.resolve(F(o,i))}),r.set("stockImage",function(){return Promise.resolve(R)})):l===s._ThumbnailProviderType.VROOMMeTACache?(r.set("vroom",function(){return U(o,e.serviceScope,s._ThumbnailProviderType.VROOMMeTACache)?Promise.resolve(x(o,e.serviceScope)):Promise.resolve(o)}),r.set("docViz",function(){return Promise.resolve(s._ThumbnailUrlGenerator.getDocVizUrl(i))}),r.set("fullImage",function(){return Promise.resolve(F(o,i))}),r.set("stockImage",function(){return Promise.resolve(R)})):l===s._ThumbnailProviderType.DocViz?(r.set("docViz",function(){return Promise.resolve(o)}),r.set("fullImage",function(){return Promise.resolve(F(o,i))}),r.set("stockImage",function(){return Promise.resolve(R)})):l===s._ThumbnailProviderType.Stock||l===s._ThumbnailProviderType.HubbleStock||l===s._ThumbnailProviderType.HubbleStockThumbnail||l===s._ThumbnailProviderType.SPOLayoutsImage?(r.set("staticImage",function(){return Promise.resolve(o)}),r.set("stockImage",function(){return Promise.resolve(R)})):l===s._ThumbnailProviderType.MediaCDNHubble||l===s._ThumbnailProviderType.MediaCDNDefault||l===s._ThumbnailProviderType.MediaCDNLayoutsImage?(r.set("optimalStaticImage",function(){return Promise.resolve(o)}),r.set("staticImage",function(){return Promise.resolve(a||i.spResource)}),r.set("stockImage",function(){return Promise.resolve(R)})):l===s._ThumbnailProviderType.External?(r.set("external",function(){return Promise.resolve(o)}),r.set("stockImage",function(){return Promise.resolve(R)})):(u._TraceLogger.logError(L,new Error("_ThumbnailUrlGenerator is providing an unexpected type of url")),r.set("fullImage",function(){return Promise.resolve(o)}),r.set("stockImage",function(){return Promise.resolve(R)})),r}function F(e,t){if(e!==t.spResource&&t.spResource){var r=s._ThumbnailUrlGenerator.getThumbnailProvider(t.spResource),n=t.spResource;if(r===s._ThumbnailProviderType.PublicCDN||r===s._ThumbnailProviderType.PrivateCDN||r===s._ThumbnailProviderType.AFDPrivateCDN)n="https://"+new y.Uri(t.spResource).getPathSegments().join("/");else if(r===s._ThumbnailProviderType.DocViz&&-1!==t.spResource.indexOf("path="))if(o._SPKillSwitch.isActivated("caeddc7b-74b5-4a56-9076-083cdaa21110")){var i=new y.Uri(t.spResource);n=t.spResource.split("/_layouts/15/getPreview.aspx")[0]+i.getQueryParameter("path")}else{var a=new s._SPResourcePath(t.spResource),u=t.spResource.toLowerCase().indexOf("/_layouts/15/getpreview.ashx");n=(u>-1?t.spResource.substring(0,u):a.authority)+a.getQueryParameter("path")}else r!==s._ThumbnailProviderType.SharePointHost&&r!==s._ThumbnailProviderType.MySite||(n=s._ThumbnailUrlGenerator.updateThumbnailWidth(n,t.width||s._PreviewUtility.smallestBreakPointWidth));return n}}var D=r("KL1q");function j(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{target:t,currentTarget:t,nativeEvent:e,isDefaultPrevented:function(){return!1},isPropagationStopped:function(){return!1},persist:function(){}})}var H={display:"none"};function M(e){if(!e.src)return null;var t=e.imgTagFallbackOptions,r=e.objectFit,a=e.imageFit,u=Object(n.__rest)(e,["imgTagFallbackOptions","objectFit","imageFit"]),s=i.createRef(),c=i.createRef(),l=i.createRef(),d=i.useMemo(function(){return e.src?g.tryConsumePreAllocatedImageTag(e.src):void 0},[e.src]);i.useLayoutEffect(function(){var n,i,a=c.current;if(s.current&&a&&d){var o=d.imageElement,u=d.loadEvent;if(a.getAttributeNames)a.getAttributeNames().forEach(function(e){o.setAttribute(e,a.getAttribute(e))});else if(a.hasAttributes())for(var m=a.attributes,g=0;g<m.length;g++)o.setAttribute(m[g].name,m[g].value);r&&(o.style.objectFit=r);var f=function(t){var r;return null===(r=e.onLoad)||void 0===r?void 0:r.call(e,j(t,o))};o.parentElement||(s.current.appendChild(o),null===(n=null==t?void 0:t.imgRef)||void 0===n||n.call(t,o),u?f(u):(o.onload=f,o.onerror=function(t){var r;return null===(r=e.onError)||void 0===r?void 0:r.call(e,j(t,o))}))}else l.current&&t&&(null===(i=t.imgRef)||void 0===i||i.call(t,l.current))}),(o._SPFlight.isEnabled(60041)||o._SPFlight.isEnabled(1994))&&i.useEffect(function(){return function(){var t;(null===(t=e.src)||void 0===t?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.src)}},[]);var m=Object(D.getNativeElementProps)("img",u,["src","onLoad","onError"]);return d?i.createElement("div",{role:"presentation"},i.createElement("div",{ref:s,role:"presentation"}),i.createElement("div",{style:H,"aria-hidden":"true"},i.createElement("img",Object(n.__assign)({ref:c},m)))):e.imgTagFallbackOptions?i.createElement("img",Object(n.__assign)({},u,{ref:l})):i.createElement(D.Image,Object(n.__assign)({imageFit:a},u))}var k,q=function(e){var t=e.callerId,r=e.cdnBaseUrls,a=e.imageData,u=e.onImageLoad,s=e.onImageLoadFailure,c=e.serviceScope,l=e.thumbnailWidth,m=e.thumbnailHeight,g=e.renderedInDetachedDOM,f=e.imgRef,v=Object(n.__rest)(e,["callerId","cdnBaseUrls","imageData","onImageLoad","onImageLoadFailure","serviceScope","thumbnailWidth","thumbnailHeight","renderedInDetachedDOM","imgRef"]),h={callerId:t,cdnBaseUrls:r,imageData:a,serviceScope:c,thumbnailWidth:l,thumbnailHeight:m},b=p({onImageLoad:u,onImageLoadFailure:s,imageData:a,callerId:t,thumbnailWidth:l,services:d()?C(h):void 0,getServices:function(){return C(h)}}),P=i.useCallback(function(e){return null==f?void 0:f(e)},[f]);return(o._SPFlight.isEnabled(60041)||o._SPFlight.isEnabled(1994))&&i.useEffect(function(){return function(){var e;(null===(e=b.src)||void 0===e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(b.src)}},[]),g?i.createElement("img",Object(n.__assign)({},v,b,{ref:P})):i.createElement(M,Object(n.__assign)({imgTagFallbackOptions:{imgRef:f}},v,b))},A=function(){function e(){}return e.loadImage=function(e){return new Promise(function(t,r){var n=document.createElement("img");n.onload=function(e){t(n)},n.onerror=function(e){r(e)},n.setAttribute("src",e)})},e.readImageRatio=function(t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,e.loadImage(t)];case 1:return[2,(r=n.sent()).naturalWidth/r.naturalHeight]}})})},e.loadThumbnailImage=function(e){return new Promise(function(t,r){var o=document.createElement("div");a.render(i.createElement(q,Object(n.__assign)(Object(n.__assign)({},e),{onImageLoad:function(e){t(null==e?void 0:e.target),a.unmountComponentAtNode(o)},onImageLoadFailure:function(e,t){"stockImage"===e&&(r(e),a.unmountComponentAtNode(o))},renderedInDetachedDOM:!0})),o)})},e.readThumbnailImageRatio=function(t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,e.loadThumbnailImage(t)];case 1:return[2,(r=n.sent()).naturalWidth/r.naturalHeight]}})})},e}(),N=((k={})[D.ImageFit.cover]="cover",k[D.ImageFit.center]="none",k[D.ImageFit.centerContain]="scale-down",k[D.ImageFit.contain]="contain",k),W=function(e){var t=e.callerId,r=e.cdnBaseUrls,a=e.imageData,u=e.onImageLoad,s=e.onImageLoadFailure,c=e.serviceScope,l=e.thumbnailWidth,m=e.imageFit,g=e.thumbnailHeight,f=Object(n.__rest)(e,["callerId","cdnBaseUrls","imageData","onImageLoad","onImageLoadFailure","serviceScope","thumbnailWidth","imageFit","thumbnailHeight"]),v={callerId:t,cdnBaseUrls:r,imageData:a,serviceScope:c,thumbnailWidth:l,thumbnailHeight:o._SPFlight.isEnabled(630)&&o._SPExperiment.getVariantAndLogExposure(90070)>0?g:void 0},h=p({onImageLoad:u,onImageLoadFailure:s,imageData:a,callerId:t,thumbnailWidth:l,thumbnailHeight:g,services:d()?C(v):void 0,getServices:function(){return C(v)}}),b=o._BrowserDetection.getBrowserInformation().browser!==o._Browser.IE&&(void 0===m||void 0!==N[m]);return(o._SPFlight.isEnabled(60041)||o._SPFlight.isEnabled(1994))&&i.useEffect(function(){return function(){var e;(null===(e=h.src)||void 0===e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(h.src)}},[]),b?i.createElement(M,Object(n.__assign)({},f,h,{imageFit:m,objectFit:m?N[m]:void 0})):i.createElement(D.Image,Object(n.__assign)({},f,h,{imageFit:m}))}},ut3N:function(e,t){e.exports=c},vlQI:function(e,t){e.exports=l},y88i:function(e,t){e.exports=d}})});