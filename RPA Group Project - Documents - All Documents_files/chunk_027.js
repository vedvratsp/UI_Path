(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_13_0||[]).push([[3],{X7FI:function(e,t,i){"use strict";i.r(t),i.d(t,"MsalTokenProvider",function(){return c});var n=i("17wl"),r=i("ut3N"),a=i("jtSf"),o=i("UWqr"),s=i("MGiw"),l=i("nUPw"),u=i("+3E/"),d=i("52lI"),c=function(){function e(e){this._defaultConfiguration=e,this._requestMap=new Map,this._msalInstance=this._initializeMsalJs(),o._SPFlight.isEnabled(1887)||(this._defaultConfiguration.aadInstanceUrl="https://login.microsoftonline.com")}return e.prototype.getToken=function(e,t){var i=this;if(void 0===t&&(t=!0),u.a.isReturnTokenDataEnabled())return this.getTokenData(e,t).then(function(e){return e.accessToken});var n=new r._QosMonitor("MsalTokenProvider.GetToken"),a=this._generateTelemetryExtraData();if(u.a.isLogAadAdditionalTelemetryEnabled()&&a.isInternal&&(a.name=e),!o._SPFlight.isEnabled(1887)&&!this._defaultConfiguration.userPrincipalName){var s=new Error("MSAL does not support silent auth without login hint");return n.writeExpectedFailure(s.message,s,a),Promise.reject(s)}var l,d=o._BrowserDetection.getBrowserInformation().browser;return l=d===o._Browser.IE||d===o._Browser.Edge?this._loginSilent().then(function(){return i._acquireToken(e)}):this._acquireToken(e),a.CorrelationId=this._defaultConfiguration.spRequestGuid||o.Guid.newGuid().toString(),l.then(function(e){return n.writeSuccess(a),e}).catch(function(t){return i._handleAuthErrors(n,t,a,e)})},e.prototype.getTokenData=function(e,t){var i=this;void 0===t&&(t=!0);var n=new r._QosMonitor("MsalTokenProvider.GetTokenData"),a=this._generateTelemetryExtraData();if(u.a.isLogAadAdditionalTelemetryEnabled()&&a.isInternal&&(a.name=e),!o._SPFlight.isEnabled(1887)&&!this._defaultConfiguration.userPrincipalName){var s=new Error("MSAL does not support silent auth without login hint");return n.writeExpectedFailure(s.message,s,a),Promise.reject(s)}var l,d=o._BrowserDetection.getBrowserInformation().browser;return l=d===o._Browser.IE||d===o._Browser.Edge?this._loginSilent().then(function(){return i._acquireTokenData(e)}):this._acquireTokenData(e),a.CorrelationId=this._defaultConfiguration.spRequestGuid||o.Guid.newGuid().toString(),l.then(function(e){return n.writeSuccess(a),e}).catch(function(t){return i._handleAuthErrors(n,t,a,e)})},e.prototype._loginSilent=function(){var e=new r._QosMonitor("MsalTokenProvider.GetIdToken");return this._loginSilentHelper(0,e)},e.prototype._loginSilentHelper=function(e,t){var i,n=this;e>0&&(i=new r._QosMonitor("MsalTokenProvider.RetryGetIdToken"));var a=this._generateTelemetryExtraData(),s={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:a.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[this._defaultConfiguration.servicePrincipalId]};return o._SPFlight.isEnabled(1887)&&0===e&&(s.sid=this._defaultConfiguration.aadSessionId,s.loginHint=void 0),this._msalInstance.acquireTokenSilent(s).then(function(e){return a.alias=e.fromCache.toString(),u.a.isAdditionalMsalTelemetryEnabled()&&(a.jsonExtraData=JSON.stringify(n._requestMap.get(a.CorrelationId))),t.writeSuccess(a),e.accessToken}).catch(function(r){if(u.a.isAdditionalMsalTelemetryEnabled()&&(a.jsonExtraData=JSON.stringify(n._requestMap.get(a.CorrelationId))),null==i||i.writeUnexpectedFailure(r.errorCode,r,a),u.a.isRetryIdTokenWithLoginHintEnabled()&&l.a._isInteractionRequired(r.message,r.errorCode)&&e<1)return n._loginSilentHelper(++e,t);n._handleAuthErrors(t,r,a,n._defaultConfiguration.servicePrincipalId)})},e.prototype._acquireToken=function(e){var t=new r._QosMonitor("MsalTokenProvider.GetAccessToken");return this._acquireTokenHelper(e,0,t)},e.prototype._acquireTokenHelper=function(e,t,i,n){var a,s=this;void 0===n&&(n=!1),t>0&&(a=n?new r._QosMonitor("MsalTokenProvider.RetryLoginHintGetAccessToken"):new r._QosMonitor("MsalTokenProvider.RetryGetAccessToken"));var d=this._generateTelemetryExtraData(),c={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:d.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[e+"/.default"]};return o._SPFlight.isEnabled(1887)&&!n&&(c.sid=this._defaultConfiguration.aadSessionId,c.loginHint=void 0),this._msalInstance.acquireTokenSilent(c).then(function(e){return d.alias=e.fromCache.toString(),u.a.isAdditionalMsalTelemetryEnabled()&&(d.jsonExtraData=JSON.stringify(s._requestMap.get(d.CorrelationId))),i.writeSuccess(d),null==a||a.writeSuccess(d),e.accessToken}).catch(function(n){return u.a.isAdditionalMsalTelemetryEnabled()&&(d.jsonExtraData=JSON.stringify(s._requestMap.get(d.CorrelationId))),null==a||a.writeUnexpectedFailure(n.errorCode,n,d),u.a.isRetryTimeoutsEnabled()&&l.a._isTokenRenewalTimeout(n.errorCode)&&t<1||u.a.isRetryOnResolveEndpointsFailureEnabled()&&l.a._isEndpointsResolutionError(n.errorCode)&&t<1?s._acquireTokenHelper(e,++t,i):u.a.isRetryWithLoginHintEnabled()&&(!u.a.isBlockLoginHintForGuestsEnabled()||s._defaultConfiguration.userPrincipalName)&&l.a._isInteractionRequired(n.message,n.errorCode)&&t<1?s._acquireTokenHelper(e,++t,i,!0):void s._handleAuthErrors(i,n,d,e)})},e.prototype._acquireTokenData=function(e){var t=new r._QosMonitor("MsalTokenProvider.GetAccessTokenData");return this._acquireTokenDataHelper(e,0,t)},e.prototype._acquireTokenDataHelper=function(e,t,i,n){var a,s=this;void 0===n&&(n=!1),t>0&&(a=n?new r._QosMonitor("MsalTokenProvider.RetryLoginHintGetAccessToken"):new r._QosMonitor("MsalTokenProvider.RetryGetAccessToken"));var d=this._generateTelemetryExtraData(),c={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:d.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[e+"/.default"]};return o._SPFlight.isEnabled(1887)&&!n&&(c.sid=this._defaultConfiguration.aadSessionId,c.loginHint=void 0),this._msalInstance.acquireTokenSilent(c).then(function(e){return d.alias=e.fromCache.toString(),u.a.isAdditionalMsalTelemetryEnabled()&&(d.jsonExtraData=JSON.stringify(s._requestMap.get(d.CorrelationId))),i.writeSuccess(d),null==a||a.writeSuccess(d),e}).catch(function(n){return u.a.isAdditionalMsalTelemetryEnabled()&&(d.jsonExtraData=JSON.stringify(s._requestMap.get(d.CorrelationId))),null==a||a.writeUnexpectedFailure(n.errorCode,n,d),u.a.isRetryTimeoutsEnabled()&&l.a._isTokenRenewalTimeout(n.errorCode)&&t<1||u.a.isRetryOnResolveEndpointsFailureEnabled()&&l.a._isEndpointsResolutionError(n.errorCode)&&t<1?s._acquireTokenDataHelper(e,++t,i):u.a.isRetryWithLoginHintEnabled()&&(!u.a.isBlockLoginHintForGuestsEnabled()||s._defaultConfiguration.userPrincipalName)&&l.a._isInteractionRequired(n.message,n.errorCode)&&t<1?s._acquireTokenDataHelper(e,++t,i,!0):void s._handleAuthErrors(i,n,d,e)})},e.prototype._initializeMsalJs=function(){var e,t=this;return e=o._SPFlight.isEnabled(467)?{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!0,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1,authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId},system:{loadFrameTimeout:1e4,navigateFrameWait:0}}:{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!1,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1},system:{loadFrameTimeout:1e4,navigateFrameWait:0}},u.a.isAdditionalMsalTelemetryEnabled()&&(e.system.telemetry={applicationName:this._defaultConfiguration.servicePrincipalId,applicationVersion:"1.0",telemetryEmitter:function(e){var i="",r={};e.forEach(function(e){"msal.api_event"===e["msal.event_name"]?(i=e["Microsoft.MSAL.correlation_id"],r=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r),t._requestMap.get(i)),e)):"msal.default_event"===e["msal.event_name"]&&(r=Object(n.__assign)(Object(n.__assign)({},r),{"msal.effective_connection_speed":e["msal.effective_connection_speed"]}))}),t._requestMap.set(i,r)}}),new d.a(e)},e.prototype._generateTelemetryExtraData=function(){return{alias:"false",CorrelationId:o.Guid.newGuid().toString(),isInternal:this._defaultConfiguration.servicePrincipalId===s.a.PRE_AUTHORIZED_APP_PRINCIPAL_ID,jsonExtraData:""}},e.prototype._cancelRedirect=function(){this._redirectCancelled=!0},e.prototype._handleAuthErrors=function(e,t,i,n){var r=this,d=o._BrowserDetection.getBrowserInformation().userAgent||"";if(o._SPFlight.isEnabled(467)&&l.a._isInteractionRequired(t.message,t.errorCode)&&o._Browser.IE!==o._BrowserDetection.getBrowserInformation().browser){var c=new Date,_=window.sessionStorage.getItem("msalRedirectFirstAttempTime"),f=!1,g=1;if(_){var h=new Date(_);if(c.getTime()-h.getTime()<6e4){var E=window.sessionStorage.getItem("msalRedirectAttempNumber");E&&(g=parseInt(E,10),g++,f=!0)}}if(f||window.sessionStorage.setItem("msalRedirectFirstAttempTime",c.toString()),g<7){e.writeExpectedFailure(t.errorCode,t,i),window.sessionStorage.setItem("msalRedirectAttempNumber",g.toString()),window.sessionStorage.setItem("msalRedirectClientId",this._defaultConfiguration.servicePrincipalId);var p={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:i.CorrelationId,scopes:[n+"/.default"],state:window.location.href,onRedirectNavigate:function(e){return r._redirectCancelled=!1,o._SPEventManager.instance.raiseEvent(a.c._onBeforeRedirectEventId,new a.a(e,r._cancelRedirect.bind(r))),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(r._redirectCancelled=!0),!r._redirectCancelled}};if(u.a.isBlockLoginHintForGuestsEnabled()&&!this._defaultConfiguration.userPrincipalName||(p.loginHint=this._defaultConfiguration.userPrincipalName),!u.a.isBlockLoginHintForGuestsEnabled()||this._defaultConfiguration.userPrincipalName||this._msalInstance.getAccount())this._msalInstance.acquireTokenRedirect(p);else{var m={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:i.CorrelationId,scopes:[n+"/.default"],redirectUri:this._defaultConfiguration.redirectUri,state:window.location.href};this._msalInstance.loginRedirect(m)}}else e.writeUnexpectedFailure(t.errorCode,t,i)}else l.a._doesAadErrorCodeExist(t.message,s.a.EXPECTED_AAD_ERRORS)||d.indexOf("TabStop/1.0")>-1?e.writeExpectedFailure(t.errorCode,t,i):e.writeUnexpectedFailure(t.errorCode,t,i);throw t},e}()},nUPw:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("jtSf"),r=i("MGiw"),a=i("UWqr"),o=i("NJ9J"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,i,s){e._doesAadErrorCodeExist(i,r.a.UNRESOLVABLE_AAD_ERROR_CODES)||r.a.RESOLVABLE_ERROR_CODES.forEach(function(e){if(i.indexOf(e)>-1){var r=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";a._SPEventManager.instance.raiseEvent(n.c._tokenAcquisitionEventId,new n.b(o.a,r))}})},e._isInteractionRequired=function(t,i){return!e._doesAadErrorCodeExist(t,r.a.UNRESOLVABLE_AAD_ERROR_CODES)&&r.a.RESOLVABLE_ERROR_CODES.has(i)},e._isTokenRenewalTimeout=function(e){return e===r.a.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===r.a.ENDPOINTS_RESOLUTION_ERROR},e._doesAadErrorCodeExist=function(e,t){for(var i=0,n=e.match(/(AADSTS)[0-9]+/g)||[];i<n.length;i++){var r=n[i];if(t.has(r))return!0}return!1},e}()}}]);