(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[6],{"81ec":function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("17wl"),n=r("cDcd"),s=r("jOlS");Object(s.loadStyles)([{rawString:".livePersonaCardAdapterRoot_c7f3c290{display:inline-block}\n"}]);var i=r("aoE0"),a=r("v78Q"),p=r("KL1q"),u=r("K9kD"),c=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.makeAdapterConfig=function(){var e=n.props.lpcCallbacks||{};return n.props.addGroupMembersCallback&&(e.addGroupMembers=n.props.addGroupMembersCallback),{pageContext:n.props.pageContext,actionCallBacks:e,dataCallBacks:n.props.lpcCallbacks,clientType:n.props.lpcClientType}},n.state={isReady:!1},t.ensureInitializeLPC(n.makeAdapterConfig()).then(function(){n.setState({isReady:!0})}),n}return Object(o.__extends)(t,e),t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if(e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer)return t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),Promise.resolve();var r=new a.a(e.pageContext),o="Prod";e.pageContext&&(Object(a.b)(e.pageContext)&&(o="Blackforest"),Object(a.c)(e.pageContext)&&(o="GccModerate"));var n=r.getAadAuthTokenGetter(),s={culture:e.pageContext.currentUICultureName,region:r.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:n,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:o};return Object(i.initializeLivePersonaCardAsync)(s).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),e.onSuccess&&e.onSuccess()}).catch(function(t){e.onFailure&&e.onFailure(t)})},t.prototype.render=function(){var e=this,r=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var s=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(o.__assign)({personaInfo:{identifiers:{Smtp:this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.email:void 0),PersonaType:this.props.personaType,LocationId:this.props.locationId},displayName:r?this.props.displayName:void 0,personaCoinColor:r?Object(p.getPersonaInitialsColor)({text:this.props.displayName}):void 0},behavior:Object(o.__assign)(Object(o.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&u.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&u.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return n.createElement(t.LivePersonaCardHoverTargetV2,Object(o.__assign)({},s),this.props.children)}return t.LivePersonaCardHoverTarget?(s=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&u.Engagement.logData(e.props.loggingData),e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}}),n.createElement(t.LivePersonaCardHoverTarget,Object(o.__assign)({},s),this.props.children)):n.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)},t.LivePersonaCardHoverTarget=void 0,t.LivePersonaCardHoverTargetV2=void 0,t._logResult=function(e,t,r){},t}(p.BaseComponent)},Ddmm:function(e,t,r){"use strict";r.r(t),r.d(t,"TokenFetchServerErrorCodes",function(){return o}),r("qkfK");var o,n=r("K9kD");!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(o||(o={}));var s=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var r=new n.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return r.end({resultType:n.ResultTypeEnum.Success}),e},function(e){return r.end({resultType:n.ResultTypeEnum.Failure}),n.Promise.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var r=new n.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return r.end({resultType:n.ResultTypeEnum.Success}),e},function(e){return r.end({resultType:n.ResultTypeEnum.Failure}),n.Promise.reject(e)})},e}();t.default=s},Gu0Z:function(e,t,r){"use strict";r.r(t);var o,n=r("17wl"),s=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(o||(o={}));var i=function(e){function t(r,o){var n=e.call(this,o.message)||this;return n.__proto__=t.prototype,n._type=r,n._httpResponseStatus=o.httpResponseStatus,n._cultureName=o.cultureName,n._message=o.message,n._serverErrorCode=o.serverErrorCode,n._correlationId=o.correlationId,n._redirectUrl=o.redirectUrl,n}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==o.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0}),t}(Error),a=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var r=this;this._receiveMediaServiceFlushedToken();var o=this._getCachedTokenData(e);if(o&&!this._isExpiring(o)){var n={token:o.accessToken,isGuest:!1,expirationTimeMs:o.expiresOn};return Promise.resolve({tokenInfo:n,spRequestId:o.correlationId,spRequestTimestamp:o.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){return r._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var r=this._resourceKeys.indexOf(t);!isNaN(r)&&r>-1&&this._resourceKeys.splice(r)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!0,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,r,n){var s=this,a=this._context.qosMonitor(),p=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,n)).then(function(u){if(200!==u.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+u.statusText);var c=new i(o.unknownError,{httpResponseStatus:u.status,message:u.statusText,correlationId:e._getCorrelationId(u)});return 400!==u.status?(a.writeUnexpectedFailure("UnknownError",c),Promise.reject(c)):u.json().then(function(o){var i=e._extractRealError(o),p=s._getErrorCodeFromResponseCode(i);if(!s._isRetriableError(p)||0===r){var u=s._buildErrorFromResponse(i);return a.writeUnexpectedFailure("SharepointServerError",u),Promise.reject(u)}return s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+r),s._retriableFetchWithDigest(t,r-1,n)})}return s._instrumentedParseResponseData(u,a,p)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var r=new Headers;r.append("Content-Type","application/json; charset=utf-8"),r.append("Odata-Version","4.0"),r.append("Accept","application/json;odata.metadata=minimal");var o={method:"POST",headers:r,body:JSON.stringify(this._buildRequestBody(e))},n=t;return n&&n.lastIndexOf("/")===n.length-1&&(n=n.substr(0,n.length-1)),new Request(n+s.apiUrl,o)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,r,n=this._getErrorCodeFromResponseCode(e);return void 0===n?new i(o.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId}):(e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,r=e.message.lang)),new i(o.serverError,{httpResponseStatus:400,message:t,cultureName:r,serverErrorCode:n,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]}))},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,r=Number(t);if(isNaN(r)&&"string"==typeof e.message){var o=t.indexOf(",");-1!==o&&(r=Number(t.substr(0,o)))}return r},e.prototype._instrumentedParseResponseData=function(t,r,n){try{return t.json().then(function(o){return r.writeSuccess(),{accessToken:o.access_token,expiresOn:Number(o.expires_on),notBefore:Number(o.not_before),resource:o.resource,tokenType:o.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:n}})}catch(n){return r.writeUnexpectedFailure("ResponseParseError",n),Promise.reject(new i(o.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,r=this._resourceKeys;t<r.length;t++){var o=r[t];window.sessionStorage.removeItem(o)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),p=r("dq6a"),u=r("K9kD"),c=r("3HEj"),d=function(){function e(){this._qos=new u.Qos({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:u.ResultTypeEnum.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})},e}(),l=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),h=function(e){function t(t,r){var o=e.call(this,{},{pageContext:t})||this;return o.logger=new l,r&&(r.logger&&(o.logger=r.logger),r.useAbsoluteUrlForOAuth&&(o._useAbsoluteUrlForOAuth=r.useAbsoluteUrlForOAuth)),o._oAuthUtility=new a(o),o}return Object(n.__extends)(t,e),t.prototype.qosMonitor=function(){return new d},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(c.c)(this._pageContext)},enumerable:!0,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(r){var o=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return r},"POST",t._getRequestHeadersDictionary(e),o,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,r={};return t.forEach(function(e,t){r[t]=e}),r},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,r){e.then(function(e){t(e)},function(e){r(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new u.Promise(function(t,r){e.then(function(e){t(e)},function(e){r(e)})})},t}(p.b);t.default=h},QVYh:function(e,t,r){var o=r("K9kD");e.exports=o.SPAlternativeUrls},"Wv/s":function(e,t,r){"use strict";r.r(t),r.d(t,"SpLivePersonaCard",function(){return p});var o=r("17wl"),n=r("cDcd"),s=r("KL1q"),i=r("QVYh"),a=r("81ec"),p=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,n.props.pageContext,n.props.lpcCallbacks)},n}return Object(o.__extends)(t,e),t.makeSpLpcCallbacks=function(e,t,r){return Object(o.__assign)(Object(o.__assign)({},r||{}),{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp&&t?t(Object(i.getUserPhotoUrl)(e.Smtp,3)):t()},addGroupMembers:e})},t.prototype.render=function(){return n.createElement(a.a,{personaType:this.props.personaType,email:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex,lpcClientType:this.props.lpcClientType},this.props.children)},t}(s.BaseComponent)},v78Q:function(e,t,r){"use strict";r.d(t,"a",function(){return p}),r.d(t,"b",function(){return u}),r.d(t,"c",function(){return c});var o=r("17wl"),n=r("K9kD"),s=r("Ddmm"),i=r("dq6a"),a=r("Gu0Z"),p=function(e){function t(t){var r=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;return r._oAuthTokenProvider=new s.default(null,{oAuthTokenDataSource:new a.default(t)}),r}return Object(o.__extends)(t,e),t.prototype.getRegion=function(){var e=new n.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var r=this._pageContext.farmLabel;if(!r)return e.end({resultType:n.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"}),"";var o=r.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[o]}catch(t){return e.end({resultType:n.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:t}),""}},t.prototype.getAuthTokenGetter=function(e){return void 0===e&&(e=""),this.getAadAuthTokenGetter()},t.prototype.getAadAuthTokenGetter=function(){var e=this,t=this._pageContext.CorrelationId,r="https://loki.delve.office.com/";return u(this._pageContext)&&(r="https://loki.delve.office.de/"),function(o,n){e._oAuthTokenProvider.getInstrumentedToken(r).then(function(e){return o(e.tokenInfo.token,e.spRequestId)}).catch(function(e){var r={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};n(JSON.stringify(r),t)})}},t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"},t}(i.b);function u(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function c(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}}}]);