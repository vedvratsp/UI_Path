(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[32],{"3Ilx":function(e,t,r){"use strict";r.d(t,"a",function(){return l});var i=r("17wl"),n=r("6o44"),o=r("OpjN"),s=r("4AK9"),a=r("K9kD"),u=function(){function e(e,t,r,i,n){this._groupsProvider=e,this._parentGroup=t,this._loadPageFromServerDelegate=r,this._pageSize=i&&"number"==typeof i.pageSize?i.pageSize:20,this._shouldAddOwnershipInformation=!i||(i.ownershipInformation,!1)||i.ownershipInformation,this._userLoginName=n,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var t=this,r=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,r,this._pageSize).then(function(e){return t._processPage(e,r)},function(e){return t.error=e,a.Promise.reject(e)}):a.Promise.reject(void 0)},e.prototype._processPage=function(e,t){var r=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var i=t+this._pageSize>=this.totalNumberOfMembers,n=i?void 0:this._computeGetNextPagePromise(t+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,i),a.Promise.resolve({page:e.membersList.members,getNextPagePromise:n})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){return r._addOwnershipInformationToPage(e,i,t),a.Promise.resolve({page:e.membersList.members,getNextPagePromise:n})}):a.Promise.resolve({page:e.membersList.members,getNextPagePromise:n})},e.prototype._addOwnershipInformationToPage=function(e,t,r){var i=this;if(r&&(this.totalNumberOfOwners=r.totalNumberOfOwners,this._ownersDictionary={},r.ownersList.members.forEach(function(e){e.userId&&(i._ownersDictionary[e.userId]=e)}),this.isOwner=r.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=i._ownersDictionary&&!!i._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(i._numberOfOwnersFound++,i._foundOwnersDictionary[e.userId]=!0)}),t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var n in this._ownersDictionary){var o=this._ownersDictionary[n];this._foundOwnersDictionary[o.userId]||(o.isOwnerOfCurrentGroup=!0,e.membersList.members.push(o),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}},e}(),c=r("3HEj"),p=r("mxVm"),l=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._pageContext=e.pageContext,this._dataRequestor=new a.DataRequestor({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new s.a(e.pageContext);var t=function(e){return e.name?Object(i.__assign)(Object(i.__assign)({},e),{name:"GroupsProvider.PersistentCache."+e.name}):e};this._persistentCache=new p.a({secret:void 0,cacheType:1,telemetry:{engagement:a.Engagement.withData(t),qos:a.Qos.withData(t)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new a.EventGroup(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var t=this;return new u(this,this.group,function(e,r,i){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,r,i):a.Promise.reject(t._missingLoginNameError):a.Promise.reject("Missing group id.")},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?a.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):a.Promise.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return a.Promise.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,t){var r=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer},r.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return t._performBasicPropertiesPostProcessing(e),Object(c.f)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties(),e}):a.Promise.reject("Missing group id.")},e.prototype.loadMembershipContainerFromServer=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!1),e?this._userLoginName?this._dataSource.getGroupMembership(e,this._userLoginName,t,r):a.Promise.reject(this._missingLoginNameError):a.Promise.reject("Missing group id.")},e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):a.Promise.reject("Missing group id.")},e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(r){return r&&0!==r.length?a.Promise.resolve(r):t.getCurrentUser().then(function(r){return e?t._dataSource.getUserGroupsFromAAD(r).then(function(e){return t._persistentCache.update({key:"UserGroupsFromAAD"+r.userId},e),e}):t._dataSource.getUserGroups(r).then(function(e){return t._persistentCache.update({key:"UserGroups"+r.userId},e),t._setUsersGroups(e,o.a.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(r){return(e?a.Promise.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+r.userId}).then(function(e){return e.data})):a.Promise.resolve(t._persistentCache.read({key:"UserGroups"+r.userId}).then(function(e){return e.data}))).then(function(r){return r&&!e&&t._setUsersGroups(r,o.a.Cache),r})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var r=0,i=t.length;r<i;r++)if(t[r].id===e)return!0;return!1})},e.prototype.getGroup=function(e,t){var r=this;if(void 0===t&&(t=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return t||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new a.Promise(function(e,t){var i=r.group;r.group?i.source===o.a.None?r._eventGroup.on(i,n.b.onSourceChange,function(n){n!==o.a.Error?n===o.a.None||e(i):t(r.group.error)}):e(i):t("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?a.Promise.resolve(this.currentUser):this._getUserFromCache("CurrentUser").then(function(t){return e.currentUser=t,t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){return e._saveUserToCache(t,"CurrentUser"),e.currentUser=t,t})}):a.Promise.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,t,r,i){var n,o=this;return e?this._getUserIdForCacheClear(t,r).then(function(s){return n=s,o._dataSource.addGroupMember(e,t,r,i)}).then(function(){o._clearUserGroupsCache(n)}):a.Promise.reject("Missing group id.")},e.prototype.addUserToGroupOwnership=function(e,t,r,i){var n,o=this;return e?this._getUserIdForCacheClear(t,r).then(function(s){return n=s,o._dataSource.addGroupOwner(e,t,r,i)}).then(function(){o._clearUserGroupsCache(n)}):a.Promise.reject("Missing group id.")},e.prototype.removeUserFromGroupMembership=function(e,t,r){var i,n=this;return e?this._getUserIdForCacheClear(t).then(function(o){return i=o,n._dataSource.removeGroupMember(e,t,r)}).then(function(){n._clearUserGroupsCache(i)}):a.Promise.reject("Missing group id.")},e.prototype.removeUserFromGroupOwnership=function(e,t,r){var i,n=this;return e?this._getUserIdForCacheClear(t).then(function(o){return i=o,n._dataSource.removeGroupOwner(e,t,r)}).then(function(){n._clearUserGroupsCache(i)}):a.Promise.reject("Missing group id.")},e.prototype.addUsersToGroup=function(e,t,r,i,n){var o,s=this;return e?this.currentUser?(o=this.currentUser.userId,this._dataSource.addUsersToGroup(e,t,r,i,n).then(function(e){return s._clearUserGroupsCache(o),e})):this.getCurrentUser().then(function(e){o=e.userId}).then(function(){return s._dataSource.addUsersToGroup(e,t,r,i,n)}).then(function(e){return s._clearUserGroupsCache(o),e}):a.Promise.reject("Missing group id.")},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var r=this.getCachedGroup(e);r.load(),this.group=r}},e.prototype.getCachedGroup=function(e,t){var r=this._groups[e];return r||(r=new n.b(t,this,e,this._pageContext),this._groups[e]=r),r},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t=this._pageContext;return t.groupId===e.id&&(t.webTitle!==e.name||(t.siteClassification||e.classification)&&t.siteClassification!==e.classification||(t.sensitivityLabel||e.assignedLabels)&&t.sensitivityLabel.toLocaleLowerCase()!==e.assignedLabels.toLocaleLowerCase()||null===t.groupType||void 0===t.groupType||"Public"===t.groupType!==e.isPublic||!a.Killswitch.isActivated("C846AC33-6AD5-479A-B4FD-8DE1AF891B6F","04/10/2020","Lazt Sync Teams Connected Site")&&!t.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return a.Promise.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var t=this;return a.Promise.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(r){return!!r.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){return"HideTeamify:"+(e||this._pageContext.siteId)},e.prototype._setUsersGroups=function(t,r){var i=this;this.userGroups=t.map(function(e){var t=i.getCachedGroup(e.id,e);return r!==o.a.Server&&t.source===o.a.Server||t.extend(e),t.pictureUrl||t.load(),t}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl=this._pageContext.webAbsoluteUrl+"/_api/GroupService/GetGroupImage",e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations","Yammer.FeedURL"),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,"MicrosoftTeams.TeamHomeURL"))},e.prototype._getWorkloadUrl=function(e,t,r,i){var n=null,o=e.yammerResources,s=e.teamsResources,a=function(e){var t=e.filter(function(e){return e.Key===i});return t&&t[0]?t[0].Value:null};return"MicrosoftTeams.TeamHomeURL"===i?s&&s.results&&s.results.length>0&&(n=a(s.results)):o&&o.results&&o.results.length>0?"Yammer.FeedURL"===i&&(n=a(o.results)):n=e[t]?e[t]:this._pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+e.id+"&target="+r,n},e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)},e.prototype._getUserFromCache=function(e){return a.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return a.Promise.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,t){var r;return this.currentUser&&e?(r=e===this.currentUser.userId?e:null,a.Promise.resolve(r)):this.getCurrentUser().then(function(i){return r=e?e===i.userId?i.userId:null:t===i.principalName?i.userId:null})},e.onUserGroupsChange="userGroups",e}()},"403U":function(e,t,r){"use strict";r.r(t),r.d(t,"TeamifyBanner",function(){return D}),r.d(t,"default",function(){return D});var i=r("17wl"),n=r("cDcd"),o=r("CWvN"),s=r("KL1q"),a=r("WopS"),u=r("1wUa"),c=r("QmvJ"),p=r("jOlS");Object(p.loadStyles)([{rawString:".teamifyBanner_a8ceaba1{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";position:relative}.titleWrapper_a8ceaba1{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-bottom:4px}.teamsIcon_a8ceaba1{color:#5558af;font-size:17px}.teamsName_a8ceaba1{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";padding:0 8px 0 4px}[dir='rtl'] .teamsName_a8ceaba1{padding:0 4px 0 8px}.infoIcon_a8ceaba1{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";padding-top:6px}.toolTipContainer_a8ceaba1{padding:0px 4px}.tooltip_a8ceaba1{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:"}.createTeamText_a8ceaba1{font-weight:600}.description_a8ceaba1{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.teamifySpinner_a8ceaba1.teamifySpinner_a8ceaba1{display:'inline-block'}.hideTeamifyButton_a8ceaba1{position:absolute;top:0px;right:0px}.hideTeamifyIcon_a8ceaba1{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";line-height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:"}.hideTeamifyDialogButtonContainer_a8ceaba1{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.hideTeamifyDialogButton_a8ceaba1{padding:0px 4px}.createTeamLink_a8ceaba1{padding-top:8px}.dismissPermanentlyLink_a8ceaba1{padding-top:20px}\n"}]);var l,m="teamifyBanner_a8ceaba1",d="titleWrapper_a8ceaba1",h="teamsIcon_a8ceaba1",f="infoIcon_a8ceaba1",_="description_a8ceaba1",g="teamifySpinner_a8ceaba1",y=r("ITuu"),v=r.n(y),b=r("c4/U"),T=r("K9kD"),S=r("3Ilx"),C=r("ynV5");!function(e){e.TipsNTricks="TipsNTricks",e.TeamifyBanner="TeamifyBanner"}(l||(l={}));var P=n.lazy(function(){return Promise.all([r.e(0),r.e(2),r.e(40),r.e(34)]).then(r.bind(null,"fVj+"))}),U={ODB:1936},D=function(e){function t(t){var r=e.call(this,t)||this;return r._hideTeamifyKillswitch=!1,r._experimentKillswitch=!1,r._renderTooltipContent=function(){return T.FeatureOverrides.isFeatureEnabled(U)||!r._experimentKillswitch?n.createElement("div",{className:"tooltip_a8ceaba1"},v.a.toolTipContent):n.createElement("div",{className:"tooltip_a8ceaba1"},v.a.teamsDescription1,n.createElement("br",null),n.createElement("br",null),Object(b.a)(v.a.teamsDescription2,v.a.createTeam,"span",{className:"createTeamText_a8ceaba1"}))},r._onHideTeamifyBanner=function(){new S.a({pageContext:r.props.pageContext}).hideTeamifyBanner(),T.Engagement.logData({name:"TeamifyBanner.Hide",isIntentional:!0}),r.setState({hasDismissed:!0}),r._onCloseHideTeamifyDialog()},r._onDismissTeamifyBanner=function(){var e=new S.a({pageContext:r.props.pageContext});T.Engagement.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0}),e.dismissTeamifyBanner().then(function(){r._onCloseHideTeamifyDialog(),r.setState({hasDismissed:!0})})},r._onClick=function(){if(T.FeatureOverrides.isFeatureEnabled(U))r._onClickV2Experience();else if(r._experimentKillswitch)r._onClickV1Experience();else switch(Object(T.getVariantAndLogExposure)(90010,r.props.pageContext)){case 1:r._onClickV2Experience();break;default:r._onClickV1Experience()}T.Engagement.logData({name:"TeamifyBanner.Click",isIntentional:!0})},r._onClickV2Experience=function(){r._teamifyQos=new T.Qos({name:"TeamifyWizardLoader.Load"}),r._toggleTeamify()},r._onClickV1Experience=function(){r.setState({hasClickedLink:!0}),new S.a({pageContext:r.props.pageContext}).teamify().done(function(e){void 0!==e?(r.setState({responseHasFailure:!1,responseHasSuccess:!0,teamUrl:e}),T.Engagement.logData({name:"TeamifyBanner.Teamify.Success",isIntentional:!1})):r.setState({responseHasFailure:!0})},function(e){r.setState({responseHasFailure:!0})})},r._onCloseHideTeamifyDialog=function(){r.setState({hideTeamifyDialogOpen:!1})},r._onOpenHideTeamifyDialog=function(){T.Engagement.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0}),r.setState({hideTeamifyDialogOpen:!0})},r._logClick=function(){r.setState({hasClickedLink:!0}),T.Engagement.logData({name:"TeamifyBanner.Click",isIntentional:!0})},r._toggleTeamify=function(){r.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})},r.state={},r._createUrl=t.pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?Target=TEAM&Create=TRUE",r._usePostmethod=!T.Killswitch.isActivated("67615EE2-7930-41EE-A90D-4D174AB85A58","01/15/2019","Enable Teamify through POST method only."),r._hideTeamifyKillswitch=T.Killswitch.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner"),r._experimentKillswitch=T.Killswitch.isActivated("DB52012D-C103-4653-928C-16AC57D214B9","11/05/2020","Enable v2 Experiment"),r}return Object(i.__extends)(t,e),t.prototype.render=function(){return T.FeatureOverrides.isFeatureEnabled(U)?this._renderV2Experience():this._experimentKillswitch?this._renderV1Experience():this._renderExperimentalExperience()},t.prototype.componentDidMount=function(){T.Engagement.logData({name:"TeamifyBanner.Render",isIntentional:!1})},t.prototype._renderV1Experience=function(){if(this._usePostmethod){var e="Microsoft Teams",t=n.createElement(s.TooltipHost,{tooltipProps:{onRenderContent:this._renderTooltipContent}},n.createElement(c.Icon,{iconName:"Info",className:f,tabIndex:0,ariaLabel:e+". "+v.a.description})),r=void 0;return this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?r=n.createElement("div",{className:_},v.a.error):this.state.responseHasSuccess&&(r=n.createElement("div",{className:_},n.createElement(s.Link,{href:this.state.teamUrl,target:"_blank"},v.a.visitTeam))):r=n.createElement("div",{className:_},v.a.description,n.createElement("br",null),n.createElement(s.Spinner,{size:s.SpinnerSize.xSmall,className:g+" "+g})," ",v.a.creating):r=n.createElement("div",{className:_},v.a.description,!this._hideTeamifyKillswitch&&n.createElement("span",{className:"toolTipContainer_a8ceaba1"},t),n.createElement("br",null),n.createElement(s.Link,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},v.a.createTeam)),n.createElement("div",{className:Object(o.css)(this.props.className,m)},this._renderHideTeamifyButton(),n.createElement("div",{className:d},n.createElement(c.Icon,{className:h,iconName:"TeamsLogoInverse"}),n.createElement("span",{className:"teamsName_a8ceaba1"},e),this._hideTeamifyKillswitch&&t),r)}return this.state.hasClickedLink?null:(e="Microsoft Teams",n.createElement("div",{className:Object(o.css)(this.props.className,m)},this._renderHideTeamifyButton(),n.createElement("div",{className:d},n.createElement(c.Icon,{className:h,iconName:"TeamsLogoInverse"}),n.createElement("span",{className:"teamsName_a8ceaba1"},e),n.createElement(s.TooltipHost,{tooltipProps:{onRenderContent:this._renderTooltipContent}},n.createElement(c.Icon,{iconName:"Info",className:f,tabIndex:0,ariaLabel:e+". "+v.a.description}))),n.createElement("div",{className:_},v.a.description,n.createElement("br",null),n.createElement(s.Link,{href:this._createUrl,onClick:this._logClick,target:"_blank"},v.a.createTeam))))},t.prototype._renderV2Experience=function(){var e=n.createElement(s.TooltipHost,{tooltipProps:{onRenderContent:this._renderTooltipContent}},n.createElement(c.Icon,{iconName:"Info",className:f,tabIndex:0}));return n.createElement("div",null,n.createElement("div",{className:Object(o.css)(this.props.className,m)},this._renderHideTeamifyButton(),n.createElement("div",{className:d},n.createElement(c.Icon,{className:h,iconName:"TeamsLogoInverse"}),n.createElement("span",{className:"teamsName_a8ceaba1"},v.a.title)),n.createElement("div",{className:_},v.a.teamifyDescription,!this._hideTeamifyKillswitch&&n.createElement("span",{className:"toolTipContainer_a8ceaba1"},e),n.createElement("br",null),n.createElement(s.Link,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},v.a.linkDescription))),this.state.showTeamifyWizard&&n.createElement(n.Suspense,{fallback:null},n.createElement(P,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:l.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))},t.prototype._renderExperimentalExperience=function(){var e,t=n.createElement(s.TooltipHost,{tooltipProps:{onRenderContent:this._renderTooltipContent}},n.createElement(c.Icon,{iconName:"Info",className:f,tabIndex:0}));return this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?e=n.createElement("div",{className:_},v.a.error):this.state.responseHasSuccess&&(e=n.createElement("div",{className:_},n.createElement(s.Link,{href:this.state.teamUrl,target:"_blank"},v.a.visitTeam))):e=n.createElement("div",{className:_},v.a.description,n.createElement("br",null),n.createElement(s.Spinner,{size:s.SpinnerSize.xSmall,className:g+" "+g})," ",v.a.creating):e=n.createElement("div",{className:_},v.a.teamifyDescription,!this._hideTeamifyKillswitch&&n.createElement("span",{className:"toolTipContainer_a8ceaba1"},t),n.createElement("br",null),n.createElement(s.Link,{onClick:this._onClick,className:"createTeamLink_a8ceaba1"},v.a.linkDescription)),n.createElement("div",{className:Object(o.css)(this.props.className,m)},this._renderHideTeamifyButton(),n.createElement("div",{className:d},n.createElement(c.Icon,{className:h,iconName:"TeamsLogoInverse"}),n.createElement("span",{className:"teamsName_a8ceaba1"},"Microsoft Teams")),e,this.state.showTeamifyWizard&&n.createElement(n.Suspense,{fallback:null},n.createElement(P,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:l.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))},t.prototype._renderHideTeamifyButton=function(){if(!this._hideTeamifyKillswitch)return this.state.hasDismissed?null:[n.createElement(s.IconButton,{className:"hideTeamifyButton_a8ceaba1",ariaLabel:v.a.hideTeamifyButtonAriaLabel,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_a8ceaba1"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]},t.prototype._renderHideTeamifyDialog=function(){return n.createElement(a.a,{hidden:!this.state.hideTeamifyDialogOpen,type:u.a.close,dialogContentProps:{type:u.a.close,title:v.a.hideTeamifyDialogTitle,subText:C.format(v.a.hideTeamifyDialogDescription,v.a.hideTeamifyDialogPermanentDismissLink),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},n.createElement("div",{className:"hideTeamifyDialogButtonContainer_a8ceaba1"},n.createElement("div",{className:"hideTeamifyDialogButton_a8ceaba1"},n.createElement(s.PrimaryButton,{onClick:this._onHideTeamifyBanner}," ",v.a.hideTeamifyDialogYesButton," ")),n.createElement("div",{className:"hideTeamifyDialogButton_a8ceaba1"},n.createElement(s.DefaultButton,{onClick:this._onCloseHideTeamifyDialog}," ",v.a.hideTeamifyDialogNoButton," "))),n.createElement("div",{className:"hideTeamifyDialogButtonContainer_a8ceaba1"},n.createElement(s.Link,{className:"dismissPermanentlyLink_a8ceaba1",onClick:this._onDismissTeamifyBanner},v.a.hideTeamifyDialogPermanentDismissLink)))},t}(o.BaseComponent)},"4AK9":function(e,t,r){"use strict";var i=r("17wl"),n=r("tOru"),o=r("1tKF"),s=r("K9kD"),a=r("ynV5"),u=r("y88i"),c=r("C21W"),p=r("QVYh"),l="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",m="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",d="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",h=function(e){function t(t){var r=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;return r._isTeamifyPromptHiddenCacheKey=t?"isTeamifyPromptHidden_"+(t.siteId+t.groupId):"isTeamifyPromptHidden",r}return Object(i.__extends)(t,e),t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},t._parseUser=function(e){var r=JSON.parse(e);return t._copyMember(r.d)},t._copyMembers=function(e){var r=new n.b;return r.members=e.map(function(e){return t._copyMember(e)}),r},t._parseGroup=function(e){var r=JSON.parse(e);return t._copyGroup(r.d)},t._parseMembership=function(e){var r=JSON.parse(e);return t._copyMembership(r.d)},t._copyGroup=function(e){var r={description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,membership:t._copyMembership(e)};return t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&(r.assignedLabels=e.assignedLabels),r},t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}},t._parseOwnership=function(e){var r=JSON.parse(e);return t._copyOwnership(r.d)},t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}},Object.defineProperty(t,"_isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled",{get:function(){return s.FeatureOverrides.isFeatureEnabled({ODB:1688})},enumerable:!0,configurable:!0}),t.prototype.getGroupBasicProperties=function(e){var r=this;return this.getData(function(){return r._getUrl(a.format(t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled?"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels":"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic",e),"SP.Directory.DirectorySession")},function(i){var n=t._parseGroup(i);return n.id||(n.id=e),r._calculateMissingGroupProperties(n,e),n},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},t.prototype.setGroupBasicProperties=function(e){var r=this;return e?this.getData(function(){return r._getUrl(a.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var r;return r=s.Killswitch.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")?{__metadata:{type:"SP.Directory.Group"},displayName:e.name,description:e.description}:{__metadata:{type:"SP.Directory.Group"}},s.Killswitch.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")||(e.name&&(r.displayName=e.name),e.description&&(r.description=e.description)),t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&e.assignedLabels?(null!=e.isPublic&&(r.isPublic=e.isPublic),e.assignedLabels===s.Guid.Empty?r.assignedLabels="":r.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(r.isPublic=e.isPublic),e.classification&&(r.classification=e.classification)),JSON.stringify(r)},"PATCH",void 0,void 0,3):s.Promise.reject("Group parameter is null or undefined")},t.prototype.getGroupByAlias=function(e){var r=this;return this.getData(function(){return r._getUrl(a.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},t.prototype.getGroupMembership=function(e,r,i,n){var o=this;void 0===i&&(i=!1),void 0===n&&(n=!1);var u=i?"100":"3";return this.getData(function(){return o._getUrl(a.format(l,e,"members","0",u),"SP.Directory.DirectorySession")},function(e){var i=t._parseMembership(e);return o._calculateMissingMembershipProperties(i,r),i},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return n?o._addOwnerInformation(e,r,t):s.Promise.resolve(t)})},t.prototype.getGroupMembershipPage=function(e,r,i,n){var o=this;return this.getData(function(){return o._getUrl(a.format(l,e,"members",i,n),"SP.Directory.DirectorySession")},function(e){var i=t._parseMembership(e);return o._calculateMissingMembershipProperties(i,r),i},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},t.prototype.getGroupOwnership=function(e,r){var i=this,n=r||"100";return this.getData(function(){return i._getUrl(a.format(l,e,"owners","0",n),"SP.Directory.DirectorySession")},function(e){var r=t._parseOwnership(e);return i._calculateMissingOwnershipProperties(r),r},"GetOwnership",void 0,"GET",void 0,void 0,3)},t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return a.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},t.prototype.getUserGroups=function(e){var t=this,r=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(a.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:r()},r)},t.prototype.addGroupMember=function(e,t,r,i){var n=this;return t=t||s.Guid.Empty,r=r||"",this.getData(function(){return n._getUrl(a.format(m,e,t,r),"SP.Directory.DirectorySession")},void 0,i||"AddMember",void 0,"POST",void 0,void 0,3)},t.prototype.addGroupOwner=function(e,t,r,i){var n=this;return t=t||s.Guid.Empty,r=r||"",this.getData(function(){return n._getUrl(a.format(d,e,t,r),"SP.Directory.DirectorySession")},void 0,i||"AddOwner",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupMember=function(e,t,r){var i=this;return this.getData(function(){return i._getUrl(a.format("Group('{0}')/Members/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,r||"RemoveMember",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupOwner=function(e,t,r){var i=this;return this.getData(function(){return i._getUrl(a.format("Group('{0}')/Owners/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,r||"RemoveOwner",void 0,"POST",void 0,void 0,3)},t.prototype.addUsersToGroup=function(e,t,r,n,o){var u=this,p=s.Guid.generate(),l="multipart/mixed; boundary=batch_"+p,h=[],f=[],_=0,g=0,y=function(t,r,i){for(var n=r?d:m,o=0;o<t.length;o++){var c=void 0,p=void 0;if(i?p=t[o]:c=t[o],c||p){c=c||s.Guid.Empty,p=p||"";var l=u._getUrl(a.format(n,e,c,p),"SP.Directory.DirectorySession");r?f.push(l):h.push(l)}}};if(t?(y(t,!0,!1),_=t.length):n&&(y(n,!0,!0),_=n.length),r?(y(r,!1,!1),g=r.length):o&&(y(o,!1,!0),g=o.length),!(f.length<1&&h.length<1)){var v=this.getData(function(){return c.a.getBatchOperationUrl(u._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return c.a.getBatchContent(p,[f,h],"POST",c.a.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,r=e.eventData;return t?(t.extraData={OwnersNumber:_,MembersNumber:g},{eventData:Object(i.__assign)(Object(i.__assign)({},r),{resultCode:t.status.toString()})}):{eventData:r}},void 0);return new s.Promise(function(e,t){v.then(function(r){var i=c.a.processBatchResponse(r);i.hasError?t(i):e(i)},function(e){t(e)})})}},t.prototype.addRemoveGroupUsers=function(e,t,r,n,o){var u=this,p=s.Guid.generate(),l="multipart/mixed; boundary=batch_"+p,h=[],f=[],_=[],g=[],y=function(t,r,i){var n="SP.Directory.DirectorySession";if(void 0!==t)for(var o=0;o<t.length;o++)if(r)if(i){var s=u._getUrl(a.format(d,e,t[o],""),n);h.push(s)}else s=u._getUrl(a.format("Group('{0}')/Owners/Remove('{1}')",e,t[o]),n),_.push(s);else i?(s=u._getUrl(a.format(m,e,t[o],""),n),f.push(s)):(s=u._getUrl(a.format("Group('{0}')/Members/Remove('{1}')",e,t[o]),n),g.push(s))};if(y(t,!0,!0),y(n,!0,!1),y(r,!1,!0),y(o,!1,!1),0!==h.length||0!==f.length||0!==_.length||0!==g.length){var v=this.getData(function(){return c.a.getBatchOperationUrl(u._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return c.a.getBatchContent(p,[h,f,_,g],"POST",c.a.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,r=e.eventData;return t?(t.extraData={OwnersToAdd:h.length,MembersToAdd:f.length,OwnersToRemove:_.length,MembersToRemove:g.length},{eventData:Object(i.__assign)(Object(i.__assign)({},r),{resultCode:t.status.toString()})}):{eventData:r}},void 0);return new s.Promise(function(e,t){v.then(function(r){var i=c.a.processBatchResponse(r);i.hasError?t(i):e(i)},function(e){t(e)})})}},t.prototype.getUserInfo=function(e){var r=this;return this.getData(function(){return r._getUrl(a.format("User(principalName='{0}')",u.UriEncoding.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(r){var i=t._parseUser(r);return i.email=e,i},"GetGraphUser",void 0,"GET",void 0,void 0,3)},t.prototype.deleteGroup=function(e){var t=this;return e?this.getData(function(){return t._getUrl(a.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):s.Promise.reject("Group parameter is null or undefined")},t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},t.prototype.teamifyV2=function(e,t){var r=this;return this.getData(function(){return r._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(i){return t(i),i&&i.teamsId?r._pinToTeam(i,e):void 0})},t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){s.Killswitch.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")||(e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0))})},t.prototype.getTeamifyBannerHidden=function(e){var t=this,r=function(){return t._pageContext.siteAbsoluteUrl+a.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},i=function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden};return s.Killswitch.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")?this.getData(r,i,"TeamifyBannerHidden",function(){return""},"Get"):this.getDataUtilizingPersistentCache({getUrl:r,qosName:"TeamifyBannerHidden",parseResponse:i,additionalPostData:"",method:"Get",cachingStrategy:e?3:0,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},t.prototype._getUrl=function(e,t){return this._pageContext.webAbsoluteUrl+"/_api/"+t+"/"+e},t.prototype._getCsomUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_vti_bin/client.svc/"+e},t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+a.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"notebook")},t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+a.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"documents")},t.prototype._addOwnerInformation=function(e,t,r){return this.getGroupOwnership(e,"100").then(function(e){var i=e.ownersList.members,n=r.membersList.members,o=[],a={};i.forEach(function(e){a[e.userId]=!0,e.principalName.toLowerCase()===t.toLowerCase()&&(r.isOwner=!0)});var u=0,c={};return n.forEach(function(e){a[e.userId]?(e.isOwnerOfCurrentGroup=!0,o.push(e),u++,c[e.userId]=!0):o.push(e),e.principalName===t&&(r.isMember=!0)}),u<i.length&&i.forEach(function(e){c[e.userId]||(e.isOwnerOfCurrentGroup=!0,o.push(e))}),r.membersList.members=o,r.totalNumberOfMembers<o.length&&(r.totalNumberOfMembers=o.length),r.totalNumberOfOwners=e.totalNumberOfOwners,s.Promise.resolve(r)})},t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(p.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=a.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},t.prototype._calculateMissingMembershipProperties=function(e,t){var r=this;e.membersList.members.forEach(function(e){r._fixUserImages(e)})},t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})},t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t)),!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))},t.prototype._parseResponseForGetUserGroups=function(e){var t=this,r=JSON.parse(e);if(r.constructor===Array)return r[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var i=r.d.results.map(function(e){var r={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return t._calculateMissingGroupProperties(r,r.id),r}),n=i.filter(function(e){return e.isFavorite});return n.push.apply(n,i.filter(function(e){return!e.isFavorite})),n},t.prototype._pinToTeam=function(e,t){var r=this;return t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return r._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var r=JSON.parse(t);if(r&&r.d)return{pinToTeam:r.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(r._pageContext&&r._pageContext.navigationInfo&&r._pageContext.navigationInfo.quickLaunch){var i={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(i)}},"POST",void 0,void 0,0)},t}(o.b);t.a=h},"6o44":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=r("7KUI"),n=r("K9kD"),o=r("ynV5"),s=r("OpjN"),a=function(){function e(t,r,o,a){this._eventGroup=new n.EventGroup(this),this.source=s.a.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=r,this.id=o,t?this.extend(t):this.load(),this.membership=new i.c(void 0,this._groupsProvider,this),!a&&r&&(a=r.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(a,o)}return e._getPlannerUrl=function(e,t){if(e)return t||(t=e.groupId),e.webAbsoluteUrl+o.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(t){var r=this;if(this._groupsProvider&&this.id){var i=n.Promise.resolve();return this.source===s.a.None&&(i=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){t&&t.lastLoadTimeStampFromServer>0&&(r.extend(t),r.source=s.a.Cache,r._eventGroup.raise(e.onSourceChange,r.source))})),i.then(function(){if(r._shouldLoadNewData(t))return r._startLoadingFromServer(),r._groupsProvider.loadGroupInfoContainerFromServer(r.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),r.extend(e),r._finishLoadingFromServer(),r._groupsProvider.saveGroupToCache(e)},function(e){r._errorLoading(e)})})}return n.Promise.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==s.a.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=s.a.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1,this.error=t,this._eventGroup.raise(e.onSourceChange,s.a.Error)},e.onSourceChange="source",e}();t.b=a},"7KUI":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a});var i,n=r("tOru"),o=r("OpjN"),s=r("K9kD");!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(i||(i={}));var a=function(){function e(e,t,r){this._eventGroup=new s.EventGroup(this),this.source=o.a.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this._parent=r,e&&this.extend(e,o.a.None),this.membersList||(this.membersList=new n.b)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,t){var r=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._groupsProvider&&this._parent.id){var n=0;e&&(n|=i.allMembers),t&&(n|=i.ownershipInformation);var a=s.Promise.resolve();return this.source!==o.a.None||n||(a=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&r.extend(e.membership,o.a.Cache)})),a.then(function(){if(r._shouldLoadNewData(n))return r._startLoadingFromServer(n),r._groupsProvider.loadMembershipContainerFromServer(r._parent.id,e,t).then(function(e){r.extend(e,o.a.Server),r._finishLoadingFromServer(),n||(e.lastLoadTimeStampFromServer=r.lastLoadTimeStampFromServer,r._groupsProvider.saveMembershipToCache(r._parent.id,e))},function(e){r._errorLoading(e)})})}return s.Promise.resolve()},e.prototype.loadWithOptions=function(e){var t=this;return this._groupsProvider&&this._parent.id&&(this.source!==o.a.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,o.a.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&i.allMembers)===i.allMembers,e&&(e&i.ownershipInformation)===i.ownershipInformation).then(function(r){t.extend(r,o.a.Server),t._finishLoadingFromServer(),e&&e!==i.forceSkipCache||(r.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,r))},function(e){t._errorLoading(e)})):s.Promise.resolve(void 0)},e.prototype.extend=function(t,r){this.isMember=t.isMember,this.isOwner=t.isOwner,this.isJoinPending=t.isJoinPending,this.membersList=t.membersList,this.totalNumberOfMembers=t.totalNumberOfMembers,this.totalNumberOfOwners=t.totalNumberOfOwners,this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=r,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==o.a.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&i.forceSkipCache)===i.forceSkipCache||e&&(e&i.allMembers)===i.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&i.allMembers)===i.allMembers)||e&&(e&i.ownershipInformation)===i.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&i.ownershipInformation)===i.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}();t.c=a},C21W:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=r("K9kD"),n=r("m1i4"),o=r("y88i"),s=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new n.b({webAbsoluteUrl:!e&&t?new o.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var r={id:t};if((e=e.error?e.error:e)&&e.code){var i=e.code?e.code.split(","):e.error.code.split(","),n=Number(i[0]),o=e.message.value;r.error={code:n,message:o}}return{items:[r]}},e.getBatchResponseText=function(e){var t,r,i,n=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){r=(e=e.replace(t.trim()+"--","")).split(t);for(var o=1;o<r.length;o++)(i=r[o].split("\n\r")).length>2&&n.push(i[2])}return n},e.processBatchResponse=function(e,t,r){var i,n,o,s,a=[],u=!1;if(e.split("\n").length>0&&(i=e.split("\n")[0]),i){n=(e=e.replace(i.trim()+"--","")).split(i);for(var c=1;c<n.length;c++)if((o=n[c].split("\n\r")).length>2){try{s=JSON.parse(o[2])}catch(e){s=o[2]}var p=t&&t[c-1],l=p?{key:p.key,id:p.id,newId:r?r+"/"+p.name:null}:{};if((s=s.error?s.error:s)&&s.code){var m=s.code?s.code.split(","):s.error.code.split(","),d=Number(m[0]),h=s.message.value;l.error={code:d,message:h},u=!0}a.push(l)}}return{items:a,hasError:u}},e.getBatchContent=function(e,t,r,n){for(var o=[],s=0;s<t.length;s++){for(var a=t[s],u=i.Guid.generate(),c=[],p=0;p<a.length;p++){var l=a[p];c.push("--changeset_"+u),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(r+" "+l+" HTTP/1.1"),c.push(n),c.push("")}c.push("--changeset_"+u+"--");var m=c.join("\r\n");o.push("--batch_"+e),o.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"'),o.push("Content-Length: "+m.length),o.push("Content-Transfer-Encoding: binary"),o.push(""),o.push(m),o.push("")}return o.push("--batch_"+e+"--"),o.join("\r\n")},e.getBatchContentExtended=function(e,t,r,n,o,s,a){var u=i.Guid.generate(),c=[];o&&o.length!==t.length&&(o=null);for(var p=0;p<t.length;p++){var l=t[p];c.push("--changeset_"+u),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),a?c.push(a[p]+" "+l+" HTTP/1.1"):c.push(r+" "+l+" HTTP/1.1"),c.push(n),s&&c.push(s),o&&(c.push(""),c.push(o[p])),c.push("")}c.push("--changeset_"+u+"--");var m=c.join("\r\n");return(c=[]).push("--batch_"+e),c.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"'),c.push("Content-Length: "+m.length),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(m),c.push(""),c.push("--batch_"+e+"--"),c.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.b=s},Ddmm:function(e,t,r){"use strict";r.r(t),r.d(t,"TokenFetchServerErrorCodes",function(){return i}),r("qkfK");var i,n=r("K9kD");!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(i||(i={}));var o=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var r=new n.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return r.end({resultType:n.ResultTypeEnum.Success}),e},function(e){return r.end({resultType:n.ResultTypeEnum.Failure}),n.Promise.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var r=new n.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return r.end({resultType:n.ResultTypeEnum.Success}),e},function(e){return r.end({resultType:n.ResultTypeEnum.Failure}),n.Promise.reject(e)})},e}();t.default=o},Gu0Z:function(e,t,r){"use strict";r.r(t);var i,n=r("17wl"),o=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(i||(i={}));var s=function(e){function t(r,i){var n=e.call(this,i.message)||this;return n.__proto__=t.prototype,n._type=r,n._httpResponseStatus=i.httpResponseStatus,n._cultureName=i.cultureName,n._message=i.message,n._serverErrorCode=i.serverErrorCode,n._correlationId=i.correlationId,n._redirectUrl=i.redirectUrl,n}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==i.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0}),t}(Error),a=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var r=this;this._receiveMediaServiceFlushedToken();var i=this._getCachedTokenData(e);if(i&&!this._isExpiring(i)){var n={token:i.accessToken,isGuest:!1,expirationTimeMs:i.expiresOn};return Promise.resolve({tokenInfo:n,spRequestId:i.correlationId,spRequestTimestamp:i.requestTimestamp})}return this._retriableFetchWithDigest(e,o.retries,t).then(function(t){return r._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var r=this._resourceKeys.indexOf(t);!isNaN(r)&&r>-1&&this._resourceKeys.splice(r)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!0,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,r,n){var o=this,a=this._context.qosMonitor(),u=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,n)).then(function(c){if(200!==c.status){o._context.logger.logError("fetchWithDigest failed. Server responded with "+c.statusText);var p=new s(i.unknownError,{httpResponseStatus:c.status,message:c.statusText,correlationId:e._getCorrelationId(c)});return 400!==c.status?(a.writeUnexpectedFailure("UnknownError",p),Promise.reject(p)):c.json().then(function(i){var s=e._extractRealError(i),u=o._getErrorCodeFromResponseCode(s);if(!o._isRetriableError(u)||0===r){var c=o._buildErrorFromResponse(s);return a.writeUnexpectedFailure("SharepointServerError",c),Promise.reject(c)}return o._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+r),o._retriableFetchWithDigest(t,r-1,n)})}return o._instrumentedParseResponseData(c,a,u)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",o.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<o.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==o.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var r=new Headers;r.append("Content-Type","application/json; charset=utf-8"),r.append("Odata-Version","4.0"),r.append("Accept","application/json;odata.metadata=minimal");var i={method:"POST",headers:r,body:JSON.stringify(this._buildRequestBody(e))},n=t;return n&&n.lastIndexOf("/")===n.length-1&&(n=n.substr(0,n.length-1)),new Request(n+o.apiUrl,i)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,r,n=this._getErrorCodeFromResponseCode(e);return void 0===n?new s(i.malformedResponseBody,{httpResponseStatus:400,message:o.unexpectedErrorCodeFormat,correlationId:e.correlationId}):(e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,r=e.message.lang)),new s(i.serverError,{httpResponseStatus:400,message:t,cultureName:r,serverErrorCode:n,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]}))},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,r=Number(t);if(isNaN(r)&&"string"==typeof e.message){var i=t.indexOf(",");-1!==i&&(r=Number(t.substr(0,i)))}return r},e.prototype._instrumentedParseResponseData=function(t,r,n){try{return t.json().then(function(i){return r.writeSuccess(),{accessToken:i.access_token,expiresOn:Number(i.expires_on),notBefore:Number(i.not_before),resource:i.resource,tokenType:i.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:n}})}catch(n){return r.writeUnexpectedFailure("ResponseParseError",n),Promise.reject(new s(i.malformedResponseBody,{httpResponseStatus:200,message:o.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,r=this._resourceKeys;t<r.length;t++){var i=r[t];window.sessionStorage.removeItem(i)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),u=r("dq6a"),c=r("K9kD"),p=r("3HEj"),l=function(){function e(){this._qos=new c.Qos({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:c.ResultTypeEnum.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:c.ResultTypeEnum.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:c.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})},e}(),m=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),d=function(e){function t(t,r){var i=e.call(this,{},{pageContext:t})||this;return i.logger=new m,r&&(r.logger&&(i.logger=r.logger),r.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=r.useAbsoluteUrlForOAuth)),i._oAuthUtility=new a(i),i}return Object(n.__extends)(t,e),t.prototype.qosMonitor=function(){return new l},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(p.c)(this._pageContext)},enumerable:!0,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(r){var i=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return r},"POST",t._getRequestHeadersDictionary(e),i,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,r={};return t.forEach(function(e,t){r[t]=e}),r},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,r){e.then(function(e){t(e)},function(e){r(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new c.Promise(function(t,r){e.then(function(e){t(e)},function(e){r(e)})})},t}(u.b);t.default=d},ITuu:function(e,t){var r={description:"Communicate with your colleagues in real time by creating a Team for your Microsoft 365 Group.",createTeam:"Create a Team",teamsDescription1:"Microsoft Teams is a real-time collaboration and communication tool that is part of the Office 365 suite of services.",teamsDescription2:"Clicking {0} will add a new Microsoft Team and connect it to the Microsoft 365 Group associated with this site. This action cannot be reversed.",creating:"Creating a Team",error:"We couldn\u0027t set up the Team. Please try again later.",visitTeam:"Success!  Click here to go to your Team.",hideTeamifyDialogTitle:"Hide",hideTeamifyDialogDescription:"Are you sure you want to hide the Microsoft Teams banner for this browser session? To remove it permanently, click \u0022{0}\u0022",hideTeamifyDialogPermanentDismissLink:"Don\u0027t show me again",hideTeamifyDialogYesButton:"Yes",hideTeamifyDialogNoButton:"No",hideTeamifyButtonAriaLabel:"Hide",title:"Add real-time chat",teamifyDescription:"Add Microsoft Teams to collaborate in real-time and share resources across Microsoft 365 with your team.",linkDescription:"Add Microsoft Teams",toolTipContent:"Adding Microsoft Teams will connect your team site to a Microsoft 365 Group and create a new workspace to share resources and collaborate in real-time. "};r.default=r,e.exports=r},OpjN:function(e,t,r){"use strict";var i;r.d(t,"a",function(){return i}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(i||(i={}))},QVYh:function(e,t,r){var i=r("K9kD");e.exports=i.SPAlternativeUrls},"c4/U":function(e,t,r){"use strict";r.d(t,"a",function(){return o});var i=r("17wl"),n=r("cDcd");function o(e,t,r,o){var s=e.split("{0}");return o=Object(i.__assign)({key:"key"},o||{}),[s[0],n.createElement(r,o,t),s[1]]}},fz6G:function(e,t,r){"use strict";r.r(t),r.d(t,"GraphUserInfoDataSource",function(){return u});var i=r("17wl"),n=r("K9kD"),o=r("mcLH"),s=r("dq6a"),a={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},u=function(e){function t(t,r){var i=e.call(this,{dataSourceName:"GraphUserInfo"},r)||this;return i._oAuthTokenProvider=r.oAuthTokenProvider,i._canUseGraph=i._pageContext.isSPO,i._requestCache=new o.a({id:"GraphUserInfo"},{pageContext:i._pageContext}),i}return Object(i.__extends)(t,e),t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._requestCache.getDataUtilizingCache({cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):n.Promise.resolve(null)},t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(i.__assign)(Object(i.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},a),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){var t=e.servicePlans||[];if(n.Killswitch.isActivated("D8EC3B19-16BC-4A64-8EF4-AF0DB0262805","7/25/2019","Properly check the status of the users Teams license"))return t.some(function(e){return"57ff2da0-773e-42df-b2af-ffb7a2317929"===e.servicePlanId});for(var r=0;r<t.length;r++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[r].servicePlanId)return"Success"===t[r].provisioningStatus;return!1})}}))},t}(s.a)},jViZ:function(e,t,r){"use strict";r.r(t),r.d(t,"NavLinkCoachmark",function(){return p});var i=r("17wl"),n=r("cDcd"),o=r("PsPn"),s=r("tEA7"),a=r("KL1q"),u=r("PuC3"),c=r.n(u),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){t.setState({isDismissed:!0}),t.props.onDismiss()},t}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return t&&t.isDismissed?null:n.createElement(o.a,Object(i.__assign)({target:"#"+e.id,positioningContainerProps:{directionalHint:a.DirectionalHint.rightCenter}},e.coachmarkProps||{}),n.createElement(s.a,Object(i.__assign)({headline:e.teachingBubbleHeadline,calloutProps:{doNotLayer:!0},hasCloseIcon:!0,closeButtonAriaLabel:c.a.bubbleCloseButton,primaryButtonProps:{text:c.a.bubbleDoneButton,onClick:this._onDismiss},hasSmallHeadline:!0,onDismiss:this._onDismiss},e.teachingBubbleProps||{}),e.teachingBubbleContent))},t}(n.Component)},lR8E:function(e,t,r){"use strict";r.r(t),r.d(t,"TeamsProvider",function(){return o});var i=r("K9kD"),n=r("3HEj"),o=function(){function e(e,t){var r=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider,this._graphUserInfoDataSource=t.graphUserInfoDataSource,this._userInfoDataSource=t.userInfoDataSource,this._isTeamsRelevant=Object(n.f)(r),this._hideTeamifyKillswitch=i.Killswitch.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner")}return e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):i.Promise.resolve()},e.prototype.canTeamify=function(){var e=this,t=this._pageContext;if(!this._isTeamsRelevant||!t.isSiteAdmin)return i.Promise.resolve(!1);if(!i.Killswitch.isActivated("233F5D13-C231-46A9-820F-68FD2F032580","4/16/2020","Don't show banner if server side flag set")&&t.isTeamsConnectedSite)return i.Promise.resolve(!1);var r=function(){return e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})};return this._hideTeamifyKillswitch?r():this._groupsProvider.getTeamifyBannerHidden().then(function(e){return!e&&r()})},e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue("sharePointTeamsTeachingBubble")).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})},e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var r=new i.Uri(t.toLowerCase());t=decodeURIComponent(r.getStringWithoutQueryAndFragment());for(var n=0,o=e;n<o.length;n++){var s=o[n],a=decodeURIComponent((s.url||"").toLowerCase());if(a.substring(0,t.length)===t||-1!==a.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return s}}},e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",e)},e}()},lXIE:function(e,t,r){"use strict";r.r(t),r.d(t,"UserInfoFlag",function(){return i}),r.d(t,"UserInfoDataSource",function(){return c});var i,n=r("17wl"),o=r("K9kD"),s=r("1tKF"),a=r("xkft"),u=r("h/Eh");!function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun",e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun",e.teamsTeachingBubble="sharePointTeamsTeachingBubble",e.librariesFirstRun="sharePointLibrariesFirstRun",e.listsFirstRun="sharePointListsFirstRun",e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun"}(i||(i={}));var c=function(e){function t(t,r){var i=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo"},r)||this,n=i._pageContext,o=r.itemUrlHelper||new a.a({},{pageContext:n});return i.apiUrlHelper=r.apiUrlHelper||new u.a({},{pageContext:n,itemUrlHelper:o}),i._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"},i}return Object(n.__extends)(t,e),t.prototype.getUserFlagValue=function(e){var t=this;if(o.Killswitch.isActivated("AC6676C2-EA2E-4FFE-AAEA-E36483FB5552","03/29/2020","Disable Firstrun check"))return o.Promise.resolve(!0);if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return o.Promise.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return o.Promise.resolve(!0);var r={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingLegacyCache(Object(n.__assign)({onlyCache:!0,useStale:!0},r)).then(function(i){return i||t.getDataUtilizingLegacyCache(Object(n.__assign)(Object(n.__assign)({},r),{additionalHeaders:Object(n.__assign)({},t._additionalHeaders),parseResponse:function(t){var r=JSON.parse(t);if(r&&r.d&&void 0!==r.d[e])return!!r.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})},t.prototype.setUserFlagValue=function(e,t){var r;return this.getDataUtilizingLegacyCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((r={},r[e]=t,r)),method:"POST",additionalHeaders:Object(n.__assign)({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})},t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()},t}(s.a)},tOru:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var t=-1,r=0;r<this.members.length;r++)this.members[r].userId===e.userId&&(t=r);t>=0&&this.members.splice(t,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),r=0;r<this.members.length;r++)if(this.members[r].principalName&&this.members[r].principalName.toLowerCase()===t)return!0;return!1},e}();t.b=i}}]);