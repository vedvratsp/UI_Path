define("1cea229f-b208-4202-8014-22503d92a019_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,r,n,i,a,o,s,u,c,l,d,p){return function(e){function t(t){for(var r,i,a=t[0],o=t[1],s=0,c=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&c.push(n[i][0]),n[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(u&&u(t);c.length;)c.shift()()}var r={},n={0:0};function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,i){r=n[e]=[t,i]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-queryablemanagedproperties",2:"sp-retrievablemanagedproperties"}[e]||e)+"_"+"none"+"_"+{1:"1c84c493dd85e0bf579b",2:"452be3fcde8203897c78"}[e]+".js"}(e);var u=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(c);var r=n[e];if(0!==r){if(r){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,r[1](u)}n[e]=void 0}};var c=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var u=o;return function(){var e,t=document.getElementsByTagName("script"),r="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-dataproviders_en-us_898afb79a6bb72067149\.js/i;if(t&&t.length)for(var n=0;n<t.length;n++)if(t[n]){var a=t[n].getAttribute("src");if(a&&a.match(r)){e=a.substring(0,a.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(r)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"/Gup":function(e,t,r){e.exports=r.p+"Modernize_News_a3fe9f83e59c20415da4c571d192296b.svg"},"0Res":function(e,t,r){e.exports=r.p+"icon_helpitemimg1_c0dba21d.png"},"13jQ":function(e,t){},"17wl":function(t,r){t.exports=e},"2q6Q":function(e,r){e.exports=t},"6DSs":function(e){e.exports=JSON.parse('{"a":"Can\\u0027t get data. {0}: {1} REST call failed. Status Code: {2} Status Message: {3}"}')},"6ZIT":function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"c",function(){return o}),r.d(t,"d",function(){return s}),r.d(t,"e",function(){return l}),r.d(t,"i",function(){return u}),r.d(t,"f",function(){return p}),r.d(t,"a",function(){return i.BaseDataSource}),r.d(t,"g",function(){return i.ODataQueryStringBuilder}),r.d(t,"h",function(){return i.SPDataSource});var n=r("17wl"),i=r("jnk8"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.getListsForWeb=function(e,t){return this.get(e,"/_api/web/lists",t,"ListDataSource","getListsForWeb",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t.prototype.getListFromWeb=function(e,t,r){return this.get(e,"/_api/web/lists(guid'"+t+"')",r,"ListDataSource","getListFromWeb").then(function(e){return e})},t.prototype.getDefaultDocumentLibrary=function(e,t){return this.get(e,"/_api/web/DefaultDocumentLibrary",t,"ListDataSource","getDefaultDocumentLibrary").then(function(e){return e})},t}(i.SPDataSource),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.getFieldsForList=function(e,t,r){return this.get(e,"/_api/web/lists('"+t+"')/Fields",r,"ListFieldDataSource","getFieldsForList",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t}(i.SPDataSource),s={Integer:1,Text:2,DateTime:4,Counter:5,Choice:6,Boolean:8,Number:9,Currency:10,MultiChoice:15,User:20},u={None:0,ContextInfo:1,ListData:2,ListSchema:4},c=r("R/pT"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.getItemsForList=function(e,t,r,n,i,a,o,s,l,d,p){if(!n&&!t&&!r)throw c.a;var f;void 0===i&&(i=u.None),o?(0===o.indexOf("?")&&(o=o.substring(1)),0!==o.indexOf("&")&&(o="&"+o)):o="",n?f="DefaultDocumentLibrary":(f="Lists",f+=t?"(guid'"+t+"')":"/GetByTitle('"+r+"')");var h="/_api/web/"+f+"/RenderListDataAsStream?"+(p?"View="+p:"")+o,g={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:i}},_=new Headers;return _.append("Content-Type","application/json;odata=verbose"),_.append("Accept","application/json;odata=nometadata"),_.append("OData-Version","3.0"),a&&(g.parameters.ViewXml=a),l&&(g.parameters.ImageFieldsToTryRewriteToCdnUrls=l),void 0!==d&&(g.parameters.AudienceTarget=d),this.post(e,h,"",JSON.stringify(g),"ListItemDataSource","getItemsForList",_,s).then(function(e){return e.ListData.Row})},t}(i.SPDataSource),d=r("hiL/"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.addView=function(e,t){var r="/_api/web/lists('"+t+"')/Views/Add",n=JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},PersonalView:!1}});return this.post(e,r,void 0,n,"ListViewDataSource","addView",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},t.prototype.updateViewXml=function(e,t,r,n){var i="/_api/web/lists('"+t+"')/views('"+r+"')/SetViewXml()",a=JSON.stringify({viewXml:n});return this.post(e,i,void 0,a,"ListViewDataSource","updateViewXml",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},Object(n.__decorate)([Object(d.monitor)("ListViewDataSource.addView")],t.prototype,"addView",null),Object(n.__decorate)([Object(d.monitor)("ListViewDataSource.updateViewXml")],t.prototype,"updateViewXml",null),t}(i.SPDataSource)},"8dK2":function(e,t){e.exports=r},"9G/9":function(e){e.exports=JSON.parse('{"a":"Search"}')},CWUF:function(e,t,r){"use strict";r("n1Om"),r("MMs3"),r("o7e7")},G9eg:function(e,t,r){e.exports=r.p+"icon_helpitemimg2-2x_5a055172.png"},JEu8:function(e,t,r){"use strict";r.r(t);var n=r("13jQ");for(var i in n)["default","SeeAllPageLayoutWebparts"].indexOf(i)<0&&function(e){r.d(t,e,function(){return n[e]})}(i);var a=r("urBa");r.d(t,"SeeAllPageLayoutWebparts",function(){return a.a})},K9kD:function(e,t){e.exports=n},KL1q:function(e,t){e.exports=i},LJjX:function(e,t,r){e.exports=r.p+"icon_helpitemimg2_4dca3af9.png"},M8Mv:function(e,t){},MMs3:function(e,t){},Pk8u:function(e,t){e.exports=a},QRxg:function(e){e.exports=JSON.parse('{"a":"Page"}')},QVYh:function(e,t,r){var n=r("K9kD");e.exports=n.SPAlternativeUrls},"R/pT":function(e){e.exports=JSON.parse('{"a":"Can\\u0027t get data. A list identifier or title must be specified."}')},RSuL:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("UWqr"),i=function(){function e(e){this._pageContext=e.pageContext}return e.prototype.buildUrl=function(e,t,r){var i=n.UrlUtilities.removeEndSlash(e),a=0===t.indexOf("/")?"":"/",o=t.indexOf("?")>-1?"&":"?";return""+i+a+t+(r?o+r:"")},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),e}()},"S/19":function(e,t,r){"use strict";r.r(t);var n=r("rOX9");r.d(t,"SearchAPIRequest",function(){return n.a});var i=r("zDft");r.d(t,"SearchAPISortDirection",function(){return i.a});var a=r("Y4yO");for(var o in a)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){r.d(t,e,function(){return a[e]})}(o);var s=r("YDBy");for(var o in s)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){r.d(t,e,function(){return s[e]})}(o);var u=r("M8Mv");for(var o in u)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){r.d(t,e,function(){return u[e]})}(o)},UWqr:function(e,t){e.exports=o},"X+PM":function(e,t){e.exports=s},Y2xY:function(e,t,r){e.exports=r.p+"icon_helpitemimg3-2x_ef307bcc.png"},Y4yO:function(e,t){},YDBy:function(e,t){},Ycni:function(e,t){e.exports=u},YkpB:function(e){e.exports=JSON.parse('{"b":"List","a":"Invalid ListRequestType value."}')},"e+fh":function(e,t,r){"use strict";r.d(t,"a",function(){return m}),r.d(t,"b",function(){return p});var n=r("17wl"),i=r("KL1q"),a=r("ut3N"),o=r("hiL/"),s=r("vlQI"),u=r("UWqr"),c=r("X+PM"),l=r("y88i"),d=r("evK2"),p=function(e){this.name="SPHomeMicroserviceNotAvailableError",this.message="SPHome Microservice not available in this environment",this.message=e||this.message},f=function(e){function t(t){var r=e.call(this,t)||this;return r._requestUpdater=function(e){return Promise.resolve(e)},r}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"requestUpdater",{set:function(e){this._requestUpdater=e},enumerable:!1,configurable:!0}),t.prototype._fetch=function(t,r,n){var i=this;return this._requestUpdater({url:t,options:n}).then(function(t){return e.prototype._fetch.call(i,t.url,r,t.options)})},t}(s.SPHttpClient),h=u.ServiceKey.create("sp-http:SPHttpMicroserviceClient",f),g=r("nJGZ"),_=new o.KillSwitch("0306551a-b040-4e46-ae3d-98f35375764b"),m=function(){function e(e){var t=this;this._isServiceAvailable=void 0,this._hasPrefetchedToken=!1,this._requestUpdater=function(e){return t._fetchTokenIfExpired().then(function(){return{url:t._generateUrlVersionedPath(e.url),options:t._getRequestOptions(e.options)}})},this._isPrefetchTokenFlightEnabled&&(this._initializeFromPrefetchedToken=new Promise(function(e,r){var n=new i.Async;window._spHomeClientContextLoaded=function(){n.dispose();var i=new a._QosMonitor("SpHomeClientContextPrefetch");try{t._initializeWithPrefetchedToken(),t._hasPrefetchedToken?i.writeSuccess():i.writeUnexpectedFailure("NoPrefetchedToken")}catch(e){i.writeUnexpectedFailure("Unexpected",e),r(e)}e()},n.setTimeout(function(){return!t._hasPrefetchedToken&&r(new Error("Timeout"))},1e4)})),this._stopUsingSPHttpMSClient=Object(d.f)(),e.whenFinished(function(){t._spHttpClient=e.consume(s.SPHttpClient.serviceKey),t._stopUsingSPHttpMSClient||(t._spHttpMicroserviceClient=e.consume(h),t._spHttpMicroserviceClient.requestUpdater=t._requestUpdater),t._httpClient=e.consume(s.HttpClient.serviceKey),t._pageContext=e.consume(c.PageContext.serviceKey),t._isPrefetchTokenFlightEnabled&&t._initializeWithPrefetchedToken(),t._isUserSupportedBySubstrate=t._isSubtrateSupportedUser(e.consume(c.PageContext.serviceKey).user)})}return e.prototype.get=function(e,t,r,n){return n?this._get(e,t,r,n):this._get_deprecated(e,t,r)},e.prototype.post=function(e,t,r,n,i){return i?this._post(e,t,r,n,i):this._post_deprecated(e,t,r,n)},Object.defineProperty(e.prototype,"isServiceAvailable",{get:function(){var e=this;return void 0!==this._isServiceAvailable?Promise.resolve(this._isServiceAvailable):this._fetchTokenIfExpired().then(function(){return e._isServiceAvailable=!0,e._isServiceAvailable}).catch(function(t){return e._isServiceAvailable=!1,e._isServiceAvailable})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUserSupportedBySubstrate",{get:function(){return this._isUserSupportedBySubstrate},enumerable:!1,configurable:!0}),e.prototype._get=function(e,t,r,n){var i=this;if(!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var a=this._generateVersionedPath(e,t);return this._spHttpMicroserviceClient.get(a,new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),this._getRequestOptions({},r),this._getCacheConfiguration(n,a))}return this._fetchTokenIfExpired().then(function(){return i._spHttpClient.get(i._generateUrl(e,t),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),i._getRequestOptions({},r),n)})},e.prototype._get_deprecated=function(e,t,r){var n=this;return this._fetchTokenIfExpired().then(function(){return _.isActivated()?n._httpClient.get(n._generateUrl(e,t),s.HttpClient.configurations.v1,n._getRequestOptions({},r)):n._spHttpClient.get(n._generateUrl(e,t),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),n._getRequestOptions({},r))})},e.prototype._post=function(e,t,r,n,i){var a=this;if(void 0===t&&(t=""),!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var o=this._generateVersionedPath(e,r);return this._spHttpMicroserviceClient.fetch(o,new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),this._getRequestOptions({body:t},n,"POST"),this._getCacheConfiguration(i,o))}return this._fetchTokenIfExpired().then(function(){return a._spHttpClient.fetch(a._generateUrl(e,r),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),a._getRequestOptions({body:t},n,"POST"),i)})},e.prototype._post_deprecated=function(e,t,r,n){var i=this;return void 0===t&&(t=""),this._fetchTokenIfExpired().then(function(){return _.isActivated()?i._httpClient.post(i._generateUrl(e,r),s.HttpClient.configurations.v1,i._getRequestOptions({body:t},n)):i._spHttpClient.post(i._generateUrl(e,r),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),i._getRequestOptions({body:t},n))})},e.prototype._getCacheConfiguration=function(e,t){return e&&(e.extraProps||(e.extraProps=new Map),e.extraProps.set(g.a.parentKeyOverride,t)),e},e.prototype._generateUrl=function(t,r){return void 0===r&&(r=1),u.Text.format(e.MICROSERVICE_ENDPOINT,this._url,r,t)},e.prototype._generateUrlVersionedPath=function(t){return u.Text.format(e.MICROSERVICE_ENDPOINT_V,this._url,t)},e.prototype._generateVersionedPath=function(t,r){return void 0===r&&(r=1),u.Text.format(e.VERSIONED_PATH,r,t)},e.prototype._isTokenValid=function(){return this._tokenExpiry&&this._tokenExpiry>new Date},e.prototype._getTokenAndMicroserviceDetails=function(){var e,t=this,r=new a._QosMonitor("SPHomeHttpClient"),n=this._pageContext.web.absoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload";return this._spHttpClient.get(n,s.SPHttpClient.configurations.v1).then(function(t){if(e=t.correlationId?t.correlationId.toString():void 0,t.ok)return t.json();var n=new Error(t.statusText);throw r.writeUnexpectedFailure("FailedResponse",n,{correlationId:e,Status:t.status}),n}).then(function(e){if(!e.Token||!e.Token.access_token)throw t._isServiceAvailable=!1,new p;t._isServiceAvailable=!0,t._token=e.Token.access_token,t._tokenExpiry=new Date(1e3*Number(e.Token.expires_on)-15e3),t._payload=e.Payload,t._url=e.Urls[0],t._alreadyGettingTokenPromise=void 0,r.writeSuccess()}).catch(function(n){throw n instanceof p?r.writeExpectedFailure("NotAvailable",n,{correlationId:e}):r.writeUnexpectedFailure("SPHomeHttpClient",n,{correlationId:e}),t._alreadyGettingTokenPromise=void 0,n})},e.prototype._getRequestOptions=function(e,t,r){var i;void 0===e&&(e={});var a={};if(this._token&&(a.Authorization="Bearer "+this._token),this._payload&&(a["SPHome-ApiContext"]=this._payload),a["Content-Type"]="application/json",a["SPHome-ClientType"]="PagesWeb",(null===(i=this._pageContext)||void 0===i?void 0:i.legacyPageContext)&&(a.FarmLabel=this._pageContext.legacyPageContext.farmLabel),!Object(d.a)()){var o=l.SPAlternativeUrls.tryGetAlternativeUrl("AFDCDNEnabled");o&&(a["client-on-afd-spo"]=("True"===o).toString())}return r&&(a["X-HTTP-Method"]=r,e.method=r),t&&t.forEach(function(e,t){a[t]=e}),Object(n.__assign)(Object(n.__assign)({},e),{headers:Object(n.__assign)(Object(n.__assign)({},e.headers||{}),a)})},e.prototype._initializeWithPrefetchedToken=function(){var e=new a._QosMonitor("InitializeSpHomeClientContext");try{if(!this._hasPrefetchedToken)if(window._spHomeClientContext&&window._spHomeClientContext!==[]){var t=window._spHomeClientContext,r=t.Token;this._token=r&&r.AccessToken,this._payload=t.Payload,this._url=t.Urls&&t.Urls[0],this._tokenExpiry=r&&r.ExpiresOn&&new Date(1e3*Number(t.Token.ExpiresOn)-15e3),this._hasPrefetchedToken=!0,e.writeSuccess()}else window._spHomeClientContext===[]?e.writeUnexpectedFailure("SPHomeClientContextNotAvailable",new Error("EmptyTokenReturned")):e.writeExpectedFailure("SPHomeClientContextNotAvailable",new Error("TokenNotAvailable"))}catch(t){this._hasPrefetchedToken=!1,e.writeUnexpectedFailure("InitializeSPHomeClientContextFailed",t.message)}return this._hasPrefetchedToken},e.prototype._fetchTokenIfExpired=function(){if(this._isTokenValid())return Promise.resolve();if(!this._alreadyGettingTokenPromise)if(this._isPrefetchTokenFlightEnabled){var e=u.Guid.parse("928806ac-3e49-4e4e-9114-7c392215230f"),t=u.Guid.parse("5ff931f9-8682-4614-b4f1-9b8d1aa74942"),r=[{raceablePromise:this._initializeFromPrefetchedToken,raceId:e},{raceablePromise:this._getTokenAndMicroserviceDetails(),raceId:t}];this._alreadyGettingTokenPromise=o.SmartRace.race(r).then(function(e){return e.raceablePromise}).catch(function(e){throw e})}else this._alreadyGettingTokenPromise=this._getTokenAndMicroserviceDetails();return this._alreadyGettingTokenPromise},Object.defineProperty(e.prototype,"_isPrefetchTokenFlightEnabled",{get:function(){return u._SPFlight.isEnabled(1265)},enumerable:!1,configurable:!0}),e.prototype._isSubtrateSupportedUser=function(e){if(e){var t=e.isAnonymousGuestUser,r=e.isExternalGuestUser;return!t&&!r}return!0},e.serviceKey=u.ServiceKey.create("sp-component-utilities:SPHomeHttpClient",e),e.MICROSERVICE_ENDPOINT="{0}/api/v{1}/{2}",e.MICROSERVICE_ENDPOINT_V="{0}/api/{1}",e.VERSIONED_PATH="v{0}/{1}",e}()},evK2:function(e,t,r){"use strict";r.d(t,"f",function(){return i}),r.d(t,"e",function(){return a}),r.d(t,"d",function(){return o}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"c",function(){return c});var n=r("UWqr");function i(){return n._SPKillSwitch.isActivated("14b96c7e-3dcc-42e8-8a42-f56091d1f9f3")}function a(){return n._SPKillSwitch.isActivated("83c7fd57-b124-44b5-98c9-19fbfa5e8826")}function o(){return n._SPKillSwitch.isActivated("75e4c9bc-59a9-4d12-9e59-958b61cc6cfd")}function s(){return n._SPKillSwitch.isActivated("097d35a4-443f-45dc-91d2-3c504f97e929")}function u(){return n._SPKillSwitch.isActivated("4e730624-6524-45e8-9ae1-21b7dd288491")}function c(){return n._SPKillSwitch.isActivated("cb14a218-ded5-4fa1-b126-a6cf32dadaac")}},fP0x:function(e){e.exports=JSON.parse('{"b":"Unknown error happens.","a":"This Events list no longer exists. Try a different Events list."}')},g9eu:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("y88i"),i=function(){function e(){}return e.generateQueryString=function(e){var t=e.queryString||"",r=e.fields?e.fields.map(function(e){return n.UriEncoding.encodeURIComponent(e)}).join(","):void 0;return 0===(t+=this._generateOption(t,"select",r,!1)+this._generateOption(t,"filter",e.filter,!0)+this._generateOption(t,"top",e.top,!0)+this._generateOption(t,"skip",e.skip,!0)+this._generateOption(t,"orderby",e.orderBy,!0)+this._generateOption(t,"expand",e.expand,!0)).indexOf("&")&&(t=t.slice(1)),t},e._generateOption=function(e,t,r,i){return r&&-1===e.indexOf("$"+t)?"&$"+t+"="+(i?n.UriEncoding.encodeRestUriStringToken(r.toString()):r.toString()):""},e}()},hE4m:function(e){e.exports=JSON.parse('{"n":"Keep your team updated with news on your team site","m":"From the site home page you\\u0027ll be able to quickly author a news post – a status update, trip report, or even just highlight a document with some additional context provided to the team.","o":"https://go.microsoft.com/fwlink/p/?linkid=827920","q":"What is a team site?","p":"A SharePoint team site connects you and your team to the content, information, and apps you rely on every day. For example, you can use a team site to store and collaborate on files or to create and manage lists of information. On a team site home page, you can view links to important team files, apps, and web pages and see recent site activity in the activity feed.","r":"https://go.microsoft.com/fwlink/p/?linkid=827918","t":"Add a page to a site","s":"Using pages is a great way to share ideas using images, Excel, Word and PowerPoint documents, video, and more. You can create and publish pages quickly and easily, and they look great on any device. When you create a page, you add and customize web parts with a toolbox available right in the editing pane. And, you can publish with just a click.","u":"https://go.microsoft.com/fwlink/p/?linkid=827919","x":"Welcome to the new team site experience","w":"Quickly author a new news post, a status update, or a trip report on the new team site home page.","v":"SharePoint","B":"News","y":"Hub News","A":"My News","z":"Multi-site News","c":"Create a news post","e":"No news posts are available right now","b":"Keep your audience engaged by sharing your latest updates.","d":"Check back later to see the latest News.","k":"Title of news post","j":"Preview that shows the first few lines of the article.","i":"Author name","l":"A few seconds ago","a":"Automatic","f":"Build successful portals","g":"Modern SharePoint branding","h":"SharePoint News reaches more users"}')},"hiL/":function(e,t){e.exports=c},j2UY:function(e,t,r){e.exports=r.p+"icon_helpitemimg1-2x_296a0ca6.png"},jnk8:function(e,t,r){"use strict";var n=r("RSuL");r.d(t,"BaseDataSource",function(){return n.a});var i=r("ukKy");r.d(t,"SPDataSource",function(){return i.a});var a=r("g9eu");r.d(t,"ODataQueryStringBuilder",function(){return a.a}),r("CWUF")},jrLr:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"d",function(){return c}),r.d(t,"J",function(){return T}),r.d(t,"lb",function(){return C}),r.d(t,"rb",function(){return D}),r.d(t,"hb",function(){return I}),r.d(t,"ib",function(){return E}),r.d(t,"nb",function(){return R}),r.d(t,"jb",function(){return x}),r.d(t,"kb",function(){return U}),r.d(t,"pb",function(){return F}),r.d(t,"E",function(){return h}),r.d(t,"mb",function(){return g}),r.d(t,"db",function(){return _}),r.d(t,"eb",function(){return m}),r.d(t,"fb",function(){return v}),r.d(t,"H",function(){return P}),r.d(t,"r",function(){return k}),r.d(t,"v",function(){return K}),r.d(t,"A",function(){return Q}),r.d(t,"D",function(){return z}),r.d(t,"F",function(){return Z}),r.d(t,"G",function(){return J}),r.d(t,"I",function(){return he}),r.d(t,"B",function(){return ge}),r.d(t,"C",function(){return _e}),r.d(t,"qb",function(){return w}),r.d(t,"n",function(){return te}),r.d(t,"s",function(){return re}),r.d(t,"t",function(){return ne}),r.d(t,"u",function(){return ie}),r.d(t,"bb",function(){return se}),r.d(t,"Y",function(){return ue}),r.d(t,"X",function(){return G.a}),r.d(t,"f",function(){return $}),r.d(t,"h",function(){return ee}),r.d(t,"k",function(){return me}),r.d(t,"w",function(){return de}),r.d(t,"a",function(){return le}),r.d(t,"z",function(){return ae.a}),r.d(t,"Q",function(){return oe}),r.d(t,"P",function(){return fe}),r.d(t,"N",function(){return ve}),r.d(t,"ob",function(){return ye}),r.d(t,"e",function(){return Pe}),r.d(t,"y",function(){return we}),r.d(t,"x",function(){return Ce}),r.d(t,"g",function(){return De}),r.d(t,"o",function(){return Ve}),r.d(t,"q",function(){return Be}),r.d(t,"p",function(){return Qe}),r.d(t,"K",function(){return ze}),r.d(t,"L",function(){return Ke}),r.d(t,"gb",function(){return Ze}),r.d(t,"M",function(){return Xe}),r.d(t,"S",function(){return $e}),r.d(t,"W",function(){return et}),r.d(t,"V",function(){return tt}),r.d(t,"j",function(){return rt}),r.d(t,"m",function(){return nt}),r.d(t,"R",function(){return it}),r.d(t,"U",function(){return at}),r.d(t,"T",function(){return ot}),r.d(t,"i",function(){return st}),r.d(t,"l",function(){return ut}),r.d(t,"O",function(){return ct}),r.d(t,"c",function(){return lt}),r.d(t,"Z",function(){return yt}),r.d(t,"ab",function(){return _t}),r.d(t,"cb",function(){return q});var n=r("X+PM"),i=r("vlQI"),a=r("UWqr"),o=function(){function e(e){return this._options=e,this._serviceScope=e.serviceScope,this}return e.prototype.requestData=function(e){var t=this;return this.resolveServices().then(function(){return t.getItems(e)})},e.prototype.resolveServices=function(){var e=this;return new Promise(function(t,r){e._serviceScope.whenFinished(function(){e._pageContext=e._serviceScope.consume(n.PageContext.serviceKey),e._baseEndPoint=a.UrlUtilities.removeEndSlash(e._pageContext.web.absoluteUrl),e._options.useHttpClient?e._httpClient=e._serviceScope.consume(i.HttpClient.serviceKey):e._spHttpClient=e._serviceScope.consume(i.SPHttpClient.serviceKey),e._options.requiresTokenProvider&&(e._tokenProvider=e._serviceScope.consume(i.OAuthTokenProvider.serviceKey)),t()})})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spHttpClient",{get:function(){return this._spHttpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseEndPoint",{get:function(){return this._baseEndPoint},enumerable:!1,configurable:!0}),e}(),s=r("ut3N"),u=r("e+fh"),c=function(){function e(e,t){var r=this;this._qosComponentName=e,t.whenFinished(function(){r._spHomeHttpClient=t.consume(u.a.serviceKey)})}return e.prototype.addBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".AddBookmark"),r=e;return this._spHomeHttpClient.post("documents/followed/add",JSON.stringify(r)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("AddBookmark"),!1})},e.prototype.removeBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".RemoveBookmark"),r=decodeURI(e);return this._spHomeHttpClient.post("documents/followed/remove",JSON.stringify(r)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("RemoveBookmark"),!1})},e.prototype.isBookmarked=function(e){var t=new s._QosMonitor(this._qosComponentName+".IsBookmarked");return this._spHomeHttpClient.isUserSupportedBySubstrate?this._isBookmarkedRequest(e).then(function(e){return t.writeSuccess(),e.json()}).then(function(e){return e.SavedForLater}).catch(function(e){return t.writeUnexpectedFailure("IsBookmarked"),!1}):(t.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve(!1))},e.prototype._isBookmarkedRequest=function(e){var t="document/metadata?siteId="+e.siteId+"&webId="+e.webId+"&listId="+e.listId+"&uniqueId="+e.listItemUniqueId+"&url="+e.url+(e.groupId?"&groupId="+e.groupId:"");return this._spHomeHttpClient.get(t)},e}(),l=r("8dK2"),d=r("y88i"),p=r("QVYh"),f=r("hiL/"),h={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},g="newsDataSourceProp";function _(e){return e.audienceTargetingEnabled?"&filterByAudience=true":""}function m(e){var t=e.languageOverride;return t?"&languageOverride="+t:""}function v(e,t){var r="noFilter";e.serializedFilterQuery?r="filterCAMLQueryAdded":e.filterKQLQuery&&(r="filterKQLQueryAdded");var n={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:T.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:r};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(n.service="HubSite"),n}var y=r("hE4m"),S=function(){function e(){}return e.getIconUrl=function(t){if(t===e._modernizedImageKey&&!e._assetIconsMap[this._modernizedImageKey]){var n=r("/Gup");e._assetIconsMap[this._modernizedImageKey]=[n,n]}var i=e._assetIconsMap[t];return i[window.devicePixelRatio>=2&&i.length>=2?1:0]},e._assetIconsMap={HelpImg1:[r("0Res"),r("j2UY")],HelpImg2:[r("LJjX"),r("G9eg")],HelpImg3:[r("mBwh"),r("Y2xY")]},e._modernizedImageKey="HelpImgModern",e}(),P={None:0,TeamSite:1,CommSite:2,Carousel:3};function w(e,t,r){if(e&&t&&r.legacyPageContext&&r.legacyPageContext.organizationNewsSiteReference){var n=a.Guid.tryParse(e),i=a.Guid.tryParse(t);if(n&&i){var o;r.legacyPageContext.organizationNewsSiteReference&&(o=r.legacyPageContext.organizationNewsSiteReference);for(var s=0,u=o;s<u.length;s++){var c=u[s];if(b(n,i,c))return c}}}}function b(e,t,r){var n=a.Guid.tryParse(r.SiteId),i=a.Guid.tryParse(r.WebId);return n&&i&&e.equals(n)&&t.equals(i)}var T=function(){function e(){}return e.cacheViewCountsValue=function(t,r,n){var i=e.viewCountsDictionary[t+"/"+r];(void 0===i||i<n)&&(e.viewCountsDictionary[t+"/"+r]=n)},e._internalGetTeamSiteHelpItems=function(t,r){var i=void 0!==t&&t<=3?t:3,a=[],o=!1;r&&r.whenFinished(function(){var e=r.consume(n.PageContext.serviceKey);o=e.legacyPageContext.IsHomepageModernized});for(var s=[{description:o?y.w:y.m,title:o?y.x:y.n,url:o?e._mdrnHelpUrl:y.o},{description:y.p,title:y.q,url:y.r},{description:y.s,title:y.t,url:y.u}],u=0;u<i;u++){var c="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=o&&0===u?"Modern":""+(u+1);a.push({author:y.v,authorInitial:"SP",authorAccountName:"",description:s[u].description,image:S.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:s[u].title,url:s[u].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:c,siteId:c,webId:c})}return a},e.isValidNewsSource=function(e){return e===h.CurrentSite||e===h.Hub||e===h.ChooseSites||e===h.MyNews},e.getEmptyStateItems=function(t,r,n,i){switch(t){case P.CommSite:return e.getCommSiteHelpArticles(n);case P.TeamSite:return e._internalGetTeamSiteHelpItems(n,r);case P.Carousel:return e.getEmptyCarouselItems(n,i);default:return[]}},e.getCommSiteHelpArticles=function(e){for(var t=void 0!==e&&e<=3?e:3,r=[],n=0;n<t;n++){var i=a.Guid.newGuid().toString();r.push({author:y.i,authorAccountName:"",description:y.j,image:"",publishedOn:void 0,publishedOnRelativeTime:y.l,title:y.k,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:i,siteId:i,webId:i})}return r},e.getEmptyCarouselItems=function(e,t){for(var r=void 0!==e&&e<=3?e:3,n=[],i=[y.f,y.g,y.h],o=0;o<r;o++){var s=a.Guid.newGuid().toString(),u=f.DefaultImageHelper.getDefaultNewsCarouselImageById(o);u=l._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:u,spResource:u,width:t,callerId:"EmptyCarouselItems"}),n.push({author:"",authorAccountName:"",description:"",image:u,publishedOn:void 0,publishedOnRelativeTime:"",title:i[o],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:s,siteId:s,webId:s})}return n},Object.defineProperty(e,"autofillItem",{get:function(){var e=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:y.l,title:y.a,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:e,siteId:e,webId:e}},enumerable:!1,configurable:!0}),e.getTipActionNewsItem=function(e,t){var r=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:e?y.b:y.d,image:"",isContributorActionCard:e,publishedOn:void 0,publishedOnRelativeTime:"",title:e?y.c:y.e,url:e?d.Uri.concatenate(t,"/_layouts/15/CreateSitePage.aspx?source=")+d.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":y.o,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:r,siteId:r,webId:r}},e.extractNewsItemsFromSearch=function(t,r){return t.map(function(t){var n=t.SiteID?a.Guid.parse(t.SiteID).toString():void 0,i=t.WebId?a.Guid.parse(t.WebId).toString():void 0,o=t.ListId?a.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?a.Guid.parse(t.UniqueID).toString():void 0,u=t.ViewCountLifetime,c="number"==typeof u?u:void 0,l=w(n,i,r),d=t.SPWebUrl,p=e._handleDefaultBanner(t.PictureThumbnailURL);return{author:e._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",isAuthoritative:!!l,image:p||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:e.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:e._getSiteTitle(t,n,i,r),siteUrl:d,viewCounts:c,isHelpArticle:!1,uniqueId:s,siteId:n,webId:i,listId:o}})},e.extractNewsItems=function(t,r){var n=this;return t.map(function(t){var i,o=function(e){return a.Guid.parse(e).toString()},s=t.SiteID?o(t.SiteID):r.site.id.toString(),u=t.WebId?o(t.WebId):r.web.id.toString(),c=t.ListId?o(t.ListId):r.list&&r.list.id&&r.list.id.toString(),l=t.UniqueId?o(t.UniqueId):r.listItem&&r.listItem.id&&r.listItem.id.toString(),p=w(s,u,r),f=t.BannerImageUrl,h=t.BannerThumbnailUrl;i=a._SPFlight.isEnabled(1047)&&f&&f.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?e._handleDefaultBanner(f):e._handleDefaultBanner(h||f);var g=!n._isUseRedirectPageUrlKillSwitchActivated()&&r.web&&r.web.absoluteUrl&&t.Path&&t.Path.DecodedUrl?d.Uri.concatenate(r.web.absoluteUrl,"/",t.Path.DecodedUrl):t.AbsoluteUrl;return{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,description:t.Description?t.Description:"",isAuthoritative:!!p,image:i||"",publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(g),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:p?e._getSiteTitle(t,s,u,r):void 0,siteUrl:r.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:l,siteId:s,webId:u,listId:c}})},e.extractMicroserviceNewsItems=function(t,r,n){return t.map(function(t){var i,o,s,u=t.Site&&t.Site.ItemReference,c=t.Library,l=a.Guid.tryParse(u&&u.SiteId);i=l&&l.toString()||n&&r.site.id.toString();var d=a.Guid.tryParse(u&&u.WebId);o=d&&d.toString()||n&&r.web.id.toString();var p=a.Guid.tryParse(c&&c.ListId);s=p&&p.toString();var f=t.UniqueId?a.Guid.parse(t.UniqueId).toString():void 0,h=w(i,o,r),g=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||r.site.absoluteUrl,_=e._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,isAuthoritative:t.IsAuthoritativeNews||!!h,image:_||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:e.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:e._getSiteTitle(t,i,o,r),siteUrl:g,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:f,siteId:i,webId:o,listId:s}})},e.processBannerImageUrlPart=function(t,r,n,i,a,o,u){try{return e._processBannerImageUrlPartCore(t,r,n,i,a,o,u)}catch(e){var c={defaultUniqueId:r,imageWidth:i};return a&&(c.siteId=a),o&&(c.webId=a),new s._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,c),""}},e.getResourceFromPrivateCDNUrl=function(e){return l._ThumbnailUrlGenerator.getThumbnailProvider(e)===l._ThumbnailProviderType.PrivateCDN&&(e=(e="https:/"+new l._SPResourcePath(e).path).split("?")[0]),e},e.isPrefetchStale=function(e){return void 0!==this._initialUrl||(this._initialUrl=e,!1)},e.extractParamFromUrl=function(e,t){var r=new RegExp("[?&]"+e+"=([^?&]+)(&|$)");return r.test(t)?decodeURIComponent(r.exec(t)[1]):void 0},e.isNewsItemInList=function(t,r){return!(!t||!r)&&t.some(function(t,n){return t&&e.getNewsItemKey(t,""+n)===e.getNewsItemKey(r,""+n)})},e.getPaddingCount=function(e,t){var r=0;return e.emptyItemType&&(r=e.count-t,r=e.emptyItemsCount?Math.min(e.emptyItemsCount,r):r),r},e.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var r=!0;return e.every(function(e){return r=r&&t.some(function(t){return e.url===t.url})}),r},e.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},e.removeQueryParam=function(e,t){if(e&&t){var r=new d.Uri(e);return r.removeQueryParameter(t),r.toString()}return e},e.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},e.getNewsItemKey=function(e,t){return e.isHelpArticle?t:e.siteId+"-"+e.webId+"-"+e.listId+"-"+e.uniqueId},Object.defineProperty(e,"isOnSeeAllPage",{get:function(){var e=new d.Uri(window.location.href);return d.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!1,configurable:!0}),e.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},e.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",r=new l._SPResourcePath(e);if(!r.authority&&!r.domain)return e;var n=new RegExp(".+.aspx"),i=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),a=r.segments.filter(function(e){return!!e}).map(function(e){try{if(n.test(e)){var t=n.exec(i.test(e)?decodeURIComponent(e):e)[0];return e.replace(n,encodeURIComponent(t))}return e}catch(t){return e}});return d.Uri.concatenate.apply(d.Uri,[r.authority].concat(a))+t+r.searchParamString},e._shouldDeprecateDocViz=function(){return l._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},e._getSiteTitle=function(e,t,r,n){var i=e.SiteTitle;if(!i){var o=a.Guid.tryParse(t),s=a.Guid.tryParse(r);o&&s&&o.equals(n.site.id)&&s.equals(n.web.id)&&(i=n.web.title)}return i},e._getUserDisplayNameFromSearch=function(e){var t=e,r=e&&e.split("|");return r&&r.length>1&&(t=r[1]),t||""},e._handleDefaultBanner=function(t){return e._isDefaultBannerImage(t)?"":t},e._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},e._isDefaultBannerImage=function(t){return!t||d.StringHelper.doesStringEndWith(e._extractImageFromBanner(t),"/images/sitepagethumbnail.png")},e._isUseRedirectPageUrlKillSwitchActivated=function(){return a._SPKillSwitch.isActivated("5a9dc530-5eb2-4032-b8b9-b6d4222ad8ad")},e._processBannerImageUrlPartCore=function(t,r,n,i,a,o,u){var c=e._extractImageFromBanner(t),h=u||n.web.absoluteUrl,g=e._tryGetExternalBanner(n,c,"newsProcessBannerImageUrl:");if(g)return g;if(e._isDefaultBannerImage(c))return"";var _=l._ThumbnailUrlGenerator.getThumbnailProvider(c);_!==l._ThumbnailProviderType.PrivateCDN||Object(p.isAlterantiveUrlFresh)(c)||(c=(c="https:/"+new l._SPResourcePath(c).path).split("?")[0],_=l._ThumbnailProviderType.Original);var m=new l._SPResourcePath(c),v=m.path.toLowerCase();if(_===l._ThumbnailProviderType.Stock)return c;if(_===l._ThumbnailProviderType.VROOMMeTACache||_===l._ThumbnailProviderType.PrivateCDN||_===l._ThumbnailProviderType.PublicCDN||_===l._ThumbnailProviderType.MeTA)return l._ThumbnailUrlGenerator.updateThumbnailWidth(c,i);if(_===l._ThumbnailProviderType.DocViz){if(s._TraceLogger.logVerbose(e._logSource,"newsProcessBannerImageUrl: already from GetPreview"),e._shouldDeprecateDocViz()){var y=l._ThumbnailUrlGenerator.fromGetPreview(c,"newsProcessBannerImageUrl",i);if(y)return y}var S=l._PreviewUtility.normalizeWidthToResolution(i),P=new d.Uri(c);return P.setQueryParameter(l._PreviewHelper.RESOLUTION,S.toString()),P.toString()}var w=_!==l._ThumbnailProviderType.SharePointHost&&_!==l._ThumbnailProviderType.MySite;if(_!==l._ThumbnailProviderType.Unknown&&w)return l._ThumbnailUrlGenerator.updateThumbnailWidth(c,i);var b={absoluteUrl:m.authority||h,fileType:l._PreviewUtility.getFileExtension(m),spResource:v,width:i,callerId:"newsProcessBannerImageUrl"};return l._ThumbnailUrlGenerator.getThumbnailUrl(b,f.DefaultImageHelper.getDefaultImage(m))},e._tryGetExternalBanner=function(t,r,n){var i=new l._SPResourcePath(r),a="";if(i&&(a=i.authority),a&&!f.UrlUtility.isInternalResource(r,t))return s._TraceLogger.logVerbose(e._logSource,n+" external host"),r},e.aliasPrefix="FirstParty_NewsWebPart_",e.viewCountsDictionary={},e._logSource=s._LogSource.create("NewsUtilities"),e._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",e}(),C="news",D="viewCounts",I="currentViewCounts",E="hubNews",R="newsDigest",x="multiSiteNews",U="myNews",F="staleViewCounts",A=r("2q6Q");function N(e,t){return(a._BrowserDetection.getBrowserInformation().browser===a._Browser.IE||t)&&!!e}function L(e,t){return t?O(e)?"ThrottledResponse":"ResponseNotOk":"AzureFrontDoorHeadersMissing"}function O(e){return 429===e||503===e}var q=function(){function e(e){var t=this;e.whenFinished(function(){t._sphomeHttpClient=e.consume(u.a.serviceKey)})}return e.prototype.getViewCounts=function(e){var t=this;if(0===e.length)return Promise.resolve([]);var r=new A._QosMonitor("ExchangeViewCountsFetch");if(!this._sphomeHttpClient.isUserSupportedBySubstrate)return r.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve([]);var n=this._requestForItem(e);return this._sphomeHttpClient.post("documents/metadata",JSON.stringify(n)).then(function(e){if(e.ok)return e.json();var t=function(e){var t={MSCV:e.headers.get("MS-CV"),responseStatus:e.status.toString()},r=N(t.MSCV,e.url);return t.errorCode=L(e.status,r),t}(e),n=t.errorCode,i=new Error(n);throw r.writeUnexpectedFailure(n,i,t),i}).then(function(n){return r.writeSuccess(),e.map(function(e){return t._addMicroserviceViewCount(e,n.Items)})}).catch(function(e){return r.hasEnded||r.writeUnexpectedFailure("ExchangeViewCountsFetchSearchFallback",e),[]})},e.prototype._addMicroserviceViewCount=function(e,t){var r=this,n=t.filter(function(t){return r._guidEquals(t.Site.ItemReference.SiteId,e.siteId)&&r._guidEquals(t.Site.ItemReference.WebId,e.webId)&&r._guidEquals(t.UniqueId,e.uniqueId)})[0];return n&&void 0!==n.Views&&(e.viewCount=n.Views),e},e.prototype._guidEquals=function(e,t){var r=a.Guid.tryParse(e),n=a.Guid.tryParse(t);return r&&n&&r.equals(n)},e.prototype._requestForItem=function(e){return[].concat.apply([],e.map(function(e){return[{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"},{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"GroupReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"}]}))},e.serviceKey=a.ServiceKey.create("sp-dataproviders:ViewCountDataProvider",e),e}(),M=r("Pk8u"),k=function(){function e(e){var t=this;this.id="ExchangeViewCounts",this.title="",this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._viewCountDataSource=t.options.serviceScope.consume(q.serviceKey)})}return e._getViewCountFromCacheIfAvailable=function(e){this._viewCountCache.hasOwnProperty(e.uniqueId)&&(e.viewCounts=this._viewCountCache[e.uniqueId])},e._cacheViewCounts=function(e){var t=this;e.forEach(function(e){void 0!==e.uniqueId&&(t._viewCountCache[e.uniqueId]=e.viewCounts)})},e.prototype.requestData=function(e){var t=Object(M.chunk)(e,10);return Promise.all(t.map(this._createRequestForItems.bind(this))).then(function(){return e})},e.prototype._addViewCountsToItems=function(e,t){return e.filter(this._needsViewCount).map(function(e){var r=t.filter(function(t){return t.uniqueId===e.uniqueId||t.siteId===e.siteId&&t.webId===e.webId&&t.listItemId===Number(e.listItemId)})[0];return e.viewCounts=void 0!==r?Number(r.viewCount):void 0,e})},e.prototype._createRequestForItems=function(t){var r=this;return this._viewCountDataSource.getViewCounts(this._buildRequest(t)).then(function(n){return t=r._addViewCountsToItems(t,n),e._cacheViewCounts(t),t})},e.prototype._buildRequest=function(e){var t=this._pageContext.site.id.toString(),r=this._pageContext.web.id.toString();return e.filter(this._needsViewCount).map(function(e){return{listItemId:Number(e.listItemId)||0,uniqueId:e.uniqueId,siteId:e.siteId||t,webId:e.webId||r,listId:e.listId}})},e.prototype._needsViewCount=function(t){e._getViewCountFromCacheIfAvailable(t);var r=t.viewCounts;return null==r||"number"!=typeof r},e._viewCountCache={},e}(),j=r("17wl"),H=function(){function e(){}return e.isTieredCachingEnabled=function(){var e=this._isMySiteCacheEnabled(),t=this._isIndexedDBEnabled();return a._SPFlight.isEnabled(1703)&&(e||t)},e.isCacheAndNetworkEnabled=function(){return this._isMySiteCacheEnabled()},e._isIndexedDBEnabled=function(){return a._SPFlight.isEnabled(1693)||1===A._SPPerfExperiment.getVariantAndTrackExperiment(A._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)},e._isMySiteCacheEnabled=function(){return a._SPFlight.isEnabled(1705)||1===A._SPPerfExperiment.getVariantAndTrackExperiment(A._PerformanceExperiment.WEXMySiteCacheTieredCachingExp)},e}();function V(){return a._SPFlight.isEnabled(60013)}function B(){return a._SPFlight.isEnabled(60218)||1===A._SPPerfExperiment.getVariantAndTrackExperiment(A._PerformanceExperiment.SOXEventUpdate)}var G=r("nJGZ"),Q=function(){function e(e){var t=this;this._maxRetryCount=3,this._processRawData=function(e,r,n){var i=T.getPaddingCount(r,e.Items?e.Items.length:0),a=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,a,e);var o=a?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(T.getEmptyStateItems(r.emptyItemType,t.options.serviceScope,i,r.webpartWidth)),n.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(u.a.serviceKey)})}return Object.defineProperty(e.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!1,configurable:!0}),e.prototype.requestData=function(t){var r=this,n=0,i=e._requestCount++;return this._addPageUsageStartData(i),H.isTieredCachingEnabled()?this._requestData(t,n).then(function(e){return r._addPageUsageEndData(i,n),e}).catch(function(e){if(++n<r._maxRetryCount&&r.shouldRetryDataFetch(e))return r._requestData(t,n).then(function(e){return r._addPageUsageEndData(i,n),e});throw r._addPageUsageEndData(i,n,!0),e}):this._requestDataWithRetry(t,n).then(function(e){return r._addPageUsageEndData(i,n),e}).catch(function(e){if(++n<r._maxRetryCount&&r.shouldRetryDataFetch(e))return r._requestDataWithRetry(t,n).then(function(e){return r._addPageUsageEndData(i,n),e});throw r._addPageUsageEndData(i,n,!0),e})},e.prototype.extractMicroserviceNewsItems=function(e){return T.extractMicroserviceNewsItems(e,this._pageContext)},e.prototype.shouldRetryDataFetch=function(e){return"UnexpectedRetryableError"===e.message},e.prototype._applyCacheAndNetwork=function(e,t,r){var n=this,i=new s._QosMonitor(this.qosMonitorLabel+".getNewsItemsInSmartRace"),o=this._processHttpClientResponsePromise(e.serverResponse,t,i).then(function(e){var r=n._isEmptyResponse(e);return t.onServerResponseResolved(r),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),u=new s._QosMonitor(this.qosMonitorLabel+".getCachedNewsItemsInSmartRace"),c=G.a.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t,u).then(function(e){var r=n._isEmptyResponse(e);return t.onCacheResponseResolved(r),e}).catch(function(e){throw u.writeUnexpectedFailure("ParseCacheResultsFailed",e),t.onCacheResponseFailed(e),e}),l=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),d=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),p=[{raceablePromise:c,raceId:l},{raceablePromise:o,raceId:d}];return f.SmartRace.race(p).then(function(e){return e.raceId===l&&o.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),r.writeSuccess({cacheStatus:e.raceId===l?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw r.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.prototype._addPageUsageStartData=function(e){var t=A._PageUsageAdapter.getInstance(),r=t.elapsedTime();t.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-StartTime-"+e,r.toFixed(2))},e.prototype._addPageUsageEndData=function(e,t,r){var n=A._PageUsageAdapter.getInstance(),i=n.elapsedTime();n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-EndTime-"+e+"-"+t,i.toFixed(2)),r&&n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-"+e+"-"+t+"-Failure")},e.prototype._addMoreAdditionalFields=function(e){this._extraData.spHomeServer=e.headers.get("sphome-server");var t=e.headers.get("sphome-sharepointid");t&&(this._extraData.spHomeSharepointId=t)},e.prototype._addCacheAndServerEmptyStateLogs=function(e,t,r,n){var i=this,a=t&&r,o=a?"Cache":"";return e.then(function(e){var r=i._isEmptyResponse(e);if(n.onServerResponseResolved(r),r||a){var s=r?"Server":"";i._writeToEmptyResultsMonitor(t,""+o+s+"EmptyResponse")}return e}).catch(function(e){throw i._writeToEmptyResultsMonitor(t,o+"Server_Response_Parse_Error",e),n.onServerResponseFailed(e),e})},e.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!O(e)},e.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!O(e)},e.prototype._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!t||0===t.length},e.prototype._isRawData=function(e){return e&&void 0!==e.Items},e.prototype._logEmptyResultToQos=function(e,t,r){var n=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems.EmptyResults");t?n.writeUnexpectedFailure("EmptyResponse",new Error("200 "+(r.Items?"0 Items":"No Items")),e):n.writeSuccess(e)},e.prototype._logThrottledResultToQos=function(e,t){if(O(t)){var r=new s._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,r.writeSuccess(e)}},e.prototype._parseClientCachableResponse=function(e,t,r){var n=this,i=e.cachedResponse&&G.a.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,r),a=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,r):void 0;return i?(i.then(function(e){var r=n._isEmptyResponse(e);if(t.onCacheResponseResolved(r),a)n._addCacheAndServerEmptyStateLogs(a,!0,r,t).then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){});else{var i=r?"Cache":"";r&&n._writeToEmptyResultsMonitor(!0,i+"EmptyResponse")}}).catch(function(e){t.onCacheResponseFailed(e)}),i):(r.writeSuccess(this._extraData),this._addCacheAndServerEmptyStateLogs(a,!1,!0,t))},e.prototype._parseHttpClientResponse=function(e,t,r){var n=this,i=v(t);i.responseStatus=e.status.toString();var a=N(i.MSCV,i.URL),o=L(e.status,a);return e.ok?e.json().then(function(e){var a=n._processRawData(e,t,r);return r.writeSuccess(i),a}).catch(function(e){throw r.writeUnexpectedFailure(o,e,i),e}):(r.writeUnexpectedFailure(o,new Error("UnexpectedError"),i),Promise.reject())},e.prototype._processHttpClientResponsePromise=function(e,t,r){var n,i=this;return e.then(function(e){return n=e,e.json()}).then(function(e){return i._processMicroserviceServiceResponse(e,t,r,n)})},e.prototype._processMicroserviceServiceResponse=function(e,t,r,n){this._extraData.URL=T.removeQueryParam(n.url,"mainSiteUrl"),this._extraData.MSCV=n.headers.get("MS-CV"),this._addMoreAdditionalFields(n);var i=N(this._extraData.MSCV,this._extraData.URL);if(n.ok&&i)return this._processRawData(e,t,r);var a=n.status,o=L(a,i);this._extraData.statusCode=a.toString(),this._extraData.responseStatus=n.statusText;var s=void 0,u=e;throw this._getIsExpectedError(a)?(s=new Error("ExpectedError"),this._extraData.id=u.ErrorLabel,r.writeExpectedFailure(o,s,this._extraData)):(this._getIsUnExpectedRetryableError(a)?s=new Error("UnexpectedRetryableError"):(s=new Error("UnexpectedError"),this._logThrottledResultToQos(this._extraData,a)),this._extraData.id=u.ErrorLabel,r.writeUnexpectedFailure(o,s,this._extraData)),s},e.prototype._requestData=function(e,t){var r=this,n=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems");return this._extraData=v(e,this._pageContext),this._extraData.retryCount=t,this.executeRequest(e).then(function(t){if(t instanceof i.HttpClientResponse)return r._parseHttpClientResponse(t,e,n);if(H.isCacheAndNetworkEnabled()){var a=t;if(a.serverResponse&&a.cachedResponse)return r._applyCacheAndNetwork(a,e,n)}var o=t;return r._parseClientCachableResponse(o,e,n)}).catch(function(e){if(!n.hasEnded&&0===r._extraData.retryCount)if(e instanceof u.b)n.writeUnexpectedFailure("TokenNotAvailable",e,r._extraData);else{var t=e.message;e=new Error("UnexpectedError"),n.writeUnexpectedFailure(t,e,r._extraData)}throw e})},e.prototype._requestDataWithRetry=function(e,t){var r,n,i=this,a=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems"),o=!1;return this._extraData=v(e,this._pageContext),this._extraData.retryCount=t,this.executeRequest_deprecated(e).then(function(e){return r=e,i._extraData.URL=T.removeQueryParam(e.url,"mainSiteUrl"),i._extraData.MSCV=e.headers.get("MS-CV"),i._addMoreAdditionalFields(e),n=N(i._extraData.MSCV,i._extraData.URL),o=e.ok&&!!n,e.json()}).then(function(t){if(o)return i._processRawData(t,e,a);var s=r.status,u=L(s,n);i._extraData.statusCode=s.toString(),i._extraData.responseStatus=r.statusText;var c=void 0,l=t;throw i._getIsExpectedError(s)?(c=new Error("ExpectedError"),i._extraData.id=l.ErrorLabel,a.writeExpectedFailure(u,c,i._extraData)):(i._getIsUnExpectedRetryableError(s)?c=new Error("UnexpectedRetryableError"):(c=new Error("UnexpectedError"),i._logThrottledResultToQos(i._extraData,s)),i._extraData.id=l.ErrorLabel,a.writeUnexpectedFailure(u,c,i._extraData)),c}).catch(function(e){if(!a.hasEnded&&0===i._extraData.retryCount)if(e instanceof u.b)a.writeUnexpectedFailure("TokenNotAvailable",e,i._extraData);else{var t=e.message;e=new Error("UnexpectedError"),a.writeUnexpectedFailure(t,e,i._extraData)}throw e})},e.prototype._writeToEmptyResultsMonitor=function(e,t,r){var n=new s._QosMonitor("GetNewsItems.ZeroResult");this._extraData.mySiteCacheHit=e,this._extraData.dataProvider=this.qosMonitorLabel,this._extraData.source=t,r?n.writeUnexpectedFailure(t,r,this._extraData):e&&"CacheServerEmptyResponse"===t?n.writeExpectedFailure(t,new Error("Expected Cache and Server Empty Result"),this._extraData):n.writeSuccess(this._extraData)},e._requestCount=0,e}(),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=y.y,t}return Object(j.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return T.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),T.getFilterQueryBody(e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=H.isCacheAndNetworkEnabled(),r={alias:T.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[G.a.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),T.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="departmentId="+e.hubId+"&start="+e.skip+"&count="+e.count;return"news/hub/filtered?"+((t+=_(e))+m(e))},t}(Q),W=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},z=function(){function e(e){var t=this;return this.id="News",this.title=y.B,this.options=e,this._isTieredCachingEnabled=H.isTieredCachingEnabled(),this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._absoluteUrl=void 0===t._pageContext?void 0:t._pageContext.web.absoluteUrl}),d.Locale.language||(d.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t=this;return this._executeRequest(e).then(function(r){if(r instanceof i.SPHttpClientResponse)return t._parseSPHttpClientResponse(r,e);if(H.isCacheAndNetworkEnabled()){var n=r;if(n.serverResponse&&n.cachedResponse)return t._applyCacheAndNetwork(n,e)}return t._parseClientCachableResponse(r,e)})},e.prototype._applyCacheAndNetwork=function(e,t){var r=this,n=e.serverResponse.then(function(e){return r._parseSPHttpClientResponse(e,t,!0)}).then(function(e){var n=r._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),i=G.a.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=r._isEmptyResponse(e);return t.onCacheResponseResolved(n),e}).catch(function(e){throw t.onCacheResponseFailed(e),e}),o=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),s=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),u=[{raceablePromise:i,raceId:o},{raceablePromise:n,raceId:s}];return f.SmartRace.race(u).then(function(e){return e.raceId===o&&n.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),e.raceablePromise})},e.prototype._executeRequest=function(e){var t={metadataFilter:e.serializedFilterQuery,languageOverride:e.languageOverride},r={body:JSON.stringify(t),headers:new W("POST")};if(this._isTieredCachingEnabled){r.method="POST";var n=H.isCacheAndNetworkEnabled(),a={alias:T.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:n?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[G.a.useStalePropName,!0]])};return e.canCacheRequest||(a.cacheStrategy=i._CacheStrategy.NetworkOnly),this._spHttpClient.fetch(this._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,r,a)}return this._spHttpClient.post(this._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,r)},e.prototype._getNewsItemsUrl=function(e){return d.UriEncoding.escapeUrlForCallback(this._absoluteUrl)+"/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true&$skip="+(e.skip?e.skip.toString():"0")+"&$top="+(e.count>0?e.count.toString():"")+"&$expand=CreatedBy&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path"},e.prototype._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!t||0===t.length},e.prototype._isRawData=function(e){return e&&e.value},e.prototype._parseClientCachableResponse=function(e,t){var r=this,n=e.serverResponse?e.serverResponse.then(function(e){return r._parseSPHttpClientResponse(e,t)}).then(function(e){var n=r._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e}):void 0;return e.cachedResponse?(n&&n.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),G.a.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=r._isEmptyResponse(e);return t.onCacheResponseResolved(n),e}).catch(function(e){throw t.onCacheResponseFailed(e),e})):n},e.prototype._parseSPHttpClientResponse=function(e,t,r){var n=this,i=v(t),a=r?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=new A._QosMonitor(a);if(i.correlationId=""+e.correlationId,i.responseStatus=""+e.status,i.message=e.statusMessage,e.ok)return e.json().then(function(e){var r=n._processRawData(e,t);return o.writeSuccess(i),r}).catch(function(e){throw o.writeUnexpectedFailure("Unexpected",e,i),e});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),Promise.reject(s)},e.prototype._processRawData=function(e,t){var r=T.getPaddingCount(t,e.value?e.value.length:0);return(e.value&&e.value.length>0?T.extractNewsItems(e.value,this._pageContext):[]).concat(T.getEmptyStateItems(t.emptyItemType,this.options.serviceScope,r,t.webpartWidth))},e}(),Z=function(){function e(e){this.id=R,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}(),J=function(){function e(e,t,r){return a.Validate.isNotNullOrUndefined(e,"pageContext"),this._pageContext=e,this._spHttpClient=t,this._newsDigestBubbleType=r,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){return this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+d.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!1,configurable:!0}),e.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},e.prototype.writeCachedFirstRunExperience=function(t){var r=this._newsDigestBubbleType,n=window.localStorage.getItem(r),i=String(t);if(n!==i)try{window.localStorage.setItem(r,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e.prototype.showFirstRun=function(){var t=e.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this.getFirstRunBitApi()},e.prototype.setFirstRunSeen=function(t){var r=this,n=new A._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),a={};a[this._newsDigestBubbleType]=Boolean(t);var o="application/json; odata=minimalmetadata",u=new Headers;return u.append("Accept","*/*, "+o),u.append("Content-Type",o),u.append("X-HTTP-Method","PATCH"),u.append("X-ClientType","NewsDigest_SetFirstRunBit"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(a),headers:u}).then(function(i){s._TraceLogger.logVerbose(e._logSource,"Set news digest first run bit to API: "+t),n.writeSuccess(),r.writeCachedFirstRunExperience(t)}).catch(function(t){throw s._TraceLogger.logError(e._logSource,t),n.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",t),t})},e.prototype.getFirstRunBitApi=function(){var t=this,r=new A._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),n=new Headers;return n.append("X-ClientType","NewsDigest_GetFirstRunBit"),this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,i.SPHttpClient.configurations.v1,{headers:n}).then(function(e){return e.json()}).then(function(n){var i=n[t._newsDigestBubbleType];return s._TraceLogger.logVerbose(e._logSource,"Get news digest first run bit from API, status: "+i),r.writeSuccess(),t.writeCachedFirstRunExperience(i),!i}).catch(function(t){return s._TraceLogger.logError(e._logSource,t),r.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",t),!1})},e._logSource=s._LogSource.create("NewsDigestFirstRunDataProvider"),e}(),Y=r("zDft"),X=r("S/19"),$={CurrentSite:1,CurrentSiteCollection:2,AllSites:3,CurrentSiteDocumentLibrary:4,AllSitesInTheHub:5,CurrentSitePageLibrary:6,CurrentSiteEventsList:7,SelectedSites:99},ee={Document:1,Page:2,Video:3,Event:4,Issue:5,Task:6,Link:7,Contact:8,Image:9,News:10,All:99},te={Word:1,Excel:2,PowerPoint:3,OneNote:4,Visio:5,PDF:10,Any:99},re={Equals:1,NotEqual:2,BeginsWith:3,EndsWith:4,Contains:5,DoesNotContain:6,LessThan:7,GreaterThan:8,Between:9,GreaterThanOrEqualTo:10,LessThanOrEqualTo:11,IsNull:12},ne={Today:1,Yesterday:2,ThisWeek:3,ThisMonth:4,LastMonth:5,ThisYear:6,LastYear:7},ie={TitleContaining:1,AnyTextContaining:2,TaggedWith:3,CreatedBy:4,ModifiedBy:5,Field:6,RecentlyChanged:7,RecentlyAdded:8,PageAuthorByline:9},ae=r("ui8f"),oe={MostRecent:1,MostViewed:2,Trending:3,FieldAscending:4,FieldDescending:5},se={CurrentUser:1,SpecificUser:2},ue=function(){function e(){}return e.isValidMeToken=function(e){return new RegExp("^\\[me\\]$","i").test(e)},e.isValidTodayToken=function(e){return new RegExp("^\\[today\\]([\\+|\\-]\\d+$)?$","i").test(e)},e}(),ce=r("evK2"),le="(ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)",de=function(){function e(){}return e.generateKqlFromFilters=function(e){var t="",r=!1;if(!e||!e.query||!e.query.filters)return{expr:t,isFilteringByDate:r};for(var n=Object(M.clone)(e.query.filters),i=n.length;i--;)void 0!==n[i].value&&""!==n[i].value||void 0!==n[i].userType&&n[i].userType!==se.SpecificUser||n.splice(i,1);n=n.sort(function(e,t){return e.filterType-t.filterType});for(var a=!1,o=0;o<n.length;o++){o>0&&(t+=" "+(a?"OR":"AND")+" ");var s=n[o],u=o<n.length-1?n[o+1]:{};a||void 0===u.value||s.filterType!==u.filterType||(t+="(",a=!0);var c=this._kqlFilter(s,e.queryableManagedProperties);t+=c.expr,r=r||c.isFilteringByDate,a&&s.filterType!==u.filterType&&(t+=")",a=!1)}return t.length>0&&(t+=" AND"),{expr:t,isFilteringByDate:r}},e.generateKqlFromFilterGroup=function(e){if(!e||!e.query||!e.query.filterGroup)return{expr:"",isFilteringByDate:!1};var t=this._buildFilterGroupExpr(e.query.filterGroup,e.queryableManagedProperties);return t.expr.length>0&&(t.expr+=" AND"),t},e.generateQuery=function(e,t){var r="";if(!e||!e.query)return{queryTemplate:r};var n=!1,i=!1;if(e.query.advancedQueryText)r=e.query.advancedQueryText;else if(e.query.filterGroup)r=(a=this.generateKqlFromFilterGroup(e)).expr,n=a.isFilteringByDate;else if(e.query.filters){var a;r=(a=this.generateKqlFromFilters(e)).expr,n=a.isFilteringByDate}r.length>0&&(i=!0),r+=" "+this.generateContentLocationKqlQuery(e),r+=this._generateContentKql(e,i);var o=void 0;return n&&(o=t.user.preferUserTimeZone?t.user.timeZoneInfo.id:t.web.timeZoneInfo.id),e.audienceTarget&&(r=r.trim()+" "+le),{queryTemplate:r.trim(),timeZoneId:o}},e.generateContentLocationKqlQuery=function(e){var t=this;switch(e.query.contentLocation){case $.AllSitesInTheHub:return""+this._siteCriteria(e.hubSiteId,"DepartmentId");case $.CurrentSite:return this._generateSiteIdCriteria(e.siteId,e.webId);case $.CurrentSiteCollection:return"("+this._siteCriteria(e.siteId,"NormSiteID")+")";case $.SelectedSites:if(e.siteIds&&e.siteIds.length>0)return"("+e.siteIds.map(function(e){return t._generateSiteIdCriteria(e.siteId,e.webId)}).join(" OR ")+")"}return""},e.generateSearchAPIQueryOptions=function(e,t,r){var n=r.isPrivateGroup;!n&&r.query&&(n=r.query.contentLocation===$.AllSites||r.query.contentLocation===$.AllSitesInTheHub);var i=n?"True":"False",a=r.enableMultiGeoSearch?"True":"False",o={ClientType:r.clientType,QueryTemplate:e,TimeZoneId:t,SelectProperties:["ContentType","ContentTypeId","Title","EditorOwsUser","ModifiedBy","LastModifiedBy","FileExtension","FileType","Path","SiteName","SiteTitle","PictureThumbnailURL","DefaultEncodingURL","LastModifiedTime","ListID","ListItemID","SiteID","WebId","UniqueID"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:i,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:a,QueryPropertyValueTypeIndex:3}}],SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",TrimDuplicates:!1};if(e.indexOf("ContentTypeId:0x0106*")>-1&&o.SelectProperties.push("UserName","WorkEmail","OrgNames","JobTitle","WorkPhone","MobilePhone"),r.query&&r.query.filters){for(var s=r.query.filters,u=!1,c=!1,l=0;l<s.length;l++)switch(s[l].filterType){case ie.RecentlyAdded:u=!0;break;case ie.RecentlyChanged:c=!0}u&&o.SelectProperties.push("Created"),c&&o.SelectProperties.push("LastModifiedTime")}if(r.selectProperties){var d={};for(l=0;l<o.SelectProperties.length;l++)d[o.SelectProperties[l]]=!0;for(l=0;l<r.selectProperties.length;l++)this._addSelectField(o.SelectProperties,r.selectProperties[l],d)}if(r.maxItemsPerPage&&(o.RowLimit=r.maxItemsPerPage,o.RowsPerPage=r.maxItemsPerPage),r.startRow&&(o.StartRow=r.startRow),r.query)switch(r.query.sortType){case oe.MostRecent:o.SortList=[{Property:"LastModifiedTime",Direction:Y.a.descending}];break;case oe.MostViewed:o.SortList=[{Property:"ViewsLifeTime",Direction:Y.a.descending}];break;case oe.Trending:o.SortList=[{Property:"ViewsRecent",Direction:Y.a.descending}];break;case oe.FieldAscending:case oe.FieldDescending:r.query.sortField&&(o.SortList=[{Property:r.query.sortField,Direction:r.query.sortType===oe.FieldAscending?Y.a.ascending:Y.a.descending}])}return o},e.generateSearchAPIQueryOptionsForManagedProperties=function(e){var t,r=e.query,n=r.managedPropertiesRefinerOptions,i=isNaN(n.limit)?5e4:n.limit,a=n.managedPropertyMatchText?"*"+n.managedPropertyMatchText+"*":"*",o=btoa(Object(M.unescape)(encodeURIComponent(a)));switch(r.contentLocation){case $.CurrentSite:t=e.webAbsoluteUrl;break;case $.CurrentSiteCollection:t=e.siteAbsoluteUrl;break;case $.AllSites:default:t=new URL(e.webAbsoluteUrl).origin}var s='path:"'+t+'" '+this._generateContentKql(e,!1);return{ClientType:e.clientType,SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",Querytext:s,Refiners:"ManagedProperties(filter3i="+i+"/0/"+o+",sort=name/ascending)",EnableQueryRules:!1,ProcessBestBets:!1,ProcessPersonalFavorites:!1,Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:"False",QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"SchemaLookup",QueryPropertyValueTypeIndex:1}}]}},e._buildFilterGroupExpr=function(e,t){var r=this,n="",i=!1;return e.filters&&e.filters.forEach(function(a){if(void 0!==a.value&&""!==a.value||void 0!==a.userType&&a.userType!==se.SpecificUser){var o=r._kqlFilter(a,t);i=i||o.isFilteringByDate,n=r._chainKqlFilterExpr(n,o,e.logicalOperator)}}),e.filterGroups&&e.filterGroups.forEach(function(a){var o=r._buildFilterGroupExpr(a,t);i=i||o.isFilteringByDate,n=r._chainKqlFilterExpr(n,o,e.logicalOperator)}),n&&(n+=")"),{expr:n,isFilteringByDate:i}},e._chainKqlFilterExpr=function(e,t,r){var n=e;return t.expr&&(n?n+=" "+r+" ":n="(",n+=t.expr),n},e._generateContentKql=function(e,t){var r=e.query,n=e.languageCode,i="",o="(FileType="+f.spConstants.imageExtensions.join(" OR FileType=")+")",s=r.contentTypes||[ee.Document],u=!1;s.indexOf(ee.All)>-1&&(u=!0,r.contentLocation!==$.AllSites||t||(i+="*"));var c=!1,l=!1;if(!u)for(var d="",p=0;p<s.length;++p)switch(1===p&&(d=" OR"),s[p]){case ee.Document:i=this._appendCriteriaUniquely(i,d,"IsDocument:1"),c||(i+=" AND NOT (FileType:aspx OR FileType:html OR FileType:htm OR FileType:mhtml)"),c=!0;break;case ee.Page:i=this._appendCriteriaUniquely(i,d,"(ContentTypeId:0x010108* OR ContentTypeId:0x01010901* OR ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* OR ContentTypeId:0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39*)",n),l||(i+=" AND NOT (FileType:one OR FileType:onepkg OR FileType:ms-one-stub OR FileType:onetoc OR FileType:onetoc2)"),l=!0;break;case ee.News:i=this._appendCriteriaUniquely(i,d,"(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState=2)",n);break;case ee.Event:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x0102*");break;case ee.Issue:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x0103*");break;case ee.Task:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x0108*");break;case ee.Link:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x0105*");break;case ee.Contact:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x0106*");break;case ee.Video:i=this._appendCriteriaUniquely(i,d,"ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012*"),a._SPFlight.isEnabled(1538)&&(""===d&&(i+=" OR "),i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(Object(j.__spreadArrays)(f.spConstants.videoExtensions))));break;case ee.Image:i=this._appendCriteriaUniquely(i,d,o)}if(n&&u&&(i+=(Object(ce.e)()?" AND":"")+" (SPTranslationLanguage:"+n+" OR (NOT SPTranslatedLanguages:"+n+" AND NOT SPIsTranslation:true))"),c||u){var h=r.documentTypes||[te.Any];if(-1===h.indexOf(te.Any))for(d="",p=0;p<h.length;++p)switch(1===p&&(d=" OR"),h[p]){case te.Word:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["doc","docm","docx"]));break;case te.Excel:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case te.PowerPoint:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case te.OneNote:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["one","onepkg","ms-one-stub","onetoc","onetoc2"]));break;case te.Visio:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case te.PDF:i=this._appendCriteriaUniquely(i,d,this._documentTypeCriteria(["pdf"]))}}return i&&" ("+i.trim()+")"},e._addSelectField=function(e,t,r){r[t]||(r[t]=!0,e.push(t))},e._generateSiteIdCriteria=function(e,t){return"("+this._siteCriteria(e,"NormSiteID")+" AND "+this._siteCriteria(t,"NormWebId")+")"},e._siteCriteria=function(e,t){return"DepartmentId"===t?"("+t+":"+e+" OR "+t+":{"+e+"})":t+":"+e},e._appendCriteriaUniquely=function(e,t,r,n){return-1===e.indexOf(r)&&(n&&(r+=(Object(ce.e)()?" AND ":"")+" (SPTranslationLanguage:"+n+" OR (NOT SPTranslatedLanguages:"+n+" AND NOT SPIsTranslation:true))"),e+=t+" "+r),e},e._kqlFilter=function(e,t){var r=" ",n=!1;if(e&&(void 0!==e.value||void 0!==e.userType)){var i=void 0!==e.value?e.value.toString():"",a=void 0;switch(e.filterType){case ie.TitleContaining:r+=i?'title:"'+i+'"':"";break;case ie.AnyTextContaining:r+=i?'"'+i+'"':"";break;case ie.TaggedWith:r+=i?'tags:"'+i+'"':"";break;case ie.CreatedBy:e.userType===se.CurrentUser?r+="createdby:{User}":i&&(ue.isValidMeToken(i)?r+="createdby:{User}":r+='createdby:"'+i+'"');break;case ie.ModifiedBy:e.userType===se.CurrentUser?r+="modifiedby:{User}":i&&(ue.isValidMeToken(i)?r+="modifiedby:{User}":r+='modifiedby:"'+i+'"');break;case ie.RecentlyAdded:a="Created";break;case ie.RecentlyChanged:a="LastModifiedTime";break;case ie.Field:if(t){var o=this._managedPropertyFilter(e,t);r+=o.expr,n=o.isFilteringByDate}}if(a)switch(n=!0,this._filterSince(i)){case ne.Today:r+=a+"=today";break;case ne.Yesterday:r+="("+a+"=today OR "+a+"=yesterday)";break;case ne.ThisWeek:r+=a+'="this week"';break;case ne.ThisMonth:r+=a+'="this month"';break;case ne.LastMonth:r+="("+a+'="this month" OR '+a+'="last month")';break;case ne.ThisYear:r+=a+'="this year"';break;case ne.LastYear:r+="("+a+'="this year" OR '+a+'="last year")'}}return{expr:r.trim(),isFilteringByDate:n}},e._filterSince=function(e){try{return parseInt(e,10)}catch(e){return ne.ThisMonth}},e._documentTypeCriteria=function(e){return"(FileType:"+e.join(" OR FileType:")+")"},e._managedPropertyFilter=function(e,t){var r=e.fieldInfo||t[e.fieldname];r=r||ae.a.Text;var n=this._parseManagedFieldValue(e.value,r),i="",a=r===ae.a.DateTime;if(""===n.trim()&&e.op!==re.Equals&&e.op!==re.NotEqual&&e.op!==re.Between)return{expr:"",isFilteringByDate:!1};switch(e.op){case re.BeginsWith:var o=n.substr(1,n.length-2);i=e.fieldname+'="'+o+'*"';break;case re.Between:var s=this._parseManagedFieldValue(e.value2,r);""!==n.trim()&&""!==s.trim()?i=e.fieldname+">="+n+" AND "+e.fieldname+"<="+s:""!==n.trim()?i=e.fieldname+">="+n:""!==s.trim()&&(i=e.fieldname+"<="+s);break;case re.Contains:i=e.fieldname+":"+n;break;case re.DoesNotContain:i="-"+e.fieldname+":"+n;break;case re.Equals:i=e.fieldname+"="+n;break;case re.GreaterThan:i=e.fieldname+">"+n;break;case re.GreaterThanOrEqualTo:i=e.fieldname+">="+n;break;case re.LessThan:i=e.fieldname+"<"+n;break;case re.LessThanOrEqualTo:i=e.fieldname+"<="+n;break;case re.NotEqual:i="-"+e.fieldname+"="+n}return{expr:i,isFilteringByDate:a}},e._parseManagedFieldValue=function(e,t){var r="";switch(t){case ae.a.DateTime:if("string"==typeof e&&ue.isValidTodayToken(e)){var n=e.substr("[today]".length)||"";return n?"{Today"+n+"}":"{Today}"}var i=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(i)&&(isNaN(i.getTime())||(r='"'+i.toISOString()+'"'));break;case ae.a.Decimal:case ae.a.Double:var a=parseFloat(e.toString());isNaN(a)||(r=a.toString());break;case ae.a.Integer:var o=parseInt(e.toString(),10);isNaN(o)||(r=o.toString());break;case ae.a.Text:r="string"==typeof e&&ue.isValidMeToken(e)?"{User}":'"'+e.toString().trim()+'"';break;case ae.a.YesNo:r=e?"true":"false"}return r},e}(),pe=r("9G/9"),fe=function(){function e(e){var t=this;return this.id="Search",this.title=pe.a,this.options=e,this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._initVariables()}),this._searchAPIRequest=new X.SearchAPIRequest(e.serviceScope,!1,e.qosPrefix||""),d.Locale.language||(d.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t;if(Object(M.has)(e.searchOptions,"query.managedPropertiesRefinerOptions"))return t=de.generateSearchAPIQueryOptionsForManagedProperties(e.searchOptions),this._searchAPIRequest.getManagedPropertiesQueryResponse(t).catch(function(e){return Promise.reject(e)});if(e.returnCachedValues)return this._returnCachedResults();if(e.searchAPIQueryOptions)t=e.searchAPIQueryOptions;else if(e.searchOptions){var r=de.generateQuery(e.searchOptions,this._pageContext);t=de.generateSearchAPIQueryOptions(r.queryTemplate,r.timeZoneId,e.searchOptions)}return t?this._searchAPIRequest.getSearchQueryResponse(t).then(this._mapResponse).catch(function(e){return Promise.reject(e)}):Promise.resolve([])},e.prototype._initVariables=function(){},e.prototype._mapResponse=function(e){return Promise.resolve(e)},e.prototype._returnCachedResults=function(){return Promise.resolve([])},e}(),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=T.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(r)},t}return Object(j.__extends)(t,e),t._requestNewsData=function(e){var r="ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2",n=[];return e.uniqueIdGuids?(n.push(r+" AND ("),e.uniqueIdGuids.forEach(function(e,t){0===t?n.push("UniqueID:"+e.toString()):n.push(" OR UniqueID:"+e.toString()),n.push(" OR UniqueID:{"+e.toString()+"}")}),n.push(")")):n.push("{searchterms} "+r),t._request(e,n.join(""))},t._request=function(e,r){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:r,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:Y.a.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(fe),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=y.z,t}return Object(j.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){return 0===t.siteList.length?Promise.resolve(this._getNewsItemsWithPadding(t,0)):e.prototype.requestData.call(this,t)},t.prototype.extractMicroserviceNewsItems=function(e){return T.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),this._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=H.isCacheAndNetworkEnabled(),r={alias:T.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[G.a.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),this._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl="+this._pageContext.site.absoluteUrl+"&",r="start="+e.skip+"&count="+e.count;return r+=_(e),r+=m(e),"news/sites/filtered?"+(this._shouldQueryCurrentSite(e.siteList)?t:"")+r},t.prototype._getNewsItemsWithPadding=function(e,t){var r=T.getPaddingCount(e,t);return T.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,r,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),r=this._pageContext.web.id.toString();return M.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===r})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){var r=e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}});return JSON.stringify({ReferenceList:r,FilterQuery:t})},t}(Q),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=y.A,t}return Object(j.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),T.getFilterQueryBody(e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=H.isCacheAndNetworkEnabled(),r={alias:T.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[G.a.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),T.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="start="+e.skip+"&count="+e.count;return"news/filtered?"+((t+=_(e))+m(e))},t}(Q),me=function(){function e(){}return e.ensureQueryableManagedProperties=function(){return e._loadedQueryableManagedPropertiesPromise||(e._loadedQueryableManagedPropertiesPromise=r.e(1).then(r.bind(null,"n9CK")).then(function(e){return e.default})),e._loadedQueryableManagedPropertiesPromise},e.ensureRetrievableManagedProperties=function(){return e._loadedRetrievableManagedPromise||(e._loadedRetrievableManagedPromise=r.e(2).then(r.bind(null,"oz+a")).then(function(e){return e.default})),e._loadedRetrievableManagedPromise},e}(),ve=function(){function e(){}return e.prototype.getPerson=function(e,t){var r,n,i,a;if(!e&&t)(o=t.split(";")).length>0&&(n=o[o.length-1]);else if(e){var o;if((o=e.split(" | ")).length>=2&&(i=o[0],n=o[1]),o.length>=3&&o[2]){var s=o[2].split(" ");s.length>1&&s[1].length>1&&(a=this._getAccountNameFromClaim(s[1]))}}return r={name:n},a&&(r.profileImageSrc=f.SPUtility.getUserPhotoUrl(a)),i?(r.email=i,r.profileImageSrc||(r.profileImageSrc=f.SPUtility.getUserPhotoUrl(i))):n?r.initials=this._getEditorInitials(n):r.profileImageSrc||(r.profileImageSrc=f.SPUtility.getUserPhotoUrl()),r},e.prototype._getEditorInitials=function(e){var t;if(e){var r=e.split("(")[0].trim().split(" ");switch(r.length){case 1:t=r[0].substring(0,2);break;default:t=r[0].charAt(0)+r[r.length-1].charAt(0)}t=t.toUpperCase()}return t},e.prototype._getAccountNameFromClaim=function(e){if(e){var t=e.lastIndexOf("|");if(t>=0)return e.substr(t+1)}},e}();function ye(e){if(!e)return"";var t=new RegExp('[*{}"]',"g");return e.replace(t," ")}var Se=r("6ZIT"),Pe=function(){function e(){}return e.generateCAMLQuery=function(t,r){var n=this;(t=t||{}).documentTypes=t.documentTypes||[te.Any],t.fields=t.fields||["Editor","FileLeafRef","File_x0020_Type","ID","Modified","Title","UniqueID"],t.filters=t.filters||[],t.fieldDictionary=t.fieldDictionary||{};var i=[],a=[],o=!1;t.documentTypes.map(function(e){switch(e){case te.Any:o=!0;break;case te.Word:i.push(n._documentTypeCriteria(["doc","docm","docx"]));break;case te.Excel:i.push(n._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case te.PowerPoint:i.push(n._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case te.OneNote:i.push(n._documentTypeCriteria(["one","onepkg","ms-one-stub"]));break;case te.Visio:i.push(n._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case te.PDF:i.push(n._documentTypeCriteria(["pdf"]))}}),o&&(i=[]),i.length&&(i=['<And><In><FieldRef Name="File_x0020_Type" /><Values>'].concat(i,"</Values></In>"),a.push("</And>")),o&&(i=['<And><And><Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+e._generateNotIn("File_x0020_Type",["onetoc","onetoc2"])+"</And>"],a.push("</And>")),t.contentTypes&&t.contentTypes.indexOf(ee.News)>-1&&(i.push('<And><Eq><FieldRef Name="PromotedState" /><Value Type="Integer">2</Value></Eq>'),a.push("</And>")),t.languageCode&&this._filterByLanguage(t,i,a);var s=t.sortField||"Modified",u="true";"Modified"===s&&(u="false");var c="";t.maxItemsPerPage&&(c='<RowLimit Paged="false">'+t.maxItemsPerPage+"</RowLimit>");var l=t.fields.map(function(e){return'<FieldRef Name="'+e+'" />'}).join("");return'<View Scope="RecursiveAll"><Query>'+e.generateCAMLFilter(t,i,a,r)+'<OrderBy><FieldRef Name="'+s+'" Ascending="'+u+'" /></OrderBy></Query><ViewFields>'+l+"</ViewFields>"+c+"</View>"},e.generateCAMLFilter=function(e,t,r,n){var i=this;if(t=t||[],r=r||[],e.filterGroup){var a=this._generateCriteriaFromFilterGroup(e.filterGroup,e.fieldDictionary,n);return"<Where>"+t.join("")+(a?"<And>":"")+a+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+(a?"</And>":"")+r.join("")+"</Where>"}var o=new Map;return e.filters.map(function(t){if(t){var r=i._generateFieldName(t),a=i._generateCriteria(t,e.fieldDictionary,n);r&&a&&(o.get(t.filterType)||o.set(t.filterType,new Map),o.get(t.filterType).get(r)||o.get(t.filterType).set(r,[]),o.get(t.filterType).get(r).push(a))}}),o.forEach(function(e){e.forEach(function(e){t.push("<And>"+i._combineCriteria(e,"Or")),r.push("</And>")})}),"<Where>"+t.join("")+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+r.join("")+"</Where>"},e._generateNotIn=function(e,t){return t.map(function(t){return'<Neq><FieldRef Name="'+e+'" /><Value Type="Text">'+t+"</Value></Neq>"}).reduceRight(function(e,t){return""===e?t:"<And>"+t+e+"</And>"},"")},e._generateCriteriaFromFilterGroup=function(t,r,n){var i=this,a="";return t.filters&&(a=t.filters.reduce(function(a,o){var s=i._generateCriteria(o,r,n);return e._appendCriteria(t.logicalOperator,a,s)},a)),t.filterGroups&&(a=t.filterGroups.reduce(function(n,a){var o=i._generateCriteriaFromFilterGroup(a,r);return e._appendCriteria(t.logicalOperator,n,o)},a)),a},e._appendCriteria=function(e,t,r){var n="AND"===e?"And":"Or";return t&&r?"<"+n+">"+t+r+"</"+n+">":t+r},e._generateFieldName=function(e){switch(e.filterType){case ie.TitleContaining:return"Title";case ie.CreatedBy:return"Author";case ie.PageAuthorByline:return"_AuthorByline";case ie.ModifiedBy:return"Editor";case ie.RecentlyAdded:return"Created";case ie.RecentlyChanged:return"Modified";case ie.Field:return e.fieldname}return""},e._generateCriteria=function(e,t,r){var n=e.value?this._encodeUserEntryForXML(e.value.toString(),r):"";switch(e.filterType){case ie.TitleContaining:return n?'<Contains><FieldRef Name="Title"/><Value Type="Text">'+n+"</Value></Contains>":"";case ie.CreatedBy:return this._userTypeCriteria(e.userType,n,"Author",e.op);case ie.PageAuthorByline:return this._userTypeCriteria(e.userType,n,"_AuthorByline",e.op);case ie.ModifiedBy:return this._userTypeCriteria(e.userType,n,"Editor",e.op);case ie.RecentlyAdded:return this._dateTimeTypeCriteria(e.value,"Created");case ie.RecentlyChanged:return this._dateTimeTypeCriteria(e.value,"Modified");case ie.Field:return this._fieldTypeCriteria(e,t,r)}return""},e._encodeUserEntryForXML=function(e,t){var r=document.createElement("div");return r.appendChild(document.createTextNode(e)),t?encodeURIComponent(r.innerHTML).replace(new RegExp("'","g"),"%27%27"):r.innerHTML},e._documentTypeCriteria=function(e){return e.map(function(e){return'<Value Type="Text">'+e+"</Value>"}).join("")},e._getISODateString=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e._getDateTimeTypeComparisonValueElement=function(e,t,r){return["<And>",this._comparisonElement("Geq",e,'<Value Type="DateTime">'+this._getISODateString(t)+"</Value>"),this._comparisonElement("Leq",e,'<Value Type="DateTime">'+this._getISODateString(r)+"</Value>"),"</And>"].join("")},e._dateTimeTypeCriteria=function(e,t){var r=new Date;if("number"==typeof e)switch(e){case ne.Today:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today /></Value>');case ne.Yesterday:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today OffsetDays="-1" /></Value>');case ne.ThisWeek:var n=new Date(r.getFullYear(),r.getMonth(),r.getDate()-r.getDay());return this._getDateTimeTypeComparisonValueElement(t,n,r);case ne.ThisMonth:var i=new Date(r.getFullYear(),r.getMonth(),1),a=new Date(r.getFullYear(),r.getMonth()+1,0);return this._getDateTimeTypeComparisonValueElement(t,i,a);case ne.LastMonth:var o=new Date(r.getFullYear(),r.getMonth()-1,1),s=new Date(r.getFullYear(),r.getMonth(),0);return this._getDateTimeTypeComparisonValueElement(t,o,s);case ne.ThisYear:var u=new Date(r.getFullYear(),0,1),c=new Date(r.getFullYear(),11,31);return this._getDateTimeTypeComparisonValueElement(t,u,c);case ne.LastYear:var l=new Date(r.getFullYear()-1,0,1),d=new Date(r.getFullYear()-1,11,31);return this._getDateTimeTypeComparisonValueElement(t,l,d)}return""},e._userTypeCriteria=function(e,t,r,n){switch(n){case re.IsNull:return this._comparisonElement("IsNull",r,"");case re.Equals:default:var i=this._comparisonElement("Eq",r,'<Value Type="Integer"><UserID Type="Integer" /></Value>');return e===se.CurrentUser?i:e===se.SpecificUser&&t?ue.isValidMeToken(t)?i:this._comparisonElement("Eq",r,'<Value Type="User">'+t.toString()+"</Value>"):""}},e._criteriaElement=function(e,t,r,n){var i=n?this._encodeUserEntryForXML(r,n):r,a='<Value Type="'+t.TypeAsString+'">'+i+"</Value>";if(t.FieldTypeKind===Se.d.User&&ue.isValidMeToken(i))a='<Value Type="Integer"><UserID Type="Integer" /></Value>';else if(t.FieldTypeKind===Se.d.DateTime&&ue.isValidTodayToken(i)){var o=i.substr("[today]".length)||"0";a='<Value Type="DateTime"><Today OffsetDays="'+parseInt(o,0)+'" /></Value>'}return this._comparisonElement(e,t.InternalName,a)},e._comparisonElement=function(e,t,r){return"<"+e+'><FieldRef Name="'+t+'"/>'+r+"</"+e+">"},e._includeElement=function(e,t,r){var n=this,i=t.map(function(t){return t?n._criteriaElement("Eq",e,t,r):'<IsNull><FieldRef Name="'+e.InternalName+'"/></IsNull>'});return this._combineCriteria(i,"Or")},e._combineCriteria=function(e,t){if(!e||0===e.length)return"";for(var r="",n=1;n<e.length;n++)r+="<"+t+">";for(r+=e[0],n=1;n<e.length;n++)r+=e[n]+"</"+t+">";return r},e._fieldTypeCriteria=function(e,t,r){var n=this;if(!e.fieldInfo&&!t)return"";var i=e.fieldInfo||t[e.fieldname];if(!i)return"";var a=this._parseListFieldValue(e.value,i.FieldTypeKind);if(""===a.trim()&&e.op!==re.Equals&&e.op!==re.NotEqual&&e.op!==re.Between)return"";var o="";switch(e.op){case re.BeginsWith:o=this._criteriaElement("BeginsWith",i,a,r);break;case re.Between:var s=this._parseListFieldValue(e.value2,i.FieldTypeKind);""!==a.trim()&&""!==s.trim()?o="<And>"+this._criteriaElement("Geq",i,a,r)+this._criteriaElement("Leq",i,s,r)+"</And>":""!==a.trim()?o=this._criteriaElement("Geq",i,a,r):""!==s.trim()&&(o=this._criteriaElement("Leq",i,s,r));break;case re.Contains:o=this._criteriaElement("Contains",i,a,r);break;case re.Equals:o=e.values&&e.values.length>0?this._includeElement(i,e.values.map(function(e){return n._parseListFieldValue(e,i.FieldTypeKind)}),r):this._criteriaElement("Eq",i,a,r);break;case re.GreaterThan:o=this._criteriaElement("Gt",i,a,r);break;case re.GreaterThanOrEqualTo:o=this._criteriaElement("Geq",i,a,r);break;case re.LessThan:o=this._criteriaElement("Lt",i,a,r);break;case re.LessThanOrEqualTo:o=this._criteriaElement("Leq",i,a,r);break;case re.NotEqual:o=this._criteriaElement("Neq",i,a,r)}return o},e._parseListFieldValue=function(e,t){var r="";if(void 0===e)return r;switch(t){case Se.d.DateTime:if("string"==typeof e&&ue.isValidTodayToken(e)){r=e.trim();break}var n=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(n)&&(isNaN(n.getTime())||(r=""+n.toISOString()));break;case Se.d.Number:case Se.d.Currency:var i=parseFloat(e.toString());isNaN(i)||(r=i.toString());break;case Se.d.Integer:case Se.d.Counter:var a=parseInt(e.toString(),10);isNaN(a)||(r=a.toString());break;case Se.d.User:case Se.d.Text:default:r=""+e.toString().trim()}return this._encodeUserEntryForXML(r)},e._filterByLanguage=function(e,t,r){var n=e.contentTypes&&e.contentTypes.indexOf(ee.All)>-1,i=!1,a=!1;if(e.contentTypes&&!n)for(var o=0;o<e.contentTypes.length;++o)switch(e.contentTypes[o]){case ee.Page:i=!0;break;case ee.News:a=!0}if(e.languageCode&&(n||i||a)){var s=e.languageCode,u='<Eq><FieldRef Name="_SPTranslationLanguage" /><Value Type="Choice">'+s+"</Value></Eq>",c='<Neq><FieldRef Name="_SPTranslatedLanguages" /><Value Type="MultiChoice">'+s+"</Value></Neq>";t.push("<And><Or>"+u+"<And>"+c+'<IsNull><FieldRef Name="_SPTranslationLanguage" /></IsNull></And></Or>'),r.push("</And>")}},e}(),we={List:1,Item:2,Field:3},be=r("jnk8"),Te=r("YkpB"),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="List",t.title=Te.b,t._logSource=s._LogSource.create("ListDataProvider"),t}return Object(j.__extends)(t,e),t.prototype.getItems=function(e){var t=this;switch(e.requestType){case we.List:return this._listDataSource||(this._listDataSource=new Se.b({spHttpClient:this.spHttpClient})),this._listDataSource.getListsForWeb(this.baseEndPoint,be.ODataQueryStringBuilder.generateQueryString(e));case we.Item:return this._listItemDataSource||(this._listItemDataSource=new Se.e({spHttpClient:this.spHttpClient})),e.viewId?(this._listViewDataSource||(this._listViewDataSource=new Se.f({spHttpClient:this.spHttpClient})),this._listViewDataSource.updateViewXml(this.baseEndPoint,e.id,e.viewId,e.caml).then(function(){return t._listItemDataSource.getItemsForList(t.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,void 0,void 0,void 0,void 0,e.audienceTarget,e.viewId)})):this._listItemDataSource.getItemsForList(this.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,e.caml,void 0,void 0,void 0,e.audienceTarget);case we.Field:return this._listFieldDataSource||(this._listFieldDataSource=new Se.c({spHttpClient:this.spHttpClient})),this._listFieldDataSource.getFieldsForList(this.baseEndPoint,e.id,be.ODataQueryStringBuilder.generateQueryString(e));default:var r=new Error(Te.a);return s._TraceLogger.logError(this._logSource,r),Promise.reject(r)}},t.prototype.addView=function(e){return this._listViewDataSource||(this._listViewDataSource=new Se.f({spHttpClient:this.spHttpClient})),this._listViewDataSource.addView(this.baseEndPoint,e)},t}(o),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){for(var r=[],n=["aspx","html","htm"],i=0,a=e.rows;i<a.length;i++){var o=a[i],s=t._personaSettingsCache.getPerson(o.EditorOwsUser,o.ModifiedBy),u=n.indexOf(o.FileExtension)>-1?o.Path:f.SPUtility.getWebPathOfFile(o.DefaultEncodingURL?o.DefaultEncodingURL:o.Path),c=Object(ce.d)()?o.LastModifiedTime:o.LastModifiedTimeForRetention,l=o.SitePath;l&&(l=l.split(";")[0]);var d=f.SPFormatDateTime.formatTimestampToDisplayDate(c,t._pageContext,{skeleton:"yMMMd"}),p=M.extend(o,{Name:s.name,Email:s.email,ProfileImageSrc:s.profileImageSrc,Initials:s.initials,InitialsColor:s.initials,WebPath:u,ModifiedDate:d,SitePath:l});p.SiteName&&(p.SiteName=encodeURI(p.SiteName)),r.push(p)}return new Promise(function(e,t){return e(r)})},t}return Object(j.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new ve},t}(fe);function Ie(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function Ee(e,t){return("\n    <View>\n      <ViewFields>\n        "+(B()?'<FieldRef Name="BannerUrl" />':"")+'\n        <FieldRef Name="Category" />\n        <FieldRef Name="EndDate" />\n        <FieldRef Name="EventDate" />\n        <FieldRef Name="ID" />\n        <FieldRef Name="Location" />\n        <FieldRef Name="Title" />\n        <FieldRef Name="fAllDayEvent" />\n        '+(V()?'<FieldRef Name="_ModernAudienceTargetUserField" />':"")+"\n      </ViewFields>\n      <Query>\n        <Where>\n          "+function(e){return a._SPFlight.isEnabled(1634)?"\n      <And>\n        "+e+'\n        <Neq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">1</Value>\n        </Neq>\n      </And>\n    ':"\n      <And>\n        "+e+'\n        <Eq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">0</Value>\n        </Eq>\n      </And>\n    '}(function(e,t){var r=function(e){return e.category?"\n      <Eq>\n        <FieldRef Name='Category' />\n        <Value Type='Choice'>"+d.HtmlEncoding.encodeText(e.category)+"</Value>\n      </Eq>\n    ":""}(e),n=function(e,t){var r='\n      <Geq>\n        <FieldRef Name="EndDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+(e.startDate||"<Today />")+"\n        </Value>\n      </Geq>\n    ",n=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+Ie(e.endDate)+"\n        </Value>\n      </Lt>\n    ":"",i=e.startDate?Re(e.startDate,t):"<Today />",a=e.endDate?Re(Ie(e.endDate),t):"",o='\n        <Geq>\n          <FieldRef Name="EndDate" />\n          <Value IncludeTimeValue="True" Type="DateTime">\n            '+i+"\n          </Value>\n        </Geq>\n      ",s=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+a+"\n        </Value>\n      </Lt>\n    ":"",u='\n      <Neq>\n        <FieldRef Name="fAllDayEvent" />\n        <Value Type="Boolean">1</Value>\n      </Neq>\n    ';return n?"\n      <Or>\n        <And>\n          "+u+"\n          <And>\n            "+r+"\n            "+n+'\n          </And>\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          <And>\n            '+o+"\n            "+s+"\n          </And>\n        </And>\n      </Or>\n      ":"\n      <Or>\n        <And>\n          "+u+"\n          "+r+'\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          '+o+"\n        </And>\n      </Or>"}(e,t);return r?"\n      <And>\n        "+n+"\n        "+r+"\n      </And>\n    ":n}(e,t))+"\n        </Where>\n      </Query>\n      "+function(e){return e.rowLimit?'<RowLimit Paged="FALSE">'+e.rowLimit+"</RowLimit>":""}(e)+"\n    </View>\n  ").replace(/" \/>/g,'"/>').split(/(?:\r\n|\r|\n)/).map(function(e){return e.trim()}).join("")}function Re(e,t){var r=new Date(e);return r.setMinutes(r.getMinutes()-t.offset),r.toISOString()}var xe=r("Ycni"),Ue=function(){function e(){}return e.dateStringToUTCDate=function(t,r,n){if(e._allDayKillSwitch.isActivated())return new Date(t);var i=new Date(e.ensureISOTimestamp(t));if(!n)return i;var a=new xe.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}).convertToUTC(r);return new Date(Date.UTC(a.fullYear,a.month,a.date,a.hours,a.minutes,a.seconds,a.milliseconds))},e.dateStringToLocalDate=function(t,r,n){var i=new Date(e.ensureISOTimestamp(t));if(!r)return i;var a=new xe.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=n?a:a.convertFromUTC(r);return new Date(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds)},e.localToUtc=function(e,t){if(!t)return e;var r=new xe.SPDate({fullYear:e.getFullYear(),date:e.getDate(),month:e.getMonth(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}).convertToUTC(t);return new Date(Date.UTC(r.fullYear,r.month,r.date,r.hours,r.minutes,r.seconds))},e.ensureISOTimestamp=function(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*Z$/i.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*$/i.test(e))return e.substring(0,19)+"Z";throw new Error("EventTimeZoneUtilities: date time string "+e+" is not supported")},e._allDayKillSwitch=new f.KillSwitch("5a511229-1361-450b-a2ac-61bdf600d687"),e}(),Fe=r("fP0x");function Ae(e,t){return{FieldName:e,FieldValue:t}}function Ne(e){return(e<10?"0":"")+e}function Le(e){return e.getFullYear()+"-"+Ne(e.getMonth()+1)+"-"+Ne(e.getDate())+" "+Ne(e.getHours())+":"+Ne(e.getMinutes())+":"+Ne(e.getSeconds())}function Oe(e,t,r){if(t){var n=e.getFullYear()+"-"+Ne(e.getMonth()+1)+"-"+Ne(e.getDate())+"T00:00:00.000Z";return Ue.dateStringToLocalDate(n,r,!1)}return e}function qe(e,t,r){var n={formValues:[Ae("Title",e.title),Ae("Category",e.category?e.category instanceof Array?JSON.stringify(e.category):e.category:""),Ae("Description",e.description),Ae("Location",e.location),Ae("EventDate",Le(Oe(e.startTime,e.isAllDayEvent,r))),Ae("EndDate",Le(Oe(e.endTime,e.isAllDayEvent,r))),Ae("fAllDayEvent",e.isAllDayEvent?"true":"false"),Ae("Workspace",e.linkUrl?e.linkUrl+", "+e.linkName:""),Ae("BannerUrl",e.bannerUrl),Ae("ParticipantsPicker",JSON.stringify(t.map(function(e){return{Key:e}}))),Ae("Geolocation",e.geolocation?"Point ("+e.geolocation.longitude+" "+e.geolocation.latitude+")":"")],bNewDocumentUpdate:!1,checkInComment:null};return V()&&e.audiences&&n.formValues.push(Ae("_ModernAudienceTargetUserField",JSON.stringify(e.audiences.map(function(e){return{Key:e}})))),n}function Me(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){throw He(e.correlationId,e.status,t.error)})}function ke(e){return e.status>=200&&e.status<300?Promise.resolve(!0):e.json().then(function(t){if(400===e.status&&"string"==typeof t.error.message&&t.error.message.indexOf("7F759147-C861-4CD6-A11F-5AA3037D9634"))return Promise.resolve(!1);throw He(e.correlationId,e.status,t.error)})}function je(e){var t=e.value.filter(function(e){return 0!==e.ErrorCode});if(t.length>0)throw{correlationId:a.Guid.empty,httpStatus:200,code:t[0].ErrorCode.toString(),message:t[0].ErrorMessage};return e.value.filter(function(e){return"Id"===e.FieldName})[0].FieldValue}function He(e,t,r){var n=r||{code:"UnknownErrorCode",message:Fe.b};return{correlationId:e,httpStatus:t,code:n.code,message:"string"==typeof n.message?n.message:n.message.value}}var Ve=function(){function e(e){this.id="Event",this.title="EventDataProvider",this._eventToETag=new Map,this.options=e,this._serviceScope=e.serviceScope}return e.prototype.requestData=function(e){var t=this;if(!e.listId)return Promise.resolve([]);if(e.startDate&&e.endDate&&new Date(e.startDate)>new Date(e.endDate))return Promise.resolve([]);var r,n={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"};return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,u=o.httpClient,c=a.UrlUtilities.removeEndSlash(s.web.absoluteUrl);r=t._getTimeZoneFromPageContext(s);var l=c+"/_api/web/Lists(guid'"+e.listId.toString()+"')/RenderListDataAsStream?"+t._buildQueryString(e),d=JSON.stringify({parameters:Object(j.__assign)({__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:Ee(e,r),AudienceTarget:e.audienceTarget},!Object(ce.c)()&&!!e.cdnRewriteBannerUrl&&{ImageFieldsToTryRewriteToCdnUrls:"BannerUrl"})});return u.post(l,i.SPHttpClient.configurations.v1,{body:d,headers:n})}).then(Me).then(function(e){if(e&&e.ListData&&e.ListData.Row instanceof Array)return e.ListData.Row.map(function(n){var i;return{id:n.ID,category:n.Category,title:t._htmlDecode(n.Title),description:void 0,startTime:Ue.dateStringToLocalDate(n.EventDate,r,"1"===n["fAllDayEvent.value"]),endTime:Ue.dateStringToLocalDate(n.EndDate,r,"1"===n["fAllDayEvent.value"]),allDay:"1"===n["fAllDayEvent.value"],location:t._htmlDecode(n.Location),attendees:void 0,containsAudiences:V()?(null===(i=n._ModernAudienceTargetUserField)||void 0===i?void 0:i.length)>0:void 0,prevPageQuery:t._constructPageQuery(e.ListData.PrevHref),nextPageQuery:t._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:B()?String(n.BannerUrl):void 0,webName:"",webUrl:""}});throw new Error(Fe.a)})},e.prototype.requestEventItem=function(e,t){return this._requestEventItem(e,t,!1)},e.prototype.requestUTCEventItem=function(e,t,r){return this._requestEventItem(t,r,!0,e)},e.prototype.updateEventItem=function(e,t,r){var n,o=this;return V()?this._afterServiceScopeFinished().then(function(s){var u=s.pageContext,c=s.httpClient,l=a.UrlUtilities.removeEndSlash(u.web.absoluteUrl);n=l+"/_api/web/Lists(guid'"+e.toString()+"')/items('"+t+"')/ValidateUpdateListItem()";var d={"If-Match":o._eventToETag.get(n),"Content-Type":"application/json;charset=utf-8"};return o._getEventPeopleIds(r.attendees).then(function(e){var t=JSON.stringify(qe(r,e.map(function(e){return e.UserPrincipalName||e.LoginName}),o._getTimeZoneFromPageContext(u)));return c.post(n,i.SPHttpClient.configurations.v1,{headers:d,body:t})})}).then(function(e){return Me(e).then(function(){return e})}).then(function(e){o._eventToETag.set(n,e.headers.get("ETag"))}):this._updateEventItemFlightDisabled(e,t,r)},e.prototype.deleteEventItem=function(e,t){var r,n=this;return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,u=o.httpClient,c=a.UrlUtilities.removeEndSlash(s.web.absoluteUrl);r=c+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var l={"If-Match":n._eventToETag.get(r)};return u.fetch(r,i.SPHttpClient.configurations.v1,{headers:l,method:"DELETE"})}).then(Me).then(function(){n._eventToETag.delete(r)}).catch(function(e){if("-2130575234, Microsoft.SharePoint.SPException"!==e.code)throw e;A._EngagementLogger.logEvent("EventDataProvider.DeleteEventItemFailure.HasSkypeLink")})},e.prototype.createEventItem=function(e,t){var r=this;return V()?this._afterServiceScopeFinished().then(function(n){var o=n.pageContext,s=n.httpClient,u=a.UrlUtilities.removeEndSlash(o.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/AddValidateUpdateItemUsingPath()",c={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return r._getEventPeopleIds(t.attendees).then(function(e){var n=JSON.stringify(qe(t,e.map(function(e){return e.UserPrincipalName||e.LoginName}),r._getTimeZoneFromPageContext(o)));return s.post(u,i.SPHttpClient.configurations.v1,{headers:c,body:n})})}).then(Me).then(je).then(function(t){return r.requestEventItem(e,t)}):this._createEventItemFlightDisabled(e,t)},e.prototype.getAllCategories=function(e){return Promise.all([this.getInUsedCategories(e),this.getPreDefinedCategories(e)]).then(function(e){var t=e[0],r=e[1];return Object(M.uniq)(Object(j.__spreadArrays)(t,r.categories)).sort()})},e.prototype.getPreDefinedCategories=function(e){return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/fields/GetByInternalNameOrTitle('Category')";return n.get(o,i.SPHttpClient.configurations.v1).then(Me).then(function(e){return{categories:Object(j.__spreadArrays)(e.Choices),type:e.TypeAsString}})})},e.prototype.getInUsedCategories=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext,i=r.httpClient,o=a.UrlUtilities.removeEndSlash(n.web.absoluteUrl);return t._getViewId(o,e.toString(),i).then(function(r){return t._getCategoriesFromView(o,e.toString(),i,r)})})},e.prototype.convertDisplayedDateToUTC=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext;return Ue.localToUtc(e,t._getTimeZoneFromPageContext(n))})},e.prototype.getAudienceTargetEnabledFlag=function(e){return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/Fields(guid'7F759147-C861-4CD6-A11F-5AA3037D9634')";return n.get(o,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(ke)},e.prototype._createEventItemFlightDisabled=function(e,t){var r,n,o=this,s=e.toString();return this._afterServiceScopeFinished().then(function(e){var u=e.pageContext,c=e.httpClient;r=a.UrlUtilities.removeEndSlash(u.web.absoluteUrl),n=o._getTimeZoneFromPageContext(u);var l=r+"/_api/web/Lists(guid'"+s+"')/items?$select="+["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","Geolocation","ID","Location","ParticipantsPickerId","Title","Workspace","fRecurrence"].join(","),d={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return o._constructEventPayload(t,n).then(function(e){var t=JSON.stringify(e);return c.post(l,i.SPHttpClient.configurations.v1,{headers:d,body:t})})}).then(Me).then(function(e){var t=r+"/_api/web/Lists(guid'"+s+"')/items("+e.ID+")";return o._eventToETag.set(t,e["@odata.etag"]),o._mapRESTResponseEvent(e,n)})},e.prototype._updateEventItemFlightDisabled=function(e,t,r){var n,o,s=this;return this._afterServiceScopeFinished().then(function(u){var c=u.pageContext,l=u.httpClient;o=s._getTimeZoneFromPageContext(c);var d=a.UrlUtilities.removeEndSlash(c.web.absoluteUrl);n=d+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var p={"If-Match":s._eventToETag.get(n),"X-HTTP-Method":"MERGE","Content-Type":"application/json;charset=utf-8"};return s._constructEventPayload(r,o).then(function(e){var t=JSON.stringify(e);return l.post(n,i.SPHttpClient.configurations.v1,{headers:p,body:t})})}).then(function(e){return Me(e).then(function(){return e})}).then(function(e){s._eventToETag.set(n,e.headers.get("ETag"))})},e.prototype._getViewId=function(e,t,r){var n=e+"/_api/web/Lists/GetById('"+t+"')/Views?$select=Id&$filter=BaseViewId eq '1'";return r.get(n,i.SPHttpClient.configurations.v1).then(Me).then(function(e){return e.value&&e.value.length>0?e.value[0].Id:Promise.reject(new Error("No view is found."))})},e.prototype._getCategoriesFromView=function(e,t,r,n){var a=this,o=e+"/_api/web/Lists/GetById('"+t+"')/RenderListFilterData?FieldInternalName='Category'&ViewId='"+n+"'";return r.post(o,i.SPHttpClient.configurations.v1,{}).then(function(e){if(e.ok)return e.text();throw new Error(JSON.stringify(e))}).then(function(e){var t=new RegExp('Value="([^"]*)',"g"),r=e.match(t).map(function(e){return e.replace(t,"$1")}).map(a._htmlDecode);return Object(M.uniq)(r)})},e.prototype._mapRESTResponseEvent=function(e,t,r){var i=this;return void 0===r&&(r=!1),this._getEventAttachments(e).then(function(a){return{id:e.ID.toString(),category:e.Category,title:e.Title,description:e.Description,startTime:r?Ue.dateStringToUTCDate(e.EventDate,t,e.fAllDayEvent):Ue.dateStringToLocalDate(e.EventDate,t,e.fAllDayEvent),endTime:r?Ue.dateStringToUTCDate(e.EndDate,t,e.fAllDayEvent):Ue.dateStringToLocalDate(e.EndDate,t,e.fAllDayEvent),location:e.Location,attendees:i._mapRESTResponsePeople(e.ParticipantsPicker),audiences:V()?i._mapRESTResponseAudience(e.OData__ModernAudienceTargetUserField,e["OData__ModernAudienceTargetUserField@odata.navigationLink"]):void 0,bannerUrl:e.BannerUrl?e.BannerUrl.Url:"",attachments:a,linkName:e.Workspace?e.Workspace.Description:"",linkUrl:e.Workspace?e.Workspace.Url:"",isAllDayEvent:e.fAllDayEvent,geolocation:e.Geolocation?{latitude:e.Geolocation.Latitude,longitude:e.Geolocation.Longitude}:void 0,permission:new n.SPPermission(e.EffectiveBasePermissions),isRecurrence:e.fRecurrence,prevPageQuery:void 0,nextPageQuery:void 0,webName:"",webUrl:""}})},e.prototype._getEventAttachments=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext,o=r.httpClient,s=a.UrlUtilities.removeEndSlash(n.web.absoluteUrl);if(e.Attachments){var u=o.beginBatch(),c=e.AttachmentFiles.map(function(e){return e.ServerRelativeUrl}).map(function(e){var t=s+"/_api/web/getFileByUrl('"+e+"')";return u.get(t,i.SPHttpClientBatch.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(function(e){return Me(e)})});return u.execute().then(function(){return Promise.all(c)}).then(t._mapRESTAttachments)}return Promise.resolve([])})},e.prototype._constructEventPayload=function(e,t){return this._getEventPeopleIds(e.attendees).then(function(e){return e.map(function(e){return e.Id})}).then(function(r){return{Title:e.title,Category:e.category?e.category:null,Description:e.description,Location:e.location,EventDate:Ue.localToUtc(e.startTime,t).toISOString(),EndDate:Ue.localToUtc(e.endTime,t).toISOString(),fAllDayEvent:e.isAllDayEvent,Workspace:{Description:e.linkName,Url:e.linkUrl},BannerUrl:{Url:e.bannerUrl},ParticipantsPickerId:r,Geolocation:e.geolocation?{Latitude:e.geolocation.latitude,Longitude:e.geolocation.longitude}:null,fRecurrence:e.isRecurrence}})},e.prototype._getEventPeopleIds=function(e){return e.length>0?this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl),s=n.beginBatch(),u=e.map(function(e){var t=o+"/_api/web/ensureUser(@user)?@user='"+encodeURIComponent(e.id)+"'";return s.get(t,i.SPHttpClientBatch.configurations.v1).then(Me).then(function(e){return e})});return s.execute().then(function(){return Promise.all(u)})}):Promise.resolve([])},e.prototype._requestEventItem=function(e,t,r,n){var o,s,u=this;return void 0===r&&(r=!1),this._afterServiceScopeFinished().then(function(r){var c=r.pageContext,l=r.httpClient;s=u._getTimeZoneFromPageContext(c),n=n||a.UrlUtilities.removeEndSlash(c.web.absoluteUrl);var p=["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","ID","Location","ParticipantsPicker/Name","ParticipantsPicker/Title","Title","Workspace","fRecurrence","Geolocation"],f=["AttachmentFiles","ParticipantsPicker"];o=n+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var h={Accept:"application/json","Content-Type":"application/json;charset=utf-8"},g=V()?u.getAudienceTargetEnabledFlag(e):Promise.resolve(!1);if(Object(ce.b)())return g.then(function(e){e&&(p.push("OData__ModernAudienceTargetUserField/Name"),f.push("OData__ModernAudienceTargetUserField"));var t="$select="+p.join(",")+"&$expand="+f.join(","),r=o+"/?"+t;return l.get(r,i.SPHttpClient.configurations.v1,{headers:h})});var _=new d.Uri(n),m=new d.Uri(c.web.absoluteUrl),v=_.getScheme()+"://"+_.getHost();return(v===m.getScheme()+"://"+m.getHost()?Promise.resolve(!0):i._AadTokenProviders.configurable._getTokenInternal(v,i._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return h.Authorization="Bearer "+e,Promise.resolve(!0)},function(){return Promise.resolve(!0)})).then(function(){return g}).then(function(e){return e&&(p.push("OData__ModernAudienceTargetUserField/Name"),f.push("OData__ModernAudienceTargetUserField")),Promise.resolve(!0)},function(){return Promise.resolve(!0)}).then(function(){var e="$select="+p.join(",")+"&$expand="+f.join(","),t=o+"/?"+e;return l.get(t,i.SPHttpClient.configurations.v1,{headers:h})})}).then(Me).then(function(e){return u._eventToETag.set(o,e["@odata.etag"]),u._mapRESTResponseEvent(e,s,r)})},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(n.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._buildQueryString=function(e){if(e.pageQuery)return e.pageQuery;var t=[];return e.orderBy&&t.push(["SortField",e.orderBy.field],["SortDir",e.orderBy.direction]),t.map(function(e){return e.join("=")}).join("&")},e.prototype._mapRESTResponsePeople=function(e){return e?e.map(function(e){return{id:e.Name,name:e.Title}}):[]},e.prototype._mapRESTResponseAudience=function(e,t){return e?e.map(function(e){return function(e){var t;return(null===(t=e.Name)||void 0===t?void 0:t.length)>=36?e.Name.substr(e.Name.length-36):""}(e)}):t?[]:void 0},e.prototype._mapRESTAttachments=function(e){return e?e.map(function(e){return{fileName:e.Name,fileSize:e.Length,filePreviewUrl:e.LinkingUri,fileRelativeUrl:e.ServerRelativeUrl}}):[]},e.prototype._constructPageQuery=function(e){return e?e.substr(1).replace("&View=00000000-0000-0000-0000-000000000000",""):""},e.prototype._getTimeZoneFromPageContext=function(e){return e.user.preferUserTimeZone?e.user.timeZoneInfo:e.web.timeZoneInfo},e.prototype._htmlDecode=function(e){return e?(new DOMParser).parseFromString(e,"text/html").body.innerText:e},Object(j.__decorate)([Object(f.monitor)("EventDataProvider.RequestData")],e.prototype,"requestData",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.UpdateEventItem")],e.prototype,"updateEventItem",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.DeleteEventItem")],e.prototype,"deleteEventItem",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.CreateEventItem")],e.prototype,"createEventItem",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetPreDefinedCategories")],e.prototype,"getPreDefinedCategories",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetInUsedCategories")],e.prototype,"getInUsedCategories",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetAudienceTargetEnabledFlag")],e.prototype,"getAudienceTargetEnabledFlag",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetEventAttachments")],e.prototype,"_getEventAttachments",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetEventPeopleIds")],e.prototype,"_getEventPeopleIds",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.RequestEventItem")],e.prototype,"_requestEventItem",null),e}(),Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=t._pageContext.user.preferUserTimeZone?t._pageContext.user.timeZoneInfo:t._pageContext.web.timeZoneInfo,n=e.rows.map(function(e){var t="true"===e.IsAllDayEvent,n=Ue.dateStringToLocalDate(e.EventsRollUpStartDate.toString(),r,t);return{endTime:Ue.dateStringToLocalDate(e.EventsRollUpEndDate.toString(),r,t),isAllDayEvent:t,startTime:n,id:e.ListItemID,attendees:void 0,audiences:void 0,bannerUrl:B()?e.BannerUrlOWSURLH?e.BannerUrlOWSURLH.split(",")[0]:"":void 0,category:e.EventsRollUpCategory?e.EventsRollUpCategory.toString():"",description:void 0,geolocation:void 0,linkName:void 0,linkUrl:void 0,listId:e.ListID,location:e.Location?e.Location.toString():"",nextPageQuery:void 0,prevPageQuery:void 0,title:e.Title,webName:e.SiteTitle?e.SiteTitle:"",webUrl:e.SPWebUrl?e.SPWebUrl.toString():"",containsAudiences:!!V()&&Boolean(e.ModernAudienceAadObjectIds)}});return Promise.resolve(n)},t}return Object(j.__extends)(t,e),Object.defineProperty(t,"selectProperties",{get:function(){var e=["EventsRollUpCategory","EventsRollUpEndDate","EventsRollUpStartDate","IsAllDayEvent","ListID","ListItemID","Location","SiteTitle","SPWebUrl","Title"];return B()&&e.push("BannerUrlOWSURLH"),e},enumerable:!1,configurable:!0}),t}(fe),Ge=[-2130575322,-2147024891],Qe=function(){function e(e){this._serviceScope=e}return e.prototype.getEventsLists=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,a=r.web.absoluteUrl+"/_api/web/Lists?$filter=BaseTemplate eq 106&$select=Id,Title";return n.get(a,i.SPHttpClient.configurations.v1).then(e._parseResponse).then(function(e){return e.value})})},e.prototype.ensureEventsList=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,a=r.web.absoluteUrl+"/_api/Lists/EnsureEventsList?$select=Title,Id";return n.post(a,i.SPHttpClient.configurations.v1,{}).then(e._parseResponse)})},e.prototype.getEventsListPermission=function(e){var t=this;return e?this._afterServiceScopeFinished().then(function(r){var a=r.pageContext,o=r.httpClient,s=a.web.absoluteUrl+"/_api/web/Lists(guid'"+e+"')/EffectiveBasePermissions";return o.get(s,i.SPHttpClient.configurations.v1).then(t._parseResponse).then(function(e){return new n.SPPermission(e)}).catch(function(e){return Ge.forEach(function(t){if(-1!==e.code.indexOf(String(t)))throw new f.ExpectedFailure("SPErrorCode_"+e.code,e.message,{correlationId:e.correlationId?e.correlationId.toString():void 0})}),Promise.reject(e)})}):Promise.resolve(void 0)},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(n.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){var r=t.error||{code:"UnknownErrorCode",message:Fe.b};throw{correlationId:e.correlationId,httpStatus:e.status,code:r.code,message:"string"==typeof r.message?r.message:r.message.value}})},Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetEventsLists")],e.prototype,"getEventsLists",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.EnsureEventsList")],e.prototype,"ensureEventsList",null),Object(j.__decorate)([Object(f.monitor)("EventDataProvider.GetEventsListPermission")],e.prototype,"getEventsListPermission",null),e}(),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.getPageJsonBlob=function(e,t,r){return this.get(e,"_api/sitepages/pages/GetByUrl('"+d.UriEncoding.encodeRestUriStringToken(t)+"')",r,"PageDataSource","getPageJsonBlob").then(function(e){return[e]})},t.prototype.getPageCanvasContent=function(e){return this.get("/",e,"asjson=1","PageDataSource","getPageCanvasContent").then(function(e){return e.page.Content.CanvasContent1})},t}(be.SPDataSource),We=r("QRxg"),ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="Page",t.title=We.a,t}return Object(j.__extends)(t,e),t.prototype.getItems=function(e){return this._pageDataSource||(this._pageDataSource=new Ke({spHttpClient:this.spHttpClient})),this._pageDataSource.getPageCanvasContent(e.pageRelativeUrl).then(function(e){return[e]})},t}(o);function Ze(e){var t=e.pageRelativeUrl,r=e.webPartInstanceId,n=e.componentName,i=e.webPartAlias,a=e.defaultWebPartData,o=e.serviceScope,s=e.processWebPartDataCallback,u=new A._QosMonitor(n+".ParseWebPartDataFromPage");return new ze({serviceScope:o}).requestData({pageRelativeUrl:t}).then(function(e){var t=e[0],r=t.CanvasJson1||t;return r||function(e,t){var r=new Error("StockContent");throw e.writeExpectedFailure(r.message,r,Je(t)),r}(u,i),JSON.parse(r)}).then(function(e){return function(e,t){if(t)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i.id===e)return i}}(r,e)}).then(function(e){var t;if(e&&(t=e.webPartData),!t){var n=new Error("NoInstanceDataFound");throw u.writeUnexpectedFailure(n.message,n,Je(i)),n}return t.instanceId=r,s&&(t=s(t)),u.writeSuccess(Je(i)),t}).catch(function(e){return u.hasEnded||u.writeUnexpectedFailure("FailedToParse",e,Je(i)),A._EngagementLogger.logEvent(n+".LoadDefaultWebPartData"),a}).then(function(e){return e})}function Je(e){return{webpart:e}}var Ye,Xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=e.rows.map(function(e){return{id:a.Guid.tryParse(e.UniqueID),lastEditor:t._personaSettingsCache.getPerson(e.EditorOwsUser,e.ModifiedBy),lastModifiedDate:e.ModifiedOwsDate&&new Date(e.ModifiedOwsDate),title:e.Title,url:e.DefaultEncodingURL}});return Promise.resolve(r)},t}return Object(j.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new ve},t}(fe),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.getPages=function(e){var t=new s._QosMonitor("TemplatePanelDataSource.getPages");return this.get(e,"_api/sitepages/pages/templates","asjson=1","TemplatePanelDataSource","getPages").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return 404===e.status?t.writeExpectedFailure("TemplatePanelError",Error(e.statusMessage||"getPage returned 404"),{correlationId:e.correlationId,status:e.status}):t.writeUnexpectedFailure("TemplatePanelError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(be.SPDataSource),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.getPage=function(e,t){var r=new s._QosMonitor("TemplateSelectedPageCopyDataSource.getPage");return this.get(e,"_api/sitepages/pages("+t+")","$select=CanvasContent1,LayoutWebpartsContent","TemplateCopyDataSource","getPage").then(function(e){return r.writeSuccess(),[e]}).catch(function(e){return r.writeUnexpectedFailure("TemplateSelectedPageCopyError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(be.SPDataSource),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.getPage=function(e){var t=new s._QosMonitor("TemplateSelectedPageAsJsonDataSource.getPage");return this.get(e,"","as=json","TemplateSelectedPageAsJsonDataSource","getPage").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return t.writeUnexpectedFailure("TemplateSelectedPageAsJsonError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(be.SPDataSource),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var r=new s._QosMonitor(t._dataSourceName+".GetDefaultNewPageTemplateId");return this.get(e,"_api/web/DefaultNewPageTemplateId","",t._dataSourceName,"GetDefaultNewPageTemplateId",this._headers).then(function(e){var t=e.value;return r.writeSuccess(),t}).catch(function(e){return r.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t.prototype.setDefaultNewPageTemplateId=function(e,r){var n=new s._QosMonitor(t._dataSourceName+".SetDefaultNewPageTemplateId",!0);return this.post(e,"_api/web/SetDefaultNewPageTemplateId","",JSON.stringify({defaultNewPageTemplateId:r}),t._dataSourceName,"SetDefaultNewPageTemplateId",this._headers,!0,!0).then(function(){return n.writeSuccess(),!0}).catch(function(e){return n.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to set DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e},enumerable:!1,configurable:!0}),t._dataSourceName="DefaultNewPageTemplateIdDataSource",t._errorTag="DefaultNewPageTemplateIdError",t}(be.SPDataSource),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(j.__extends)(t,e),t.prototype.deleteTemplatePage=function(e,r){var n=new s._QosMonitor(t._dataSourceName+".deleteTemplatePage"),i=t._apiRelativePath+"('"+r+"')";return this.post(e,i+"/recycle()","","",t._dataSourceName,"deleteTemplatePage",this._headers,!0,!0).then(function(){return n.writeSuccess(),!0}).catch(function(e){return n.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to delete template page"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e.append("IF-MATCH","*"),e},enumerable:!1,configurable:!0}),t._apiRelativePath="_api/web/GetFileByServerRelativeUrl",t._dataSourceName="DeleteTemplatePageDataSource",t._errorTag="DeleteTemplatePageError",t}(be.SPDataSource),it=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplates",t.title="Template Data Provider",t}return Object(j.__extends)(t,e),t.prototype.getItems=function(e){return this._templatePanelDataSource||(this._templatePanelDataSource=new $e({spHttpClient:this.spHttpClient})),this._templatePanelDataSource.getPages(e.webAbsoluteUrl)},t}(o),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesCopy",t.title="Template Copy Data Provider",t}return Object(j.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageCopyDataSource||(this._templateSelectedPageCopyDataSource=new et({spHttpClient:this.spHttpClient})),this._templateSelectedPageCopyDataSource.getPage(e.webAbsoluteUrl,e.page.Id)},t}(o),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesAsJson",t.title="Template As Json Data Provider",t}return Object(j.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageAsJsonDataSource||(this._templateSelectedPageAsJsonDataSource=new tt({spHttpClient:this.spHttpClient})),this._templateSelectedPageAsJsonDataSource.getPage(e.page.AbsoluteUrl)},t}(o),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DefaultNewPageTemplateId",t.title="Default New Page Template Id Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(j.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var t=this;return(this._defaultNewPageTemplateIdDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultNewPageTemplateIdDataSource=new rt({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultNewPageTemplateIdDataSource.getDefaultNewPageTemplateId(e.RequestingWebUrl)})},t.prototype.setDefaultNewPageTemplateId=function(e){var t=this;return(this._defaultNewPageTemplateIdDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultNewPageTemplateIdDataSource=new rt({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultNewPageTemplateIdDataSource.setDefaultNewPageTemplateId(e.RequestingWebUrl,e.DefaultNewPageTemplateId)})},t}(o),ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DeleteTemplatePage",t.title="Delete Template Page Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(j.__extends)(t,e),t.prototype.deleteTemplatePage=function(e){var t=this;return(this._defaultDeleteTemplatePageDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultDeleteTemplatePageDataSource=new nt({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultDeleteTemplatePageDataSource.deleteTemplatePage(e.RequestingWebUrl,e.RelativePageUrl)})},t}(o),ct=function(){function e(e){this.id="RecentDocuments",this.title="Recent documents",this._pageContext=e}return e.prototype.requestData=function(e){var t=this,r=new A._QosMonitor("RecentDocumentsDataProvider.getRecentDocuments");return e.authToken.then(function(r){return fetch(t._getApiUrl(e),t._getHttpConfig(r))}).then(function(e){return r.writeSuccess(),e.json()}).catch(function(e){r.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return e&&e.documents&&e.documents.items?e.documents.items.map(function(e){var t=new Date(e.time_stamp),r=e.url.substring(0,e.url.lastIndexOf("/")),n="OneNote"===e.app?"one":e.extension,i=new d.Uri(e.url);return i.setQueryParameter("web","1"),{fileName:e.title,fileUrl:i.toString(),filePathSegments:e.display_path,filePathUrl:r,fileType:e.app,fileExtension:n,lastAccessedRelative:t}}):[]})},e.prototype._getApiUrl=function(e){return this._pageContext.legacyPageContext.msMruEndpointUrl+"/ocs/v2/recent/docs?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,PdfViewer&show="+(e.numDocsToRequest||50)+"&sort=Date"},e.prototype._getHttpConfig=function(e){var t=new Headers;return t.set("Authorization","Bearer "+e),t.set("Content-Type","application/json"),t.set("X-Office-Application","120"),t.set("X-Office-Platform","Web"),t.set("X-Office-Version","aec61d34-20ca-455f-ba08-4fbe7e366f81"),t.set("X-CorrelationId",a.Guid.newGuid().toString()),{headers:t}},e}(),lt=function(){function e(e){this._httpClient=e.serviceScope.consume(i.HttpClient.serviceKey),this._cultureName=e.serviceScope.consume(n.PageContext.serviceKey).cultureInfo.currentUICultureName,this._qosPrefix=e.qosPrefix}return e.prototype.getLocationSuggestions=function(e,t){void 0===t&&(t=5);var r=new A._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationSuggestions"),n=new d.Uri("https://www.bingapis.com/api/v6/Places/AutoSuggest");return n.setQueryParameter("q",e),n.setQueryParameter("appid","DEFC13FBC2E876A56E00AD5BDB9B690CD6B55B16"),n.setQueryParameter("structuredaddress","true"),n.setQueryParameter("setmkt",this._cultureName),n.setQueryParameter("setlang",this._cultureName),n.setQueryParameter("count",String(t)),"zh-cn"===this._cultureName.toLowerCase()?(n.setQueryParameter("localmapview","40.173091266970914,116.1689437866211,39.68604237738654,116.63105621337891"),n.setQueryParameter("localcircularview","39.9295,116.4,100")):"ja-jp"===this._cultureName.toLowerCase()&&(n.setQueryParameter("localmapview","36.266035662679684,139.24756548070306,35.10266624641582,140.5796577658593"),n.setQueryParameter("localcircularview","39.9785614013672,116.308280944824,100")),this._httpClient.get(n.toString(),i.HttpClient.configurations.v1).catch(function(e){return Promise.reject(new f.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){if(e&&e.value)return r.writeSuccess(),e.value.filter(function(e){return e.address});r.writeUnexpectedFailure("BingLocationDataProvider: value data does not exist in response.")})},e.prototype.getLocationInfo=function(e,t){void 0===t&&(t=1);var r=new A._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationInfo"),n=new d.Uri("https://dev.virtualearth.net/REST/v1/Locations");return n.setQueryParameter("query",e),n.setQueryParameter("o","json"),n.setQueryParameter("c",this._cultureName),n.setQueryParameter("maxResults",t.toString()),n.setQueryParameter("key","AmOSPT8X9eXz5u_8hQauiEyLHFJOG522w2XBbewYRhDtcEAUpsVIbvpApHbDAtyA"),this._httpClient.get(n.toString(),i.HttpClient.configurations.v1).catch(function(e){return r.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: network error."),Promise.reject(new f.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){try{var t=e.resourceSets[0].resources.map(function(e){return{name:e.name,coordinates:{latitude:e.point.coordinates[0],longitude:e.point.coordinates[1]}}});return r.writeSuccess(),t}catch(e){return r.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: invalid response."),Promise.reject(e)}})},e.prototype._parseResponse=function(e){return e.ok?e.json().catch(function(t){return Promise.reject(new f.UnexpectedFailure("FailedToParseResponse",t,{statusCode:e.status}))}):e.json().catch(function(t){return Promise.reject(new f.UnexpectedFailure("FailedToParseError",t,{statusCode:e.status}))}).then(function(t){return Promise.reject(new f.UnexpectedFailure("RequestFailure",JSON.stringify(t),{statusCode:e.status}))})},e}();!function(e){e.GetFirstRunHTTPError403="GetFirstErrorHTTP403",e.GetFirstRunHTTPStatusError="GetFirstHTTPStatusError",e.GetFirstRunHTTPRequestError="GetFirstHTTPRequestError"}(Ye||(Ye={}));var dt,pt=Ye,ft={true:!0,false:!1},ht=function(){function e(){}return e.getIsFirstRun=function(e){var t=window.localStorage.getItem(e);return ft[t]},e.setIsFirstRun=function(t,r){var n=window.localStorage.getItem(t),i=String(r);if(n!==i)try{window.localStorage.setItem(t,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e._logSource=s._LogSource.create("CortexFirstRunCacheManager"),e}();!function(e){e.KnowledgeCenter="KnowledgeCenterFirstRun",e.KnowledgeManagementTopicPage="KnowledgeManagementTopicPageFirstRun"}(dt||(dt={}));var gt,_t=dt,mt=function(){function e(){}return e.topicFirstRun="CSIKM.FirstRun",e.topicFirstRunDPLogPrefix=e.topicFirstRun+".DP",e.topicFirstRunGetAPIDPPrefix=e.topicFirstRun+"GetAPI.DP",e.topicFirstRunSetAPIDPPrefix=e.topicFirstRun+"SetAPI.DP",e}(),vt=((gt={})[_t.KnowledgeCenter]="sharePointKnowledgeCenterFirstRun",gt[_t.KnowledgeManagementTopicPage]="sharePointKnowledgeManagementTopicPageFirstRun",gt),yt=function(){function e(e,t){this._spHttpClient=t,this._pageContext=e}return e._domainUrl=function(){return decodeURIComponent(window.location.protocol+"//"+window.location.host)},e._getErrorExtraData=function(e){var t=e.headers.get("sprequestguid")||"",r=e.headers.get("microsoftsharepointteamservices")||"";return{status:e.status,correlationId:t,spVersion:r}},e.prototype.getIsFirstRun=function(t){return Object(j.__awaiter)(this,void 0,void 0,function(){var r;return Object(j.__generator)(this,function(n){switch(n.label){case 0:return"boolean"!=typeof(r=ht.getIsFirstRun(t))?[3,1]:(s._TraceLogger.logVerbose(e._logSource,mt.topicFirstRun+" is "+r+" in the local storage"),[2,r]);case 1:return[4,this._getServerIsFirstRun(t)];case 2:return[2,n.sent()]}})})},e.prototype.setIsFirstRun=function(e,t){return Object(j.__awaiter)(this,void 0,void 0,function(){return Object(j.__generator)(this,function(r){switch(r.label){case 0:return[4,this.setServerIsFirstRun(e,t)];case 1:return r.sent(),this.setLocalIsFirstRun(e,t),[2]}})})},e.prototype.setServerIsFirstRun=function(t,r){return Object(j.__awaiter)(this,void 0,void 0,function(){var n,a,o,u,c;return Object(j.__generator)(this,function(l){switch(l.label){case 0:return n=!r,a=new A._QosMonitor(mt.topicFirstRunGetAPIDPPrefix),(o={})[vt[t]]=n,[4,this._spHttpClient.post(this._bitRestUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(o),headers:{Accept:"*/*, application/json; odata=minimalmetadata","X-HTTP-Method":"PATCH","Content-Type":"application/json; odata=minimalmetadata","X-ClientType":"PageAuthoring_SetFirstRunBit"}})];case 1:if(!(u=l.sent()).ok)throw c=new Error(u.statusText),s._TraceLogger.logError(e._logSource,c),a.writeUnexpectedFailure(mt.topicFirstRunSetAPIDPPrefix,c,e._getErrorExtraData(u)),c;return s._TraceLogger.logVerbose(e._logSource,"Request successfully for setting page authoring first run, the status: "+n),a.writeSuccess(),[2]}})})},e.prototype.setLocalIsFirstRun=function(e,t){ht.setIsFirstRun(e,t)},e.prototype._getServerIsFirstRun=function(t){return Object(j.__awaiter)(this,void 0,void 0,function(){var r,n,a,o,u,c,l;return Object(j.__generator)(this,function(d){switch(d.label){case 0:r=new A._QosMonitor(mt.topicFirstRunGetAPIDPPrefix),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,this._spHttpClient.get(this._retrieveBitRestUrl(t),i.SPHttpClient.configurations.v1,{headers:{"X-ClientType":"PageAuthoring_GetFirstRunBit"}})];case 2:return(n=d.sent()).ok?[4,n.json()]:[3,4];case 3:return a=d.sent(),o=a[vt[t]],s._TraceLogger.logVerbose(e._logSource,"Retrieving first run bit "+t+" successfully, the status: "+!o),r.writeSuccess(),[2,!o];case 4:return u=new Error(n.statusText),c=e._getErrorExtraData(n),403===n.status?(r.writeExpectedFailure(pt.GetFirstRunHTTPError403,u,c),[2,!1]):(s._TraceLogger.logError(e._logSource,u),r.writeUnexpectedFailure(pt.GetFirstRunHTTPStatusError,u,c),[2,Promise.reject(u)]);case 5:return[3,7];case 6:return l=d.sent(),s._TraceLogger.logError(e._logSource,l),r.writeUnexpectedFailure(pt.GetFirstRunHTTPRequestError,l),[2,Promise.reject(l)];case 7:return[2]}})})},e.prototype._retrieveBitRestUrl=function(e){return this._bitRestUrl+"?$select="+vt[e]},Object.defineProperty(e.prototype,"_bitRestUrl",{get:function(){return e._domainUrl()+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+d.UriEncoding.encodeURIComponent(this._pageContext.legacyPageContext.userLoginName)+"')"},enumerable:!1,configurable:!0}),e._logSource=s._LogSource.create(mt.topicFirstRunDPLogPrefix),e}()},mBwh:function(e,t,r){e.exports=r.p+"icon_helpitemimg3_7f442b60.png"},mwqp:function(e,t,r){"use strict";r.r(t);var n=r("jrLr");r.d(t,"BaseDataProvider",function(){return n.b}),r.d(t,"BookmarksDataProvider",function(){return n.d}),r.d(t,"NewsUtilities",function(){return n.J}),r.d(t,"news",function(){return n.lb}),r.d(t,"viewCounts",function(){return n.rb}),r.d(t,"currentViewCounts",function(){return n.hb}),r.d(t,"hubNews",function(){return n.ib}),r.d(t,"newsDigest",function(){return n.nb}),r.d(t,"multiSiteNews",function(){return n.jb}),r.d(t,"myNews",function(){return n.kb}),r.d(t,"staleViewCounts",function(){return n.pb}),r.d(t,"NewsDataSource",function(){return n.E}),r.d(t,"newsDataSourceProp",function(){return n.mb}),r.d(t,"_appendAudienceFilteringQueryParam",function(){return n.db}),r.d(t,"_appendLanguageOverrideQueryParam",function(){return n.eb}),r.d(t,"_getExtraDataForLogging",function(){return n.fb}),r.d(t,"NewsEmptyStateType",function(){return n.H}),r.d(t,"ExchangeViewCountsDataProvider",function(){return n.r}),r.d(t,"HubNewsDataProvider",function(){return n.v}),r.d(t,"MicroServiceNewsDataProvider",function(){return n.A}),r.d(t,"NewsDataProvider",function(){return n.D}),r.d(t,"NewsDigestDataProvider",function(){return n.F}),r.d(t,"NewsDigestUtilities",function(){return n.G}),r.d(t,"NewsSearchDataProvider",function(){return n.I}),r.d(t,"MultiSiteNewsDataProvider",function(){return n.B}),r.d(t,"MyNewsDataProvider",function(){return n.C}),r.d(t,"tryGetAuthoritativeSiteDetails",function(){return n.qb}),r.d(t,"DocumentType",function(){return n.n}),r.d(t,"FilterOperator",function(){return n.s}),r.d(t,"FilterSince",function(){return n.t}),r.d(t,"FilterType",function(){return n.u}),r.d(t,"UserType",function(){return n.bb}),r.d(t,"TokenUtilities",function(){return n.Y}),r.d(t,"TieredCacheHelper",function(){return n.X}),r.d(t,"ContentLocation",function(){return n.f}),r.d(t,"ContentType",function(){return n.h}),r.d(t,"DeferredManagedProperties",function(){return n.k}),r.d(t,"KQLQueryBuilder",function(){return n.w}),r.d(t,"AUDIENCE_TARGET_KQL_QUERY",function(){return n.a}),r.d(t,"ManagedDataType",function(){return n.z}),r.d(t,"SortType",function(){return n.Q}),r.d(t,"SearchDataProvider",function(){return n.P}),r.d(t,"PersonaSettingsCache",function(){return n.N}),r.d(t,"sanitizeSearchQueryParameter",function(){return n.ob}),r.d(t,"CAMLQueryBuilder",function(){return n.e}),r.d(t,"ListRequestType",function(){return n.y}),r.d(t,"ListDataProvider",function(){return n.x}),r.d(t,"ContentRollupDataProvider",function(){return n.g}),r.d(t,"EventDataProvider",function(){return n.o}),r.d(t,"EventsSearchDataProvider",function(){return n.q}),r.d(t,"EventsListDataProvider",function(){return n.p}),r.d(t,"PageDataProvider",function(){return n.K}),r.d(t,"PageDataSource",function(){return n.L}),r.d(t,"_getWebPartDataFromPage",function(){return n.gb}),r.d(t,"PageSearchDataProvider",function(){return n.M}),r.d(t,"TemplatePanelDataSource",function(){return n.S}),r.d(t,"TemplateSelectedPageCopyDataSource",function(){return n.W}),r.d(t,"TemplateSelectedPageAsJsonDataSource",function(){return n.V}),r.d(t,"DefaultNewPageTemplateIdDataSource",function(){return n.j}),r.d(t,"DeleteTemplatePageDataSource",function(){return n.m}),r.d(t,"TemplatePanelDataProvider",function(){return n.R}),r.d(t,"TemplatePanelSelectedPageCopyDataProvider",function(){return n.U}),r.d(t,"TemplatePanelSelectedPageAsJsonDataProvider",function(){return n.T}),r.d(t,"DefaultNewPageTemplateIdDataProvider",function(){return n.i}),r.d(t,"DeleteTemplatePageDataProvider",function(){return n.l}),r.d(t,"RecentDocumentsDataProvider",function(){return n.O}),r.d(t,"BingLocationDataProvider",function(){return n.c}),r.d(t,"TopicFirstRunDataProvider",function(){return n.Z}),r.d(t,"TopicFirstRunKeys",function(){return n.ab}),r.d(t,"ViewCountDataProvider",function(){return n.cb});var i=r("6ZIT");r.d(t,"ListDataSource",function(){return i.b}),r.d(t,"ListFieldDataSource",function(){return i.c}),r.d(t,"ListFieldType",function(){return i.d}),r.d(t,"ListItemDataSource",function(){return i.e}),r.d(t,"SPRenderListDataOptions",function(){return i.i}),r.d(t,"ListViewDataSource",function(){return i.f}),r.d(t,"BaseDataSource",function(){return i.a}),r.d(t,"ODataQueryStringBuilder",function(){return i.g}),r.d(t,"SPDataSource",function(){return i.h});var a=r("e+fh");r.d(t,"SPHomeHttpClient",function(){return a.a}),r.d(t,"SPHomeMicroserviceNotAvailableError",function(){return a.b});var o=r("JEu8");for(var s in o)["default","BaseDataProvider","BookmarksDataProvider","NewsUtilities","news","viewCounts","currentViewCounts","hubNews","newsDigest","multiSiteNews","myNews","staleViewCounts","NewsDataSource","newsDataSourceProp","_appendAudienceFilteringQueryParam","_appendLanguageOverrideQueryParam","_getExtraDataForLogging","NewsEmptyStateType","ExchangeViewCountsDataProvider","HubNewsDataProvider","MicroServiceNewsDataProvider","NewsDataProvider","NewsDigestDataProvider","NewsDigestUtilities","NewsSearchDataProvider","MultiSiteNewsDataProvider","MyNewsDataProvider","tryGetAuthoritativeSiteDetails","DocumentType","FilterOperator","FilterSince","FilterType","UserType","TokenUtilities","TieredCacheHelper","ContentLocation","ContentType","DeferredManagedProperties","KQLQueryBuilder","AUDIENCE_TARGET_KQL_QUERY","ManagedDataType","SortType","SearchDataProvider","PersonaSettingsCache","sanitizeSearchQueryParameter","CAMLQueryBuilder","ListRequestType","ListDataProvider","ContentRollupDataProvider","EventDataProvider","EventsSearchDataProvider","EventsListDataProvider","PageDataProvider","PageDataSource","_getWebPartDataFromPage","PageSearchDataProvider","TemplatePanelDataSource","TemplateSelectedPageCopyDataSource","TemplateSelectedPageAsJsonDataSource","DefaultNewPageTemplateIdDataSource","DeleteTemplatePageDataSource","TemplatePanelDataProvider","TemplatePanelSelectedPageCopyDataProvider","TemplatePanelSelectedPageAsJsonDataProvider","DefaultNewPageTemplateIdDataProvider","DeleteTemplatePageDataProvider","RecentDocumentsDataProvider","BingLocationDataProvider","TopicFirstRunDataProvider","TopicFirstRunKeys","ViewCountDataProvider","ListDataSource","ListFieldDataSource","ListFieldType","ListItemDataSource","SPRenderListDataOptions","ListViewDataSource","BaseDataSource","ODataQueryStringBuilder","SPDataSource","SPHomeHttpClient","SPHomeMicroserviceNotAvailableError"].indexOf(s)<0&&function(e){r.d(t,e,function(){return o[e]})}(s);var u=r("S/19");for(var s in u)["default","BaseDataProvider","BookmarksDataProvider","NewsUtilities","news","viewCounts","currentViewCounts","hubNews","newsDigest","multiSiteNews","myNews","staleViewCounts","NewsDataSource","newsDataSourceProp","_appendAudienceFilteringQueryParam","_appendLanguageOverrideQueryParam","_getExtraDataForLogging","NewsEmptyStateType","ExchangeViewCountsDataProvider","HubNewsDataProvider","MicroServiceNewsDataProvider","NewsDataProvider","NewsDigestDataProvider","NewsDigestUtilities","NewsSearchDataProvider","MultiSiteNewsDataProvider","MyNewsDataProvider","tryGetAuthoritativeSiteDetails","DocumentType","FilterOperator","FilterSince","FilterType","UserType","TokenUtilities","TieredCacheHelper","ContentLocation","ContentType","DeferredManagedProperties","KQLQueryBuilder","AUDIENCE_TARGET_KQL_QUERY","ManagedDataType","SortType","SearchDataProvider","PersonaSettingsCache","sanitizeSearchQueryParameter","CAMLQueryBuilder","ListRequestType","ListDataProvider","ContentRollupDataProvider","EventDataProvider","EventsSearchDataProvider","EventsListDataProvider","PageDataProvider","PageDataSource","_getWebPartDataFromPage","PageSearchDataProvider","TemplatePanelDataSource","TemplateSelectedPageCopyDataSource","TemplateSelectedPageAsJsonDataSource","DefaultNewPageTemplateIdDataSource","DeleteTemplatePageDataSource","TemplatePanelDataProvider","TemplatePanelSelectedPageCopyDataProvider","TemplatePanelSelectedPageAsJsonDataProvider","DefaultNewPageTemplateIdDataProvider","DeleteTemplatePageDataProvider","RecentDocumentsDataProvider","BingLocationDataProvider","TopicFirstRunDataProvider","TopicFirstRunKeys","ViewCountDataProvider","ListDataSource","ListFieldDataSource","ListFieldType","ListItemDataSource","SPRenderListDataOptions","ListViewDataSource","BaseDataSource","ODataQueryStringBuilder","SPDataSource","SPHomeHttpClient","SPHomeMicroserviceNotAvailableError"].indexOf(s)<0&&function(e){r.d(t,e,function(){return u[e]})}(s)},n1Om:function(e,t){},nJGZ:function(e,t,r){"use strict";var n=r("17wl"),i=function(){function e(){}return e.processResponseRawData=function(e,t,r){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return e.then(function(e){return t(e)?r.apply(void 0,Object(n.__spreadArrays)([e],i)):e})},e.useStalePropName="useStale",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e}();t.a=i},o7e7:function(e,t){},rOX9:function(e,t,r){"use strict";var n=r("Pk8u"),i=r("vlQI"),a=r("X+PM"),o=r("2q6Q"),s=r("ut3N"),u=function(){function e(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=""),this._serviceScope=e,this._isMockMode=t,this._qosPrefix=r}return e.prototype.getSearchQueryResponse=function(e){var t=this,r=this._qosPrefix?new o._QosMonitor(this._qosPrefix+".SearchDataProviderGetResponse"):new o._QosMonitor("SearchDataProviderGetResponse");return this._isMockMode?(r.writeSuccess(),Promise.resolve(this.mockResponse)):this._getRawSearchQueryResponse(e).then(function(e){var n=t._simplifyResultForTemplating(e);return r.writeSuccess(),n}).catch(function(e){return r.writeUnexpectedFailure("FailedSearchPOST",e,{correlationId:e.correlationId}),Promise.reject(e)})},e.prototype.getManagedPropertiesQueryResponse=function(e){var t=new o._QosMonitor("ManagedPropertiesRequest");return this._isMockMode?(t.writeSuccess(),Promise.resolve([])):this._getRawSearchQueryResponse(e).then(function(e){var r=Object(n.has)(e.PrimaryQueryResult,"RefinementResults.Refiners")?e.PrimaryQueryResult.RefinementResults.Refiners:[],i=(r.length>0?r[0].Entries:[]).map(function(e){return e.RefinementName});return t.writeSuccess(),Promise.resolve(i)}).catch(function(e){return t.writeUnexpectedFailure("ManagedPropertiesRequestFailed",e),Promise.reject(e)})},e.prototype._getRawSearchQueryResponse=function(e){var t=this;e.ClientType=e.ClientType||"ModernWebPart";var r='{ "request": '+(e?JSON.stringify(e):"{}")+" }",n=new Headers;return n.append("Accept","application/json;odata=nometadata"),n.append("Content-type","application/json;charset=utf-8"),n.append("OData-Version","3.0"),this._afterServiceScopeFinished().then(function(e){var a=e.pageContext,o=e.spHttpClient,s=a.web.absoluteUrl+"/_api/search/postquery";return o.post(s,i.SPHttpClient.configurations.v1,{body:r,headers:n}).then(t._parseResponse)})},e.prototype._simplifyResultForTemplating=function(e){var t={};try{for(var r=[],n=e.PrimaryQueryResult.RelevantResults.Table.Rows,i=0;i<n.length;i++){for(var a={},o=n[i].Cells,s=0;s<o.length;s++){var u=o[s];a[u.Key]=u.Value}r.push(a)}t.rows=r}catch(e){t.rows=[]}return t},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),spHttpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(t){return t.status>=200&&t.status<300?t.json():t.json().then(function(r){var n="BadSearchResponse: statusMessage="+t.statusMessage;throw s._TraceLogger.logVerbose(e._LogSource,n+", response inner error="+JSON.stringify(r)),{message:n,status:t.status,correlationId:t.correlationId?t.correlationId.toString():"",innerError:r}})},e._LogSource=s._LogSource.create("SearchAPIRequest"),e}();t.a=u},ui8f:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={Text:1,Integer:2,Decimal:3,DateTime:4,YesNo:5,Binary:6,Double:7}},ukKy:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r("17wl"),i=r("vlQI"),a=r("UWqr"),o=r("RSuL"),s=r("6DSs"),u=function(e){function t(t){var r=e.call(this,t)||this;return r._spHttpClient=t.spHttpClient,r}return Object(n.__extends)(t,e),t.prototype.get=function(e,t,r,n,a,o,s,u){var c=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.get(c,i.SPHttpClient.configurations.v1,{headers:o}),n,a,s,u)},t.prototype.post=function(e,t,r,n,a,o,s,u,c){var l=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.post(l,i.SPHttpClient.configurations.v1,{body:n,headers:s}),a,o,u,c)},t.prototype.patch=function(e,t,r,n,a,o,s,u,c){var l=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.fetch(l,i.SPHttpClient.configurations.v1,{body:n,headers:s,method:"PATCH"}),a,o,u,c)},t.prototype._getResponse=function(e,t,r,n,i){return e.then(function(e){if(e.ok)return i?{}:e.json();var o=a.Text.format(s.a,t,r,e.status,e.statusMessage);if(n)throw e;return e.json().then(function(t){throw{message:o,status:e.status,correlationId:e.correlationId?e.correlationId.toString():"",innerError:t}})})},t}(o.a)},urBa:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={HighlightedContent:1,SiteActivity:2,Sites:3,RecentDocuments:4,OfficeFeed:5,MyTopics:6,Other:999}},ut3N:function(e,t){e.exports=l},vlQI:function(e,t){e.exports=d},y88i:function(e,t){e.exports=p},zDft:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){}return e.ascending=0,e.descending=1,e}()}})});